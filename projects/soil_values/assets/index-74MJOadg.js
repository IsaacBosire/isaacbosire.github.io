(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))_(T);new MutationObserver(T=>{for(const C of T)if(C.type==="childList")for(const P of C.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&_(P)}).observe(document,{childList:!0,subtree:!0});function d(T){const C={};return T.integrity&&(C.integrity=T.integrity),T.referrerPolicy&&(C.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?C.credentials="include":T.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function _(T){if(T.ep)return;T.ep=!0;const C=d(T);fetch(T.href,C)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function hx(t){const l=Object.create(null);for(const d of t.split(","))l[d]=1;return d=>d in l}const Fr={},Kp=[],nl=()=>{},sI=()=>!1,s_=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),ub=t=>t.startsWith("onUpdate:"),Tn=Object.assign,db=(t,l)=>{const d=t.indexOf(l);d>-1&&t.splice(d,1)},oI=Object.prototype.hasOwnProperty,tn=(t,l)=>oI.call(t,l),Oi=Array.isArray,Jp=t=>um(t)==="[object Map]",Of=t=>um(t)==="[object Set]",ow=t=>um(t)==="[object Date]",aI=t=>um(t)==="[object RegExp]",er=t=>typeof t=="function",Dn=t=>typeof t=="string",Ul=t=>typeof t=="symbol",gn=t=>t!==null&&typeof t=="object",fb=t=>(gn(t)||er(t))&&er(t.then)&&er(t.catch),dE=Object.prototype.toString,um=t=>dE.call(t),lI=t=>um(t).slice(8,-1),ux=t=>um(t)==="[object Object]",pb=t=>Dn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Qp=hx(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),dx=t=>{const l=Object.create(null);return d=>l[d]||(l[d]=t(d))},cI=/-(\w)/g,qs=dx(t=>t.replace(cI,(l,d)=>d?d.toUpperCase():"")),hI=/\B([A-Z])/g,aa=dx(t=>t.replace(hI,"-$1").toLowerCase()),o_=dx(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ig=dx(t=>t?`on${o_(t)}`:""),zo=(t,l)=>!Object.is(t,l),em=(t,...l)=>{for(let d=0;d<t.length;d++)t[d](...l)},fE=(t,l,d,_=!1)=>{Object.defineProperty(t,l,{configurable:!0,enumerable:!1,writable:_,value:d})},Wy=t=>{const l=parseFloat(t);return isNaN(l)?t:l},Hy=t=>{const l=Dn(t)?Number(t):NaN;return isNaN(l)?t:l};let aw;const fx=()=>aw||(aw=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),uI="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",dI=hx(uI);function Rc(t){if(Oi(t)){const l={};for(let d=0;d<t.length;d++){const _=t[d],T=Dn(_)?gI(_):Rc(_);if(T)for(const C in T)l[C]=T[C]}return l}else if(Dn(t)||gn(t))return t}const fI=/;(?![^(]*\))/g,pI=/:([^]+)/,mI=/\/\*[^]*?\*\//g;function gI(t){const l={};return t.replace(mI,"").split(fI).forEach(d=>{if(d){const _=d.split(pI);_.length>1&&(l[_[0].trim()]=_[1].trim())}}),l}function Us(t){let l="";if(Dn(t))l=t;else if(Oi(t))for(let d=0;d<t.length;d++){const _=Us(t[d]);_&&(l+=_+" ")}else if(gn(t))for(const d in t)t[d]&&(l+=d+" ");return l.trim()}function _I(t){if(!t)return null;let{class:l,style:d}=t;return l&&!Dn(l)&&(t.class=Us(l)),d&&(t.style=Rc(d)),t}const yI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xI=hx(yI);function pE(t){return!!t||t===""}function vI(t,l){if(t.length!==l.length)return!1;let d=!0;for(let _=0;d&&_<t.length;_++)d=Hu(t[_],l[_]);return d}function Hu(t,l){if(t===l)return!0;let d=ow(t),_=ow(l);if(d||_)return d&&_?t.getTime()===l.getTime():!1;if(d=Ul(t),_=Ul(l),d||_)return t===l;if(d=Oi(t),_=Oi(l),d||_)return d&&_?vI(t,l):!1;if(d=gn(t),_=gn(l),d||_){if(!d||!_)return!1;const T=Object.keys(t).length,C=Object.keys(l).length;if(T!==C)return!1;for(const P in t){const V=t.hasOwnProperty(P),s=l.hasOwnProperty(P);if(V&&!s||!V&&s||!Hu(t[P],l[P]))return!1}}return String(t)===String(l)}function px(t,l){return t.findIndex(d=>Hu(d,l))}const mE=t=>!!(t&&t.__v_isRef===!0),pi=t=>Dn(t)?t:t==null?"":Oi(t)||gn(t)&&(t.toString===dE||!er(t.toString))?mE(t)?pi(t.value):JSON.stringify(t,gE,2):String(t),gE=(t,l)=>mE(l)?gE(t,l.value):Jp(l)?{[`Map(${l.size})`]:[...l.entries()].reduce((d,[_,T],C)=>(d[e0(_,C)+" =>"]=T,d),{})}:Of(l)?{[`Set(${l.size})`]:[...l.values()].map(d=>e0(d))}:Ul(l)?e0(l):gn(l)&&!Oi(l)&&!ux(l)?String(l):l,e0=(t,l="")=>{var d;return Ul(t)?`Symbol(${(d=t.description)!=null?d:l})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ro;class mb{constructor(l=!1){this.detached=l,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ro,!l&&Ro&&(this.index=(Ro.scopes||(Ro.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let l,d;if(this.scopes)for(l=0,d=this.scopes.length;l<d;l++)this.scopes[l].pause();for(l=0,d=this.effects.length;l<d;l++)this.effects[l].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let l,d;if(this.scopes)for(l=0,d=this.scopes.length;l<d;l++)this.scopes[l].resume();for(l=0,d=this.effects.length;l<d;l++)this.effects[l].resume()}}run(l){if(this._active){const d=Ro;try{return Ro=this,l()}finally{Ro=d}}}on(){Ro=this}off(){Ro=this.parent}stop(l){if(this._active){this._active=!1;let d,_;for(d=0,_=this.effects.length;d<_;d++)this.effects[d].stop();for(this.effects.length=0,d=0,_=this.cleanups.length;d<_;d++)this.cleanups[d]();if(this.cleanups.length=0,this.scopes){for(d=0,_=this.scopes.length;d<_;d++)this.scopes[d].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!l){const T=this.parent.scopes.pop();T&&T!==this&&(this.parent.scopes[this.index]=T,T.index=this.index)}this.parent=void 0}}}function mx(t){return new mb(t)}function gb(){return Ro}function _E(t,l=!1){Ro&&Ro.cleanups.push(t)}let kn;const t0=new WeakSet;class Ug{constructor(l){this.fn=l,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ro&&Ro.active&&Ro.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,t0.has(this)&&(t0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||xE(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,lw(this),vE(this);const l=kn,d=Fl;kn=this,Fl=!0;try{return this.fn()}finally{bE(this),kn=l,Fl=d,this.flags&=-3}}stop(){if(this.flags&1){for(let l=this.deps;l;l=l.nextDep)xb(l);this.deps=this.depsTail=void 0,lw(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?t0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){E0(this)&&this.run()}get dirty(){return E0(this)}}let yE=0,kg,Pg;function xE(t,l=!1){if(t.flags|=8,l){t.next=Pg,Pg=t;return}t.next=kg,kg=t}function _b(){yE++}function yb(){if(--yE>0)return;if(Pg){let l=Pg;for(Pg=void 0;l;){const d=l.next;l.next=void 0,l.flags&=-9,l=d}}let t;for(;kg;){let l=kg;for(kg=void 0;l;){const d=l.next;if(l.next=void 0,l.flags&=-9,l.flags&1)try{l.trigger()}catch(_){t||(t=_)}l=d}}if(t)throw t}function vE(t){for(let l=t.deps;l;l=l.nextDep)l.version=-1,l.prevActiveLink=l.dep.activeLink,l.dep.activeLink=l}function bE(t){let l,d=t.depsTail,_=d;for(;_;){const T=_.prevDep;_.version===-1?(_===d&&(d=T),xb(_),bI(_)):l=_,_.dep.activeLink=_.prevActiveLink,_.prevActiveLink=void 0,_=T}t.deps=l,t.depsTail=d}function E0(t){for(let l=t.deps;l;l=l.nextDep)if(l.dep.version!==l.version||l.dep.computed&&(wE(l.dep.computed)||l.dep.version!==l.version))return!0;return!!t._dirty}function wE(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Vg))return;t.globalVersion=Vg;const l=t.dep;if(t.flags|=2,l.version>0&&!t.isSSR&&t.deps&&!E0(t)){t.flags&=-3;return}const d=kn,_=Fl;kn=t,Fl=!0;try{vE(t);const T=t.fn(t._value);(l.version===0||zo(T,t._value))&&(t._value=T,l.version++)}catch(T){throw l.version++,T}finally{kn=d,Fl=_,bE(t),t.flags&=-3}}function xb(t,l=!1){const{dep:d,prevSub:_,nextSub:T}=t;if(_&&(_.nextSub=T,t.prevSub=void 0),T&&(T.prevSub=_,t.nextSub=void 0),d.subs===t&&(d.subs=_,!_&&d.computed)){d.computed.flags&=-5;for(let C=d.computed.deps;C;C=C.nextDep)xb(C,!0)}!l&&!--d.sc&&d.map&&d.map.delete(d.key)}function bI(t){const{prevDep:l,nextDep:d}=t;l&&(l.nextDep=d,t.prevDep=void 0),d&&(d.prevDep=l,t.nextDep=void 0)}function wI(t,l){t.effect instanceof Ug&&(t=t.effect.fn);const d=new Ug(t);l&&Tn(d,l);try{d.run()}catch(T){throw d.stop(),T}const _=d.run.bind(d);return _.effect=d,_}function TI(t){t.effect.stop()}let Fl=!0;const TE=[];function Yu(){TE.push(Fl),Fl=!1}function Ku(){const t=TE.pop();Fl=t===void 0?!0:t}function lw(t){const{cleanup:l}=t;if(t.cleanup=void 0,l){const d=kn;kn=void 0;try{l()}finally{kn=d}}}let Vg=0;class EI{constructor(l,d){this.sub=l,this.dep=d,this.version=d.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class gx{constructor(l){this.computed=l,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(l){if(!kn||!Fl||kn===this.computed)return;let d=this.activeLink;if(d===void 0||d.sub!==kn)d=this.activeLink=new EI(kn,this),kn.deps?(d.prevDep=kn.depsTail,kn.depsTail.nextDep=d,kn.depsTail=d):kn.deps=kn.depsTail=d,EE(d);else if(d.version===-1&&(d.version=this.version,d.nextDep)){const _=d.nextDep;_.prevDep=d.prevDep,d.prevDep&&(d.prevDep.nextDep=_),d.prevDep=kn.depsTail,d.nextDep=void 0,kn.depsTail.nextDep=d,kn.depsTail=d,kn.deps===d&&(kn.deps=_)}return d}trigger(l){this.version++,Vg++,this.notify(l)}notify(l){_b();try{for(let d=this.subs;d;d=d.prevSub)d.sub.notify()&&d.sub.dep.notify()}finally{yb()}}}function EE(t){if(t.dep.sc++,t.sub.flags&4){const l=t.dep.computed;if(l&&!t.dep.subs){l.flags|=20;for(let _=l.deps;_;_=_.nextDep)EE(_)}const d=t.dep.subs;d!==t&&(t.prevSub=d,d&&(d.nextSub=t)),t.dep.subs=t}}const qy=new WeakMap,Af=Symbol(""),S0=Symbol(""),jg=Symbol("");function fo(t,l,d){if(Fl&&kn){let _=qy.get(t);_||qy.set(t,_=new Map);let T=_.get(d);T||(_.set(d,T=new gx),T.map=_,T.key=d),T.track()}}function wh(t,l,d,_,T,C){const P=qy.get(t);if(!P){Vg++;return}const V=s=>{s&&s.trigger()};if(_b(),l==="clear")P.forEach(V);else{const s=Oi(t),$=s&&pb(d);if(s&&d==="length"){const Z=Number(_);P.forEach((J,ne)=>{(ne==="length"||ne===jg||!Ul(ne)&&ne>=Z)&&V(J)})}else switch((d!==void 0||P.has(void 0))&&V(P.get(d)),$&&V(P.get(jg)),l){case"add":s?$&&V(P.get("length")):(V(P.get(Af)),Jp(t)&&V(P.get(S0)));break;case"delete":s||(V(P.get(Af)),Jp(t)&&V(P.get(S0)));break;case"set":Jp(t)&&V(P.get(Af));break}}yb()}function SI(t,l){const d=qy.get(t);return d&&d.get(l)}function jp(t){const l=Ir(t);return l===t?l:(fo(l,"iterate",jg),Ba(t)?l:l.map(po))}function _x(t){return fo(t=Ir(t),"iterate",jg),t}const CI={__proto__:null,[Symbol.iterator](){return i0(this,Symbol.iterator,po)},concat(...t){return jp(this).concat(...t.map(l=>Oi(l)?jp(l):l))},entries(){return i0(this,"entries",t=>(t[1]=po(t[1]),t))},every(t,l){return _h(this,"every",t,l,void 0,arguments)},filter(t,l){return _h(this,"filter",t,l,d=>d.map(po),arguments)},find(t,l){return _h(this,"find",t,l,po,arguments)},findIndex(t,l){return _h(this,"findIndex",t,l,void 0,arguments)},findLast(t,l){return _h(this,"findLast",t,l,po,arguments)},findLastIndex(t,l){return _h(this,"findLastIndex",t,l,void 0,arguments)},forEach(t,l){return _h(this,"forEach",t,l,void 0,arguments)},includes(...t){return r0(this,"includes",t)},indexOf(...t){return r0(this,"indexOf",t)},join(t){return jp(this).join(t)},lastIndexOf(...t){return r0(this,"lastIndexOf",t)},map(t,l){return _h(this,"map",t,l,void 0,arguments)},pop(){return bg(this,"pop")},push(...t){return bg(this,"push",t)},reduce(t,...l){return cw(this,"reduce",t,l)},reduceRight(t,...l){return cw(this,"reduceRight",t,l)},shift(){return bg(this,"shift")},some(t,l){return _h(this,"some",t,l,void 0,arguments)},splice(...t){return bg(this,"splice",t)},toReversed(){return jp(this).toReversed()},toSorted(t){return jp(this).toSorted(t)},toSpliced(...t){return jp(this).toSpliced(...t)},unshift(...t){return bg(this,"unshift",t)},values(){return i0(this,"values",po)}};function i0(t,l,d){const _=_x(t),T=_[l]();return _!==t&&!Ba(t)&&(T._next=T.next,T.next=()=>{const C=T._next();return C.value&&(C.value=d(C.value)),C}),T}const AI=Array.prototype;function _h(t,l,d,_,T,C){const P=_x(t),V=P!==t&&!Ba(t),s=P[l];if(s!==AI[l]){const J=s.apply(t,C);return V?po(J):J}let $=d;P!==t&&(V?$=function(J,ne){return d.call(this,po(J),ne,t)}:d.length>2&&($=function(J,ne){return d.call(this,J,ne,t)}));const Z=s.call(P,$,_);return V&&T?T(Z):Z}function cw(t,l,d,_){const T=_x(t);let C=d;return T!==t&&(Ba(t)?d.length>3&&(C=function(P,V,s){return d.call(this,P,V,s,t)}):C=function(P,V,s){return d.call(this,P,po(V),s,t)}),T[l](C,..._)}function r0(t,l,d){const _=Ir(t);fo(_,"iterate",jg);const T=_[l](...d);return(T===-1||T===!1)&&vx(d[0])?(d[0]=Ir(d[0]),_[l](...d)):T}function bg(t,l,d=[]){Yu(),_b();const _=Ir(t)[l].apply(t,d);return yb(),Ku(),_}const MI=hx("__proto__,__v_isRef,__isVue"),SE=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Ul));function II(t){Ul(t)||(t=String(t));const l=Ir(this);return fo(l,"has",t),l.hasOwnProperty(t)}class CE{constructor(l=!1,d=!1){this._isReadonly=l,this._isShallow=d}get(l,d,_){if(d==="__v_skip")return l.__v_skip;const T=this._isReadonly,C=this._isShallow;if(d==="__v_isReactive")return!T;if(d==="__v_isReadonly")return T;if(d==="__v_isShallow")return C;if(d==="__v_raw")return _===(T?C?LE:PE:C?kE:IE).get(l)||Object.getPrototypeOf(l)===Object.getPrototypeOf(_)?l:void 0;const P=Oi(l);if(!T){let s;if(P&&(s=CI[d]))return s;if(d==="hasOwnProperty")return II}const V=Reflect.get(l,d,Ln(l)?l:_);return(Ul(d)?SE.has(d):MI(d))||(T||fo(l,"get",d),C)?V:Ln(V)?P&&pb(d)?V:V.value:gn(V)?T?bb(V):dm(V):V}}class AE extends CE{constructor(l=!1){super(!1,l)}set(l,d,_,T){let C=l[d];if(!this._isShallow){const s=qu(C);if(!Ba(_)&&!qu(_)&&(C=Ir(C),_=Ir(_)),!Oi(l)&&Ln(C)&&!Ln(_))return s?!1:(C.value=_,!0)}const P=Oi(l)&&pb(d)?Number(d)<l.length:tn(l,d),V=Reflect.set(l,d,_,Ln(l)?l:T);return l===Ir(T)&&(P?zo(_,C)&&wh(l,"set",d,_):wh(l,"add",d,_)),V}deleteProperty(l,d){const _=tn(l,d);l[d];const T=Reflect.deleteProperty(l,d);return T&&_&&wh(l,"delete",d,void 0),T}has(l,d){const _=Reflect.has(l,d);return(!Ul(d)||!SE.has(d))&&fo(l,"has",d),_}ownKeys(l){return fo(l,"iterate",Oi(l)?"length":Af),Reflect.ownKeys(l)}}class ME extends CE{constructor(l=!1){super(!0,l)}set(l,d){return!0}deleteProperty(l,d){return!0}}const kI=new AE,PI=new ME,LI=new AE(!0),DI=new ME(!0),C0=t=>t,Ty=t=>Reflect.getPrototypeOf(t);function OI(t,l,d){return function(..._){const T=this.__v_raw,C=Ir(T),P=Jp(C),V=t==="entries"||t===Symbol.iterator&&P,s=t==="keys"&&P,$=T[t](..._),Z=d?C0:l?A0:po;return!l&&fo(C,"iterate",s?S0:Af),{next(){const{value:J,done:ne}=$.next();return ne?{value:J,done:ne}:{value:V?[Z(J[0]),Z(J[1])]:Z(J),done:ne}},[Symbol.iterator](){return this}}}}function Ey(t){return function(...l){return t==="delete"?!1:t==="clear"?void 0:this}}function RI(t,l){const d={get(T){const C=this.__v_raw,P=Ir(C),V=Ir(T);t||(zo(T,V)&&fo(P,"get",T),fo(P,"get",V));const{has:s}=Ty(P),$=l?C0:t?A0:po;if(s.call(P,T))return $(C.get(T));if(s.call(P,V))return $(C.get(V));C!==P&&C.get(T)},get size(){const T=this.__v_raw;return!t&&fo(Ir(T),"iterate",Af),Reflect.get(T,"size",T)},has(T){const C=this.__v_raw,P=Ir(C),V=Ir(T);return t||(zo(T,V)&&fo(P,"has",T),fo(P,"has",V)),T===V?C.has(T):C.has(T)||C.has(V)},forEach(T,C){const P=this,V=P.__v_raw,s=Ir(V),$=l?C0:t?A0:po;return!t&&fo(s,"iterate",Af),V.forEach((Z,J)=>T.call(C,$(Z),$(J),P))}};return Tn(d,t?{add:Ey("add"),set:Ey("set"),delete:Ey("delete"),clear:Ey("clear")}:{add(T){!l&&!Ba(T)&&!qu(T)&&(T=Ir(T));const C=Ir(this);return Ty(C).has.call(C,T)||(C.add(T),wh(C,"add",T,T)),this},set(T,C){!l&&!Ba(C)&&!qu(C)&&(C=Ir(C));const P=Ir(this),{has:V,get:s}=Ty(P);let $=V.call(P,T);$||(T=Ir(T),$=V.call(P,T));const Z=s.call(P,T);return P.set(T,C),$?zo(C,Z)&&wh(P,"set",T,C):wh(P,"add",T,C),this},delete(T){const C=Ir(this),{has:P,get:V}=Ty(C);let s=P.call(C,T);s||(T=Ir(T),s=P.call(C,T)),V&&V.call(C,T);const $=C.delete(T);return s&&wh(C,"delete",T,void 0),$},clear(){const T=Ir(this),C=T.size!==0,P=T.clear();return C&&wh(T,"clear",void 0,void 0),P}}),["keys","values","entries",Symbol.iterator].forEach(T=>{d[T]=OI(T,t,l)}),d}function yx(t,l){const d=RI(t,l);return(_,T,C)=>T==="__v_isReactive"?!t:T==="__v_isReadonly"?t:T==="__v_raw"?_:Reflect.get(tn(d,T)&&T in _?d:_,T,C)}const zI={get:yx(!1,!1)},BI={get:yx(!1,!0)},FI={get:yx(!0,!1)},NI={get:yx(!0,!0)},IE=new WeakMap,kE=new WeakMap,PE=new WeakMap,LE=new WeakMap;function UI(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function VI(t){return t.__v_skip||!Object.isExtensible(t)?0:UI(lI(t))}function dm(t){return qu(t)?t:xx(t,!1,kI,zI,IE)}function vb(t){return xx(t,!1,LI,BI,kE)}function bb(t){return xx(t,!0,PI,FI,PE)}function jI(t){return xx(t,!0,DI,NI,LE)}function xx(t,l,d,_,T){if(!gn(t)||t.__v_raw&&!(l&&t.__v_isReactive))return t;const C=T.get(t);if(C)return C;const P=VI(t);if(P===0)return t;const V=new Proxy(t,P===2?_:d);return T.set(t,V),V}function Nl(t){return qu(t)?Nl(t.__v_raw):!!(t&&t.__v_isReactive)}function qu(t){return!!(t&&t.__v_isReadonly)}function Ba(t){return!!(t&&t.__v_isShallow)}function vx(t){return t?!!t.__v_raw:!1}function Ir(t){const l=t&&t.__v_raw;return l?Ir(l):t}function bx(t){return!tn(t,"__v_skip")&&Object.isExtensible(t)&&fE(t,"__v_skip",!0),t}const po=t=>gn(t)?dm(t):t,A0=t=>gn(t)?bb(t):t;function Ln(t){return t?t.__v_isRef===!0:!1}function Ui(t){return DE(t,!1)}function a_(t){return DE(t,!0)}function DE(t,l){return Ln(t)?t:new $I(t,l)}class $I{constructor(l,d){this.dep=new gx,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=d?l:Ir(l),this._value=d?l:po(l),this.__v_isShallow=d}get value(){return this.dep.track(),this._value}set value(l){const d=this._rawValue,_=this.__v_isShallow||Ba(l)||qu(l);l=_?l:Ir(l),zo(l,d)&&(this._rawValue=l,this._value=_?l:po(l),this.dep.trigger())}}function GI(t){t.dep&&t.dep.trigger()}function ns(t){return Ln(t)?t.value:t}function WI(t){return er(t)?t():ns(t)}const HI={get:(t,l,d)=>l==="__v_raw"?t:ns(Reflect.get(t,l,d)),set:(t,l,d,_)=>{const T=t[l];return Ln(T)&&!Ln(d)?(T.value=d,!0):Reflect.set(t,l,d,_)}};function wb(t){return Nl(t)?t:new Proxy(t,HI)}class qI{constructor(l){this.__v_isRef=!0,this._value=void 0;const d=this.dep=new gx,{get:_,set:T}=l(d.track.bind(d),d.trigger.bind(d));this._get=_,this._set=T}get value(){return this._value=this._get()}set value(l){this._set(l)}}function OE(t){return new qI(t)}function RE(t){const l=Oi(t)?new Array(t.length):{};for(const d in t)l[d]=BE(t,d);return l}class XI{constructor(l,d,_){this._object=l,this._key=d,this._defaultValue=_,this.__v_isRef=!0,this._value=void 0}get value(){const l=this._object[this._key];return this._value=l===void 0?this._defaultValue:l}set value(l){this._object[this._key]=l}get dep(){return SI(Ir(this._object),this._key)}}class ZI{constructor(l){this._getter=l,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function zE(t,l,d){return Ln(t)?t:er(t)?new ZI(t):gn(t)&&arguments.length>1?BE(t,l,d):Ui(t)}function BE(t,l,d){const _=t[l];return Ln(_)?_:new XI(t,l,d)}class YI{constructor(l,d,_){this.fn=l,this.setter=d,this._value=void 0,this.dep=new gx(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Vg-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!d,this.isSSR=_}notify(){if(this.flags|=16,!(this.flags&8)&&kn!==this)return xE(this,!0),!0}get value(){const l=this.dep.track();return wE(this),l&&(l.version=this.dep.version),this._value}set value(l){this.setter&&this.setter(l)}}function KI(t,l,d=!1){let _,T;return er(t)?_=t:(_=t.get,T=t.set),new YI(_,T,d)}const JI={GET:"get",HAS:"has",ITERATE:"iterate"},QI={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},Sy={},Xy=new WeakMap;let Uu;function ek(){return Uu}function FE(t,l=!1,d=Uu){if(d){let _=Xy.get(d);_||Xy.set(d,_=[]),_.push(t)}}function tk(t,l,d=Fr){const{immediate:_,deep:T,once:C,scheduler:P,augmentJob:V,call:s}=d,$=ge=>T?ge:Ba(ge)||T===!1||T===0?Th(ge,1):Th(ge);let Z,J,ne,ue,we=!1,Me=!1;if(Ln(t)?(J=()=>t.value,we=Ba(t)):Nl(t)?(J=()=>$(t),we=!0):Oi(t)?(Me=!0,we=t.some(ge=>Nl(ge)||Ba(ge)),J=()=>t.map(ge=>{if(Ln(ge))return ge.value;if(Nl(ge))return $(ge);if(er(ge))return s?s(ge,2):ge()})):er(t)?l?J=s?()=>s(t,2):t:J=()=>{if(ne){Yu();try{ne()}finally{Ku()}}const ge=Uu;Uu=Z;try{return s?s(t,3,[ue]):t(ue)}finally{Uu=ge}}:J=nl,l&&T){const ge=J,Oe=T===!0?1/0:T;J=()=>Th(ge(),Oe)}const Ye=gb(),Ze=()=>{Z.stop(),Ye&&Ye.active&&db(Ye.effects,Z)};if(C&&l){const ge=l;l=(...Oe)=>{ge(...Oe),Ze()}}let Fe=Me?new Array(t.length).fill(Sy):Sy;const ae=ge=>{if(!(!(Z.flags&1)||!Z.dirty&&!ge))if(l){const Oe=Z.run();if(T||we||(Me?Oe.some((ze,rt)=>zo(ze,Fe[rt])):zo(Oe,Fe))){ne&&ne();const ze=Uu;Uu=Z;try{const rt=[Oe,Fe===Sy?void 0:Me&&Fe[0]===Sy?[]:Fe,ue];s?s(l,3,rt):l(...rt),Fe=Oe}finally{Uu=ze}}}else Z.run()};return V&&V(ae),Z=new Ug(J),Z.scheduler=P?()=>P(ae,!1):ae,ue=ge=>FE(ge,!1,Z),ne=Z.onStop=()=>{const ge=Xy.get(Z);if(ge){if(s)s(ge,4);else for(const Oe of ge)Oe();Xy.delete(Z)}},l?_?ae(!0):Fe=Z.run():P?P(ae.bind(null,!0),!0):Z.run(),Ze.pause=Z.pause.bind(Z),Ze.resume=Z.resume.bind(Z),Ze.stop=Ze,Ze}function Th(t,l=1/0,d){if(l<=0||!gn(t)||t.__v_skip||(d=d||new Set,d.has(t)))return t;if(d.add(t),l--,Ln(t))Th(t.value,l,d);else if(Oi(t))for(let _=0;_<t.length;_++)Th(t[_],l,d);else if(Of(t)||Jp(t))t.forEach(_=>{Th(_,l,d)});else if(ux(t)){for(const _ in t)Th(t[_],l,d);for(const _ of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,_)&&Th(t[_],l,d)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const NE=[];function ik(t){NE.push(t)}function rk(){NE.pop()}function nk(t,l){}const sk={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},ok={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function fm(t,l,d,_){try{return _?t(..._):t()}catch(T){Rf(T,l,d)}}function ol(t,l,d,_){if(er(t)){const T=fm(t,l,d,_);return T&&fb(T)&&T.catch(C=>{Rf(C,l,d)}),T}if(Oi(t)){const T=[];for(let C=0;C<t.length;C++)T.push(ol(t[C],l,d,_));return T}}function Rf(t,l,d,_=!0){const T=l?l.vnode:null,{errorHandler:C,throwUnhandledErrorInProduction:P}=l&&l.appContext.config||Fr;if(l){let V=l.parent;const s=l.proxy,$=`https://vuejs.org/error-reference/#runtime-${d}`;for(;V;){const Z=V.ec;if(Z){for(let J=0;J<Z.length;J++)if(Z[J](t,s,$)===!1)return}V=V.parent}if(C){Yu(),fm(C,null,10,[t,s,$]),Ku();return}}ak(t,d,T,_,P)}function ak(t,l,d,_=!0,T=!1){if(T)throw t;console.error(t)}const Bo=[];let Ic=-1;const tm=[];let Vu=null,Wp=0;const UE=Promise.resolve();let Zy=null;function zf(t){const l=Zy||UE;return t?l.then(this?t.bind(this):t):l}function lk(t){let l=Ic+1,d=Bo.length;for(;l<d;){const _=l+d>>>1,T=Bo[_],C=Gg(T);C<t||C===t&&T.flags&2?l=_+1:d=_}return l}function Tb(t){if(!(t.flags&1)){const l=Gg(t),d=Bo[Bo.length-1];!d||!(t.flags&2)&&l>=Gg(d)?Bo.push(t):Bo.splice(lk(l),0,t),t.flags|=1,VE()}}function VE(){Zy||(Zy=UE.then(jE))}function $g(t){Oi(t)?tm.push(...t):Vu&&t.id===-1?Vu.splice(Wp+1,0,t):t.flags&1||(tm.push(t),t.flags|=1),VE()}function hw(t,l,d=Ic+1){for(;d<Bo.length;d++){const _=Bo[d];if(_&&_.flags&2){if(t&&_.id!==t.uid)continue;Bo.splice(d,1),d--,_.flags&4&&(_.flags&=-2),_(),_.flags&4||(_.flags&=-2)}}}function Yy(t){if(tm.length){const l=[...new Set(tm)].sort((d,_)=>Gg(d)-Gg(_));if(tm.length=0,Vu){Vu.push(...l);return}for(Vu=l,Wp=0;Wp<Vu.length;Wp++){const d=Vu[Wp];d.flags&4&&(d.flags&=-2),d.flags&8||d(),d.flags&=-2}Vu=null,Wp=0}}const Gg=t=>t.id==null?t.flags&2?-1:1/0:t.id;function jE(t){try{for(Ic=0;Ic<Bo.length;Ic++){const l=Bo[Ic];l&&!(l.flags&8)&&(l.flags&4&&(l.flags&=-2),fm(l,l.i,l.i?15:14),l.flags&4||(l.flags&=-2))}}finally{for(;Ic<Bo.length;Ic++){const l=Bo[Ic];l&&(l.flags&=-2)}Ic=-1,Bo.length=0,Yy(),Zy=null,(Bo.length||tm.length)&&jE()}}let Hp,Cy=[];function $E(t,l){var d,_;Hp=t,Hp?(Hp.enabled=!0,Cy.forEach(({event:T,args:C})=>Hp.emit(T,...C)),Cy=[]):typeof window<"u"&&window.HTMLElement&&!((_=(d=window.navigator)==null?void 0:d.userAgent)!=null&&_.includes("jsdom"))?((l.__VUE_DEVTOOLS_HOOK_REPLAY__=l.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(C=>{$E(C,l)}),setTimeout(()=>{Hp||(l.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Cy=[])},3e3)):Cy=[]}let Is=null,wx=null;function Wg(t){const l=Is;return Is=t,wx=t&&t.type.__scopeId||null,l}function ck(t){wx=t}function hk(){wx=null}const uk=t=>Ns;function Ns(t,l=Is,d){if(!l||t._n)return t;const _=(...T)=>{_._d&&R0(-1);const C=Wg(l);let P;try{P=t(...T)}finally{Wg(C),_._d&&R0(1)}return P};return _._n=!0,_._c=!0,_._d=!0,_}function uo(t,l){if(Is===null)return t;const d=d_(Is),_=t.dirs||(t.dirs=[]);for(let T=0;T<l.length;T++){let[C,P,V,s=Fr]=l[T];C&&(er(C)&&(C={mounted:C,updated:C}),C.deep&&Th(P),_.push({dir:C,instance:d,value:P,oldValue:void 0,arg:V,modifiers:s}))}return t}function kc(t,l,d,_){const T=t.dirs,C=l&&l.dirs;for(let P=0;P<T.length;P++){const V=T[P];C&&(V.oldValue=C[P].value);let s=V.dir[_];s&&(Yu(),ol(s,d,8,[t.el,V,t,l]),Ku())}}const GE=Symbol("_vte"),WE=t=>t.__isTeleport,Lg=t=>t&&(t.disabled||t.disabled===""),uw=t=>t&&(t.defer||t.defer===""),dw=t=>typeof SVGElement<"u"&&t instanceof SVGElement,fw=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,M0=(t,l)=>{const d=t&&t.to;return Dn(d)?l?l(d):null:d},HE={name:"Teleport",__isTeleport:!0,process(t,l,d,_,T,C,P,V,s,$){const{mc:Z,pc:J,pbc:ne,o:{insert:ue,querySelector:we,createText:Me,createComment:Ye}}=$,Ze=Lg(l.props);let{shapeFlag:Fe,children:ae,dynamicChildren:ge}=l;if(t==null){const Oe=l.el=Me(""),ze=l.anchor=Me("");ue(Oe,d,_),ue(ze,d,_);const rt=(Je,He)=>{Fe&16&&(T&&T.isCE&&(T.ce._teleportTarget=Je),Z(ae,Je,He,T,C,P,V,s))},Ie=()=>{const Je=l.target=M0(l.props,we),He=qE(Je,l,Me,ue);Je&&(P!=="svg"&&dw(Je)?P="svg":P!=="mathml"&&fw(Je)&&(P="mathml"),Ze||(rt(Je,He),Ry(l,!1)))};Ze&&(rt(d,ze),Ry(l,!0)),uw(l.props)?As(()=>{Ie(),l.el.__isMounted=!0},C):Ie()}else{if(uw(l.props)&&!t.el.__isMounted){As(()=>{HE.process(t,l,d,_,T,C,P,V,s,$),delete t.el.__isMounted},C);return}l.el=t.el,l.targetStart=t.targetStart;const Oe=l.anchor=t.anchor,ze=l.target=t.target,rt=l.targetAnchor=t.targetAnchor,Ie=Lg(t.props),Je=Ie?d:ze,He=Ie?Oe:rt;if(P==="svg"||dw(ze)?P="svg":(P==="mathml"||fw(ze))&&(P="mathml"),ge?(ne(t.dynamicChildren,ge,Je,T,C,P,V),Ob(t,l,!0)):s||J(t,l,Je,He,T,C,P,V,!1),Ze)Ie?l.props&&t.props&&l.props.to!==t.props.to&&(l.props.to=t.props.to):Ay(l,d,Oe,$,1);else if((l.props&&l.props.to)!==(t.props&&t.props.to)){const ti=l.target=M0(l.props,we);ti&&Ay(l,ti,null,$,0)}else Ie&&Ay(l,ze,rt,$,1);Ry(l,Ze)}},remove(t,l,d,{um:_,o:{remove:T}},C){const{shapeFlag:P,children:V,anchor:s,targetStart:$,targetAnchor:Z,target:J,props:ne}=t;if(J&&(T($),T(Z)),C&&T(s),P&16){const ue=C||!Lg(ne);for(let we=0;we<V.length;we++){const Me=V[we];_(Me,l,d,ue,!!Me.dynamicChildren)}}},move:Ay,hydrate:dk};function Ay(t,l,d,{o:{insert:_},m:T},C=2){C===0&&_(t.targetAnchor,l,d);const{el:P,anchor:V,shapeFlag:s,children:$,props:Z}=t,J=C===2;if(J&&_(P,l,d),(!J||Lg(Z))&&s&16)for(let ne=0;ne<$.length;ne++)T($[ne],l,d,2);J&&_(V,l,d)}function dk(t,l,d,_,T,C,{o:{nextSibling:P,parentNode:V,querySelector:s,insert:$,createText:Z}},J){const ne=l.target=M0(l.props,s);if(ne){const ue=Lg(l.props),we=ne._lpa||ne.firstChild;if(l.shapeFlag&16)if(ue)l.anchor=J(P(t),l,V(t),d,_,T,C),l.targetStart=we,l.targetAnchor=we&&P(we);else{l.anchor=P(t);let Me=we;for(;Me;){if(Me&&Me.nodeType===8){if(Me.data==="teleport start anchor")l.targetStart=Me;else if(Me.data==="teleport anchor"){l.targetAnchor=Me,ne._lpa=l.targetAnchor&&P(l.targetAnchor);break}}Me=P(Me)}l.targetAnchor||qE(ne,l,Z,$),J(we&&P(we),l,ne,d,_,T,C)}Ry(l,ue)}return l.anchor&&P(l.anchor)}const fk=HE;function Ry(t,l){const d=t.ctx;if(d&&d.ut){let _,T;for(l?(_=t.el,T=t.anchor):(_=t.targetStart,T=t.targetAnchor);_&&_!==T;)_.nodeType===1&&_.setAttribute("data-v-owner",d.uid),_=_.nextSibling;d.ut()}}function qE(t,l,d,_){const T=l.targetStart=d(""),C=l.targetAnchor=d("");return T[GE]=C,t&&(_(T,t),_(C,t)),C}const ju=Symbol("_leaveCb"),My=Symbol("_enterCb");function Eb(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Dh(()=>{t.isMounted=!0}),Cx(()=>{t.isUnmounting=!0}),t}const tl=[Function,Array],Sb={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:tl,onEnter:tl,onAfterEnter:tl,onEnterCancelled:tl,onBeforeLeave:tl,onLeave:tl,onAfterLeave:tl,onLeaveCancelled:tl,onBeforeAppear:tl,onAppear:tl,onAfterAppear:tl,onAppearCancelled:tl},XE=t=>{const l=t.subTree;return l.component?XE(l.component):l},pk={name:"BaseTransition",props:Sb,setup(t,{slots:l}){const d=Zs(),_=Eb();return()=>{const T=l.default&&Tx(l.default(),!0);if(!T||!T.length)return;const C=ZE(T),P=Ir(t),{mode:V}=P;if(_.isLeaving)return n0(C);const s=pw(C);if(!s)return n0(C);let $=rm(s,P,_,d,J=>$=J);s.type!==ws&&kh(s,$);let Z=d.subTree&&pw(d.subTree);if(Z&&Z.type!==ws&&!Ol(s,Z)&&XE(d).type!==ws){let J=rm(Z,P,_,d);if(kh(Z,J),V==="out-in"&&s.type!==ws)return _.isLeaving=!0,J.afterLeave=()=>{_.isLeaving=!1,d.job.flags&8||d.update(),delete J.afterLeave,Z=void 0},n0(C);V==="in-out"&&s.type!==ws?J.delayLeave=(ne,ue,we)=>{const Me=KE(_,Z);Me[String(Z.key)]=Z,ne[ju]=()=>{ue(),ne[ju]=void 0,delete $.delayedLeave,Z=void 0},$.delayedLeave=()=>{we(),delete $.delayedLeave,Z=void 0}}:Z=void 0}else Z&&(Z=void 0);return C}}};function ZE(t){let l=t[0];if(t.length>1){for(const d of t)if(d.type!==ws){l=d;break}}return l}const YE=pk;function KE(t,l){const{leavingVNodes:d}=t;let _=d.get(l.type);return _||(_=Object.create(null),d.set(l.type,_)),_}function rm(t,l,d,_,T){const{appear:C,mode:P,persisted:V=!1,onBeforeEnter:s,onEnter:$,onAfterEnter:Z,onEnterCancelled:J,onBeforeLeave:ne,onLeave:ue,onAfterLeave:we,onLeaveCancelled:Me,onBeforeAppear:Ye,onAppear:Ze,onAfterAppear:Fe,onAppearCancelled:ae}=l,ge=String(t.key),Oe=KE(d,t),ze=(Je,He)=>{Je&&ol(Je,_,9,He)},rt=(Je,He)=>{const ti=He[1];ze(Je,He),Oi(Je)?Je.every(bt=>bt.length<=1)&&ti():Je.length<=1&&ti()},Ie={mode:P,persisted:V,beforeEnter(Je){let He=s;if(!d.isMounted)if(C)He=Ye||s;else return;Je[ju]&&Je[ju](!0);const ti=Oe[ge];ti&&Ol(t,ti)&&ti.el[ju]&&ti.el[ju](),ze(He,[Je])},enter(Je){let He=$,ti=Z,bt=J;if(!d.isMounted)if(C)He=Ze||$,ti=Fe||Z,bt=ae||J;else return;let wt=!1;const xt=Je[My]=Tt=>{wt||(wt=!0,Tt?ze(bt,[Je]):ze(ti,[Je]),Ie.delayedLeave&&Ie.delayedLeave(),Je[My]=void 0)};He?rt(He,[Je,xt]):xt()},leave(Je,He){const ti=String(t.key);if(Je[My]&&Je[My](!0),d.isUnmounting)return He();ze(ne,[Je]);let bt=!1;const wt=Je[ju]=xt=>{bt||(bt=!0,He(),xt?ze(Me,[Je]):ze(we,[Je]),Je[ju]=void 0,Oe[ti]===t&&delete Oe[ti])};Oe[ti]=t,ue?rt(ue,[Je,wt]):wt()},clone(Je){const He=rm(Je,l,d,_,T);return T&&T(He),He}};return Ie}function n0(t){if(l_(t))return t=Oc(t),t.children=null,t}function pw(t){if(!l_(t))return WE(t.type)&&t.children?ZE(t.children):t;const{shapeFlag:l,children:d}=t;if(d){if(l&16)return d[0];if(l&32&&er(d.default))return d.default()}}function kh(t,l){t.shapeFlag&6&&t.component?(t.transition=l,kh(t.component.subTree,l)):t.shapeFlag&128?(t.ssContent.transition=l.clone(t.ssContent),t.ssFallback.transition=l.clone(t.ssFallback)):t.transition=l}function Tx(t,l=!1,d){let _=[],T=0;for(let C=0;C<t.length;C++){let P=t[C];const V=d==null?P.key:String(d)+String(P.key!=null?P.key:C);P.type===jr?(P.patchFlag&128&&T++,_=_.concat(Tx(P.children,l,V))):(l||P.type!==ws)&&_.push(V!=null?Oc(P,{key:V}):P)}if(T>1)for(let C=0;C<_.length;C++)_[C].patchFlag=-2;return _}/*! #__NO_SIDE_EFFECTS__ */function On(t,l){return er(t)?Tn({name:t.name},l,{setup:t}):t}function mk(){const t=Zs();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function Cb(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function gk(t){const l=Zs(),d=a_(null);if(l){const T=l.refs===Fr?l.refs={}:l.refs;Object.defineProperty(T,t,{enumerable:!0,get:()=>d.value,set:C=>d.value=C})}return d}function Hg(t,l,d,_,T=!1){if(Oi(t)){t.forEach((we,Me)=>Hg(we,l&&(Oi(l)?l[Me]:l),d,_,T));return}if(Wu(_)&&!T){_.shapeFlag&512&&_.type.__asyncResolved&&_.component.subTree.component&&Hg(t,l,d,_.component.subTree);return}const C=_.shapeFlag&4?d_(_.component):_.el,P=T?null:C,{i:V,r:s}=t,$=l&&l.r,Z=V.refs===Fr?V.refs={}:V.refs,J=V.setupState,ne=Ir(J),ue=J===Fr?()=>!1:we=>tn(ne,we);if($!=null&&$!==s&&(Dn($)?(Z[$]=null,ue($)&&(J[$]=null)):Ln($)&&($.value=null)),er(s))fm(s,V,12,[P,Z]);else{const we=Dn(s),Me=Ln(s);if(we||Me){const Ye=()=>{if(t.f){const Ze=we?ue(s)?J[s]:Z[s]:s.value;T?Oi(Ze)&&db(Ze,C):Oi(Ze)?Ze.includes(C)||Ze.push(C):we?(Z[s]=[C],ue(s)&&(J[s]=Z[s])):(s.value=[C],t.k&&(Z[t.k]=s.value))}else we?(Z[s]=P,ue(s)&&(J[s]=P)):Me&&(s.value=P,t.k&&(Z[t.k]=P))};P?(Ye.id=-1,As(Ye,d)):Ye()}}}let mw=!1;const $p=()=>{mw||(console.error("Hydration completed but contains mismatches."),mw=!0)},_k=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",yk=t=>t.namespaceURI.includes("MathML"),Iy=t=>{if(t.nodeType===1){if(_k(t))return"svg";if(yk(t))return"mathml"}},Zp=t=>t.nodeType===8;function xk(t){const{mt:l,p:d,o:{patchProp:_,createText:T,nextSibling:C,parentNode:P,remove:V,insert:s,createComment:$}}=t,Z=(ae,ge)=>{if(!ge.hasChildNodes()){d(null,ae,ge),Yy(),ge._vnode=ae;return}J(ge.firstChild,ae,null,null,null),Yy(),ge._vnode=ae},J=(ae,ge,Oe,ze,rt,Ie=!1)=>{Ie=Ie||!!ge.dynamicChildren;const Je=Zp(ae)&&ae.data==="[",He=()=>Me(ae,ge,Oe,ze,rt,Je),{type:ti,ref:bt,shapeFlag:wt,patchFlag:xt}=ge;let Tt=ae.nodeType;ge.el=ae,xt===-2&&(Ie=!1,ge.dynamicChildren=null);let vt=null;switch(ti){case Mh:Tt!==3?ge.children===""?(s(ge.el=T(""),P(ae),ae),vt=ae):vt=He():(ae.data!==ge.children&&($p(),ae.data=ge.children),vt=C(ae));break;case ws:Fe(ae)?(vt=C(ae),Ze(ge.el=ae.content.firstChild,ae,Oe)):Tt!==8||Je?vt=He():vt=C(ae);break;case If:if(Je&&(ae=C(ae),Tt=ae.nodeType),Tt===1||Tt===3){vt=ae;const ai=!ge.children.length;for(let yi=0;yi<ge.staticCount;yi++)ai&&(ge.children+=vt.nodeType===1?vt.outerHTML:vt.data),yi===ge.staticCount-1&&(ge.anchor=vt),vt=C(vt);return Je?C(vt):vt}else He();break;case jr:Je?vt=we(ae,ge,Oe,ze,rt,Ie):vt=He();break;default:if(wt&1)(Tt!==1||ge.type.toLowerCase()!==ae.tagName.toLowerCase())&&!Fe(ae)?vt=He():vt=ne(ae,ge,Oe,ze,rt,Ie);else if(wt&6){ge.slotScopeIds=rt;const ai=P(ae);if(Je?vt=Ye(ae):Zp(ae)&&ae.data==="teleport start"?vt=Ye(ae,ae.data,"teleport end"):vt=C(ae),l(ge,ai,null,Oe,ze,Iy(ai),Ie),Wu(ge)&&!ge.type.__asyncResolved){let yi;Je?(yi=fr(jr),yi.anchor=vt?vt.previousSibling:ai.lastChild):yi=ae.nodeType===3?Vs(""):fr("div"),yi.el=ae,ge.component.subTree=yi}}else wt&64?Tt!==8?vt=He():vt=ge.type.hydrate(ae,ge,Oe,ze,rt,Ie,t,ue):wt&128&&(vt=ge.type.hydrate(ae,ge,Oe,ze,Iy(P(ae)),rt,Ie,t,J))}return bt!=null&&Hg(bt,null,ze,ge),vt},ne=(ae,ge,Oe,ze,rt,Ie)=>{Ie=Ie||!!ge.dynamicChildren;const{type:Je,props:He,patchFlag:ti,shapeFlag:bt,dirs:wt,transition:xt}=ge,Tt=Je==="input"||Je==="option";if(Tt||ti!==-1){wt&&kc(ge,null,Oe,"created");let vt=!1;if(Fe(ae)){vt=ES(null,xt)&&Oe&&Oe.vnode.props&&Oe.vnode.props.appear;const yi=ae.content.firstChild;vt&&xt.beforeEnter(yi),Ze(yi,ae,Oe),ge.el=ae=yi}if(bt&16&&!(He&&(He.innerHTML||He.textContent))){let yi=ue(ae.firstChild,ge,ae,Oe,ze,rt,Ie);for(;yi;){ky(ae,1)||$p();const xi=yi;yi=yi.nextSibling,V(xi)}}else if(bt&8){let yi=ge.children;yi[0]===`
`&&(ae.tagName==="PRE"||ae.tagName==="TEXTAREA")&&(yi=yi.slice(1)),ae.textContent!==yi&&(ky(ae,0)||$p(),ae.textContent=ge.children)}if(He){if(Tt||!Ie||ti&48){const yi=ae.tagName.includes("-");for(const xi in He)(Tt&&(xi.endsWith("value")||xi==="indeterminate")||s_(xi)&&!Qp(xi)||xi[0]==="."||yi)&&_(ae,xi,null,He[xi],void 0,Oe)}else if(He.onClick)_(ae,"onClick",null,He.onClick,void 0,Oe);else if(ti&4&&Nl(He.style))for(const yi in He.style)He.style[yi]}let ai;(ai=He&&He.onVnodeBeforeMount)&&sa(ai,Oe,ge),wt&&kc(ge,null,Oe,"beforeMount"),((ai=He&&He.onVnodeMounted)||wt||vt)&&DS(()=>{ai&&sa(ai,Oe,ge),vt&&xt.enter(ae),wt&&kc(ge,null,Oe,"mounted")},ze)}return ae.nextSibling},ue=(ae,ge,Oe,ze,rt,Ie,Je)=>{Je=Je||!!ge.dynamicChildren;const He=ge.children,ti=He.length;for(let bt=0;bt<ti;bt++){const wt=Je?He[bt]:He[bt]=oa(He[bt]),xt=wt.type===Mh;ae?(xt&&!Je&&bt+1<ti&&oa(He[bt+1]).type===Mh&&(s(T(ae.data.slice(wt.children.length)),Oe,C(ae)),ae.data=wt.children),ae=J(ae,wt,ze,rt,Ie,Je)):xt&&!wt.children?s(wt.el=T(""),Oe):(ky(Oe,1)||$p(),d(null,wt,Oe,null,ze,rt,Iy(Oe),Ie))}return ae},we=(ae,ge,Oe,ze,rt,Ie)=>{const{slotScopeIds:Je}=ge;Je&&(rt=rt?rt.concat(Je):Je);const He=P(ae),ti=ue(C(ae),ge,He,Oe,ze,rt,Ie);return ti&&Zp(ti)&&ti.data==="]"?C(ge.anchor=ti):($p(),s(ge.anchor=$("]"),He,ti),ti)},Me=(ae,ge,Oe,ze,rt,Ie)=>{if(ky(ae.parentElement,1)||$p(),ge.el=null,Ie){const ti=Ye(ae);for(;;){const bt=C(ae);if(bt&&bt!==ti)V(bt);else break}}const Je=C(ae),He=P(ae);return V(ae),d(null,ge,He,Je,Oe,ze,Iy(He),rt),Oe&&(Oe.vnode.el=ge.el,Ix(Oe,ge.el)),Je},Ye=(ae,ge="[",Oe="]")=>{let ze=0;for(;ae;)if(ae=C(ae),ae&&Zp(ae)&&(ae.data===ge&&ze++,ae.data===Oe)){if(ze===0)return C(ae);ze--}return ae},Ze=(ae,ge,Oe)=>{const ze=ge.parentNode;ze&&ze.replaceChild(ae,ge);let rt=Oe;for(;rt;)rt.vnode.el===ge&&(rt.vnode.el=rt.subTree.el=ae),rt=rt.parent},Fe=ae=>ae.nodeType===1&&ae.tagName==="TEMPLATE";return[Z,J]}const gw="data-allow-mismatch",vk={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function ky(t,l){if(l===0||l===1)for(;t&&!t.hasAttribute(gw);)t=t.parentElement;const d=t&&t.getAttribute(gw);if(d==null)return!1;if(d==="")return!0;{const _=d.split(",");return l===0&&_.includes("children")?!0:d.split(",").includes(vk[l])}}const bk=fx().requestIdleCallback||(t=>setTimeout(t,1)),wk=fx().cancelIdleCallback||(t=>clearTimeout(t)),Tk=(t=1e4)=>l=>{const d=bk(l,{timeout:t});return()=>wk(d)};function Ek(t){const{top:l,left:d,bottom:_,right:T}=t.getBoundingClientRect(),{innerHeight:C,innerWidth:P}=window;return(l>0&&l<C||_>0&&_<C)&&(d>0&&d<P||T>0&&T<P)}const Sk=t=>(l,d)=>{const _=new IntersectionObserver(T=>{for(const C of T)if(C.isIntersecting){_.disconnect(),l();break}},t);return d(T=>{if(T instanceof Element){if(Ek(T))return l(),_.disconnect(),!1;_.observe(T)}}),()=>_.disconnect()},Ck=t=>l=>{if(t){const d=matchMedia(t);if(d.matches)l();else return d.addEventListener("change",l,{once:!0}),()=>d.removeEventListener("change",l)}},Ak=(t=[])=>(l,d)=>{Dn(t)&&(t=[t]);let _=!1;const T=P=>{_||(_=!0,C(),l(),P.target.dispatchEvent(new P.constructor(P.type,P)))},C=()=>{d(P=>{for(const V of t)P.removeEventListener(V,T)})};return d(P=>{for(const V of t)P.addEventListener(V,T,{once:!0})}),C};function Mk(t,l){if(Zp(t)&&t.data==="["){let d=1,_=t.nextSibling;for(;_;){if(_.nodeType===1){if(l(_)===!1)break}else if(Zp(_))if(_.data==="]"){if(--d===0)break}else _.data==="["&&d++;_=_.nextSibling}}else l(t)}const Wu=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function Ik(t){er(t)&&(t={loader:t});const{loader:l,loadingComponent:d,errorComponent:_,delay:T=200,hydrate:C,timeout:P,suspensible:V=!0,onError:s}=t;let $=null,Z,J=0;const ne=()=>(J++,$=null,ue()),ue=()=>{let we;return $||(we=$=l().catch(Me=>{if(Me=Me instanceof Error?Me:new Error(String(Me)),s)return new Promise((Ye,Ze)=>{s(Me,()=>Ye(ne()),()=>Ze(Me),J+1)});throw Me}).then(Me=>we!==$&&$?$:(Me&&(Me.__esModule||Me[Symbol.toStringTag]==="Module")&&(Me=Me.default),Z=Me,Me)))};return On({name:"AsyncComponentWrapper",__asyncLoader:ue,__asyncHydrate(we,Me,Ye){const Ze=C?()=>{const Fe=C(Ye,ae=>Mk(we,ae));Fe&&(Me.bum||(Me.bum=[])).push(Fe)}:Ye;Z?Ze():ue().then(()=>!Me.isUnmounted&&Ze())},get __asyncResolved(){return Z},setup(){const we=Ms;if(Cb(we),Z)return()=>s0(Z,we);const Me=ae=>{$=null,Rf(ae,we,13,!_)};if(V&&we.suspense||nm)return ue().then(ae=>()=>s0(ae,we)).catch(ae=>(Me(ae),()=>_?fr(_,{error:ae}):null));const Ye=Ui(!1),Ze=Ui(),Fe=Ui(!!T);return T&&setTimeout(()=>{Fe.value=!1},T),P!=null&&setTimeout(()=>{if(!Ye.value&&!Ze.value){const ae=new Error(`Async component timed out after ${P}ms.`);Me(ae),Ze.value=ae}},P),ue().then(()=>{Ye.value=!0,we.parent&&l_(we.parent.vnode)&&we.parent.update()}).catch(ae=>{Me(ae),Ze.value=ae}),()=>{if(Ye.value&&Z)return s0(Z,we);if(Ze.value&&_)return fr(_,{error:Ze.value});if(d&&!Fe.value)return fr(d)}}})}function s0(t,l){const{ref:d,props:_,children:T,ce:C}=l.vnode,P=fr(t,_,T);return P.ref=d,P.ce=C,delete l.vnode.ce,P}const l_=t=>t.type.__isKeepAlive,kk={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:l}){const d=Zs(),_=d.ctx;if(!_.renderer)return()=>{const Fe=l.default&&l.default();return Fe&&Fe.length===1?Fe[0]:Fe};const T=new Map,C=new Set;let P=null;const V=d.suspense,{renderer:{p:s,m:$,um:Z,o:{createElement:J}}}=_,ne=J("div");_.activate=(Fe,ae,ge,Oe,ze)=>{const rt=Fe.component;$(Fe,ae,ge,0,V),s(rt.vnode,Fe,ae,ge,rt,V,Oe,Fe.slotScopeIds,ze),As(()=>{rt.isDeactivated=!1,rt.a&&em(rt.a);const Ie=Fe.props&&Fe.props.onVnodeMounted;Ie&&sa(Ie,rt.parent,Fe)},V)},_.deactivate=Fe=>{const ae=Fe.component;Jy(ae.m),Jy(ae.a),$(Fe,ne,null,1,V),As(()=>{ae.da&&em(ae.da);const ge=Fe.props&&Fe.props.onVnodeUnmounted;ge&&sa(ge,ae.parent,Fe),ae.isDeactivated=!0},V)};function ue(Fe){o0(Fe),Z(Fe,d,V,!0)}function we(Fe){T.forEach((ae,ge)=>{const Oe=U0(ae.type);Oe&&!Fe(Oe)&&Me(ge)})}function Me(Fe){const ae=T.get(Fe);ae&&(!P||!Ol(ae,P))?ue(ae):P&&o0(P),T.delete(Fe),C.delete(Fe)}ca(()=>[t.include,t.exclude],([Fe,ae])=>{Fe&&we(ge=>Ag(Fe,ge)),ae&&we(ge=>!Ag(ae,ge))},{flush:"post",deep:!0});let Ye=null;const Ze=()=>{Ye!=null&&(Qy(d.subTree.type)?As(()=>{T.set(Ye,Py(d.subTree))},d.subTree.suspense):T.set(Ye,Py(d.subTree)))};return Dh(Ze),Sx(Ze),Cx(()=>{T.forEach(Fe=>{const{subTree:ae,suspense:ge}=d,Oe=Py(ae);if(Fe.type===Oe.type&&Fe.key===Oe.key){o0(Oe);const ze=Oe.component.da;ze&&As(ze,ge);return}ue(Fe)})}),()=>{if(Ye=null,!l.default)return P=null;const Fe=l.default(),ae=Fe[0];if(Fe.length>1)return P=null,Fe;if(!Ph(ae)||!(ae.shapeFlag&4)&&!(ae.shapeFlag&128))return P=null,ae;let ge=Py(ae);if(ge.type===ws)return P=null,ge;const Oe=ge.type,ze=U0(Wu(ge)?ge.type.__asyncResolved||{}:Oe),{include:rt,exclude:Ie,max:Je}=t;if(rt&&(!ze||!Ag(rt,ze))||Ie&&ze&&Ag(Ie,ze))return ge.shapeFlag&=-257,P=ge,ae;const He=ge.key==null?Oe:ge.key,ti=T.get(He);return ge.el&&(ge=Oc(ge),ae.shapeFlag&128&&(ae.ssContent=ge)),Ye=He,ti?(ge.el=ti.el,ge.component=ti.component,ge.transition&&kh(ge,ge.transition),ge.shapeFlag|=512,C.delete(He),C.add(He)):(C.add(He),Je&&C.size>parseInt(Je,10)&&Me(C.values().next().value)),ge.shapeFlag|=256,P=ge,Qy(ae.type)?ae:ge}}},Pk=kk;function Ag(t,l){return Oi(t)?t.some(d=>Ag(d,l)):Dn(t)?t.split(",").includes(l):aI(t)?(t.lastIndex=0,t.test(l)):!1}function JE(t,l){eS(t,"a",l)}function QE(t,l){eS(t,"da",l)}function eS(t,l,d=Ms){const _=t.__wdc||(t.__wdc=()=>{let T=d;for(;T;){if(T.isDeactivated)return;T=T.parent}return t()});if(Ex(l,_,d),d){let T=d.parent;for(;T&&T.parent;)l_(T.parent.vnode)&&Lk(_,l,d,T),T=T.parent}}function Lk(t,l,d,_){const T=Ex(l,t,_,!0);c_(()=>{db(_[l],T)},d)}function o0(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Py(t){return t.shapeFlag&128?t.ssContent:t}function Ex(t,l,d=Ms,_=!1){if(d){const T=d[t]||(d[t]=[]),C=l.__weh||(l.__weh=(...P)=>{Yu();const V=Lf(d),s=ol(l,d,t,P);return V(),Ku(),s});return _?T.unshift(C):T.push(C),C}}const Lh=t=>(l,d=Ms)=>{(!nm||t==="sp")&&Ex(t,(..._)=>l(..._),d)},Ab=Lh("bm"),Dh=Lh("m"),Mb=Lh("bu"),Sx=Lh("u"),Cx=Lh("bum"),c_=Lh("um"),tS=Lh("sp"),iS=Lh("rtg"),rS=Lh("rtc");function nS(t,l=Ms){Ex("ec",t,l)}const Ib="components",Dk="directives";function Ah(t,l){return kb(Ib,t,!0,l)||t}const sS=Symbol.for("v-ndc");function Ax(t){return Dn(t)?kb(Ib,t,!1)||t:t||sS}function Ok(t){return kb(Dk,t)}function kb(t,l,d=!0,_=!1){const T=Is||Ms;if(T){const C=T.type;if(t===Ib){const V=U0(C,!1);if(V&&(V===l||V===qs(l)||V===o_(qs(l))))return C}const P=_w(T[t]||C[t],l)||_w(T.appContext[t],l);return!P&&_?C:P}}function _w(t,l){return t&&(t[l]||t[qs(l)]||t[o_(qs(l))])}function za(t,l,d,_){let T;const C=d&&d[_],P=Oi(t);if(P||Dn(t)){const V=P&&Nl(t);let s=!1;V&&(s=!Ba(t),t=_x(t)),T=new Array(t.length);for(let $=0,Z=t.length;$<Z;$++)T[$]=l(s?po(t[$]):t[$],$,void 0,C&&C[$])}else if(typeof t=="number"){T=new Array(t);for(let V=0;V<t;V++)T[V]=l(V+1,V,void 0,C&&C[V])}else if(gn(t))if(t[Symbol.iterator])T=Array.from(t,(V,s)=>l(V,s,void 0,C&&C[s]));else{const V=Object.keys(t);T=new Array(V.length);for(let s=0,$=V.length;s<$;s++){const Z=V[s];T[s]=l(t[Z],Z,s,C&&C[s])}}else T=[];return d&&(d[_]=T),T}function Rk(t,l){for(let d=0;d<l.length;d++){const _=l[d];if(Oi(_))for(let T=0;T<_.length;T++)t[_[T].name]=_[T].fn;else _&&(t[_.name]=_.key?(...T)=>{const C=_.fn(...T);return C&&(C.key=_.key),C}:_.fn)}return t}function oS(t,l,d={},_,T){if(Is.ce||Is.parent&&Wu(Is.parent)&&Is.parent.ce)return l!=="default"&&(d.name=l),gi(),Fo(jr,null,[fr("slot",d,_&&_())],64);let C=t[l];C&&C._c&&(C._d=!1),gi();const P=C&&Pb(C(d)),V=d.key||P&&P.key,s=Fo(jr,{key:(V&&!Ul(V)?V:`_${l}`)+(!P&&_?"_fb":"")},P||(_?_():[]),P&&t._===1?64:-2);return!T&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),C&&C._c&&(C._d=!0),s}function Pb(t){return t.some(l=>Ph(l)?!(l.type===ws||l.type===jr&&!Pb(l.children)):!0)?t:null}function aS(t,l){const d={};for(const _ in t)d[l&&/[A-Z]/.test(_)?`on:${_}`:Ig(_)]=t[_];return d}const I0=t=>t?NS(t)?d_(t):I0(t.parent):null,Dg=Tn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>I0(t.parent),$root:t=>I0(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Lb(t),$forceUpdate:t=>t.f||(t.f=()=>{Tb(t.update)}),$nextTick:t=>t.n||(t.n=zf.bind(t.proxy)),$watch:t=>dP.bind(t)}),a0=(t,l)=>t!==Fr&&!t.__isScriptSetup&&tn(t,l),k0={get({_:t},l){if(l==="__v_skip")return!0;const{ctx:d,setupState:_,data:T,props:C,accessCache:P,type:V,appContext:s}=t;let $;if(l[0]!=="$"){const ue=P[l];if(ue!==void 0)switch(ue){case 1:return _[l];case 2:return T[l];case 4:return d[l];case 3:return C[l]}else{if(a0(_,l))return P[l]=1,_[l];if(T!==Fr&&tn(T,l))return P[l]=2,T[l];if(($=t.propsOptions[0])&&tn($,l))return P[l]=3,C[l];if(d!==Fr&&tn(d,l))return P[l]=4,d[l];P0&&(P[l]=0)}}const Z=Dg[l];let J,ne;if(Z)return l==="$attrs"&&fo(t.attrs,"get",""),Z(t);if((J=V.__cssModules)&&(J=J[l]))return J;if(d!==Fr&&tn(d,l))return P[l]=4,d[l];if(ne=s.config.globalProperties,tn(ne,l))return ne[l]},set({_:t},l,d){const{data:_,setupState:T,ctx:C}=t;return a0(T,l)?(T[l]=d,!0):_!==Fr&&tn(_,l)?(_[l]=d,!0):tn(t.props,l)||l[0]==="$"&&l.slice(1)in t?!1:(C[l]=d,!0)},has({_:{data:t,setupState:l,accessCache:d,ctx:_,appContext:T,propsOptions:C}},P){let V;return!!d[P]||t!==Fr&&tn(t,P)||a0(l,P)||(V=C[0])&&tn(V,P)||tn(_,P)||tn(Dg,P)||tn(T.config.globalProperties,P)},defineProperty(t,l,d){return d.get!=null?t._.accessCache[l]=0:tn(d,"value")&&this.set(t,l,d.value,null),Reflect.defineProperty(t,l,d)}},zk=Tn({},k0,{get(t,l){if(l!==Symbol.unscopables)return k0.get(t,l,t)},has(t,l){return l[0]!=="_"&&!dI(l)}});function Bk(){return null}function Fk(){return null}function Nk(t){}function Uk(t){}function Vk(){return null}function jk(){}function $k(t,l){return null}function Gk(){return lS().slots}function Wk(){return lS().attrs}function lS(){const t=Zs();return t.setupContext||(t.setupContext=jS(t))}function qg(t){return Oi(t)?t.reduce((l,d)=>(l[d]=null,l),{}):t}function Hk(t,l){const d=qg(t);for(const _ in l){if(_.startsWith("__skip"))continue;let T=d[_];T?Oi(T)||er(T)?T=d[_]={type:T,default:l[_]}:T.default=l[_]:T===null&&(T=d[_]={default:l[_]}),T&&l[`__skip_${_}`]&&(T.skipFactory=!0)}return d}function qk(t,l){return!t||!l?t||l:Oi(t)&&Oi(l)?t.concat(l):Tn({},qg(t),qg(l))}function Xk(t,l){const d={};for(const _ in t)l.includes(_)||Object.defineProperty(d,_,{enumerable:!0,get:()=>t[_]});return d}function Zk(t){const l=Zs();let d=t();return B0(),fb(d)&&(d=d.catch(_=>{throw Lf(l),_})),[d,()=>Lf(l)]}let P0=!0;function Yk(t){const l=Lb(t),d=t.proxy,_=t.ctx;P0=!1,l.beforeCreate&&yw(l.beforeCreate,t,"bc");const{data:T,computed:C,methods:P,watch:V,provide:s,inject:$,created:Z,beforeMount:J,mounted:ne,beforeUpdate:ue,updated:we,activated:Me,deactivated:Ye,beforeDestroy:Ze,beforeUnmount:Fe,destroyed:ae,unmounted:ge,render:Oe,renderTracked:ze,renderTriggered:rt,errorCaptured:Ie,serverPrefetch:Je,expose:He,inheritAttrs:ti,components:bt,directives:wt,filters:xt}=l;if($&&Kk($,_,null),P)for(const ai in P){const yi=P[ai];er(yi)&&(_[ai]=yi.bind(d))}if(T){const ai=T.call(d,d);gn(ai)&&(t.data=dm(ai))}if(P0=!0,C)for(const ai in C){const yi=C[ai],xi=er(yi)?yi.bind(d,d):er(yi.get)?yi.get.bind(d,d):nl,Pr=!er(yi)&&er(yi.set)?yi.set.bind(d):nl,tr=un({get:xi,set:Pr});Object.defineProperty(_,ai,{enumerable:!0,configurable:!0,get:()=>tr.value,set:nr=>tr.value=nr})}if(V)for(const ai in V)cS(V[ai],_,d,ai);if(s){const ai=er(s)?s.call(d):s;Reflect.ownKeys(ai).forEach(yi=>{Og(yi,ai[yi])})}Z&&yw(Z,t,"c");function vt(ai,yi){Oi(yi)?yi.forEach(xi=>ai(xi.bind(d))):yi&&ai(yi.bind(d))}if(vt(Ab,J),vt(Dh,ne),vt(Mb,ue),vt(Sx,we),vt(JE,Me),vt(QE,Ye),vt(nS,Ie),vt(rS,ze),vt(iS,rt),vt(Cx,Fe),vt(c_,ge),vt(tS,Je),Oi(He))if(He.length){const ai=t.exposed||(t.exposed={});He.forEach(yi=>{Object.defineProperty(ai,yi,{get:()=>d[yi],set:xi=>d[yi]=xi})})}else t.exposed||(t.exposed={});Oe&&t.render===nl&&(t.render=Oe),ti!=null&&(t.inheritAttrs=ti),bt&&(t.components=bt),wt&&(t.directives=wt),Je&&Cb(t)}function Kk(t,l,d=nl){Oi(t)&&(t=L0(t));for(const _ in t){const T=t[_];let C;gn(T)?"default"in T?C=la(T.from||_,T.default,!0):C=la(T.from||_):C=la(T),Ln(C)?Object.defineProperty(l,_,{enumerable:!0,configurable:!0,get:()=>C.value,set:P=>C.value=P}):l[_]=C}}function yw(t,l,d){ol(Oi(t)?t.map(_=>_.bind(l.proxy)):t.bind(l.proxy),l,d)}function cS(t,l,d,_){let T=_.includes(".")?IS(d,_):()=>d[_];if(Dn(t)){const C=l[t];er(C)&&ca(T,C)}else if(er(t))ca(T,t.bind(d));else if(gn(t))if(Oi(t))t.forEach(C=>cS(C,l,d,_));else{const C=er(t.handler)?t.handler.bind(d):l[t.handler];er(C)&&ca(T,C,t)}}function Lb(t){const l=t.type,{mixins:d,extends:_}=l,{mixins:T,optionsCache:C,config:{optionMergeStrategies:P}}=t.appContext,V=C.get(l);let s;return V?s=V:!T.length&&!d&&!_?s=l:(s={},T.length&&T.forEach($=>Ky(s,$,P,!0)),Ky(s,l,P)),gn(l)&&C.set(l,s),s}function Ky(t,l,d,_=!1){const{mixins:T,extends:C}=l;C&&Ky(t,C,d,!0),T&&T.forEach(P=>Ky(t,P,d,!0));for(const P in l)if(!(_&&P==="expose")){const V=Jk[P]||d&&d[P];t[P]=V?V(t[P],l[P]):l[P]}return t}const Jk={data:xw,props:vw,emits:vw,methods:Mg,computed:Mg,beforeCreate:Do,created:Do,beforeMount:Do,mounted:Do,beforeUpdate:Do,updated:Do,beforeDestroy:Do,beforeUnmount:Do,destroyed:Do,unmounted:Do,activated:Do,deactivated:Do,errorCaptured:Do,serverPrefetch:Do,components:Mg,directives:Mg,watch:eP,provide:xw,inject:Qk};function xw(t,l){return l?t?function(){return Tn(er(t)?t.call(this,this):t,er(l)?l.call(this,this):l)}:l:t}function Qk(t,l){return Mg(L0(t),L0(l))}function L0(t){if(Oi(t)){const l={};for(let d=0;d<t.length;d++)l[t[d]]=t[d];return l}return t}function Do(t,l){return t?[...new Set([].concat(t,l))]:l}function Mg(t,l){return t?Tn(Object.create(null),t,l):l}function vw(t,l){return t?Oi(t)&&Oi(l)?[...new Set([...t,...l])]:Tn(Object.create(null),qg(t),qg(l??{})):l}function eP(t,l){if(!t)return l;if(!l)return t;const d=Tn(Object.create(null),t);for(const _ in l)d[_]=Do(t[_],l[_]);return d}function hS(){return{app:null,config:{isNativeTag:sI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let tP=0;function iP(t,l){return function(_,T=null){er(_)||(_=Tn({},_)),T!=null&&!gn(T)&&(T=null);const C=hS(),P=new WeakSet,V=[];let s=!1;const $=C.app={_uid:tP++,_component:_,_props:T,_container:null,_context:C,_instance:null,version:GS,get config(){return C.config},set config(Z){},use(Z,...J){return P.has(Z)||(Z&&er(Z.install)?(P.add(Z),Z.install($,...J)):er(Z)&&(P.add(Z),Z($,...J))),$},mixin(Z){return C.mixins.includes(Z)||C.mixins.push(Z),$},component(Z,J){return J?(C.components[Z]=J,$):C.components[Z]},directive(Z,J){return J?(C.directives[Z]=J,$):C.directives[Z]},mount(Z,J,ne){if(!s){const ue=$._ceVNode||fr(_,T);return ue.appContext=C,ne===!0?ne="svg":ne===!1&&(ne=void 0),J&&l?l(ue,Z):t(ue,Z,ne),s=!0,$._container=Z,Z.__vue_app__=$,d_(ue.component)}},onUnmount(Z){V.push(Z)},unmount(){s&&(ol(V,$._instance,16),t(null,$._container),delete $._container.__vue_app__)},provide(Z,J){return C.provides[Z]=J,$},runWithContext(Z){const J=Mf;Mf=$;try{return Z()}finally{Mf=J}}};return $}}let Mf=null;function Og(t,l){if(Ms){let d=Ms.provides;const _=Ms.parent&&Ms.parent.provides;_===d&&(d=Ms.provides=Object.create(_)),d[t]=l}}function la(t,l,d=!1){const _=Ms||Is;if(_||Mf){const T=Mf?Mf._context.provides:_?_.parent==null?_.vnode.appContext&&_.vnode.appContext.provides:_.parent.provides:void 0;if(T&&t in T)return T[t];if(arguments.length>1)return d&&er(l)?l.call(_&&_.proxy):l}}function uS(){return!!(Ms||Is||Mf)}const dS={},fS=()=>Object.create(dS),pS=t=>Object.getPrototypeOf(t)===dS;function rP(t,l,d,_=!1){const T={},C=fS();t.propsDefaults=Object.create(null),mS(t,l,T,C);for(const P in t.propsOptions[0])P in T||(T[P]=void 0);d?t.props=_?T:vb(T):t.type.props?t.props=T:t.props=C,t.attrs=C}function nP(t,l,d,_){const{props:T,attrs:C,vnode:{patchFlag:P}}=t,V=Ir(T),[s]=t.propsOptions;let $=!1;if((_||P>0)&&!(P&16)){if(P&8){const Z=t.vnode.dynamicProps;for(let J=0;J<Z.length;J++){let ne=Z[J];if(Mx(t.emitsOptions,ne))continue;const ue=l[ne];if(s)if(tn(C,ne))ue!==C[ne]&&(C[ne]=ue,$=!0);else{const we=qs(ne);T[we]=D0(s,V,we,ue,t,!1)}else ue!==C[ne]&&(C[ne]=ue,$=!0)}}}else{mS(t,l,T,C)&&($=!0);let Z;for(const J in V)(!l||!tn(l,J)&&((Z=aa(J))===J||!tn(l,Z)))&&(s?d&&(d[J]!==void 0||d[Z]!==void 0)&&(T[J]=D0(s,V,J,void 0,t,!0)):delete T[J]);if(C!==V)for(const J in C)(!l||!tn(l,J))&&(delete C[J],$=!0)}$&&wh(t.attrs,"set","")}function mS(t,l,d,_){const[T,C]=t.propsOptions;let P=!1,V;if(l)for(let s in l){if(Qp(s))continue;const $=l[s];let Z;T&&tn(T,Z=qs(s))?!C||!C.includes(Z)?d[Z]=$:(V||(V={}))[Z]=$:Mx(t.emitsOptions,s)||(!(s in _)||$!==_[s])&&(_[s]=$,P=!0)}if(C){const s=Ir(d),$=V||Fr;for(let Z=0;Z<C.length;Z++){const J=C[Z];d[J]=D0(T,s,J,$[J],t,!tn($,J))}}return P}function D0(t,l,d,_,T,C){const P=t[d];if(P!=null){const V=tn(P,"default");if(V&&_===void 0){const s=P.default;if(P.type!==Function&&!P.skipFactory&&er(s)){const{propsDefaults:$}=T;if(d in $)_=$[d];else{const Z=Lf(T);_=$[d]=s.call(null,l),Z()}}else _=s;T.ce&&T.ce._setProp(d,_)}P[0]&&(C&&!V?_=!1:P[1]&&(_===""||_===aa(d))&&(_=!0))}return _}const sP=new WeakMap;function gS(t,l,d=!1){const _=d?sP:l.propsCache,T=_.get(t);if(T)return T;const C=t.props,P={},V=[];let s=!1;if(!er(t)){const Z=J=>{s=!0;const[ne,ue]=gS(J,l,!0);Tn(P,ne),ue&&V.push(...ue)};!d&&l.mixins.length&&l.mixins.forEach(Z),t.extends&&Z(t.extends),t.mixins&&t.mixins.forEach(Z)}if(!C&&!s)return gn(t)&&_.set(t,Kp),Kp;if(Oi(C))for(let Z=0;Z<C.length;Z++){const J=qs(C[Z]);bw(J)&&(P[J]=Fr)}else if(C)for(const Z in C){const J=qs(Z);if(bw(J)){const ne=C[Z],ue=P[J]=Oi(ne)||er(ne)?{type:ne}:Tn({},ne),we=ue.type;let Me=!1,Ye=!0;if(Oi(we))for(let Ze=0;Ze<we.length;++Ze){const Fe=we[Ze],ae=er(Fe)&&Fe.name;if(ae==="Boolean"){Me=!0;break}else ae==="String"&&(Ye=!1)}else Me=er(we)&&we.name==="Boolean";ue[0]=Me,ue[1]=Ye,(Me||tn(ue,"default"))&&V.push(J)}}const $=[P,V];return gn(t)&&_.set(t,$),$}function bw(t){return t[0]!=="$"&&!Qp(t)}const _S=t=>t[0]==="_"||t==="$stable",Db=t=>Oi(t)?t.map(oa):[oa(t)],oP=(t,l,d)=>{if(l._n)return l;const _=Ns((...T)=>Db(l(...T)),d);return _._c=!1,_},yS=(t,l,d)=>{const _=t._ctx;for(const T in t){if(_S(T))continue;const C=t[T];if(er(C))l[T]=oP(T,C,_);else if(C!=null){const P=Db(C);l[T]=()=>P}}},xS=(t,l)=>{const d=Db(l);t.slots.default=()=>d},vS=(t,l,d)=>{for(const _ in l)(d||_!=="_")&&(t[_]=l[_])},aP=(t,l,d)=>{const _=t.slots=fS();if(t.vnode.shapeFlag&32){const T=l._;T?(vS(_,l,d),d&&fE(_,"_",T,!0)):yS(l,_)}else l&&xS(t,l)},lP=(t,l,d)=>{const{vnode:_,slots:T}=t;let C=!0,P=Fr;if(_.shapeFlag&32){const V=l._;V?d&&V===1?C=!1:vS(T,l,d):(C=!l.$stable,yS(l,T)),P=l}else l&&(xS(t,l),P={default:1});if(C)for(const V in T)!_S(V)&&P[V]==null&&delete T[V]},As=DS;function bS(t){return TS(t)}function wS(t){return TS(t,xk)}function TS(t,l){const d=fx();d.__VUE__=!0;const{insert:_,remove:T,patchProp:C,createElement:P,createText:V,createComment:s,setText:$,setElementText:Z,parentNode:J,nextSibling:ne,setScopeId:ue=nl,insertStaticContent:we}=t,Me=(xe,ve,nt,Lt=null,It=null,Xt=null,ni=void 0,Te=null,Ae=!!ve.dynamicChildren)=>{if(xe===ve)return;xe&&!Ol(xe,ve)&&(Lt=zt(xe),nr(xe,It,Xt,!0),xe=null),ve.patchFlag===-2&&(Ae=!1,ve.dynamicChildren=null);const{type:Qe,ref:$t,shapeFlag:Gt}=ve;switch(Qe){case Mh:Ye(xe,ve,nt,Lt);break;case ws:Ze(xe,ve,nt,Lt);break;case If:xe==null&&Fe(ve,nt,Lt,ni);break;case jr:bt(xe,ve,nt,Lt,It,Xt,ni,Te,Ae);break;default:Gt&1?Oe(xe,ve,nt,Lt,It,Xt,ni,Te,Ae):Gt&6?wt(xe,ve,nt,Lt,It,Xt,ni,Te,Ae):(Gt&64||Gt&128)&&Qe.process(xe,ve,nt,Lt,It,Xt,ni,Te,Ae,Ti)}$t!=null&&It&&Hg($t,xe&&xe.ref,Xt,ve||xe,!ve)},Ye=(xe,ve,nt,Lt)=>{if(xe==null)_(ve.el=V(ve.children),nt,Lt);else{const It=ve.el=xe.el;ve.children!==xe.children&&$(It,ve.children)}},Ze=(xe,ve,nt,Lt)=>{xe==null?_(ve.el=s(ve.children||""),nt,Lt):ve.el=xe.el},Fe=(xe,ve,nt,Lt)=>{[xe.el,xe.anchor]=we(xe.children,ve,nt,Lt,xe.el,xe.anchor)},ae=({el:xe,anchor:ve},nt,Lt)=>{let It;for(;xe&&xe!==ve;)It=ne(xe),_(xe,nt,Lt),xe=It;_(ve,nt,Lt)},ge=({el:xe,anchor:ve})=>{let nt;for(;xe&&xe!==ve;)nt=ne(xe),T(xe),xe=nt;T(ve)},Oe=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae)=>{ve.type==="svg"?ni="svg":ve.type==="math"&&(ni="mathml"),xe==null?ze(ve,nt,Lt,It,Xt,ni,Te,Ae):Je(xe,ve,It,Xt,ni,Te,Ae)},ze=(xe,ve,nt,Lt,It,Xt,ni,Te)=>{let Ae,Qe;const{props:$t,shapeFlag:Gt,transition:Zt,dirs:ut}=xe;if(Ae=xe.el=P(xe.type,Xt,$t&&$t.is,$t),Gt&8?Z(Ae,xe.children):Gt&16&&Ie(xe.children,Ae,null,Lt,It,l0(xe,Xt),ni,Te),ut&&kc(xe,null,Lt,"created"),rt(Ae,xe,xe.scopeId,ni,Lt),$t){for(const Mi in $t)Mi!=="value"&&!Qp(Mi)&&C(Ae,Mi,null,$t[Mi],Xt,Lt);"value"in $t&&C(Ae,"value",null,$t.value,Xt),(Qe=$t.onVnodeBeforeMount)&&sa(Qe,Lt,xe)}ut&&kc(xe,null,Lt,"beforeMount");const Pt=ES(It,Zt);Pt&&Zt.beforeEnter(Ae),_(Ae,ve,nt),((Qe=$t&&$t.onVnodeMounted)||Pt||ut)&&As(()=>{Qe&&sa(Qe,Lt,xe),Pt&&Zt.enter(Ae),ut&&kc(xe,null,Lt,"mounted")},It)},rt=(xe,ve,nt,Lt,It)=>{if(nt&&ue(xe,nt),Lt)for(let Xt=0;Xt<Lt.length;Xt++)ue(xe,Lt[Xt]);if(It){let Xt=It.subTree;if(ve===Xt||Qy(Xt.type)&&(Xt.ssContent===ve||Xt.ssFallback===ve)){const ni=It.vnode;rt(xe,ni,ni.scopeId,ni.slotScopeIds,It.parent)}}},Ie=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae=0)=>{for(let Qe=Ae;Qe<xe.length;Qe++){const $t=xe[Qe]=Te?$u(xe[Qe]):oa(xe[Qe]);Me(null,$t,ve,nt,Lt,It,Xt,ni,Te)}},Je=(xe,ve,nt,Lt,It,Xt,ni)=>{const Te=ve.el=xe.el;let{patchFlag:Ae,dynamicChildren:Qe,dirs:$t}=ve;Ae|=xe.patchFlag&16;const Gt=xe.props||Fr,Zt=ve.props||Fr;let ut;if(nt&&bf(nt,!1),(ut=Zt.onVnodeBeforeUpdate)&&sa(ut,nt,ve,xe),$t&&kc(ve,xe,nt,"beforeUpdate"),nt&&bf(nt,!0),(Gt.innerHTML&&Zt.innerHTML==null||Gt.textContent&&Zt.textContent==null)&&Z(Te,""),Qe?He(xe.dynamicChildren,Qe,Te,nt,Lt,l0(ve,It),Xt):ni||yi(xe,ve,Te,null,nt,Lt,l0(ve,It),Xt,!1),Ae>0){if(Ae&16)ti(Te,Gt,Zt,nt,It);else if(Ae&2&&Gt.class!==Zt.class&&C(Te,"class",null,Zt.class,It),Ae&4&&C(Te,"style",Gt.style,Zt.style,It),Ae&8){const Pt=ve.dynamicProps;for(let Mi=0;Mi<Pt.length;Mi++){const Di=Pt[Mi],$r=Gt[Di],Nr=Zt[Di];(Nr!==$r||Di==="value")&&C(Te,Di,$r,Nr,It,nt)}}Ae&1&&xe.children!==ve.children&&Z(Te,ve.children)}else!ni&&Qe==null&&ti(Te,Gt,Zt,nt,It);((ut=Zt.onVnodeUpdated)||$t)&&As(()=>{ut&&sa(ut,nt,ve,xe),$t&&kc(ve,xe,nt,"updated")},Lt)},He=(xe,ve,nt,Lt,It,Xt,ni)=>{for(let Te=0;Te<ve.length;Te++){const Ae=xe[Te],Qe=ve[Te],$t=Ae.el&&(Ae.type===jr||!Ol(Ae,Qe)||Ae.shapeFlag&70)?J(Ae.el):nt;Me(Ae,Qe,$t,null,Lt,It,Xt,ni,!0)}},ti=(xe,ve,nt,Lt,It)=>{if(ve!==nt){if(ve!==Fr)for(const Xt in ve)!Qp(Xt)&&!(Xt in nt)&&C(xe,Xt,ve[Xt],null,It,Lt);for(const Xt in nt){if(Qp(Xt))continue;const ni=nt[Xt],Te=ve[Xt];ni!==Te&&Xt!=="value"&&C(xe,Xt,Te,ni,It,Lt)}"value"in nt&&C(xe,"value",ve.value,nt.value,It)}},bt=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae)=>{const Qe=ve.el=xe?xe.el:V(""),$t=ve.anchor=xe?xe.anchor:V("");let{patchFlag:Gt,dynamicChildren:Zt,slotScopeIds:ut}=ve;ut&&(Te=Te?Te.concat(ut):ut),xe==null?(_(Qe,nt,Lt),_($t,nt,Lt),Ie(ve.children||[],nt,$t,It,Xt,ni,Te,Ae)):Gt>0&&Gt&64&&Zt&&xe.dynamicChildren?(He(xe.dynamicChildren,Zt,nt,It,Xt,ni,Te),(ve.key!=null||It&&ve===It.subTree)&&Ob(xe,ve,!0)):yi(xe,ve,nt,$t,It,Xt,ni,Te,Ae)},wt=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae)=>{ve.slotScopeIds=Te,xe==null?ve.shapeFlag&512?It.ctx.activate(ve,nt,Lt,ni,Ae):xt(ve,nt,Lt,It,Xt,ni,Ae):Tt(xe,ve,Ae)},xt=(xe,ve,nt,Lt,It,Xt,ni)=>{const Te=xe.component=FS(xe,Lt,It);if(l_(xe)&&(Te.ctx.renderer=Ti),US(Te,!1,ni),Te.asyncDep){if(It&&It.registerDep(Te,vt,ni),!xe.el){const Ae=Te.subTree=fr(ws);Ze(null,Ae,ve,nt)}}else vt(Te,xe,ve,nt,It,Xt,ni)},Tt=(xe,ve,nt)=>{const Lt=ve.component=xe.component;if(yP(xe,ve,nt))if(Lt.asyncDep&&!Lt.asyncResolved){ai(Lt,ve,nt);return}else Lt.next=ve,Lt.update();else ve.el=xe.el,Lt.vnode=ve},vt=(xe,ve,nt,Lt,It,Xt,ni)=>{const Te=()=>{if(xe.isMounted){let{next:Gt,bu:Zt,u:ut,parent:Pt,vnode:Mi}=xe;{const lr=SS(xe);if(lr){Gt&&(Gt.el=Mi.el,ai(xe,Gt,ni)),lr.asyncDep.then(()=>{xe.isUnmounted||Te()});return}}let Di=Gt,$r;bf(xe,!1),Gt?(Gt.el=Mi.el,ai(xe,Gt,ni)):Gt=Mi,Zt&&em(Zt),($r=Gt.props&&Gt.props.onVnodeBeforeUpdate)&&sa($r,Pt,Gt,Mi),bf(xe,!0);const Nr=zy(xe),cn=xe.subTree;xe.subTree=Nr,Me(cn,Nr,J(cn.el),zt(cn),xe,It,Xt),Gt.el=Nr.el,Di===null&&Ix(xe,Nr.el),ut&&As(ut,It),($r=Gt.props&&Gt.props.onVnodeUpdated)&&As(()=>sa($r,Pt,Gt,Mi),It)}else{let Gt;const{el:Zt,props:ut}=ve,{bm:Pt,m:Mi,parent:Di,root:$r,type:Nr}=xe,cn=Wu(ve);if(bf(xe,!1),Pt&&em(Pt),!cn&&(Gt=ut&&ut.onVnodeBeforeMount)&&sa(Gt,Di,ve),bf(xe,!0),Zt&&Ei){const lr=()=>{xe.subTree=zy(xe),Ei(Zt,xe.subTree,xe,It,null)};cn&&Nr.__asyncHydrate?Nr.__asyncHydrate(Zt,xe,lr):lr()}else{$r.ce&&$r.ce._injectChildStyle(Nr);const lr=xe.subTree=zy(xe);Me(null,lr,nt,Lt,xe,It,Xt),ve.el=lr.el}if(Mi&&As(Mi,It),!cn&&(Gt=ut&&ut.onVnodeMounted)){const lr=ve;As(()=>sa(Gt,Di,lr),It)}(ve.shapeFlag&256||Di&&Wu(Di.vnode)&&Di.vnode.shapeFlag&256)&&xe.a&&As(xe.a,It),xe.isMounted=!0,ve=nt=Lt=null}};xe.scope.on();const Ae=xe.effect=new Ug(Te);xe.scope.off();const Qe=xe.update=Ae.run.bind(Ae),$t=xe.job=Ae.runIfDirty.bind(Ae);$t.i=xe,$t.id=xe.uid,Ae.scheduler=()=>Tb($t),bf(xe,!0),Qe()},ai=(xe,ve,nt)=>{ve.component=xe;const Lt=xe.vnode.props;xe.vnode=ve,xe.next=null,nP(xe,ve.props,Lt,nt),lP(xe,ve.children,nt),Yu(),hw(xe),Ku()},yi=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae=!1)=>{const Qe=xe&&xe.children,$t=xe?xe.shapeFlag:0,Gt=ve.children,{patchFlag:Zt,shapeFlag:ut}=ve;if(Zt>0){if(Zt&128){Pr(Qe,Gt,nt,Lt,It,Xt,ni,Te,Ae);return}else if(Zt&256){xi(Qe,Gt,nt,Lt,It,Xt,ni,Te,Ae);return}}ut&8?($t&16&&nn(Qe,It,Xt),Gt!==Qe&&Z(nt,Gt)):$t&16?ut&16?Pr(Qe,Gt,nt,Lt,It,Xt,ni,Te,Ae):nn(Qe,It,Xt,!0):($t&8&&Z(nt,""),ut&16&&Ie(Gt,nt,Lt,It,Xt,ni,Te,Ae))},xi=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae)=>{xe=xe||Kp,ve=ve||Kp;const Qe=xe.length,$t=ve.length,Gt=Math.min(Qe,$t);let Zt;for(Zt=0;Zt<Gt;Zt++){const ut=ve[Zt]=Ae?$u(ve[Zt]):oa(ve[Zt]);Me(xe[Zt],ut,nt,null,It,Xt,ni,Te,Ae)}Qe>$t?nn(xe,It,Xt,!0,!1,Gt):Ie(ve,nt,Lt,It,Xt,ni,Te,Ae,Gt)},Pr=(xe,ve,nt,Lt,It,Xt,ni,Te,Ae)=>{let Qe=0;const $t=ve.length;let Gt=xe.length-1,Zt=$t-1;for(;Qe<=Gt&&Qe<=Zt;){const ut=xe[Qe],Pt=ve[Qe]=Ae?$u(ve[Qe]):oa(ve[Qe]);if(Ol(ut,Pt))Me(ut,Pt,nt,null,It,Xt,ni,Te,Ae);else break;Qe++}for(;Qe<=Gt&&Qe<=Zt;){const ut=xe[Gt],Pt=ve[Zt]=Ae?$u(ve[Zt]):oa(ve[Zt]);if(Ol(ut,Pt))Me(ut,Pt,nt,null,It,Xt,ni,Te,Ae);else break;Gt--,Zt--}if(Qe>Gt){if(Qe<=Zt){const ut=Zt+1,Pt=ut<$t?ve[ut].el:Lt;for(;Qe<=Zt;)Me(null,ve[Qe]=Ae?$u(ve[Qe]):oa(ve[Qe]),nt,Pt,It,Xt,ni,Te,Ae),Qe++}}else if(Qe>Zt)for(;Qe<=Gt;)nr(xe[Qe],It,Xt,!0),Qe++;else{const ut=Qe,Pt=Qe,Mi=new Map;for(Qe=Pt;Qe<=Zt;Qe++){const zn=ve[Qe]=Ae?$u(ve[Qe]):oa(ve[Qe]);zn.key!=null&&Mi.set(zn.key,Qe)}let Di,$r=0;const Nr=Zt-Pt+1;let cn=!1,lr=0;const hs=new Array(Nr);for(Qe=0;Qe<Nr;Qe++)hs[Qe]=0;for(Qe=ut;Qe<=Gt;Qe++){const zn=xe[Qe];if($r>=Nr){nr(zn,It,Xt,!0);continue}let Kn;if(zn.key!=null)Kn=Mi.get(zn.key);else for(Di=Pt;Di<=Zt;Di++)if(hs[Di-Pt]===0&&Ol(zn,ve[Di])){Kn=Di;break}Kn===void 0?nr(zn,It,Xt,!0):(hs[Kn-Pt]=Qe+1,Kn>=lr?lr=Kn:cn=!0,Me(zn,ve[Kn],nt,null,It,Xt,ni,Te,Ae),$r++)}const _o=cn?cP(hs):Kp;for(Di=_o.length-1,Qe=Nr-1;Qe>=0;Qe--){const zn=Pt+Qe,Kn=ve[zn],ss=zn+1<$t?ve[zn+1].el:Lt;hs[Qe]===0?Me(null,Kn,nt,ss,It,Xt,ni,Te,Ae):cn&&(Di<0||Qe!==_o[Di]?tr(Kn,nt,ss,2):Di--)}}},tr=(xe,ve,nt,Lt,It=null)=>{const{el:Xt,type:ni,transition:Te,children:Ae,shapeFlag:Qe}=xe;if(Qe&6){tr(xe.component.subTree,ve,nt,Lt);return}if(Qe&128){xe.suspense.move(ve,nt,Lt);return}if(Qe&64){ni.move(xe,ve,nt,Ti);return}if(ni===jr){_(Xt,ve,nt);for(let Gt=0;Gt<Ae.length;Gt++)tr(Ae[Gt],ve,nt,Lt);_(xe.anchor,ve,nt);return}if(ni===If){ae(xe,ve,nt);return}if(Lt!==2&&Qe&1&&Te)if(Lt===0)Te.beforeEnter(Xt),_(Xt,ve,nt),As(()=>Te.enter(Xt),It);else{const{leave:Gt,delayLeave:Zt,afterLeave:ut}=Te,Pt=()=>_(Xt,ve,nt),Mi=()=>{Gt(Xt,()=>{Pt(),ut&&ut()})};Zt?Zt(Xt,Pt,Mi):Mi()}else _(Xt,ve,nt)},nr=(xe,ve,nt,Lt=!1,It=!1)=>{const{type:Xt,props:ni,ref:Te,children:Ae,dynamicChildren:Qe,shapeFlag:$t,patchFlag:Gt,dirs:Zt,cacheIndex:ut}=xe;if(Gt===-2&&(It=!1),Te!=null&&Hg(Te,null,nt,xe,!0),ut!=null&&(ve.renderCache[ut]=void 0),$t&256){ve.ctx.deactivate(xe);return}const Pt=$t&1&&Zt,Mi=!Wu(xe);let Di;if(Mi&&(Di=ni&&ni.onVnodeBeforeUnmount)&&sa(Di,ve,xe),$t&6)Rn(xe.component,nt,Lt);else{if($t&128){xe.suspense.unmount(nt,Lt);return}Pt&&kc(xe,null,ve,"beforeUnmount"),$t&64?xe.type.remove(xe,ve,nt,Ti,Lt):Qe&&!Qe.hasOnce&&(Xt!==jr||Gt>0&&Gt&64)?nn(Qe,ve,nt,!1,!0):(Xt===jr&&Gt&384||!It&&$t&16)&&nn(Ae,ve,nt),Lt&&rn(xe)}(Mi&&(Di=ni&&ni.onVnodeUnmounted)||Pt)&&As(()=>{Di&&sa(Di,ve,xe),Pt&&kc(xe,null,ve,"unmounted")},nt)},rn=xe=>{const{type:ve,el:nt,anchor:Lt,transition:It}=xe;if(ve===jr){dr(nt,Lt);return}if(ve===If){ge(xe);return}const Xt=()=>{T(nt),It&&!It.persisted&&It.afterLeave&&It.afterLeave()};if(xe.shapeFlag&1&&It&&!It.persisted){const{leave:ni,delayLeave:Te}=It,Ae=()=>ni(nt,Xt);Te?Te(xe.el,Xt,Ae):Ae()}else Xt()},dr=(xe,ve)=>{let nt;for(;xe!==ve;)nt=ne(xe),T(xe),xe=nt;T(ve)},Rn=(xe,ve,nt)=>{const{bum:Lt,scope:It,job:Xt,subTree:ni,um:Te,m:Ae,a:Qe}=xe;Jy(Ae),Jy(Qe),Lt&&em(Lt),It.stop(),Xt&&(Xt.flags|=8,nr(ni,xe,ve,nt)),Te&&As(Te,ve),As(()=>{xe.isUnmounted=!0},ve),ve&&ve.pendingBranch&&!ve.isUnmounted&&xe.asyncDep&&!xe.asyncResolved&&xe.suspenseId===ve.pendingId&&(ve.deps--,ve.deps===0&&ve.resolve())},nn=(xe,ve,nt,Lt=!1,It=!1,Xt=0)=>{for(let ni=Xt;ni<xe.length;ni++)nr(xe[ni],ve,nt,Lt,It)},zt=xe=>{if(xe.shapeFlag&6)return zt(xe.component.subTree);if(xe.shapeFlag&128)return xe.suspense.next();const ve=ne(xe.anchor||xe.el),nt=ve&&ve[GE];return nt?ne(nt):ve};let fi=!1;const ri=(xe,ve,nt)=>{xe==null?ve._vnode&&nr(ve._vnode,null,null,!0):Me(ve._vnode||null,xe,ve,null,null,null,nt),ve._vnode=xe,fi||(fi=!0,hw(),Yy(),fi=!1)},Ti={p:Me,um:nr,m:tr,r:rn,mt:xt,mc:Ie,pc:yi,pbc:He,n:zt,o:t};let sr,Ei;return l&&([sr,Ei]=l(Ti)),{render:ri,hydrate:sr,createApp:iP(ri,sr)}}function l0({type:t,props:l},d){return d==="svg"&&t==="foreignObject"||d==="mathml"&&t==="annotation-xml"&&l&&l.encoding&&l.encoding.includes("html")?void 0:d}function bf({effect:t,job:l},d){d?(t.flags|=32,l.flags|=4):(t.flags&=-33,l.flags&=-5)}function ES(t,l){return(!t||t&&!t.pendingBranch)&&l&&!l.persisted}function Ob(t,l,d=!1){const _=t.children,T=l.children;if(Oi(_)&&Oi(T))for(let C=0;C<_.length;C++){const P=_[C];let V=T[C];V.shapeFlag&1&&!V.dynamicChildren&&((V.patchFlag<=0||V.patchFlag===32)&&(V=T[C]=$u(T[C]),V.el=P.el),!d&&V.patchFlag!==-2&&Ob(P,V)),V.type===Mh&&(V.el=P.el)}}function cP(t){const l=t.slice(),d=[0];let _,T,C,P,V;const s=t.length;for(_=0;_<s;_++){const $=t[_];if($!==0){if(T=d[d.length-1],t[T]<$){l[_]=T,d.push(_);continue}for(C=0,P=d.length-1;C<P;)V=C+P>>1,t[d[V]]<$?C=V+1:P=V;$<t[d[C]]&&(C>0&&(l[_]=d[C-1]),d[C]=_)}}for(C=d.length,P=d[C-1];C-- >0;)d[C]=P,P=l[P];return d}function SS(t){const l=t.subTree.component;if(l)return l.asyncDep&&!l.asyncResolved?l:SS(l)}function Jy(t){if(t)for(let l=0;l<t.length;l++)t[l].flags|=8}const CS=Symbol.for("v-scx"),AS=()=>la(CS);function hP(t,l){return h_(t,null,l)}function uP(t,l){return h_(t,null,{flush:"post"})}function MS(t,l){return h_(t,null,{flush:"sync"})}function ca(t,l,d){return h_(t,l,d)}function h_(t,l,d=Fr){const{immediate:_,deep:T,flush:C,once:P}=d,V=Tn({},d),s=l&&_||!l&&C!=="post";let $;if(nm){if(C==="sync"){const ue=AS();$=ue.__watcherHandles||(ue.__watcherHandles=[])}else if(!s){const ue=()=>{};return ue.stop=nl,ue.resume=nl,ue.pause=nl,ue}}const Z=Ms;V.call=(ue,we,Me)=>ol(ue,Z,we,Me);let J=!1;C==="post"?V.scheduler=ue=>{As(ue,Z&&Z.suspense)}:C!=="sync"&&(J=!0,V.scheduler=(ue,we)=>{we?ue():Tb(ue)}),V.augmentJob=ue=>{l&&(ue.flags|=4),J&&(ue.flags|=2,Z&&(ue.id=Z.uid,ue.i=Z))};const ne=tk(t,l,V);return nm&&($?$.push(ne):s&&ne()),ne}function dP(t,l,d){const _=this.proxy,T=Dn(t)?t.includes(".")?IS(_,t):()=>_[t]:t.bind(_,_);let C;er(l)?C=l:(C=l.handler,d=l);const P=Lf(this),V=h_(T,C.bind(_),d);return P(),V}function IS(t,l){const d=l.split(".");return()=>{let _=t;for(let T=0;T<d.length&&_;T++)_=_[d[T]];return _}}function fP(t,l,d=Fr){const _=Zs(),T=qs(l),C=aa(l),P=kS(t,T),V=OE((s,$)=>{let Z,J=Fr,ne;return MS(()=>{const ue=t[T];zo(Z,ue)&&(Z=ue,$())}),{get(){return s(),d.get?d.get(Z):Z},set(ue){const we=d.set?d.set(ue):ue;if(!zo(we,Z)&&!(J!==Fr&&zo(ue,J)))return;const Me=_.vnode.props;Me&&(l in Me||T in Me||C in Me)&&(`onUpdate:${l}`in Me||`onUpdate:${T}`in Me||`onUpdate:${C}`in Me)||(Z=ue,$()),_.emit(`update:${l}`,we),zo(ue,we)&&zo(ue,J)&&!zo(we,ne)&&$(),J=ue,ne=we}}});return V[Symbol.iterator]=()=>{let s=0;return{next(){return s<2?{value:s++?P||Fr:V,done:!1}:{done:!0}}}},V}const kS=(t,l)=>l==="modelValue"||l==="model-value"?t.modelModifiers:t[`${l}Modifiers`]||t[`${qs(l)}Modifiers`]||t[`${aa(l)}Modifiers`];function pP(t,l,...d){if(t.isUnmounted)return;const _=t.vnode.props||Fr;let T=d;const C=l.startsWith("update:"),P=C&&kS(_,l.slice(7));P&&(P.trim&&(T=d.map(Z=>Dn(Z)?Z.trim():Z)),P.number&&(T=d.map(Wy)));let V,s=_[V=Ig(l)]||_[V=Ig(qs(l))];!s&&C&&(s=_[V=Ig(aa(l))]),s&&ol(s,t,6,T);const $=_[V+"Once"];if($){if(!t.emitted)t.emitted={};else if(t.emitted[V])return;t.emitted[V]=!0,ol($,t,6,T)}}function PS(t,l,d=!1){const _=l.emitsCache,T=_.get(t);if(T!==void 0)return T;const C=t.emits;let P={},V=!1;if(!er(t)){const s=$=>{const Z=PS($,l,!0);Z&&(V=!0,Tn(P,Z))};!d&&l.mixins.length&&l.mixins.forEach(s),t.extends&&s(t.extends),t.mixins&&t.mixins.forEach(s)}return!C&&!V?(gn(t)&&_.set(t,null),null):(Oi(C)?C.forEach(s=>P[s]=null):Tn(P,C),gn(t)&&_.set(t,P),P)}function Mx(t,l){return!t||!s_(l)?!1:(l=l.slice(2).replace(/Once$/,""),tn(t,l[0].toLowerCase()+l.slice(1))||tn(t,aa(l))||tn(t,l))}function zy(t){const{type:l,vnode:d,proxy:_,withProxy:T,propsOptions:[C],slots:P,attrs:V,emit:s,render:$,renderCache:Z,props:J,data:ne,setupState:ue,ctx:we,inheritAttrs:Me}=t,Ye=Wg(t);let Ze,Fe;try{if(d.shapeFlag&4){const ge=T||_,Oe=ge;Ze=oa($.call(Oe,ge,Z,J,ue,ne,we)),Fe=V}else{const ge=l;Ze=oa(ge.length>1?ge(J,{attrs:V,slots:P,emit:s}):ge(J,null)),Fe=l.props?V:gP(V)}}catch(ge){Rg.length=0,Rf(ge,t,1),Ze=fr(ws)}let ae=Ze;if(Fe&&Me!==!1){const ge=Object.keys(Fe),{shapeFlag:Oe}=ae;ge.length&&Oe&7&&(C&&ge.some(ub)&&(Fe=_P(Fe,C)),ae=Oc(ae,Fe,!1,!0))}return d.dirs&&(ae=Oc(ae,null,!1,!0),ae.dirs=ae.dirs?ae.dirs.concat(d.dirs):d.dirs),d.transition&&kh(ae,d.transition),Ze=ae,Wg(Ye),Ze}function mP(t,l=!0){let d;for(let _=0;_<t.length;_++){const T=t[_];if(Ph(T)){if(T.type!==ws||T.children==="v-if"){if(d)return;d=T}}else return}return d}const gP=t=>{let l;for(const d in t)(d==="class"||d==="style"||s_(d))&&((l||(l={}))[d]=t[d]);return l},_P=(t,l)=>{const d={};for(const _ in t)(!ub(_)||!(_.slice(9)in l))&&(d[_]=t[_]);return d};function yP(t,l,d){const{props:_,children:T,component:C}=t,{props:P,children:V,patchFlag:s}=l,$=C.emitsOptions;if(l.dirs||l.transition)return!0;if(d&&s>=0){if(s&1024)return!0;if(s&16)return _?ww(_,P,$):!!P;if(s&8){const Z=l.dynamicProps;for(let J=0;J<Z.length;J++){const ne=Z[J];if(P[ne]!==_[ne]&&!Mx($,ne))return!0}}}else return(T||V)&&(!V||!V.$stable)?!0:_===P?!1:_?P?ww(_,P,$):!0:!!P;return!1}function ww(t,l,d){const _=Object.keys(l);if(_.length!==Object.keys(t).length)return!0;for(let T=0;T<_.length;T++){const C=_[T];if(l[C]!==t[C]&&!Mx(d,C))return!0}return!1}function Ix({vnode:t,parent:l},d){for(;l;){const _=l.subTree;if(_.suspense&&_.suspense.activeBranch===t&&(_.el=t.el),_===t)(t=l.vnode).el=d,l=l.parent;else break}}const Qy=t=>t.__isSuspense;let O0=0;const xP={name:"Suspense",__isSuspense:!0,process(t,l,d,_,T,C,P,V,s,$){if(t==null)bP(l,d,_,T,C,P,V,s,$);else{if(C&&C.deps>0&&!t.suspense.isInFallback){l.suspense=t.suspense,l.suspense.vnode=l,l.el=t.el;return}wP(t,l,d,_,T,P,V,s,$)}},hydrate:TP,normalize:EP},vP=xP;function Xg(t,l){const d=t.props&&t.props[l];er(d)&&d()}function bP(t,l,d,_,T,C,P,V,s){const{p:$,o:{createElement:Z}}=s,J=Z("div"),ne=t.suspense=LS(t,T,_,l,J,d,C,P,V,s);$(null,ne.pendingBranch=t.ssContent,J,null,_,ne,C,P),ne.deps>0?(Xg(t,"onPending"),Xg(t,"onFallback"),$(null,t.ssFallback,l,d,_,null,C,P),im(ne,t.ssFallback)):ne.resolve(!1,!0)}function wP(t,l,d,_,T,C,P,V,{p:s,um:$,o:{createElement:Z}}){const J=l.suspense=t.suspense;J.vnode=l,l.el=t.el;const ne=l.ssContent,ue=l.ssFallback,{activeBranch:we,pendingBranch:Me,isInFallback:Ye,isHydrating:Ze}=J;if(Me)J.pendingBranch=ne,Ol(ne,Me)?(s(Me,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0?J.resolve():Ye&&(Ze||(s(we,ue,d,_,T,null,C,P,V),im(J,ue)))):(J.pendingId=O0++,Ze?(J.isHydrating=!1,J.activeBranch=Me):$(Me,T,J),J.deps=0,J.effects.length=0,J.hiddenContainer=Z("div"),Ye?(s(null,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0?J.resolve():(s(we,ue,d,_,T,null,C,P,V),im(J,ue))):we&&Ol(ne,we)?(s(we,ne,d,_,T,J,C,P,V),J.resolve(!0)):(s(null,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0&&J.resolve()));else if(we&&Ol(ne,we))s(we,ne,d,_,T,J,C,P,V),im(J,ne);else if(Xg(l,"onPending"),J.pendingBranch=ne,ne.shapeFlag&512?J.pendingId=ne.component.suspenseId:J.pendingId=O0++,s(null,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0)J.resolve();else{const{timeout:Fe,pendingId:ae}=J;Fe>0?setTimeout(()=>{J.pendingId===ae&&J.fallback(ue)},Fe):Fe===0&&J.fallback(ue)}}function LS(t,l,d,_,T,C,P,V,s,$,Z=!1){const{p:J,m:ne,um:ue,n:we,o:{parentNode:Me,remove:Ye}}=$;let Ze;const Fe=SP(t);Fe&&l&&l.pendingBranch&&(Ze=l.pendingId,l.deps++);const ae=t.props?Hy(t.props.timeout):void 0,ge=C,Oe={vnode:t,parent:l,parentComponent:d,namespace:P,container:_,hiddenContainer:T,deps:0,pendingId:O0++,timeout:typeof ae=="number"?ae:-1,activeBranch:null,pendingBranch:null,isInFallback:!Z,isHydrating:Z,isUnmounted:!1,effects:[],resolve(ze=!1,rt=!1){const{vnode:Ie,activeBranch:Je,pendingBranch:He,pendingId:ti,effects:bt,parentComponent:wt,container:xt}=Oe;let Tt=!1;Oe.isHydrating?Oe.isHydrating=!1:ze||(Tt=Je&&He.transition&&He.transition.mode==="out-in",Tt&&(Je.transition.afterLeave=()=>{ti===Oe.pendingId&&(ne(He,xt,C===ge?we(Je):C,0),$g(bt))}),Je&&(Me(Je.el)===xt&&(C=we(Je)),ue(Je,wt,Oe,!0)),Tt||ne(He,xt,C,0)),im(Oe,He),Oe.pendingBranch=null,Oe.isInFallback=!1;let vt=Oe.parent,ai=!1;for(;vt;){if(vt.pendingBranch){vt.effects.push(...bt),ai=!0;break}vt=vt.parent}!ai&&!Tt&&$g(bt),Oe.effects=[],Fe&&l&&l.pendingBranch&&Ze===l.pendingId&&(l.deps--,l.deps===0&&!rt&&l.resolve()),Xg(Ie,"onResolve")},fallback(ze){if(!Oe.pendingBranch)return;const{vnode:rt,activeBranch:Ie,parentComponent:Je,container:He,namespace:ti}=Oe;Xg(rt,"onFallback");const bt=we(Ie),wt=()=>{Oe.isInFallback&&(J(null,ze,He,bt,Je,null,ti,V,s),im(Oe,ze))},xt=ze.transition&&ze.transition.mode==="out-in";xt&&(Ie.transition.afterLeave=wt),Oe.isInFallback=!0,ue(Ie,Je,null,!0),xt||wt()},move(ze,rt,Ie){Oe.activeBranch&&ne(Oe.activeBranch,ze,rt,Ie),Oe.container=ze},next(){return Oe.activeBranch&&we(Oe.activeBranch)},registerDep(ze,rt,Ie){const Je=!!Oe.pendingBranch;Je&&Oe.deps++;const He=ze.vnode.el;ze.asyncDep.catch(ti=>{Rf(ti,ze,0)}).then(ti=>{if(ze.isUnmounted||Oe.isUnmounted||Oe.pendingId!==ze.suspenseId)return;ze.asyncResolved=!0;const{vnode:bt}=ze;F0(ze,ti,!1),He&&(bt.el=He);const wt=!He&&ze.subTree.el;rt(ze,bt,Me(He||ze.subTree.el),He?null:we(ze.subTree),Oe,P,Ie),wt&&Ye(wt),Ix(ze,bt.el),Je&&--Oe.deps===0&&Oe.resolve()})},unmount(ze,rt){Oe.isUnmounted=!0,Oe.activeBranch&&ue(Oe.activeBranch,d,ze,rt),Oe.pendingBranch&&ue(Oe.pendingBranch,d,ze,rt)}};return Oe}function TP(t,l,d,_,T,C,P,V,s){const $=l.suspense=LS(l,_,d,t.parentNode,document.createElement("div"),null,T,C,P,V,!0),Z=s(t,$.pendingBranch=l.ssContent,d,$,C,P);return $.deps===0&&$.resolve(!1,!0),Z}function EP(t){const{shapeFlag:l,children:d}=t,_=l&32;t.ssContent=Tw(_?d.default:d),t.ssFallback=_?Tw(d.fallback):fr(ws)}function Tw(t){let l;if(er(t)){const d=Pf&&t._c;d&&(t._d=!1,gi()),t=t(),d&&(t._d=!0,l=go,OS())}return Oi(t)&&(t=mP(t)),t=oa(t),l&&!t.dynamicChildren&&(t.dynamicChildren=l.filter(d=>d!==t)),t}function DS(t,l){l&&l.pendingBranch?Oi(t)?l.effects.push(...t):l.effects.push(t):$g(t)}function im(t,l){t.activeBranch=l;const{vnode:d,parentComponent:_}=t;let T=l.el;for(;!T&&l.component;)l=l.component.subTree,T=l.el;d.el=T,_&&_.subTree===d&&(_.vnode.el=T,Ix(_,T))}function SP(t){const l=t.props&&t.props.suspensible;return l!=null&&l!==!1}const jr=Symbol.for("v-fgt"),Mh=Symbol.for("v-txt"),ws=Symbol.for("v-cmt"),If=Symbol.for("v-stc"),Rg=[];let go=null;function gi(t=!1){Rg.push(go=t?null:[])}function OS(){Rg.pop(),go=Rg[Rg.length-1]||null}let Pf=1;function R0(t,l=!1){Pf+=t,t<0&&go&&l&&(go.hasOnce=!0)}function RS(t){return t.dynamicChildren=Pf>0?go||Kp:null,OS(),Pf>0&&go&&go.push(t),t}function ki(t,l,d,_,T,C){return RS(ot(t,l,d,_,T,C,!0))}function Fo(t,l,d,_,T){return RS(fr(t,l,d,_,T,!0))}function Ph(t){return t?t.__v_isVNode===!0:!1}function Ol(t,l){return t.type===l.type&&t.key===l.key}function CP(t){}const zS=({key:t})=>t??null,By=({ref:t,ref_key:l,ref_for:d})=>(typeof t=="number"&&(t=""+t),t!=null?Dn(t)||Ln(t)||er(t)?{i:Is,r:t,k:l,f:!!d}:t:null);function ot(t,l=null,d=null,_=0,T=null,C=t===jr?0:1,P=!1,V=!1){const s={__v_isVNode:!0,__v_skip:!0,type:t,props:l,key:l&&zS(l),ref:l&&By(l),scopeId:wx,slotScopeIds:null,children:d,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:C,patchFlag:_,dynamicProps:T,dynamicChildren:null,appContext:null,ctx:Is};return V?(Rb(s,d),C&128&&t.normalize(s)):d&&(s.shapeFlag|=Dn(d)?8:16),Pf>0&&!P&&go&&(s.patchFlag>0||C&6)&&s.patchFlag!==32&&go.push(s),s}const fr=AP;function AP(t,l=null,d=null,_=0,T=null,C=!1){if((!t||t===sS)&&(t=ws),Ph(t)){const V=Oc(t,l,!0);return d&&Rb(V,d),Pf>0&&!C&&go&&(V.shapeFlag&6?go[go.indexOf(t)]=V:go.push(V)),V.patchFlag=-2,V}if(OP(t)&&(t=t.__vccOpts),l){l=BS(l);let{class:V,style:s}=l;V&&!Dn(V)&&(l.class=Us(V)),gn(s)&&(vx(s)&&!Oi(s)&&(s=Tn({},s)),l.style=Rc(s))}const P=Dn(t)?1:Qy(t)?128:WE(t)?64:gn(t)?4:er(t)?2:0;return ot(t,l,d,_,T,P,C,!0)}function BS(t){return t?vx(t)||pS(t)?Tn({},t):t:null}function Oc(t,l,d=!1,_=!1){const{props:T,ref:C,patchFlag:P,children:V,transition:s}=t,$=l?u_(T||{},l):T,Z={__v_isVNode:!0,__v_skip:!0,type:t.type,props:$,key:$&&zS($),ref:l&&l.ref?d&&C?Oi(C)?C.concat(By(l)):[C,By(l)]:By(l):C,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:V,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:l&&t.type!==jr?P===-1?16:P|16:P,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:s,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Oc(t.ssContent),ssFallback:t.ssFallback&&Oc(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return s&&_&&kh(Z,s.clone(Z)),Z}function Vs(t=" ",l=0){return fr(Mh,null,t,l)}function Zg(t,l){const d=fr(If,null,t);return d.staticCount=l,d}function wn(t="",l=!1){return l?(gi(),Fo(ws,null,t)):fr(ws,null,t)}function oa(t){return t==null||typeof t=="boolean"?fr(ws):Oi(t)?fr(jr,null,t.slice()):Ph(t)?$u(t):fr(Mh,null,String(t))}function $u(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Oc(t)}function Rb(t,l){let d=0;const{shapeFlag:_}=t;if(l==null)l=null;else if(Oi(l))d=16;else if(typeof l=="object")if(_&65){const T=l.default;T&&(T._c&&(T._d=!1),Rb(t,T()),T._c&&(T._d=!0));return}else{d=32;const T=l._;!T&&!pS(l)?l._ctx=Is:T===3&&Is&&(Is.slots._===1?l._=1:(l._=2,t.patchFlag|=1024))}else er(l)?(l={default:l,_ctx:Is},d=32):(l=String(l),_&64?(d=16,l=[Vs(l)]):d=8);t.children=l,t.shapeFlag|=d}function u_(...t){const l={};for(let d=0;d<t.length;d++){const _=t[d];for(const T in _)if(T==="class")l.class!==_.class&&(l.class=Us([l.class,_.class]));else if(T==="style")l.style=Rc([l.style,_.style]);else if(s_(T)){const C=l[T],P=_[T];P&&C!==P&&!(Oi(C)&&C.includes(P))&&(l[T]=C?[].concat(C,P):P)}else T!==""&&(l[T]=_[T])}return l}function sa(t,l,d,_=null){ol(t,l,7,[d,_])}const MP=hS();let IP=0;function FS(t,l,d){const _=t.type,T=(l?l.appContext:t.appContext)||MP,C={uid:IP++,vnode:t,type:_,parent:l,appContext:T,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new mb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:l?l.provides:Object.create(T.provides),ids:l?l.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:gS(_,T),emitsOptions:PS(_,T),emit:null,emitted:null,propsDefaults:Fr,inheritAttrs:_.inheritAttrs,ctx:Fr,data:Fr,props:Fr,attrs:Fr,slots:Fr,refs:Fr,setupState:Fr,setupContext:null,suspense:d,suspenseId:d?d.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return C.ctx={_:C},C.root=l?l.root:C,C.emit=pP.bind(null,C),t.ce&&t.ce(C),C}let Ms=null;const Zs=()=>Ms||Is;let ex,z0;{const t=fx(),l=(d,_)=>{let T;return(T=t[d])||(T=t[d]=[]),T.push(_),C=>{T.length>1?T.forEach(P=>P(C)):T[0](C)}};ex=l("__VUE_INSTANCE_SETTERS__",d=>Ms=d),z0=l("__VUE_SSR_SETTERS__",d=>nm=d)}const Lf=t=>{const l=Ms;return ex(t),t.scope.on(),()=>{t.scope.off(),ex(l)}},B0=()=>{Ms&&Ms.scope.off(),ex(null)};function NS(t){return t.vnode.shapeFlag&4}let nm=!1;function US(t,l=!1,d=!1){l&&z0(l);const{props:_,children:T}=t.vnode,C=NS(t);rP(t,_,C,l),aP(t,T,d);const P=C?kP(t,l):void 0;return l&&z0(!1),P}function kP(t,l){const d=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,k0);const{setup:_}=d;if(_){Yu();const T=t.setupContext=_.length>1?jS(t):null,C=Lf(t),P=fm(_,t,0,[t.props,T]),V=fb(P);if(Ku(),C(),(V||t.sp)&&!Wu(t)&&Cb(t),V){if(P.then(B0,B0),l)return P.then(s=>{F0(t,s,l)}).catch(s=>{Rf(s,t,0)});t.asyncDep=P}else F0(t,P,l)}else VS(t,l)}function F0(t,l,d){er(l)?t.type.__ssrInlineRender?t.ssrRender=l:t.render=l:gn(l)&&(t.setupState=wb(l)),VS(t,d)}let tx,N0;function PP(t){tx=t,N0=l=>{l.render._rc&&(l.withProxy=new Proxy(l.ctx,zk))}}const LP=()=>!tx;function VS(t,l,d){const _=t.type;if(!t.render){if(!l&&tx&&!_.render){const T=_.template||Lb(t).template;if(T){const{isCustomElement:C,compilerOptions:P}=t.appContext.config,{delimiters:V,compilerOptions:s}=_,$=Tn(Tn({isCustomElement:C,delimiters:V},P),s);_.render=tx(T,$)}}t.render=_.render||nl,N0&&N0(t)}{const T=Lf(t);Yu();try{Yk(t)}finally{Ku(),T()}}}const DP={get(t,l){return fo(t,"get",""),t[l]}};function jS(t){const l=d=>{t.exposed=d||{}};return{attrs:new Proxy(t.attrs,DP),slots:t.slots,emit:t.emit,expose:l}}function d_(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(wb(bx(t.exposed)),{get(l,d){if(d in l)return l[d];if(d in Dg)return Dg[d](t)},has(l,d){return d in l||d in Dg}})):t.proxy}function U0(t,l=!0){return er(t)?t.displayName||t.name:t.name||l&&t.__name}function OP(t){return er(t)&&"__vccOpts"in t}const un=(t,l)=>KI(t,l,nm);function pm(t,l,d){const _=arguments.length;return _===2?gn(l)&&!Oi(l)?Ph(l)?fr(t,null,[l]):fr(t,l):fr(t,null,l):(_>3?d=Array.prototype.slice.call(arguments,2):_===3&&Ph(d)&&(d=[d]),fr(t,l,d))}function RP(){}function zP(t,l,d,_){const T=d[_];if(T&&$S(T,t))return T;const C=l();return C.memo=t.slice(),C.cacheIndex=_,d[_]=C}function $S(t,l){const d=t.memo;if(d.length!=l.length)return!1;for(let _=0;_<d.length;_++)if(zo(d[_],l[_]))return!1;return Pf>0&&go&&go.push(t),!0}const GS="3.5.13",BP=nl,FP=ok,NP=Hp,UP=$E,VP={createComponentInstance:FS,setupComponent:US,renderComponentRoot:zy,setCurrentRenderingInstance:Wg,isVNode:Ph,normalizeVNode:oa,getComponentPublicInstance:d_,ensureValidVNode:Pb,pushWarningContext:ik,popWarningContext:rk},jP=VP,$P=null,GP=null,WP=null;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let V0;const Ew=typeof window<"u"&&window.trustedTypes;if(Ew)try{V0=Ew.createPolicy("vue",{createHTML:t=>t})}catch{}const WS=V0?t=>V0.createHTML(t):t=>t,HP="http://www.w3.org/2000/svg",qP="http://www.w3.org/1998/Math/MathML",bh=typeof document<"u"?document:null,Sw=bh&&bh.createElement("template"),XP={insert:(t,l,d)=>{l.insertBefore(t,d||null)},remove:t=>{const l=t.parentNode;l&&l.removeChild(t)},createElement:(t,l,d,_)=>{const T=l==="svg"?bh.createElementNS(HP,t):l==="mathml"?bh.createElementNS(qP,t):d?bh.createElement(t,{is:d}):bh.createElement(t);return t==="select"&&_&&_.multiple!=null&&T.setAttribute("multiple",_.multiple),T},createText:t=>bh.createTextNode(t),createComment:t=>bh.createComment(t),setText:(t,l)=>{t.nodeValue=l},setElementText:(t,l)=>{t.textContent=l},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>bh.querySelector(t),setScopeId(t,l){t.setAttribute(l,"")},insertStaticContent(t,l,d,_,T,C){const P=d?d.previousSibling:l.lastChild;if(T&&(T===C||T.nextSibling))for(;l.insertBefore(T.cloneNode(!0),d),!(T===C||!(T=T.nextSibling)););else{Sw.innerHTML=WS(_==="svg"?`<svg>${t}</svg>`:_==="mathml"?`<math>${t}</math>`:t);const V=Sw.content;if(_==="svg"||_==="mathml"){const s=V.firstChild;for(;s.firstChild;)V.appendChild(s.firstChild);V.removeChild(s)}l.insertBefore(V,d)}return[P?P.nextSibling:l.firstChild,d?d.previousSibling:l.lastChild]}},Ru="transition",wg="animation",sm=Symbol("_vtc"),HS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},qS=Tn({},Sb,HS),ZP=t=>(t.displayName="Transition",t.props=qS,t),zb=ZP((t,{slots:l})=>pm(YE,XS(t),l)),wf=(t,l=[])=>{Oi(t)?t.forEach(d=>d(...l)):t&&t(...l)},Cw=t=>t?Oi(t)?t.some(l=>l.length>1):t.length>1:!1;function XS(t){const l={};for(const bt in t)bt in HS||(l[bt]=t[bt]);if(t.css===!1)return l;const{name:d="v",type:_,duration:T,enterFromClass:C=`${d}-enter-from`,enterActiveClass:P=`${d}-enter-active`,enterToClass:V=`${d}-enter-to`,appearFromClass:s=C,appearActiveClass:$=P,appearToClass:Z=V,leaveFromClass:J=`${d}-leave-from`,leaveActiveClass:ne=`${d}-leave-active`,leaveToClass:ue=`${d}-leave-to`}=t,we=YP(T),Me=we&&we[0],Ye=we&&we[1],{onBeforeEnter:Ze,onEnter:Fe,onEnterCancelled:ae,onLeave:ge,onLeaveCancelled:Oe,onBeforeAppear:ze=Ze,onAppear:rt=Fe,onAppearCancelled:Ie=ae}=l,Je=(bt,wt,xt,Tt)=>{bt._enterCancelled=Tt,Fu(bt,wt?Z:V),Fu(bt,wt?$:P),xt&&xt()},He=(bt,wt)=>{bt._isLeaving=!1,Fu(bt,J),Fu(bt,ue),Fu(bt,ne),wt&&wt()},ti=bt=>(wt,xt)=>{const Tt=bt?rt:Fe,vt=()=>Je(wt,bt,xt);wf(Tt,[wt,vt]),Aw(()=>{Fu(wt,bt?s:C),Mc(wt,bt?Z:V),Cw(Tt)||Mw(wt,_,Me,vt)})};return Tn(l,{onBeforeEnter(bt){wf(Ze,[bt]),Mc(bt,C),Mc(bt,P)},onBeforeAppear(bt){wf(ze,[bt]),Mc(bt,s),Mc(bt,$)},onEnter:ti(!1),onAppear:ti(!0),onLeave(bt,wt){bt._isLeaving=!0;const xt=()=>He(bt,wt);Mc(bt,J),bt._enterCancelled?(Mc(bt,ne),j0()):(j0(),Mc(bt,ne)),Aw(()=>{bt._isLeaving&&(Fu(bt,J),Mc(bt,ue),Cw(ge)||Mw(bt,_,Ye,xt))}),wf(ge,[bt,xt])},onEnterCancelled(bt){Je(bt,!1,void 0,!0),wf(ae,[bt])},onAppearCancelled(bt){Je(bt,!0,void 0,!0),wf(Ie,[bt])},onLeaveCancelled(bt){He(bt),wf(Oe,[bt])}})}function YP(t){if(t==null)return null;if(gn(t))return[c0(t.enter),c0(t.leave)];{const l=c0(t);return[l,l]}}function c0(t){return Hy(t)}function Mc(t,l){l.split(/\s+/).forEach(d=>d&&t.classList.add(d)),(t[sm]||(t[sm]=new Set)).add(l)}function Fu(t,l){l.split(/\s+/).forEach(_=>_&&t.classList.remove(_));const d=t[sm];d&&(d.delete(l),d.size||(t[sm]=void 0))}function Aw(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let KP=0;function Mw(t,l,d,_){const T=t._endId=++KP,C=()=>{T===t._endId&&_()};if(d!=null)return setTimeout(C,d);const{type:P,timeout:V,propCount:s}=ZS(t,l);if(!P)return _();const $=P+"end";let Z=0;const J=()=>{t.removeEventListener($,ne),C()},ne=ue=>{ue.target===t&&++Z>=s&&J()};setTimeout(()=>{Z<s&&J()},V+1),t.addEventListener($,ne)}function ZS(t,l){const d=window.getComputedStyle(t),_=we=>(d[we]||"").split(", "),T=_(`${Ru}Delay`),C=_(`${Ru}Duration`),P=Iw(T,C),V=_(`${wg}Delay`),s=_(`${wg}Duration`),$=Iw(V,s);let Z=null,J=0,ne=0;l===Ru?P>0&&(Z=Ru,J=P,ne=C.length):l===wg?$>0&&(Z=wg,J=$,ne=s.length):(J=Math.max(P,$),Z=J>0?P>$?Ru:wg:null,ne=Z?Z===Ru?C.length:s.length:0);const ue=Z===Ru&&/\b(transform|all)(,|$)/.test(_(`${Ru}Property`).toString());return{type:Z,timeout:J,propCount:ne,hasTransform:ue}}function Iw(t,l){for(;t.length<l.length;)t=t.concat(t);return Math.max(...l.map((d,_)=>kw(d)+kw(t[_])))}function kw(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function j0(){return document.body.offsetHeight}function JP(t,l,d){const _=t[sm];_&&(l=(l?[l,..._]:[..._]).join(" ")),l==null?t.removeAttribute("class"):d?t.setAttribute("class",l):t.className=l}const ix=Symbol("_vod"),YS=Symbol("_vsh"),KS={beforeMount(t,{value:l},{transition:d}){t[ix]=t.style.display==="none"?"":t.style.display,d&&l?d.beforeEnter(t):Tg(t,l)},mounted(t,{value:l},{transition:d}){d&&l&&d.enter(t)},updated(t,{value:l,oldValue:d},{transition:_}){!l!=!d&&(_?l?(_.beforeEnter(t),Tg(t,!0),_.enter(t)):_.leave(t,()=>{Tg(t,!1)}):Tg(t,l))},beforeUnmount(t,{value:l}){Tg(t,l)}};function Tg(t,l){t.style.display=l?t[ix]:"none",t[YS]=!l}function QP(){KS.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const JS=Symbol("");function eL(t){const l=Zs();if(!l)return;const d=l.ut=(T=t(l.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${l.uid}"]`)).forEach(C=>rx(C,T))},_=()=>{const T=t(l.proxy);l.ce?rx(l.ce,T):$0(l.subTree,T),d(T)};Mb(()=>{$g(_)}),Dh(()=>{ca(_,nl,{flush:"post"});const T=new MutationObserver(_);T.observe(l.subTree.el.parentNode,{childList:!0}),c_(()=>T.disconnect())})}function $0(t,l){if(t.shapeFlag&128){const d=t.suspense;t=d.activeBranch,d.pendingBranch&&!d.isHydrating&&d.effects.push(()=>{$0(d.activeBranch,l)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)rx(t.el,l);else if(t.type===jr)t.children.forEach(d=>$0(d,l));else if(t.type===If){let{el:d,anchor:_}=t;for(;d&&(rx(d,l),d!==_);)d=d.nextSibling}}function rx(t,l){if(t.nodeType===1){const d=t.style;let _="";for(const T in l)d.setProperty(`--${T}`,l[T]),_+=`--${T}: ${l[T]};`;d[JS]=_}}const tL=/(^|;)\s*display\s*:/;function iL(t,l,d){const _=t.style,T=Dn(d);let C=!1;if(d&&!T){if(l)if(Dn(l))for(const P of l.split(";")){const V=P.slice(0,P.indexOf(":")).trim();d[V]==null&&Fy(_,V,"")}else for(const P in l)d[P]==null&&Fy(_,P,"");for(const P in d)P==="display"&&(C=!0),Fy(_,P,d[P])}else if(T){if(l!==d){const P=_[JS];P&&(d+=";"+P),_.cssText=d,C=tL.test(d)}}else l&&t.removeAttribute("style");ix in t&&(t[ix]=C?_.display:"",t[YS]&&(_.display="none"))}const Pw=/\s*!important$/;function Fy(t,l,d){if(Oi(d))d.forEach(_=>Fy(t,l,_));else if(d==null&&(d=""),l.startsWith("--"))t.setProperty(l,d);else{const _=rL(t,l);Pw.test(d)?t.setProperty(aa(_),d.replace(Pw,""),"important"):t[_]=d}}const Lw=["Webkit","Moz","ms"],h0={};function rL(t,l){const d=h0[l];if(d)return d;let _=qs(l);if(_!=="filter"&&_ in t)return h0[l]=_;_=o_(_);for(let T=0;T<Lw.length;T++){const C=Lw[T]+_;if(C in t)return h0[l]=C}return l}const Dw="http://www.w3.org/1999/xlink";function Ow(t,l,d,_,T,C=xI(l)){_&&l.startsWith("xlink:")?d==null?t.removeAttributeNS(Dw,l.slice(6,l.length)):t.setAttributeNS(Dw,l,d):d==null||C&&!pE(d)?t.removeAttribute(l):t.setAttribute(l,C?"":Ul(d)?String(d):d)}function Rw(t,l,d,_,T){if(l==="innerHTML"||l==="textContent"){d!=null&&(t[l]=l==="innerHTML"?WS(d):d);return}const C=t.tagName;if(l==="value"&&C!=="PROGRESS"&&!C.includes("-")){const V=C==="OPTION"?t.getAttribute("value")||"":t.value,s=d==null?t.type==="checkbox"?"on":"":String(d);(V!==s||!("_value"in t))&&(t.value=s),d==null&&t.removeAttribute(l),t._value=d;return}let P=!1;if(d===""||d==null){const V=typeof t[l];V==="boolean"?d=pE(d):d==null&&V==="string"?(d="",P=!0):V==="number"&&(d=0,P=!0)}try{t[l]=d}catch{}P&&t.removeAttribute(T||l)}function Eh(t,l,d,_){t.addEventListener(l,d,_)}function nL(t,l,d,_){t.removeEventListener(l,d,_)}const zw=Symbol("_vei");function sL(t,l,d,_,T=null){const C=t[zw]||(t[zw]={}),P=C[l];if(_&&P)P.value=_;else{const[V,s]=oL(l);if(_){const $=C[l]=cL(_,T);Eh(t,V,$,s)}else P&&(nL(t,V,P,s),C[l]=void 0)}}const Bw=/(?:Once|Passive|Capture)$/;function oL(t){let l;if(Bw.test(t)){l={};let _;for(;_=t.match(Bw);)t=t.slice(0,t.length-_[0].length),l[_[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):aa(t.slice(2)),l]}let u0=0;const aL=Promise.resolve(),lL=()=>u0||(aL.then(()=>u0=0),u0=Date.now());function cL(t,l){const d=_=>{if(!_._vts)_._vts=Date.now();else if(_._vts<=d.attached)return;ol(hL(_,d.value),l,5,[_])};return d.value=t,d.attached=lL(),d}function hL(t,l){if(Oi(l)){const d=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{d.call(t),t._stopped=!0},l.map(_=>T=>!T._stopped&&_&&_(T))}else return l}const Fw=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,uL=(t,l,d,_,T,C)=>{const P=T==="svg";l==="class"?JP(t,_,P):l==="style"?iL(t,d,_):s_(l)?ub(l)||sL(t,l,d,_,C):(l[0]==="."?(l=l.slice(1),!0):l[0]==="^"?(l=l.slice(1),!1):dL(t,l,_,P))?(Rw(t,l,_),!t.tagName.includes("-")&&(l==="value"||l==="checked"||l==="selected")&&Ow(t,l,_,P,C,l!=="value")):t._isVueCE&&(/[A-Z]/.test(l)||!Dn(_))?Rw(t,qs(l),_,C,l):(l==="true-value"?t._trueValue=_:l==="false-value"&&(t._falseValue=_),Ow(t,l,_,P))};function dL(t,l,d,_){if(_)return!!(l==="innerHTML"||l==="textContent"||l in t&&Fw(l)&&er(d));if(l==="spellcheck"||l==="draggable"||l==="translate"||l==="form"||l==="list"&&t.tagName==="INPUT"||l==="type"&&t.tagName==="TEXTAREA")return!1;if(l==="width"||l==="height"){const T=t.tagName;if(T==="IMG"||T==="VIDEO"||T==="CANVAS"||T==="SOURCE")return!1}return Fw(l)&&Dn(d)?!1:l in t}const Nw={};/*! #__NO_SIDE_EFFECTS__ */function QS(t,l,d){const _=On(t,l);ux(_)&&Tn(_,l);class T extends kx{constructor(P){super(_,P,d)}}return T.def=_,T}/*! #__NO_SIDE_EFFECTS__ */const fL=(t,l)=>QS(t,l,uC),pL=typeof HTMLElement<"u"?HTMLElement:class{};class kx extends pL{constructor(l,d={},_=Kg){super(),this._def=l,this._props=d,this._createApp=_,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&_!==Kg?this._root=this.shadowRoot:l.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let l=this;for(;l=l&&(l.parentNode||l.host);)if(l instanceof kx){this._parent=l;break}this._instance||(this._resolved?(this._setParent(),this._update()):l&&l._pendingResolve?this._pendingResolve=l._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(l=this._parent){l&&(this._instance.parent=l._instance,this._instance.provides=l._instance.provides)}disconnectedCallback(){this._connected=!1,zf(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let _=0;_<this.attributes.length;_++)this._setAttr(this.attributes[_].name);this._ob=new MutationObserver(_=>{for(const T of _)this._setAttr(T.attributeName)}),this._ob.observe(this,{attributes:!0});const l=(_,T=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:C,styles:P}=_;let V;if(C&&!Oi(C))for(const s in C){const $=C[s];($===Number||$&&$.type===Number)&&(s in this._props&&(this._props[s]=Hy(this._props[s])),(V||(V=Object.create(null)))[qs(s)]=!0)}this._numberProps=V,T&&this._resolveProps(_),this.shadowRoot&&this._applyStyles(P),this._mount(_)},d=this._def.__asyncLoader;d?this._pendingResolve=d().then(_=>l(this._def=_,!0)):l(this._def)}_mount(l){this._app=this._createApp(l),l.configureApp&&l.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const d=this._instance&&this._instance.exposed;if(d)for(const _ in d)tn(this,_)||Object.defineProperty(this,_,{get:()=>ns(d[_])})}_resolveProps(l){const{props:d}=l,_=Oi(d)?d:Object.keys(d||{});for(const T of Object.keys(this))T[0]!=="_"&&_.includes(T)&&this._setProp(T,this[T]);for(const T of _.map(qs))Object.defineProperty(this,T,{get(){return this._getProp(T)},set(C){this._setProp(T,C,!0,!0)}})}_setAttr(l){if(l.startsWith("data-v-"))return;const d=this.hasAttribute(l);let _=d?this.getAttribute(l):Nw;const T=qs(l);d&&this._numberProps&&this._numberProps[T]&&(_=Hy(_)),this._setProp(T,_,!1,!0)}_getProp(l){return this._props[l]}_setProp(l,d,_=!0,T=!1){if(d!==this._props[l]&&(d===Nw?delete this._props[l]:(this._props[l]=d,l==="key"&&this._app&&(this._app._ceVNode.key=d)),T&&this._instance&&this._update(),_)){const C=this._ob;C&&C.disconnect(),d===!0?this.setAttribute(aa(l),""):typeof d=="string"||typeof d=="number"?this.setAttribute(aa(l),d+""):d||this.removeAttribute(aa(l)),C&&C.observe(this,{attributes:!0})}}_update(){hC(this._createVNode(),this._root)}_createVNode(){const l={};this.shadowRoot||(l.onVnodeMounted=l.onVnodeUpdated=this._renderSlots.bind(this));const d=fr(this._def,Tn(l,this._props));return this._instance||(d.ce=_=>{this._instance=_,_.ce=this,_.isCE=!0;const T=(C,P)=>{this.dispatchEvent(new CustomEvent(C,ux(P[0])?Tn({detail:P},P[0]):{detail:P}))};_.emit=(C,...P)=>{T(C,P),aa(C)!==C&&T(aa(C),P)},this._setParent()}),d}_applyStyles(l,d){if(!l)return;if(d){if(d===this._def||this._styleChildren.has(d))return;this._styleChildren.add(d)}const _=this._nonce;for(let T=l.length-1;T>=0;T--){const C=document.createElement("style");_&&C.setAttribute("nonce",_),C.textContent=l[T],this.shadowRoot.prepend(C)}}_parseSlots(){const l=this._slots={};let d;for(;d=this.firstChild;){const _=d.nodeType===1&&d.getAttribute("slot")||"default";(l[_]||(l[_]=[])).push(d),this.removeChild(d)}}_renderSlots(){const l=(this._teleportTarget||this).querySelectorAll("slot"),d=this._instance.type.__scopeId;for(let _=0;_<l.length;_++){const T=l[_],C=T.getAttribute("name")||"default",P=this._slots[C],V=T.parentNode;if(P)for(const s of P){if(d&&s.nodeType===1){const $=d+"-s",Z=document.createTreeWalker(s,1);s.setAttribute($,"");let J;for(;J=Z.nextNode();)J.setAttribute($,"")}V.insertBefore(s,T)}else for(;T.firstChild;)V.insertBefore(T.firstChild,T);V.removeChild(T)}}_injectChildStyle(l){this._applyStyles(l.styles,l)}_removeChildStyle(l){}}function eC(t){const l=Zs(),d=l&&l.ce;return d||null}function mL(){const t=eC();return t&&t.shadowRoot}function gL(t="$style"){{const l=Zs();if(!l)return Fr;const d=l.type.__cssModules;if(!d)return Fr;const _=d[t];return _||Fr}}const tC=new WeakMap,iC=new WeakMap,nx=Symbol("_moveCb"),Uw=Symbol("_enterCb"),_L=t=>(delete t.props.mode,t),yL=_L({name:"TransitionGroup",props:Tn({},qS,{tag:String,moveClass:String}),setup(t,{slots:l}){const d=Zs(),_=Eb();let T,C;return Sx(()=>{if(!T.length)return;const P=t.moveClass||`${t.name||"v"}-move`;if(!wL(T[0].el,d.vnode.el,P))return;T.forEach(xL),T.forEach(vL);const V=T.filter(bL);j0(),V.forEach(s=>{const $=s.el,Z=$.style;Mc($,P),Z.transform=Z.webkitTransform=Z.transitionDuration="";const J=$[nx]=ne=>{ne&&ne.target!==$||(!ne||/transform$/.test(ne.propertyName))&&($.removeEventListener("transitionend",J),$[nx]=null,Fu($,P))};$.addEventListener("transitionend",J)})}),()=>{const P=Ir(t),V=XS(P);let s=P.tag||jr;if(T=[],C)for(let $=0;$<C.length;$++){const Z=C[$];Z.el&&Z.el instanceof Element&&(T.push(Z),kh(Z,rm(Z,V,_,d)),tC.set(Z,Z.el.getBoundingClientRect()))}C=l.default?Tx(l.default()):[];for(let $=0;$<C.length;$++){const Z=C[$];Z.key!=null&&kh(Z,rm(Z,V,_,d))}return fr(s,null,C)}}}),rC=yL;function xL(t){const l=t.el;l[nx]&&l[nx](),l[Uw]&&l[Uw]()}function vL(t){iC.set(t,t.el.getBoundingClientRect())}function bL(t){const l=tC.get(t),d=iC.get(t),_=l.left-d.left,T=l.top-d.top;if(_||T){const C=t.el.style;return C.transform=C.webkitTransform=`translate(${_}px,${T}px)`,C.transitionDuration="0s",t}}function wL(t,l,d){const _=t.cloneNode(),T=t[sm];T&&T.forEach(V=>{V.split(/\s+/).forEach(s=>s&&_.classList.remove(s))}),d.split(/\s+/).forEach(V=>V&&_.classList.add(V)),_.style.display="none";const C=l.nodeType===1?l:l.parentNode;C.appendChild(_);const{hasTransform:P}=ZS(_);return C.removeChild(_),P}const Xu=t=>{const l=t.props["onUpdate:modelValue"]||!1;return Oi(l)?d=>em(l,d):l};function TL(t){t.target.composing=!0}function Vw(t){const l=t.target;l.composing&&(l.composing=!1,l.dispatchEvent(new Event("input")))}const sl=Symbol("_assign"),il={created(t,{modifiers:{lazy:l,trim:d,number:_}},T){t[sl]=Xu(T);const C=_||T.props&&T.props.type==="number";Eh(t,l?"change":"input",P=>{if(P.target.composing)return;let V=t.value;d&&(V=V.trim()),C&&(V=Wy(V)),t[sl](V)}),d&&Eh(t,"change",()=>{t.value=t.value.trim()}),l||(Eh(t,"compositionstart",TL),Eh(t,"compositionend",Vw),Eh(t,"change",Vw))},mounted(t,{value:l}){t.value=l??""},beforeUpdate(t,{value:l,oldValue:d,modifiers:{lazy:_,trim:T,number:C}},P){if(t[sl]=Xu(P),t.composing)return;const V=(C||t.type==="number")&&!/^0\d/.test(t.value)?Wy(t.value):t.value,s=l??"";V!==s&&(document.activeElement===t&&t.type!=="range"&&(_&&l===d||T&&t.value.trim()===s)||(t.value=s))}},Bb={deep:!0,created(t,l,d){t[sl]=Xu(d),Eh(t,"change",()=>{const _=t._modelValue,T=om(t),C=t.checked,P=t[sl];if(Oi(_)){const V=px(_,T),s=V!==-1;if(C&&!s)P(_.concat(T));else if(!C&&s){const $=[..._];$.splice(V,1),P($)}}else if(Of(_)){const V=new Set(_);C?V.add(T):V.delete(T),P(V)}else P(nC(t,C))})},mounted:jw,beforeUpdate(t,l,d){t[sl]=Xu(d),jw(t,l,d)}};function jw(t,{value:l,oldValue:d},_){t._modelValue=l;let T;if(Oi(l))T=px(l,_.props.value)>-1;else if(Of(l))T=l.has(_.props.value);else{if(l===d)return;T=Hu(l,nC(t,!0))}t.checked!==T&&(t.checked=T)}const Fb={created(t,{value:l},d){t.checked=Hu(l,d.props.value),t[sl]=Xu(d),Eh(t,"change",()=>{t[sl](om(t))})},beforeUpdate(t,{value:l,oldValue:d},_){t[sl]=Xu(_),l!==d&&(t.checked=Hu(l,_.props.value))}},Sh={deep:!0,created(t,{value:l,modifiers:{number:d}},_){const T=Of(l);Eh(t,"change",()=>{const C=Array.prototype.filter.call(t.options,P=>P.selected).map(P=>d?Wy(om(P)):om(P));t[sl](t.multiple?T?new Set(C):C:C[0]),t._assigning=!0,zf(()=>{t._assigning=!1})}),t[sl]=Xu(_)},mounted(t,{value:l}){$w(t,l)},beforeUpdate(t,l,d){t[sl]=Xu(d)},updated(t,{value:l}){t._assigning||$w(t,l)}};function $w(t,l){const d=t.multiple,_=Oi(l);if(!(d&&!_&&!Of(l))){for(let T=0,C=t.options.length;T<C;T++){const P=t.options[T],V=om(P);if(d)if(_){const s=typeof V;s==="string"||s==="number"?P.selected=l.some($=>String($)===String(V)):P.selected=px(l,V)>-1}else P.selected=l.has(V);else if(Hu(om(P),l)){t.selectedIndex!==T&&(t.selectedIndex=T);return}}!d&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function om(t){return"_value"in t?t._value:t.value}function nC(t,l){const d=l?"_trueValue":"_falseValue";return d in t?t[d]:l}const sC={created(t,l,d){Ly(t,l,d,null,"created")},mounted(t,l,d){Ly(t,l,d,null,"mounted")},beforeUpdate(t,l,d,_){Ly(t,l,d,_,"beforeUpdate")},updated(t,l,d,_){Ly(t,l,d,_,"updated")}};function oC(t,l){switch(t){case"SELECT":return Sh;case"TEXTAREA":return il;default:switch(l){case"checkbox":return Bb;case"radio":return Fb;default:return il}}}function Ly(t,l,d,_,T){const P=oC(t.tagName,d.props&&d.props.type)[T];P&&P(t,l,d,_)}function EL(){il.getSSRProps=({value:t})=>({value:t}),Fb.getSSRProps=({value:t},l)=>{if(l.props&&Hu(l.props.value,t))return{checked:!0}},Bb.getSSRProps=({value:t},l)=>{if(Oi(t)){if(l.props&&px(t,l.props.value)>-1)return{checked:!0}}else if(Of(t)){if(l.props&&t.has(l.props.value))return{checked:!0}}else if(t)return{checked:!0}},sC.getSSRProps=(t,l)=>{if(typeof l.type!="string")return;const d=oC(l.type.toUpperCase(),l.props&&l.props.type);if(d.getSSRProps)return d.getSSRProps(t,l)}}const SL=["ctrl","shift","alt","meta"],CL={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,l)=>SL.some(d=>t[`${d}Key`]&&!l.includes(d))},Yg=(t,l)=>{const d=t._withMods||(t._withMods={}),_=l.join(".");return d[_]||(d[_]=(T,...C)=>{for(let P=0;P<l.length;P++){const V=CL[l[P]];if(V&&V(T,l))return}return t(T,...C)})},AL={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ML=(t,l)=>{const d=t._withKeys||(t._withKeys={}),_=l.join(".");return d[_]||(d[_]=T=>{if(!("key"in T))return;const C=aa(T.key);if(l.some(P=>P===C||AL[P]===C))return t(T)})},aC=Tn({patchProp:uL},XP);let zg,Gw=!1;function lC(){return zg||(zg=bS(aC))}function cC(){return zg=Gw?zg:wS(aC),Gw=!0,zg}const hC=(...t)=>{lC().render(...t)},IL=(...t)=>{cC().hydrate(...t)},Kg=(...t)=>{const l=lC().createApp(...t),{mount:d}=l;return l.mount=_=>{const T=fC(_);if(!T)return;const C=l._component;!er(C)&&!C.render&&!C.template&&(C.template=T.innerHTML),T.nodeType===1&&(T.textContent="");const P=d(T,!1,dC(T));return T instanceof Element&&(T.removeAttribute("v-cloak"),T.setAttribute("data-v-app","")),P},l},uC=(...t)=>{const l=cC().createApp(...t),{mount:d}=l;return l.mount=_=>{const T=fC(_);if(T)return d(T,!0,dC(T))},l};function dC(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function fC(t){return Dn(t)?document.querySelector(t):t}let Ww=!1;const kL=()=>{Ww||(Ww=!0,EL(),QP())};/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const PL=()=>{},LL=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:YE,BaseTransitionPropsValidators:Sb,Comment:ws,DeprecationTypes:WP,EffectScope:mb,ErrorCodes:sk,ErrorTypeStrings:FP,Fragment:jr,KeepAlive:Pk,ReactiveEffect:Ug,Static:If,Suspense:vP,Teleport:fk,Text:Mh,TrackOpTypes:JI,Transition:zb,TransitionGroup:rC,TriggerOpTypes:QI,VueElement:kx,assertNumber:nk,callWithAsyncErrorHandling:ol,callWithErrorHandling:fm,camelize:qs,capitalize:o_,cloneVNode:Oc,compatUtils:GP,compile:PL,computed:un,createApp:Kg,createBlock:Fo,createCommentVNode:wn,createElementBlock:ki,createElementVNode:ot,createHydrationRenderer:wS,createPropsRestProxy:Xk,createRenderer:bS,createSSRApp:uC,createSlots:Rk,createStaticVNode:Zg,createTextVNode:Vs,createVNode:fr,customRef:OE,defineAsyncComponent:Ik,defineComponent:On,defineCustomElement:QS,defineEmits:Fk,defineExpose:Nk,defineModel:jk,defineOptions:Uk,defineProps:Bk,defineSSRCustomElement:fL,defineSlots:Vk,devtools:NP,effect:wI,effectScope:mx,getCurrentInstance:Zs,getCurrentScope:gb,getCurrentWatcher:ek,getTransitionRawChildren:Tx,guardReactiveProps:BS,h:pm,handleError:Rf,hasInjectionContext:uS,hydrate:IL,hydrateOnIdle:Tk,hydrateOnInteraction:Ak,hydrateOnMediaQuery:Ck,hydrateOnVisible:Sk,initCustomFormatter:RP,initDirectivesForSSR:kL,inject:la,isMemoSame:$S,isProxy:vx,isReactive:Nl,isReadonly:qu,isRef:Ln,isRuntimeOnly:LP,isShallow:Ba,isVNode:Ph,markRaw:bx,mergeDefaults:Hk,mergeModels:qk,mergeProps:u_,nextTick:zf,normalizeClass:Us,normalizeProps:_I,normalizeStyle:Rc,onActivated:JE,onBeforeMount:Ab,onBeforeUnmount:Cx,onBeforeUpdate:Mb,onDeactivated:QE,onErrorCaptured:nS,onMounted:Dh,onRenderTracked:rS,onRenderTriggered:iS,onScopeDispose:_E,onServerPrefetch:tS,onUnmounted:c_,onUpdated:Sx,onWatcherCleanup:FE,openBlock:gi,popScopeId:hk,provide:Og,proxyRefs:wb,pushScopeId:ck,queuePostFlushCb:$g,reactive:dm,readonly:bb,ref:Ui,registerRuntimeCompiler:PP,render:hC,renderList:za,renderSlot:oS,resolveComponent:Ah,resolveDirective:Ok,resolveDynamicComponent:Ax,resolveFilter:$P,resolveTransitionHooks:rm,setBlockTracking:R0,setDevtoolsHook:UP,setTransitionHooks:kh,shallowReactive:vb,shallowReadonly:jI,shallowRef:a_,ssrContextKey:CS,ssrUtils:jP,stop:TI,toDisplayString:pi,toHandlerKey:Ig,toHandlers:aS,toRaw:Ir,toRef:zE,toRefs:RE,toValue:WI,transformVNodeArgs:CP,triggerRef:GI,unref:ns,useAttrs:Wk,useCssModule:gL,useCssVars:eL,useHost:eC,useId:mk,useModel:fP,useSSRContext:AS,useShadowRoot:mL,useSlots:Gk,useTemplateRef:gk,useTransitionState:Eb,vModelCheckbox:Bb,vModelDynamic:sC,vModelRadio:Fb,vModelSelect:Sh,vModelText:il,vShow:KS,version:GS,warn:BP,watch:ca,watchEffect:hP,watchPostEffect:uP,watchSyncEffect:MS,withAsyncContext:Zk,withCtx:Ns,withDefaults:$k,withDirectives:uo,withKeys:ML,withMemo:zP,withModifiers:Yg,withScopeId:uk},Symbol.toStringTag,{value:"Module"})),Nb="/projects/soil_values/assets/DGIS_logo-BMUz1Rxj.webp",pC="/projects/soil_values/assets/logo-CicDM-h9.png";/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const qp=typeof document<"u";function mC(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function DL(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&mC(t.default)}const ln=Object.assign;function d0(t,l){const d={};for(const _ in l){const T=l[_];d[_]=Vl(T)?T.map(t):t(T)}return d}const Bg=()=>{},Vl=Array.isArray,gC=/#/g,OL=/&/g,RL=/\//g,zL=/=/g,BL=/\?/g,_C=/\+/g,FL=/%5B/g,NL=/%5D/g,yC=/%5E/g,UL=/%60/g,xC=/%7B/g,VL=/%7C/g,vC=/%7D/g,jL=/%20/g;function Ub(t){return encodeURI(""+t).replace(VL,"|").replace(FL,"[").replace(NL,"]")}function $L(t){return Ub(t).replace(xC,"{").replace(vC,"}").replace(yC,"^")}function G0(t){return Ub(t).replace(_C,"%2B").replace(jL,"+").replace(gC,"%23").replace(OL,"%26").replace(UL,"`").replace(xC,"{").replace(vC,"}").replace(yC,"^")}function GL(t){return G0(t).replace(zL,"%3D")}function WL(t){return Ub(t).replace(gC,"%23").replace(BL,"%3F")}function HL(t){return t==null?"":WL(t).replace(RL,"%2F")}function Jg(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const qL=/\/$/,XL=t=>t.replace(qL,"");function f0(t,l,d="/"){let _,T={},C="",P="";const V=l.indexOf("#");let s=l.indexOf("?");return V<s&&V>=0&&(s=-1),s>-1&&(_=l.slice(0,s),C=l.slice(s+1,V>-1?V:l.length),T=t(C)),V>-1&&(_=_||l.slice(0,V),P=l.slice(V,l.length)),_=JL(_??l,d),{fullPath:_+(C&&"?")+C+P,path:_,query:T,hash:Jg(P)}}function ZL(t,l){const d=l.query?t(l.query):"";return l.path+(d&&"?")+d+(l.hash||"")}function Hw(t,l){return!l||!t.toLowerCase().startsWith(l.toLowerCase())?t:t.slice(l.length)||"/"}function YL(t,l,d){const _=l.matched.length-1,T=d.matched.length-1;return _>-1&&_===T&&am(l.matched[_],d.matched[T])&&bC(l.params,d.params)&&t(l.query)===t(d.query)&&l.hash===d.hash}function am(t,l){return(t.aliasOf||t)===(l.aliasOf||l)}function bC(t,l){if(Object.keys(t).length!==Object.keys(l).length)return!1;for(const d in t)if(!KL(t[d],l[d]))return!1;return!0}function KL(t,l){return Vl(t)?qw(t,l):Vl(l)?qw(l,t):t===l}function qw(t,l){return Vl(l)?t.length===l.length&&t.every((d,_)=>d===l[_]):t.length===1&&t[0]===l}function JL(t,l){if(t.startsWith("/"))return t;if(!t)return l;const d=l.split("/"),_=t.split("/"),T=_[_.length-1];(T===".."||T===".")&&_.push("");let C=d.length-1,P,V;for(P=0;P<_.length;P++)if(V=_[P],V!==".")if(V==="..")C>1&&C--;else break;return d.slice(0,C).join("/")+"/"+_.slice(P).join("/")}const zu={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Qg;(function(t){t.pop="pop",t.push="push"})(Qg||(Qg={}));var Fg;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Fg||(Fg={}));function QL(t){if(!t)if(qp){const l=document.querySelector("base");t=l&&l.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),XL(t)}const eD=/^[^#]+#/;function tD(t,l){return t.replace(eD,"#")+l}function iD(t,l){const d=document.documentElement.getBoundingClientRect(),_=t.getBoundingClientRect();return{behavior:l.behavior,left:_.left-d.left-(l.left||0),top:_.top-d.top-(l.top||0)}}const Px=()=>({left:window.scrollX,top:window.scrollY});function rD(t){let l;if("el"in t){const d=t.el,_=typeof d=="string"&&d.startsWith("#"),T=typeof d=="string"?_?document.getElementById(d.slice(1)):document.querySelector(d):d;if(!T)return;l=iD(T,t)}else l=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(l):window.scrollTo(l.left!=null?l.left:window.scrollX,l.top!=null?l.top:window.scrollY)}function Xw(t,l){return(history.state?history.state.position-l:-1)+t}const W0=new Map;function nD(t,l){W0.set(t,l)}function sD(t){const l=W0.get(t);return W0.delete(t),l}let oD=()=>location.protocol+"//"+location.host;function wC(t,l){const{pathname:d,search:_,hash:T}=l,C=t.indexOf("#");if(C>-1){let V=T.includes(t.slice(C))?t.slice(C).length:1,s=T.slice(V);return s[0]!=="/"&&(s="/"+s),Hw(s,"")}return Hw(d,t)+_+T}function aD(t,l,d,_){let T=[],C=[],P=null;const V=({state:ne})=>{const ue=wC(t,location),we=d.value,Me=l.value;let Ye=0;if(ne){if(d.value=ue,l.value=ne,P&&P===we){P=null;return}Ye=Me?ne.position-Me.position:0}else _(ue);T.forEach(Ze=>{Ze(d.value,we,{delta:Ye,type:Qg.pop,direction:Ye?Ye>0?Fg.forward:Fg.back:Fg.unknown})})};function s(){P=d.value}function $(ne){T.push(ne);const ue=()=>{const we=T.indexOf(ne);we>-1&&T.splice(we,1)};return C.push(ue),ue}function Z(){const{history:ne}=window;ne.state&&ne.replaceState(ln({},ne.state,{scroll:Px()}),"")}function J(){for(const ne of C)ne();C=[],window.removeEventListener("popstate",V),window.removeEventListener("beforeunload",Z)}return window.addEventListener("popstate",V),window.addEventListener("beforeunload",Z,{passive:!0}),{pauseListeners:s,listen:$,destroy:J}}function Zw(t,l,d,_=!1,T=!1){return{back:t,current:l,forward:d,replaced:_,position:window.history.length,scroll:T?Px():null}}function lD(t){const{history:l,location:d}=window,_={value:wC(t,d)},T={value:l.state};T.value||C(_.value,{back:null,current:_.value,forward:null,position:l.length-1,replaced:!0,scroll:null},!0);function C(s,$,Z){const J=t.indexOf("#"),ne=J>-1?(d.host&&document.querySelector("base")?t:t.slice(J))+s:oD()+t+s;try{l[Z?"replaceState":"pushState"]($,"",ne),T.value=$}catch(ue){console.error(ue),d[Z?"replace":"assign"](ne)}}function P(s,$){const Z=ln({},l.state,Zw(T.value.back,s,T.value.forward,!0),$,{position:T.value.position});C(s,Z,!0),_.value=s}function V(s,$){const Z=ln({},T.value,l.state,{forward:s,scroll:Px()});C(Z.current,Z,!0);const J=ln({},Zw(_.value,s,null),{position:Z.position+1},$);C(s,J,!1),_.value=s}return{location:_,state:T,push:V,replace:P}}function cD(t){t=QL(t);const l=lD(t),d=aD(t,l.state,l.location,l.replace);function _(C,P=!0){P||d.pauseListeners(),history.go(C)}const T=ln({location:"",base:t,go:_,createHref:tD.bind(null,t)},l,d);return Object.defineProperty(T,"location",{enumerable:!0,get:()=>l.location.value}),Object.defineProperty(T,"state",{enumerable:!0,get:()=>l.state.value}),T}function hD(t){return typeof t=="string"||t&&typeof t=="object"}function TC(t){return typeof t=="string"||typeof t=="symbol"}const EC=Symbol("");var Yw;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Yw||(Yw={}));function lm(t,l){return ln(new Error,{type:t,[EC]:!0},l)}function yh(t,l){return t instanceof Error&&EC in t&&(l==null||!!(t.type&l))}const Kw="[^/]+?",uD={sensitive:!1,strict:!1,start:!0,end:!0},dD=/[.+*?^${}()[\]/\\]/g;function fD(t,l){const d=ln({},uD,l),_=[];let T=d.start?"^":"";const C=[];for(const $ of t){const Z=$.length?[]:[90];d.strict&&!$.length&&(T+="/");for(let J=0;J<$.length;J++){const ne=$[J];let ue=40+(d.sensitive?.25:0);if(ne.type===0)J||(T+="/"),T+=ne.value.replace(dD,"\\$&"),ue+=40;else if(ne.type===1){const{value:we,repeatable:Me,optional:Ye,regexp:Ze}=ne;C.push({name:we,repeatable:Me,optional:Ye});const Fe=Ze||Kw;if(Fe!==Kw){ue+=10;try{new RegExp(`(${Fe})`)}catch(ge){throw new Error(`Invalid custom RegExp for param "${we}" (${Fe}): `+ge.message)}}let ae=Me?`((?:${Fe})(?:/(?:${Fe}))*)`:`(${Fe})`;J||(ae=Ye&&$.length<2?`(?:/${ae})`:"/"+ae),Ye&&(ae+="?"),T+=ae,ue+=20,Ye&&(ue+=-8),Me&&(ue+=-20),Fe===".*"&&(ue+=-50)}Z.push(ue)}_.push(Z)}if(d.strict&&d.end){const $=_.length-1;_[$][_[$].length-1]+=.7000000000000001}d.strict||(T+="/?"),d.end?T+="$":d.strict&&!T.endsWith("/")&&(T+="(?:/|$)");const P=new RegExp(T,d.sensitive?"":"i");function V($){const Z=$.match(P),J={};if(!Z)return null;for(let ne=1;ne<Z.length;ne++){const ue=Z[ne]||"",we=C[ne-1];J[we.name]=ue&&we.repeatable?ue.split("/"):ue}return J}function s($){let Z="",J=!1;for(const ne of t){(!J||!Z.endsWith("/"))&&(Z+="/"),J=!1;for(const ue of ne)if(ue.type===0)Z+=ue.value;else if(ue.type===1){const{value:we,repeatable:Me,optional:Ye}=ue,Ze=we in $?$[we]:"";if(Vl(Ze)&&!Me)throw new Error(`Provided param "${we}" is an array but it is not repeatable (* or + modifiers)`);const Fe=Vl(Ze)?Ze.join("/"):Ze;if(!Fe)if(Ye)ne.length<2&&(Z.endsWith("/")?Z=Z.slice(0,-1):J=!0);else throw new Error(`Missing required param "${we}"`);Z+=Fe}}return Z||"/"}return{re:P,score:_,keys:C,parse:V,stringify:s}}function pD(t,l){let d=0;for(;d<t.length&&d<l.length;){const _=l[d]-t[d];if(_)return _;d++}return t.length<l.length?t.length===1&&t[0]===80?-1:1:t.length>l.length?l.length===1&&l[0]===80?1:-1:0}function SC(t,l){let d=0;const _=t.score,T=l.score;for(;d<_.length&&d<T.length;){const C=pD(_[d],T[d]);if(C)return C;d++}if(Math.abs(T.length-_.length)===1){if(Jw(_))return 1;if(Jw(T))return-1}return T.length-_.length}function Jw(t){const l=t[t.length-1];return t.length>0&&l[l.length-1]<0}const mD={type:0,value:""},gD=/[a-zA-Z0-9_]/;function _D(t){if(!t)return[[]];if(t==="/")return[[mD]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function l(ue){throw new Error(`ERR (${d})/"${$}": ${ue}`)}let d=0,_=d;const T=[];let C;function P(){C&&T.push(C),C=[]}let V=0,s,$="",Z="";function J(){$&&(d===0?C.push({type:0,value:$}):d===1||d===2||d===3?(C.length>1&&(s==="*"||s==="+")&&l(`A repeatable param (${$}) must be alone in its segment. eg: '/:ids+.`),C.push({type:1,value:$,regexp:Z,repeatable:s==="*"||s==="+",optional:s==="*"||s==="?"})):l("Invalid state to consume buffer"),$="")}function ne(){$+=s}for(;V<t.length;){if(s=t[V++],s==="\\"&&d!==2){_=d,d=4;continue}switch(d){case 0:s==="/"?($&&J(),P()):s===":"?(J(),d=1):ne();break;case 4:ne(),d=_;break;case 1:s==="("?d=2:gD.test(s)?ne():(J(),d=0,s!=="*"&&s!=="?"&&s!=="+"&&V--);break;case 2:s===")"?Z[Z.length-1]=="\\"?Z=Z.slice(0,-1)+s:d=3:Z+=s;break;case 3:J(),d=0,s!=="*"&&s!=="?"&&s!=="+"&&V--,Z="";break;default:l("Unknown state");break}}return d===2&&l(`Unfinished custom RegExp for param "${$}"`),J(),P(),T}function yD(t,l,d){const _=fD(_D(t.path),d),T=ln(_,{record:t,parent:l,children:[],alias:[]});return l&&!T.record.aliasOf==!l.record.aliasOf&&l.children.push(T),T}function xD(t,l){const d=[],_=new Map;l=iT({strict:!1,end:!0,sensitive:!1},l);function T(J){return _.get(J)}function C(J,ne,ue){const we=!ue,Me=eT(J);Me.aliasOf=ue&&ue.record;const Ye=iT(l,J),Ze=[Me];if("alias"in J){const ge=typeof J.alias=="string"?[J.alias]:J.alias;for(const Oe of ge)Ze.push(eT(ln({},Me,{components:ue?ue.record.components:Me.components,path:Oe,aliasOf:ue?ue.record:Me})))}let Fe,ae;for(const ge of Ze){const{path:Oe}=ge;if(ne&&Oe[0]!=="/"){const ze=ne.record.path,rt=ze[ze.length-1]==="/"?"":"/";ge.path=ne.record.path+(Oe&&rt+Oe)}if(Fe=yD(ge,ne,Ye),ue?ue.alias.push(Fe):(ae=ae||Fe,ae!==Fe&&ae.alias.push(Fe),we&&J.name&&!tT(Fe)&&P(J.name)),CC(Fe)&&s(Fe),Me.children){const ze=Me.children;for(let rt=0;rt<ze.length;rt++)C(ze[rt],Fe,ue&&ue.children[rt])}ue=ue||Fe}return ae?()=>{P(ae)}:Bg}function P(J){if(TC(J)){const ne=_.get(J);ne&&(_.delete(J),d.splice(d.indexOf(ne),1),ne.children.forEach(P),ne.alias.forEach(P))}else{const ne=d.indexOf(J);ne>-1&&(d.splice(ne,1),J.record.name&&_.delete(J.record.name),J.children.forEach(P),J.alias.forEach(P))}}function V(){return d}function s(J){const ne=wD(J,d);d.splice(ne,0,J),J.record.name&&!tT(J)&&_.set(J.record.name,J)}function $(J,ne){let ue,we={},Me,Ye;if("name"in J&&J.name){if(ue=_.get(J.name),!ue)throw lm(1,{location:J});Ye=ue.record.name,we=ln(Qw(ne.params,ue.keys.filter(ae=>!ae.optional).concat(ue.parent?ue.parent.keys.filter(ae=>ae.optional):[]).map(ae=>ae.name)),J.params&&Qw(J.params,ue.keys.map(ae=>ae.name))),Me=ue.stringify(we)}else if(J.path!=null)Me=J.path,ue=d.find(ae=>ae.re.test(Me)),ue&&(we=ue.parse(Me),Ye=ue.record.name);else{if(ue=ne.name?_.get(ne.name):d.find(ae=>ae.re.test(ne.path)),!ue)throw lm(1,{location:J,currentLocation:ne});Ye=ue.record.name,we=ln({},ne.params,J.params),Me=ue.stringify(we)}const Ze=[];let Fe=ue;for(;Fe;)Ze.unshift(Fe.record),Fe=Fe.parent;return{name:Ye,path:Me,params:we,matched:Ze,meta:bD(Ze)}}t.forEach(J=>C(J));function Z(){d.length=0,_.clear()}return{addRoute:C,resolve:$,removeRoute:P,clearRoutes:Z,getRoutes:V,getRecordMatcher:T}}function Qw(t,l){const d={};for(const _ of l)_ in t&&(d[_]=t[_]);return d}function eT(t){const l={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:vD(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(l,"mods",{value:{}}),l}function vD(t){const l={},d=t.props||!1;if("component"in t)l.default=d;else for(const _ in t.components)l[_]=typeof d=="object"?d[_]:d;return l}function tT(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function bD(t){return t.reduce((l,d)=>ln(l,d.meta),{})}function iT(t,l){const d={};for(const _ in t)d[_]=_ in l?l[_]:t[_];return d}function wD(t,l){let d=0,_=l.length;for(;d!==_;){const C=d+_>>1;SC(t,l[C])<0?_=C:d=C+1}const T=TD(t);return T&&(_=l.lastIndexOf(T,_-1)),_}function TD(t){let l=t;for(;l=l.parent;)if(CC(l)&&SC(t,l)===0)return l}function CC({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function ED(t){const l={};if(t===""||t==="?")return l;const _=(t[0]==="?"?t.slice(1):t).split("&");for(let T=0;T<_.length;++T){const C=_[T].replace(_C," "),P=C.indexOf("="),V=Jg(P<0?C:C.slice(0,P)),s=P<0?null:Jg(C.slice(P+1));if(V in l){let $=l[V];Vl($)||($=l[V]=[$]),$.push(s)}else l[V]=s}return l}function rT(t){let l="";for(let d in t){const _=t[d];if(d=GL(d),_==null){_!==void 0&&(l+=(l.length?"&":"")+d);continue}(Vl(_)?_.map(C=>C&&G0(C)):[_&&G0(_)]).forEach(C=>{C!==void 0&&(l+=(l.length?"&":"")+d,C!=null&&(l+="="+C))})}return l}function SD(t){const l={};for(const d in t){const _=t[d];_!==void 0&&(l[d]=Vl(_)?_.map(T=>T==null?null:""+T):_==null?_:""+_)}return l}const CD=Symbol(""),nT=Symbol(""),Lx=Symbol(""),Vb=Symbol(""),H0=Symbol("");function Eg(){let t=[];function l(_){return t.push(_),()=>{const T=t.indexOf(_);T>-1&&t.splice(T,1)}}function d(){t=[]}return{add:l,list:()=>t.slice(),reset:d}}function Gu(t,l,d,_,T,C=P=>P()){const P=_&&(_.enterCallbacks[T]=_.enterCallbacks[T]||[]);return()=>new Promise((V,s)=>{const $=ne=>{ne===!1?s(lm(4,{from:d,to:l})):ne instanceof Error?s(ne):hD(ne)?s(lm(2,{from:l,to:ne})):(P&&_.enterCallbacks[T]===P&&typeof ne=="function"&&P.push(ne),V())},Z=C(()=>t.call(_&&_.instances[T],l,d,$));let J=Promise.resolve(Z);t.length<3&&(J=J.then($)),J.catch(ne=>s(ne))})}function p0(t,l,d,_,T=C=>C()){const C=[];for(const P of t)for(const V in P.components){let s=P.components[V];if(!(l!=="beforeRouteEnter"&&!P.instances[V]))if(mC(s)){const Z=(s.__vccOpts||s)[l];Z&&C.push(Gu(Z,d,_,P,V,T))}else{let $=s();C.push(()=>$.then(Z=>{if(!Z)throw new Error(`Couldn't resolve component "${V}" at "${P.path}"`);const J=DL(Z)?Z.default:Z;P.mods[V]=Z,P.components[V]=J;const ue=(J.__vccOpts||J)[l];return ue&&Gu(ue,d,_,P,V,T)()}))}}return C}function sT(t){const l=la(Lx),d=la(Vb),_=un(()=>{const s=ns(t.to);return l.resolve(s)}),T=un(()=>{const{matched:s}=_.value,{length:$}=s,Z=s[$-1],J=d.matched;if(!Z||!J.length)return-1;const ne=J.findIndex(am.bind(null,Z));if(ne>-1)return ne;const ue=oT(s[$-2]);return $>1&&oT(Z)===ue&&J[J.length-1].path!==ue?J.findIndex(am.bind(null,s[$-2])):ne}),C=un(()=>T.value>-1&&PD(d.params,_.value.params)),P=un(()=>T.value>-1&&T.value===d.matched.length-1&&bC(d.params,_.value.params));function V(s={}){if(kD(s)){const $=l[ns(t.replace)?"replace":"push"](ns(t.to)).catch(Bg);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>$),$}return Promise.resolve()}return{route:_,href:un(()=>_.value.href),isActive:C,isExactActive:P,navigate:V}}function AD(t){return t.length===1?t[0]:t}const MD=On({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:sT,setup(t,{slots:l}){const d=dm(sT(t)),{options:_}=la(Lx),T=un(()=>({[aT(t.activeClass,_.linkActiveClass,"router-link-active")]:d.isActive,[aT(t.exactActiveClass,_.linkExactActiveClass,"router-link-exact-active")]:d.isExactActive}));return()=>{const C=l.default&&AD(l.default(d));return t.custom?C:pm("a",{"aria-current":d.isExactActive?t.ariaCurrentValue:null,href:d.href,onClick:d.navigate,class:T.value},C)}}}),ID=MD;function kD(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const l=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(l))return}return t.preventDefault&&t.preventDefault(),!0}}function PD(t,l){for(const d in l){const _=l[d],T=t[d];if(typeof _=="string"){if(_!==T)return!1}else if(!Vl(T)||T.length!==_.length||_.some((C,P)=>C!==T[P]))return!1}return!0}function oT(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const aT=(t,l,d)=>t??l??d,LD=On({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:l,slots:d}){const _=la(H0),T=un(()=>t.route||_.value),C=la(nT,0),P=un(()=>{let $=ns(C);const{matched:Z}=T.value;let J;for(;(J=Z[$])&&!J.components;)$++;return $}),V=un(()=>T.value.matched[P.value]);Og(nT,un(()=>P.value+1)),Og(CD,V),Og(H0,T);const s=Ui();return ca(()=>[s.value,V.value,t.name],([$,Z,J],[ne,ue,we])=>{Z&&(Z.instances[J]=$,ue&&ue!==Z&&$&&$===ne&&(Z.leaveGuards.size||(Z.leaveGuards=ue.leaveGuards),Z.updateGuards.size||(Z.updateGuards=ue.updateGuards))),$&&Z&&(!ue||!am(Z,ue)||!ne)&&(Z.enterCallbacks[J]||[]).forEach(Me=>Me($))},{flush:"post"}),()=>{const $=T.value,Z=t.name,J=V.value,ne=J&&J.components[Z];if(!ne)return lT(d.default,{Component:ne,route:$});const ue=J.props[Z],we=ue?ue===!0?$.params:typeof ue=="function"?ue($):ue:null,Ye=pm(ne,ln({},we,l,{onVnodeUnmounted:Ze=>{Ze.component.isUnmounted&&(J.instances[Z]=null)},ref:s}));return lT(d.default,{Component:Ye,route:$})||Ye}}});function lT(t,l){if(!t)return null;const d=t(l);return d.length===1?d[0]:d}const DD=LD;function OD(t){const l=xD(t.routes,t),d=t.parseQuery||ED,_=t.stringifyQuery||rT,T=t.history,C=Eg(),P=Eg(),V=Eg(),s=a_(zu);let $=zu;qp&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const Z=d0.bind(null,zt=>""+zt),J=d0.bind(null,HL),ne=d0.bind(null,Jg);function ue(zt,fi){let ri,Ti;return TC(zt)?(ri=l.getRecordMatcher(zt),Ti=fi):Ti=zt,l.addRoute(Ti,ri)}function we(zt){const fi=l.getRecordMatcher(zt);fi&&l.removeRoute(fi)}function Me(){return l.getRoutes().map(zt=>zt.record)}function Ye(zt){return!!l.getRecordMatcher(zt)}function Ze(zt,fi){if(fi=ln({},fi||s.value),typeof zt=="string"){const ve=f0(d,zt,fi.path),nt=l.resolve({path:ve.path},fi),Lt=T.createHref(ve.fullPath);return ln(ve,nt,{params:ne(nt.params),hash:Jg(ve.hash),redirectedFrom:void 0,href:Lt})}let ri;if(zt.path!=null)ri=ln({},zt,{path:f0(d,zt.path,fi.path).path});else{const ve=ln({},zt.params);for(const nt in ve)ve[nt]==null&&delete ve[nt];ri=ln({},zt,{params:J(ve)}),fi.params=J(fi.params)}const Ti=l.resolve(ri,fi),sr=zt.hash||"";Ti.params=Z(ne(Ti.params));const Ei=ZL(_,ln({},zt,{hash:$L(sr),path:Ti.path})),xe=T.createHref(Ei);return ln({fullPath:Ei,hash:sr,query:_===rT?SD(zt.query):zt.query||{}},Ti,{redirectedFrom:void 0,href:xe})}function Fe(zt){return typeof zt=="string"?f0(d,zt,s.value.path):ln({},zt)}function ae(zt,fi){if($!==zt)return lm(8,{from:fi,to:zt})}function ge(zt){return rt(zt)}function Oe(zt){return ge(ln(Fe(zt),{replace:!0}))}function ze(zt){const fi=zt.matched[zt.matched.length-1];if(fi&&fi.redirect){const{redirect:ri}=fi;let Ti=typeof ri=="function"?ri(zt):ri;return typeof Ti=="string"&&(Ti=Ti.includes("?")||Ti.includes("#")?Ti=Fe(Ti):{path:Ti},Ti.params={}),ln({query:zt.query,hash:zt.hash,params:Ti.path!=null?{}:zt.params},Ti)}}function rt(zt,fi){const ri=$=Ze(zt),Ti=s.value,sr=zt.state,Ei=zt.force,xe=zt.replace===!0,ve=ze(ri);if(ve)return rt(ln(Fe(ve),{state:typeof ve=="object"?ln({},sr,ve.state):sr,force:Ei,replace:xe}),fi||ri);const nt=ri;nt.redirectedFrom=fi;let Lt;return!Ei&&YL(_,Ti,ri)&&(Lt=lm(16,{to:nt,from:Ti}),tr(Ti,Ti,!0,!1)),(Lt?Promise.resolve(Lt):He(nt,Ti)).catch(It=>yh(It)?yh(It,2)?It:Pr(It):yi(It,nt,Ti)).then(It=>{if(It){if(yh(It,2))return rt(ln({replace:xe},Fe(It.to),{state:typeof It.to=="object"?ln({},sr,It.to.state):sr,force:Ei}),fi||nt)}else It=bt(nt,Ti,!0,xe,sr);return ti(nt,Ti,It),It})}function Ie(zt,fi){const ri=ae(zt,fi);return ri?Promise.reject(ri):Promise.resolve()}function Je(zt){const fi=dr.values().next().value;return fi&&typeof fi.runWithContext=="function"?fi.runWithContext(zt):zt()}function He(zt,fi){let ri;const[Ti,sr,Ei]=RD(zt,fi);ri=p0(Ti.reverse(),"beforeRouteLeave",zt,fi);for(const ve of Ti)ve.leaveGuards.forEach(nt=>{ri.push(Gu(nt,zt,fi))});const xe=Ie.bind(null,zt,fi);return ri.push(xe),nn(ri).then(()=>{ri=[];for(const ve of C.list())ri.push(Gu(ve,zt,fi));return ri.push(xe),nn(ri)}).then(()=>{ri=p0(sr,"beforeRouteUpdate",zt,fi);for(const ve of sr)ve.updateGuards.forEach(nt=>{ri.push(Gu(nt,zt,fi))});return ri.push(xe),nn(ri)}).then(()=>{ri=[];for(const ve of Ei)if(ve.beforeEnter)if(Vl(ve.beforeEnter))for(const nt of ve.beforeEnter)ri.push(Gu(nt,zt,fi));else ri.push(Gu(ve.beforeEnter,zt,fi));return ri.push(xe),nn(ri)}).then(()=>(zt.matched.forEach(ve=>ve.enterCallbacks={}),ri=p0(Ei,"beforeRouteEnter",zt,fi,Je),ri.push(xe),nn(ri))).then(()=>{ri=[];for(const ve of P.list())ri.push(Gu(ve,zt,fi));return ri.push(xe),nn(ri)}).catch(ve=>yh(ve,8)?ve:Promise.reject(ve))}function ti(zt,fi,ri){V.list().forEach(Ti=>Je(()=>Ti(zt,fi,ri)))}function bt(zt,fi,ri,Ti,sr){const Ei=ae(zt,fi);if(Ei)return Ei;const xe=fi===zu,ve=qp?history.state:{};ri&&(Ti||xe?T.replace(zt.fullPath,ln({scroll:xe&&ve&&ve.scroll},sr)):T.push(zt.fullPath,sr)),s.value=zt,tr(zt,fi,ri,xe),Pr()}let wt;function xt(){wt||(wt=T.listen((zt,fi,ri)=>{if(!Rn.listening)return;const Ti=Ze(zt),sr=ze(Ti);if(sr){rt(ln(sr,{replace:!0,force:!0}),Ti).catch(Bg);return}$=Ti;const Ei=s.value;qp&&nD(Xw(Ei.fullPath,ri.delta),Px()),He(Ti,Ei).catch(xe=>yh(xe,12)?xe:yh(xe,2)?(rt(ln(Fe(xe.to),{force:!0}),Ti).then(ve=>{yh(ve,20)&&!ri.delta&&ri.type===Qg.pop&&T.go(-1,!1)}).catch(Bg),Promise.reject()):(ri.delta&&T.go(-ri.delta,!1),yi(xe,Ti,Ei))).then(xe=>{xe=xe||bt(Ti,Ei,!1),xe&&(ri.delta&&!yh(xe,8)?T.go(-ri.delta,!1):ri.type===Qg.pop&&yh(xe,20)&&T.go(-1,!1)),ti(Ti,Ei,xe)}).catch(Bg)}))}let Tt=Eg(),vt=Eg(),ai;function yi(zt,fi,ri){Pr(zt);const Ti=vt.list();return Ti.length?Ti.forEach(sr=>sr(zt,fi,ri)):console.error(zt),Promise.reject(zt)}function xi(){return ai&&s.value!==zu?Promise.resolve():new Promise((zt,fi)=>{Tt.add([zt,fi])})}function Pr(zt){return ai||(ai=!zt,xt(),Tt.list().forEach(([fi,ri])=>zt?ri(zt):fi()),Tt.reset()),zt}function tr(zt,fi,ri,Ti){const{scrollBehavior:sr}=t;if(!qp||!sr)return Promise.resolve();const Ei=!ri&&sD(Xw(zt.fullPath,0))||(Ti||!ri)&&history.state&&history.state.scroll||null;return zf().then(()=>sr(zt,fi,Ei)).then(xe=>xe&&rD(xe)).catch(xe=>yi(xe,zt,fi))}const nr=zt=>T.go(zt);let rn;const dr=new Set,Rn={currentRoute:s,listening:!0,addRoute:ue,removeRoute:we,clearRoutes:l.clearRoutes,hasRoute:Ye,getRoutes:Me,resolve:Ze,options:t,push:ge,replace:Oe,go:nr,back:()=>nr(-1),forward:()=>nr(1),beforeEach:C.add,beforeResolve:P.add,afterEach:V.add,onError:vt.add,isReady:xi,install(zt){const fi=this;zt.component("RouterLink",ID),zt.component("RouterView",DD),zt.config.globalProperties.$router=fi,Object.defineProperty(zt.config.globalProperties,"$route",{enumerable:!0,get:()=>ns(s)}),qp&&!rn&&s.value===zu&&(rn=!0,ge(T.location).catch(sr=>{}));const ri={};for(const sr in zu)Object.defineProperty(ri,sr,{get:()=>s.value[sr],enumerable:!0});zt.provide(Lx,fi),zt.provide(Vb,vb(ri)),zt.provide(H0,s);const Ti=zt.unmount;dr.add(zt),zt.unmount=function(){dr.delete(zt),dr.size<1&&($=zu,wt&&wt(),wt=null,s.value=zu,rn=!1,ai=!1),Ti()}}};function nn(zt){return zt.reduce((fi,ri)=>fi.then(()=>Je(ri)),Promise.resolve())}return Rn}function RD(t,l){const d=[],_=[],T=[],C=Math.max(l.matched.length,t.matched.length);for(let P=0;P<C;P++){const V=l.matched[P];V&&(t.matched.find($=>am($,V))?_.push(V):d.push(V));const s=t.matched[P];s&&(l.matched.find($=>am($,s))||T.push(s))}return[d,_,T]}function AC(){return la(Lx)}function zD(t){return la(Vb)}/*!
  * shared v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function BD(t,l){typeof console<"u"&&(console.warn("[intlify] "+t),l&&console.warn(l.stack))}const sx=typeof window<"u",Ju=(t,l=!1)=>l?Symbol.for(t):Symbol(t),FD=(t,l,d)=>ND({l:t,k:l,s:d}),ND=t=>JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),cs=t=>typeof t=="number"&&isFinite(t),UD=t=>IC(t)==="[object Date]",Zu=t=>IC(t)==="[object RegExp]",Dx=t=>hr(t)&&Object.keys(t).length===0,Xs=Object.assign,VD=Object.create,mn=(t=null)=>VD(t);let cT;const Ch=()=>cT||(cT=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:mn());function hT(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2F;").replace(/=/g,"&#x3D;")}function uT(t){return t.replace(/&(?![a-zA-Z0-9#]{2,6};)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function jD(t){return t=t.replace(/(\w+)\s*=\s*"([^"]*)"/g,(_,T,C)=>`${T}="${uT(C)}"`),t=t.replace(/(\w+)\s*=\s*'([^']*)'/g,(_,T,C)=>`${T}='${uT(C)}'`),/\s*on\w+\s*=\s*["']?[^"'>]+["']?/gi.test(t)&&(t=t.replace(/(\s+)(on)(\w+\s*=)/gi,"$1&#111;n$3")),[/(\s+(?:href|src|action|formaction)\s*=\s*["']?)\s*javascript:/gi,/(style\s*=\s*["'][^"']*url\s*\(\s*)javascript:/gi].forEach(_=>{t=t.replace(_,"$1javascript&#58;")}),t}const $D=Object.prototype.hasOwnProperty;function Rl(t,l){return $D.call(t,l)}const Vn=Array.isArray,Pn=t=>typeof t=="function",Si=t=>typeof t=="string",Sr=t=>typeof t=="boolean",qr=t=>t!==null&&typeof t=="object",GD=t=>qr(t)&&Pn(t.then)&&Pn(t.catch),MC=Object.prototype.toString,IC=t=>MC.call(t),hr=t=>{if(!qr(t))return!1;const l=Object.getPrototypeOf(t);return l===null||l.constructor===Object},WD=t=>t==null?"":Vn(t)||hr(t)&&t.toString===MC?JSON.stringify(t,null,2):String(t);function HD(t,l=""){return t.reduce((d,_,T)=>T===0?d+_:d+l+_,"")}function Ox(t){let l=t;return()=>++l}const Dy=t=>!qr(t)||Vn(t);function Ny(t,l){if(Dy(t)||Dy(l))throw new Error("Invalid value");const d=[{src:t,des:l}];for(;d.length;){const{src:_,des:T}=d.pop();Object.keys(_).forEach(C=>{C!=="__proto__"&&(qr(_[C])&&!qr(T[C])&&(T[C]=Array.isArray(_[C])?[]:mn()),Dy(T[C])||Dy(_[C])?T[C]=_[C]:d.push({src:_[C],des:T[C]}))})}}/*!
  * message-compiler v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function qD(t,l,d){return{line:t,column:l,offset:d}}function ox(t,l,d){return{start:t,end:l}}const XD=/\{([0-9a-zA-Z]+)\}/g;function kC(t,...l){return l.length===1&&ZD(l[0])&&(l=l[0]),(!l||!l.hasOwnProperty)&&(l={}),t.replace(XD,(d,_)=>l.hasOwnProperty(_)?l[_]:"")}const PC=Object.assign,dT=t=>typeof t=="string",ZD=t=>t!==null&&typeof t=="object";function LC(t,l=""){return t.reduce((d,_,T)=>T===0?d+_:d+l+_,"")}const jb={USE_MODULO_SYNTAX:1,__EXTEND_POINT__:2},YD={[jb.USE_MODULO_SYNTAX]:"Use modulo before '{{0}}'."};function KD(t,l,...d){const _=kC(YD[t],...d||[]),T={message:String(_),code:t};return l&&(T.location=l),T}const rr={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,UNHANDLED_CODEGEN_NODE_TYPE:15,UNHANDLED_MINIFIER_NODE_TYPE:16,__EXTEND_POINT__:17},JD={[rr.EXPECTED_TOKEN]:"Expected token: '{0}'",[rr.INVALID_TOKEN_IN_PLACEHOLDER]:"Invalid token in placeholder: '{0}'",[rr.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER]:"Unterminated single quote in placeholder",[rr.UNKNOWN_ESCAPE_SEQUENCE]:"Unknown escape sequence: \\{0}",[rr.INVALID_UNICODE_ESCAPE_SEQUENCE]:"Invalid unicode escape sequence: {0}",[rr.UNBALANCED_CLOSING_BRACE]:"Unbalanced closing brace",[rr.UNTERMINATED_CLOSING_BRACE]:"Unterminated closing brace",[rr.EMPTY_PLACEHOLDER]:"Empty placeholder",[rr.NOT_ALLOW_NEST_PLACEHOLDER]:"Not allowed nest placeholder",[rr.INVALID_LINKED_FORMAT]:"Invalid linked format",[rr.MUST_HAVE_MESSAGES_IN_PLURAL]:"Plural must have messages",[rr.UNEXPECTED_EMPTY_LINKED_MODIFIER]:"Unexpected empty linked modifier",[rr.UNEXPECTED_EMPTY_LINKED_KEY]:"Unexpected empty linked key",[rr.UNEXPECTED_LEXICAL_ANALYSIS]:"Unexpected lexical analysis in token: '{0}'",[rr.UNHANDLED_CODEGEN_NODE_TYPE]:"unhandled codegen node type: '{0}'",[rr.UNHANDLED_MINIFIER_NODE_TYPE]:"unhandled mimifier node type: '{0}'"};function mm(t,l,d={}){const{domain:_,messages:T,args:C}=d,P=kC((T||JD)[t]||"",...C||[]),V=new SyntaxError(String(P));return V.code=t,l&&(V.location=l),V.domain=_,V}function QD(t){throw t}const xh=" ",eO="\r",Oo=`
`,tO="\u2028",iO="\u2029";function rO(t){const l=t;let d=0,_=1,T=1,C=0;const P=rt=>l[rt]===eO&&l[rt+1]===Oo,V=rt=>l[rt]===Oo,s=rt=>l[rt]===iO,$=rt=>l[rt]===tO,Z=rt=>P(rt)||V(rt)||s(rt)||$(rt),J=()=>d,ne=()=>_,ue=()=>T,we=()=>C,Me=rt=>P(rt)||s(rt)||$(rt)?Oo:l[rt],Ye=()=>Me(d),Ze=()=>Me(d+C);function Fe(){return C=0,Z(d)&&(_++,T=0),P(d)&&d++,d++,T++,l[d]}function ae(){return P(d+C)&&C++,C++,l[d+C]}function ge(){d=0,_=1,T=1,C=0}function Oe(rt=0){C=rt}function ze(){const rt=d+C;for(;rt!==d;)Fe();C=0}return{index:J,line:ne,column:ue,peekOffset:we,charAt:Me,currentChar:Ye,currentPeek:Ze,next:Fe,peek:ae,reset:ge,resetPeek:Oe,skipToPeek:ze}}const Bu=void 0,nO=".",fT="'",sO="tokenizer";function oO(t,l={}){const d=l.location!==!1,_=rO(t),T=()=>_.index(),C=()=>qD(_.line(),_.column(),_.index()),P=C(),V=T(),s={currentType:14,offset:V,startLoc:P,endLoc:P,lastType:14,lastOffset:V,lastStartLoc:P,lastEndLoc:P,braceNest:0,inLinked:!1,text:""},$=()=>s,{onError:Z}=l;function J(Te,Ae,Qe,...$t){const Gt=$();if(Ae.column+=Qe,Ae.offset+=Qe,Z){const Zt=d?ox(Gt.startLoc,Ae):null,ut=mm(Te,Zt,{domain:sO,args:$t});Z(ut)}}function ne(Te,Ae,Qe){Te.endLoc=C(),Te.currentType=Ae;const $t={type:Ae};return d&&($t.loc=ox(Te.startLoc,Te.endLoc)),Qe!=null&&($t.value=Qe),$t}const ue=Te=>ne(Te,14);function we(Te,Ae){return Te.currentChar()===Ae?(Te.next(),Ae):(J(rr.EXPECTED_TOKEN,C(),0,Ae),"")}function Me(Te){let Ae="";for(;Te.currentPeek()===xh||Te.currentPeek()===Oo;)Ae+=Te.currentPeek(),Te.peek();return Ae}function Ye(Te){const Ae=Me(Te);return Te.skipToPeek(),Ae}function Ze(Te){if(Te===Bu)return!1;const Ae=Te.charCodeAt(0);return Ae>=97&&Ae<=122||Ae>=65&&Ae<=90||Ae===95}function Fe(Te){if(Te===Bu)return!1;const Ae=Te.charCodeAt(0);return Ae>=48&&Ae<=57}function ae(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==2)return!1;Me(Te);const $t=Ze(Te.currentPeek());return Te.resetPeek(),$t}function ge(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==2)return!1;Me(Te);const $t=Te.currentPeek()==="-"?Te.peek():Te.currentPeek(),Gt=Fe($t);return Te.resetPeek(),Gt}function Oe(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==2)return!1;Me(Te);const $t=Te.currentPeek()===fT;return Te.resetPeek(),$t}function ze(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==8)return!1;Me(Te);const $t=Te.currentPeek()===".";return Te.resetPeek(),$t}function rt(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==9)return!1;Me(Te);const $t=Ze(Te.currentPeek());return Te.resetPeek(),$t}function Ie(Te,Ae){const{currentType:Qe}=Ae;if(!(Qe===8||Qe===12))return!1;Me(Te);const $t=Te.currentPeek()===":";return Te.resetPeek(),$t}function Je(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==10)return!1;const $t=()=>{const Zt=Te.currentPeek();return Zt==="{"?Ze(Te.peek()):Zt==="@"||Zt==="%"||Zt==="|"||Zt===":"||Zt==="."||Zt===xh||!Zt?!1:Zt===Oo?(Te.peek(),$t()):bt(Te,!1)},Gt=$t();return Te.resetPeek(),Gt}function He(Te){Me(Te);const Ae=Te.currentPeek()==="|";return Te.resetPeek(),Ae}function ti(Te){const Ae=Me(Te),Qe=Te.currentPeek()==="%"&&Te.peek()==="{";return Te.resetPeek(),{isModulo:Qe,hasSpace:Ae.length>0}}function bt(Te,Ae=!0){const Qe=(Gt=!1,Zt="",ut=!1)=>{const Pt=Te.currentPeek();return Pt==="{"?Zt==="%"?!1:Gt:Pt==="@"||!Pt?Zt==="%"?!0:Gt:Pt==="%"?(Te.peek(),Qe(Gt,"%",!0)):Pt==="|"?Zt==="%"||ut?!0:!(Zt===xh||Zt===Oo):Pt===xh?(Te.peek(),Qe(!0,xh,ut)):Pt===Oo?(Te.peek(),Qe(!0,Oo,ut)):!0},$t=Qe();return Ae&&Te.resetPeek(),$t}function wt(Te,Ae){const Qe=Te.currentChar();return Qe===Bu?Bu:Ae(Qe)?(Te.next(),Qe):null}function xt(Te){const Ae=Te.charCodeAt(0);return Ae>=97&&Ae<=122||Ae>=65&&Ae<=90||Ae>=48&&Ae<=57||Ae===95||Ae===36}function Tt(Te){return wt(Te,xt)}function vt(Te){const Ae=Te.charCodeAt(0);return Ae>=97&&Ae<=122||Ae>=65&&Ae<=90||Ae>=48&&Ae<=57||Ae===95||Ae===36||Ae===45}function ai(Te){return wt(Te,vt)}function yi(Te){const Ae=Te.charCodeAt(0);return Ae>=48&&Ae<=57}function xi(Te){return wt(Te,yi)}function Pr(Te){const Ae=Te.charCodeAt(0);return Ae>=48&&Ae<=57||Ae>=65&&Ae<=70||Ae>=97&&Ae<=102}function tr(Te){return wt(Te,Pr)}function nr(Te){let Ae="",Qe="";for(;Ae=xi(Te);)Qe+=Ae;return Qe}function rn(Te){Ye(Te);const Ae=Te.currentChar();return Ae!=="%"&&J(rr.EXPECTED_TOKEN,C(),0,Ae),Te.next(),"%"}function dr(Te){let Ae="";for(;;){const Qe=Te.currentChar();if(Qe==="{"||Qe==="}"||Qe==="@"||Qe==="|"||!Qe)break;if(Qe==="%")if(bt(Te))Ae+=Qe,Te.next();else break;else if(Qe===xh||Qe===Oo)if(bt(Te))Ae+=Qe,Te.next();else{if(He(Te))break;Ae+=Qe,Te.next()}else Ae+=Qe,Te.next()}return Ae}function Rn(Te){Ye(Te);let Ae="",Qe="";for(;Ae=ai(Te);)Qe+=Ae;return Te.currentChar()===Bu&&J(rr.UNTERMINATED_CLOSING_BRACE,C(),0),Qe}function nn(Te){Ye(Te);let Ae="";return Te.currentChar()==="-"?(Te.next(),Ae+=`-${nr(Te)}`):Ae+=nr(Te),Te.currentChar()===Bu&&J(rr.UNTERMINATED_CLOSING_BRACE,C(),0),Ae}function zt(Te){return Te!==fT&&Te!==Oo}function fi(Te){Ye(Te),we(Te,"'");let Ae="",Qe="";for(;Ae=wt(Te,zt);)Ae==="\\"?Qe+=ri(Te):Qe+=Ae;const $t=Te.currentChar();return $t===Oo||$t===Bu?(J(rr.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,C(),0),$t===Oo&&(Te.next(),we(Te,"'")),Qe):(we(Te,"'"),Qe)}function ri(Te){const Ae=Te.currentChar();switch(Ae){case"\\":case"'":return Te.next(),`\\${Ae}`;case"u":return Ti(Te,Ae,4);case"U":return Ti(Te,Ae,6);default:return J(rr.UNKNOWN_ESCAPE_SEQUENCE,C(),0,Ae),""}}function Ti(Te,Ae,Qe){we(Te,Ae);let $t="";for(let Gt=0;Gt<Qe;Gt++){const Zt=tr(Te);if(!Zt){J(rr.INVALID_UNICODE_ESCAPE_SEQUENCE,C(),0,`\\${Ae}${$t}${Te.currentChar()}`);break}$t+=Zt}return`\\${Ae}${$t}`}function sr(Te){return Te!=="{"&&Te!=="}"&&Te!==xh&&Te!==Oo}function Ei(Te){Ye(Te);let Ae="",Qe="";for(;Ae=wt(Te,sr);)Qe+=Ae;return Qe}function xe(Te){let Ae="",Qe="";for(;Ae=Tt(Te);)Qe+=Ae;return Qe}function ve(Te){const Ae=Qe=>{const $t=Te.currentChar();return $t==="{"||$t==="%"||$t==="@"||$t==="|"||$t==="("||$t===")"||!$t||$t===xh?Qe:(Qe+=$t,Te.next(),Ae(Qe))};return Ae("")}function nt(Te){Ye(Te);const Ae=we(Te,"|");return Ye(Te),Ae}function Lt(Te,Ae){let Qe=null;switch(Te.currentChar()){case"{":return Ae.braceNest>=1&&J(rr.NOT_ALLOW_NEST_PLACEHOLDER,C(),0),Te.next(),Qe=ne(Ae,2,"{"),Ye(Te),Ae.braceNest++,Qe;case"}":return Ae.braceNest>0&&Ae.currentType===2&&J(rr.EMPTY_PLACEHOLDER,C(),0),Te.next(),Qe=ne(Ae,3,"}"),Ae.braceNest--,Ae.braceNest>0&&Ye(Te),Ae.inLinked&&Ae.braceNest===0&&(Ae.inLinked=!1),Qe;case"@":return Ae.braceNest>0&&J(rr.UNTERMINATED_CLOSING_BRACE,C(),0),Qe=It(Te,Ae)||ue(Ae),Ae.braceNest=0,Qe;default:{let Gt=!0,Zt=!0,ut=!0;if(He(Te))return Ae.braceNest>0&&J(rr.UNTERMINATED_CLOSING_BRACE,C(),0),Qe=ne(Ae,1,nt(Te)),Ae.braceNest=0,Ae.inLinked=!1,Qe;if(Ae.braceNest>0&&(Ae.currentType===5||Ae.currentType===6||Ae.currentType===7))return J(rr.UNTERMINATED_CLOSING_BRACE,C(),0),Ae.braceNest=0,Xt(Te,Ae);if(Gt=ae(Te,Ae))return Qe=ne(Ae,5,Rn(Te)),Ye(Te),Qe;if(Zt=ge(Te,Ae))return Qe=ne(Ae,6,nn(Te)),Ye(Te),Qe;if(ut=Oe(Te,Ae))return Qe=ne(Ae,7,fi(Te)),Ye(Te),Qe;if(!Gt&&!Zt&&!ut)return Qe=ne(Ae,13,Ei(Te)),J(rr.INVALID_TOKEN_IN_PLACEHOLDER,C(),0,Qe.value),Ye(Te),Qe;break}}return Qe}function It(Te,Ae){const{currentType:Qe}=Ae;let $t=null;const Gt=Te.currentChar();switch((Qe===8||Qe===9||Qe===12||Qe===10)&&(Gt===Oo||Gt===xh)&&J(rr.INVALID_LINKED_FORMAT,C(),0),Gt){case"@":return Te.next(),$t=ne(Ae,8,"@"),Ae.inLinked=!0,$t;case".":return Ye(Te),Te.next(),ne(Ae,9,".");case":":return Ye(Te),Te.next(),ne(Ae,10,":");default:return He(Te)?($t=ne(Ae,1,nt(Te)),Ae.braceNest=0,Ae.inLinked=!1,$t):ze(Te,Ae)||Ie(Te,Ae)?(Ye(Te),It(Te,Ae)):rt(Te,Ae)?(Ye(Te),ne(Ae,12,xe(Te))):Je(Te,Ae)?(Ye(Te),Gt==="{"?Lt(Te,Ae)||$t:ne(Ae,11,ve(Te))):(Qe===8&&J(rr.INVALID_LINKED_FORMAT,C(),0),Ae.braceNest=0,Ae.inLinked=!1,Xt(Te,Ae))}}function Xt(Te,Ae){let Qe={type:14};if(Ae.braceNest>0)return Lt(Te,Ae)||ue(Ae);if(Ae.inLinked)return It(Te,Ae)||ue(Ae);switch(Te.currentChar()){case"{":return Lt(Te,Ae)||ue(Ae);case"}":return J(rr.UNBALANCED_CLOSING_BRACE,C(),0),Te.next(),ne(Ae,3,"}");case"@":return It(Te,Ae)||ue(Ae);default:{if(He(Te))return Qe=ne(Ae,1,nt(Te)),Ae.braceNest=0,Ae.inLinked=!1,Qe;const{isModulo:Gt,hasSpace:Zt}=ti(Te);if(Gt)return Zt?ne(Ae,0,dr(Te)):ne(Ae,4,rn(Te));if(bt(Te))return ne(Ae,0,dr(Te));break}}return Qe}function ni(){const{currentType:Te,offset:Ae,startLoc:Qe,endLoc:$t}=s;return s.lastType=Te,s.lastOffset=Ae,s.lastStartLoc=Qe,s.lastEndLoc=$t,s.offset=T(),s.startLoc=C(),_.currentChar()===Bu?ne(s,14):Xt(_,s)}return{nextToken:ni,currentOffset:T,currentPosition:C,context:$}}const aO="parser",lO=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function cO(t,l,d){switch(t){case"\\\\":return"\\";case"\\'":return"'";default:{const _=parseInt(l||d,16);return _<=55295||_>=57344?String.fromCodePoint(_):""}}}function hO(t={}){const l=t.location!==!1,{onError:d,onWarn:_}=t;function T(ae,ge,Oe,ze,...rt){const Ie=ae.currentPosition();if(Ie.offset+=ze,Ie.column+=ze,d){const Je=l?ox(Oe,Ie):null,He=mm(ge,Je,{domain:aO,args:rt});d(He)}}function C(ae,ge,Oe,ze,...rt){const Ie=ae.currentPosition();if(Ie.offset+=ze,Ie.column+=ze,_){const Je=l?ox(Oe,Ie):null;_(KD(ge,Je,rt))}}function P(ae,ge,Oe){const ze={type:ae};return l&&(ze.start=ge,ze.end=ge,ze.loc={start:Oe,end:Oe}),ze}function V(ae,ge,Oe,ze){l&&(ae.end=ge,ae.loc&&(ae.loc.end=Oe))}function s(ae,ge){const Oe=ae.context(),ze=P(3,Oe.offset,Oe.startLoc);return ze.value=ge,V(ze,ae.currentOffset(),ae.currentPosition()),ze}function $(ae,ge){const Oe=ae.context(),{lastOffset:ze,lastStartLoc:rt}=Oe,Ie=P(5,ze,rt);return Ie.index=parseInt(ge,10),ae.nextToken(),V(Ie,ae.currentOffset(),ae.currentPosition()),Ie}function Z(ae,ge,Oe){const ze=ae.context(),{lastOffset:rt,lastStartLoc:Ie}=ze,Je=P(4,rt,Ie);return Je.key=ge,Oe===!0&&(Je.modulo=!0),ae.nextToken(),V(Je,ae.currentOffset(),ae.currentPosition()),Je}function J(ae,ge){const Oe=ae.context(),{lastOffset:ze,lastStartLoc:rt}=Oe,Ie=P(9,ze,rt);return Ie.value=ge.replace(lO,cO),ae.nextToken(),V(Ie,ae.currentOffset(),ae.currentPosition()),Ie}function ne(ae){const ge=ae.nextToken(),Oe=ae.context(),{lastOffset:ze,lastStartLoc:rt}=Oe,Ie=P(8,ze,rt);return ge.type!==12?(T(ae,rr.UNEXPECTED_EMPTY_LINKED_MODIFIER,Oe.lastStartLoc,0),Ie.value="",V(Ie,ze,rt),{nextConsumeToken:ge,node:Ie}):(ge.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,Oe.lastStartLoc,0,Ll(ge)),Ie.value=ge.value||"",V(Ie,ae.currentOffset(),ae.currentPosition()),{node:Ie})}function ue(ae,ge){const Oe=ae.context(),ze=P(7,Oe.offset,Oe.startLoc);return ze.value=ge,V(ze,ae.currentOffset(),ae.currentPosition()),ze}function we(ae){const ge=ae.context(),Oe=P(6,ge.offset,ge.startLoc);let ze=ae.nextToken();if(ze.type===9){const rt=ne(ae);Oe.modifier=rt.node,ze=rt.nextConsumeToken||ae.nextToken()}switch(ze.type!==10&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(ze)),ze=ae.nextToken(),ze.type===2&&(ze=ae.nextToken()),ze.type){case 11:ze.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(ze)),Oe.key=ue(ae,ze.value||"");break;case 5:ze.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(ze)),Oe.key=Z(ae,ze.value||"");break;case 6:ze.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(ze)),Oe.key=$(ae,ze.value||"");break;case 7:ze.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(ze)),Oe.key=J(ae,ze.value||"");break;default:{T(ae,rr.UNEXPECTED_EMPTY_LINKED_KEY,ge.lastStartLoc,0);const rt=ae.context(),Ie=P(7,rt.offset,rt.startLoc);return Ie.value="",V(Ie,rt.offset,rt.startLoc),Oe.key=Ie,V(Oe,rt.offset,rt.startLoc),{nextConsumeToken:ze,node:Oe}}}return V(Oe,ae.currentOffset(),ae.currentPosition()),{node:Oe}}function Me(ae){const ge=ae.context(),Oe=ge.currentType===1?ae.currentOffset():ge.offset,ze=ge.currentType===1?ge.endLoc:ge.startLoc,rt=P(2,Oe,ze);rt.items=[];let Ie=null,Je=null;do{const bt=Ie||ae.nextToken();switch(Ie=null,bt.type){case 0:bt.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(bt)),rt.items.push(s(ae,bt.value||""));break;case 6:bt.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(bt)),rt.items.push($(ae,bt.value||""));break;case 4:Je=!0;break;case 5:bt.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(bt)),rt.items.push(Z(ae,bt.value||"",!!Je)),Je&&(C(ae,jb.USE_MODULO_SYNTAX,ge.lastStartLoc,0,Ll(bt)),Je=null);break;case 7:bt.value==null&&T(ae,rr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Ll(bt)),rt.items.push(J(ae,bt.value||""));break;case 8:{const wt=we(ae);rt.items.push(wt.node),Ie=wt.nextConsumeToken||null;break}}}while(ge.currentType!==14&&ge.currentType!==1);const He=ge.currentType===1?ge.lastOffset:ae.currentOffset(),ti=ge.currentType===1?ge.lastEndLoc:ae.currentPosition();return V(rt,He,ti),rt}function Ye(ae,ge,Oe,ze){const rt=ae.context();let Ie=ze.items.length===0;const Je=P(1,ge,Oe);Je.cases=[],Je.cases.push(ze);do{const He=Me(ae);Ie||(Ie=He.items.length===0),Je.cases.push(He)}while(rt.currentType!==14);return Ie&&T(ae,rr.MUST_HAVE_MESSAGES_IN_PLURAL,Oe,0),V(Je,ae.currentOffset(),ae.currentPosition()),Je}function Ze(ae){const ge=ae.context(),{offset:Oe,startLoc:ze}=ge,rt=Me(ae);return ge.currentType===14?rt:Ye(ae,Oe,ze,rt)}function Fe(ae){const ge=oO(ae,PC({},t)),Oe=ge.context(),ze=P(0,Oe.offset,Oe.startLoc);return l&&ze.loc&&(ze.loc.source=ae),ze.body=Ze(ge),t.onCacheKey&&(ze.cacheKey=t.onCacheKey(ae)),Oe.currentType!==14&&T(ge,rr.UNEXPECTED_LEXICAL_ANALYSIS,Oe.lastStartLoc,0,ae[Oe.offset]||""),V(ze,ge.currentOffset(),ge.currentPosition()),ze}return{parse:Fe}}function Ll(t){if(t.type===14)return"EOF";const l=(t.value||"").replace(/\r?\n/gu,"\\n");return l.length>10?l.slice(0,9)+"":l}function uO(t,l={}){const d={ast:t,helpers:new Set};return{context:()=>d,helper:C=>(d.helpers.add(C),C)}}function pT(t,l){for(let d=0;d<t.length;d++)$b(t[d],l)}function $b(t,l){switch(t.type){case 1:pT(t.cases,l),l.helper("plural");break;case 2:pT(t.items,l);break;case 6:{$b(t.key,l),l.helper("linked"),l.helper("type");break}case 5:l.helper("interpolate"),l.helper("list");break;case 4:l.helper("interpolate"),l.helper("named");break}}function dO(t,l={}){const d=uO(t);d.helper("normalize"),t.body&&$b(t.body,d);const _=d.context();t.helpers=Array.from(_.helpers)}function fO(t){const l=t.body;return l.type===2?mT(l):l.cases.forEach(d=>mT(d)),t}function mT(t){if(t.items.length===1){const l=t.items[0];(l.type===3||l.type===9)&&(t.static=l.value,delete l.value)}else{const l=[];for(let d=0;d<t.items.length;d++){const _=t.items[d];if(!(_.type===3||_.type===9)||_.value==null)break;l.push(_.value)}if(l.length===t.items.length){t.static=LC(l);for(let d=0;d<t.items.length;d++){const _=t.items[d];(_.type===3||_.type===9)&&delete _.value}}}}const pO="minifier";function Xp(t){switch(t.t=t.type,t.type){case 0:{const l=t;Xp(l.body),l.b=l.body,delete l.body;break}case 1:{const l=t,d=l.cases;for(let _=0;_<d.length;_++)Xp(d[_]);l.c=d,delete l.cases;break}case 2:{const l=t,d=l.items;for(let _=0;_<d.length;_++)Xp(d[_]);l.i=d,delete l.items,l.static&&(l.s=l.static,delete l.static);break}case 3:case 9:case 8:case 7:{const l=t;l.value&&(l.v=l.value,delete l.value);break}case 6:{const l=t;Xp(l.key),l.k=l.key,delete l.key,l.modifier&&(Xp(l.modifier),l.m=l.modifier,delete l.modifier);break}case 5:{const l=t;l.i=l.index,delete l.index;break}case 4:{const l=t;l.k=l.key,delete l.key;break}default:throw mm(rr.UNHANDLED_MINIFIER_NODE_TYPE,null,{domain:pO,args:[t.type]})}delete t.type}const mO="parser";function gO(t,l){const{filename:d,breakLineCode:_,needIndent:T}=l,C=l.location!==!1,P={filename:d,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:_,needIndent:T,indentLevel:0};C&&t.loc&&(P.source=t.loc.source);const V=()=>P;function s(Me,Ye){P.code+=Me}function $(Me,Ye=!0){const Ze=Ye?_:"";s(T?Ze+"  ".repeat(Me):Ze)}function Z(Me=!0){const Ye=++P.indentLevel;Me&&$(Ye)}function J(Me=!0){const Ye=--P.indentLevel;Me&&$(Ye)}function ne(){$(P.indentLevel)}return{context:V,push:s,indent:Z,deindent:J,newline:ne,helper:Me=>`_${Me}`,needIndent:()=>P.needIndent}}function _O(t,l){const{helper:d}=t;t.push(`${d("linked")}(`),cm(t,l.key),l.modifier?(t.push(", "),cm(t,l.modifier),t.push(", _type")):t.push(", undefined, _type"),t.push(")")}function yO(t,l){const{helper:d,needIndent:_}=t;t.push(`${d("normalize")}([`),t.indent(_());const T=l.items.length;for(let C=0;C<T&&(cm(t,l.items[C]),C!==T-1);C++)t.push(", ");t.deindent(_()),t.push("])")}function xO(t,l){const{helper:d,needIndent:_}=t;if(l.cases.length>1){t.push(`${d("plural")}([`),t.indent(_());const T=l.cases.length;for(let C=0;C<T&&(cm(t,l.cases[C]),C!==T-1);C++)t.push(", ");t.deindent(_()),t.push("])")}}function vO(t,l){l.body?cm(t,l.body):t.push("null")}function cm(t,l){const{helper:d}=t;switch(l.type){case 0:vO(t,l);break;case 1:xO(t,l);break;case 2:yO(t,l);break;case 6:_O(t,l);break;case 8:t.push(JSON.stringify(l.value),l);break;case 7:t.push(JSON.stringify(l.value),l);break;case 5:t.push(`${d("interpolate")}(${d("list")}(${l.index}))`,l);break;case 4:t.push(`${d("interpolate")}(${d("named")}(${JSON.stringify(l.key)}))`,l);break;case 9:t.push(JSON.stringify(l.value),l);break;case 3:t.push(JSON.stringify(l.value),l);break;default:throw mm(rr.UNHANDLED_CODEGEN_NODE_TYPE,null,{domain:mO,args:[l.type]})}}const bO=(t,l={})=>{const d=dT(l.mode)?l.mode:"normal",_=dT(l.filename)?l.filename:"message.intl";l.sourceMap;const T=l.breakLineCode!=null?l.breakLineCode:d==="arrow"?";":`
`,C=l.needIndent?l.needIndent:d!=="arrow",P=t.helpers||[],V=gO(t,{filename:_,breakLineCode:T,needIndent:C});V.push(d==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),V.indent(C),P.length>0&&(V.push(`const { ${LC(P.map(Z=>`${Z}: _${Z}`),", ")} } = ctx`),V.newline()),V.push("return "),cm(V,t),V.deindent(C),V.push("}"),delete t.helpers;const{code:s,map:$}=V.context();return{ast:t,code:s,map:$?$.toJSON():void 0}};function wO(t,l={}){const d=PC({},l),_=!!d.jit,T=!!d.minify,C=d.optimize==null?!0:d.optimize,V=hO(d).parse(t);return _?(C&&fO(V),T&&Xp(V),{ast:V,code:""}):(dO(V,d),bO(V,d))}/*!
  * core-base v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function TO(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(Ch().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(Ch().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(Ch().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}function Lc(t){return qr(t)&&Gb(t)===0&&(Rl(t,"b")||Rl(t,"body"))}const DC=["b","body"];function EO(t){return Qu(t,DC)}const OC=["c","cases"];function SO(t){return Qu(t,OC,[])}const RC=["s","static"];function CO(t){return Qu(t,RC)}const zC=["i","items"];function AO(t){return Qu(t,zC,[])}const BC=["t","type"];function Gb(t){return Qu(t,BC)}const FC=["v","value"];function Oy(t,l){const d=Qu(t,FC);if(d!=null)return d;throw e_(l)}const NC=["m","modifier"];function MO(t){return Qu(t,NC)}const UC=["k","key"];function IO(t){const l=Qu(t,UC);if(l)return l;throw e_(6)}function Qu(t,l,d){for(let _=0;_<l.length;_++){const T=l[_];if(Rl(t,T)&&t[T]!=null)return t[T]}return d}const VC=[...DC,...OC,...RC,...zC,...UC,...NC,...FC,...BC];function e_(t){return new Error(`unhandled node type: ${t}`)}const ed=[];ed[0]={w:[0],i:[3,0],"[":[4],o:[7]};ed[1]={w:[1],".":[2],"[":[4],o:[7]};ed[2]={w:[2],i:[3,0],0:[3,0]};ed[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};ed[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};ed[5]={"'":[4,0],o:8,l:[5,0]};ed[6]={'"':[4,0],o:8,l:[6,0]};const kO=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function PO(t){return kO.test(t)}function LO(t){const l=t.charCodeAt(0),d=t.charCodeAt(t.length-1);return l===d&&(l===34||l===39)?t.slice(1,-1):t}function DO(t){if(t==null)return"o";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function OO(t){const l=t.trim();return t.charAt(0)==="0"&&isNaN(parseInt(t))?!1:PO(l)?LO(l):"*"+l}function RO(t){const l=[];let d=-1,_=0,T=0,C,P,V,s,$,Z,J;const ne=[];ne[0]=()=>{P===void 0?P=V:P+=V},ne[1]=()=>{P!==void 0&&(l.push(P),P=void 0)},ne[2]=()=>{ne[0](),T++},ne[3]=()=>{if(T>0)T--,_=4,ne[0]();else{if(T=0,P===void 0||(P=OO(P),P===!1))return!1;ne[1]()}};function ue(){const we=t[d+1];if(_===5&&we==="'"||_===6&&we==='"')return d++,V="\\"+we,ne[0](),!0}for(;_!==null;)if(d++,C=t[d],!(C==="\\"&&ue())){if(s=DO(C),J=ed[_],$=J[s]||J.l||8,$===8||(_=$[0],$[1]!==void 0&&(Z=ne[$[1]],Z&&(V=C,Z()===!1))))return;if(_===7)return l}}const gT=new Map;function zO(t,l){return qr(t)?t[l]:null}function BO(t,l){if(!qr(t))return null;let d=gT.get(l);if(d||(d=RO(l),d&&gT.set(l,d)),!d)return null;const _=d.length;let T=t,C=0;for(;C<_;){const P=d[C];if(VC.includes(P)&&Lc(T))return null;const V=T[P];if(V===void 0||Pn(T))return null;T=V,C++}return T}const FO=t=>t,NO=t=>"",UO="text",VO=t=>t.length===0?"":HD(t),jO=WD;function _T(t,l){return t=Math.abs(t),l===2?t?t>1?1:0:1:t?Math.min(t,2):0}function $O(t){const l=cs(t.pluralIndex)?t.pluralIndex:-1;return t.named&&(cs(t.named.count)||cs(t.named.n))?cs(t.named.count)?t.named.count:cs(t.named.n)?t.named.n:l:l}function GO(t,l){l.count||(l.count=t),l.n||(l.n=t)}function WO(t={}){const l=t.locale,d=$O(t),_=qr(t.pluralRules)&&Si(l)&&Pn(t.pluralRules[l])?t.pluralRules[l]:_T,T=qr(t.pluralRules)&&Si(l)&&Pn(t.pluralRules[l])?_T:void 0,C=Ze=>Ze[_(d,Ze.length,T)],P=t.list||[],V=Ze=>P[Ze],s=t.named||mn();cs(t.pluralIndex)&&GO(d,s);const $=Ze=>s[Ze];function Z(Ze){const Fe=Pn(t.messages)?t.messages(Ze):qr(t.messages)?t.messages[Ze]:!1;return Fe||(t.parent?t.parent.message(Ze):NO)}const J=Ze=>t.modifiers?t.modifiers[Ze]:FO,ne=hr(t.processor)&&Pn(t.processor.normalize)?t.processor.normalize:VO,ue=hr(t.processor)&&Pn(t.processor.interpolate)?t.processor.interpolate:jO,we=hr(t.processor)&&Si(t.processor.type)?t.processor.type:UO,Ye={list:V,named:$,plural:C,linked:(Ze,...Fe)=>{const[ae,ge]=Fe;let Oe="text",ze="";Fe.length===1?qr(ae)?(ze=ae.modifier||ze,Oe=ae.type||Oe):Si(ae)&&(ze=ae||ze):Fe.length===2&&(Si(ae)&&(ze=ae||ze),Si(ge)&&(Oe=ge||Oe));const rt=Z(Ze)(Ye),Ie=Oe==="vnode"&&Vn(rt)&&ze?rt[0]:rt;return ze?J(ze)(Ie,Oe):Ie},message:Z,type:we,interpolate:ue,normalize:ne,values:Xs(mn(),P,s)};return Ye}let t_=null;function HO(t){t_=t}function qO(t,l,d){t_&&t_.emit("i18n:init",{timestamp:Date.now(),i18n:t,version:l,meta:d})}const XO=ZO("function:translate");function ZO(t){return l=>t_&&t_.emit(t,l)}const YO=jb.__EXTEND_POINT__,Tf=Ox(YO),KO={FALLBACK_TO_TRANSLATE:Tf(),CANNOT_FORMAT_NUMBER:Tf(),FALLBACK_TO_NUMBER_FORMAT:Tf(),CANNOT_FORMAT_DATE:Tf(),FALLBACK_TO_DATE_FORMAT:Tf(),EXPERIMENTAL_CUSTOM_MESSAGE_COMPILER:Tf(),__EXTEND_POINT__:Tf()},jC=rr.__EXTEND_POINT__,Ef=Ox(jC),zl={INVALID_ARGUMENT:jC,INVALID_DATE_ARGUMENT:Ef(),INVALID_ISO_DATE_ARGUMENT:Ef(),NOT_SUPPORT_NON_STRING_MESSAGE:Ef(),NOT_SUPPORT_LOCALE_PROMISE_VALUE:Ef(),NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:Ef(),NOT_SUPPORT_LOCALE_TYPE:Ef(),__EXTEND_POINT__:Ef()};function Pc(t){return mm(t,null,void 0)}function Wb(t,l){return l.locale!=null?yT(l.locale):yT(t.locale)}let m0;function yT(t){if(Si(t))return t;if(Pn(t)){if(t.resolvedOnce&&m0!=null)return m0;if(t.constructor.name==="Function"){const l=t();if(GD(l))throw Pc(zl.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return m0=l}else throw Pc(zl.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw Pc(zl.NOT_SUPPORT_LOCALE_TYPE)}function JO(t,l,d){return[...new Set([d,...Vn(l)?l:qr(l)?Object.keys(l):Si(l)?[l]:[d]])]}function $C(t,l,d){const _=Si(d)?d:hm,T=t;T.__localeChainCache||(T.__localeChainCache=new Map);let C=T.__localeChainCache.get(_);if(!C){C=[];let P=[d];for(;Vn(P);)P=xT(C,P,l);const V=Vn(l)||!hr(l)?l:l.default?l.default:null;P=Si(V)?[V]:V,Vn(P)&&xT(C,P,!1),T.__localeChainCache.set(_,C)}return C}function xT(t,l,d){let _=!0;for(let T=0;T<l.length&&Sr(_);T++){const C=l[T];Si(C)&&(_=QO(t,l[T],d))}return _}function QO(t,l,d){let _;const T=l.split("-");do{const C=T.join("-");_=eR(t,C,d),T.splice(-1,1)}while(T.length&&_===!0);return _}function eR(t,l,d){let _=!1;if(!t.includes(l)&&(_=!0,l)){_=l[l.length-1]!=="!";const T=l.replace(/!/g,"");t.push(T),(Vn(d)||hr(d))&&d[T]&&(_=d[T])}return _}const tR="9.14.5",Rx=-1,hm="en-US",vT="",bT=t=>`${t.charAt(0).toLocaleUpperCase()}${t.substr(1)}`;function iR(){return{upper:(t,l)=>l==="text"&&Si(t)?t.toUpperCase():l==="vnode"&&qr(t)&&"__v_isVNode"in t?t.children.toUpperCase():t,lower:(t,l)=>l==="text"&&Si(t)?t.toLowerCase():l==="vnode"&&qr(t)&&"__v_isVNode"in t?t.children.toLowerCase():t,capitalize:(t,l)=>l==="text"&&Si(t)?bT(t):l==="vnode"&&qr(t)&&"__v_isVNode"in t?bT(t.children):t}}let GC;function wT(t){GC=t}let WC;function rR(t){WC=t}let HC;function nR(t){HC=t}let qC=null;const sR=t=>{qC=t},oR=()=>qC;let XC=null;const TT=t=>{XC=t},aR=()=>XC;let ET=0;function lR(t={}){const l=Pn(t.onWarn)?t.onWarn:BD,d=Si(t.version)?t.version:tR,_=Si(t.locale)||Pn(t.locale)?t.locale:hm,T=Pn(_)?hm:_,C=Vn(t.fallbackLocale)||hr(t.fallbackLocale)||Si(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:T,P=hr(t.messages)?t.messages:g0(T),V=hr(t.datetimeFormats)?t.datetimeFormats:g0(T),s=hr(t.numberFormats)?t.numberFormats:g0(T),$=Xs(mn(),t.modifiers,iR()),Z=t.pluralRules||mn(),J=Pn(t.missing)?t.missing:null,ne=Sr(t.missingWarn)||Zu(t.missingWarn)?t.missingWarn:!0,ue=Sr(t.fallbackWarn)||Zu(t.fallbackWarn)?t.fallbackWarn:!0,we=!!t.fallbackFormat,Me=!!t.unresolving,Ye=Pn(t.postTranslation)?t.postTranslation:null,Ze=hr(t.processor)?t.processor:null,Fe=Sr(t.warnHtmlMessage)?t.warnHtmlMessage:!0,ae=!!t.escapeParameter,ge=Pn(t.messageCompiler)?t.messageCompiler:GC,Oe=Pn(t.messageResolver)?t.messageResolver:WC||zO,ze=Pn(t.localeFallbacker)?t.localeFallbacker:HC||JO,rt=qr(t.fallbackContext)?t.fallbackContext:void 0,Ie=t,Je=qr(Ie.__datetimeFormatters)?Ie.__datetimeFormatters:new Map,He=qr(Ie.__numberFormatters)?Ie.__numberFormatters:new Map,ti=qr(Ie.__meta)?Ie.__meta:{};ET++;const bt={version:d,cid:ET,locale:_,fallbackLocale:C,messages:P,modifiers:$,pluralRules:Z,missing:J,missingWarn:ne,fallbackWarn:ue,fallbackFormat:we,unresolving:Me,postTranslation:Ye,processor:Ze,warnHtmlMessage:Fe,escapeParameter:ae,messageCompiler:ge,messageResolver:Oe,localeFallbacker:ze,fallbackContext:rt,onWarn:l,__meta:ti};return bt.datetimeFormats=V,bt.numberFormats=s,bt.__datetimeFormatters=Je,bt.__numberFormatters=He,__INTLIFY_PROD_DEVTOOLS__&&qO(bt,d,ti),bt}const g0=t=>({[t]:mn()});function Hb(t,l,d,_,T){const{missing:C,onWarn:P}=t;if(C!==null){const V=C(t,d,l,T);return Si(V)?V:l}else return l}function Sg(t,l,d){const _=t;_.__localeChainCache=new Map,t.localeFallbacker(t,d,l)}function cR(t,l){return t===l?!1:t.split("-")[0]===l.split("-")[0]}function hR(t,l){const d=l.indexOf(t);if(d===-1)return!1;for(let _=d+1;_<l.length;_++)if(cR(t,l[_]))return!0;return!1}function _0(t){return d=>uR(d,t)}function uR(t,l){const d=EO(l);if(d==null)throw e_(0);if(Gb(d)===1){const C=SO(d);return t.plural(C.reduce((P,V)=>[...P,ST(t,V)],[]))}else return ST(t,d)}function ST(t,l){const d=CO(l);if(d!=null)return t.type==="text"?d:t.normalize([d]);{const _=AO(l).reduce((T,C)=>[...T,q0(t,C)],[]);return t.normalize(_)}}function q0(t,l){const d=Gb(l);switch(d){case 3:return Oy(l,d);case 9:return Oy(l,d);case 4:{const _=l;if(Rl(_,"k")&&_.k)return t.interpolate(t.named(_.k));if(Rl(_,"key")&&_.key)return t.interpolate(t.named(_.key));throw e_(d)}case 5:{const _=l;if(Rl(_,"i")&&cs(_.i))return t.interpolate(t.list(_.i));if(Rl(_,"index")&&cs(_.index))return t.interpolate(t.list(_.index));throw e_(d)}case 6:{const _=l,T=MO(_),C=IO(_);return t.linked(q0(t,C),T?q0(t,T):void 0,t.type)}case 7:return Oy(l,d);case 8:return Oy(l,d);default:throw new Error(`unhandled node on format message part: ${d}`)}}const ZC=t=>t;let Yp=mn();function YC(t,l={}){let d=!1;const _=l.onError||QD;return l.onError=T=>{d=!0,_(T)},{...wO(t,l),detectError:d}}const dR=(t,l)=>{if(!Si(t))throw Pc(zl.NOT_SUPPORT_NON_STRING_MESSAGE);{Sr(l.warnHtmlMessage)&&l.warnHtmlMessage;const _=(l.onCacheKey||ZC)(t),T=Yp[_];if(T)return T;const{code:C,detectError:P}=YC(t,l),V=new Function(`return ${C}`)();return P?V:Yp[_]=V}};function fR(t,l){if(__INTLIFY_JIT_COMPILATION__&&!__INTLIFY_DROP_MESSAGE_COMPILER__&&Si(t)){Sr(l.warnHtmlMessage)&&l.warnHtmlMessage;const _=(l.onCacheKey||ZC)(t),T=Yp[_];if(T)return T;const{ast:C,detectError:P}=YC(t,{...l,location:!1,jit:!0}),V=_0(C);return P?V:Yp[_]=V}else{const d=t.cacheKey;if(d){const _=Yp[d];return _||(Yp[d]=_0(t))}else return _0(t)}}const CT=()=>"",rl=t=>Pn(t);function AT(t,...l){const{fallbackFormat:d,postTranslation:_,unresolving:T,messageCompiler:C,fallbackLocale:P,messages:V}=t,[s,$]=X0(...l),Z=Sr($.missingWarn)?$.missingWarn:t.missingWarn,J=Sr($.fallbackWarn)?$.fallbackWarn:t.fallbackWarn,ne=Sr($.escapeParameter)?$.escapeParameter:t.escapeParameter,ue=!!$.resolvedMessage,we=Si($.default)||Sr($.default)?Sr($.default)?C?s:()=>s:$.default:d?C?s:()=>s:"",Me=d||we!=="",Ye=Wb(t,$);ne&&pR($);let[Ze,Fe,ae]=ue?[s,Ye,V[Ye]||mn()]:KC(t,s,Ye,P,J,Z),ge=Ze,Oe=s;if(!ue&&!(Si(ge)||Lc(ge)||rl(ge))&&Me&&(ge=we,Oe=ge),!ue&&(!(Si(ge)||Lc(ge)||rl(ge))||!Si(Fe)))return T?Rx:s;let ze=!1;const rt=()=>{ze=!0},Ie=rl(ge)?ge:JC(t,s,Fe,ge,Oe,rt);if(ze)return ge;const Je=_R(t,Fe,ae,$),He=WO(Je),ti=mR(t,Ie,He);let bt=_?_(ti,s):ti;if(ne&&Si(bt)&&(bt=jD(bt)),__INTLIFY_PROD_DEVTOOLS__){const wt={timestamp:Date.now(),key:Si(s)?s:rl(ge)?ge.key:"",locale:Fe||(rl(ge)?ge.locale:""),format:Si(ge)?ge:rl(ge)?ge.source:"",message:bt};wt.meta=Xs({},t.__meta,oR()||{}),XO(wt)}return bt}function pR(t){Vn(t.list)?t.list=t.list.map(l=>Si(l)?hT(l):l):qr(t.named)&&Object.keys(t.named).forEach(l=>{Si(t.named[l])&&(t.named[l]=hT(t.named[l]))})}function KC(t,l,d,_,T,C){const{messages:P,onWarn:V,messageResolver:s,localeFallbacker:$}=t,Z=$(t,_,d);let J=mn(),ne,ue=null;const we="translate";for(let Me=0;Me<Z.length&&(ne=Z[Me],J=P[ne]||mn(),(ue=s(J,l))===null&&(ue=J[l]),!(Si(ue)||Lc(ue)||rl(ue)));Me++)if(!hR(ne,Z)){const Ye=Hb(t,l,ne,C,we);Ye!==l&&(ue=Ye)}return[ue,ne,J]}function JC(t,l,d,_,T,C){const{messageCompiler:P,warnHtmlMessage:V}=t;if(rl(_)){const $=_;return $.locale=$.locale||d,$.key=$.key||l,$}if(P==null){const $=()=>_;return $.locale=d,$.key=l,$}const s=P(_,gR(t,d,T,_,V,C));return s.locale=d,s.key=l,s.source=_,s}function mR(t,l,d){return l(d)}function X0(...t){const[l,d,_]=t,T=mn();if(!Si(l)&&!cs(l)&&!rl(l)&&!Lc(l))throw Pc(zl.INVALID_ARGUMENT);const C=cs(l)?String(l):(rl(l),l);return cs(d)?T.plural=d:Si(d)?T.default=d:hr(d)&&!Dx(d)?T.named=d:Vn(d)&&(T.list=d),cs(_)?T.plural=_:Si(_)?T.default=_:hr(_)&&Xs(T,_),[C,T]}function gR(t,l,d,_,T,C){return{locale:l,key:d,warnHtmlMessage:T,onError:P=>{throw C&&C(P),P},onCacheKey:P=>FD(l,d,P)}}function _R(t,l,d,_){const{modifiers:T,pluralRules:C,messageResolver:P,fallbackLocale:V,fallbackWarn:s,missingWarn:$,fallbackContext:Z}=t,ne={locale:l,modifiers:T,pluralRules:C,messages:ue=>{let we=P(d,ue);if(we==null&&Z){const[,,Me]=KC(Z,ue,l,V,s,$);we=P(Me,ue)}if(Si(we)||Lc(we)){let Me=!1;const Ze=JC(t,ue,l,we,ue,()=>{Me=!0});return Me?CT:Ze}else return rl(we)?we:CT}};return t.processor&&(ne.processor=t.processor),_.list&&(ne.list=_.list),_.named&&(ne.named=_.named),cs(_.plural)&&(ne.pluralIndex=_.plural),ne}function MT(t,...l){const{datetimeFormats:d,unresolving:_,fallbackLocale:T,onWarn:C,localeFallbacker:P}=t,{__datetimeFormatters:V}=t,[s,$,Z,J]=Z0(...l),ne=Sr(Z.missingWarn)?Z.missingWarn:t.missingWarn;Sr(Z.fallbackWarn)?Z.fallbackWarn:t.fallbackWarn;const ue=!!Z.part,we=Wb(t,Z),Me=P(t,T,we);if(!Si(s)||s==="")return new Intl.DateTimeFormat(we,J).format($);let Ye={},Ze,Fe=null;const ae="datetime format";for(let ze=0;ze<Me.length&&(Ze=Me[ze],Ye=d[Ze]||{},Fe=Ye[s],!hr(Fe));ze++)Hb(t,s,Ze,ne,ae);if(!hr(Fe)||!Si(Ze))return _?Rx:s;let ge=`${Ze}__${s}`;Dx(J)||(ge=`${ge}__${JSON.stringify(J)}`);let Oe=V.get(ge);return Oe||(Oe=new Intl.DateTimeFormat(Ze,Xs({},Fe,J)),V.set(ge,Oe)),ue?Oe.formatToParts($):Oe.format($)}const QC=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function Z0(...t){const[l,d,_,T]=t,C=mn();let P=mn(),V;if(Si(l)){const s=l.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!s)throw Pc(zl.INVALID_ISO_DATE_ARGUMENT);const $=s[3]?s[3].trim().startsWith("T")?`${s[1].trim()}${s[3].trim()}`:`${s[1].trim()}T${s[3].trim()}`:s[1].trim();V=new Date($);try{V.toISOString()}catch{throw Pc(zl.INVALID_ISO_DATE_ARGUMENT)}}else if(UD(l)){if(isNaN(l.getTime()))throw Pc(zl.INVALID_DATE_ARGUMENT);V=l}else if(cs(l))V=l;else throw Pc(zl.INVALID_ARGUMENT);return Si(d)?C.key=d:hr(d)&&Object.keys(d).forEach(s=>{QC.includes(s)?P[s]=d[s]:C[s]=d[s]}),Si(_)?C.locale=_:hr(_)&&(P=_),hr(T)&&(P=T),[C.key||"",V,C,P]}function IT(t,l,d){const _=t;for(const T in d){const C=`${l}__${T}`;_.__datetimeFormatters.has(C)&&_.__datetimeFormatters.delete(C)}}function kT(t,...l){const{numberFormats:d,unresolving:_,fallbackLocale:T,onWarn:C,localeFallbacker:P}=t,{__numberFormatters:V}=t,[s,$,Z,J]=Y0(...l),ne=Sr(Z.missingWarn)?Z.missingWarn:t.missingWarn;Sr(Z.fallbackWarn)?Z.fallbackWarn:t.fallbackWarn;const ue=!!Z.part,we=Wb(t,Z),Me=P(t,T,we);if(!Si(s)||s==="")return new Intl.NumberFormat(we,J).format($);let Ye={},Ze,Fe=null;const ae="number format";for(let ze=0;ze<Me.length&&(Ze=Me[ze],Ye=d[Ze]||{},Fe=Ye[s],!hr(Fe));ze++)Hb(t,s,Ze,ne,ae);if(!hr(Fe)||!Si(Ze))return _?Rx:s;let ge=`${Ze}__${s}`;Dx(J)||(ge=`${ge}__${JSON.stringify(J)}`);let Oe=V.get(ge);return Oe||(Oe=new Intl.NumberFormat(Ze,Xs({},Fe,J)),V.set(ge,Oe)),ue?Oe.formatToParts($):Oe.format($)}const eA=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function Y0(...t){const[l,d,_,T]=t,C=mn();let P=mn();if(!cs(l))throw Pc(zl.INVALID_ARGUMENT);const V=l;return Si(d)?C.key=d:hr(d)&&Object.keys(d).forEach(s=>{eA.includes(s)?P[s]=d[s]:C[s]=d[s]}),Si(_)?C.locale=_:hr(_)&&(P=_),hr(T)&&(P=T),[C.key||"",V,C,P]}function PT(t,l,d){const _=t;for(const T in d){const C=`${l}__${T}`;_.__numberFormatters.has(C)&&_.__numberFormatters.delete(C)}}TO();/*!
  * vue-i18n v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */const yR="9.14.5";function xR(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&(Ch().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&(Ch().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(Ch().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(Ch().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(Ch().__INTLIFY_PROD_DEVTOOLS__=!1)}const vR=KO.__EXTEND_POINT__,vh=Ox(vR);vh(),vh(),vh(),vh(),vh(),vh(),vh(),vh(),vh();const tA=zl.__EXTEND_POINT__,na=Ox(tA),ks={UNEXPECTED_RETURN_TYPE:tA,INVALID_ARGUMENT:na(),MUST_BE_CALL_SETUP_TOP:na(),NOT_INSTALLED:na(),NOT_AVAILABLE_IN_LEGACY_MODE:na(),REQUIRED_VALUE:na(),INVALID_VALUE:na(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:na(),NOT_INSTALLED_WITH_PROVIDE:na(),UNEXPECTED_ERROR:na(),NOT_COMPATIBLE_LEGACY_VUE_I18N:na(),BRIDGE_SUPPORT_VUE_2_ONLY:na(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:na(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:na(),__EXTEND_POINT__:na()};function js(t,...l){return mm(t,null,void 0)}const K0=Ju("__translateVNode"),J0=Ju("__datetimeParts"),Q0=Ju("__numberParts"),iA=Ju("__setPluralRules"),rA=Ju("__injectWithOption"),eb=Ju("__dispose");function i_(t){if(!qr(t)||Lc(t))return t;for(const l in t)if(Rl(t,l))if(!l.includes("."))qr(t[l])&&i_(t[l]);else{const d=l.split("."),_=d.length-1;let T=t,C=!1;for(let P=0;P<_;P++){if(d[P]==="__proto__")throw new Error(`unsafe key: ${d[P]}`);if(d[P]in T||(T[d[P]]=mn()),!qr(T[d[P]])){C=!0;break}T=T[d[P]]}if(C||(Lc(T)?VC.includes(d[_])||delete t[l]:(T[d[_]]=t[l],delete t[l])),!Lc(T)){const P=T[d[_]];qr(P)&&i_(P)}}return t}function zx(t,l){const{messages:d,__i18n:_,messageResolver:T,flatJson:C}=l,P=hr(d)?d:Vn(_)?mn():{[t]:mn()};if(Vn(_)&&_.forEach(V=>{if("locale"in V&&"resource"in V){const{locale:s,resource:$}=V;s?(P[s]=P[s]||mn(),Ny($,P[s])):Ny($,P)}else Si(V)&&Ny(JSON.parse(V),P)}),T==null&&C)for(const V in P)Rl(P,V)&&i_(P[V]);return P}function nA(t){return t.type}function sA(t,l,d){let _=qr(l.messages)?l.messages:mn();"__i18nGlobal"in d&&(_=zx(t.locale.value,{messages:_,__i18n:d.__i18nGlobal}));const T=Object.keys(_);T.length&&T.forEach(C=>{t.mergeLocaleMessage(C,_[C])});{if(qr(l.datetimeFormats)){const C=Object.keys(l.datetimeFormats);C.length&&C.forEach(P=>{t.mergeDateTimeFormat(P,l.datetimeFormats[P])})}if(qr(l.numberFormats)){const C=Object.keys(l.numberFormats);C.length&&C.forEach(P=>{t.mergeNumberFormat(P,l.numberFormats[P])})}}}function LT(t){return fr(Mh,null,t,0)}const DT="__INTLIFY_META__",OT=()=>[],bR=()=>!1;let RT=0;function zT(t){return(l,d,_,T)=>t(d,_,Zs()||void 0,T)}const wR=()=>{const t=Zs();let l=null;return t&&(l=nA(t)[DT])?{[DT]:l}:null};function qb(t={},l){const{__root:d,__injectWithOption:_}=t,T=d===void 0,C=t.flatJson,P=sx?Ui:a_,V=!!t.translateExistCompatible;let s=Sr(t.inheritLocale)?t.inheritLocale:!0;const $=P(d&&s?d.locale.value:Si(t.locale)?t.locale:hm),Z=P(d&&s?d.fallbackLocale.value:Si(t.fallbackLocale)||Vn(t.fallbackLocale)||hr(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:$.value),J=P(zx($.value,t)),ne=P(hr(t.datetimeFormats)?t.datetimeFormats:{[$.value]:{}}),ue=P(hr(t.numberFormats)?t.numberFormats:{[$.value]:{}});let we=d?d.missingWarn:Sr(t.missingWarn)||Zu(t.missingWarn)?t.missingWarn:!0,Me=d?d.fallbackWarn:Sr(t.fallbackWarn)||Zu(t.fallbackWarn)?t.fallbackWarn:!0,Ye=d?d.fallbackRoot:Sr(t.fallbackRoot)?t.fallbackRoot:!0,Ze=!!t.fallbackFormat,Fe=Pn(t.missing)?t.missing:null,ae=Pn(t.missing)?zT(t.missing):null,ge=Pn(t.postTranslation)?t.postTranslation:null,Oe=d?d.warnHtmlMessage:Sr(t.warnHtmlMessage)?t.warnHtmlMessage:!0,ze=!!t.escapeParameter;const rt=d?d.modifiers:hr(t.modifiers)?t.modifiers:{};let Ie=t.pluralRules||d&&d.pluralRules,Je;Je=(()=>{T&&TT(null);const ut={version:yR,locale:$.value,fallbackLocale:Z.value,messages:J.value,modifiers:rt,pluralRules:Ie,missing:ae===null?void 0:ae,missingWarn:we,fallbackWarn:Me,fallbackFormat:Ze,unresolving:!0,postTranslation:ge===null?void 0:ge,warnHtmlMessage:Oe,escapeParameter:ze,messageResolver:t.messageResolver,messageCompiler:t.messageCompiler,__meta:{framework:"vue"}};ut.datetimeFormats=ne.value,ut.numberFormats=ue.value,ut.__datetimeFormatters=hr(Je)?Je.__datetimeFormatters:void 0,ut.__numberFormatters=hr(Je)?Je.__numberFormatters:void 0;const Pt=lR(ut);return T&&TT(Pt),Pt})(),Sg(Je,$.value,Z.value);function ti(){return[$.value,Z.value,J.value,ne.value,ue.value]}const bt=un({get:()=>$.value,set:ut=>{$.value=ut,Je.locale=$.value}}),wt=un({get:()=>Z.value,set:ut=>{Z.value=ut,Je.fallbackLocale=Z.value,Sg(Je,$.value,ut)}}),xt=un(()=>J.value),Tt=un(()=>ne.value),vt=un(()=>ue.value);function ai(){return Pn(ge)?ge:null}function yi(ut){ge=ut,Je.postTranslation=ut}function xi(){return Fe}function Pr(ut){ut!==null&&(ae=zT(ut)),Fe=ut,Je.missing=ae}const tr=(ut,Pt,Mi,Di,$r,Nr)=>{ti();let cn;try{__INTLIFY_PROD_DEVTOOLS__,T||(Je.fallbackContext=d?aR():void 0),cn=ut(Je)}finally{__INTLIFY_PROD_DEVTOOLS__,T||(Je.fallbackContext=void 0)}if(Mi!=="translate exists"&&cs(cn)&&cn===Rx||Mi==="translate exists"&&!cn){const[lr,hs]=Pt();return d&&Ye?Di(d):$r(lr)}else{if(Nr(cn))return cn;throw js(ks.UNEXPECTED_RETURN_TYPE)}};function nr(...ut){return tr(Pt=>Reflect.apply(AT,null,[Pt,...ut]),()=>X0(...ut),"translate",Pt=>Reflect.apply(Pt.t,Pt,[...ut]),Pt=>Pt,Pt=>Si(Pt))}function rn(...ut){const[Pt,Mi,Di]=ut;if(Di&&!qr(Di))throw js(ks.INVALID_ARGUMENT);return nr(Pt,Mi,Xs({resolvedMessage:!0},Di||{}))}function dr(...ut){return tr(Pt=>Reflect.apply(MT,null,[Pt,...ut]),()=>Z0(...ut),"datetime format",Pt=>Reflect.apply(Pt.d,Pt,[...ut]),()=>vT,Pt=>Si(Pt))}function Rn(...ut){return tr(Pt=>Reflect.apply(kT,null,[Pt,...ut]),()=>Y0(...ut),"number format",Pt=>Reflect.apply(Pt.n,Pt,[...ut]),()=>vT,Pt=>Si(Pt))}function nn(ut){return ut.map(Pt=>Si(Pt)||cs(Pt)||Sr(Pt)?LT(String(Pt)):Pt)}const fi={normalize:nn,interpolate:ut=>ut,type:"vnode"};function ri(...ut){return tr(Pt=>{let Mi;const Di=Pt;try{Di.processor=fi,Mi=Reflect.apply(AT,null,[Di,...ut])}finally{Di.processor=null}return Mi},()=>X0(...ut),"translate",Pt=>Pt[K0](...ut),Pt=>[LT(Pt)],Pt=>Vn(Pt))}function Ti(...ut){return tr(Pt=>Reflect.apply(kT,null,[Pt,...ut]),()=>Y0(...ut),"number format",Pt=>Pt[Q0](...ut),OT,Pt=>Si(Pt)||Vn(Pt))}function sr(...ut){return tr(Pt=>Reflect.apply(MT,null,[Pt,...ut]),()=>Z0(...ut),"datetime format",Pt=>Pt[J0](...ut),OT,Pt=>Si(Pt)||Vn(Pt))}function Ei(ut){Ie=ut,Je.pluralRules=Ie}function xe(ut,Pt){return tr(()=>{if(!ut)return!1;const Mi=Si(Pt)?Pt:$.value,Di=Lt(Mi),$r=Je.messageResolver(Di,ut);return V?$r!=null:Lc($r)||rl($r)||Si($r)},()=>[ut],"translate exists",Mi=>Reflect.apply(Mi.te,Mi,[ut,Pt]),bR,Mi=>Sr(Mi))}function ve(ut){let Pt=null;const Mi=$C(Je,Z.value,$.value);for(let Di=0;Di<Mi.length;Di++){const $r=J.value[Mi[Di]]||{},Nr=Je.messageResolver($r,ut);if(Nr!=null){Pt=Nr;break}}return Pt}function nt(ut){const Pt=ve(ut);return Pt??(d?d.tm(ut)||{}:{})}function Lt(ut){return J.value[ut]||{}}function It(ut,Pt){if(C){const Mi={[ut]:Pt};for(const Di in Mi)Rl(Mi,Di)&&i_(Mi[Di]);Pt=Mi[ut]}J.value[ut]=Pt,Je.messages=J.value}function Xt(ut,Pt){J.value[ut]=J.value[ut]||{};const Mi={[ut]:Pt};if(C)for(const Di in Mi)Rl(Mi,Di)&&i_(Mi[Di]);Pt=Mi[ut],Ny(Pt,J.value[ut]),Je.messages=J.value}function ni(ut){return ne.value[ut]||{}}function Te(ut,Pt){ne.value[ut]=Pt,Je.datetimeFormats=ne.value,IT(Je,ut,Pt)}function Ae(ut,Pt){ne.value[ut]=Xs(ne.value[ut]||{},Pt),Je.datetimeFormats=ne.value,IT(Je,ut,Pt)}function Qe(ut){return ue.value[ut]||{}}function $t(ut,Pt){ue.value[ut]=Pt,Je.numberFormats=ue.value,PT(Je,ut,Pt)}function Gt(ut,Pt){ue.value[ut]=Xs(ue.value[ut]||{},Pt),Je.numberFormats=ue.value,PT(Je,ut,Pt)}RT++,d&&sx&&(ca(d.locale,ut=>{s&&($.value=ut,Je.locale=ut,Sg(Je,$.value,Z.value))}),ca(d.fallbackLocale,ut=>{s&&(Z.value=ut,Je.fallbackLocale=ut,Sg(Je,$.value,Z.value))}));const Zt={id:RT,locale:bt,fallbackLocale:wt,get inheritLocale(){return s},set inheritLocale(ut){s=ut,ut&&d&&($.value=d.locale.value,Z.value=d.fallbackLocale.value,Sg(Je,$.value,Z.value))},get availableLocales(){return Object.keys(J.value).sort()},messages:xt,get modifiers(){return rt},get pluralRules(){return Ie||{}},get isGlobal(){return T},get missingWarn(){return we},set missingWarn(ut){we=ut,Je.missingWarn=we},get fallbackWarn(){return Me},set fallbackWarn(ut){Me=ut,Je.fallbackWarn=Me},get fallbackRoot(){return Ye},set fallbackRoot(ut){Ye=ut},get fallbackFormat(){return Ze},set fallbackFormat(ut){Ze=ut,Je.fallbackFormat=Ze},get warnHtmlMessage(){return Oe},set warnHtmlMessage(ut){Oe=ut,Je.warnHtmlMessage=ut},get escapeParameter(){return ze},set escapeParameter(ut){ze=ut,Je.escapeParameter=ut},t:nr,getLocaleMessage:Lt,setLocaleMessage:It,mergeLocaleMessage:Xt,getPostTranslationHandler:ai,setPostTranslationHandler:yi,getMissingHandler:xi,setMissingHandler:Pr,[iA]:Ei};return Zt.datetimeFormats=Tt,Zt.numberFormats=vt,Zt.rt=rn,Zt.te=xe,Zt.tm=nt,Zt.d=dr,Zt.n=Rn,Zt.getDateTimeFormat=ni,Zt.setDateTimeFormat=Te,Zt.mergeDateTimeFormat=Ae,Zt.getNumberFormat=Qe,Zt.setNumberFormat=$t,Zt.mergeNumberFormat=Gt,Zt[rA]=_,Zt[K0]=ri,Zt[J0]=sr,Zt[Q0]=Ti,Zt}function TR(t){const l=Si(t.locale)?t.locale:hm,d=Si(t.fallbackLocale)||Vn(t.fallbackLocale)||hr(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:l,_=Pn(t.missing)?t.missing:void 0,T=Sr(t.silentTranslationWarn)||Zu(t.silentTranslationWarn)?!t.silentTranslationWarn:!0,C=Sr(t.silentFallbackWarn)||Zu(t.silentFallbackWarn)?!t.silentFallbackWarn:!0,P=Sr(t.fallbackRoot)?t.fallbackRoot:!0,V=!!t.formatFallbackMessages,s=hr(t.modifiers)?t.modifiers:{},$=t.pluralizationRules,Z=Pn(t.postTranslation)?t.postTranslation:void 0,J=Si(t.warnHtmlInMessage)?t.warnHtmlInMessage!=="off":!0,ne=!!t.escapeParameterHtml,ue=Sr(t.sync)?t.sync:!0;let we=t.messages;if(hr(t.sharedMessages)){const ze=t.sharedMessages;we=Object.keys(ze).reduce((Ie,Je)=>{const He=Ie[Je]||(Ie[Je]={});return Xs(He,ze[Je]),Ie},we||{})}const{__i18n:Me,__root:Ye,__injectWithOption:Ze}=t,Fe=t.datetimeFormats,ae=t.numberFormats,ge=t.flatJson,Oe=t.translateExistCompatible;return{locale:l,fallbackLocale:d,messages:we,flatJson:ge,datetimeFormats:Fe,numberFormats:ae,missing:_,missingWarn:T,fallbackWarn:C,fallbackRoot:P,fallbackFormat:V,modifiers:s,pluralRules:$,postTranslation:Z,warnHtmlMessage:J,escapeParameter:ne,messageResolver:t.messageResolver,inheritLocale:ue,translateExistCompatible:Oe,__i18n:Me,__root:Ye,__injectWithOption:Ze}}function tb(t={},l){{const d=qb(TR(t)),{__extender:_}=t,T={id:d.id,get locale(){return d.locale.value},set locale(C){d.locale.value=C},get fallbackLocale(){return d.fallbackLocale.value},set fallbackLocale(C){d.fallbackLocale.value=C},get messages(){return d.messages.value},get datetimeFormats(){return d.datetimeFormats.value},get numberFormats(){return d.numberFormats.value},get availableLocales(){return d.availableLocales},get formatter(){return{interpolate(){return[]}}},set formatter(C){},get missing(){return d.getMissingHandler()},set missing(C){d.setMissingHandler(C)},get silentTranslationWarn(){return Sr(d.missingWarn)?!d.missingWarn:d.missingWarn},set silentTranslationWarn(C){d.missingWarn=Sr(C)?!C:C},get silentFallbackWarn(){return Sr(d.fallbackWarn)?!d.fallbackWarn:d.fallbackWarn},set silentFallbackWarn(C){d.fallbackWarn=Sr(C)?!C:C},get modifiers(){return d.modifiers},get formatFallbackMessages(){return d.fallbackFormat},set formatFallbackMessages(C){d.fallbackFormat=C},get postTranslation(){return d.getPostTranslationHandler()},set postTranslation(C){d.setPostTranslationHandler(C)},get sync(){return d.inheritLocale},set sync(C){d.inheritLocale=C},get warnHtmlInMessage(){return d.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(C){d.warnHtmlMessage=C!=="off"},get escapeParameterHtml(){return d.escapeParameter},set escapeParameterHtml(C){d.escapeParameter=C},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(C){},get pluralizationRules(){return d.pluralRules||{}},__composer:d,t(...C){const[P,V,s]=C,$={};let Z=null,J=null;if(!Si(P))throw js(ks.INVALID_ARGUMENT);const ne=P;return Si(V)?$.locale=V:Vn(V)?Z=V:hr(V)&&(J=V),Vn(s)?Z=s:hr(s)&&(J=s),Reflect.apply(d.t,d,[ne,Z||J||{},$])},rt(...C){return Reflect.apply(d.rt,d,[...C])},tc(...C){const[P,V,s]=C,$={plural:1};let Z=null,J=null;if(!Si(P))throw js(ks.INVALID_ARGUMENT);const ne=P;return Si(V)?$.locale=V:cs(V)?$.plural=V:Vn(V)?Z=V:hr(V)&&(J=V),Si(s)?$.locale=s:Vn(s)?Z=s:hr(s)&&(J=s),Reflect.apply(d.t,d,[ne,Z||J||{},$])},te(C,P){return d.te(C,P)},tm(C){return d.tm(C)},getLocaleMessage(C){return d.getLocaleMessage(C)},setLocaleMessage(C,P){d.setLocaleMessage(C,P)},mergeLocaleMessage(C,P){d.mergeLocaleMessage(C,P)},d(...C){return Reflect.apply(d.d,d,[...C])},getDateTimeFormat(C){return d.getDateTimeFormat(C)},setDateTimeFormat(C,P){d.setDateTimeFormat(C,P)},mergeDateTimeFormat(C,P){d.mergeDateTimeFormat(C,P)},n(...C){return Reflect.apply(d.n,d,[...C])},getNumberFormat(C){return d.getNumberFormat(C)},setNumberFormat(C,P){d.setNumberFormat(C,P)},mergeNumberFormat(C,P){d.mergeNumberFormat(C,P)},getChoiceIndex(C,P){return-1}};return T.__extender=_,T}}const Xb={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:t=>t==="parent"||t==="global",default:"parent"},i18n:{type:Object}};function ER({slots:t},l){return l.length===1&&l[0]==="default"?(t.default?t.default():[]).reduce((_,T)=>[..._,...T.type===jr?T.children:[T]],[]):l.reduce((d,_)=>{const T=t[_];return T&&(d[_]=T()),d},mn())}function oA(t){return jr}const SR=On({name:"i18n-t",props:Xs({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:t=>cs(t)||!isNaN(t)}},Xb),setup(t,l){const{slots:d,attrs:_}=l,T=t.i18n||f_({useScope:t.scope,__useComponent:!0});return()=>{const C=Object.keys(d).filter(J=>J!=="_"),P=mn();t.locale&&(P.locale=t.locale),t.plural!==void 0&&(P.plural=Si(t.plural)?+t.plural:t.plural);const V=ER(l,C),s=T[K0](t.keypath,V,P),$=Xs(mn(),_),Z=Si(t.tag)||qr(t.tag)?t.tag:oA();return pm(Z,$,s)}}}),BT=SR;function CR(t){return Vn(t)&&!Si(t[0])}function aA(t,l,d,_){const{slots:T,attrs:C}=l;return()=>{const P={part:!0};let V=mn();t.locale&&(P.locale=t.locale),Si(t.format)?P.key=t.format:qr(t.format)&&(Si(t.format.key)&&(P.key=t.format.key),V=Object.keys(t.format).reduce((ne,ue)=>d.includes(ue)?Xs(mn(),ne,{[ue]:t.format[ue]}):ne,mn()));const s=_(t.value,P,V);let $=[P.key];Vn(s)?$=s.map((ne,ue)=>{const we=T[ne.type],Me=we?we({[ne.type]:ne.value,index:ue,parts:s}):[ne.value];return CR(Me)&&(Me[0].key=`${ne.type}-${ue}`),Me}):Si(s)&&($=[s]);const Z=Xs(mn(),C),J=Si(t.tag)||qr(t.tag)?t.tag:oA();return pm(J,Z,$)}}const AR=On({name:"i18n-n",props:Xs({value:{type:Number,required:!0},format:{type:[String,Object]}},Xb),setup(t,l){const d=t.i18n||f_({useScope:t.scope,__useComponent:!0});return aA(t,l,eA,(..._)=>d[Q0](..._))}}),FT=AR,MR=On({name:"i18n-d",props:Xs({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},Xb),setup(t,l){const d=t.i18n||f_({useScope:t.scope,__useComponent:!0});return aA(t,l,QC,(..._)=>d[J0](..._))}}),NT=MR;function IR(t,l){const d=t;if(t.mode==="composition")return d.__getInstance(l)||t.global;{const _=d.__getInstance(l);return _!=null?_.__composer:t.global.__composer}}function kR(t){const l=P=>{const{instance:V,modifiers:s,value:$}=P;if(!V||!V.$)throw js(ks.UNEXPECTED_ERROR);const Z=IR(t,V.$),J=UT($);return[Reflect.apply(Z.t,Z,[...VT(J)]),Z]};return{created:(P,V)=>{const[s,$]=l(V);sx&&t.global===$&&(P.__i18nWatcher=ca($.locale,()=>{V.instance&&V.instance.$forceUpdate()})),P.__composer=$,P.textContent=s},unmounted:P=>{sx&&P.__i18nWatcher&&(P.__i18nWatcher(),P.__i18nWatcher=void 0,delete P.__i18nWatcher),P.__composer&&(P.__composer=void 0,delete P.__composer)},beforeUpdate:(P,{value:V})=>{if(P.__composer){const s=P.__composer,$=UT(V);P.textContent=Reflect.apply(s.t,s,[...VT($)])}},getSSRProps:P=>{const[V]=l(P);return{textContent:V}}}}function UT(t){if(Si(t))return{path:t};if(hr(t)){if(!("path"in t))throw js(ks.REQUIRED_VALUE,"path");return t}else throw js(ks.INVALID_VALUE)}function VT(t){const{path:l,locale:d,args:_,choice:T,plural:C}=t,P={},V=_||{};return Si(d)&&(P.locale=d),cs(T)&&(P.plural=T),cs(C)&&(P.plural=C),[l,V,P]}function PR(t,l,...d){const _=hr(d[0])?d[0]:{},T=!!_.useI18nComponentName;(Sr(_.globalInstall)?_.globalInstall:!0)&&([T?"i18n":BT.name,"I18nT"].forEach(P=>t.component(P,BT)),[FT.name,"I18nN"].forEach(P=>t.component(P,FT)),[NT.name,"I18nD"].forEach(P=>t.component(P,NT))),t.directive("t",kR(l))}function LR(t,l,d){return{beforeCreate(){const _=Zs();if(!_)throw js(ks.UNEXPECTED_ERROR);const T=this.$options;if(T.i18n){const C=T.i18n;if(T.__i18n&&(C.__i18n=T.__i18n),C.__root=l,this===this.$root)this.$i18n=jT(t,C);else{C.__injectWithOption=!0,C.__extender=d.__vueI18nExtend,this.$i18n=tb(C);const P=this.$i18n;P.__extender&&(P.__disposer=P.__extender(this.$i18n))}}else if(T.__i18n)if(this===this.$root)this.$i18n=jT(t,T);else{this.$i18n=tb({__i18n:T.__i18n,__injectWithOption:!0,__extender:d.__vueI18nExtend,__root:l});const C=this.$i18n;C.__extender&&(C.__disposer=C.__extender(this.$i18n))}else this.$i18n=t;T.__i18nGlobal&&sA(l,T,T),this.$t=(...C)=>this.$i18n.t(...C),this.$rt=(...C)=>this.$i18n.rt(...C),this.$tc=(...C)=>this.$i18n.tc(...C),this.$te=(C,P)=>this.$i18n.te(C,P),this.$d=(...C)=>this.$i18n.d(...C),this.$n=(...C)=>this.$i18n.n(...C),this.$tm=C=>this.$i18n.tm(C),d.__setInstance(_,this.$i18n)},mounted(){},unmounted(){const _=Zs();if(!_)throw js(ks.UNEXPECTED_ERROR);const T=this.$i18n;delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,T.__disposer&&(T.__disposer(),delete T.__disposer,delete T.__extender),d.__deleteInstance(_),delete this.$i18n}}}function jT(t,l){t.locale=l.locale||t.locale,t.fallbackLocale=l.fallbackLocale||t.fallbackLocale,t.missing=l.missing||t.missing,t.silentTranslationWarn=l.silentTranslationWarn||t.silentFallbackWarn,t.silentFallbackWarn=l.silentFallbackWarn||t.silentFallbackWarn,t.formatFallbackMessages=l.formatFallbackMessages||t.formatFallbackMessages,t.postTranslation=l.postTranslation||t.postTranslation,t.warnHtmlInMessage=l.warnHtmlInMessage||t.warnHtmlInMessage,t.escapeParameterHtml=l.escapeParameterHtml||t.escapeParameterHtml,t.sync=l.sync||t.sync,t.__composer[iA](l.pluralizationRules||t.pluralizationRules);const d=zx(t.locale,{messages:l.messages,__i18n:l.__i18n});return Object.keys(d).forEach(_=>t.mergeLocaleMessage(_,d[_])),l.datetimeFormats&&Object.keys(l.datetimeFormats).forEach(_=>t.mergeDateTimeFormat(_,l.datetimeFormats[_])),l.numberFormats&&Object.keys(l.numberFormats).forEach(_=>t.mergeNumberFormat(_,l.numberFormats[_])),t}const DR=Ju("global-vue-i18n");function OR(t={},l){const d=__VUE_I18N_LEGACY_API__&&Sr(t.legacy)?t.legacy:__VUE_I18N_LEGACY_API__,_=Sr(t.globalInjection)?t.globalInjection:!0,T=__VUE_I18N_LEGACY_API__&&d?!!t.allowComposition:!0,C=new Map,[P,V]=RR(t,d),s=Ju("");function $(ne){return C.get(ne)||null}function Z(ne,ue){C.set(ne,ue)}function J(ne){C.delete(ne)}{const ne={get mode(){return __VUE_I18N_LEGACY_API__&&d?"legacy":"composition"},get allowComposition(){return T},async install(ue,...we){if(ue.__VUE_I18N_SYMBOL__=s,ue.provide(ue.__VUE_I18N_SYMBOL__,ne),hr(we[0])){const Ze=we[0];ne.__composerExtend=Ze.__composerExtend,ne.__vueI18nExtend=Ze.__vueI18nExtend}let Me=null;!d&&_&&(Me=GR(ue,ne.global)),__VUE_I18N_FULL_INSTALL__&&PR(ue,ne,...we),__VUE_I18N_LEGACY_API__&&d&&ue.mixin(LR(V,V.__composer,ne));const Ye=ue.unmount;ue.unmount=()=>{Me&&Me(),ne.dispose(),Ye()}},get global(){return V},dispose(){P.stop()},__instances:C,__getInstance:$,__setInstance:Z,__deleteInstance:J};return ne}}function f_(t={}){const l=Zs();if(l==null)throw js(ks.MUST_BE_CALL_SETUP_TOP);if(!l.isCE&&l.appContext.app!=null&&!l.appContext.app.__VUE_I18N_SYMBOL__)throw js(ks.NOT_INSTALLED);const d=zR(l),_=FR(d),T=nA(l),C=BR(t,T);if(__VUE_I18N_LEGACY_API__&&d.mode==="legacy"&&!t.__useComponent){if(!d.allowComposition)throw js(ks.NOT_AVAILABLE_IN_LEGACY_MODE);return jR(l,C,_,t)}if(C==="global")return sA(_,t,T),_;if(C==="parent"){let s=NR(d,l,t.__useComponent);return s==null&&(s=_),s}const P=d;let V=P.__getInstance(l);if(V==null){const s=Xs({},t);"__i18n"in T&&(s.__i18n=T.__i18n),_&&(s.__root=_),V=qb(s),P.__composerExtend&&(V[eb]=P.__composerExtend(V)),VR(P,l,V),P.__setInstance(l,V)}return V}function RR(t,l,d){const _=mx();{const T=__VUE_I18N_LEGACY_API__&&l?_.run(()=>tb(t)):_.run(()=>qb(t));if(T==null)throw js(ks.UNEXPECTED_ERROR);return[_,T]}}function zR(t){{const l=la(t.isCE?DR:t.appContext.app.__VUE_I18N_SYMBOL__);if(!l)throw js(t.isCE?ks.NOT_INSTALLED_WITH_PROVIDE:ks.UNEXPECTED_ERROR);return l}}function BR(t,l){return Dx(t)?"__i18n"in l?"local":"global":t.useScope?t.useScope:"local"}function FR(t){return t.mode==="composition"?t.global:t.global.__composer}function NR(t,l,d=!1){let _=null;const T=l.root;let C=UR(l,d);for(;C!=null;){const P=t;if(t.mode==="composition")_=P.__getInstance(C);else if(__VUE_I18N_LEGACY_API__){const V=P.__getInstance(C);V!=null&&(_=V.__composer,d&&_&&!_[rA]&&(_=null))}if(_!=null||T===C)break;C=C.parent}return _}function UR(t,l=!1){return t==null?null:l&&t.vnode.ctx||t.parent}function VR(t,l,d){Dh(()=>{},l),c_(()=>{const _=d;t.__deleteInstance(l);const T=_[eb];T&&(T(),delete _[eb])},l)}function jR(t,l,d,_={}){const T=l==="local",C=a_(null);if(T&&t.proxy&&!(t.proxy.$options.i18n||t.proxy.$options.__i18n))throw js(ks.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION);const P=Sr(_.inheritLocale)?_.inheritLocale:!Si(_.locale),V=Ui(!T||P?d.locale.value:Si(_.locale)?_.locale:hm),s=Ui(!T||P?d.fallbackLocale.value:Si(_.fallbackLocale)||Vn(_.fallbackLocale)||hr(_.fallbackLocale)||_.fallbackLocale===!1?_.fallbackLocale:V.value),$=Ui(zx(V.value,_)),Z=Ui(hr(_.datetimeFormats)?_.datetimeFormats:{[V.value]:{}}),J=Ui(hr(_.numberFormats)?_.numberFormats:{[V.value]:{}}),ne=T?d.missingWarn:Sr(_.missingWarn)||Zu(_.missingWarn)?_.missingWarn:!0,ue=T?d.fallbackWarn:Sr(_.fallbackWarn)||Zu(_.fallbackWarn)?_.fallbackWarn:!0,we=T?d.fallbackRoot:Sr(_.fallbackRoot)?_.fallbackRoot:!0,Me=!!_.fallbackFormat,Ye=Pn(_.missing)?_.missing:null,Ze=Pn(_.postTranslation)?_.postTranslation:null,Fe=T?d.warnHtmlMessage:Sr(_.warnHtmlMessage)?_.warnHtmlMessage:!0,ae=!!_.escapeParameter,ge=T?d.modifiers:hr(_.modifiers)?_.modifiers:{},Oe=_.pluralRules||T&&d.pluralRules;function ze(){return[V.value,s.value,$.value,Z.value,J.value]}const rt=un({get:()=>C.value?C.value.locale.value:V.value,set:ve=>{C.value&&(C.value.locale.value=ve),V.value=ve}}),Ie=un({get:()=>C.value?C.value.fallbackLocale.value:s.value,set:ve=>{C.value&&(C.value.fallbackLocale.value=ve),s.value=ve}}),Je=un(()=>C.value?C.value.messages.value:$.value),He=un(()=>Z.value),ti=un(()=>J.value);function bt(){return C.value?C.value.getPostTranslationHandler():Ze}function wt(ve){C.value&&C.value.setPostTranslationHandler(ve)}function xt(){return C.value?C.value.getMissingHandler():Ye}function Tt(ve){C.value&&C.value.setMissingHandler(ve)}function vt(ve){return ze(),ve()}function ai(...ve){return C.value?vt(()=>Reflect.apply(C.value.t,null,[...ve])):vt(()=>"")}function yi(...ve){return C.value?Reflect.apply(C.value.rt,null,[...ve]):""}function xi(...ve){return C.value?vt(()=>Reflect.apply(C.value.d,null,[...ve])):vt(()=>"")}function Pr(...ve){return C.value?vt(()=>Reflect.apply(C.value.n,null,[...ve])):vt(()=>"")}function tr(ve){return C.value?C.value.tm(ve):{}}function nr(ve,nt){return C.value?C.value.te(ve,nt):!1}function rn(ve){return C.value?C.value.getLocaleMessage(ve):{}}function dr(ve,nt){C.value&&(C.value.setLocaleMessage(ve,nt),$.value[ve]=nt)}function Rn(ve,nt){C.value&&C.value.mergeLocaleMessage(ve,nt)}function nn(ve){return C.value?C.value.getDateTimeFormat(ve):{}}function zt(ve,nt){C.value&&(C.value.setDateTimeFormat(ve,nt),Z.value[ve]=nt)}function fi(ve,nt){C.value&&C.value.mergeDateTimeFormat(ve,nt)}function ri(ve){return C.value?C.value.getNumberFormat(ve):{}}function Ti(ve,nt){C.value&&(C.value.setNumberFormat(ve,nt),J.value[ve]=nt)}function sr(ve,nt){C.value&&C.value.mergeNumberFormat(ve,nt)}const Ei={get id(){return C.value?C.value.id:-1},locale:rt,fallbackLocale:Ie,messages:Je,datetimeFormats:He,numberFormats:ti,get inheritLocale(){return C.value?C.value.inheritLocale:P},set inheritLocale(ve){C.value&&(C.value.inheritLocale=ve)},get availableLocales(){return C.value?C.value.availableLocales:Object.keys($.value)},get modifiers(){return C.value?C.value.modifiers:ge},get pluralRules(){return C.value?C.value.pluralRules:Oe},get isGlobal(){return C.value?C.value.isGlobal:!1},get missingWarn(){return C.value?C.value.missingWarn:ne},set missingWarn(ve){C.value&&(C.value.missingWarn=ve)},get fallbackWarn(){return C.value?C.value.fallbackWarn:ue},set fallbackWarn(ve){C.value&&(C.value.missingWarn=ve)},get fallbackRoot(){return C.value?C.value.fallbackRoot:we},set fallbackRoot(ve){C.value&&(C.value.fallbackRoot=ve)},get fallbackFormat(){return C.value?C.value.fallbackFormat:Me},set fallbackFormat(ve){C.value&&(C.value.fallbackFormat=ve)},get warnHtmlMessage(){return C.value?C.value.warnHtmlMessage:Fe},set warnHtmlMessage(ve){C.value&&(C.value.warnHtmlMessage=ve)},get escapeParameter(){return C.value?C.value.escapeParameter:ae},set escapeParameter(ve){C.value&&(C.value.escapeParameter=ve)},t:ai,getPostTranslationHandler:bt,setPostTranslationHandler:wt,getMissingHandler:xt,setMissingHandler:Tt,rt:yi,d:xi,n:Pr,tm:tr,te:nr,getLocaleMessage:rn,setLocaleMessage:dr,mergeLocaleMessage:Rn,getDateTimeFormat:nn,setDateTimeFormat:zt,mergeDateTimeFormat:fi,getNumberFormat:ri,setNumberFormat:Ti,mergeNumberFormat:sr};function xe(ve){ve.locale.value=V.value,ve.fallbackLocale.value=s.value,Object.keys($.value).forEach(nt=>{ve.mergeLocaleMessage(nt,$.value[nt])}),Object.keys(Z.value).forEach(nt=>{ve.mergeDateTimeFormat(nt,Z.value[nt])}),Object.keys(J.value).forEach(nt=>{ve.mergeNumberFormat(nt,J.value[nt])}),ve.escapeParameter=ae,ve.fallbackFormat=Me,ve.fallbackRoot=we,ve.fallbackWarn=ue,ve.missingWarn=ne,ve.warnHtmlMessage=Fe}return Ab(()=>{if(t.proxy==null||t.proxy.$i18n==null)throw js(ks.NOT_AVAILABLE_COMPOSITION_IN_LEGACY);const ve=C.value=t.proxy.$i18n.__composer;l==="global"?(V.value=ve.locale.value,s.value=ve.fallbackLocale.value,$.value=ve.messages.value,Z.value=ve.datetimeFormats.value,J.value=ve.numberFormats.value):T&&xe(ve)}),Ei}const $R=["locale","fallbackLocale","availableLocales"],$T=["t","rt","d","n","tm","te"];function GR(t,l){const d=Object.create(null);return $R.forEach(T=>{const C=Object.getOwnPropertyDescriptor(l,T);if(!C)throw js(ks.UNEXPECTED_ERROR);const P=Ln(C.value)?{get(){return C.value.value},set(V){C.value.value=V}}:{get(){return C.get&&C.get()}};Object.defineProperty(d,T,P)}),t.config.globalProperties.$i18n=d,$T.forEach(T=>{const C=Object.getOwnPropertyDescriptor(l,T);if(!C||!C.value)throw js(ks.UNEXPECTED_ERROR);Object.defineProperty(t.config.globalProperties,`$${T}`,C)}),()=>{delete t.config.globalProperties.$i18n,$T.forEach(T=>{delete t.config.globalProperties[`$${T}`]})}}xR();__INTLIFY_JIT_COMPILATION__?wT(fR):wT(dR);rR(BO);nR($C);if(__INTLIFY_PROD_DEVTOOLS__){const t=Ch();t.__INTLIFY__=!0,HO(t.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}/*!
 * pinia v3.0.2
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let lA;const Bx=t=>lA=t,cA=Symbol();function ib(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Ng;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Ng||(Ng={}));function WR(){const t=mx(!0),l=t.run(()=>Ui({}));let d=[],_=[];const T=bx({install(C){Bx(T),T._a=C,C.provide(cA,T),C.config.globalProperties.$pinia=T,_.forEach(P=>d.push(P)),_=[]},use(C){return this._a?d.push(C):_.push(C),this},_p:d,_a:null,_e:t,_s:new Map,state:l});return T}const hA=()=>{};function GT(t,l,d,_=hA){t.push(l);const T=()=>{const C=t.indexOf(l);C>-1&&(t.splice(C,1),_())};return!d&&gb()&&_E(T),T}function Gp(t,...l){t.slice().forEach(d=>{d(...l)})}const HR=t=>t(),WT=Symbol(),y0=Symbol();function rb(t,l){t instanceof Map&&l instanceof Map?l.forEach((d,_)=>t.set(_,d)):t instanceof Set&&l instanceof Set&&l.forEach(t.add,t);for(const d in l){if(!l.hasOwnProperty(d))continue;const _=l[d],T=t[d];ib(T)&&ib(_)&&t.hasOwnProperty(d)&&!Ln(_)&&!Nl(_)?t[d]=rb(T,_):t[d]=_}return t}const qR=Symbol();function XR(t){return!ib(t)||!Object.prototype.hasOwnProperty.call(t,qR)}const{assign:Nu}=Object;function ZR(t){return!!(Ln(t)&&t.effect)}function YR(t,l,d,_){const{state:T,actions:C,getters:P}=l,V=d.state.value[t];let s;function $(){V||(d.state.value[t]=T?T():{});const Z=RE(d.state.value[t]);return Nu(Z,C,Object.keys(P||{}).reduce((J,ne)=>(J[ne]=bx(un(()=>{Bx(d);const ue=d._s.get(t);return P[ne].call(ue,ue)})),J),{}))}return s=uA(t,$,l,d,_,!0),s}function uA(t,l,d={},_,T,C){let P;const V=Nu({actions:{}},d),s={deep:!0};let $,Z,J=[],ne=[],ue;const we=_.state.value[t];!C&&!we&&(_.state.value[t]={}),Ui({});let Me;function Ye(Ie){let Je;$=Z=!1,typeof Ie=="function"?(Ie(_.state.value[t]),Je={type:Ng.patchFunction,storeId:t,events:ue}):(rb(_.state.value[t],Ie),Je={type:Ng.patchObject,payload:Ie,storeId:t,events:ue});const He=Me=Symbol();zf().then(()=>{Me===He&&($=!0)}),Z=!0,Gp(J,Je,_.state.value[t])}const Ze=C?function(){const{state:Je}=d,He=Je?Je():{};this.$patch(ti=>{Nu(ti,He)})}:hA;function Fe(){P.stop(),J=[],ne=[],_._s.delete(t)}const ae=(Ie,Je="")=>{if(WT in Ie)return Ie[y0]=Je,Ie;const He=function(){Bx(_);const ti=Array.from(arguments),bt=[],wt=[];function xt(ai){bt.push(ai)}function Tt(ai){wt.push(ai)}Gp(ne,{args:ti,name:He[y0],store:Oe,after:xt,onError:Tt});let vt;try{vt=Ie.apply(this&&this.$id===t?this:Oe,ti)}catch(ai){throw Gp(wt,ai),ai}return vt instanceof Promise?vt.then(ai=>(Gp(bt,ai),ai)).catch(ai=>(Gp(wt,ai),Promise.reject(ai))):(Gp(bt,vt),vt)};return He[WT]=!0,He[y0]=Je,He},ge={_p:_,$id:t,$onAction:GT.bind(null,ne),$patch:Ye,$reset:Ze,$subscribe(Ie,Je={}){const He=GT(J,Ie,Je.detached,()=>ti()),ti=P.run(()=>ca(()=>_.state.value[t],bt=>{(Je.flush==="sync"?Z:$)&&Ie({storeId:t,type:Ng.direct,events:ue},bt)},Nu({},s,Je)));return He},$dispose:Fe},Oe=dm(ge);_._s.set(t,Oe);const rt=(_._a&&_._a.runWithContext||HR)(()=>_._e.run(()=>(P=mx()).run(()=>l({action:ae}))));for(const Ie in rt){const Je=rt[Ie];if(Ln(Je)&&!ZR(Je)||Nl(Je))C||(we&&XR(Je)&&(Ln(Je)?Je.value=we[Ie]:rb(Je,we[Ie])),_.state.value[t][Ie]=Je);else if(typeof Je=="function"){const He=ae(Je,Ie);rt[Ie]=He,V.actions[Ie]=Je}}return Nu(Oe,rt),Nu(Ir(Oe),rt),Object.defineProperty(Oe,"$state",{get:()=>_.state.value[t],set:Ie=>{Ye(Je=>{Nu(Je,Ie)})}}),_._p.forEach(Ie=>{Nu(Oe,P.run(()=>Ie({store:Oe,app:_._a,pinia:_,options:V})))}),we&&C&&d.hydrate&&d.hydrate(Oe.$state,we),$=!0,Z=!0,Oe}/*! #__NO_SIDE_EFFECTS__ */function dA(t,l,d){let _;const T=typeof l=="function";_=T?d:l;function C(P,V){const s=uS();return P=P||(s?la(cA,null):null),P&&Bx(P),P=lA,P._s.has(t)||(T?uA(t,l,_,P):YR(t,_,P)),P._s.get(t)}return C.$id=t,C}function KR(t){const l=Ir(t),d={};for(const _ in l){const T=l[_];T.effect?d[_]=un({get:()=>t[_],set(C){t[_]=C}}):(Ln(T)||Nl(T))&&(d[_]=zE(t,_))}return d}function fA(t,l){return function(){return t.apply(l,arguments)}}const{toString:JR}=Object.prototype,{getPrototypeOf:Zb}=Object,Fx=(t=>l=>{const d=JR.call(l);return t[d]||(t[d]=d.slice(8,-1).toLowerCase())})(Object.create(null)),jl=t=>(t=t.toLowerCase(),l=>Fx(l)===t),Nx=t=>l=>typeof l===t,{isArray:gm}=Array,r_=Nx("undefined");function QR(t){return t!==null&&!r_(t)&&t.constructor!==null&&!r_(t.constructor)&&Fa(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const pA=jl("ArrayBuffer");function ez(t){let l;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?l=ArrayBuffer.isView(t):l=t&&t.buffer&&pA(t.buffer),l}const tz=Nx("string"),Fa=Nx("function"),mA=Nx("number"),Ux=t=>t!==null&&typeof t=="object",iz=t=>t===!0||t===!1,Uy=t=>{if(Fx(t)!=="object")return!1;const l=Zb(t);return(l===null||l===Object.prototype||Object.getPrototypeOf(l)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},rz=jl("Date"),nz=jl("File"),sz=jl("Blob"),oz=jl("FileList"),az=t=>Ux(t)&&Fa(t.pipe),lz=t=>{let l;return t&&(typeof FormData=="function"&&t instanceof FormData||Fa(t.append)&&((l=Fx(t))==="formdata"||l==="object"&&Fa(t.toString)&&t.toString()==="[object FormData]"))},cz=jl("URLSearchParams"),[hz,uz,dz,fz]=["ReadableStream","Request","Response","Headers"].map(jl),pz=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function p_(t,l,{allOwnKeys:d=!1}={}){if(t===null||typeof t>"u")return;let _,T;if(typeof t!="object"&&(t=[t]),gm(t))for(_=0,T=t.length;_<T;_++)l.call(null,t[_],_,t);else{const C=d?Object.getOwnPropertyNames(t):Object.keys(t),P=C.length;let V;for(_=0;_<P;_++)V=C[_],l.call(null,t[V],V,t)}}function gA(t,l){l=l.toLowerCase();const d=Object.keys(t);let _=d.length,T;for(;_-- >0;)if(T=d[_],l===T.toLowerCase())return T;return null}const Sf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_A=t=>!r_(t)&&t!==Sf;function nb(){const{caseless:t}=_A(this)&&this||{},l={},d=(_,T)=>{const C=t&&gA(l,T)||T;Uy(l[C])&&Uy(_)?l[C]=nb(l[C],_):Uy(_)?l[C]=nb({},_):gm(_)?l[C]=_.slice():l[C]=_};for(let _=0,T=arguments.length;_<T;_++)arguments[_]&&p_(arguments[_],d);return l}const mz=(t,l,d,{allOwnKeys:_}={})=>(p_(l,(T,C)=>{d&&Fa(T)?t[C]=fA(T,d):t[C]=T},{allOwnKeys:_}),t),gz=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),_z=(t,l,d,_)=>{t.prototype=Object.create(l.prototype,_),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:l.prototype}),d&&Object.assign(t.prototype,d)},yz=(t,l,d,_)=>{let T,C,P;const V={};if(l=l||{},t==null)return l;do{for(T=Object.getOwnPropertyNames(t),C=T.length;C-- >0;)P=T[C],(!_||_(P,t,l))&&!V[P]&&(l[P]=t[P],V[P]=!0);t=d!==!1&&Zb(t)}while(t&&(!d||d(t,l))&&t!==Object.prototype);return l},xz=(t,l,d)=>{t=String(t),(d===void 0||d>t.length)&&(d=t.length),d-=l.length;const _=t.indexOf(l,d);return _!==-1&&_===d},vz=t=>{if(!t)return null;if(gm(t))return t;let l=t.length;if(!mA(l))return null;const d=new Array(l);for(;l-- >0;)d[l]=t[l];return d},bz=(t=>l=>t&&l instanceof t)(typeof Uint8Array<"u"&&Zb(Uint8Array)),wz=(t,l)=>{const _=(t&&t[Symbol.iterator]).call(t);let T;for(;(T=_.next())&&!T.done;){const C=T.value;l.call(t,C[0],C[1])}},Tz=(t,l)=>{let d;const _=[];for(;(d=t.exec(l))!==null;)_.push(d);return _},Ez=jl("HTMLFormElement"),Sz=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(d,_,T){return _.toUpperCase()+T}),HT=(({hasOwnProperty:t})=>(l,d)=>t.call(l,d))(Object.prototype),Cz=jl("RegExp"),yA=(t,l)=>{const d=Object.getOwnPropertyDescriptors(t),_={};p_(d,(T,C)=>{let P;(P=l(T,C,t))!==!1&&(_[C]=P||T)}),Object.defineProperties(t,_)},Az=t=>{yA(t,(l,d)=>{if(Fa(t)&&["arguments","caller","callee"].indexOf(d)!==-1)return!1;const _=t[d];if(Fa(_)){if(l.enumerable=!1,"writable"in l){l.writable=!1;return}l.set||(l.set=()=>{throw Error("Can not rewrite read-only method '"+d+"'")})}})},Mz=(t,l)=>{const d={},_=T=>{T.forEach(C=>{d[C]=!0})};return gm(t)?_(t):_(String(t).split(l)),d},Iz=()=>{},kz=(t,l)=>t!=null&&Number.isFinite(t=+t)?t:l;function Pz(t){return!!(t&&Fa(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const Lz=t=>{const l=new Array(10),d=(_,T)=>{if(Ux(_)){if(l.indexOf(_)>=0)return;if(!("toJSON"in _)){l[T]=_;const C=gm(_)?[]:{};return p_(_,(P,V)=>{const s=d(P,T+1);!r_(s)&&(C[V]=s)}),l[T]=void 0,C}}return _};return d(t,0)},Dz=jl("AsyncFunction"),Oz=t=>t&&(Ux(t)||Fa(t))&&Fa(t.then)&&Fa(t.catch),xA=((t,l)=>t?setImmediate:l?((d,_)=>(Sf.addEventListener("message",({source:T,data:C})=>{T===Sf&&C===d&&_.length&&_.shift()()},!1),T=>{_.push(T),Sf.postMessage(d,"*")}))(`axios@${Math.random()}`,[]):d=>setTimeout(d))(typeof setImmediate=="function",Fa(Sf.postMessage)),Rz=typeof queueMicrotask<"u"?queueMicrotask.bind(Sf):typeof process<"u"&&process.nextTick||xA,Dt={isArray:gm,isArrayBuffer:pA,isBuffer:QR,isFormData:lz,isArrayBufferView:ez,isString:tz,isNumber:mA,isBoolean:iz,isObject:Ux,isPlainObject:Uy,isReadableStream:hz,isRequest:uz,isResponse:dz,isHeaders:fz,isUndefined:r_,isDate:rz,isFile:nz,isBlob:sz,isRegExp:Cz,isFunction:Fa,isStream:az,isURLSearchParams:cz,isTypedArray:bz,isFileList:oz,forEach:p_,merge:nb,extend:mz,trim:pz,stripBOM:gz,inherits:_z,toFlatObject:yz,kindOf:Fx,kindOfTest:jl,endsWith:xz,toArray:vz,forEachEntry:wz,matchAll:Tz,isHTMLForm:Ez,hasOwnProperty:HT,hasOwnProp:HT,reduceDescriptors:yA,freezeMethods:Az,toObjectSet:Mz,toCamelCase:Sz,noop:Iz,toFiniteNumber:kz,findKey:gA,global:Sf,isContextDefined:_A,isSpecCompliantForm:Pz,toJSONObject:Lz,isAsyncFn:Dz,isThenable:Oz,setImmediate:xA,asap:Rz};function yr(t,l,d,_,T){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",l&&(this.code=l),d&&(this.config=d),_&&(this.request=_),T&&(this.response=T,this.status=T.status?T.status:null)}Dt.inherits(yr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Dt.toJSONObject(this.config),code:this.code,status:this.status}}});const vA=yr.prototype,bA={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{bA[t]={value:t}});Object.defineProperties(yr,bA);Object.defineProperty(vA,"isAxiosError",{value:!0});yr.from=(t,l,d,_,T,C)=>{const P=Object.create(vA);return Dt.toFlatObject(t,P,function(s){return s!==Error.prototype},V=>V!=="isAxiosError"),yr.call(P,t.message,l,d,_,T),P.cause=t,P.name=t.name,C&&Object.assign(P,C),P};const zz=null;function sb(t){return Dt.isPlainObject(t)||Dt.isArray(t)}function wA(t){return Dt.endsWith(t,"[]")?t.slice(0,-2):t}function qT(t,l,d){return t?t.concat(l).map(function(T,C){return T=wA(T),!d&&C?"["+T+"]":T}).join(d?".":""):l}function Bz(t){return Dt.isArray(t)&&!t.some(sb)}const Fz=Dt.toFlatObject(Dt,{},null,function(l){return/^is[A-Z]/.test(l)});function Vx(t,l,d){if(!Dt.isObject(t))throw new TypeError("target must be an object");l=l||new FormData,d=Dt.toFlatObject(d,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Me,Ye){return!Dt.isUndefined(Ye[Me])});const _=d.metaTokens,T=d.visitor||Z,C=d.dots,P=d.indexes,s=(d.Blob||typeof Blob<"u"&&Blob)&&Dt.isSpecCompliantForm(l);if(!Dt.isFunction(T))throw new TypeError("visitor must be a function");function $(we){if(we===null)return"";if(Dt.isDate(we))return we.toISOString();if(!s&&Dt.isBlob(we))throw new yr("Blob is not supported. Use a Buffer instead.");return Dt.isArrayBuffer(we)||Dt.isTypedArray(we)?s&&typeof Blob=="function"?new Blob([we]):Buffer.from(we):we}function Z(we,Me,Ye){let Ze=we;if(we&&!Ye&&typeof we=="object"){if(Dt.endsWith(Me,"{}"))Me=_?Me:Me.slice(0,-2),we=JSON.stringify(we);else if(Dt.isArray(we)&&Bz(we)||(Dt.isFileList(we)||Dt.endsWith(Me,"[]"))&&(Ze=Dt.toArray(we)))return Me=wA(Me),Ze.forEach(function(ae,ge){!(Dt.isUndefined(ae)||ae===null)&&l.append(P===!0?qT([Me],ge,C):P===null?Me:Me+"[]",$(ae))}),!1}return sb(we)?!0:(l.append(qT(Ye,Me,C),$(we)),!1)}const J=[],ne=Object.assign(Fz,{defaultVisitor:Z,convertValue:$,isVisitable:sb});function ue(we,Me){if(!Dt.isUndefined(we)){if(J.indexOf(we)!==-1)throw Error("Circular reference detected in "+Me.join("."));J.push(we),Dt.forEach(we,function(Ze,Fe){(!(Dt.isUndefined(Ze)||Ze===null)&&T.call(l,Ze,Dt.isString(Fe)?Fe.trim():Fe,Me,ne))===!0&&ue(Ze,Me?Me.concat(Fe):[Fe])}),J.pop()}}if(!Dt.isObject(t))throw new TypeError("data must be an object");return ue(t),l}function XT(t){const l={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(_){return l[_]})}function Yb(t,l){this._pairs=[],t&&Vx(t,this,l)}const TA=Yb.prototype;TA.append=function(l,d){this._pairs.push([l,d])};TA.toString=function(l){const d=l?function(_){return l.call(this,_,XT)}:XT;return this._pairs.map(function(T){return d(T[0])+"="+d(T[1])},"").join("&")};function Nz(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function EA(t,l,d){if(!l)return t;const _=d&&d.encode||Nz;Dt.isFunction(d)&&(d={serialize:d});const T=d&&d.serialize;let C;if(T?C=T(l,d):C=Dt.isURLSearchParams(l)?l.toString():new Yb(l,d).toString(_),C){const P=t.indexOf("#");P!==-1&&(t=t.slice(0,P)),t+=(t.indexOf("?")===-1?"?":"&")+C}return t}class ZT{constructor(){this.handlers=[]}use(l,d,_){return this.handlers.push({fulfilled:l,rejected:d,synchronous:_?_.synchronous:!1,runWhen:_?_.runWhen:null}),this.handlers.length-1}eject(l){this.handlers[l]&&(this.handlers[l]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(l){Dt.forEach(this.handlers,function(_){_!==null&&l(_)})}}const SA={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Uz=typeof URLSearchParams<"u"?URLSearchParams:Yb,Vz=typeof FormData<"u"?FormData:null,jz=typeof Blob<"u"?Blob:null,$z={isBrowser:!0,classes:{URLSearchParams:Uz,FormData:Vz,Blob:jz},protocols:["http","https","file","blob","url","data"]},Kb=typeof window<"u"&&typeof document<"u",ob=typeof navigator=="object"&&navigator||void 0,Gz=Kb&&(!ob||["ReactNative","NativeScript","NS"].indexOf(ob.product)<0),Wz=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Hz=Kb&&window.location.href||"http://localhost",qz=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Kb,hasStandardBrowserEnv:Gz,hasStandardBrowserWebWorkerEnv:Wz,navigator:ob,origin:Hz},Symbol.toStringTag,{value:"Module"})),mo={...qz,...$z};function Xz(t,l){return Vx(t,new mo.classes.URLSearchParams,Object.assign({visitor:function(d,_,T,C){return mo.isNode&&Dt.isBuffer(d)?(this.append(_,d.toString("base64")),!1):C.defaultVisitor.apply(this,arguments)}},l))}function Zz(t){return Dt.matchAll(/\w+|\[(\w*)]/g,t).map(l=>l[0]==="[]"?"":l[1]||l[0])}function Yz(t){const l={},d=Object.keys(t);let _;const T=d.length;let C;for(_=0;_<T;_++)C=d[_],l[C]=t[C];return l}function CA(t){function l(d,_,T,C){let P=d[C++];if(P==="__proto__")return!0;const V=Number.isFinite(+P),s=C>=d.length;return P=!P&&Dt.isArray(T)?T.length:P,s?(Dt.hasOwnProp(T,P)?T[P]=[T[P],_]:T[P]=_,!V):((!T[P]||!Dt.isObject(T[P]))&&(T[P]=[]),l(d,_,T[P],C)&&Dt.isArray(T[P])&&(T[P]=Yz(T[P])),!V)}if(Dt.isFormData(t)&&Dt.isFunction(t.entries)){const d={};return Dt.forEachEntry(t,(_,T)=>{l(Zz(_),T,d,0)}),d}return null}function Kz(t,l,d){if(Dt.isString(t))try{return(l||JSON.parse)(t),Dt.trim(t)}catch(_){if(_.name!=="SyntaxError")throw _}return(d||JSON.stringify)(t)}const m_={transitional:SA,adapter:["xhr","http","fetch"],transformRequest:[function(l,d){const _=d.getContentType()||"",T=_.indexOf("application/json")>-1,C=Dt.isObject(l);if(C&&Dt.isHTMLForm(l)&&(l=new FormData(l)),Dt.isFormData(l))return T?JSON.stringify(CA(l)):l;if(Dt.isArrayBuffer(l)||Dt.isBuffer(l)||Dt.isStream(l)||Dt.isFile(l)||Dt.isBlob(l)||Dt.isReadableStream(l))return l;if(Dt.isArrayBufferView(l))return l.buffer;if(Dt.isURLSearchParams(l))return d.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),l.toString();let V;if(C){if(_.indexOf("application/x-www-form-urlencoded")>-1)return Xz(l,this.formSerializer).toString();if((V=Dt.isFileList(l))||_.indexOf("multipart/form-data")>-1){const s=this.env&&this.env.FormData;return Vx(V?{"files[]":l}:l,s&&new s,this.formSerializer)}}return C||T?(d.setContentType("application/json",!1),Kz(l)):l}],transformResponse:[function(l){const d=this.transitional||m_.transitional,_=d&&d.forcedJSONParsing,T=this.responseType==="json";if(Dt.isResponse(l)||Dt.isReadableStream(l))return l;if(l&&Dt.isString(l)&&(_&&!this.responseType||T)){const P=!(d&&d.silentJSONParsing)&&T;try{return JSON.parse(l)}catch(V){if(P)throw V.name==="SyntaxError"?yr.from(V,yr.ERR_BAD_RESPONSE,this,null,this.response):V}}return l}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mo.classes.FormData,Blob:mo.classes.Blob},validateStatus:function(l){return l>=200&&l<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Dt.forEach(["delete","get","head","post","put","patch"],t=>{m_.headers[t]={}});const Jz=Dt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Qz=t=>{const l={};let d,_,T;return t&&t.split(`
`).forEach(function(P){T=P.indexOf(":"),d=P.substring(0,T).trim().toLowerCase(),_=P.substring(T+1).trim(),!(!d||l[d]&&Jz[d])&&(d==="set-cookie"?l[d]?l[d].push(_):l[d]=[_]:l[d]=l[d]?l[d]+", "+_:_)}),l},YT=Symbol("internals");function Cg(t){return t&&String(t).trim().toLowerCase()}function Vy(t){return t===!1||t==null?t:Dt.isArray(t)?t.map(Vy):String(t)}function e3(t){const l=Object.create(null),d=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _;for(;_=d.exec(t);)l[_[1]]=_[2];return l}const t3=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function x0(t,l,d,_,T){if(Dt.isFunction(_))return _.call(this,l,d);if(T&&(l=d),!!Dt.isString(l)){if(Dt.isString(_))return l.indexOf(_)!==-1;if(Dt.isRegExp(_))return _.test(l)}}function i3(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(l,d,_)=>d.toUpperCase()+_)}function r3(t,l){const d=Dt.toCamelCase(" "+l);["get","set","has"].forEach(_=>{Object.defineProperty(t,_+d,{value:function(T,C,P){return this[_].call(this,l,T,C,P)},configurable:!0})})}let ha=class{constructor(l){l&&this.set(l)}set(l,d,_){const T=this;function C(V,s,$){const Z=Cg(s);if(!Z)throw new Error("header name must be a non-empty string");const J=Dt.findKey(T,Z);(!J||T[J]===void 0||$===!0||$===void 0&&T[J]!==!1)&&(T[J||s]=Vy(V))}const P=(V,s)=>Dt.forEach(V,($,Z)=>C($,Z,s));if(Dt.isPlainObject(l)||l instanceof this.constructor)P(l,d);else if(Dt.isString(l)&&(l=l.trim())&&!t3(l))P(Qz(l),d);else if(Dt.isHeaders(l))for(const[V,s]of l.entries())C(s,V,_);else l!=null&&C(d,l,_);return this}get(l,d){if(l=Cg(l),l){const _=Dt.findKey(this,l);if(_){const T=this[_];if(!d)return T;if(d===!0)return e3(T);if(Dt.isFunction(d))return d.call(this,T,_);if(Dt.isRegExp(d))return d.exec(T);throw new TypeError("parser must be boolean|regexp|function")}}}has(l,d){if(l=Cg(l),l){const _=Dt.findKey(this,l);return!!(_&&this[_]!==void 0&&(!d||x0(this,this[_],_,d)))}return!1}delete(l,d){const _=this;let T=!1;function C(P){if(P=Cg(P),P){const V=Dt.findKey(_,P);V&&(!d||x0(_,_[V],V,d))&&(delete _[V],T=!0)}}return Dt.isArray(l)?l.forEach(C):C(l),T}clear(l){const d=Object.keys(this);let _=d.length,T=!1;for(;_--;){const C=d[_];(!l||x0(this,this[C],C,l,!0))&&(delete this[C],T=!0)}return T}normalize(l){const d=this,_={};return Dt.forEach(this,(T,C)=>{const P=Dt.findKey(_,C);if(P){d[P]=Vy(T),delete d[C];return}const V=l?i3(C):String(C).trim();V!==C&&delete d[C],d[V]=Vy(T),_[V]=!0}),this}concat(...l){return this.constructor.concat(this,...l)}toJSON(l){const d=Object.create(null);return Dt.forEach(this,(_,T)=>{_!=null&&_!==!1&&(d[T]=l&&Dt.isArray(_)?_.join(", "):_)}),d}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([l,d])=>l+": "+d).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(l){return l instanceof this?l:new this(l)}static concat(l,...d){const _=new this(l);return d.forEach(T=>_.set(T)),_}static accessor(l){const _=(this[YT]=this[YT]={accessors:{}}).accessors,T=this.prototype;function C(P){const V=Cg(P);_[V]||(r3(T,P),_[V]=!0)}return Dt.isArray(l)?l.forEach(C):C(l),this}};ha.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Dt.reduceDescriptors(ha.prototype,({value:t},l)=>{let d=l[0].toUpperCase()+l.slice(1);return{get:()=>t,set(_){this[d]=_}}});Dt.freezeMethods(ha);function v0(t,l){const d=this||m_,_=l||d,T=ha.from(_.headers);let C=_.data;return Dt.forEach(t,function(V){C=V.call(d,C,T.normalize(),l?l.status:void 0)}),T.normalize(),C}function AA(t){return!!(t&&t.__CANCEL__)}function _m(t,l,d){yr.call(this,t??"canceled",yr.ERR_CANCELED,l,d),this.name="CanceledError"}Dt.inherits(_m,yr,{__CANCEL__:!0});function MA(t,l,d){const _=d.config.validateStatus;!d.status||!_||_(d.status)?t(d):l(new yr("Request failed with status code "+d.status,[yr.ERR_BAD_REQUEST,yr.ERR_BAD_RESPONSE][Math.floor(d.status/100)-4],d.config,d.request,d))}function n3(t){const l=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return l&&l[1]||""}function s3(t,l){t=t||10;const d=new Array(t),_=new Array(t);let T=0,C=0,P;return l=l!==void 0?l:1e3,function(s){const $=Date.now(),Z=_[C];P||(P=$),d[T]=s,_[T]=$;let J=C,ne=0;for(;J!==T;)ne+=d[J++],J=J%t;if(T=(T+1)%t,T===C&&(C=(C+1)%t),$-P<l)return;const ue=Z&&$-Z;return ue?Math.round(ne*1e3/ue):void 0}}function o3(t,l){let d=0,_=1e3/l,T,C;const P=($,Z=Date.now())=>{d=Z,T=null,C&&(clearTimeout(C),C=null),t.apply(null,$)};return[(...$)=>{const Z=Date.now(),J=Z-d;J>=_?P($,Z):(T=$,C||(C=setTimeout(()=>{C=null,P(T)},_-J)))},()=>T&&P(T)]}const ax=(t,l,d=3)=>{let _=0;const T=s3(50,250);return o3(C=>{const P=C.loaded,V=C.lengthComputable?C.total:void 0,s=P-_,$=T(s),Z=P<=V;_=P;const J={loaded:P,total:V,progress:V?P/V:void 0,bytes:s,rate:$||void 0,estimated:$&&V&&Z?(V-P)/$:void 0,event:C,lengthComputable:V!=null,[l?"download":"upload"]:!0};t(J)},d)},KT=(t,l)=>{const d=t!=null;return[_=>l[0]({lengthComputable:d,total:t,loaded:_}),l[1]]},JT=t=>(...l)=>Dt.asap(()=>t(...l)),a3=mo.hasStandardBrowserEnv?((t,l)=>d=>(d=new URL(d,mo.origin),t.protocol===d.protocol&&t.host===d.host&&(l||t.port===d.port)))(new URL(mo.origin),mo.navigator&&/(msie|trident)/i.test(mo.navigator.userAgent)):()=>!0,l3=mo.hasStandardBrowserEnv?{write(t,l,d,_,T,C){const P=[t+"="+encodeURIComponent(l)];Dt.isNumber(d)&&P.push("expires="+new Date(d).toGMTString()),Dt.isString(_)&&P.push("path="+_),Dt.isString(T)&&P.push("domain="+T),C===!0&&P.push("secure"),document.cookie=P.join("; ")},read(t){const l=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return l?decodeURIComponent(l[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function c3(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function h3(t,l){return l?t.replace(/\/?\/$/,"")+"/"+l.replace(/^\/+/,""):t}function IA(t,l,d){let _=!c3(l);return t&&(_||d==!1)?h3(t,l):l}const QT=t=>t instanceof ha?{...t}:t;function Df(t,l){l=l||{};const d={};function _($,Z,J,ne){return Dt.isPlainObject($)&&Dt.isPlainObject(Z)?Dt.merge.call({caseless:ne},$,Z):Dt.isPlainObject(Z)?Dt.merge({},Z):Dt.isArray(Z)?Z.slice():Z}function T($,Z,J,ne){if(Dt.isUndefined(Z)){if(!Dt.isUndefined($))return _(void 0,$,J,ne)}else return _($,Z,J,ne)}function C($,Z){if(!Dt.isUndefined(Z))return _(void 0,Z)}function P($,Z){if(Dt.isUndefined(Z)){if(!Dt.isUndefined($))return _(void 0,$)}else return _(void 0,Z)}function V($,Z,J){if(J in l)return _($,Z);if(J in t)return _(void 0,$)}const s={url:C,method:C,data:C,baseURL:P,transformRequest:P,transformResponse:P,paramsSerializer:P,timeout:P,timeoutMessage:P,withCredentials:P,withXSRFToken:P,adapter:P,responseType:P,xsrfCookieName:P,xsrfHeaderName:P,onUploadProgress:P,onDownloadProgress:P,decompress:P,maxContentLength:P,maxBodyLength:P,beforeRedirect:P,transport:P,httpAgent:P,httpsAgent:P,cancelToken:P,socketPath:P,responseEncoding:P,validateStatus:V,headers:($,Z,J)=>T(QT($),QT(Z),J,!0)};return Dt.forEach(Object.keys(Object.assign({},t,l)),function(Z){const J=s[Z]||T,ne=J(t[Z],l[Z],Z);Dt.isUndefined(ne)&&J!==V||(d[Z]=ne)}),d}const kA=t=>{const l=Df({},t);let{data:d,withXSRFToken:_,xsrfHeaderName:T,xsrfCookieName:C,headers:P,auth:V}=l;l.headers=P=ha.from(P),l.url=EA(IA(l.baseURL,l.url,l.allowAbsoluteUrls),t.params,t.paramsSerializer),V&&P.set("Authorization","Basic "+btoa((V.username||"")+":"+(V.password?unescape(encodeURIComponent(V.password)):"")));let s;if(Dt.isFormData(d)){if(mo.hasStandardBrowserEnv||mo.hasStandardBrowserWebWorkerEnv)P.setContentType(void 0);else if((s=P.getContentType())!==!1){const[$,...Z]=s?s.split(";").map(J=>J.trim()).filter(Boolean):[];P.setContentType([$||"multipart/form-data",...Z].join("; "))}}if(mo.hasStandardBrowserEnv&&(_&&Dt.isFunction(_)&&(_=_(l)),_||_!==!1&&a3(l.url))){const $=T&&C&&l3.read(C);$&&P.set(T,$)}return l},u3=typeof XMLHttpRequest<"u",d3=u3&&function(t){return new Promise(function(d,_){const T=kA(t);let C=T.data;const P=ha.from(T.headers).normalize();let{responseType:V,onUploadProgress:s,onDownloadProgress:$}=T,Z,J,ne,ue,we;function Me(){ue&&ue(),we&&we(),T.cancelToken&&T.cancelToken.unsubscribe(Z),T.signal&&T.signal.removeEventListener("abort",Z)}let Ye=new XMLHttpRequest;Ye.open(T.method.toUpperCase(),T.url,!0),Ye.timeout=T.timeout;function Ze(){if(!Ye)return;const ae=ha.from("getAllResponseHeaders"in Ye&&Ye.getAllResponseHeaders()),Oe={data:!V||V==="text"||V==="json"?Ye.responseText:Ye.response,status:Ye.status,statusText:Ye.statusText,headers:ae,config:t,request:Ye};MA(function(rt){d(rt),Me()},function(rt){_(rt),Me()},Oe),Ye=null}"onloadend"in Ye?Ye.onloadend=Ze:Ye.onreadystatechange=function(){!Ye||Ye.readyState!==4||Ye.status===0&&!(Ye.responseURL&&Ye.responseURL.indexOf("file:")===0)||setTimeout(Ze)},Ye.onabort=function(){Ye&&(_(new yr("Request aborted",yr.ECONNABORTED,t,Ye)),Ye=null)},Ye.onerror=function(){_(new yr("Network Error",yr.ERR_NETWORK,t,Ye)),Ye=null},Ye.ontimeout=function(){let ge=T.timeout?"timeout of "+T.timeout+"ms exceeded":"timeout exceeded";const Oe=T.transitional||SA;T.timeoutErrorMessage&&(ge=T.timeoutErrorMessage),_(new yr(ge,Oe.clarifyTimeoutError?yr.ETIMEDOUT:yr.ECONNABORTED,t,Ye)),Ye=null},C===void 0&&P.setContentType(null),"setRequestHeader"in Ye&&Dt.forEach(P.toJSON(),function(ge,Oe){Ye.setRequestHeader(Oe,ge)}),Dt.isUndefined(T.withCredentials)||(Ye.withCredentials=!!T.withCredentials),V&&V!=="json"&&(Ye.responseType=T.responseType),$&&([ne,we]=ax($,!0),Ye.addEventListener("progress",ne)),s&&Ye.upload&&([J,ue]=ax(s),Ye.upload.addEventListener("progress",J),Ye.upload.addEventListener("loadend",ue)),(T.cancelToken||T.signal)&&(Z=ae=>{Ye&&(_(!ae||ae.type?new _m(null,t,Ye):ae),Ye.abort(),Ye=null)},T.cancelToken&&T.cancelToken.subscribe(Z),T.signal&&(T.signal.aborted?Z():T.signal.addEventListener("abort",Z)));const Fe=n3(T.url);if(Fe&&mo.protocols.indexOf(Fe)===-1){_(new yr("Unsupported protocol "+Fe+":",yr.ERR_BAD_REQUEST,t));return}Ye.send(C||null)})},f3=(t,l)=>{const{length:d}=t=t?t.filter(Boolean):[];if(l||d){let _=new AbortController,T;const C=function($){if(!T){T=!0,V();const Z=$ instanceof Error?$:this.reason;_.abort(Z instanceof yr?Z:new _m(Z instanceof Error?Z.message:Z))}};let P=l&&setTimeout(()=>{P=null,C(new yr(`timeout ${l} of ms exceeded`,yr.ETIMEDOUT))},l);const V=()=>{t&&(P&&clearTimeout(P),P=null,t.forEach($=>{$.unsubscribe?$.unsubscribe(C):$.removeEventListener("abort",C)}),t=null)};t.forEach($=>$.addEventListener("abort",C));const{signal:s}=_;return s.unsubscribe=()=>Dt.asap(V),s}},p3=function*(t,l){let d=t.byteLength;if(d<l){yield t;return}let _=0,T;for(;_<d;)T=_+l,yield t.slice(_,T),_=T},m3=async function*(t,l){for await(const d of g3(t))yield*p3(d,l)},g3=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const l=t.getReader();try{for(;;){const{done:d,value:_}=await l.read();if(d)break;yield _}}finally{await l.cancel()}},eE=(t,l,d,_)=>{const T=m3(t,l);let C=0,P,V=s=>{P||(P=!0,_&&_(s))};return new ReadableStream({async pull(s){try{const{done:$,value:Z}=await T.next();if($){V(),s.close();return}let J=Z.byteLength;if(d){let ne=C+=J;d(ne)}s.enqueue(new Uint8Array(Z))}catch($){throw V($),$}},cancel(s){return V(s),T.return()}},{highWaterMark:2})},jx=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",PA=jx&&typeof ReadableStream=="function",_3=jx&&(typeof TextEncoder=="function"?(t=>l=>t.encode(l))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),LA=(t,...l)=>{try{return!!t(...l)}catch{return!1}},y3=PA&&LA(()=>{let t=!1;const l=new Request(mo.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!l}),tE=64*1024,ab=PA&&LA(()=>Dt.isReadableStream(new Response("").body)),lx={stream:ab&&(t=>t.body)};jx&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(l=>{!lx[l]&&(lx[l]=Dt.isFunction(t[l])?d=>d[l]():(d,_)=>{throw new yr(`Response type '${l}' is not supported`,yr.ERR_NOT_SUPPORT,_)})})})(new Response);const x3=async t=>{if(t==null)return 0;if(Dt.isBlob(t))return t.size;if(Dt.isSpecCompliantForm(t))return(await new Request(mo.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Dt.isArrayBufferView(t)||Dt.isArrayBuffer(t))return t.byteLength;if(Dt.isURLSearchParams(t)&&(t=t+""),Dt.isString(t))return(await _3(t)).byteLength},v3=async(t,l)=>{const d=Dt.toFiniteNumber(t.getContentLength());return d??x3(l)},b3=jx&&(async t=>{let{url:l,method:d,data:_,signal:T,cancelToken:C,timeout:P,onDownloadProgress:V,onUploadProgress:s,responseType:$,headers:Z,withCredentials:J="same-origin",fetchOptions:ne}=kA(t);$=$?($+"").toLowerCase():"text";let ue=f3([T,C&&C.toAbortSignal()],P),we;const Me=ue&&ue.unsubscribe&&(()=>{ue.unsubscribe()});let Ye;try{if(s&&y3&&d!=="get"&&d!=="head"&&(Ye=await v3(Z,_))!==0){let Oe=new Request(l,{method:"POST",body:_,duplex:"half"}),ze;if(Dt.isFormData(_)&&(ze=Oe.headers.get("content-type"))&&Z.setContentType(ze),Oe.body){const[rt,Ie]=KT(Ye,ax(JT(s)));_=eE(Oe.body,tE,rt,Ie)}}Dt.isString(J)||(J=J?"include":"omit");const Ze="credentials"in Request.prototype;we=new Request(l,{...ne,signal:ue,method:d.toUpperCase(),headers:Z.normalize().toJSON(),body:_,duplex:"half",credentials:Ze?J:void 0});let Fe=await fetch(we);const ae=ab&&($==="stream"||$==="response");if(ab&&(V||ae&&Me)){const Oe={};["status","statusText","headers"].forEach(Je=>{Oe[Je]=Fe[Je]});const ze=Dt.toFiniteNumber(Fe.headers.get("content-length")),[rt,Ie]=V&&KT(ze,ax(JT(V),!0))||[];Fe=new Response(eE(Fe.body,tE,rt,()=>{Ie&&Ie(),Me&&Me()}),Oe)}$=$||"text";let ge=await lx[Dt.findKey(lx,$)||"text"](Fe,t);return!ae&&Me&&Me(),await new Promise((Oe,ze)=>{MA(Oe,ze,{data:ge,headers:ha.from(Fe.headers),status:Fe.status,statusText:Fe.statusText,config:t,request:we})})}catch(Ze){throw Me&&Me(),Ze&&Ze.name==="TypeError"&&/fetch/i.test(Ze.message)?Object.assign(new yr("Network Error",yr.ERR_NETWORK,t,we),{cause:Ze.cause||Ze}):yr.from(Ze,Ze&&Ze.code,t,we)}}),lb={http:zz,xhr:d3,fetch:b3};Dt.forEach(lb,(t,l)=>{if(t){try{Object.defineProperty(t,"name",{value:l})}catch{}Object.defineProperty(t,"adapterName",{value:l})}});const iE=t=>`- ${t}`,w3=t=>Dt.isFunction(t)||t===null||t===!1,DA={getAdapter:t=>{t=Dt.isArray(t)?t:[t];const{length:l}=t;let d,_;const T={};for(let C=0;C<l;C++){d=t[C];let P;if(_=d,!w3(d)&&(_=lb[(P=String(d)).toLowerCase()],_===void 0))throw new yr(`Unknown adapter '${P}'`);if(_)break;T[P||"#"+C]=_}if(!_){const C=Object.entries(T).map(([V,s])=>`adapter ${V} `+(s===!1?"is not supported by the environment":"is not available in the build"));let P=l?C.length>1?`since :
`+C.map(iE).join(`
`):" "+iE(C[0]):"as no adapter specified";throw new yr("There is no suitable adapter to dispatch the request "+P,"ERR_NOT_SUPPORT")}return _},adapters:lb};function b0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new _m(null,t)}function rE(t){return b0(t),t.headers=ha.from(t.headers),t.data=v0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),DA.getAdapter(t.adapter||m_.adapter)(t).then(function(_){return b0(t),_.data=v0.call(t,t.transformResponse,_),_.headers=ha.from(_.headers),_},function(_){return AA(_)||(b0(t),_&&_.response&&(_.response.data=v0.call(t,t.transformResponse,_.response),_.response.headers=ha.from(_.response.headers))),Promise.reject(_)})}const OA="1.8.4",$x={};["object","boolean","number","function","string","symbol"].forEach((t,l)=>{$x[t]=function(_){return typeof _===t||"a"+(l<1?"n ":" ")+t}});const nE={};$x.transitional=function(l,d,_){function T(C,P){return"[Axios v"+OA+"] Transitional option '"+C+"'"+P+(_?". "+_:"")}return(C,P,V)=>{if(l===!1)throw new yr(T(P," has been removed"+(d?" in "+d:"")),yr.ERR_DEPRECATED);return d&&!nE[P]&&(nE[P]=!0,console.warn(T(P," has been deprecated since v"+d+" and will be removed in the near future"))),l?l(C,P,V):!0}};$x.spelling=function(l){return(d,_)=>(console.warn(`${_} is likely a misspelling of ${l}`),!0)};function T3(t,l,d){if(typeof t!="object")throw new yr("options must be an object",yr.ERR_BAD_OPTION_VALUE);const _=Object.keys(t);let T=_.length;for(;T-- >0;){const C=_[T],P=l[C];if(P){const V=t[C],s=V===void 0||P(V,C,t);if(s!==!0)throw new yr("option "+C+" must be "+s,yr.ERR_BAD_OPTION_VALUE);continue}if(d!==!0)throw new yr("Unknown option "+C,yr.ERR_BAD_OPTION)}}const jy={assertOptions:T3,validators:$x},Ac=jy.validators;let kf=class{constructor(l){this.defaults=l,this.interceptors={request:new ZT,response:new ZT}}async request(l,d){try{return await this._request(l,d)}catch(_){if(_ instanceof Error){let T={};Error.captureStackTrace?Error.captureStackTrace(T):T=new Error;const C=T.stack?T.stack.replace(/^.+\n/,""):"";try{_.stack?C&&!String(_.stack).endsWith(C.replace(/^.+\n.+\n/,""))&&(_.stack+=`
`+C):_.stack=C}catch{}}throw _}}_request(l,d){typeof l=="string"?(d=d||{},d.url=l):d=l||{},d=Df(this.defaults,d);const{transitional:_,paramsSerializer:T,headers:C}=d;_!==void 0&&jy.assertOptions(_,{silentJSONParsing:Ac.transitional(Ac.boolean),forcedJSONParsing:Ac.transitional(Ac.boolean),clarifyTimeoutError:Ac.transitional(Ac.boolean)},!1),T!=null&&(Dt.isFunction(T)?d.paramsSerializer={serialize:T}:jy.assertOptions(T,{encode:Ac.function,serialize:Ac.function},!0)),d.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?d.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:d.allowAbsoluteUrls=!0),jy.assertOptions(d,{baseUrl:Ac.spelling("baseURL"),withXsrfToken:Ac.spelling("withXSRFToken")},!0),d.method=(d.method||this.defaults.method||"get").toLowerCase();let P=C&&Dt.merge(C.common,C[d.method]);C&&Dt.forEach(["delete","get","head","post","put","patch","common"],we=>{delete C[we]}),d.headers=ha.concat(P,C);const V=[];let s=!0;this.interceptors.request.forEach(function(Me){typeof Me.runWhen=="function"&&Me.runWhen(d)===!1||(s=s&&Me.synchronous,V.unshift(Me.fulfilled,Me.rejected))});const $=[];this.interceptors.response.forEach(function(Me){$.push(Me.fulfilled,Me.rejected)});let Z,J=0,ne;if(!s){const we=[rE.bind(this),void 0];for(we.unshift.apply(we,V),we.push.apply(we,$),ne=we.length,Z=Promise.resolve(d);J<ne;)Z=Z.then(we[J++],we[J++]);return Z}ne=V.length;let ue=d;for(J=0;J<ne;){const we=V[J++],Me=V[J++];try{ue=we(ue)}catch(Ye){Me.call(this,Ye);break}}try{Z=rE.call(this,ue)}catch(we){return Promise.reject(we)}for(J=0,ne=$.length;J<ne;)Z=Z.then($[J++],$[J++]);return Z}getUri(l){l=Df(this.defaults,l);const d=IA(l.baseURL,l.url,l.allowAbsoluteUrls);return EA(d,l.params,l.paramsSerializer)}};Dt.forEach(["delete","get","head","options"],function(l){kf.prototype[l]=function(d,_){return this.request(Df(_||{},{method:l,url:d,data:(_||{}).data}))}});Dt.forEach(["post","put","patch"],function(l){function d(_){return function(C,P,V){return this.request(Df(V||{},{method:l,headers:_?{"Content-Type":"multipart/form-data"}:{},url:C,data:P}))}}kf.prototype[l]=d(),kf.prototype[l+"Form"]=d(!0)});let E3=class RA{constructor(l){if(typeof l!="function")throw new TypeError("executor must be a function.");let d;this.promise=new Promise(function(C){d=C});const _=this;this.promise.then(T=>{if(!_._listeners)return;let C=_._listeners.length;for(;C-- >0;)_._listeners[C](T);_._listeners=null}),this.promise.then=T=>{let C;const P=new Promise(V=>{_.subscribe(V),C=V}).then(T);return P.cancel=function(){_.unsubscribe(C)},P},l(function(C,P,V){_.reason||(_.reason=new _m(C,P,V),d(_.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(l){if(this.reason){l(this.reason);return}this._listeners?this._listeners.push(l):this._listeners=[l]}unsubscribe(l){if(!this._listeners)return;const d=this._listeners.indexOf(l);d!==-1&&this._listeners.splice(d,1)}toAbortSignal(){const l=new AbortController,d=_=>{l.abort(_)};return this.subscribe(d),l.signal.unsubscribe=()=>this.unsubscribe(d),l.signal}static source(){let l;return{token:new RA(function(T){l=T}),cancel:l}}};function S3(t){return function(d){return t.apply(null,d)}}function C3(t){return Dt.isObject(t)&&t.isAxiosError===!0}const cb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(cb).forEach(([t,l])=>{cb[l]=t});function zA(t){const l=new kf(t),d=fA(kf.prototype.request,l);return Dt.extend(d,kf.prototype,l,{allOwnKeys:!0}),Dt.extend(d,l,null,{allOwnKeys:!0}),d.create=function(T){return zA(Df(t,T))},d}const dn=zA(m_);dn.Axios=kf;dn.CanceledError=_m;dn.CancelToken=E3;dn.isCancel=AA;dn.VERSION=OA;dn.toFormData=Vx;dn.AxiosError=yr;dn.Cancel=dn.CanceledError;dn.all=function(l){return Promise.all(l)};dn.spread=S3;dn.isAxiosError=C3;dn.mergeConfig=Df;dn.AxiosHeaders=ha;dn.formToJSON=t=>CA(Dt.isHTMLForm(t)?new FormData(t):t);dn.getAdapter=DA.getAdapter;dn.HttpStatusCode=cb;dn.default=dn;const{Axios:d4,AxiosError:f4,CanceledError:p4,isCancel:m4,CancelToken:g4,VERSION:_4,all:y4,Cancel:x4,isAxiosError:v4,spread:b4,toFormData:w4,AxiosHeaders:T4,HttpStatusCode:E4,formToJSON:S4,getAdapter:C4,mergeConfig:A4}=dn,ym=dA("user",{state:()=>({token:localStorage.getItem("token"),role:localStorage.getItem("role"),email:localStorage.getItem("email")}),actions:{setToken(t,l,d){this.token=t,this.role=l,this.email=d,localStorage.setItem("token",t),localStorage.setItem("role",l),localStorage.setItem("email",d),dn.defaults.headers.common.Authorization=`Bearer ${t}`},async login(t,l){try{const d=await dn.post("http://127.0.0.1:8000/api/v1/auth/login",{email:t,password:l});return this.setToken(d.data.access_token,d.data.role,d.data.email),!0}catch(d){return console.error("Login failed:",d),!1}},logout(){this.token=null,this.role=null,this.email=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("email"),delete dn.defaults.headers.common.Authorization}}}),A3={class:"app-container"},M3={class:"navbar"},I3={key:0,class:"geoportal-title"},k3={class:"navbar-controls"},P3={class:"navbar-links"},L3={class:"language-switcher"},D3={key:0,class:"auth-controls"},O3={class:"user-email"},R3={key:1},z3={class:"view-container"},B3={class:"footer"},F3=On({__name:"Layout",setup(t){const l=zD(),d=AC(),{locale:_}=f_(),T=Z=>{_.value=Z,localStorage.setItem("lang",Z)},C=un(()=>l.path!=="/"),P=ym(),V=un(()=>!!P.token),s=un(()=>P.email||""),$=()=>{P.logout(),d.push("/login")};return(Z,J)=>{const ne=Ah("router-link"),ue=Ah("router-view");return gi(),ki("div",A3,[ot("nav",M3,[fr(ne,{to:"/",class:"logo-group","aria-label":"Home"},{default:Ns(()=>[J[2]||(J[2]=ot("img",{src:Nb,alt:"Donor Logo",class:"logo-dgis"},null,-1)),J[3]||(J[3]=ot("img",{src:pC,alt:"Soil Values Logo",class:"logo-sv"},null,-1)),C.value?(gi(),ki("span",I3,pi(Z.$t("title")),1)):wn("",!0)]),_:1}),ot("div",k3,[ot("div",P3,[fr(ne,{to:"/",class:"nav-link"},{default:Ns(()=>[Vs(pi(Z.$t("nav.home")),1)]),_:1}),fr(ne,{to:"/dashboard",class:"nav-link"},{default:Ns(()=>[Vs(pi(Z.$t("nav.map")),1)]),_:1}),fr(ne,{to:"/monitoring",class:"nav-link"},{default:Ns(()=>[Vs(pi(Z.$t("nav.mne")),1)]),_:1}),fr(ne,{to:"/catalog",class:"nav-link"},{default:Ns(()=>[Vs(pi(Z.$t("nav.catalog")),1)]),_:1}),fr(ne,{to:"/about",class:"nav-link"},{default:Ns(()=>[Vs(pi(Z.$t("nav.about")),1)]),_:1}),fr(ne,{to:"/admin-panel",class:"nav-link"},{default:Ns(()=>J[4]||(J[4]=[Vs("Admin Panel")])),_:1})]),ot("div",L3,[uo(ot("select",{"onUpdate:modelValue":J[0]||(J[0]=we=>Ln(_)?_.value=we:null),onChange:J[1]||(J[1]=we=>T(ns(_)))},J[5]||(J[5]=[ot("option",{value:"en"},"EN",-1),ot("option",{value:"fr"},"FR",-1)]),544),[[Sh,ns(_)]])]),V.value?(gi(),ki("div",D3,[ot("span",O3,pi(s.value),1),ot("button",{onClick:$,class:"logout-btn"},"Logout")])):(gi(),ki("div",R3,[fr(ne,{to:"/login",class:"nav-link"},{default:Ns(()=>J[6]||(J[6]=[Vs("Login")])),_:1})]))])]),ot("div",z3,[fr(ue)]),ot("footer",B3,[ot("p",null,pi(Z.$t("footer")),1)])])}}}),ua=(t,l)=>{const d=t.__vccOpts||t;for(const[_,T]of l)d[_]=T;return d},N3=ua(F3,[["__scopeId","data-v-b1cd5593"]]),U3={id:"app"},V3=On({__name:"App",setup(t){return(l,d)=>(gi(),ki("div",U3,[fr(N3)]))}}),BA="/projects/soil_values/assets/ifdc_logo-C0Phf9Dr.png",FA="/projects/soil_values/assets/WUR_logo-Ds7IIsIR.png",NA="/projects/soil_values/assets/SNV_logo_2-LRpPKBkz.png",UA="/projects/soil_values/assets/AGRA_logo-BuD40XdR.webp",VA="/projects/soil_values/assets/IITA_logo-DW09z6CA.png",jA="/projects/soil_values/assets/IWMI_logo-B-LuUFd5.jpg",$A="/projects/soil_values/assets/ISRIC_logo-Cx1mKsJo.webp",GA="/projects/soil_values/assets/CIFOR-ICRAF-logo-CA2wt9fE.webp",j3={class:"home-container"},$3={class:"landing-content"},G3={class:"fade-slide"},W3={class:"landing-text fade-slide",style:{"animation-delay":"0.3s"}},H3=On({__name:"HomeView",setup(t){return(l,d)=>{const _=Ah("router-link");return gi(),ki("div",j3,[ot("div",$3,[d[0]||(d[0]=Zg('<div class="top-logos fade-slide" data-v-effe8000><a href="https://www.government.nl/ministries/ministry-of-foreign-affairs" target="_blank" rel="noopener" data-v-effe8000><img src="'+Nb+'" alt="DGIS Logo" class="logo donor-logo" data-v-effe8000></a><a href="https://ifdc.org/soil-values" target="_blank" rel="noopener" data-v-effe8000><img src="'+pC+'" alt="Soil Values Logo" class="logo main-logo" data-v-effe8000></a></div>',1)),ot("h1",G3,pi(l.$t("home.title")),1),ot("div",W3,[ot("p",null,pi(l.$t("home.intro1")),1),ot("p",null,pi(l.$t("home.intro2")),1)]),d[1]||(d[1]=Zg('<div class="logos-grid" data-v-effe8000><div class="logo-row fade-slide" style="animation-delay:0.6s;" data-v-effe8000><a href="https://ifdc.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+BA+'" alt="IFDC" data-v-effe8000></a><a href="https://wur.nl" target="_blank" rel="noopener" data-v-effe8000><img src="'+FA+'" alt="WUR" data-v-effe8000></a><a href="https://snv.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+NA+'" alt="SNV" data-v-effe8000></a></div><div class="logo-row fade-slide" style="animation-delay:0.9s;" data-v-effe8000><a href="https://agra.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+UA+'" alt="AGRA" data-v-effe8000></a><a href="https://www.iita.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+VA+'" alt="IITA" data-v-effe8000></a><a href="https://www.iwmi.cgiar.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+jA+'" alt="IWMI" class="logo-iwmi" data-v-effe8000></a><a href="https://www.isric.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+$A+'" alt="ISRIC" data-v-effe8000></a><a href="https://www.cifor-icraf.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+GA+'" alt="CIFOR-ICRAF" data-v-effe8000></a></div></div>',1)),fr(_,{to:"/dashboard",class:"launch-btn fade-slide",style:{"animation-delay":"1.2s"}},{default:Ns(()=>[Vs(pi(l.$t("home.launch")),1)]),_:1})])])}}}),q3=ua(H3,[["__scopeId","data-v-effe8000"]]);var WA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function HA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function X3(t){if(t.__esModule)return t;var l=t.default;if(typeof l=="function"){var d=function _(){return this instanceof _?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};d.prototype=l.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(t).forEach(function(_){var T=Object.getOwnPropertyDescriptor(t,_);Object.defineProperty(d,_,T.get?T:{enumerable:!0,get:function(){return t[_]}})}),d}var qA={exports:{}};(function(t,l){var d={};(function(_,T){t.exports=T()})(WA,function(){var _,T,C;function P(s,$){if(!_)_=$;else if(!T)T=$;else{var Z="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+_+")(sharedChunk); ("+T+")(sharedChunk); self.onerror = null;",J={};_(J),C=$(J),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(C.workerUrl=window.URL.createObjectURL(new Blob([Z],{type:"text/javascript"})))}}P(["exports"],function(s){var $=typeof self<"u"?self:{},Z="2.15.0";let J;const ne={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(J==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{J=d.API_URL_REGEX!=null?new RegExp(d.API_URL_REGEX):i}catch{J=i}}return J},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ne.API_URL)return null;try{const i=new URL(ne.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ue={supported:!1,testSupport:function(i){!Ye&&Me&&(Ze?Fe(i):we=i)}};let we,Me,Ye=!1,Ze=!1;function Fe(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Me),i.isContextLost())return;ue.supported=!0}catch{}i.deleteTexture(e),Ye=!0}$.document&&(Me=$.document.createElement("img"),Me.onload=function(){we&&Fe(we),we=null,Ze=!0},Me.onerror=function(){Ye=!0,we=null},Me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ae="01";function ge(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Oe=ze;function ze(i,e,r,a){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=r,this.p2y=a}ze.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,a=0;a<8;a++){var h=this.sampleCurveX(r)-i;if(Math.abs(h)<e)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=h/m}var y=0,w=1;for(r=i,a=0;a<20&&(h=this.sampleCurveX(r),!(Math.abs(h-i)<e));a++)i>h?y=r:w=r,r=.5*(w-y)+y;return r},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var rt=ge(Oe),Ie=Je;function Je(i,e){this.x=i,this.y=e}Je.prototype={clone:function(){return new Je(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,r=i.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),r=Math.sin(i),a=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=a,this},_rotateAround:function(i,e){var r=Math.cos(i),a=Math.sin(i),h=e.y+a*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Je.convert=function(i){return i instanceof Je?i:Array.isArray(i)?new Je(i[0],i[1]):i};var He=ge(Ie);const ti=Math.PI/180,bt=180/Math.PI;function wt(i){return i*ti}function xt(i){return i*bt}const Tt=[[0,0],[1,0],[1,1],[0,1]];function vt(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,r=e*i;return 4*(i<.5?r:3*(i-e)+r-.75)}function ai(i,e,r,a){const h=new rt(i,e,r,a);return function(m){return h.solve(m)}}const yi=ai(.25,.1,.25,1);function xi(i,e,r){return Math.min(r,Math.max(e,i))}function Pr(i,e,r){return(r=xi((r-i)/(e-i),0,1))*r*(3-2*r)}function tr(i,e,r){const a=r-e,h=((i-e)%a+a)%a+e;return h===e?r:h}function nr(i,e,r){if(!i.length)return r(null,[]);let a=i.length;const h=new Array(i.length);let m=null;i.forEach((y,w)=>{e(y,(M,k)=>{M&&(m=M),h[w]=k,--a==0&&r(m,h)})})}function rn(i){const e=[];for(const r in i)e.push(i[r]);return e}function dr(i,...e){for(const r of e)for(const a in r)i[a]=r[a];return i}let Rn=1;function nn(){return Rn++}function zt(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function fi(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function ri(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function Ti(i,e){i.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function sr(i,e){return i.indexOf(e,i.length-e.length)!==-1}function Ei(i,e,r){const a={};for(const h in i)a[h]=e.call(this,i[h],h,i);return a}function xe(i,e,r){const a={};for(const h in i)e.call(r||this,i[h],h,i)&&(a[h]=i[h]);return a}function ve(i){return Array.isArray(i)?i.map(ve):typeof i=="object"&&i?Ei(i,ve):i}const nt={};function Lt(i){nt[i]||(typeof console<"u"&&console.warn(i),nt[i]=!0)}function It(i,e,r){return(r.y-i.y)*(e.x-i.x)>(e.y-i.y)*(r.x-i.x)}function Xt(i){let e=0;for(let r,a,h=0,m=i.length,y=m-1;h<m;y=h++)r=i[h],a=i[y],e+=(a.x-r.x)*(r.y+a.y);return e}function ni(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Te(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,a,h,m)=>{const y=h||m;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let Ae=null;function Qe(i){if(Ae==null){const e=i.navigator?i.navigator.userAgent:null;Ae=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ae}function $t(i){try{const e=$[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Gt(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}const Zt="mapbox-tiles";let ut=500,Pt=50,Mi,Di;function $r(){try{return $.caches}catch{}}function Nr(){$r()&&!Mi&&(Mi=$.caches.open(Zt))}function cn(i){const e=i.indexOf("?");if(e<0)return i;const r=function(h){const m=h.indexOf("?");return m>0?h.slice(m+1).split("&"):[]}(i),a=r.filter(h=>{const m=h.split("=");return m[0]==="language"||m[0]==="worldview"});return a.length?`${i.slice(0,e)}?${a.join("&")}`:i.slice(0,e)}let lr=1/0;const hs={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(hs);class _o extends Error{constructor(e,r,a){r===401&&ct(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const zn=ni()?()=>self.worker&&self.worker.referrer:()=>($.location.protocol==="blob:"?$.parent:$).location.href,Kn=function(i,e){if(!(/^file:/.test(r=i.url)||/^file:/.test(zn())&&!/^\w+:/.test(r))){if($.fetch&&$.Request&&$.AbortController&&$.Request.prototype.hasOwnProperty("signal"))return function(a,h){const m=new $.AbortController,y=new $.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:zn(),referrerPolicy:a.referrerPolicy,signal:m.signal});let w=!1,M=!1;const k=(B=y.url).indexOf("sku=")>0&&ct(B);var B;a.type==="json"&&y.headers.set("Accept","application/json");const U=(X,Y,ie)=>{if(M)return;if(X&&X.message!=="SecurityError"&&Lt(X.toString()),Y&&ie)return G(Y);const de=Date.now();$.fetch(y).then(Ee=>{if(Ee.ok){const Re=k?Ee.clone():null;return G(Ee,Re,de)}return h(new _o(Ee.statusText,Ee.status,a.url))}).catch(Ee=>{Ee.name!=="AbortError"&&h(new Error(`${Ee.message} ${a.url}`))})},G=(X,Y,ie)=>{(a.type==="arrayBuffer"?X.arrayBuffer():a.type==="json"?X.json():X.text()).then(de=>{M||(Y&&ie&&function(Ee,Re,Se){if(Nr(),!Mi)return;const De={status:Re.status,statusText:Re.statusText,headers:new $.Headers};Re.headers.forEach((gt,dt)=>De.headers.set(dt,gt));const Ve=Te(Re.headers.get("Cache-Control")||"");if(Ve["no-store"])return;Ve["max-age"]&&De.headers.set("Expires",new Date(Se+1e3*Ve["max-age"]).toUTCString());const Be=De.headers.get("Expires");Be&&(new Date(Be).getTime()-Se<42e4||function(gt,dt){if(Di===void 0)try{new Response(new ReadableStream),Di=!0}catch{Di=!1}Di?dt(gt.body):gt.blob().then(dt)}(Re,gt=>{const dt=new $.Response(gt,De);Nr(),Mi&&Mi.then(At=>At.put(cn(Ee.url),dt)).catch(At=>Lt(At.message))}))}(y,Y,ie),w=!0,h(null,de,X.headers.get("Cache-Control"),X.headers.get("Expires")))}).catch(de=>{M||h(new Error(de.message))})};return k?function(X,Y){if(Nr(),!Mi)return Y(null);const ie=cn(X.url);Mi.then(de=>{de.match(ie).then(Ee=>{const Re=function(Se){if(!Se)return!1;const De=new Date(Se.headers.get("Expires")||0),Ve=Te(Se.headers.get("Cache-Control")||"");return De>Date.now()&&!Ve["no-cache"]}(Ee);de.delete(ie),Re&&de.put(ie,Ee.clone()),Y(null,Ee,Re)}).catch(Y)}).catch(Y)}(y,U):U(null,null),{cancel:()=>{M=!0,w||m.abort()}}}(i,e);if(ni()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var r;return function(a,h){const m=new $.XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const y in a.headers)m.setRequestHeader(y,a.headers[y]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(a.type==="json")try{y=JSON.parse(m.response)}catch(w){return h(w)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new _o(m.statusText,m.status,a.url))},m.send(a.body),{cancel:()=>m.abort()}}(i,e)},ss=function(i,e){return Kn(dr(i,{type:"arrayBuffer"}),e)};function $l(i){const e=$.document.createElement("a");return e.href=i,e.protocol===$.document.location.protocol&&e.host===$.document.location.host}const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let oe,le;oe=[],le=0;const Pe=function(i,e){if(ue.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),le>=ne.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return oe.push(m),m}le++;let r=!1;const a=()=>{if(!r)for(r=!0,le--;oe.length&&le<ne.MAX_PARALLEL_IMAGE_REQUESTS;){const m=oe.shift(),{requestParameters:y,callback:w,cancelled:M}=m;M||(m.cancel=Pe(y,w).cancel)}},h=ss(i,(m,y,w,M)=>{a(),m?e(m):y&&($.createImageBitmap?function(k,B){const U=new $.Blob([new Uint8Array(k)],{type:"image/png"});$.createImageBitmap(U).then(G=>{B(null,G)}).catch(G=>{B(new Error(`Could not load image because of ${G.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(k,B)=>e(k,B,w,M)):function(k,B){const U=new $.Image,G=$.URL;U.onload=()=>{B(null,U),G.revokeObjectURL(U.src),U.onload=null,$.requestAnimationFrame(()=>{U.src=Le})},U.onerror=()=>B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const X=new $.Blob([new Uint8Array(k)],{type:"image/png"});U.src=k.byteLength?G.createObjectURL(X):Le}(y,(k,B)=>e(k,B,w,M)))});return{cancel:()=>{h.cancel(),a()}}},je="NO_ACCESS_TOKEN";function qe(i){return i.indexOf("mapbox:")===0}function ct(i){return ne.API_URL_REGEX.test(i)}function at(i){return ne.API_CDN_URL_REGEX.test(i)}function Ke(i){return ne.API_STYLE_REGEX.test(i)&&!st(i)}function st(i){return ne.API_SPRITE_REGEX.test(i)}const Kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ii(i){const e=i.match(Kt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Wt(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}const ji="mapbox.eventData";function Ri(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent($.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class $i{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=Ri(ne.ACCESS_TOKEN);let a="";return a=r&&r.u?$.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(h,m)=>String.fromCharCode(+("0x"+m)))):ne.ACCESS_TOKEN||"",e?`${ji}.${e}:${a}`:`${ji}:${a}`}fetchEventData(){const e=$t("localStorage"),r=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const h=$.localStorage.getItem(r);h&&(this.eventData=JSON.parse(h));const m=$.localStorage.getItem(a);m&&(this.anonId=m)}catch{Lt("Unable to read from LocalStorage")}}saveEventData(){const e=$t("localStorage"),r=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{$.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&$.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{Lt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,a,h){if(!ne.EVENTS_URL)return;const m=ii(ne.EVENTS_URL);m.params.push(`access_token=${h||ne.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(e).toISOString()},w=r?dr(y,r):y,M={url:Wt(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=function(k,B){return Kn(dr(k,{method:"POST"}),B)}(M,k=>{this.pendingRequest=null,a(k),this.saveEventData(),this.processRequests(h)})}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const or=new class extends $i{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){ne.EVENTS_URL&&ne.ACCESS_TOKEN&&Array.isArray(i)&&i.some(r=>qe(r)||ct(r))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Ri(ne.ACCESS_TOKEN),r=e?e.u:ne.ACCESS_TOKEN;let a=r!==this.eventData.tokenU;ri(this.anonId)||(this.anonId=zt(),a=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),y=new Date(h),w=(h-this.eventData.lastSuccess)/864e5;a=a||w>=1||w<-1||m.getDate()!==y.getDate()}else a=!0;a?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Z,skuId:ae,"enabled.telemetry":!1,userId:this.anonId},m=>{m||(this.eventData.lastSuccess=h,this.eventData.tokenU=r)},i):this.processRequests()}},ur=or.postTurnstileEvent.bind(or),hn=new class extends $i{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,r,a){this.skuToken=e,this.errorCb=a,ne.EVENTS_URL&&(r||ne.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(je)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),ri(this.anonId)||(this.anonId=zt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Z,skuId:ae,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},i))}},_n=hn.postMapLoadEvent.bind(hn),os=new class extends $i{constructor(){super("gljs.performance")}postPerformanceEvent(i,e){ne.EVENTS_URL&&(i||ne.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:r}=this.queue.shift(),a=function(h){const m=$.performance.getEntriesByType("resource"),y=$.performance.getEntriesByType("mark"),w=function(G){const X={};if(G){for(const Y in G)if(Y!=="other")for(const ie of G[Y]){const de=`${Y}ResolveRangeMin`,Ee=`${Y}ResolveRangeMax`,Re=`${Y}RequestCount`,Se=`${Y}RequestCachedCount`;X[de]=Math.min(X[de]||1/0,ie.startTime),X[Ee]=Math.max(X[Ee]||-1/0,ie.responseEnd);const De=Ve=>{X[Ve]===void 0&&(X[Ve]=0),++X[Ve]};ie.transferSize!==void 0&&ie.transferSize===0&&De(Se),De(Re)}}return X}(function(G,X){const Y={};if(G)for(const ie of G){const de=X(ie);Y[de]===void 0&&(Y[de]=[]),Y[de].push(ie)}return Y}(m,Ff)),M=$.devicePixelRatio,k=$.navigator.connection||$.navigator.mozConnection||$.navigator.webkitConnection,B={counters:[],metadata:[],attributes:[]},U=(G,X,Y)=>{Y!=null&&G.push({name:X,value:Y.toString()})};for(const G in w)U(B.counters,G,w[G]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(U(B.counters,"interactionRangeMin",h.interactionRange[0]),U(B.counters,"interactionRangeMax",h.interactionRange[1])),y)for(const G of Object.keys(En)){const X=En[G],Y=y.find(ie=>ie.name===X);Y&&U(B.counters,X,Y.startTime)}return U(B.counters,"visibilityHidden",h.visibilityHidden),U(B.attributes,"style",function(G){if(G)for(const X of G){const Y=X.name.split("?")[0];if(Ke(Y)){const ie=Y.split("/").slice(-2);if(ie.length===2)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(m)),U(B.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),U(B.attributes,"fogEnabled",h.fogEnabled?"true":"false"),U(B.attributes,"projection",h.projection),U(B.attributes,"zoom",h.zoom),U(B.metadata,"devicePixelRatio",M),U(B.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),U(B.metadata,"navigatorUserAgent",$.navigator.userAgent),U(B.metadata,"screenWidth",$.screen.width),U(B.metadata,"screenHeight",$.screen.height),U(B.metadata,"windowWidth",$.innerWidth),U(B.metadata,"windowHeight",$.innerHeight),U(B.metadata,"mapWidth",h.width/M),U(B.metadata,"mapHeight",h.height/M),U(B.metadata,"webglRenderer",h.renderer),U(B.metadata,"webglVendor",h.vendor),U(B.metadata,"sdkVersion",Z),U(B.metadata,"sdkIdentifier","mapbox-gl-js"),B}(r);for(const h of a.metadata);for(const h of a.counters);for(const h of a.attributes);this.postEvent(e,a,()=>{},i)}},jn=os.postPerformanceEvent.bind(os),No=new class extends $i{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,r,a){if(!ne.API_URL||!ne.SESSION_PATH)return;const h=ii(ne.API_URL+ne.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${a||ne.ACCESS_TOKEN||""}`);const m={url:Wt(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(y,w){return Kn(dr(y,{method:"GET"}),w)}(m,y=>{this.pendingRequest=null,r(y),this.saveEventData(),this.processRequests(a)})}getSessionAPI(i,e,r,a){this.skuToken=e,this.errorCb=a,ne.SESSION_PATH&&ne.API_URL&&(r||ne.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(je)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},i)}},$n=No.getSessionAPI.bind(No),us=new Set,En={create:"create",load:"load",fullLoad:"fullLoad"},Bf={mark(i){$.performance.mark(i)},measure(i,e,r){$.performance.measure(i,e,r)}};function Ff(i){const e=i.name.split("?")[0];return at(e)&&e.includes("mapbox-gl.js")?"javascript":at(e)&&e.includes("mapbox-gl.css")?"css":function(r){return ne.API_FONTS_REGEX.test(r)}(e)?"fontRange":st(e)?"sprite":Ke(e)?"style":function(r){return ne.API_TILEJSON_REGEX.test(r)}(e)?"tilejson":"other"}const wr=$.performance;function td(i){const e=i?i.url.toString():void 0;return wr.getEntriesByName(e)}let zc,Oh,Rh,yo;const Uo={now:()=>Rh!==void 0?Rh:$.performance.now(),setNow(i){Rh=i},restoreNow(){Rh=void 0},frame(i){const e=$.requestAnimationFrame(i);return{cancel:()=>$.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:r,height:a}=i;yo||(yo=$.document.createElement("canvas"));const h=yo.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(r>yo.width||a>yo.height)&&(yo.width=r,yo.height=a),h.clearRect(-e,-e,r+2*e,a+2*e),h.drawImage(i,0,0,r,a),h.getImageData(-e,-e,r+2*e,a+2*e)},resolveURL:i=>(zc||(zc=$.document.createElement("a")),zc.href=i,zc.href),get devicePixelRatio(){return $.devicePixelRatio},get prefersReducedMotion(){return!!$.matchMedia&&(Oh==null&&(Oh=$.matchMedia("(prefers-reduced-motion: reduce)")),Oh.matches)}};function id(i,e,r){r[i]&&r[i].indexOf(e)!==-1||(r[i]=r[i]||[],r[i].push(e))}function Bc(i,e,r){if(r&&r[i]){const a=r[i].indexOf(e);a!==-1&&r[i].splice(a,1)}}class Vo{constructor(e,r={}){dr(this,r),this.type=e}}class da extends Vo{constructor(e,r={}){super("error",dr({error:e},r))}}class Vr{on(e,r){return this._listeners=this._listeners||{},id(e,r,this._listeners),this}off(e,r){return Bc(e,r,this._listeners),Bc(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},id(e,r,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,r){typeof e=="string"&&(e=new Vo(e,r||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const w of h)w.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const w of m)Bc(a,w,this._oneTimeListeners),w.call(this,e);const y=this._eventedParent;y&&(dr(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof da&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var Et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function jo(i,...e){for(const r of e)for(const a in r)i[a]=r[a];return i}function Bn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Jn(i){if(Array.isArray(i))return i.map(Jn);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const r in i)e[r]=Jn(i[r]);return e}return Bn(i)}class Nf extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var $o=Nf;class zh{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[a,h]of r)this.bindings[a]=h}concat(e){return new zh(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Uf=zh;const Gl={kind:"null"},li={kind:"number"},cr={kind:"string"},Yi={kind:"boolean"},Ps={kind:"color"},Ys={kind:"object"},Ki={kind:"value"},Ls={kind:"collator"},ds={kind:"formatted"},xo={kind:"resolvedImage"};function Ks(i,e){return{kind:"array",itemType:i,N:e}}function sn(i){if(i.kind==="array"){const e=sn(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const Vf=[Gl,li,cr,Yi,Ps,ds,Ys,Ks(Ki),xo];function vo(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!vo(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const r of Vf)if(!vo(r,e))return null}}return`Expected ${sn(i)} but found ${sn(e)} instead.`}function Na(i,e){return e.some(r=>r.kind===i.kind)}function Fc(i,e){return e.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}var rd,nd={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Wl(i){return(i=Math.round(i))<0?0:i>255?255:i}function Go(i){return Wl(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function Bh(i){return(e=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:e>1?1:e;var e}function fa(i,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?i+(e-i)*r*6:2*r<1?e:3*r<2?i+(e-i)*(2/3-r)*6:i}try{rd={}.parseCSSColor=function(i){var e,r=i.replace(/ /g,"").toLowerCase();if(r in nd)return nd[r].slice();if(r[0]==="#")return r.length===4?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:r.length===7&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=r.indexOf("("),h=r.indexOf(")");if(a!==-1&&h+1===r.length){var m=r.substr(0,a),y=r.substr(a+1,h-(a+1)).split(","),w=1;switch(m){case"rgba":if(y.length!==4)return null;w=Bh(y.pop());case"rgb":return y.length!==3?null:[Go(y[0]),Go(y[1]),Go(y[2]),w];case"hsla":if(y.length!==4)return null;w=Bh(y.pop());case"hsl":if(y.length!==3)return null;var M=(parseFloat(y[0])%360+360)%360/360,k=Bh(y[1]),B=Bh(y[2]),U=B<=.5?B*(k+1):B+k-B*k,G=2*B-U;return[Wl(255*fa(G,U,M+1/3)),Wl(255*fa(G,U,M)),Wl(255*fa(G,U,M-1/3)),w];default:return null}}return null}}catch{}class Ds{constructor(e,r,a,h=1){this.r=e,this.g=r,this.b=a,this.a=h}static parse(e){if(!e)return;if(e instanceof Ds)return e;if(typeof e!="string")return;const r=rd(e);return r?new Ds(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,a,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(a)},${h})`}toArray(){const{r:e,g:r,b:a,a:h}=this;return h===0?[0,0,0,0]:[255*e/h,255*r/h,255*a/h,h]}toArray01(){const{r:e,g:r,b:a,a:h}=this;return h===0?[0,0,0,0]:[e/h,r/h,a/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:a,a:h}=this;return[e,r,a,h]}}Ds.black=new Ds(0,0,0,1),Ds.white=new Ds(1,1,1,1),Ds.transparent=new Ds(0,0,0,0),Ds.red=new Ds(1,0,0,1),Ds.blue=new Ds(0,0,1,1);var Sn=Ds;class sd{constructor(e,r,a){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Nc{constructor(e,r,a,h,m){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=a,this.fontStack=h,this.textColor=m}}class Os{constructor(e){this.sections=e}static fromString(e){return new Os([new Nc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Os?e:Os.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const a={};r.fontStack&&(a["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(a["font-scale"]=r.scale),r.textColor&&(a["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(a)}return e}}class Ts{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ts({name:e,available:!1}):null}serialize(){return["image",this.name]}}function od(i,e,r,a){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[i,e,r,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[i,e,r,a]:[i,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Rs(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Sn||i instanceof sd||i instanceof Os||i instanceof Ts)return!0;if(Array.isArray(i)){for(const e of i)if(!Rs(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!Rs(i[e]))return!1;return!0}return!1}function yn(i){if(i===null)return Gl;if(typeof i=="string")return cr;if(typeof i=="boolean")return Yi;if(typeof i=="number")return li;if(i instanceof Sn)return Ps;if(i instanceof sd)return Ls;if(i instanceof Os)return ds;if(i instanceof Ts)return xo;if(Array.isArray(i)){const e=i.length;let r;for(const a of i){const h=yn(a);if(r){if(r===h)continue;r=Ki;break}r=h}return Ks(r||Ki,e)}return Ys}function pa(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Sn||i instanceof Os||i instanceof Ts?i.toString():JSON.stringify(i)}class Uc{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Rs(e[1]))return r.error("invalid value");const a=e[1];let h=yn(a);const m=r.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Uc(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Sn?["rgba"].concat(this.value.toArray()):this.value instanceof Os?this.value.serialize():this.value}}var ma=Uc,Qn=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Fh={string:cr,number:li,boolean:Yi,object:Ys};class ad{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let a,h=1;const m=e[0];if(m==="array"){let w,M;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Fh)||k==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);w=Fh[k],h++}else w=Ki;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);M=e[2],h++}a=Ks(w,M)}else a=Fh[m];const y=[];for(;h<e.length;h++){const w=r.parse(e[h],h,Ki);if(!w)return null;y.push(w)}return new ad(a,y)}evaluate(e){for(let r=0;r<this.args.length;r++){const a=this.args[r].evaluate(e);if(!vo(this.type,yn(a)))return a;if(r===this.args.length-1)throw new Qn(`Expected value to be of type ${sn(this.type)}, but found ${sn(yn(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if(e.kind==="array"){const a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){r.push(a.kind);const h=e.N;(typeof h=="number"||this.args.length>1)&&r.push(h)}}return r.concat(this.args.map(a=>a.serialize()))}}var ga=ad;class _a{constructor(e){this.type=ds,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return r.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=e.length-1;++y){const w=e[y];if(m&&typeof w=="object"&&!Array.isArray(w)){m=!1;let M=null;if(w["font-scale"]&&(M=r.parse(w["font-scale"],1,li),!M))return null;let k=null;if(w["text-font"]&&(k=r.parse(w["text-font"],1,Ks(cr)),!k))return null;let B=null;if(w["text-color"]&&(B=r.parse(w["text-color"],1,Ps),!B))return null;const U=h[h.length-1];U.scale=M,U.font=k,U.textColor=B}else{const M=r.parse(e[y],1,Ki);if(!M)return null;const k=M.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:M,scale:null,font:null,textColor:null})}}return new _a(h)}evaluate(e){return new Os(this.sections.map(r=>{const a=r.content.evaluate(e);return yn(a)===xo?new Nc("",a,null,null,null):new Nc(pa(a),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const a={};r.scale&&(a["font-scale"]=r.scale.serialize()),r.font&&(a["text-font"]=r.font.serialize()),r.textColor&&(a["text-color"]=r.textColor.serialize()),e.push(a)}return e}}class Hl{constructor(e){this.type=xo,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const a=r.parse(e[1],1,cr);return a?new Hl(a):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),a=Ts.fromString(r);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(r)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ql={"to-boolean":Yi,"to-color":Ps,"to-number":li,"to-string":cr};class bo{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return r.error("Expected one argument.");const h=ql[a],m=[];for(let y=1;y<e.length;y++){const w=r.parse(e[y],y,Ki);if(!w)return null;m.push(w)}return new bo(h,m)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let r,a;for(const h of this.args){if(r=h.evaluate(e),a=null,r instanceof Sn)return r;if(typeof r=="string"){const m=e.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(a=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:od(r[0],r[1],r[2],r[3]),!a))return new Sn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Qn(a||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const a of this.args){if(r=a.evaluate(e),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new Qn(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Os.fromString(pa(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ts.fromString(pa(this.args[0].evaluate(e))):pa(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new _a([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Hl(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var ya=bo;const Wo=["Unknown","Point","LineString","Polygon"];var ld=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Wo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-i[0])+this.featureDistanceData.bearing[1]*(a*e-i[1])}return 0}parseColor(i){let e=this._parseColorCache[i];return e||(e=this._parseColorCache[i]=Sn.parse(i)),e}};class al{constructor(e,r,a,h){this.name=e,this.type=r,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const a=e[0],h=al.definitions[a];if(!h)return r.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let M=null;for(const[k,B]of w){M=new hd(r.registry,r.path,null,r.scope);const U=[];let G=!1;for(let X=1;X<e.length;X++){const Y=e[X],ie=Array.isArray(k)?k[X-1]:k.type,de=M.parse(Y,1+U.length,ie);if(!de){G=!0;break}U.push(de)}if(!G)if(Array.isArray(k)&&k.length!==U.length)M.error(`Expected ${k.length} arguments, but found ${U.length} instead.`);else{for(let X=0;X<U.length;X++){const Y=Array.isArray(k)?k[X]:k.type,ie=U[X];M.concat(X+1).checkSubtype(Y,ie.type)}if(M.errors.length===0)return new al(a,m,B,U)}}if(w.length===1)r.errors.push(...M.errors);else{const k=(w.length?w:y).map(([U])=>{return G=U,Array.isArray(G)?`(${G.map(sn).join(", ")})`:`(${sn(G.type)}...)`;var G}).join(" | "),B=[];for(let U=1;U<e.length;U++){const G=r.parse(e[U],1+B.length);if(!G)return null;B.push(sn(G.type))}r.error(`Expected arguments of type ${k}, but found (${B.join(", ")}) instead.`)}return null}static register(e,r){al.definitions=r;for(const a in r)e[a]=al}}var Ho=al;class xn{constructor(e,r,a){this.type=Ls,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return r.error("Collator options argument must be an object.");const h=r.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Yi);if(!h)return null;const m=r.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Yi);if(!m)return null;let y=null;return a.locale&&(y=r.parse(a.locale,1,cr),!y)?null:new xn(h,m,y)}evaluate(e){return new sd(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const es=8192;function Vc(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function Xl(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Zl(i,e){const r=(180+i[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(r*h*es),Math.round(a*h*es)]}function Yl(i,e,r){const a=i[0]-e[0],h=i[1]-e[1],m=i[0]-r[0],y=i[1]-r[1];return a*y-m*h==0&&a*m<=0&&h*y<=0}function Nh(i,e){let r=!1;for(let y=0,w=e.length;y<w;y++){const M=e[y];for(let k=0,B=M.length;k<B-1;k++){if(Yl(i,M[k],M[k+1]))return!1;(h=M[k])[1]>(a=i)[1]!=(m=M[k+1])[1]>a[1]&&a[0]<(m[0]-h[0])*(a[1]-h[1])/(m[1]-h[1])+h[0]&&(r=!r)}}var a,h,m;return r}function Kl(i,e){for(let r=0;r<e.length;r++)if(Nh(i,e[r]))return!0;return!1}function Uh(i,e,r,a){const h=a[0]-r[0],m=a[1]-r[1],y=(i[0]-r[0])*m-h*(i[1]-r[1]),w=(e[0]-r[0])*m-h*(e[1]-r[1]);return y>0&&w<0||y<0&&w>0}function Js(i,e,r){for(const k of r)for(let B=0;B<k.length-1;++B)if((w=[(y=k[B+1])[0]-(m=k[B])[0],y[1]-m[1]])[0]*(M=[(h=e)[0]-(a=i)[0],h[1]-a[1]])[1]-w[1]*M[0]!=0&&Uh(a,h,m,y)&&Uh(m,y,a,h))return!0;var a,h,m,y,w,M;return!1}function br(i,e){for(let r=0;r<i.length;++r)if(!Nh(i[r],e))return!1;for(let r=0;r<i.length-1;++r)if(Js(i[r],i[r+1],e))return!1;return!0}function vm(i,e){for(let r=0;r<e.length;r++)if(br(i,e[r]))return!0;return!1}function ll(i,e,r){const a=[];for(let h=0;h<i.length;h++){const m=[];for(let y=0;y<i[h].length;y++){const w=Zl(i[h][y],r);Vc(e,w),m.push(w)}a.push(m)}return a}function cd(i,e,r){const a=[];for(let h=0;h<i.length;h++){const m=ll(i[h],e,r);a.push(m)}return a}function Vh(i,e,r,a){if(i[0]<r[0]||i[0]>r[2]){const h=.5*a;let m=i[0]-r[0]>h?-a:r[0]-i[0]>h?a:0;m===0&&(m=i[0]-r[2]>h?-a:r[2]-i[0]>h?a:0),i[0]+=m}Vc(e,i)}function jh(i,e,r,a){const h=Math.pow(2,a.z)*es,m=[a.x*es,a.y*es],y=[];if(!i)return y;for(const w of i)for(const M of w){const k=[M.x+m[0],M.y+m[1]];Vh(k,e,r,h),y.push(k)}return y}function $h(i,e,r,a){const h=Math.pow(2,a.z)*es,m=[a.x*es,a.y*es],y=[];if(!i)return y;for(const M of i){const k=[];for(const B of M){const U=[B.x+m[0],B.y+m[1]];Vc(e,U),k.push(U)}y.push(k)}if(e[2]-e[0]<=h/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const M of y)for(const k of M)Vh(k,e,r,h)}var w;return y}class Ua{constructor(e,r){this.type=Yi,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Rs(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let h=0;h<a.features.length;++h){const m=a.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ua(a,a.features[h].geometry)}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Ua(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Ua(a,a)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(!y)return!1;if(a.type==="Polygon"){const w=ll(a.coordinates,m,y),M=jh(r.geometry(),h,m,y);if(!Xl(h,m))return!1;for(const k of M)if(!Nh(k,w))return!1}if(a.type==="MultiPolygon"){const w=cd(a.coordinates,m,y),M=jh(r.geometry(),h,m,y);if(!Xl(h,m))return!1;for(const k of M)if(!Kl(k,w))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(!y)return!1;if(a.type==="Polygon"){const w=ll(a.coordinates,m,y),M=$h(r.geometry(),h,m,y);if(!Xl(h,m))return!1;for(const k of M)if(!br(k,w))return!1}if(a.type==="MultiPolygon"){const w=cd(a.coordinates,m,y),M=$h(r.geometry(),h,m,y);if(!Xl(h,m))return!1;for(const k of M)if(!vm(k,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Gh=Ua;function cl(i){if(i instanceof Ho&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Gh)return!1;let e=!0;return i.eachChild(r=>{e&&!cl(r)&&(e=!1)}),e}function wo(i){if(i instanceof Ho&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(r=>{e&&!wo(r)&&(e=!1)}),e}function hl(i,e){if(i instanceof Ho&&e.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(a=>{r&&!hl(a,e)&&(r=!1)}),r}class Wh{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const a=e[1];return r.scope.has(a)?new Wh(a,r.scope.get(a)):r.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var jf=Wh;class jc{constructor(e,r=[],a,h=new Uf,m=[]){this.registry=e,this.path=r,this.key=r.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=m,this.expectedType=a}parse(e,r,a,h,m={}){return r?this.concat(r,a,h)._parse(e,m):this._parse(e,m)}_parse(e,r){function a(h,m,y){return y==="assert"?new ga(m,[h]):y==="coerce"?new ya(m,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,M=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||M.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(w,M))return null}else y=a(y,w,r.typeAnnotation||"coerce");else y=a(y,w,r.typeAnnotation||"assert")}if(!(y instanceof ma)&&y.type.kind!=="resolvedImage"&&$c(y)){const w=new ld;try{y=new ma(y.type,y.evaluate(w))}catch(M){return this.error(M.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,a){const h=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new jc(this.registry,h,r||null,m,this.errors)}error(e,...r){const a=`${this.key}${r.map(h=>`[${h}]`).join("")}`;this.errors.push(new $o(a,e))}checkSubtype(e,r){const a=vo(e,r);return a&&this.error(a),a}}var hd=jc;function $c(i){if(i instanceof jf)return $c(i.boundExpression);if(i instanceof Ho&&i.name==="error"||i instanceof xn||i instanceof Gh)return!1;const e=i instanceof ya||i instanceof ga;let r=!0;return i.eachChild(a=>{r=e?r&&$c(a):r&&a instanceof ma}),!!r&&cl(i)&&hl(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Hh(i,e){const r=i.length-1;let a,h,m=0,y=r,w=0;for(;m<=y;)if(w=Math.floor((m+y)/2),a=i[w],h=i[w+1],a<=e){if(w===r||e<h)return w;m=w+1}else{if(!(a>e))throw new Qn("Input is not a number.");y=w-1}return 0}class qh{constructor(e,r,a){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const a=r.parse(e[1],1,li);if(!a)return null;const h=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let y=1;y<e.length;y+=2){const w=y===1?-1/0:e[y],M=e[y+1],k=y,B=y+1;if(typeof w!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(h.length&&h[h.length-1][0]>=w)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const U=r.parse(M,B,m);if(!U)return null;m=m||U.type,h.push([w,U])}return new qh(m,a,h)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);const m=r.length;return h>=r[m-1]?a[m-1].evaluate(e):a[Hh(r,h)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var ud=qh;function pr(i,e,r){return i*(1-r)+e*r}var qo=Object.freeze({__proto__:null,array:function(i,e,r){return i.map((a,h)=>pr(a,e[h],r))},color:function(i,e,r){return new Sn(pr(i.r,e.r,r),pr(i.g,e.g,r),pr(i.b,e.b,r),pr(i.a,e.a,r))},number:pr});const dd=.95047,Xh=1.08883,$f=4/29,ul=6/29,fd=3*ul*ul,pd=ul*ul*ul,md=Math.PI/180,Zh=180/Math.PI;function Jl(i){return i>pd?Math.pow(i,1/3):i/fd+$f}function gd(i){return i>ul?i*i*i:fd*(i-$f)}function Yh(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function dl(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Va(i){const e=dl(i.r),r=dl(i.g),a=dl(i.b),h=Jl((.4124564*e+.3575761*r+.1804375*a)/dd),m=Jl((.2126729*e+.7151522*r+.072175*a)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-Jl((.0193339*e+.119192*r+.9503041*a)/Xh)),alpha:i.a}}function Gf(i){let e=(i.l+16)/116,r=isNaN(i.a)?e:e+i.a/500,a=isNaN(i.b)?e:e-i.b/200;return e=1*gd(e),r=dd*gd(r),a=Xh*gd(a),new Sn(Yh(3.2404542*r-1.5371385*e-.4985314*a),Yh(-.969266*r+1.8760108*e+.041556*a),Yh(.0556434*r-.2040259*e+1.0572252*a),i.alpha)}function fl(i,e,r){const a=e-i;return i+r*(a>180||a<-180?a-360*Math.round(a/360):a)}const Gc={forward:Va,reverse:Gf,interpolate:function(i,e,r){return{l:pr(i.l,e.l,r),a:pr(i.a,e.a,r),b:pr(i.b,e.b,r),alpha:pr(i.alpha,e.alpha,r)}}},To={forward:function(i){const{l:e,a:r,b:a}=Va(i),h=Math.atan2(a,r)*Zh;return{h:h<0?h+360:h,c:Math.sqrt(r*r+a*a),l:e,alpha:i.a}},reverse:function(i){const e=i.h*md,r=i.c;return Gf({l:i.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:i.alpha})},interpolate:function(i,e,r){return{h:fl(i.h,e.h,r),c:pr(i.c,e.c,r),l:pr(i.l,e.l,r),alpha:pr(i.alpha,e.alpha,r)}}};var pl=Object.freeze({__proto__:null,hcl:To,lab:Gc});class Wc{constructor(e,r,a,h,m){this.type=e,this.operator=r,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[y,w]of m)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(e,r,a,h){let m=0;if(e.name==="exponential")m=Hc(r,e.base,a,h);else if(e.name==="linear")m=Hc(r,1,a,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new rt(y[0],y[1],y[2],y[3]).solve(Hc(r,1,a,h))}return m}static parse(e,r){let[a,h,m,...y]=e;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const k=h[1];if(typeof k!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:k}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const k=h.slice(1);if(k.length!==4||k.some(B=>typeof B!="number"||B<0||B>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,li),!m)return null;const w=[];let M=null;a==="interpolate-hcl"||a==="interpolate-lab"?M=Ps:r.expectedType&&r.expectedType.kind!=="value"&&(M=r.expectedType);for(let k=0;k<y.length;k+=2){const B=y[k],U=y[k+1],G=k+3,X=k+4;if(typeof B!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(w.length&&w[w.length-1][0]>=B)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=r.parse(U,X,M);if(!Y)return null;M=M||Y.type,w.push([B,Y])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Wc(M,a,h,m,w):r.error(`Type ${sn(M)} is not interpolatable.`)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);const m=r.length;if(h>=r[m-1])return a[m-1].evaluate(e);const y=Hh(r,h),w=Wc.interpolationFactor(this.interpolation,h,r[y],r[y+1]),M=a[y].evaluate(e),k=a[y+1].evaluate(e);return this.operator==="interpolate"?qo[this.type.kind.toLowerCase()](M,k,w):this.operator==="interpolate-hcl"?To.reverse(To.interpolate(To.forward(M),To.forward(k),w)):Gc.reverse(Gc.interpolate(Gc.forward(M),Gc.forward(k),w))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)r.push(this.labels[a],this.outputs[a].serialize());return r}}function Hc(i,e,r,a){const h=a-r,m=i-r;return h===0?0:e===1?m/h:(Math.pow(e,m)-1)/(Math.pow(e,h)-1)}var Qs=Wc;class Kh{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let a=null;const h=r.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const w of e.slice(1)){const M=r.parse(w,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!M)return null;a=a||M.type,m.push(M)}const y=h&&m.some(w=>vo(h,w.type));return new Kh(y?Ki:a,m)}evaluate(e){let r,a=null,h=0;for(const m of this.args){if(h++,a=m.evaluate(e),a&&a instanceof Ts&&!a.available&&(r||(r=a),a=null,h===this.args.length))return r;if(a!==null)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var _d=Kh;class Jh{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=r.parse(e[m+1],m+1);if(!w)return null;a.push([y,w])}const h=r.parse(e[e.length-1],e.length-1,r.expectedType,a);return h?new Jh(a,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,a]of this.bindings)e.push(r,a.serialize());return e.push(this.result.serialize()),e}}var qc=Jh;class yd{constructor(e,r,a){this.type=e,this.index=r,this.input=a}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,li),h=r.parse(e[2],2,Ks(r.expectedType||Ki));return a&&h?new yd(h.type.itemType,a,h):null}evaluate(e){const r=this.index.evaluate(e),a=this.input.evaluate(e);if(r<0)throw new Qn(`Array index out of bounds: ${r} < 0.`);if(r>=a.length)throw new Qn(`Array index out of bounds: ${r} > ${a.length-1}.`);if(r!==Math.floor(r))throw new Qn(`Array index must be an integer, but found ${r} instead.`);return a[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var bm=yd;class xd{constructor(e,r){this.type=Yi,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Ki),h=r.parse(e[2],2,Ki);return a&&h?Na(a.type,[Yi,cr,li,Gl,Ki])?new xd(a,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${sn(a.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(a==null)return!1;if(!Fc(r,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${sn(yn(r))} instead.`);if(!Fc(a,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${sn(yn(a))} instead.`);return a.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Eo=xd;class Xc{constructor(e,r,a){this.type=li,this.needle=e,this.haystack=r,this.fromIndex=a}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Ki),h=r.parse(e[2],2,Ki);if(!a||!h)return null;if(!Na(a.type,[Yi,cr,li,Gl,Ki]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${sn(a.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,li);return m?new Xc(a,h,m):null}return new Xc(a,h)}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!Fc(r,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${sn(yn(r))} instead.`);if(!Fc(a,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${sn(yn(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(r,h)}return a.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var vd=Xc;class bd{constructor(e,r,a,h,m,y){this.inputType=e,this.type=r,this.input=a,this.cases=h,this.outputs=m,this.otherwise=y}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let a,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const m={},y=[];for(let k=2;k<e.length-1;k+=2){let B=e[k];const U=e[k+1];Array.isArray(B)||(B=[B]);const G=r.concat(k);if(B.length===0)return G.error("Expected at least one branch label.");for(const Y of B){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(a){if(G.checkSubtype(a,yn(Y)))return null}else a=yn(Y);if(m[String(Y)]!==void 0)return G.error("Branch labels must be unique.");m[String(Y)]=y.length}const X=r.parse(U,k,h);if(!X)return null;h=h||X.type,y.push(X)}const w=r.parse(e[1],1,Ki);if(!w)return null;const M=r.parse(e[e.length-1],e.length-1,h);return M?w.type.kind!=="value"&&r.concat(1).checkSubtype(a,w.type)?null:new bd(a,h,w,m,y,M):null}evaluate(e){const r=this.input.evaluate(e);return(yn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),a=[],h={};for(const y of r){const w=h[this.cases[y]];w===void 0?(h[this.cases[y]]=a.length,a.push([this.cases[y],[y]])):a[w][1].push(y)}const m=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,w]of a)e.push(w.length===1?m(w[0]):w.map(m)),e.push(this.outputs[y].serialize());return e.push(this.otherwise.serialize()),e}}var wm=bd;class Ql{constructor(e,r,a){this.type=e,this.branches=r,this.otherwise=a}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const w=r.parse(e[y],y,Yi);if(!w)return null;const M=r.parse(e[y+1],y+1,a);if(!M)return null;h.push([w,M]),a=a||M.type}const m=r.parse(e[e.length-1],e.length-1,a);return m?new Ql(a,h,m):null}evaluate(e){for(const[r,a]of this.branches)if(r.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,a]of this.branches)e(r),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Wf=Ql;class Zc{constructor(e,r,a,h){this.type=e,this.input=r,this.beginIndex=a,this.endIndex=h}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Ki),h=r.parse(e[2],2,li);if(!a||!h)return null;if(!Na(a.type,[Ks(Ki),cr,Ki]))return r.error(`Expected first argument to be of type array or string, but found ${sn(a.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,li);return m?new Zc(a.type,a,h,m):null}return new Zc(a.type,a,h)}evaluate(e){const r=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!Fc(r,["string","array"]))throw new Qn(`Expected first argument to be of type array or string, but found ${sn(yn(r))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return r.slice(a,h)}return r.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var wd=Zc;function Qh(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function ml(i,e,r,a){return a.compare(e,r)===0}function eo(i,e,r){const a=i!=="=="&&i!=="!=";return class XA{constructor(m,y,w){this.type=Yi,this.lhs=m,this.rhs=y,this.collator=w,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const w=m[0];let M=y.parse(m[1],1,Ki);if(!M)return null;if(!Qh(w,M.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${sn(M.type)}'.`);let k=y.parse(m[2],2,Ki);if(!k)return null;if(!Qh(w,k.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${sn(k.type)}'.`);if(M.type.kind!==k.type.kind&&M.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${sn(M.type)}' and '${sn(k.type)}'.`);a&&(M.type.kind==="value"&&k.type.kind!=="value"?M=new ga(k.type,[M]):M.type.kind!=="value"&&k.type.kind==="value"&&(k=new ga(M.type,[k])));let B=null;if(m.length===4){if(M.type.kind!=="string"&&k.type.kind!=="string"&&M.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(B=y.parse(m[3],3,Ls),!B)return null}return new XA(M,k,B)}evaluate(m){const y=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const M=yn(y),k=yn(w);if(M.kind!==k.kind||M.kind!=="string"&&M.kind!=="number")throw new Qn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${M.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const M=yn(y),k=yn(w);if(M.kind!=="string"||k.kind!=="string")return e(m,y,w)}return this.collator?r(m,y,w,this.collator.evaluate(m)):e(m,y,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[i];return this.eachChild(y=>{m.push(y.serialize())}),m}}}const Tm=eo("==",function(i,e,r){return e===r},ml),Em=eo("!=",function(i,e,r){return e!==r},function(i,e,r,a){return!ml(0,e,r,a)}),Sm=eo("<",function(i,e,r){return e<r},function(i,e,r,a){return a.compare(e,r)<0}),Cm=eo(">",function(i,e,r){return e>r},function(i,e,r,a){return a.compare(e,r)>0}),Am=eo("<=",function(i,e,r){return e<=r},function(i,e,r,a){return a.compare(e,r)<=0}),Yc=eo(">=",function(i,e,r){return e>=r},function(i,e,r,a){return a.compare(e,r)>=0});class ec{constructor(e,r,a,h,m,y){this.type=cr,this.number=e,this.locale=r,this.currency=a,this.unit=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const a=r.parse(e[1],1,li);if(!a)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=r.parse(h.locale,1,cr),!m))return null;let y=null;if(h.currency&&(y=r.parse(h.currency,1,cr),!y))return null;let w=null;if(h.unit&&(w=r.parse(h.unit,1,cr),!w))return null;let M=null;if(h["min-fraction-digits"]&&(M=r.parse(h["min-fraction-digits"],1,li),!M))return null;let k=null;return h["max-fraction-digits"]&&(k=r.parse(h["max-fraction-digits"],1,li),!k)?null:new ec(a,m,y,w,M,k)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class tc{constructor(e){this.type=li,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=r.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${sn(a.type)} instead.`):new tc(a):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Qn(`Expected value to be of type string or array, but found ${sn(yn(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const Kc={"==":Tm,"!=":Em,">":Cm,"<":Sm,">=":Yc,"<=":Am,array:ga,at:bm,boolean:ga,case:Wf,coalesce:_d,collator:xn,format:_a,image:Hl,in:Eo,"index-of":vd,interpolate:Qs,"interpolate-hcl":Qs,"interpolate-lab":Qs,length:tc,let:qc,literal:ma,match:wm,number:ga,"number-format":ec,object:ga,slice:wd,step:ud,string:ga,"to-boolean":ya,"to-color":ya,"to-number":ya,"to-string":ya,var:jf,within:Gh};function eu(i,[e,r,a,h]){e=e.evaluate(i),r=r.evaluate(i),a=a.evaluate(i);const m=h?h.evaluate(i):1,y=od(e,r,a,m);if(y)throw new Qn(y);return new Sn(e/255*m,r/255*m,a/255*m,m)}function xa(i,e){return i in e}function Jc(i,e){const r=e[i];return r===void 0?null:r}function fs(i){return{type:i}}Ho.register(Kc,{error:[{kind:"error"},[cr],(i,[e])=>{throw new Qn(e.evaluate(i))}],typeof:[cr,[Ki],(i,[e])=>sn(yn(e.evaluate(i)))],"to-rgba":[Ks(li,4),[Ps],(i,[e])=>e.evaluate(i).toArray()],rgb:[Ps,[li,li,li],eu],rgba:[Ps,[li,li,li,li],eu],has:{type:Yi,overloads:[[[cr],(i,[e])=>xa(e.evaluate(i),i.properties())],[[cr,Ys],(i,[e,r])=>xa(e.evaluate(i),r.evaluate(i))]]},get:{type:Ki,overloads:[[[cr],(i,[e])=>Jc(e.evaluate(i),i.properties())],[[cr,Ys],(i,[e,r])=>Jc(e.evaluate(i),r.evaluate(i))]]},"feature-state":[Ki,[cr],(i,[e])=>Jc(e.evaluate(i),i.featureState||{})],properties:[Ys,[],i=>i.properties()],"geometry-type":[cr,[],i=>i.geometryType()],id:[Ki,[],i=>i.id()],zoom:[li,[],i=>i.globals.zoom],pitch:[li,[],i=>i.globals.pitch||0],"distance-from-center":[li,[],i=>i.distanceFromCenter()],"heatmap-density":[li,[],i=>i.globals.heatmapDensity||0],"line-progress":[li,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[li,[],i=>i.globals.skyRadialProgress||0],accumulated:[Ki,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[li,fs(li),(i,e)=>{let r=0;for(const a of e)r+=a.evaluate(i);return r}],"*":[li,fs(li),(i,e)=>{let r=1;for(const a of e)r*=a.evaluate(i);return r}],"-":{type:li,overloads:[[[li,li],(i,[e,r])=>e.evaluate(i)-r.evaluate(i)],[[li],(i,[e])=>-e.evaluate(i)]]},"/":[li,[li,li],(i,[e,r])=>e.evaluate(i)/r.evaluate(i)],"%":[li,[li,li],(i,[e,r])=>e.evaluate(i)%r.evaluate(i)],ln2:[li,[],()=>Math.LN2],pi:[li,[],()=>Math.PI],e:[li,[],()=>Math.E],"^":[li,[li,li],(i,[e,r])=>Math.pow(e.evaluate(i),r.evaluate(i))],sqrt:[li,[li],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[li,[li],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[li,[li],(i,[e])=>Math.log(e.evaluate(i))],log2:[li,[li],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[li,[li],(i,[e])=>Math.sin(e.evaluate(i))],cos:[li,[li],(i,[e])=>Math.cos(e.evaluate(i))],tan:[li,[li],(i,[e])=>Math.tan(e.evaluate(i))],asin:[li,[li],(i,[e])=>Math.asin(e.evaluate(i))],acos:[li,[li],(i,[e])=>Math.acos(e.evaluate(i))],atan:[li,[li],(i,[e])=>Math.atan(e.evaluate(i))],min:[li,fs(li),(i,e)=>Math.min(...e.map(r=>r.evaluate(i)))],max:[li,fs(li),(i,e)=>Math.max(...e.map(r=>r.evaluate(i)))],abs:[li,[li],(i,[e])=>Math.abs(e.evaluate(i))],round:[li,[li],(i,[e])=>{const r=e.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[li,[li],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[li,[li],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Yi,[cr,Ki],(i,[e,r])=>i.properties()[e.value]===r.value],"filter-id-==":[Yi,[Ki],(i,[e])=>i.id()===e.value],"filter-type-==":[Yi,[cr],(i,[e])=>i.geometryType()===e.value],"filter-<":[Yi,[cr,Ki],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a<h}],"filter-id-<":[Yi,[Ki],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r<a}],"filter->":[Yi,[cr,Ki],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a>h}],"filter-id->":[Yi,[Ki],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r>a}],"filter-<=":[Yi,[cr,Ki],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[Yi,[Ki],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r<=a}],"filter->=":[Yi,[cr,Ki],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[Yi,[Ki],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r>=a}],"filter-has":[Yi,[Ki],(i,[e])=>e.value in i.properties()],"filter-has-id":[Yi,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Yi,[Ks(cr)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Yi,[Ks(Ki)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Yi,[cr,Ks(Ki)],(i,[e,r])=>r.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Yi,[cr,Ks(Ki)],(i,[e,r])=>function(a,h,m,y){for(;m<=y;){const w=m+y>>1;if(h[w]===a)return!0;h[w]>a?y=w-1:m=w+1}return!1}(i.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Yi,overloads:[[[Yi,Yi],(i,[e,r])=>e.evaluate(i)&&r.evaluate(i)],[fs(Yi),(i,e)=>{for(const r of e)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Yi,overloads:[[[Yi,Yi],(i,[e,r])=>e.evaluate(i)||r.evaluate(i)],[fs(Yi),(i,e)=>{for(const r of e)if(r.evaluate(i))return!0;return!1}]]},"!":[Yi,[Yi],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Yi,[cr],(i,[e])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(e.evaluate(i))}],upcase:[cr,[cr],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[cr,[cr],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[cr,fs(Ki),(i,e)=>e.map(r=>pa(r.evaluate(i))).join("")],"resolved-locale":[cr,[Ls],(i,[e])=>e.evaluate(i).resolvedLocale()]});var Qc=Kc;function eh(i){return{result:"success",value:i}}function gl(i){return{result:"error",value:i}}function ic(i){return i["property-type"]==="data-driven"}function $s(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function va(i){return!!i.expression&&i.expression.interpolated}function xr(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function rc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Hf(i){return i}function nc(i,e){const r=e.type==="color",a=i.stops&&typeof i.stops[0][0]=="object",h=a||!(a||i.property!==void 0),m=i.type||(va(e)?"exponential":"interval");if(r&&((i=jo({},i)).stops&&(i.stops=i.stops.map(k=>[k[0],Sn.parse(k[1])])),i.default=Sn.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!pl[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let y,w,M;if(m==="exponential")y=ba;else if(m==="interval")y=th;else if(m==="categorical"){y=qf,w=Object.create(null);for(const k of i.stops)w[k[0]]=k[1];M=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);y=tu}if(a){const k={},B=[];for(let X=0;X<i.stops.length;X++){const Y=i.stops[X],ie=Y[0].zoom;k[ie]===void 0&&(k[ie]={zoom:ie,type:i.type,property:i.property,default:i.default,stops:[]},B.push(ie)),k[ie].stops.push([Y[0].value,Y[1]])}const U=[];for(const X of B)U.push([k[X].zoom,nc(k[X],e)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:Qs.interpolationFactor.bind(void 0,G),zoomStops:U.map(X=>X[0]),evaluate:({zoom:X},Y)=>ba({stops:U,base:i.base},e,X).evaluate(X,Y)}}if(h){const k=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Qs.interpolationFactor.bind(void 0,k),zoomStops:i.stops.map(B=>B[0]),evaluate:({zoom:B})=>y(i,e,B,w,M)}}return{kind:"source",evaluate(k,B){const U=B&&B.properties?B.properties[i.property]:void 0;return U===void 0?sc(i.default,e.default):y(i,e,U,w,M)}}}function sc(i,e,r){return i!==void 0?i:e!==void 0?e:r!==void 0?r:void 0}function qf(i,e,r,a,h){return sc(typeof r===h?a[r]:void 0,i.default,e.default)}function th(i,e,r){if(xr(r)!=="number")return sc(i.default,e.default);const a=i.stops.length;if(a===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[a-1][0])return i.stops[a-1][1];const h=Hh(i.stops.map(m=>m[0]),r);return i.stops[h][1]}function ba(i,e,r){const a=i.base!==void 0?i.base:1;if(xr(r)!=="number")return sc(i.default,e.default);const h=i.stops.length;if(h===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[h-1][0])return i.stops[h-1][1];const m=Hh(i.stops.map(B=>B[0]),r),y=function(B,U,G,X){const Y=X-G,ie=B-G;return Y===0?0:U===1?ie/Y:(Math.pow(U,ie)-1)/(Math.pow(U,Y)-1)}(r,a,i.stops[m][0],i.stops[m+1][0]),w=i.stops[m][1],M=i.stops[m+1][1];let k=qo[e.type]||Hf;if(i.colorSpace&&i.colorSpace!=="rgb"){const B=pl[i.colorSpace];k=(U,G)=>B.reverse(B.interpolate(B.forward(U),B.forward(G),y))}return typeof w.evaluate=="function"?{evaluate(...B){const U=w.evaluate.apply(void 0,B),G=M.evaluate.apply(void 0,B);if(U!==void 0&&G!==void 0)return k(U,G,y)}}:k(w,M,y)}function tu(i,e,r){return e.type==="color"?r=Sn.parse(r):e.type==="formatted"?r=Os.fromString(r.toString()):e.type==="resolvedImage"?r=Ts.fromString(r.toString()):xr(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),sc(r,i.default,e.default)}class ps{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new ld,this._defaultValue=r?function(a){return a.type==="color"&&(rc(a.default)||Array.isArray(a.default))?new Sn(0,0,0,0):a.type==="color"?Sn.parse(a.default)||null:a.default===void 0?null:a.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,a,h,m,y,w,M){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=a,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,a,h,m,y,w,M){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=M||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Qn(`Expected value to be one of ${Object.keys(this._enumValues).map(B=>JSON.stringify(B)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Cr(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Qc}function oc(i,e){const r=new hd(Qc,[],e?function(h){const m={color:Ps,string:cr,number:li,enum:cr,boolean:Yi,formatted:ds,resolvedImage:xo};return h.type==="array"?Ks(m[h.value]||Ki,h.length):m[h.type]}(e):void 0),a=r.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?eh(new ps(a,e)):gl(r.errors)}class iu{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!wo(r.expression)}evaluateWithoutErrorHandling(e,r,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,m,y)}evaluate(e,r,a,h,m,y){return this._styleExpression.evaluate(e,r,a,h,m,y)}}class _l{constructor(e,r,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!wo(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,r,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,m,y)}evaluate(e,r,a,h,m,y){return this._styleExpression.evaluate(e,r,a,h,m,y)}interpolationFactor(e,r,a){return this.interpolationType?Qs.interpolationFactor(this.interpolationType,e,r,a):0}}function ja(i,e){if((i=oc(i,e)).result==="error")return i;const r=i.value.expression,a=cl(r);if(!a&&!ic(e))return gl([new $o("","data expressions not supported")]);const h=hl(r,["zoom","pitch","distance-from-center"]);if(!h&&!$s(e))return gl([new $o("","zoom expressions not supported")]);const m=ih(r);return m||h?m instanceof $o?gl([m]):m instanceof Qs&&!va(e)?gl([new $o("",'"interpolate" expressions cannot be used with this property')]):eh(m?new _l(a?"camera":"composite",i.value,m.labels,m instanceof Qs?m.interpolation:void 0):new iu(a?"constant":"source",i.value)):gl([new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xr{constructor(e,r){this._parameters=e,this._specification=r,jo(this,nc(this._parameters,this._specification))}static deserialize(e){return new Xr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ih(i){let e=null;if(i instanceof qc)e=ih(i.result);else if(i instanceof _d){for(const r of i.args)if(e=ih(r),e)break}else(i instanceof ud||i instanceof Qs)&&i.input instanceof Ho&&i.input.name==="zoom"&&(e=i);return e instanceof $o||i.eachChild(r=>{const a=ih(r);a instanceof $o?e=a:!e&&a?e=new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new $o("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class ui{constructor(e,r,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function to(i){const e=i.key,r=i.value,a=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,y=i.styleSpec;let w=[];const M=xr(r);if(M!=="object")return[new ui(e,r,`object expected, ${M} found`)];for(const k in r){const B=k.split(".")[0];let U;h[B]?U=h[B]:a[B]?U=ms:h["*"]?U=h["*"]:a["*"]&&(U=ms),U?w=w.concat(U({key:(e&&`${e}.`)+k,value:r[k],valueSpec:a[B]||a["*"],style:m,styleSpec:y,object:r,objectKey:k},r)):w.push(new ui(e,r[k],`unknown property "${k}"`))}for(const k in a)h[k]||a[k].required&&a[k].default===void 0&&r[k]===void 0&&w.push(new ui(e,r,`missing required property "${k}"`));return w}function Bi(i){const e=i.value,r=i.valueSpec,a=i.style,h=i.styleSpec,m=i.key,y=i.arrayElementValidator||ms;if(xr(e)!=="array")return[new ui(m,e,`array expected, ${xr(e)} found`)];if(r.length&&e.length!==r.length)return[new ui(m,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new ui(m,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let w={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};h.$version<7&&(w.function=r.function),xr(r.value)==="object"&&(w=r.value);let M=[];for(let k=0;k<e.length;k++)M=M.concat(y({array:e,arrayIndex:k,value:e[k],valueSpec:w,style:a,styleSpec:h,key:`${m}[${k}]`}));return M}function ac(i){const e=i.key,r=i.value,a=i.valueSpec;let h=xr(r);if(h==="number"&&r!=r&&(h="NaN"),h!=="number")return[new ui(e,r,`number expected, ${h} found`)];if("minimum"in a){let m=a.minimum;if(xr(a.minimum)==="array"&&(m=a.minimum[i.arrayIndex]),r<m)return[new ui(e,r,`${r} is less than the minimum value ${m}`)]}if("maximum"in a){let m=a.maximum;if(xr(a.maximum)==="array"&&(m=a.maximum[i.arrayIndex]),r>m)return[new ui(e,r,`${r} is greater than the maximum value ${m}`)]}return[]}function $a(i){const e=i.valueSpec,r=Bn(i.value.type);let a,h,m,y={};const w=r!=="categorical"&&i.value.property===void 0,M=!w,k=xr(i.value.stops)==="array"&&xr(i.value.stops[0])==="array"&&xr(i.value.stops[0][0])==="object",B=to({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(X){if(r==="identity")return[new ui(X.key,X.value,'identity function may not have a "stops" property')];let Y=[];const ie=X.value;return Y=Y.concat(Bi({key:X.key,value:ie,valueSpec:X.valueSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:U})),xr(ie)==="array"&&ie.length===0&&Y.push(new ui(X.key,ie,"array must have at least one stop")),Y},default:function(X){return ms({key:X.key,value:X.value,valueSpec:e,style:X.style,styleSpec:X.styleSpec})}}});return r==="identity"&&w&&B.push(new ui(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||B.push(new ui(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!va(i.valueSpec)&&B.push(new ui(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(M&&!ic(i.valueSpec)?B.push(new ui(i.key,i.value,"property functions not supported")):w&&!$s(i.valueSpec)&&B.push(new ui(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!k||i.value.property!==void 0||B.push(new ui(i.key,i.value,'"property" property is required')),B;function U(X){let Y=[];const ie=X.value,de=X.key;if(xr(ie)!=="array")return[new ui(de,ie,`array expected, ${xr(ie)} found`)];if(ie.length!==2)return[new ui(de,ie,`array length 2 expected, length ${ie.length} found`)];if(k){if(xr(ie[0])!=="object")return[new ui(de,ie,`object expected, ${xr(ie[0])} found`)];if(ie[0].zoom===void 0)return[new ui(de,ie,"object stop key must have zoom")];if(ie[0].value===void 0)return[new ui(de,ie,"object stop key must have value")];const Ee=Bn(ie[0].zoom);if(typeof Ee!="number")return[new ui(de,ie[0].zoom,"stop zoom values must be numbers")];if(m&&m>Ee)return[new ui(de,ie[0].zoom,"stop zoom values must appear in ascending order")];Ee!==m&&(m=Ee,h=void 0,y={}),Y=Y.concat(to({key:`${de}[0]`,value:ie[0],valueSpec:{zoom:{}},style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:ac,value:G}}))}else Y=Y.concat(G({key:`${de}[0]`,value:ie[0],style:X.style,styleSpec:X.styleSpec},ie));return Cr(Jn(ie[1]))?Y.concat([new ui(`${de}[1]`,ie[1],"expressions are not allowed in function stops.")]):Y.concat(ms({key:`${de}[1]`,value:ie[1],valueSpec:e,style:X.style,styleSpec:X.styleSpec}))}function G(X,Y){const ie=xr(X.value),de=Bn(X.value),Ee=X.value!==null?X.value:Y;if(a){if(ie!==a)return[new ui(X.key,Ee,`${ie} stop domain type must match previous stop domain type ${a}`)]}else a=ie;if(ie!=="number"&&ie!=="string"&&ie!=="boolean"&&typeof de!="number"&&typeof de!="string"&&typeof de!="boolean")return[new ui(X.key,Ee,"stop domain value must be a number, string, or boolean")];if(ie!=="number"&&r!=="categorical"){let Re=`number expected, ${ie} found`;return ic(e)&&r===void 0&&(Re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ui(X.key,Ee,Re)]}return r!=="categorical"||ie!=="number"||typeof de=="number"&&isFinite(de)&&Math.floor(de)===de?r!=="categorical"&&ie==="number"&&typeof de=="number"&&typeof h=="number"&&h!==void 0&&de<h?[new ui(X.key,Ee,"stop domain values must appear in ascending order")]:(h=de,r==="categorical"&&de in y?[new ui(X.key,Ee,"stop domain values must be unique")]:(y[de]=!0,[])):[new ui(X.key,Ee,`integer expected, found ${String(de)}`)]}}function ts(i){const e=(i.expressionContext==="property"?ja:oc)(Jn(i.value),i.valueSpec);if(e.result==="error")return e.value.map(a=>new ui(`${i.key}${a.key}`,i.value,a.message));const r=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new ui(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!wo(r))return[new ui(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return Ga(r,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!hl(r,["zoom","feature-state"]))return[new ui(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!cl(r))return[new ui(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ga(i,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)r.delete(h);if(r.size===0)return[];const a=[];return i instanceof Ho&&r.has(i.name)?[new ui(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(h=>{a.push(...Ga(h,e))}),a)}function ir(i){const e=i.key,r=i.value,a=i.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(Bn(r))===-1&&h.push(new ui(e,r,`expected one of [${a.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(a.values).indexOf(Bn(r))===-1&&h.push(new ui(e,r,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function lc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!lc(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function ru(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};lc(i)||(i=cc(i));const r=i;let a=!0;try{a=function(k){if(!yl(k))return k;let B=Jn(k);return nu(B),B=Xf(B),B}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const h=Et[`filter_${e}`],m=oc(a,h);let y=null;if(m.result==="error")throw new Error(m.value.map(k=>`${k.key}: ${k.message}`).join(", "));y=(k,B,U)=>m.value.evaluate(k,B,{},U);let w=null,M=null;if(a!==r){const k=oc(r,h);if(k.result==="error")throw new Error(k.value.map(B=>`${B.key}: ${B.message}`).join(", "));w=(B,U,G,X,Y)=>k.value.evaluate(B,U,{},G,void 0,void 0,X,Y),M=!cl(k.value.expression)}return{filter:y,dynamicFilter:w||void 0,needGeometry:Zf(a),needFeature:!!M}}function Xf(i){if(!Array.isArray(i))return i;const e=function(r){if(Wa.has(r[0])){for(let a=1;a<r.length;a++)if(yl(r[a]))return!0}return r}(i);return e===!0?e:e.map(r=>Xf(r))}function nu(i){let e=!1;const r=[];if(i[0]==="case"){for(let a=1;a<i.length-1;a+=2)e=e||yl(i[a]),r.push(i[a+1]);r.push(i[i.length-1])}else if(i[0]==="match"){e=e||yl(i[1]);for(let a=2;a<i.length-1;a+=2)r.push(i[a+1]);r.push(i[i.length-1])}else if(i[0]==="step"){e=e||yl(i[1]);for(let a=1;a<i.length-1;a+=2)r.push(i[a+1])}e&&(i.length=0,i.push("any",...r));for(let a=1;a<i.length;a++)nu(i[a])}function yl(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let r=1;r<i.length;r++)if(yl(i[r]))return!0;return!1}const Wa=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Mm(i,e){return i<e?-1:i>e?1:0}function Zf(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Zf(i[e]))return!0;return!1}function cc(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?hc(i[1],i[2],"=="):e==="!="?ou(hc(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?hc(i[1],i[2],e):e==="any"?(r=i.slice(1),["any"].concat(r.map(cc))):e==="all"?["all"].concat(i.slice(1).map(cc)):e==="none"?["all"].concat(i.slice(1).map(cc).map(ou)):e==="in"?Td(i[1],i.slice(2)):e==="!in"?ou(Td(i[1],i.slice(2))):e==="has"?su(i[1]):e==="!has"?ou(su(i[1])):e!=="within"||i;var r}function hc(i,e,r){switch(i){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,i,e]}}function Td(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",i,["literal",e.sort(Mm)]]:["filter-in-small",i,["literal",e]]}}function su(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function ou(i){return["!",i]}function rh(i){return lc(Jn(i.value))?ts(jo({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):nh(i)}function nh(i){const e=i.value,r=i.key;if(xr(e)!=="array")return[new ui(r,e,`array expected, ${xr(e)} found`)];const a=i.styleSpec;let h,m=[];if(e.length<1)return[new ui(r,e,"filter array must have at least 1 element")];switch(m=m.concat(ir({key:`${r}[0]`,value:e[0],valueSpec:a.filter_operator,style:i.style,styleSpec:i.styleSpec})),Bn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Bn(e[1])==="$type"&&m.push(new ui(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new ui(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=xr(e[1]),h!=="string"&&m.push(new ui(`${r}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=xr(e[y]),Bn(e[1])==="$type"?m=m.concat(ir({key:`${r}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new ui(`${r}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(nh({key:`${r}[${y}]`,value:e[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=xr(e[1]),e.length!==2?m.push(new ui(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new ui(`${r}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=xr(e[1]),e.length!==2?m.push(new ui(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&m.push(new ui(`${r}[1]`,e[1],`object expected, ${h} found`))}return m}function Ed(i,e){const r=i.key,a=i.style,h=i.styleSpec,m=i.value,y=i.objectKey,w=h[`${e}_${i.layerType}`];if(!w)return[];const M=y.match(/^(.*)-transition$/);if(e==="paint"&&M&&w[M[1]]&&w[M[1]].transition)return ms({key:r,value:m,valueSpec:h.transition,style:a,styleSpec:h});const k=i.valueSpec||w[y];if(!k)return[new ui(r,m,`unknown property "${y}"`)];let B;if(xr(m)==="string"&&ic(k)&&!k.tokens&&(B=/^{([^}]+)}$/.exec(m))){const G=`\`{ "type": "identity", "property": ${B?JSON.stringify(B[1]):'"_"'} }\``;return[new ui(r,m,`"${y}" does not support interpolation syntax
Use an identity property function instead: ${G}.`)]}const U=[];return i.layerType==="symbol"&&(y==="text-field"&&a&&!a.glyphs&&U.push(new ui(r,m,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&rc(Jn(m))&&Bn(m.type)==="identity"&&U.push(new ui(r,m,'"text-font" does not support identity functions'))),U.concat(ms({key:i.key,value:m,valueSpec:k,style:a,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:y}))}function Yf(i){return Ed(i,"paint")}function au(i){return Ed(i,"layout")}function Kf(i){let e=[];const r=i.value,a=i.key,h=i.style,m=i.styleSpec;r.type||r.ref||e.push(new ui(a,r,'either "type" or "ref" is required'));let y=Bn(r.type);const w=Bn(r.ref);if(r.id){const M=Bn(r.id);for(let k=0;k<i.arrayIndex;k++){const B=h.layers[k];Bn(B.id)===M&&e.push(new ui(a,r.id,`duplicate layer id "${r.id}", previously used at line ${B.id.__line__}`))}}if("ref"in r){let M;["type","source","source-layer","filter","layout"].forEach(k=>{k in r&&e.push(new ui(a,r[k],`"${k}" is prohibited for ref layers`))}),h.layers.forEach(k=>{Bn(k.id)===w&&(M=k)}),M?M.ref?e.push(new ui(a,r.ref,"ref cannot reference another ref layer")):y=Bn(M.type):typeof w=="string"&&e.push(new ui(a,r.ref,`ref layer "${w}" not found`))}else if(y!=="background"&&y!=="sky")if(r.source){const M=h.sources&&h.sources[r.source],k=M&&Bn(M.type);M?k==="vector"&&y==="raster"?e.push(new ui(a,r.source,`layer "${r.id}" requires a raster source`)):k==="raster"&&y!=="raster"?e.push(new ui(a,r.source,`layer "${r.id}" requires a vector source`)):k!=="vector"||r["source-layer"]?k==="raster-dem"&&y!=="hillshade"?e.push(new ui(a,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||k==="geojson"&&M.lineMetrics||e.push(new ui(a,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ui(a,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new ui(a,r.source,`source "${r.source}" not found`))}else e.push(new ui(a,r,'missing required property "source"'));return e=e.concat(to({key:a,value:r,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ms({key:`${a}.type`,value:r.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:M=>rh(jo({layerType:y},M)),layout:M=>to({layer:r,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":k=>au(jo({layerType:y},k))}}),paint:M=>to({layer:r,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":k=>Yf(jo({layerType:y},k))}})}})),e}function Ha(i){const e=i.value,r=i.key,a=xr(e);return a!=="string"?[new ui(r,e,`string expected, ${a} found`)]:[]}const Sd={promoteId:function({key:i,value:e}){if(xr(e)==="string")return Ha({key:i,value:e});{const r=[];for(const a in e)r.push(...Ha({key:`${i}.${a}`,value:e[a]}));return r}}};function Cd(i){const e=i.value,r=i.key,a=i.styleSpec,h=i.style;if(!e.type)return[new ui(r,e,'"type" is required')];const m=Bn(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=to({key:r,value:e,valueSpec:a[`source_${m.replace("-","_")}`],style:i.style,styleSpec:a,objectElementValidators:Sd}),y;case"geojson":if(y=to({key:r,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,objectElementValidators:Sd}),e.cluster)for(const w in e.clusterProperties){const[M,k]=e.clusterProperties[w],B=typeof M=="string"?[M,["accumulated"],["get",w]]:M;y.push(...ts({key:`${r}.${w}.map`,value:k,expressionContext:"cluster-map"})),y.push(...ts({key:`${r}.${w}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return y;case"video":return to({key:r,value:e,valueSpec:a.source_video,style:h,styleSpec:a});case"image":return to({key:r,value:e,valueSpec:a.source_image,style:h,styleSpec:a});case"canvas":return[new ui(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ir({key:`${r}.type`,value:e.type,valueSpec:{values:Xo(a)}})}}function Xo(i){return i.source.reduce((e,r)=>{const a=i[r];return a.type.type==="enum"&&(e=e.concat(Object.keys(a.type.values))),e},[])}function Jf(i){const e=i.value,r=i.styleSpec,a=r.light,h=i.style;let m=[];const y=xr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new ui("light",e,`object expected, ${y} found`)]),m;for(const w in e){const M=w.match(/^(.*)-transition$/);m=m.concat(M&&a[M[1]]&&a[M[1]].transition?ms({key:w,value:e[w],valueSpec:r.transition,style:h,styleSpec:r}):a[w]?ms({key:w,value:e[w],valueSpec:a[w],style:h,styleSpec:r}):[new ui(w,e[w],`unknown property "${w}"`)])}return m}function Ad(i){const e=i.value,r=i.key,a=i.style,h=i.styleSpec,m=h.terrain;let y=[];const w=xr(e);if(e===void 0)return y;if(w!=="object")return y=y.concat([new ui("terrain",e,`object expected, ${w} found`)]),y;for(const M in e){const k=M.match(/^(.*)-transition$/);y=y.concat(k&&m[k[1]]&&m[k[1]].transition?ms({key:M,value:e[M],valueSpec:h.transition,style:a,styleSpec:h}):m[M]?ms({key:M,value:e[M],valueSpec:m[M],style:a,styleSpec:h}):[new ui(M,e[M],`unknown property "${M}"`)])}if(e.source){const M=a.sources&&a.sources[e.source],k=M&&Bn(M.type);M?k!=="raster-dem"&&y.push(new ui(r,e.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):y.push(new ui(r,e.source,`source "${e.source}" not found`))}else y.push(new ui(r,e,'terrain is missing required property "source"'));return y}function Qf(i){const e=i.value,r=i.style,a=i.styleSpec,h=a.fog;let m=[];const y=xr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new ui("fog",e,`object expected, ${y} found`)]),m;for(const w in e){const M=w.match(/^(.*)-transition$/);m=m.concat(M&&h[M[1]]&&h[M[1]].transition?ms({key:w,value:e[w],valueSpec:a.transition,style:r,styleSpec:a}):h[w]?ms({key:w,value:e[w],valueSpec:h[w],style:r,styleSpec:a}):[new ui(w,e[w],`unknown property "${w}"`)])}return m}const Md={"*":()=>[],array:Bi,boolean:function(i){const e=i.value,r=i.key,a=xr(e);return a!=="boolean"?[new ui(r,e,`boolean expected, ${a} found`)]:[]},number:ac,color:function(i){const e=i.key,r=i.value,a=xr(r);return a!=="string"?[new ui(e,r,`color expected, ${a} found`)]:rd(r)===null?[new ui(e,r,`color expected, "${r}" found`)]:[]},enum:ir,filter:rh,function:$a,layer:Kf,object:to,source:Cd,light:Jf,terrain:Ad,fog:Qf,string:Ha,formatted:function(i){return Ha(i).length===0?[]:ts(i)},resolvedImage:function(i){return Ha(i).length===0?[]:ts(i)},projection:function(i){const e=i.value,r=i.styleSpec,a=r.projection,h=i.style;let m=[];const y=xr(e);if(y==="object")for(const w in e)m=m.concat(ms({key:w,value:e[w],valueSpec:a[w],style:h,styleSpec:r}));else y!=="string"&&(m=m.concat([new ui("projection",e,`object or string expected, ${y} found`)]));return m}};function ms(i){const e=i.value,r=i.valueSpec,a=i.styleSpec;return r.expression&&rc(Bn(e))?$a(i):r.expression&&Cr(Jn(e))?ts(i):r.type&&Md[r.type]?Md[r.type](i):to(jo({},i,{valueSpec:r.type?a[r.type]:r}))}function Im(i){const e=i.value,r=i.key,a=Ha(i);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new ui(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new ui(r,e,'"glyphs" url must include a "{range}" token'))),a}function sh(i,e=Et){return io(ms({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:Im,"*":()=>[]}}))}const km=i=>io(Yf(i)),ep=i=>io(au(i));function io(i){return i.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function tp(i,e){let r=!1;if(e&&e.length)for(const a of e)i.fire(new da(new Error(a.message))),r=!0;return r}var ip=Zo,So=3;function Zo(i,e,r){var a=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var h=new Int32Array(this.arrayBuffer);i=h[0],this.d=(e=h[1])+2*(r=h[2]);for(var m=0;m<this.d*this.d;m++){var y=h[So+m],w=h[So+m+1];a.push(y===w?null:h.subarray(y,w))}var M=h[So+a.length+1];this.keys=h.subarray(h[So+a.length],M),this.bboxes=h.subarray(M),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var k=0;k<this.d*this.d;k++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=r,this.scale=e/i,this.uid=0;var B=r/e*i;this.min=-B,this.max=i+B}Zo.prototype.insert=function(i,e,r,a,h){this._forEachCell(e,r,a,h,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(h)},Zo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Zo.prototype._insertCell=function(i,e,r,a,h,m){this.cells[h].push(m)},Zo.prototype.query=function(i,e,r,a,h){var m=this.min,y=this.max;if(i<=m&&e<=m&&y<=r&&y<=a&&!h)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(i,e,r,a,this._queryCell,w,{},h),w},Zo.prototype._queryCell=function(i,e,r,a,h,m,y,w){var M=this.cells[h];if(M!==null)for(var k=this.keys,B=this.bboxes,U=0;U<M.length;U++){var G=M[U];if(y[G]===void 0){var X=4*G;(w?w(B[X+0],B[X+1],B[X+2],B[X+3]):i<=B[X+2]&&e<=B[X+3]&&r>=B[X+0]&&a>=B[X+1])?(y[G]=!0,m.push(k[G])):y[G]=!1}}},Zo.prototype._forEachCell=function(i,e,r,a,h,m,y,w){for(var M=this._convertToCellCoord(i),k=this._convertToCellCoord(e),B=this._convertToCellCoord(r),U=this._convertToCellCoord(a),G=M;G<=B;G++)for(var X=k;X<=U;X++){var Y=this.d*X+G;if((!w||w(this._convertFromCellCoord(G),this._convertFromCellCoord(X),this._convertFromCellCoord(G+1),this._convertFromCellCoord(X+1)))&&h.call(this,i,e,r,a,Y,m,y,w))return}},Zo.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Zo.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Zo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=So+this.cells.length+1+1,r=0,a=0;a<this.cells.length;a++)r+=this.cells[a].length;var h=new Int32Array(e+r+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var m=e,y=0;y<i.length;y++){var w=i[y];h[So+y]=m,h.set(w,m),m+=w.length}return h[So+i.length]=m,h.set(this.keys,m),h[So+i.length+1]=m+=this.keys.length,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer};var xl=ge(ip);const wa={};function _i(i,e,r={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writeable:!1}),wa[e]={klass:i,omit:r.omit||[]}}_i(Object,"Object"),xl.serialize=function(i,e){const r=i.toArrayBuffer();return e&&e.push(r),{buffer:r}},xl.deserialize=function(i){return new xl(i.buffer)},Object.defineProperty(xl,"name",{value:"Grid"}),_i(xl,"Grid"),_i(Sn,"Color"),_i(Error,"Error"),_i(_o,"AJAXError"),_i(Ts,"ResolvedImage"),_i(Xr,"StylePropertyFunction"),_i(ps,"StyleExpression",{omit:["_evaluator"]}),_i(_l,"ZoomDependentExpression"),_i(iu,"ZoomConstantExpression"),_i(Ho,"CompoundExpression",{omit:["_evaluate"]});for(const i in Qc)wa[Qc[i]._classRegistryKey]||_i(Qc[i],`Expression${i}`);function Id(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function kd(i){return $.ImageBitmap&&i instanceof $.ImageBitmap}function vl(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Id(i)||kd(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return e&&e.push(r.buffer),r}if(i instanceof $.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const a of i)r.push(vl(a,e));return r}if(typeof i=="object"){const r=i.constructor,a=r._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const h=r.serialize?r.serialize(i,e):{};if(!r.serialize){for(const m in i)i.hasOwnProperty(m)&&(wa[a].omit.indexOf(m)>=0||(h[m]=vl(i[m],e)));i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof i)}function qa(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Id(i)||kd(i)||ArrayBuffer.isView(i)||i instanceof $.ImageData)return i;if(Array.isArray(i))return i.map(qa);if(typeof i=="object"){const e=i.$name||"Object",{klass:r}=wa[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(i);const a=Object.create(r.prototype);for(const h of Object.keys(i))h!=="$name"&&(a[h]=qa(i[h]));return a}throw new Error("can't deserialize object of type "+typeof i)}const oi={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Pd(i){for(const e of i)if(Ld(e.charCodeAt(0)))return!0;return!1}function Pm(i){for(const e of i)if(!lu(e.charCodeAt(0)))return!1;return!0}function lu(i){return!(oi.Arabic(i)||oi["Arabic Supplement"](i)||oi["Arabic Extended-A"](i)||oi["Arabic Presentation Forms-A"](i)||oi["Arabic Presentation Forms-B"](i))}function Ld(i){return!(i!==746&&i!==747&&(i<4352||!(oi["Bopomofo Extended"](i)||oi.Bopomofo(i)||oi["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||oi["CJK Compatibility Ideographs"](i)||oi["CJK Compatibility"](i)||oi["CJK Radicals Supplement"](i)||oi["CJK Strokes"](i)||!(!oi["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||oi["CJK Unified Ideographs Extension A"](i)||oi["CJK Unified Ideographs"](i)||oi["Enclosed CJK Letters and Months"](i)||oi["Hangul Compatibility Jamo"](i)||oi["Hangul Jamo Extended-A"](i)||oi["Hangul Jamo Extended-B"](i)||oi["Hangul Jamo"](i)||oi["Hangul Syllables"](i)||oi.Hiragana(i)||oi["Ideographic Description Characters"](i)||oi.Kanbun(i)||oi["Kangxi Radicals"](i)||oi["Katakana Phonetic Extensions"](i)||oi.Katakana(i)&&i!==12540||!(!oi["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!oi["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||oi["Unified Canadian Aboriginal Syllabics"](i)||oi["Unified Canadian Aboriginal Syllabics Extended"](i)||oi["Vertical Forms"](i)||oi["Yijing Hexagram Symbols"](i)||oi["Yi Syllables"](i)||oi["Yi Radicals"](i))))}function bl(i){return!(Ld(i)||function(e){return!!(oi["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||oi["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||oi["Letterlike Symbols"](e)||oi["Number Forms"](e)||oi["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||oi["Control Pictures"](e)&&e!==9251||oi["Optical Character Recognition"](e)||oi["Enclosed Alphanumerics"](e)||oi["Geometric Shapes"](e)||oi["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||oi["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||oi["CJK Symbols and Punctuation"](e)||oi.Katakana(e)||oi["Private Use Area"](e)||oi["CJK Compatibility Forms"](e)||oi["Small Form Variants"](e)||oi["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function rp(i){return i>=1424&&i<=2303||oi["Arabic Presentation Forms-A"](i)||oi["Arabic Presentation Forms-B"](i)}function Dd(i,e){return!(!e&&rp(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||oi.Khmer(i))}function Lm(i){for(const e of i)if(rp(e.charCodeAt(0)))return!0;return!1}const oh="deferred",cu="loading",Od="loaded";let uc=null,f="unavailable",n=null;const c=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(f="error"),uc&&uc(i)};function g(){b.fire(new Vo("pluginStateChange",{pluginStatus:f,pluginURL:n}))}const b=new Vr,E=function(){return f},L=function(){if(f!==oh||!n)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");f=cu,g(),n&&ss({url:n},i=>{i?c(i):(f=Od,g())})},D={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>f===Od||D.applyArabicShaping!=null,isLoading:()=>f===cu,setState(i){f=i.pluginStatus,n=i.pluginURL},isParsed:()=>D.applyArabicShaping!=null&&D.processBidirectionalText!=null&&D.processStyledBidirectionalText!=null,getPluginURL:()=>n};class F{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,a){for(const h of r)if(!Dd(h.charCodeAt(0),a))return!1;return!0}(e,D.isLoaded())}}class W{constructor(e,r){this.property=e,this.value=r,this.expression=function(a,h){if(rc(a))return new Xr(a,h);if(Cr(a)){const m=ja(a,h);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=a;return typeof a=="string"&&h.type==="color"&&(m=Sn.parse(a)),{kind:"constant",evaluate:()=>m}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,a){return this.property.possiblyEvaluate(this,e,r,a)}}class H{constructor(e){this.property=e,this.value=new W(e,void 0)}transitioned(e,r){return new he(this.property,this.value,r,dr({},e.transition,this.transition),e.now)}untransitioned(){return new he(this.property,this.value,null,{},0)}}class Q{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ve(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new H(this._values[e].property)),this._values[e].value=new W(this._values[e].property,r===null?void 0:ve(r))}getTransition(e){return ve(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new H(this._values[e].property)),this._values[e].transition=ve(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a);const h=this.getTransition(r);h!==void 0&&(e[`${r}-transition`]=h)}return e}transitioned(e,r){const a=new me(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,r._values[h]);return a}untransitioned(){const e=new me(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class he{constructor(e,r,a,h,m){const y=h.delay||0,w=h.duration||0;m=m||0,this.property=e,this.value=r,this.begin=m+y,this.end=this.begin+w,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,r,a){const h=e.now||0,m=this.value.possiblyEvaluate(e,r,a),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(e,r,a);{const w=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,r,a),m,vt(w))}}return m}}class me{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,a){const h=new be(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,r,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ye{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ve(this._values[e].value)}setValue(e,r){this._values[e]=new W(this._values[e].property,r===null?void 0:ve(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a)}return e}possiblyEvaluate(e,r,a){const h=new be(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,r,a);return h}}class _e{constructor(e,r,a){this.property=e,this.value=r,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,a,h){return this.property.evaluate(this.value,this.parameters,e,r,a,h)}}class be{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ee{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,a){const h=qo[this.specification.type];return h?h(e,r,a):e}}class pe{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,a,h){return new _e(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},a,h)}:e.expression,r)}interpolate(e,r,a){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new _e(this,{kind:"constant",value:void 0},e.parameters);const h=qo[this.specification.type];return h?new _e(this,{kind:"constant",value:h(e.value.value,r.value.value,a)},e.parameters):e}evaluate(e,r,a,h,m,y){return e.kind==="constant"?e.value:e.evaluate(r,a,h,m,y)}}class Ce{constructor(e){this.specification=e}possiblyEvaluate(e,r,a,h){return!!e.expression.evaluate(r,null,{},a,h)}interpolate(){return!1}}class ke{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new F(0,{});for(const a in e){const h=e[a];h.specification.overridable&&this.overridableProperties.push(a);const m=this.defaultPropertyValues[a]=new W(h,void 0),y=this.defaultTransitionablePropertyValues[a]=new H(h);this.defaultTransitioningPropertyValues[a]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=m.possiblyEvaluate(r)}}}function Ge(i,e){return 256*(i=xi(Math.floor(i),0,255))+xi(Math.floor(e),0,255)}_i(pe,"DataDrivenProperty"),_i(ee,"DataConstantProperty"),_i(Ce,"ColorRampProperty");const Ne={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class We{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class it{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function et(i,e=1){let r=0,a=0;return{members:i.map(h=>{const m=Ne[h.type].BYTES_PER_ELEMENT,y=r=ft(r,Math.max(e,m)),w=h.components||1;return a=Math.max(a,m),r+=m*w,{name:h.name,type:h.type,components:w,offset:y}}),size:ft(r,Math.max(a,e)),alignment:e}}function ft(i,e){return Math.ceil(i/e)*e}class Nt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.int16[h+0]=r,this.int16[h+1]=a,e}}Nt.prototype.bytesPerElement=4,_i(Nt,"StructArrayLayout2i4");class ht extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const m=3*e;return this.int16[m+0]=r,this.int16[m+1]=a,this.int16[m+2]=h,e}}ht.prototype.bytesPerElement=6,_i(ht,"StructArrayLayout3i6");class Mt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=4*e;return this.int16[y+0]=r,this.int16[y+1]=a,this.int16[y+2]=h,this.int16[y+3]=m,e}}Mt.prototype.bytesPerElement=8,_i(Mt,"StructArrayLayout4i8");class _t extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,a,h,m,y,w)}emplace(e,r,a,h,m,y,w,M){const k=6*e,B=12*e,U=3*e;return this.int16[k+0]=r,this.int16[k+1]=a,this.uint8[B+4]=h,this.uint8[B+5]=m,this.uint8[B+6]=y,this.uint8[B+7]=w,this.float32[U+2]=M,e}}_t.prototype.bytesPerElement=12,_i(_t,"StructArrayLayout2i4ub1f12");class Vt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=4*e;return this.float32[y+0]=r,this.float32[y+1]=a,this.float32[y+2]=h,this.float32[y+3]=m,e}}Vt.prototype.bytesPerElement=16,_i(Vt,"StructArrayLayout4f16");class lt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,a,h,m)}emplace(e,r,a,h,m,y){const w=6*e,M=3*e;return this.uint16[w+0]=r,this.uint16[w+1]=a,this.uint16[w+2]=h,this.uint16[w+3]=m,this.float32[M+2]=y,e}}lt.prototype.bytesPerElement=12,_i(lt,"StructArrayLayout4ui1f12");class kt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=4*e;return this.uint16[y+0]=r,this.uint16[y+1]=a,this.uint16[y+2]=h,this.uint16[y+3]=m,e}}kt.prototype.bytesPerElement=8,_i(kt,"StructArrayLayout4ui8");class jt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,a,h,m,y)}emplace(e,r,a,h,m,y,w){const M=6*e;return this.int16[M+0]=r,this.int16[M+1]=a,this.int16[M+2]=h,this.int16[M+3]=m,this.int16[M+4]=y,this.int16[M+5]=w,e}}jt.prototype.bytesPerElement=12,_i(jt,"StructArrayLayout6i12");class Ct extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G){const X=this.length;return this.resize(X+1),this.emplace(X,e,r,a,h,m,y,w,M,k,B,U,G)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X){const Y=12*e;return this.int16[Y+0]=r,this.int16[Y+1]=a,this.int16[Y+2]=h,this.int16[Y+3]=m,this.uint16[Y+4]=y,this.uint16[Y+5]=w,this.uint16[Y+6]=M,this.uint16[Y+7]=k,this.int16[Y+8]=B,this.int16[Y+9]=U,this.int16[Y+10]=G,this.int16[Y+11]=X,e}}Ct.prototype.bytesPerElement=24,_i(Ct,"StructArrayLayout4i4ui4i24");class Ht extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,a,h,m,y)}emplace(e,r,a,h,m,y,w){const M=10*e,k=5*e;return this.int16[M+0]=r,this.int16[M+1]=a,this.int16[M+2]=h,this.float32[k+2]=m,this.float32[k+3]=y,this.float32[k+4]=w,e}}Ht.prototype.bytesPerElement=20,_i(Ht,"StructArrayLayout3i3f20");class Ii extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Ii.prototype.bytesPerElement=4,_i(Ii,"StructArrayLayout1ul4");class Fi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G,X){const Y=this.length;return this.resize(Y+1),this.emplace(Y,e,r,a,h,m,y,w,M,k,B,U,G,X)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X,Y){const ie=20*e,de=10*e;return this.int16[ie+0]=r,this.int16[ie+1]=a,this.int16[ie+2]=h,this.int16[ie+3]=m,this.int16[ie+4]=y,this.float32[de+3]=w,this.float32[de+4]=M,this.float32[de+5]=k,this.float32[de+6]=B,this.int16[ie+14]=U,this.uint32[de+8]=G,this.uint16[ie+18]=X,this.uint16[ie+19]=Y,e}}Fi.prototype.bytesPerElement=40,_i(Fi,"StructArrayLayout5i4f1i1ul2ui40");class vi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,a,h,m,y,w)}emplace(e,r,a,h,m,y,w,M){const k=8*e;return this.int16[k+0]=r,this.int16[k+1]=a,this.int16[k+2]=h,this.int16[k+4]=m,this.int16[k+5]=y,this.int16[k+6]=w,this.int16[k+7]=M,e}}vi.prototype.bytesPerElement=16,_i(vi,"StructArrayLayout3i2i2i16");class Pi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,a,h,m)}emplace(e,r,a,h,m,y){const w=4*e,M=8*e;return this.float32[w+0]=r,this.float32[w+1]=a,this.float32[w+2]=h,this.int16[M+6]=m,this.int16[M+7]=y,e}}Pi.prototype.bytesPerElement=16,_i(Pi,"StructArrayLayout2f1f2i16");class Gi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=12*e,w=3*e;return this.uint8[y+0]=r,this.uint8[y+1]=a,this.float32[w+1]=h,this.float32[w+2]=m,e}}Gi.prototype.bytesPerElement=12,_i(Gi,"StructArrayLayout2ub2f12");class Wi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const m=3*e;return this.float32[m+0]=r,this.float32[m+1]=a,this.float32[m+2]=h,e}}Wi.prototype.bytesPerElement=12,_i(Wi,"StructArrayLayout3f12");class Ci extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const m=3*e;return this.uint16[m+0]=r,this.uint16[m+1]=a,this.uint16[m+2]=h,e}}Ci.prototype.bytesPerElement=6,_i(Ci,"StructArrayLayout3ui6");class Ar extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ve){const Be=this.length;return this.resize(Be+1),this.emplace(Be,e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ve)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ve,Be){const gt=30*e,dt=15*e,At=60*e;return this.int16[gt+0]=r,this.int16[gt+1]=a,this.int16[gt+2]=h,this.float32[dt+2]=m,this.float32[dt+3]=y,this.uint16[gt+8]=w,this.uint16[gt+9]=M,this.uint32[dt+5]=k,this.uint32[dt+6]=B,this.uint32[dt+7]=U,this.uint16[gt+16]=G,this.uint16[gt+17]=X,this.uint16[gt+18]=Y,this.float32[dt+10]=ie,this.float32[dt+11]=de,this.uint8[At+48]=Ee,this.uint8[At+49]=Re,this.uint8[At+50]=Se,this.uint32[dt+13]=De,this.int16[gt+28]=Ve,this.uint8[At+58]=Be,e}}Ar.prototype.bytesPerElement=60,_i(Ar,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Lr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ve,Be,gt,dt,At,qt,yt,Ot,Rt,Ut){const Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ve,Be,gt,dt,At,qt,yt,Ot,Rt,Ut)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ve,Be,gt,dt,At,qt,yt,Ot,Rt,Ut,Jt){const St=38*e,si=19*e;return this.int16[St+0]=r,this.int16[St+1]=a,this.int16[St+2]=h,this.float32[si+2]=m,this.float32[si+3]=y,this.int16[St+8]=w,this.int16[St+9]=M,this.int16[St+10]=k,this.int16[St+11]=B,this.int16[St+12]=U,this.int16[St+13]=G,this.uint16[St+14]=X,this.uint16[St+15]=Y,this.uint16[St+16]=ie,this.uint16[St+17]=de,this.uint16[St+18]=Ee,this.uint16[St+19]=Re,this.uint16[St+20]=Se,this.uint16[St+21]=De,this.uint16[St+22]=Ve,this.uint16[St+23]=Be,this.uint16[St+24]=gt,this.uint16[St+25]=dt,this.uint16[St+26]=At,this.uint16[St+27]=qt,this.uint16[St+28]=yt,this.uint32[si+15]=Ot,this.float32[si+16]=Rt,this.float32[si+17]=Ut,this.float32[si+18]=Jt,e}}Lr.prototype.bytesPerElement=76,_i(Lr,"StructArrayLayout3i2f6i15ui1ul3f76");class Dr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}Dr.prototype.bytesPerElement=4,_i(Dr,"StructArrayLayout1f4");class Or extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,a,h,m)}emplace(e,r,a,h,m,y){const w=5*e;return this.float32[w+0]=r,this.float32[w+1]=a,this.float32[w+2]=h,this.float32[w+3]=m,this.float32[w+4]=y,e}}Or.prototype.bytesPerElement=20,_i(Or,"StructArrayLayout5f20");class gs extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=6*e;return this.uint32[3*e+0]=r,this.uint16[y+2]=a,this.uint16[y+3]=h,this.uint16[y+4]=m,e}}gs.prototype.bytesPerElement=12,_i(gs,"StructArrayLayout1ul3ui12");class is extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.uint16[h+0]=r,this.uint16[h+1]=a,e}}is.prototype.bytesPerElement=4,_i(is,"StructArrayLayout2ui4");class ro extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}ro.prototype.bytesPerElement=2,_i(ro,"StructArrayLayout1ui2");class kr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.float32[h+0]=r,this.float32[h+1]=a,e}}kr.prototype.bytesPerElement=8,_i(kr,"StructArrayLayout2f8");class Zr extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Zr.prototype.size=40;class Ur extends Fi{get(e){return new Zr(this,e)}}_i(Ur,"CollisionBoxArray");class mr extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}mr.prototype.size=60;class Fn extends Ar{get(e){return new mr(this,e)}}_i(Fn,"PlacedSymbolArray");class Es extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Es.prototype.size=76;class Yr extends Lr{get(e){return new Es(this,e)}}_i(Yr,"SymbolInstanceArray");class Wn extends Dr{getoffsetX(e){return this.float32[1*e+0]}}_i(Wn,"GlyphOffsetArray");class hu extends Nt{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}_i(hu,"SymbolLineVertexArray");class Ta extends We{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ta.prototype.size=12;class dc extends gs{get(e){return new Ta(this,e)}}_i(dc,"FeatureIndexArray");class Yo extends is{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}_i(Yo,"FillExtrusionCentroidArray");const Ea=et([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),wl=et([{name:"a_dash",components:4,type:"Uint16"}]);var vn={exports:{}},ah={exports:{}};ah.exports=function(i,e){var r,a,h,m,y,w,M,k;for(a=i.length-(r=3&i.length),h=e,y=3432918353,w=461845907,k=0;k<a;)M=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,h=27492+(65535&(m=5*(65535&(h=(h^=M=(65535&(M=(M=(65535&M)*y+(((M>>>16)*y&65535)<<16)&4294967295)<<15|M>>>17))*w+(((M>>>16)*w&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(M=0,r){case 3:M^=(255&i.charCodeAt(k+2))<<16;case 2:M^=(255&i.charCodeAt(k+1))<<8;case 1:h^=M=(65535&(M=(M=(65535&(M^=255&i.charCodeAt(k)))*y+(((M>>>16)*y&65535)<<16)&4294967295)<<15|M>>>17))*w+(((M>>>16)*w&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var Rd=ah.exports,Dm={exports:{}};Dm.exports=function(i,e){for(var r,a=i.length,h=e^a,m=0;a>=4;)r=1540483477*(65535&(r=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(r>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:h^=(255&i.charCodeAt(m+2))<<16;case 2:h^=(255&i.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var zd=Rd,uu=Dm.exports;vn.exports=zd,vn.exports.murmur3=zd,vn.exports.murmur2=uu;var Om=ge(vn.exports);class fn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,a,h){this.ids.push(__(e)),this.positions.push(r,a,h)}getPositions(e){const r=__(e);let a=0,h=this.ids.length-1;for(;a<h;){const y=a+h>>1;this.ids[y]>=r?h=y:a=y+1}const m=[];for(;this.ids[a]===r;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,r){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return np(a,h,0,a.length-1),r&&r.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const r=new fn;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function __(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Om(String(i))}function np(i,e,r,a){for(;r<a;){const h=i[r+a>>1];let m=r-1,y=a+1;for(;;){do m++;while(i[m]<h);do y--;while(i[y]>h);if(m>=y)break;Bd(i,m,y),Bd(e,3*m,3*y),Bd(e,3*m+1,3*y+1),Bd(e,3*m+2,3*y+2)}y-r<a-y?(np(i,e,r,y),r=y+1):(np(i,e,y+1,a),a=y)}}function Bd(i,e,r){const a=i[e];i[e]=i[r],i[r]=a}_i(fn,"FeaturePositionMap");class Xa{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}}class Gn extends Xa{constructor(e){super(e),this.current=0}set(e,r,a){this.fetchUniformLocation(e,r)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class y_ extends Xa{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,a){this.fetchUniformLocation(e,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class du extends Xa{constructor(e){super(e),this.current=Sn.transparent}set(e,r,a){this.fetchUniformLocation(e,r)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const Rm=new Float32Array(16),Cn=new Float32Array(9),Hx=new Float32Array(4);function sp(i){return[Ge(255*i.r,255*i.g),Ge(255*i.b,255*i.a)]}class Gs{constructor(e,r,a){this.value=e,this.uniformNames=r.map(h=>`u_${h}`),this.type=a}setUniform(e,r,a,h,m){r.set(e,m,h.constantOr(this.value))}getBinding(e,r){return this.type==="color"?new du(e):new Gn(e)}}class _s{constructor(e,r){this.uniformNames=r.map(a=>`u_${a}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,a,h,m){const y=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;y&&r.set(e,m,y)}getBinding(e,r){return r==="u_pattern"||r==="u_dash"?new y_(e):new Gn(e)}}class Tl{constructor(e,r,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=r.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,r,a,h,m,y){const w=this.paintVertexArray.length,M=this.expression.evaluate(new F(0),r,{},m,h,y);this.paintVertexArray.resize(e),this._setPaintValue(w,e,M)}updatePaintArray(e,r,a,h,m){const y=this.expression.evaluate({zoom:0},a,h,void 0,m);this._setPaintValue(e,r,y)}_setPaintValue(e,r,a){if(this.type==="color"){const h=sp(a);for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=e;h<r;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sa{constructor(e,r,a,h,m,y){this.expression=e,this.uniformNames=r.map(w=>`u_${w}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(w=>({name:`a_${w}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,r,a,h,m,y){const w=this.expression.evaluate(new F(this.zoom),r,{},m,h,y),M=this.expression.evaluate(new F(this.zoom+1),r,{},m,h,y),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,w,M)}updatePaintArray(e,r,a,h,m){const y=this.expression.evaluate({zoom:this.zoom},a,h,void 0,m),w=this.expression.evaluate({zoom:this.zoom+1},a,h,void 0,m);this._setPaintValue(e,r,y,w)}_setPaintValue(e,r,a,h){if(this.type==="color"){const m=sp(a),y=sp(h);for(let w=e;w<r;w++)this.paintVertexArray.emplace(w,m[0],m[1],y[0],y[1])}else{for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,a,h,m){const y=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,w=xi(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);r.set(e,m,w)}getBinding(e,r){return new Gn(e)}}class El{constructor(e,r,a,h,m){this.expression=e,this.layerId=m,this.paintVertexAttributes=(a==="array"?wl:Ea).members;for(let y=0;y<r.length;++y);this.paintVertexArray=new h}populatePaintArray(e,r,a){const h=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(h,e,r.patterns&&r.patterns[this.layerId],a)}updatePaintArray(e,r,a,h,m,y){this._setPaintValues(e,r,a.patterns&&a.patterns[this.layerId],y)}_setPaintValues(e,r,a,h){if(!h||!a)return;const m=h[a];if(!m)return;const{tl:y,br:w,pixelRatio:M}=m;for(let k=e;k<r;k++)this.paintVertexArray.emplace(k,y[0],y[1],w[0],w[1],M)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class fc{constructor(e,r,a=()=>!0){this.binders={},this._buffers=[];const h=[];for(const m in e.paint._values){if(!a(m))continue;const y=e.paint.get(m);if(!(y instanceof _e&&ic(y.property.specification)))continue;const w=Xx(m,e.type),M=y.value,k=y.property.specification.type,B=!!y.property.useIntegerZoom,U=m==="line-dasharray"||m.endsWith("pattern"),G=m==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(M.kind!=="constant"||G)if(M.kind==="source"||G||U){const X=x_(m,k,"source");this.binders[m]=U?new El(M,w,k,X,e.id):new Tl(M,w,k,X),h.push(`/a_${m}`)}else{const X=x_(m,k,"composite");this.binders[m]=new Sa(M,w,k,B,r,X),h.push(`/z_${m}`)}else this.binders[m]=U?new _s(M.value,w):new Gs(M.value,w,k),h.push(`/u_${m}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Tl||r instanceof Sa?r.maxValue:0}populatePaintArrays(e,r,a,h,m,y){for(const w in this.binders){const M=this.binders[w];(M instanceof Tl||M instanceof Sa||M instanceof El)&&M.populatePaintArray(e,r,a,h,m,y)}}setConstantPatternPositions(e){for(const r in this.binders){const a=this.binders[r];a instanceof _s&&a.setConstantPatternPositions(e)}}updatePaintArrays(e,r,a,h,m,y){let w=!1;for(const M in e){const k=r.getPositions(M);for(const B of k){const U=a.feature(B.index);for(const G in this.binders){const X=this.binders[G];if((X instanceof Tl||X instanceof Sa||X instanceof El)&&X.expression.isStateDependent===!0){const Y=h.paint.get(G);X.expression=Y.value,X.updatePaintArray(B.start,B.end,U,e[M],m,y),w=!0}}}}return w}defines(){const e=[];for(const r in this.binders){const a=this.binders[r];(a instanceof Gs||a instanceof _s)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof Tl||a instanceof Sa||a instanceof El)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof Gs||a instanceof _s||a instanceof Sa)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const r=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Gs||h instanceof _s||h instanceof Sa)for(const m of h.uniformNames)r.push({name:m,property:a,binding:h.getBinding(e,m)})}return r}setUniforms(e,r,a,h,m){for(const{name:y,property:w,binding:M}of a)this.binders[w].setUniform(e,M,m,h.get(w),y)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const r=this.binders[e];(r instanceof Tl||r instanceof Sa||r instanceof El)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){const a=this.binders[r];(a instanceof Tl||a instanceof Sa||a instanceof El)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Tl||r instanceof Sa||r instanceof El)&&r.destroy()}}}class pc{constructor(e,r,a=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new fc(h,r,a);this.needsUpload=!1,this._featureMap=new fn,this._bufferOffset=0}populatePaintArrays(e,r,a,h,m,y,w){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(e,r,h,m,y,w);r.id!==void 0&&this._featureMap.add(r.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,a,h,m){for(const y of a)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,r,y,h,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const qx={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Xx(i,e){return qx[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const op={"line-pattern":{source:lt,composite:lt},"fill-pattern":{source:lt,composite:lt},"fill-extrusion-pattern":{source:lt,composite:lt},"line-dasharray":{source:kt,composite:kt}},Zx={color:{source:kr,composite:Vt},number:{source:Dr,composite:kr}};function x_(i,e,r){const a=op[i];return a&&a[r]||Zx[e][r]}_i(Gs,"ConstantBinder"),_i(_s,"PatternConstantBinder"),_i(Tl,"SourceExpressionBinder"),_i(El,"PatternCompositeBinder"),_i(Sa,"CompositeExpressionBinder"),_i(fc,"ProgramConfiguration",{omit:["_buffers"]}),_i(pc,"ProgramConfigurationSet");const ap="-transition";class Ca extends Vr{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new ye(r.layout)),r.paint)){this._transitionablePaint=new Q(r.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new be(r.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,a={}){r!=null&&this._validate(ep,`layers.${this.id}.layout.${e}`,e,r,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return sr(e,ap)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,a={}){if(r!=null&&this._validate(km,`layers.${this.id}.paint.${e}`,e,r,a))return!1;if(sr(e,ap))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[e],m=h.value.isDataDriven(),y=h.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value,M=w.isDataDriven(),k=sr(e,"pattern")||e==="line-dasharray";return M||m||k||this._handleOverridablePaintPropertyUpdate(e,y,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),xe(e,(r,a)=>!(r===void 0||a==="layout"&&!Object.keys(r).length||a==="paint"&&!Object.keys(r).length))}_validate(e,r,a,h,m={}){return(!m||m.validate!==!1)&&tp(this,e.call(sh,{key:r,layerType:this.type,objectKey:a,value:h,styleSpec:Et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof _e&&ic(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ru(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Yx=et([{name:"a_pos",components:2,type:"Int16"}],4),Sl=et([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class An{constructor(e=[]){this.segments=e}prepareSegment(e,r,a,h){let m=this.segments[this.segments.length-1];return e>An.MAX_VERTEX_ARRAY_LENGTH&&Lt(`Max vertices per segment is ${An.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>An.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,a,h){return new An([{vertexOffset:e,primitiveOffset:r,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}An.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_i(An,"SegmentVector");var Ai=8192;class as{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Rr?new Rr(e.lng,e.lat):Rr.convert(e),this}setSouthWest(e){return this._sw=e instanceof Rr?new Rr(e.lng,e.lat):Rr.convert(e),this}extend(e){const r=this._sw,a=this._ne;let h,m;if(e instanceof Rr)h=e,m=e;else{if(!(e instanceof as))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(as.convert(e)):this.extend(Rr.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Rr.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return r||a?(r.lng=Math.min(h.lng,r.lng),r.lat=Math.min(h.lat,r.lat),a.lng=Math.max(m.lng,a.lng),a.lat=Math.max(m.lat,a.lat)):(this._sw=new Rr(h.lng,h.lat),this._ne=new Rr(m.lng,m.lat)),this}getCenter(){return new Rr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Rr(this.getWest(),this.getNorth())}getSouthEast(){return new Rr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:a}=Rr.convert(e);let h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&h}static convert(e){return!e||e instanceof as?e:new as(e)}}var lp=1e-6,no=typeof Float32Array<"u"?Float32Array:Array;function v_(){var i=new no(9);return no!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function b_(i,e,r){var a=e[0],h=e[1],m=e[2],y=e[3],w=e[4],M=e[5],k=e[6],B=e[7],U=e[8],G=r[0],X=r[1],Y=r[2],ie=r[3],de=r[4],Ee=r[5],Re=r[6],Se=r[7],De=r[8];return i[0]=G*a+X*y+Y*k,i[1]=G*h+X*w+Y*B,i[2]=G*m+X*M+Y*U,i[3]=ie*a+de*y+Ee*k,i[4]=ie*h+de*w+Ee*B,i[5]=ie*m+de*M+Ee*U,i[6]=Re*a+Se*y+De*k,i[7]=Re*h+Se*w+De*B,i[8]=Re*m+Se*M+De*U,i}function Co(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function cp(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=e[4],w=e[5],M=e[6],k=e[7],B=e[8],U=e[9],G=e[10],X=e[11],Y=e[12],ie=e[13],de=e[14],Ee=e[15],Re=r*w-a*y,Se=r*M-h*y,De=r*k-m*y,Ve=a*M-h*w,Be=a*k-m*w,gt=h*k-m*M,dt=B*ie-U*Y,At=B*de-G*Y,qt=B*Ee-X*Y,yt=U*de-G*ie,Ot=U*Ee-X*ie,Rt=G*Ee-X*de,Ut=Re*Rt-Se*Ot+De*yt+Ve*qt-Be*At+gt*dt;return Ut?(i[0]=(w*Rt-M*Ot+k*yt)*(Ut=1/Ut),i[1]=(h*Ot-a*Rt-m*yt)*Ut,i[2]=(ie*gt-de*Be+Ee*Ve)*Ut,i[3]=(G*Be-U*gt-X*Ve)*Ut,i[4]=(M*qt-y*Rt-k*At)*Ut,i[5]=(r*Rt-h*qt+m*At)*Ut,i[6]=(de*De-Y*gt-Ee*Se)*Ut,i[7]=(B*gt-G*De+X*Se)*Ut,i[8]=(y*Ot-w*qt+k*dt)*Ut,i[9]=(a*qt-r*Ot-m*dt)*Ut,i[10]=(Y*Be-ie*De+Ee*Re)*Ut,i[11]=(U*De-B*Be-X*Re)*Ut,i[12]=(w*At-y*yt-M*dt)*Ut,i[13]=(r*yt-a*At+h*dt)*Ut,i[14]=(ie*Se-Y*Ve-de*Re)*Ut,i[15]=(B*Ve-U*Se+G*Re)*Ut,i):null}function Cl(i,e,r){var a=e[0],h=e[1],m=e[2],y=e[3],w=e[4],M=e[5],k=e[6],B=e[7],U=e[8],G=e[9],X=e[10],Y=e[11],ie=e[12],de=e[13],Ee=e[14],Re=e[15],Se=r[0],De=r[1],Ve=r[2],Be=r[3];return i[0]=Se*a+De*w+Ve*U+Be*ie,i[1]=Se*h+De*M+Ve*G+Be*de,i[2]=Se*m+De*k+Ve*X+Be*Ee,i[3]=Se*y+De*B+Ve*Y+Be*Re,i[4]=(Se=r[4])*a+(De=r[5])*w+(Ve=r[6])*U+(Be=r[7])*ie,i[5]=Se*h+De*M+Ve*G+Be*de,i[6]=Se*m+De*k+Ve*X+Be*Ee,i[7]=Se*y+De*B+Ve*Y+Be*Re,i[8]=(Se=r[8])*a+(De=r[9])*w+(Ve=r[10])*U+(Be=r[11])*ie,i[9]=Se*h+De*M+Ve*G+Be*de,i[10]=Se*m+De*k+Ve*X+Be*Ee,i[11]=Se*y+De*B+Ve*Y+Be*Re,i[12]=(Se=r[12])*a+(De=r[13])*w+(Ve=r[14])*U+(Be=r[15])*ie,i[13]=Se*h+De*M+Ve*G+Be*de,i[14]=Se*m+De*k+Ve*X+Be*Ee,i[15]=Se*y+De*B+Ve*Y+Be*Re,i}function Fd(i,e,r){var a,h,m,y,w,M,k,B,U,G,X,Y,ie=r[0],de=r[1],Ee=r[2];return e===i?(i[12]=e[0]*ie+e[4]*de+e[8]*Ee+e[12],i[13]=e[1]*ie+e[5]*de+e[9]*Ee+e[13],i[14]=e[2]*ie+e[6]*de+e[10]*Ee+e[14],i[15]=e[3]*ie+e[7]*de+e[11]*Ee+e[15]):(h=e[1],m=e[2],y=e[3],w=e[4],M=e[5],k=e[6],B=e[7],U=e[8],G=e[9],X=e[10],Y=e[11],i[0]=a=e[0],i[1]=h,i[2]=m,i[3]=y,i[4]=w,i[5]=M,i[6]=k,i[7]=B,i[8]=U,i[9]=G,i[10]=X,i[11]=Y,i[12]=a*ie+w*de+U*Ee+e[12],i[13]=h*ie+M*de+G*Ee+e[13],i[14]=m*ie+k*de+X*Ee+e[14],i[15]=y*ie+B*de+Y*Ee+e[15]),i}function Al(i,e,r){var a=r[0],h=r[1],m=r[2];return i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i[3]=e[3]*a,i[4]=e[4]*h,i[5]=e[5]*h,i[6]=e[6]*h,i[7]=e[7]*h,i[8]=e[8]*m,i[9]=e[9]*m,i[10]=e[10]*m,i[11]=e[11]*m,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Nd(i,e,r){var a=Math.sin(r),h=Math.cos(r),m=e[4],y=e[5],w=e[6],M=e[7],k=e[8],B=e[9],U=e[10],G=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=m*h+k*a,i[5]=y*h+B*a,i[6]=w*h+U*a,i[7]=M*h+G*a,i[8]=k*h-m*a,i[9]=B*h-y*a,i[10]=U*h-w*a,i[11]=G*h-M*a,i}function hp(i,e,r){var a=Math.sin(r),h=Math.cos(r),m=e[0],y=e[1],w=e[2],M=e[3],k=e[8],B=e[9],U=e[10],G=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*h-k*a,i[1]=y*h-B*a,i[2]=w*h-U*a,i[3]=M*h-G*a,i[8]=m*a+k*h,i[9]=y*a+B*h,i[10]=w*a+U*h,i[11]=M*a+G*h,i}function zm(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function mc(i,e,r){var a,h,m,y=r[0],w=r[1],M=r[2],k=Math.hypot(y,w,M);return k<lp?null:(y*=k=1/k,w*=k,M*=k,a=Math.sin(e),h=Math.cos(e),i[0]=y*y*(m=1-h)+h,i[1]=w*y*m+M*a,i[2]=M*y*m-w*a,i[3]=0,i[4]=y*w*m-M*a,i[5]=w*w*m+h,i[6]=M*w*m+y*a,i[7]=0,i[8]=y*M*m+w*a,i[9]=w*M*m-y*a,i[10]=M*M*m+h,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Ud=Cl;function up(){var i=new no(3);return no!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function w_(i){var e=new no(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function fu(i){return Math.hypot(i[0],i[1],i[2])}function gc(i,e,r){var a=new no(3);return a[0]=i,a[1]=e,a[2]=r,a}function Aa(i,e,r){return i[0]=e[0]+r[0],i[1]=e[1]+r[1],i[2]=e[2]+r[2],i}function dp(i,e,r){return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],i}function fp(i,e,r){return i[0]=e[0]*r[0],i[1]=e[1]*r[1],i[2]=e[2]*r[2],i}function Ws(i,e,r){return i[0]=Math.min(e[0],r[0]),i[1]=Math.min(e[1],r[1]),i[2]=Math.min(e[2],r[2]),i}function Ko(i,e,r){return i[0]=Math.max(e[0],r[0]),i[1]=Math.max(e[1],r[1]),i[2]=Math.max(e[2],r[2]),i}function so(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i}function Vd(i,e,r,a){return i[0]=e[0]+r[0]*a,i[1]=e[1]+r[1]*a,i[2]=e[2]+r[2]*a,i}function zs(i,e){var r=e[0],a=e[1],h=e[2],m=r*r+a*a+h*h;return m>0&&(m=1/Math.sqrt(m)),i[0]=e[0]*m,i[1]=e[1]*m,i[2]=e[2]*m,i}function oo(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Za(i,e,r){var a=e[0],h=e[1],m=e[2],y=r[0],w=r[1],M=r[2];return i[0]=h*M-m*w,i[1]=m*y-a*M,i[2]=a*w-h*y,i}function pn(i,e,r){var a=e[0],h=e[1],m=e[2],y=r[3]*a+r[7]*h+r[11]*m+r[15];return i[0]=(r[0]*a+r[4]*h+r[8]*m+r[12])/(y=y||1),i[1]=(r[1]*a+r[5]*h+r[9]*m+r[13])/y,i[2]=(r[2]*a+r[6]*h+r[10]*m+r[14])/y,i}function Tr(i,e,r){var a=r[0],h=r[1],m=r[2],y=e[0],w=e[1],M=e[2],k=h*M-m*w,B=m*y-a*M,U=a*w-h*y,G=h*U-m*B,X=m*k-a*U,Y=a*B-h*k,ie=2*r[3];return B*=ie,U*=ie,X*=2,Y*=2,i[0]=y+(k*=ie)+(G*=2),i[1]=w+B+X,i[2]=M+U+Y,i}var jd,Ao=dp,Kx=fp,pu=fu;function T_(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i}function $d(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=r*r+a*a+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),i[0]=r*y,i[1]=a*y,i[2]=h*y,i[3]=m*y,i}function Bs(i,e,r){var a=e[0],h=e[1],m=e[2],y=e[3];return i[0]=r[0]*a+r[4]*h+r[8]*m+r[12]*y,i[1]=r[1]*a+r[5]*h+r[9]*m+r[13]*y,i[2]=r[2]*a+r[6]*h+r[10]*m+r[14]*y,i[3]=r[3]*a+r[7]*h+r[11]*m+r[15]*y,i}function pp(){var i=new no(4);return no!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function ys(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function E_(i,e,r){r*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(r),M=Math.cos(r);return i[0]=a*M+y*w,i[1]=h*M+m*w,i[2]=m*M-h*w,i[3]=y*M-a*w,i}function Bm(i,e,r){r*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(r),M=Math.cos(r);return i[0]=a*M-m*w,i[1]=h*M+y*w,i[2]=m*M+a*w,i[3]=y*M-h*w,i}up(),jd=new no(4),no!=Float32Array&&(jd[0]=0,jd[1]=0,jd[2]=0,jd[3]=0);var S_=$d;up(),gc(1,0,0),gc(0,1,0),pp(),pp(),v_();const mp=et([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:C_}=mp,A_=et([{name:"a_pos_3",components:3,type:"Int16"}]);var Jo=et([{name:"a_pos",type:"Int16",components:2}]);class Fm{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,a){const h=oo(r,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/h;return a[0]=this.pos[0]+this.dir[0]*m,a[1]=this.pos[1]+this.dir[1]*m,a[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(e,r,a){if(function(X,Y){var ie=X[0],de=X[1],Ee=X[2],Re=Y[0],Se=Y[1],De=Y[2];return Math.abs(ie-Re)<=lp*Math.max(1,Math.abs(ie),Math.abs(Re))&&Math.abs(de-Se)<=lp*Math.max(1,Math.abs(de),Math.abs(Se))&&Math.abs(Ee-De)<=lp*Math.max(1,Math.abs(Ee),Math.abs(De))}(this.pos,e)||r===0)return a[0]=a[1]=a[2]=0,!1;const[h,m,y]=this.dir,w=this.pos[0]-e[0],M=this.pos[1]-e[1],k=this.pos[2]-e[2],B=h*h+m*m+y*y,U=2*(w*h+M*m+k*y),G=U*U-4*B*(w*w+M*M+k*k-r*r);if(G<0){const X=Math.max(-U/2,0),Y=w+h*X,ie=M+m*X,de=k+y*X,Ee=Math.hypot(Y,ie,de);return a[0]=Y*r/Ee,a[1]=ie*r/Ee,a[2]=de*r/Ee,!1}{const X=(-U-Math.sqrt(G))/(2*B);if(X<0){const Y=Math.hypot(w,M,k);return a[0]=w*r/Y,a[1]=M*r/Y,a[2]=k*r/Y,!1}return a[0]=w+h*X,a[1]=M+m*X,a[2]=k+y*X,!0}}}class Nm{constructor(e,r,a,h,m){this.TL=e,this.TR=r,this.BR=a,this.BL=h,this.horizon=m}static fromInvProjectionMatrix(e,r,a){const h=[-1,1,1],m=[1,1,1],y=[1,-1,1],w=[-1,-1,1],M=pn(h,h,e),k=pn(m,m,e),B=pn(y,y,e),U=pn(w,w,e);return new Nm(M,k,B,U,r/a)}}class Ya{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,a,h){const m=Math.pow(2,a),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const k=Bs([],M,e),B=1/k[3]/r*m;return function(U,G,X){return U[0]=G[0]*X[0],U[1]=G[1]*X[1],U[2]=G[2]*X[2],U[3]=G[3]*X[3],U}(k,k,[B,B,h?1/k[3]:B,B])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const k=zs([],Za([],Ao([],y[M[0]],y[M[1]]),Ao([],y[M[2]],y[M[1]]))),B=-oo(k,y[M[1]]);return k.concat(B)});return new Ya(y,w)}}class ls{static fromPoints(e){const r=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const h of e)Ws(r,r,h),Ko(a,a,h);return new ls(r,a)}static applyTransform(e,r){const a=e.getCorners();for(let h=0;h<a.length;++h)pn(a[h],a[h],r);return ls.fromPoints(a)}constructor(e,r){this.min=e,this.max=r,this.center=so([],Aa([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],a=w_(this.min),h=w_(this.max);for(let m=0;m<r.length;m++)a[m]=r[m]?this.min[m]:this.center[m],h[m]=r[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new ls(a,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let a=!0;for(let h=0;h<e.planes.length;h++){const m=e.planes[h];let y=0;for(let w=0;w<r.length;w++)y+=oo(m,r[w])+m[3]>=0;if(y===0)return 0;y!==r.length&&(a=!1)}if(a)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const M=e.points[w][h]-this.min[h];m=Math.min(m,M),y=Math.max(y,M)}if(y<0||m>this.max[h]-this.min[h])return 0}return 1}}const Gd=5,gp=6,Ka=Ai/Math.PI/2,M_=16383,_c=64,Wd=[_c,32,16],Mo=-Ka,Fs=Ka,Jx=[new ls([Mo,Mo,Mo],[Fs,Fs,Fs]),new ls([Mo,Mo,Mo],[0,0,Fs]),new ls([0,Mo,Mo],[Fs,0,Fs]),new ls([Mo,0,Mo],[0,Fs,Fs]),new ls([0,0,Mo],[Fs,Fs,Fs])];function _p(i){return i*Ka/Zd}function I_(i,e,r,a=!0){const h=so([],i._camera.position,i.worldSize),m=[e,r,1,1];Bs(m,m,i.pixelMatrixInverse),T_(m,m,1/m[3]);const y=zs([],Ao([],m,h)),w=i.globeMatrix,M=[w[12],w[13],w[14]],k=Ao([],M,h),B=fu(k),U=zs([],k),G=i.worldSize/(2*Math.PI),X=oo(U,y),Y=Math.asin(G/B);if(Y<Math.acos(X)){if(!a)return null;const qt=[],yt=[];so(qt,y,B/X),zs(yt,Ao(yt,qt,k)),zs(y,Aa(y,k,so(y,yt,Math.tan(Y)*B)))}const ie=[];new Fm(h,y).closestPointOnSphere(M,G,ie);const de=zs([],Gt(w,0)),Ee=zs([],Gt(w,1)),Re=zs([],Gt(w,2)),Se=oo(de,ie),De=oo(Ee,ie),Ve=oo(Re,ie),Be=xt(Math.asin(-De/G));let gt=xt(Math.atan2(Se,Ve));gt=i.center.lng+function(qt,yt){const Ot=(yt-qt+180)%360-180;return Ot<-180?Ot+360:Ot}(i.center.lng,gt);const dt=Ia(gt),At=xi(ea(Be),0,1);return new yu(dt,At)}class k_{constructor(e,r,a){this.a=Ao([],e,a),this.b=Ao([],r,a),this.center=a;const h=zs([],this.a),m=zs([],this.b);this.angle=Math.acos(oo(h,m))}}function Hd(i,e){if(i.angle===0)return null;let r;return r=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),r<0||r>1?null:function(a,h,m,y){const w=Math.sin(m);return a*(Math.sin((1-y)*m)/w)+h*(Math.sin(y*m)/w)}(i.a[e],i.b[e],i.angle,xi(r,0,1))+i.center[e]}function Qo(i){if(i.z<=1)return Jx[i.z+2*i.y+i.x];const e=lh(qd(i));return ls.fromPoints(e)}function Ma(i,e,r){return so(i,i,1-r),Vd(i,i,e,r)}function Um(i,e){const r=_u(e.zoom);if(r===0)return Qo(i);const a=qd(i),h=lh(a),m=Ia(a.getWest())*e.worldSize,y=Ia(a.getEast())*e.worldSize,w=ea(a.getNorth())*e.worldSize,M=ea(a.getSouth())*e.worldSize,k=[m,w,0],B=[y,w,0],U=[m,M,0],G=[y,M,0],X=cp([],e.globeMatrix);return pn(k,k,X),pn(B,B,X),pn(U,U,X),pn(G,G,X),h[0]=Ma(h[0],U,r),h[1]=Ma(h[1],G,r),h[2]=Ma(h[2],B,r),h[3]=Ma(h[3],k,r),ls.fromPoints(h)}function P_(i,e,r){for(const a of i)pn(a,a,e),so(a,a,r)}function Qx(i,e,r){const a=e/i.worldSize,h=i.globeMatrix;if(r.z<=1){const dt=Qo(r).getCorners();return P_(dt,h,a),ls.fromPoints(dt)}const m=qd(r),y=lh(m);P_(y,h,a);const w=Number.MAX_VALUE,M=[-w,-w,-w],k=[w,w,w];if(m.contains(i.center)){for(const qt of y)Ws(k,k,qt),Ko(M,M,qt);M[2]=0;const dt=i.point,At=[dt.x*a,dt.y*a,0];return Ws(k,k,At),Ko(M,M,At),new ls(k,M)}const B=[h[12]*a,h[13]*a,h[14]*a],U=m.getCenter(),G=xi(i.center.lat,-85.051129,ko),X=xi(U.lat,-85.051129,ko),Y=Ia(i.center.lng),ie=ea(G);let de=Y-Ia(U.lng);const Ee=ie-ea(X);de>.5?de-=1:de<-.5&&(de+=1);let Re=0;Math.abs(de)>Math.abs(Ee)?Re=de>=0?1:3:(Re=Ee>=0?0:2,Vd(B,B,[h[4]*a,h[5]*a,h[6]*a],-Math.sin(wt(Ee>=0?m.getSouth():m.getNorth()))*Ka));const Se=y[Re],De=y[(Re+1)%4],Ve=new k_(Se,De,B),Be=[Hd(Ve,0)||Se[0],Hd(Ve,1)||Se[1],Hd(Ve,2)||Se[2]],gt=_u(i.zoom);if(gt>0){const dt=function({x:qt,y:yt,z:Ot},Rt,Ut,Jt,St){const si=1/(1<<Ot);let wi=qt*si,hi=wi+si,qi=yt*si,Qt=qi+si,Li=0;const Xi=(wi+hi)/2-Jt;return Xi>.5?Li=-1:Xi<-.5&&(Li=1),wi=((wi+Li)*Rt-(Jt*=Rt))*Ut+Jt,hi=((hi+Li)*Rt-Jt)*Ut+Jt,qi=(qi*Rt-(St*=Rt))*Ut+St,Qt=(Qt*Rt-St)*Ut+St,[[wi,Qt,0],[hi,Qt,0],[hi,qi,0],[wi,qi,0]]}(r,e,i._pixelsPerMercatorPixel,Y,ie);for(let qt=0;qt<y.length;qt++)Ma(y[qt],dt[qt],gt);const At=Aa([],dt[Re],dt[(Re+1)%4]);so(At,At,.5),Ma(Be,At,gt)}for(const dt of y)Ws(k,k,dt),Ko(M,M,dt);return k[2]=Math.min(Se[2],De[2]),Ws(k,k,Be),Ko(M,M,Be),new ls(k,M)}function qd({x:i,y:e,z:r}){const a=1/(1<<r),h=new Rr(Io(i*a),xs((e+1)*a)),m=new Rr(Io((i+1)*a),xs(e*a));return new as(h,m)}function lh(i){const e=wt(i.getNorth()),r=wt(i.getSouth()),a=Math.cos(e),h=Math.cos(r),m=Math.sin(e),y=Math.sin(r),w=i.getWest(),M=i.getEast();return[ch(h,y,w),ch(h,y,M),ch(a,m,M),ch(a,m,w)]}function ch(i,e,r,a=Ka){return r=wt(r),[i*Math.sin(r)*a,-e*a,i*Math.cos(r)*a]}function mu(i,e,r){return ch(Math.cos(wt(i)),Math.sin(wt(i)),e,r)}function Xd(i,e,r,a){const h=1<<r.z,m=(i/Ai+r.x)/h;return mu(xs((e/Ai+r.y)/h),Io(m),a)}function gu({min:i,max:e}){return M_/Math.max(e[0]-i[0],e[1]-i[1],e[2]-i[2])}const yc=new Float64Array(16);function hh(i){const e=gu(i),r=zm(yc,[e,e,e]);return Fd(r,r,((a=[])[0]=-(h=i.min)[0],a[1]=-h[1],a[2]=-h[2],a));var a,h}function Vm(i){const e=(a=i.min,(r=yc)[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=a[0],r[13]=a[1],r[14]=a[2],r[15]=1,r);var r,a;const h=1/gu(i);return Al(e,e,[h,h,h])}function L_(i,e,r,a,h){const m=function(M){const k=Ai/(2*Math.PI);return M/(2*Math.PI)/k}(r),y=[i,e,-r/(2*Math.PI)],w=Co(new Float64Array(16));return Fd(w,w,y),Al(w,w,[m,m,m]),Nd(w,w,wt(-h)),hp(w,w,wt(-a)),w}function _u(i){return Pr(Gd,gp,i)}function D_(i,e){const r=mu(e.lat,e.lng),a=function(Y){const ie=mu(Y._center.lat,Y._center.lng);let de=Za([],gc(0,1,0),ie);const Ee=mc([],-Y.angle,ie);de=pn(de,de,Ee),mc(Ee,-Y._pitch,de);const Re=zs([],ie);return so(Re,Re,_p(Y.cameraToCenterDistance/Y.pixelsPerMeter)),pn(Re,Re,Ee),Aa([],ie,Re)}(i);return y=(h=dp([],a,r))[0],w=h[1],M=h[2],k=(m=r)[0],B=m[1],U=m[2],X=(G=Math.sqrt(y*y+w*w+M*M)*Math.sqrt(k*k+B*B+U*U))&&oo(h,m)/G,Math.acos(Math.min(Math.max(X,-1),1));var h,m,y,w,M,k,B,U,G,X}function jm(i,e){return D_(i,e)>Math.PI/2*1.01}const O_=wt(85),ev=Math.cos(O_),tv=Math.sin(O_),Zd=63710088e-1,R_=2*Math.PI*Zd;class xc{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xc(tr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,a=this.lat*r,h=e.lat*r,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*r);return Zd*Math.acos(Math.min(m,1))}toBounds(e=0){const r=360*e/40075017,a=r/Math.cos(Math.PI/180*this.lat);return new as(new xc(this.lng-a,this.lat-r),new xc(this.lng+a,this.lat+r))}toEcef(e){const r=_p(e);return mu(this.lat,this.lng,Ka+r)}static convert(e){if(e instanceof xc)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new xc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new xc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Rr=xc;function $m(i){return R_*Math.cos(i*Math.PI/180)}function Ia(i){return(180+i)/360}function ea(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function ka(i,e){return i/$m(e)}function Io(i){return 360*i-180}function xs(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Yd(i,e){return i*$m(xs(e))}const ko=85.051129;function Gm(i){return 1/Math.cos(i*Math.PI/180)}class yu{constructor(e,r,a=0){this.x=+e,this.y=+r,this.z=+a}static fromLngLat(e,r=0){const a=Rr.convert(e);return new yu(Ia(a.lng),ea(a.lat),ka(r,a.lat))}toLngLat(){return new Rr(Io(this.x),xs(this.y))}toAltitude(){return Yd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/R_*Gm(xs(this.y))}}function xu(i,e,r,a,h,m,y,w,M){const k=(e+a)/2,B=(r+h)/2,U=new He(k,B);w(U),function(G,X,Y,ie,de,Ee){const Re=Y-de,Se=ie-Ee;return Math.abs((ie-X)*Re-(Y-G)*Se)/Math.hypot(Re,Se)}(U.x,U.y,m.x,m.y,y.x,y.y)>=M?(xu(i,e,r,k,B,m,U,w,M),xu(i,k,B,a,h,U,y,w,M)):i.push(y)}function yp(i,e,r){let a=i[0],h=a.x,m=a.y;e(a);const y=[a];for(let w=1;w<i.length;w++){const M=i[w],{x:k,y:B}=M;e(M),xu(y,h,m,k,B,a,M,e,r),h=k,m=B,a=M}return y}function xp(i,e,r,a){if(a(e,r)){const h=e.add(r)._mult(.5);xp(i,e,h,a),xp(i,h,r,a)}else i.push(r)}function iv(i,e){let r=i[0];const a=[r];for(let h=1;h<i.length;h++){const m=i[h];xp(a,r,m,e),r=m}return a}const Kd=Math.pow(2,14)-1,z_=-Kd-1;function rv(i,e){const r=Math.round(i.x*e),a=Math.round(i.y*e);return i.x=xi(r,z_,Kd),i.y=xi(a,z_,Kd),(r<i.x||r>i.x+1||a<i.y||a>i.y+1)&&Lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Pa(i,e,r){const a=i.loadGeometry(),h=i.extent,m=Ai/h;if(e&&r&&r.projection.isReprojectedInTileSpace){const y=1<<e.z,{scale:w,x:M,y:k,projection:B}=r,U=G=>{const X=Io((e.x+G.x/h)/y),Y=xs((e.y+G.y/h)/y),ie=B.project(X,Y);G.x=(ie.x*w-M)*h,G.y=(ie.y*w-k)*h};for(let G=0;G<a.length;G++)if(i.type!==1)a[G]=yp(a[G],U,1);else{const X=[];for(const Y of a[G])Y.x<0||Y.x>=h||Y.y<0||Y.y>=h||(U(Y),X.push(Y));a[G]=X}}for(const y of a)for(const w of y)rv(w,m);return a}function uh(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Pa(i):[]}}function vp(i,e,r,a,h){i.emplaceBack(2*e+(a+1)/2,2*r+(h+1)/2)}function bp(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class vu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Nt,this.indexArray=new Ci,this.segments=new An,this.programConfigurations=new pc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a,h){const m=this.layers[0],y=[];let w=null;m.type==="circle"&&(w=m.layout.get("circle-sort-key"));for(const{feature:k,id:B,index:U,sourceLayerIndex:G}of e){const X=this.layers[0]._featureFilter.needGeometry,Y=uh(k,X);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),Y,a))continue;const ie=w?w.evaluate(Y,{},a):void 0,de={id:B,properties:k.properties,type:k.type,sourceLayerIndex:G,index:U,geometry:X?Y.geometry:Pa(k,a,h),patterns:{},sortKey:ie};y.push(de)}w&&y.sort((k,B)=>k.sortKey-B.sortKey);let M=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new jt,M=h.projection);for(const k of y){const{geometry:B,index:U,sourceLayerIndex:G}=k,X=e[U].feature;this.addFeature(k,B,U,r.availableImages,a,M),r.featureIndex.insert(X,B,U,G,this.index)}}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yx.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Sl.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,a,h,m,y){for(const w of r)for(const M of w){const k=M.x,B=M.y;if(k<0||k>=Ai||B<0||B>=Ai)continue;if(y){const X=y.projectTilePoint(k,B,m),Y=y.upVector(m,k,B),ie=this.globeExtVertexArray;bp(ie,X,Y),bp(ie,X,Y),bp(ie,X,Y),bp(ie,X,Y)}const U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),G=U.vertexLength;vp(this.layoutVertexArray,k,B,-1,-1),vp(this.layoutVertexArray,k,B,1,-1),vp(this.layoutVertexArray,k,B,1,1),vp(this.layoutVertexArray,k,B,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+2,G+3),U.vertexLength+=4,U.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h,m)}}function Jd(i,e){for(let r=0;r<i.length;r++)if(Ja(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Ja(i,e[r]))return!0;return!!wp(i,e)}function B_(i,e,r){return!!Ja(i,e)||!!Qd(e,i,r)}function Wm(i,e){if(i.length===1)return N_(e,i[0]);for(let r=0;r<e.length;r++){const a=e[r];for(let h=0;h<a.length;h++)if(Ja(i,a[h]))return!0}for(let r=0;r<i.length;r++)if(N_(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(wp(i,e[r]))return!0;return!1}function F_(i,e,r){if(i.length>1){if(wp(i,e))return!0;for(let a=0;a<e.length;a++)if(Qd(e[a],i,r))return!0}for(let a=0;a<i.length;a++)if(Qd(i[a],e,r))return!0;return!1}function wp(i,e){if(i.length===0||e.length===0)return!1;for(let r=0;r<i.length-1;r++){const a=i[r],h=i[r+1];for(let m=0;m<e.length-1;m++)if(Tp(a,h,e[m],e[m+1]))return!0}return!1}function Tp(i,e,r,a){return It(i,r,a)!==It(e,r,a)&&It(i,e,r)!==It(i,e,a)}function Qd(i,e,r){const a=r*r;if(e.length===1)return i.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(bu(i,e[h-1],e[h])<a)return!0;return!1}function bu(i,e,r){const a=e.distSqr(r);if(a===0)return i.distSqr(e);const h=((i.x-e.x)*(r.x-e.x)+(i.y-e.y)*(r.y-e.y))/a;return i.distSqr(h<0?e:h>1?r:r.sub(e)._mult(h)._add(e))}function N_(i,e){let r,a,h,m=!1;for(let y=0;y<i.length;y++){r=i[y];for(let w=0,M=r.length-1;w<r.length;M=w++)a=r[w],h=r[M],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function Ja(i,e){let r=!1;for(let a=0,h=i.length-1;a<i.length;h=a++){const m=i[a],y=i[h];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(r=!r)}return r}function ef(i,e,r,a,h){for(const y of i)if(e<=y.x&&r<=y.y&&a>=y.x&&h>=y.y)return!0;const m=[new He(e,r),new He(e,h),new He(a,h),new He(a,r)];if(i.length>2){for(const y of m)if(Ja(i,y))return!0}for(let y=0;y<i.length-1;y++)if(nv(i[y],i[y+1],m))return!0;return!1}function nv(i,e,r){const a=r[0],h=r[2];if(i.x<a.x&&e.x<a.x||i.x>h.x&&e.x>h.x||i.y<a.y&&e.y<a.y||i.y>h.y&&e.y>h.y)return!1;const m=It(i,e,r[0]);return m!==It(i,e,r[1])||m!==It(i,e,r[2])||m!==It(i,e,r[3])}function wu(i,e,r){const a=e.paint.get(i).value;return a.kind==="constant"?a.value:r.programConfigurations.get(e.id).getMaxValue(i)}function Qa(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Hm(i,e,r,a,h){if(!e[0]&&!e[1])return i;const m=He.convert(e)._mult(h);r==="viewport"&&m._rotate(-a);const y=[];for(let w=0;w<i.length;w++)y.push(i[w].sub(m));return y}function Ep(i,e,r,a){const h=He.convert(i)._mult(a);return e==="viewport"&&h._rotate(-r),h}_i(vu,"CircleBucket",{omit:["layers"]});const U_=new ke({"circle-sort-key":new pe(Et.layout_circle["circle-sort-key"])});var vc={paint:new ke({"circle-radius":new pe(Et.paint_circle["circle-radius"]),"circle-color":new pe(Et.paint_circle["circle-color"]),"circle-blur":new pe(Et.paint_circle["circle-blur"]),"circle-opacity":new pe(Et.paint_circle["circle-opacity"]),"circle-translate":new ee(Et.paint_circle["circle-translate"]),"circle-translate-anchor":new ee(Et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ee(Et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ee(Et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pe(Et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pe(Et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pe(Et.paint_circle["circle-stroke-opacity"])}),layout:U_};function Tu(i,e,r,a,h,m,y,w,M){if(m&&i.queryGeometry.isAboveHorizon)return!1;m&&(M*=i.pixelToTileUnitsFactor);const k=i.tileID.canonical,B=r.projection.upVectorScale(k,r.center.lat,r.worldSize).metersToTile;for(const U of e)for(const G of U){const X=G.add(w),Y=h&&r.elevation?r.elevation.exaggeration()*h.getElevationAt(X.x,X.y,!0):0,ie=r.projection.projectTilePoint(X.x,X.y,k);if(Y>0){const Se=r.projection.upVector(k,X.x,X.y);ie.x+=Se[0]*B*Y,ie.y+=Se[1]*B*Y,ie.z+=Se[2]*B*Y}const de=m?X:tf(ie.x,ie.y,ie.z,a),Ee=m?i.tilespaceRays.map(Se=>sv(Se,Y)):i.queryGeometry.screenGeometry,Re=Bs([],[ie.x,ie.y,ie.z,1],a);if(!y&&m?M*=Re[3]/r.cameraToCenterDistance:y&&!m&&(M*=r.cameraToCenterDistance/Re[3]),m){const Se=xs((G.y/Ai+k.y)/(1<<k.z));M/=r.projection.pixelsPerMeter(Se,1)/ka(1,Se)}if(B_(Ee,de,M))return!0}return!1}function tf(i,e,r,a){const h=Bs([],[i,e,r,1],a);return new He(h[0]/h[3],h[1]/h[3])}const V_=gc(0,0,0),rf=gc(0,0,1);function sv(i,e){const r=up();return V_[2]=e,i.intersectsPlane(V_,rf,r),new He(r[0],r[1])}class qm extends vu{}function nf(i,{width:e,height:r},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*r*a)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*r*a);return i.width=e,i.height=r,i.data=h,i}function j_(i,e,r){const{width:a,height:h}=e;a===i.width&&h===i.height||(Sp(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,a),height:Math.min(i.height,h)},r),i.width=a,i.height=h,i.data=e.data)}function Sp(i,e,r,a,h,m){if(h.width===0||h.height===0)return e;if(h.width>i.width||h.height>i.height||r.x>i.width-h.width||r.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,w=e.data;for(let M=0;M<h.height;M++){const k=((r.y+M)*i.width+r.x)*m,B=((a.y+M)*e.width+a.x)*m;for(let U=0;U<h.width*m;U++)w[B+U]=y[k+U]}return e}_i(qm,"HeatmapBucket",{omit:["layers"]});class Ml{constructor(e,r){nf(this,e,1,r)}resize(e){j_(this,new Ml(e),1)}clone(){return new Ml({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,h,m){Sp(e,r,a,h,m,1)}}class ao{constructor(e,r){nf(this,e,4,r)}resize(e){j_(this,new ao(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ao({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,h,m){Sp(e,r,a,h,m,4)}}_i(Ml,"AlphaImage"),_i(ao,"RGBAImage");var ov={paint:new ke({"heatmap-radius":new pe(Et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pe(Et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ee(Et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ce(Et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ee(Et.paint_heatmap["heatmap-opacity"])})};function Xm(i){const e={},r=i.resolution||256,a=i.clips?i.clips.length:1,h=i.image||new ao({width:r,height:a}),m=(y,w,M)=>{e[i.evaluationKey]=M;const k=i.expression.evaluate(e);h.data[y+w+0]=Math.floor(255*k.r/k.a),h.data[y+w+1]=Math.floor(255*k.g/k.a),h.data[y+w+2]=Math.floor(255*k.b/k.a),h.data[y+w+3]=Math.floor(255*k.a)};if(i.clips)for(let y=0,w=0;y<a;++y,w+=4*r)for(let M=0,k=0;M<r;M++,k+=4){const B=M/(r-1),{start:U,end:G}=i.clips[y];m(w,k,U*(1-B)+G*B)}else for(let y=0,w=0;y<r;y++,w+=4)m(0,w,y/(r-1));return h}var av={paint:new ke({"hillshade-illumination-direction":new ee(Et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ee(Et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ee(Et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ee(Et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ee(Et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ee(Et.paint_hillshade["hillshade-accent-color"])})};const Zm=et([{name:"a_pos",components:2,type:"Int16"}],4),{members:lv}=Zm;var Cp={exports:{}};function Ap(i,e,r){r=r||2;var a,h,m,y,w,M,k,B=e&&e.length,U=B?e[0]*r:i.length,G=$_(i,0,U,r,!0),X=[];if(!G||G.next===G.prev)return X;if(B&&(G=function(ie,de,Ee,Re){var Se,De,Ve,Be=[];for(Se=0,De=de.length;Se<De;Se++)(Ve=$_(ie,de[Se]*Re,Se<De-1?de[Se+1]*Re:ie.length,Re,!1))===Ve.next&&(Ve.steiner=!0),Be.push(dv(Ve));for(Be.sort(hv),Se=0;Se<Be.length;Se++)Ee=W_(Be[Se],Ee);return Ee}(i,e,G,r)),i.length>80*r){a=m=i[0],h=y=i[1];for(var Y=r;Y<U;Y+=r)(w=i[Y])<a&&(a=w),(M=i[Y+1])<h&&(h=M),w>m&&(m=w),M>y&&(y=M);k=(k=Math.max(m-a,y-h))!==0?32767/k:0}return bc(G,X,r,a,h,k,0),X}function $_(i,e,r,a,h){var m,y;if(h===af(i,e,r,a)>0)for(m=e;m<r;m+=a)y=Jm(m,i[m],i[m+1],y);else for(m=r-a;m>=e;m-=a)y=Jm(m,i[m],i[m+1],y);return y&&kp(y,y.next)&&(fh(y),y=y.next),y}function dh(i,e){if(!i)return i;e||(e=i);var r,a=i;do if(r=!1,a.steiner||!kp(a,a.next)&&Nn(a.prev,a,a.next)!==0)a=a.next;else{if(fh(a),(a=e=a.prev)===a.next)break;r=!0}while(r||a!==e);return e}function bc(i,e,r,a,h,m,y){if(i){!y&&m&&function(B,U,G,X){var Y=B;do Y.z===0&&(Y.z=Ip(Y.x,Y.y,U,G,X)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==B);Y.prevZ.nextZ=null,Y.prevZ=null,function(ie){var de,Ee,Re,Se,De,Ve,Be,gt,dt=1;do{for(Ee=ie,ie=null,De=null,Ve=0;Ee;){for(Ve++,Re=Ee,Be=0,de=0;de<dt&&(Be++,Re=Re.nextZ);de++);for(gt=dt;Be>0||gt>0&&Re;)Be!==0&&(gt===0||!Re||Ee.z<=Re.z)?(Se=Ee,Ee=Ee.nextZ,Be--):(Se=Re,Re=Re.nextZ,gt--),De?De.nextZ=Se:ie=Se,Se.prevZ=De,De=Se;Ee=Re}De.nextZ=null,dt*=2}while(Ve>1)}(Y)}(i,a,h,m);for(var w,M,k=i;i.prev!==i.next;)if(w=i.prev,M=i.next,m?cv(i,a,h,m):G_(i))e.push(w.i/r|0),e.push(i.i/r|0),e.push(M.i/r|0),fh(i),i=M.next,k=M.next;else if((i=M)===k){y?y===1?bc(i=Ym(dh(i),e,r),e,r,a,h,m,2):y===2&&Mp(i,e,r,a,h,m):bc(dh(i),e,r,a,h,m,1);break}}}function G_(i){var e=i.prev,r=i,a=i.next;if(Nn(e,r,a)>=0)return!1;for(var h=e.x,m=r.x,y=a.x,w=e.y,M=r.y,k=a.y,B=h<m?h<y?h:y:m<y?m:y,U=w<M?w<k?w:k:M<k?M:k,G=h>m?h>y?h:y:m>y?m:y,X=w>M?w>k?w:k:M>k?M:k,Y=a.next;Y!==e;){if(Y.x>=B&&Y.x<=G&&Y.y>=U&&Y.y<=X&&Eu(h,w,m,M,y,k,Y.x,Y.y)&&Nn(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function cv(i,e,r,a){var h=i.prev,m=i,y=i.next;if(Nn(h,m,y)>=0)return!1;for(var w=h.x,M=m.x,k=y.x,B=h.y,U=m.y,G=y.y,X=w<M?w<k?w:k:M<k?M:k,Y=B<U?B<G?B:G:U<G?U:G,ie=w>M?w>k?w:k:M>k?M:k,de=B>U?B>G?B:G:U>G?U:G,Ee=Ip(X,Y,e,r,a),Re=Ip(ie,de,e,r,a),Se=i.prevZ,De=i.nextZ;Se&&Se.z>=Ee&&De&&De.z<=Re;){if(Se.x>=X&&Se.x<=ie&&Se.y>=Y&&Se.y<=de&&Se!==h&&Se!==y&&Eu(w,B,M,U,k,G,Se.x,Se.y)&&Nn(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,De.x>=X&&De.x<=ie&&De.y>=Y&&De.y<=de&&De!==h&&De!==y&&Eu(w,B,M,U,k,G,De.x,De.y)&&Nn(De.prev,De,De.next)>=0))return!1;De=De.nextZ}for(;Se&&Se.z>=Ee;){if(Se.x>=X&&Se.x<=ie&&Se.y>=Y&&Se.y<=de&&Se!==h&&Se!==y&&Eu(w,B,M,U,k,G,Se.x,Se.y)&&Nn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;De&&De.z<=Re;){if(De.x>=X&&De.x<=ie&&De.y>=Y&&De.y<=de&&De!==h&&De!==y&&Eu(w,B,M,U,k,G,De.x,De.y)&&Nn(De.prev,De,De.next)>=0)return!1;De=De.nextZ}return!0}function Ym(i,e,r){var a=i;do{var h=a.prev,m=a.next.next;!kp(h,m)&&Km(h,a,a.next,m)&&of(h,m)&&of(m,h)&&(e.push(h.i/r|0),e.push(a.i/r|0),e.push(m.i/r|0),fh(a),fh(a.next),a=i=m),a=a.next}while(a!==i);return dh(a)}function Mp(i,e,r,a,h,m){var y=i;do{for(var w=y.next.next;w!==y.prev;){if(y.i!==w.i&&fv(y,w)){var M=H_(y,w);return y=dh(y,y.next),M=dh(M,M.next),bc(y,e,r,a,h,m,0),void bc(M,e,r,a,h,m,0)}w=w.next}y=y.next}while(y!==i)}function hv(i,e){return i.x-e.x}function W_(i,e){var r=function(h,m){var y,w=m,M=h.x,k=h.y,B=-1/0;do{if(k<=w.y&&k>=w.next.y&&w.next.y!==w.y){var U=w.x+(k-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(U<=M&&U>B&&(B=U,y=w.x<w.next.x?w:w.next,U===M))return y}w=w.next}while(w!==m);if(!y)return null;var G,X=y,Y=y.x,ie=y.y,de=1/0;w=y;do M>=w.x&&w.x>=Y&&M!==w.x&&Eu(k<ie?M:B,k,Y,ie,k<ie?B:M,k,w.x,w.y)&&(G=Math.abs(k-w.y)/(M-w.x),of(w,h)&&(G<de||G===de&&(w.x>y.x||w.x===y.x&&uv(y,w)))&&(y=w,de=G)),w=w.next;while(w!==X);return y}(i,e);if(!r)return e;var a=H_(r,i);return dh(a,a.next),dh(r,r.next)}function uv(i,e){return Nn(i.prev,i,e.prev)<0&&Nn(e.next,i,i.next)<0}function Ip(i,e,r,a,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function dv(i){var e=i,r=i;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==i);return r}function Eu(i,e,r,a,h,m,y,w){return(h-y)*(e-w)>=(i-y)*(m-w)&&(i-y)*(a-w)>=(r-y)*(e-w)&&(r-y)*(m-w)>=(h-y)*(a-w)}function fv(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(r,a){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==a.i&&h.next.i!==a.i&&Km(h,h.next,r,a))return!0;h=h.next}while(h!==r);return!1}(i,e)&&(of(i,e)&&of(e,i)&&function(r,a){var h=r,m=!1,y=(r.x+a.x)/2,w=(r.y+a.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==r);return m}(i,e)&&(Nn(i.prev,i,e.prev)||Nn(i,e.prev,e))||kp(i,e)&&Nn(i.prev,i,i.next)>0&&Nn(e.prev,e,e.next)>0)}function Nn(i,e,r){return(e.y-i.y)*(r.x-e.x)-(e.x-i.x)*(r.y-e.y)}function kp(i,e){return i.x===e.x&&i.y===e.y}function Km(i,e,r,a){var h=sf(Nn(i,e,r)),m=sf(Nn(i,e,a)),y=sf(Nn(r,a,i)),w=sf(Nn(r,a,e));return h!==m&&y!==w||!(h!==0||!Pp(i,r,e))||!(m!==0||!Pp(i,a,e))||!(y!==0||!Pp(r,i,a))||!(w!==0||!Pp(r,e,a))}function Pp(i,e,r){return e.x<=Math.max(i.x,r.x)&&e.x>=Math.min(i.x,r.x)&&e.y<=Math.max(i.y,r.y)&&e.y>=Math.min(i.y,r.y)}function sf(i){return i>0?1:i<0?-1:0}function of(i,e){return Nn(i.prev,i,i.next)<0?Nn(i,e,i.next)>=0&&Nn(i,i.prev,e)>=0:Nn(i,e,i.prev)<0||Nn(i,i.next,e)<0}function H_(i,e){var r=new Qm(i.i,i.x,i.y),a=new Qm(e.i,e.x,e.y),h=i.next,m=e.prev;return i.next=e,e.prev=i,r.next=h,h.prev=r,a.next=r,r.prev=a,m.next=a,a.prev=m,a}function Jm(i,e,r,a){var h=new Qm(i,e,r);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function fh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Qm(i,e,r){this.i=i,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function af(i,e,r,a){for(var h=0,m=e,y=r-a;m<r;m+=a)h+=(i[y]-i[m])*(i[m+1]+i[y+1]),y=m;return h}Cp.exports=Ap,Cp.exports.default=Ap,Ap.deviation=function(i,e,r,a){var h=e&&e.length,m=Math.abs(af(i,0,h?e[0]*r:i.length,r));if(h)for(var y=0,w=e.length;y<w;y++)m-=Math.abs(af(i,e[y]*r,y<w-1?e[y+1]*r:i.length,r));var M=0;for(y=0;y<a.length;y+=3){var k=a[y]*r,B=a[y+1]*r,U=a[y+2]*r;M+=Math.abs((i[k]-i[U])*(i[B+1]-i[k+1])-(i[k]-i[B])*(i[U+1]-i[k+1]))}return m===0&&M===0?0:Math.abs((M-m)/m)},Ap.flatten=function(i){for(var e=i[0][0].length,r={vertices:[],holes:[],dimensions:e},a=0,h=0;h<i.length;h++){for(var m=0;m<i[h].length;m++)for(var y=0;y<e;y++)r.vertices.push(i[h][m][y]);h>0&&r.holes.push(a+=i[h-1].length)}return r};var eg=ge(Cp.exports);function pv(i,e,r,a,h){q_(i,e,r,a||i.length-1,h||mv)}function q_(i,e,r,a,h){for(;a>r;){if(a-r>600){var m=a-r+1,y=e-r+1,w=Math.log(m),M=.5*Math.exp(2*w/3),k=.5*Math.sqrt(w*M*(m-M)/m)*(y-m/2<0?-1:1);q_(i,e,Math.max(r,Math.floor(e-y*M/m+k)),Math.min(a,Math.floor(e+(m-y)*M/m+k)),h)}var B=i[e],U=r,G=a;for(Su(i,r,e),h(i[a],B)>0&&Su(i,r,a);U<G;){for(Su(i,U,G),U++,G--;h(i[U],B)<0;)U++;for(;h(i[G],B)>0;)G--}h(i[r],B)===0?Su(i,r,G):Su(i,++G,a),G<=e&&(r=G+1),e<=G&&(a=G-1)}}function Su(i,e,r){var a=i[e];i[e]=i[r],i[r]=a}function mv(i,e){return i<e?-1:i>e?1:0}function Lp(i,e){const r=i.length;if(r<=1)return[i];const a=[];let h,m;for(let y=0;y<r;y++){const w=Xt(i[y]);w!==0&&(i[y].area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(h&&a.push(h),h=[i[y]]):h.push(i[y]))}if(h&&a.push(h),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(pv(a[y],e,1,a[y].length-1,X_),a[y]=a[y].slice(0,e));return a}function X_(i,e){return e.area-i.area}function tg(i,e,r){const a=r.patternDependencies;let h=!1;for(const m of e){const y=m.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const w=y.constantOr(null);w&&(h=!0,a[w]=!0)}return h}function ig(i,e,r,a,h){const m=h.patternDependencies;for(const y of e){const w=y.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let M=w.evaluate({zoom:a},r,{},h.availableImages);M=M&&M.name?M.name:M,m[M]=!0,r.patterns[y.id]=M}}return r}class lf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Nt,this.indexArray=new Ci,this.indexArray2=new is,this.programConfigurations=new pc(e.layers,e.zoom),this.segments=new An,this.segments2=new An,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,a,h){this.hasPattern=tg("fill",this.layers,r);const m=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:w,id:M,index:k,sourceLayerIndex:B}of e){const U=this.layers[0]._featureFilter.needGeometry,G=uh(w,U);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),G,a))continue;const X=m?m.evaluate(G,{},a,r.availableImages):void 0,Y={id:M,properties:w.properties,type:w.type,sourceLayerIndex:B,index:k,geometry:U?G.geometry:Pa(w,a,h),patterns:{},sortKey:X};y.push(Y)}m&&y.sort((w,M)=>w.sortKey-M.sortKey);for(const w of y){const{geometry:M,index:k,sourceLayerIndex:B}=w;if(this.hasPattern){const U=ig("fill",this.layers,w,this.zoom,r);this.patternFeatures.push(U)}else this.addFeature(w,M,k,a,{},r.availableImages);r.featureIndex.insert(e[k].feature,M,k,B,this.index)}}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}addFeatures(e,r,a,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,r,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lv),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,a,h,m,y=[]){for(const w of Lp(r,500)){let M=0;for(const Y of w)M+=Y.length;const k=this.segments.prepareSegment(M,this.layoutVertexArray,this.indexArray),B=k.vertexLength,U=[],G=[];for(const Y of w){if(Y.length===0)continue;Y!==w[0]&&G.push(U.length/2);const ie=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),de=ie.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(de+Y.length-1,de),U.push(Y[0].x),U.push(Y[0].y);for(let Ee=1;Ee<Y.length;Ee++)this.layoutVertexArray.emplaceBack(Y[Ee].x,Y[Ee].y),this.indexArray2.emplaceBack(de+Ee-1,de+Ee),U.push(Y[Ee].x),U.push(Y[Ee].y);ie.vertexLength+=Y.length,ie.primitiveLength+=Y.length}const X=eg(U,G);for(let Y=0;Y<X.length;Y+=3)this.indexArray.emplaceBack(B+X[Y],B+X[Y+1],B+X[Y+2]);k.vertexLength+=M,k.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}}_i(lf,"FillBucket",{omit:["layers","patternFeatures"]});const gv=new ke({"fill-sort-key":new pe(Et.layout_fill["fill-sort-key"])});var _v={paint:new ke({"fill-antialias":new ee(Et.paint_fill["fill-antialias"]),"fill-opacity":new pe(Et.paint_fill["fill-opacity"]),"fill-color":new pe(Et.paint_fill["fill-color"]),"fill-outline-color":new pe(Et.paint_fill["fill-outline-color"]),"fill-translate":new ee(Et.paint_fill["fill-translate"]),"fill-translate-anchor":new ee(Et.paint_fill["fill-translate-anchor"]),"fill-pattern":new pe(Et.paint_fill["fill-pattern"])}),layout:gv};const yv=et([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),xv=et([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Z_=et([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Y_}=yv;var Dp={},vv=Ie,rg=Cu;function Cu(i,e,r,a,h){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=a,this._values=h,i.readFields(K_,this,e)}function K_(i,e,r){i==1?e.id=r.readVarint():i==2?function(a,h){for(var m=a.readVarint()+a.pos;a.pos<m;){var y=h._keys[a.readVarint()],w=h._values[a.readVarint()];h.properties[y]=w}}(r,e):i==3?e.type=r.readVarint():i==4&&(e._geometry=r.pos)}function bv(i){for(var e,r,a=0,h=0,m=i.length,y=m-1;h<m;y=h++)a+=((r=i[y]).x-(e=i[h]).x)*(e.y+r.y);return a}Cu.types=["Unknown","Point","LineString","Polygon"],Cu.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,r=i.readVarint()+i.pos,a=1,h=0,m=0,y=0,w=[];i.pos<r;){if(h<=0){var M=i.readVarint();a=7&M,h=M>>3}if(h--,a===1||a===2)m+=i.readSVarint(),y+=i.readSVarint(),a===1&&(e&&w.push(e),e=[]),e.push(new vv(m,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&w.push(e),w},Cu.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,r=1,a=0,h=0,m=0,y=1/0,w=-1/0,M=1/0,k=-1/0;i.pos<e;){if(a<=0){var B=i.readVarint();r=7&B,a=B>>3}if(a--,r===1||r===2)(h+=i.readSVarint())<y&&(y=h),h>w&&(w=h),(m+=i.readSVarint())<M&&(M=m),m>k&&(k=m);else if(r!==7)throw new Error("unknown command "+r)}return[y,M,w,k]},Cu.prototype.toGeoJSON=function(i,e,r){var a,h,m=this.extent*Math.pow(2,r),y=this.extent*i,w=this.extent*e,M=this.loadGeometry(),k=Cu.types[this.type];function B(X){for(var Y=0;Y<X.length;Y++){var ie=X[Y];X[Y]=[360*(ie.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ie.y+w)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(a=0;a<M.length;a++)U[a]=M[a][0];B(M=U);break;case 2:for(a=0;a<M.length;a++)B(M[a]);break;case 3:for(M=function(X){var Y=X.length;if(Y<=1)return[X];for(var ie,de,Ee=[],Re=0;Re<Y;Re++){var Se=bv(X[Re]);Se!==0&&(de===void 0&&(de=Se<0),de===Se<0?(ie&&Ee.push(ie),ie=[X[Re]]):ie.push(X[Re]))}return ie&&Ee.push(ie),Ee}(M),a=0;a<M.length;a++)for(h=0;h<M[a].length;h++)B(M[a][h])}M.length===1?M=M[0]:k="Multi"+k;var G={type:"Feature",geometry:{type:k,coordinates:M},properties:this.properties};return"id"in this&&(G.id=this.id),G};var J_=rg,ng=Q_;function Q_(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(ey,this,e),this.length=this._features.length}function ey(i,e,r){i===15?e.version=r.readVarint():i===1?e.name=r.readString():i===5?e.extent=r.readVarint():i===2?e._features.push(r.pos):i===3?e._keys.push(r.readString()):i===4&&e._values.push(function(a){for(var h=null,m=a.readVarint()+a.pos;a.pos<m;){var y=a.readVarint()>>3;h=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return h}(r))}Q_.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new J_(this._pbf,e,this.extent,this._keys,this._values)};var wv=ng;function sg(i,e,r){if(i===3){var a=new wv(r,r.readVarint()+r.pos);a.length&&(e[a.name]=a)}}var og=Dp.VectorTile=function(i,e){this.layers=i.readFields(sg,{},e)},cf=Dp.VectorTileFeature=rg;function hf(i,e,r,a){const h=[],m=a===0?(y,w,M,k,B,U)=>{y.push(new He(U,M+(U-w)/(k-w)*(B-M)))}:(y,w,M,k,B,U)=>{y.push(new He(w+(U-M)/(B-M)*(k-w),U))};for(const y of i){const w=[];for(const M of y){if(M.length<=2)continue;const k=[];for(let G=0;G<M.length-1;G++){const X=M[G].x,Y=M[G].y,ie=M[G+1].x,de=M[G+1].y,Ee=a===0?X:Y,Re=a===0?ie:de;Ee<e?Re>e&&m(k,X,Y,ie,de,e):Ee>r?Re<r&&m(k,X,Y,ie,de,r):k.push(M[G]),Re<e&&Ee>=e&&m(k,X,Y,ie,de,e),Re>r&&Ee<=r&&m(k,X,Y,ie,de,r)}let B=M[M.length-1];const U=a===0?B.x:B.y;U>=e&&U<=r&&k.push(B),k.length&&(B=k[k.length-1],k[0].x===B.x&&k[0].y===B.y||k.push(k[0]),w.push(k))}w.length&&h.push(w)}return h}Dp.VectorTileLayer=ng;const Tv=cf.types,Ev=Math.pow(2,13);function ph(i,e,r,a,h,m,y,w){i.emplaceBack((e<<1)+y,(r<<1)+m,(Math.floor(a*Ev)<<1)+h,Math.round(w))}function uf(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class ty{constructor(){this.acc=new He(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new He(e.x,e.y),this.max=new He(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,h=this.max;e.x<a.x?a.x=e.x:e.x>h.x&&(h.x=e.x),e.y<a.y?a.y=e.y:e.y>h.y&&(h.y=e.y),((e.x===0||e.x===Ai)&&e.x===r.x)!=((e.y===0||e.y===Ai)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,pr(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>Ai!=e.x>Ai&&this.addBorderIntersection(1,pr(r.y,e.y,(Ai-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,pr(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>Ai!=e.y>Ai&&this.addBorderIntersection(3,pr(r.x,e.x,(Ai-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];r<a[0]&&(a[0]=r),r>a[1]&&(a[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const a=e.x===0?0:1;this.addBorderIntersection(a,r.y),this.addBorderIntersection(a,e.y)}else{const a=e.y===0?2:3;this.addBorderIntersection(a,r.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((r,a)=>r+a.edges,0);return e!==0?this.acc.div(e)._round():new He(0,0)}span(){return new He(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class df{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Mt,this.centroidVertexArray=new Yo,this.indexArray=new Ci,this.programConfigurations=new pc(e.layers,e.zoom),this.segments=new An,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,a,h){this.features=[],this.hasPattern=tg("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const y=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*y/(y*y+1)/Ai/(1<<m.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:y,index:w,sourceLayerIndex:M}of e){const k=this.layers[0]._featureFilter.needGeometry,B=uh(m,k);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),B,a))continue;const U={id:y,sourceLayerIndex:M,index:w,geometry:k?B.geometry:Pa(m,a,h),properties:m.properties,type:m.type,patterns:{}},G=this.layoutVertexArray.length;this.hasPattern?this.features.push(ig("fill-extrusion",this.layers,U,this.zoom,r)):this.addFeature(U,U.geometry,w,a,{},r.availableImages,h),r.featureIndex.insert(m,U.geometry,w,M,this.index,G)}this.sortBorders()}addFeatures(e,r,a,h,m){for(const y of this.features){const{geometry:w}=y;this.addFeature(y,w,y.index,r,a,h,m)}this.sortBorders()}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Y_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Z_.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,xv.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,a,h,m,y,w){const M=[new He(0,0),new He(Ai,Ai)],k=w.projection,B=k.name==="globe",U=this.enableTerrain&&!B?new ty:null,G=Tv[e.type]==="Polygon";B&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new jt);const X=Lp(r,500);for(let Ee=X.length-1;Ee>=0;Ee--){const Re=X[Ee];(Re.length===0||(Y=Re[0]).every(Se=>Se.x<=0)||Y.every(Se=>Se.x>=Ai)||Y.every(Se=>Se.y<=0)||Y.every(Se=>Se.y>=Ai))&&X.splice(Ee,1)}var Y;let ie;if(B)ie=ag(X,M,h);else{ie=[];for(const Ee of X)ie.push({polygon:Ee,bounds:M})}const de=G?this.edgeRadius:0;for(const{polygon:Ee,bounds:Re}of ie){let Se=0,De=0;for(const Be of Ee)G&&!Be[0].equals(Be[Be.length-1])&&Be.push(Be[0]),De+=G?Be.length-1:Be.length;const Ve=this.segments.prepareSegment((G?5:4)*De,this.layoutVertexArray,this.indexArray);if(G){const Be=[],gt=[];Se=Ve.vertexLength;for(const At of Ee){let qt,yt;At.length&&At!==Ee[0]&&gt.push(Be.length/2),qt=At[1].sub(At[0])._perp()._unit();for(let Ot=1;Ot<At.length;Ot++){const Rt=At[Ot],Ut=At[Ot===At.length-1?1:Ot+1];let{x:Jt,y:St}=Rt;if(de){yt=Ut.sub(Rt)._perp()._unit();const si=qt.add(yt)._unit(),wi=de*Math.min(4,1/(qt.x*si.x+qt.y*si.y));Jt+=wi*si.x,St+=wi*si.y,qt=yt}ph(this.layoutVertexArray,Jt,St,0,0,1,1,0),Ve.vertexLength++,Be.push(Rt.x,Rt.y),B&&uf(this.layoutVertexExtArray,k.projectTilePoint(Jt,St,h),k.upVector(h,Jt,St))}}const dt=eg(Be,gt);for(let At=0;At<dt.length;At+=3)this.indexArray.emplaceBack(Se+dt[At],Se+dt[At+2],Se+dt[At+1]),Ve.primitiveLength++}for(const Be of Ee){U&&Be.length&&U.startRing(Be[0]);let gt,dt,At,qt=Be.length>4&&ny(Be[Be.length-2],Be[0],Be[1]),yt=de?Sv(Be[Be.length-2],Be[0],Be[1],de):0;dt=Be[1].sub(Be[0])._perp()._unit();let Ot=!0;for(let Rt=1,Ut=0;Rt<Be.length;Rt++){let Jt=Be[Rt-1],St=Be[Rt];const si=Be[Rt===Be.length-1?1:Rt+1];if(U&&G&&U.currentPolyCount.top++,ff(St,Jt,Re)){de&&(dt=si.sub(St)._perp()._unit(),Ot=!Ot);continue}U&&U.append(St,Jt);const wi=St.sub(Jt)._perp(),hi=wi.x/(Math.abs(wi.x)+Math.abs(wi.y)),qi=wi.y>0?1:0,Qt=Jt.dist(St);if(Ut+Qt>32768&&(Ut=0),de){At=si.sub(St)._perp()._unit();let Zi=ry(Jt,St,si,iy(dt,At),de);isNaN(Zi)&&(Zi=0);const zi=St.sub(Jt)._unit();Jt=Jt.add(zi.mult(yt))._round(),St=St.add(zi.mult(-Zi))._round(),yt=Zi,dt=At}const Li=Ve.vertexLength,Xi=Be.length>4&&ny(Jt,St,si);let Er=sy(Ut,qt,Ot);if(ph(this.layoutVertexArray,Jt.x,Jt.y,hi,qi,0,0,Er),ph(this.layoutVertexArray,Jt.x,Jt.y,hi,qi,0,1,Er),Ut+=Qt,Er=sy(Ut,Xi,!Ot),qt=Xi,ph(this.layoutVertexArray,St.x,St.y,hi,qi,0,0,Er),ph(this.layoutVertexArray,St.x,St.y,hi,qi,0,1,Er),Ve.vertexLength+=4,this.indexArray.emplaceBack(Li+0,Li+1,Li+2),this.indexArray.emplaceBack(Li+1,Li+3,Li+2),Ve.primitiveLength+=2,de){const Zi=Se+(Rt===1?Be.length-2:Rt-2),zi=Rt===1?Se:Zi+1;if(this.indexArray.emplaceBack(Li+1,Zi,Li+3),this.indexArray.emplaceBack(Zi,zi,Li+3),Ve.primitiveLength+=2,gt===void 0&&(gt=Li),!ff(si,Be[Rt],Re)){const an=Rt===Be.length-1?gt:Ve.vertexLength;this.indexArray.emplaceBack(Li+2,Li+3,an),this.indexArray.emplaceBack(Li+3,an+1,an),this.indexArray.emplaceBack(Li+3,zi,an+1),Ve.primitiveLength+=3}Ot=!Ot}if(B){const Zi=this.layoutVertexExtArray,zi=k.projectTilePoint(Jt.x,Jt.y,h),an=k.projectTilePoint(St.x,St.y,h),Ji=k.upVector(h,Jt.x,Jt.y),Qi=k.upVector(h,St.x,St.y);uf(Zi,zi,Ji),uf(Zi,zi,Ji),uf(Zi,an,Qi),uf(Zi,an,Qi)}}G&&(Se+=Be.length-1)}}if(U&&U.polyCount.length>0){if(U.borders){U.vertexArrayOffset=this.centroidVertexArray.length;const Ee=U.borders,Re=this.featuresOnBorder.push(U)-1;for(let Se=0;Se<4;Se++)Ee[Se][0]!==Number.MAX_VALUE&&this.borders[Se].push(Re)}this.encodeCentroid(U.borders?void 0:U.centroid(),U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,a)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,r,a=!0){let h,m;if(e)if(e.y!==0){const w=r.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(w.x/10)),m=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else h=Math.ceil(7*(e.x+450)),m=0;else h=0,m=+a;let y=a?this.centroidVertexArray.length:r.vertexArrayOffset;for(const w of r.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let M=0;M<w.top;M++)this.centroidVertexArray.emplace(y++,h,m);for(let M=0;M<2*w.edges;M++)this.centroidVertexArray.emplace(y++,0,m),this.centroidVertexArray.emplace(y++,h,m)}}}function iy(i,e){const r=i.add(e)._unit();return i.x*r.x+i.y*r.y}function Sv(i,e,r,a){const h=e.sub(i)._perp()._unit(),m=r.sub(e)._perp()._unit();return ry(i,e,r,iy(h,m),a)}function ry(i,e,r,a,h){const m=Math.sqrt(1-a*a);return Math.min(i.dist(e)/3,e.dist(r)/3,h*m/a)}function ff(i,e,r){return i.x<r[0].x&&e.x<r[0].x||i.x>r[1].x&&e.x>r[1].x||i.y<r[0].y&&e.y<r[0].y||i.y>r[1].y&&e.y>r[1].y}function ny(i,e,r){if(i.x<0||i.x>=Ai||e.x<0||e.x>=Ai||r.x<0||r.x>=Ai)return!1;const a=r.sub(e),h=a.perp(),m=i.sub(e);return(a.x*m.x+a.y*m.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(m.x*m.x+m.y*m.y))>-.866&&h.x*m.x+h.y*m.y<0}function sy(i,e,r){const a=e?2|i:-3&i;return r?1|a:-2&a}function oy(){const i=Math.PI/32,e=Math.tan(i),r=Zd;return r*Math.sqrt(1+2*e*e)-r}function ag(i,e,r){const a=1<<r.z,h=Io(r.x/a),m=Io((r.x+1)/a),y=xs(r.y/a),w=xs((r.y+1)/a);return function(M,k,B,U,G=0,X){const Y=[];if(!M.length||!B||!U)return Y;const ie=(Be,gt)=>{for(const dt of Be)Y.push({polygon:dt,bounds:gt})},de=Math.ceil(Math.log2(B)),Ee=Math.ceil(Math.log2(U)),Re=de-Ee,Se=[];for(let Be=0;Be<Math.abs(Re);Be++)Se.push(Re>0?0:1);for(let Be=0;Be<Math.min(de,Ee);Be++)Se.push(0),Se.push(1);let De=M;if(De=hf(De,k[0].y-G,k[1].y+G,1),De=hf(De,k[0].x-G,k[1].x+G,0),!De.length)return Y;const Ve=[];for(Se.length?Ve.push({polygons:De,bounds:k,depth:0}):ie(De,k);Ve.length;){const Be=Ve.pop(),gt=Be.depth,dt=Se[gt],At=Be.bounds[0],qt=Be.bounds[1],yt=dt===0?At.x:At.y,Ot=dt===0?qt.x:qt.y,Rt=X?X(dt,yt,Ot):.5*(yt+Ot),Ut=hf(Be.polygons,yt-G,Rt+G,dt),Jt=hf(Be.polygons,Rt-G,Ot+G,dt);if(Ut.length){const St=[At,new He(dt===0?Rt:qt.x,dt===1?Rt:qt.y)];Se.length>gt+1?Ve.push({polygons:Ut,bounds:St,depth:gt+1}):ie(Ut,St)}if(Jt.length){const St=[new He(dt===0?Rt:At.x,dt===1?Rt:At.y),qt];Se.length>gt+1?Ve.push({polygons:Jt,bounds:St,depth:gt+1}):ie(Jt,St)}}return Y}(i,e,Math.ceil((m-h)/11.25),Math.ceil((y-w)/11.25),1,(M,k,B)=>{if(M===0)return .5*(k+B);{const U=xs((r.y+k/Ai)/a);return(ea(.5*(xs((r.y+B/Ai)/a)+U))*a-r.y)*Ai}})}_i(df,"FillExtrusionBucket",{omit:["layers","features"]}),_i(ty,"PartMetadata");const R=new ke({"fill-extrusion-edge-radius":new ee(Et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var o={paint:new ke({"fill-extrusion-opacity":new ee(Et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pe(Et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ee(Et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ee(Et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new pe(Et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pe(Et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pe(Et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ee(Et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ee(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ee(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ee(Et["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:R};function u(i,e,r){var a=2*Math.PI*6378137/256/Math.pow(2,r);return[i*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class p{constructor(e,r,a){this.z=e,this.x=r,this.y=a,this.key=S(0,e,e,r,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const a=function(m,y,w){var M=u(256*m,256*(y=Math.pow(2,w)-y-1),w),k=u(256*(m+1),256*(y+1),w);return M[0]+","+M[1]+","+k[0]+","+k[1]}(this.x,this.y,this.z),h=function(m,y,w){let M,k="";for(let B=m;B>0;B--)M=1<<B-1,k+=(y&M?1:0)+(w&M?2:0);return k}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class x{constructor(e,r){this.wrap=e,this.canonical=r,this.key=S(e,r.z,r.z,r.x,r.y)}}class v{constructor(e,r,a,h,m){this.overscaledZ=e,this.wrap=r,this.canonical=new p(a,+h,+m),this.key=r===0&&e===a?this.canonical.key:S(r,e,a,h,m)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new v(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new v(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return S(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return S(this.wrap*+r,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new v(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new v(r,this.wrap,r,a,h),new v(r,this.wrap,r,a+1,h),new v(r,this.wrap,r,a,h+1),new v(r,this.wrap,r,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new v(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new v(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new x(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function S(i,e,r,a,h){const m=1<<Math.min(r,22);let y=m*(h%m)+a%m;return i&&r<22&&(y+=m*m*((i<0?-2*i-1:2*i)%(1<<2*(22-r)))),16*(32*y+r)+(e-r)}_i(p,"CanonicalTileID"),_i(v,"OverscaledTileID",{omit:["projMatrix"]});class A extends He{constructor(e,r,a){super(e,r),this.z=a}}function I(i,e){return i.x*e.x+i.y*e.y}function O(i,e){if(i.length===1){let r=0;const a=e[r++];let h;for(;!h||a.equals(h);)if(h=e[r++],!h)return 1/0;for(;r<e.length;r++){const m=e[r],y=i[0],w=h.sub(a),M=m.sub(a),k=y.sub(a),B=I(w,w),U=I(w,M),G=I(M,M),X=I(k,w),Y=I(k,M),ie=B*G-U*U,de=(G*X-U*Y)/ie,Ee=(B*Y-U*X)/ie,Re=a.z*(1-de-Ee)+h.z*de+m.z*Ee;if(isFinite(Re))return Re}return 1/0}{let r=1/0;for(const a of e)r=Math.min(r,a.z);return r}}function N(i,e,r,a,h,m,y,w){const M=y*h.getElevationAt(i,e,!0,!0),k=m[0]!==0,B=k?m[1]===0?y*(m[0]/7-450):y*function(U,G,X){const Y=Math.floor(G[0]/8),ie=Math.floor(G[1]/8),de=10*(G[0]-8*Y),Ee=10*(G[1]-8*ie),Re=U.getElevationAt(Y,ie,!0,!0),Se=U.getMeterToDEM(X),De=Math.floor(.5*(de*Se-1)),Ve=Math.floor(.5*(Ee*Se-1)),Be=U.tileCoordToPixel(Y,ie),gt=2*De+1,dt=2*Ve+1,At=function(Jt,St,si,wi,hi){return[Jt.getElevationAtPixel(St,si,!0),Jt.getElevationAtPixel(St+hi,si,!0),Jt.getElevationAtPixel(St,si+hi,!0),Jt.getElevationAtPixel(St+wi,si+hi,!0)]}(U,Be.x-De,Be.y-Ve,gt,dt),qt=Math.abs(At[0]-At[1]),yt=Math.abs(At[2]-At[3]),Ot=Math.abs(At[0]-At[2])+Math.abs(At[1]-At[3]),Rt=Math.min(.25,.5*Se*(qt+yt)/gt),Ut=Math.min(.25,.5*Se*Ot/dt);return Re+Math.max(Rt*de,Ut*Ee)}(h,m,w):M;return{base:M+(r===0)?-1:r,top:k?Math.max(B+a,M+r+2):M+a}}const z=et([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:j}=z,q=et([{name:"a_packed",components:4,type:"Float32"}]),{members:K}=q,se=cf.types,re=Math.cos(Math.PI/180*37.5);class te{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new _t,this.layoutVertexArray2=new Vt,this.indexArray=new Ci,this.programConfigurations=new pc(e.layers,e.zoom),this.segments=new An,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a,h){this.hasPattern=tg("line",this.layers,r);const m=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:B,id:U,index:G,sourceLayerIndex:X}of e){const Y=this.layers[0]._featureFilter.needGeometry,ie=uh(B,Y);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),ie,a))continue;const de=m?m.evaluate(ie,{},a):void 0,Ee={id:U,properties:B.properties,type:B.type,sourceLayerIndex:X,index:G,geometry:Y?ie.geometry:Pa(B,a,h),patterns:{},sortKey:de};y.push(Ee)}m&&y.sort((B,U)=>B.sortKey-U.sortKey);const{lineAtlas:w,featureIndex:M}=r,k=this.addConstantDashes(w);for(const B of y){const{geometry:U,index:G,sourceLayerIndex:X}=B;if(k&&this.addFeatureDashes(B,w),this.hasPattern){const Y=ig("line",this.layers,B,this.zoom,r);this.patternFeatures.push(Y)}else this.addFeature(B,U,G,a,w.positions,r.availableImages);M.insert(e[G].feature,U,G,X,this.index)}}addConstantDashes(e){let r=!1;for(const a of this.layers){const h=a.paint.get("line-dasharray").value,m=a.layout.get("line-cap").value;if(h.kind!=="constant"||m.kind!=="constant")r=!0;else{const y=m.value,w=h.value;if(!w)continue;e.addDash(w,y)}}return r}addFeatureDashes(e,r){const a=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if(m.kind==="constant"&&y.kind==="constant")continue;let w,M;if(m.kind==="constant"){if(w=m.value,!w)continue}else w=m.evaluate({zoom:a},e);M=y.kind==="constant"?y.value:y.evaluate({zoom:a},e),r.addDash(w,M),e.patterns[h.id]=r.getKey(w,M)}}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}addFeatures(e,r,a,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,r,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,K)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,a,h,m,y){const w=this.layers[0].layout,M=w.get("line-join").evaluate(e,{}),k=w.get("line-cap").evaluate(e,{}),B=w.get("line-miter-limit"),U=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const G of r)this.addLine(G,e,M,k,B,U);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}addLine(e,r,a,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ee=0;Ee<e.length-1;Ee++)this.totalDistance+=e[Ee].dist(e[Ee+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=se[r.type]==="Polygon";let M=e.length;for(;M>=2&&e[M-1].equals(e[M-2]);)M--;let k=0;for(;k<M-1&&e[k].equals(e[k+1]);)k++;if(M<(w?3:2))return;a==="bevel"&&(m=1.05);const B=this.overscaling<=16?15*Ai/(512*this.overscaling):0,U=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let G,X,Y,ie,de;this.e1=this.e2=-1,w&&(G=e[M-2],de=e[k].sub(G)._unit()._perp());for(let Ee=k;Ee<M;Ee++){if(Y=Ee===M-1?w?e[k+1]:void 0:e[Ee+1],Y&&e[Ee].equals(Y))continue;de&&(ie=de),G&&(X=G),G=e[Ee],de=Y?Y.sub(G)._unit()._perp():ie,ie=ie||de;let Re=ie.add(de);Re.x===0&&Re.y===0||Re._unit();const Se=ie.x*de.x+ie.y*de.y,De=Re.x*de.x+Re.y*de.y,Ve=De!==0?1/De:1/0,Be=2*Math.sqrt(2-2*De),gt=De<re&&X&&Y,dt=ie.x*de.y-ie.y*de.x>0;if(gt&&Ee>k){const yt=G.dist(X);if(yt>2*B){const Ot=G.sub(G.sub(X)._mult(B/yt)._round());this.updateDistance(X,Ot),this.addCurrentVertex(Ot,ie,0,0,U),X=Ot}}const At=X&&Y;let qt=At?a:w?"butt":h;if(At&&qt==="round"&&(Ve<y?qt="miter":Ve<=2&&(qt="fakeround")),qt==="miter"&&Ve>m&&(qt="bevel"),qt==="bevel"&&(Ve>2&&(qt="flipbevel"),Ve<m&&(qt="miter")),X&&this.updateDistance(X,G),qt==="miter")Re._mult(Ve),this.addCurrentVertex(G,Re,0,0,U);else if(qt==="flipbevel"){if(Ve>100)Re=de.mult(-1);else{const yt=Ve*ie.add(de).mag()/ie.sub(de).mag();Re._perp()._mult(yt*(dt?-1:1))}this.addCurrentVertex(G,Re,0,0,U),this.addCurrentVertex(G,Re.mult(-1),0,0,U)}else if(qt==="bevel"||qt==="fakeround"){const yt=-Math.sqrt(Ve*Ve-1),Ot=dt?yt:0,Rt=dt?0:yt;if(X&&this.addCurrentVertex(G,ie,Ot,Rt,U),qt==="fakeround"){const Ut=Math.round(180*Be/Math.PI/20);for(let Jt=1;Jt<Ut;Jt++){let St=Jt/Ut;if(St!==.5){const wi=St-.5;St+=St*wi*(St-1)*((1.0904+Se*(Se*(3.55645-1.43519*Se)-3.2452))*wi*wi+(.848013+Se*(.215638*Se-1.06021)))}const si=de.sub(ie)._mult(St)._add(ie)._unit()._mult(dt?-1:1);this.addHalfVertex(G,si.x,si.y,!1,dt,0,U)}}Y&&this.addCurrentVertex(G,de,-Ot,-Rt,U)}else if(qt==="butt")this.addCurrentVertex(G,Re,0,0,U);else if(qt==="square"){const yt=X?1:-1;X||this.addCurrentVertex(G,Re,yt,yt,U),this.addCurrentVertex(G,Re,0,0,U),X&&this.addCurrentVertex(G,Re,yt,yt,U)}else qt==="round"&&(X&&(this.addCurrentVertex(G,ie,0,0,U),this.addCurrentVertex(G,ie,1,1,U,!0)),Y&&(this.addCurrentVertex(G,de,-1,-1,U,!0),this.addCurrentVertex(G,de,0,0,U)));if(gt&&Ee<M-1){const yt=G.dist(Y);if(yt>2*B){const Ot=G.add(Y.sub(G)._mult(B/yt)._round());this.updateDistance(G,Ot),this.addCurrentVertex(Ot,de,0,0,U),G=Ot}}}}addCurrentVertex(e,r,a,h,m,y=!1){const w=r.y*h-r.x,M=-r.y-r.x*h;this.addHalfVertex(e,r.x+r.y*a,r.y-r.x*a,y,!1,a,m),this.addHalfVertex(e,w,M,y,!0,-h,m)}addHalfVertex({x:e,y:r},a,h,m,y,w,M){this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(r<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(w===0?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),M.primitiveLength++),y?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}_i(te,"LineBucket",{omit:["layers","patternFeatures"]});const ce=new ke({"line-cap":new pe(Et.layout_line["line-cap"]),"line-join":new pe(Et.layout_line["line-join"]),"line-miter-limit":new ee(Et.layout_line["line-miter-limit"]),"line-round-limit":new ee(Et.layout_line["line-round-limit"]),"line-sort-key":new pe(Et.layout_line["line-sort-key"])});var fe={paint:new ke({"line-opacity":new pe(Et.paint_line["line-opacity"]),"line-color":new pe(Et.paint_line["line-color"]),"line-translate":new ee(Et.paint_line["line-translate"]),"line-translate-anchor":new ee(Et.paint_line["line-translate-anchor"]),"line-width":new pe(Et.paint_line["line-width"]),"line-gap-width":new pe(Et.paint_line["line-gap-width"]),"line-offset":new pe(Et.paint_line["line-offset"]),"line-blur":new pe(Et.paint_line["line-blur"]),"line-dasharray":new pe(Et.paint_line["line-dasharray"]),"line-pattern":new pe(Et.paint_line["line-pattern"]),"line-gradient":new Ce(Et.paint_line["line-gradient"]),"line-trim-offset":new ee(Et.paint_line["line-trim-offset"])}),layout:ce};const Xe=new class extends pe{possiblyEvaluate(i,e){return e=new F(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,r,a){return e=dr({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,r,a)}}(fe.paint.properties["line-width"].specification);function Ue(i,e){return e>0?e+2*i:i}Xe.useIntegerZoom=!0;const $e=et([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),pt=et([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),tt=et([{name:"a_projected_pos",components:4,type:"Float32"}],4);et([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mt=et([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Bt=et([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);et([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Yt=et([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ei=et([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);et([{name:"triangle",components:3,type:"Uint16"}]),et([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),et([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),et([{type:"Float32",name:"offsetX"}]),et([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ft=24;const ci=128;function mi(i,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new F(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=r;let m=0;for(;m<a.length&&a[m]<=i;)m++;m=Math.max(0,m-1);let y=m;for(;y<a.length&&a[y]<i+1;)y++;y=Math.min(a.length-1,y);const w=a[m],M=a[y];return r.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:M,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:M,minSize:r.evaluate(new F(w)),maxSize:r.evaluate(new F(M)),interpolationType:h}}}function Ni(i,{uSize:e,uSizeT:r},{lowerSize:a,upperSize:h}){return i.kind==="source"?a/ci:i.kind==="composite"?pr(a/ci,h/ci,r):e}function bi(i,e){let r=0,a=0;if(i.kind==="constant")a=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=i,w=h?xi(Qs.interpolationFactor(h,e,m,y),0,1):0;i.kind==="camera"?a=pr(i.minSize,i.maxSize,w):r=w}return{uSizeT:r,uSize:a}}var Vi=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ci,evaluateSizeForFeature:Ni,evaluateSizeForZoom:bi,getSizeData:mi});function gr(i,e,r){return i.sections.forEach(a=>{a.text=function(h,m,y){const w=m.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),D.applyArabicShaping&&(h=D.applyArabicShaping(h)),h}(a.text,e,r)}),i}const ar={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function vr(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function Ss(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}var _r=di,zr=function(i,e,r,a,h){var m,y,w=8*h-a-1,M=(1<<w)-1,k=M>>1,B=-7,U=h-1,G=-1,X=i[e+U];for(U+=G,m=X&(1<<-B)-1,X>>=-B,B+=w;B>0;m=256*m+i[e+U],U+=G,B-=8);for(y=m&(1<<-B)-1,m>>=-B,B+=a;B>0;y=256*y+i[e+U],U+=G,B-=8);if(m===0)m=1-k;else{if(m===M)return y?NaN:1/0*(X?-1:1);y+=Math.pow(2,a),m-=k}return(X?-1:1)*y*Math.pow(2,m-a)},Hi=function(i,e,r,a,h,m){var y,w,M,k=8*m-h-1,B=(1<<k)-1,U=B>>1,G=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=0,Y=1,ie=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,y=B):(y=Math.floor(Math.log(e)/Math.LN2),e*(M=Math.pow(2,-y))<1&&(y--,M*=2),(e+=y+U>=1?G/M:G*Math.pow(2,1-U))*M>=2&&(y++,M/=2),y+U>=B?(w=0,y=B):y+U>=1?(w=(e*M-1)*Math.pow(2,h),y+=U):(w=e*Math.pow(2,U-1)*Math.pow(2,h),y=0));h>=8;i[r+X]=255&w,X+=Y,w/=256,h-=8);for(y=y<<h|w,k+=h;k>0;i[r+X]=255&y,X+=Y,y/=256,k-=8);i[r+X-Y]|=128*ie};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function di(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}di.Varint=0,di.Fixed64=1,di.Bytes=2,di.Fixed32=5;var Mn=4294967296,Br=1/Mn,Kr=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function on(i){return i.type===di.Bytes?i.readVarint()+i.pos:i.pos+1}function lo(i,e,r){return r?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Po(i,e,r){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(a);for(var h=r.pos-1;h>=i;h--)r.buf[h+a]=r.buf[h]}function ta(i,e){for(var r=0;r<i.length;r++)e.writeVarint(i[r])}function Hs(i,e){for(var r=0;r<i.length;r++)e.writeSVarint(i[r])}function Hn(i,e){for(var r=0;r<i.length;r++)e.writeFloat(i[r])}function pf(i,e){for(var r=0;r<i.length;r++)e.writeDouble(i[r])}function wc(i,e){for(var r=0;r<i.length;r++)e.writeBoolean(i[r])}function mh(i,e){for(var r=0;r<i.length;r++)e.writeFixed32(i[r])}function mf(i,e){for(var r=0;r<i.length;r++)e.writeSFixed32(i[r])}function La(i,e){for(var r=0;r<i.length;r++)e.writeFixed64(i[r])}function Au(i,e){for(var r=0;r<i.length;r++)e.writeSFixed64(i[r])}function gf(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function Op(i,e,r){i[r]=e,i[r+1]=e>>>8,i[r+2]=e>>>16,i[r+3]=e>>>24}function e1(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}di.prototype={destroy:function(){this.buf=null},readFields:function(i,e,r){for(r=r||this.length;this.pos<r;){var a=this.readVarint(),h=a>>3,m=this.pos;this.type=7&a,i(h,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=gf(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=e1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=gf(this.buf,this.pos)+gf(this.buf,this.pos+4)*Mn;return this.pos+=8,i},readSFixed64:function(){var i=gf(this.buf,this.pos)+e1(this.buf,this.pos+4)*Mn;return this.pos+=8,i},readFloat:function(){var i=zr(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=zr(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,r,a=this.buf;return e=127&(r=a[this.pos++]),r<128?e:(e|=(127&(r=a[this.pos++]))<<7,r<128?e:(e|=(127&(r=a[this.pos++]))<<14,r<128?e:(e|=(127&(r=a[this.pos++]))<<21,r<128?e:function(h,m,y){var w,M,k=y.buf;if(w=(112&(M=k[y.pos++]))>>4,M<128||(w|=(127&(M=k[y.pos++]))<<3,M<128)||(w|=(127&(M=k[y.pos++]))<<10,M<128)||(w|=(127&(M=k[y.pos++]))<<17,M<128)||(w|=(127&(M=k[y.pos++]))<<24,M<128)||(w|=(1&(M=k[y.pos++]))<<31,M<128))return lo(h,w,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=a[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Kr?function(r,a,h){return Kr.decode(r.subarray(a,h))}(this.buf,e,i):function(r,a,h){for(var m="",y=a;y<h;){var w,M,k,B=r[y],U=null,G=B>239?4:B>223?3:B>191?2:1;if(y+G>h)break;G===1?B<128&&(U=B):G===2?(192&(w=r[y+1]))==128&&(U=(31&B)<<6|63&w)<=127&&(U=null):G===3?(M=r[y+2],(192&(w=r[y+1]))==128&&(192&M)==128&&((U=(15&B)<<12|(63&w)<<6|63&M)<=2047||U>=55296&&U<=57343)&&(U=null)):G===4&&(M=r[y+2],k=r[y+3],(192&(w=r[y+1]))==128&&(192&M)==128&&(192&k)==128&&((U=(15&B)<<18|(63&w)<<12|(63&M)<<6|63&k)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,G=1):U>65535&&(U-=65536,m+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),m+=String.fromCharCode(U),y+=G}return m}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==di.Bytes)return i.push(this.readVarint(e));var r=on(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==di.Bytes)return i.push(this.readSVarint());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==di.Bytes)return i.push(this.readBoolean());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==di.Bytes)return i.push(this.readFloat());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==di.Bytes)return i.push(this.readDouble());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==di.Bytes)return i.push(this.readFixed32());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==di.Bytes)return i.push(this.readSFixed32());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==di.Bytes)return i.push(this.readFixed64());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==di.Bytes)return i.push(this.readSFixed64());var e=on(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===di.Varint)for(;this.buf[this.pos++]>127;);else if(e===di.Bytes)this.pos=this.readVarint()+this.pos;else if(e===di.Fixed32)this.pos+=4;else{if(e!==di.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Op(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Op(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Op(this.buf,-1&i,this.pos),Op(this.buf,Math.floor(i*Br),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Op(this.buf,-1&i,this.pos),Op(this.buf,Math.floor(i*Br),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,r){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(m,y,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)}(a,0,r),function(m,y){var w=(7&m)<<4;y.buf[y.pos++]|=w|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(a,h,m){for(var y,w,M=0;M<h.length;M++){if((y=h.charCodeAt(M))>55295&&y<57344){if(!w){y>56319||M+1===h.length?(a[m++]=239,a[m++]=191,a[m++]=189):w=y;continue}if(y<56320){a[m++]=239,a[m++]=191,a[m++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(a[m++]=239,a[m++]=191,a[m++]=189,w=null);y<128?a[m++]=y:(y<2048?a[m++]=y>>6|192:(y<65536?a[m++]=y>>12|224:(a[m++]=y>>18|240,a[m++]=y>>12&63|128),a[m++]=y>>6&63|128),a[m++]=63&y|128)}return m}(this.buf,i,this.pos);var r=this.pos-e;r>=128&&Po(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),Hi(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Hi(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,e){this.pos++;var r=this.pos;i(e,this);var a=this.pos-r;a>=128&&Po(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeMessage:function(i,e,r){this.writeTag(i,di.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,ta,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,Hs,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,wc,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,Hn,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,pf,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,mh,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,mf,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,La,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,Au,e)},writeBytesField:function(i,e){this.writeTag(i,di.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,di.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,di.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,di.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,di.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,di.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,di.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,di.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,di.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,di.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};var ay=ge(_r);const Cv=3;function pM(i,e,r){e.glyphs=[],i===1&&r.readMessage(mM,e)}function mM(i,e,r){if(i===3){const{id:a,bitmap:h,width:m,height:y,left:w,top:M,advance:k}=r.readMessage(gM,{});e.glyphs.push({id:a,bitmap:new Ml({width:m+2*Cv,height:y+2*Cv},h),metrics:{width:m,height:y,left:w,top:M,advance:k}})}else i===4?e.ascender=r.readSVarint():i===5&&(e.descender=r.readSVarint())}function gM(i,e,r){i===1?e.id=r.readVarint():i===2?e.bitmap=r.readBytes():i===3?e.width=r.readVarint():i===4?e.height=r.readVarint():i===5?e.left=r.readSVarint():i===6?e.top=r.readSVarint():i===7&&(e.advance=r.readVarint())}const _M=Cv;function Av(i){let e=0,r=0;for(const y of i)e+=y.w*y.h,r=Math.max(r,y.w);i.sort((y,w)=>w.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let h=0,m=0;for(const y of i)for(let w=a.length-1;w>=0;w--){const M=a[w];if(!(y.w>M.w||y.h>M.h)){if(y.x=M.x,y.y=M.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===M.w&&y.h===M.h){const k=a.pop();w<a.length&&(a[w]=k)}else y.h===M.h?(M.x+=y.w,M.w-=y.w):y.w===M.w?(M.y+=y.h,M.h-=y.h):(a.push({x:M.x+y.w,y:M.y,w:M.w-y.w,h:y.h}),M.y+=y.h,M.h-=y.h);break}}return{w:h,h:m,fill:e/(h*m)||0}}const Lo=1;class Mv{constructor(e,{pixelRatio:r,version:a,stretchX:h,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=h,this.stretchY=m,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+Lo,this.paddedRect.y+Lo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Lo,this.paddedRect.y+this.paddedRect.h-Lo]}get displaySize(){return[(this.paddedRect.w-2*Lo)/this.pixelRatio,(this.paddedRect.h-2*Lo)/this.pixelRatio]}}class t1{constructor(e,r){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(r,h,m);const{w:y,h:w}=Av(m),M=new ao({width:y||1,height:w||1});for(const k in e){const B=e[k],U=a[k].paddedRect;ao.copy(B.data,M,{x:0,y:0},{x:U.x+Lo,y:U.y+Lo},B.data)}for(const k in r){const B=r[k],U=h[k].paddedRect,G=U.x+Lo,X=U.y+Lo,Y=B.data.width,ie=B.data.height;ao.copy(B.data,M,{x:0,y:0},{x:G,y:X},B.data),ao.copy(B.data,M,{x:0,y:ie-1},{x:G,y:X-1},{width:Y,height:1}),ao.copy(B.data,M,{x:0,y:0},{x:G,y:X+ie},{width:Y,height:1}),ao.copy(B.data,M,{x:Y-1,y:0},{x:G-1,y:X},{width:1,height:ie}),ao.copy(B.data,M,{x:0,y:0},{x:G+Y,y:X},{width:1,height:ie})}this.image=M,this.iconPositions=a,this.patternPositions=h}addImages(e,r,a){for(const h in e){const m=e[h],y={x:0,y:0,w:m.data.width+2*Lo,h:m.data.height+2*Lo};a.push(y),r[h]=new Mv(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),r),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),r)}patchUpdatedImage(e,r,a){if(!e||!r||e.version===r.version)return;e.version=r.version;const[h,m]=e.tl;a.update(r.data,void 0,{x:h,y:m})}}_i(Mv,"ImagePosition"),_i(t1,"ImageAtlas");const Da={horizontal:1,vertical:2,horizontalOnly:3},i1=-17;class lg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const a=new lg;return a.scale=e||1,a.fontStack=r,a}static forImage(e){const r=new lg;return r.imageName=e,r}}class Rp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const a=new Rp;for(let h=0;h<e.sections.length;h++){const m=e.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,r)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,a){let h="";for(let m=0;m<r.length;m++){const y=r.charCodeAt(m+1)||null,w=r.charCodeAt(m-1)||null;h+=!a&&(y&&bl(y)&&!ar[r[m+1]]||w&&bl(w)&&!ar[r[m-1]])||!ar[r[m]]?r[m]:ar[r[m]]}return h}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&ly[this.text.charCodeAt(a)];a++)e++;let r=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&ly[this.text.charCodeAt(a)];a--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const a=new Rp;return a.text=this.text.substring(e,r),a.sectionIndex=this.sectionIndex.slice(e,r),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(lg.forText(e.scale,e.fontStack||r));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void Lt("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(lg.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Iv(i,e,r,a,h,m,y,w,M,k,B,U,G,X,Y){const ie=Rp.fromFeature(i,h);U===Da.vertical&&ie.verticalizePunctuation(G);let de=[];const Ee=function(Be,gt,dt,At,qt,yt){if(!Be)return[];const Ot=[],Rt=function(si,wi,hi,qi,Qt,Li){let Xi=0;for(let Er=0;Er<si.length();Er++){const Zi=si.getSection(Er);Xi+=r1(si.getCharCode(Er),Zi,qi,Qt,wi,Li)}return Xi/Math.max(1,Math.ceil(Xi/hi))}(Be,gt,dt,At,qt,yt),Ut=Be.text.indexOf("")>=0;let Jt=0;for(let si=0;si<Be.length();si++){const wi=Be.getSection(si),hi=Be.getCharCode(si);if(ly[hi]||(Jt+=r1(hi,wi,At,qt,gt,yt)),si<Be.length()-1){const qi=!((St=hi)<11904||!(oi["Bopomofo Extended"](St)||oi.Bopomofo(St)||oi["CJK Compatibility Forms"](St)||oi["CJK Compatibility Ideographs"](St)||oi["CJK Compatibility"](St)||oi["CJK Radicals Supplement"](St)||oi["CJK Strokes"](St)||oi["CJK Symbols and Punctuation"](St)||oi["CJK Unified Ideographs Extension A"](St)||oi["CJK Unified Ideographs"](St)||oi["Enclosed CJK Letters and Months"](St)||oi["Halfwidth and Fullwidth Forms"](St)||oi.Hiragana(St)||oi["Ideographic Description Characters"](St)||oi["Kangxi Radicals"](St)||oi["Katakana Phonetic Extensions"](St)||oi.Katakana(St)||oi["Vertical Forms"](St)||oi["Yi Radicals"](St)||oi["Yi Syllables"](St)));(yM[hi]||qi||wi.imageName)&&Ot.push(s1(si+1,Jt,Rt,Ot,xM(hi,Be.getCharCode(si+1),qi&&Ut),!1))}}var St;return o1(s1(Be.length(),Jt,Rt,Ot,0,!0))}(ie,k,m,e,a,X),{processBidirectionalText:Re,processStyledBidirectionalText:Se}=D;if(Re&&ie.sections.length===1){const Be=Re(ie.toString(),Ee);for(const gt of Be){const dt=new Rp;dt.text=gt,dt.sections=ie.sections;for(let At=0;At<gt.length;At++)dt.sectionIndex.push(0);de.push(dt)}}else if(Se){const Be=Se(ie.text,ie.sectionIndex,Ee);for(const gt of Be){const dt=new Rp;dt.text=gt[0],dt.sectionIndex=gt[1],dt.sections=ie.sections,de.push(dt)}}else de=function(Be,gt){const dt=[],At=Be.text;let qt=0;for(const yt of gt)dt.push(Be.substring(qt,yt)),qt=yt;return qt<At.length&&dt.push(Be.substring(qt,At.length)),dt}(ie,Ee);const De=[],Ve={positionedLines:De,text:ie.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:U,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Be,gt,dt,At,qt,yt,Ot,Rt,Ut,Jt,St,si){let wi=0,hi=0,qi=0;const Qt=Rt==="right"?1:Rt==="left"?0:.5;let Li=!1;for(const Ji of qt){const Qi=Ji.getSections();for(const Gr of Qi){if(Gr.imageName)continue;const Jr=gt[Gr.fontStack];if(Jr&&(Li=Jr.ascender!==void 0&&Jr.descender!==void 0,!Li))break}if(!Li)break}let Xi=0;for(const Ji of qt){Ji.trim();const Qi=Ji.getMaxScale(),Gr=(Qi-1)*Ft,Jr={positionedGlyphs:[],lineOffset:0};Be.positionedLines[Xi]=Jr;const Qr=Jr.positionedGlyphs;let Wr=0;if(!Ji.length()){hi+=yt,++Xi;continue}let bn=0,Un=0;for(let Hr=0;Hr<Ji.length();Hr++){const rs=Ji.getSection(Hr),Xn=Ji.getSectionIndex(Hr),In=Ji.getCharCode(Hr);let Mr=rs.scale,Zn=null,en=null,co=null,Yn=Ft,Cs=0;const vs=!(Ut===Da.horizontal||!St&&!Ld(In)||St&&(ly[In]||(Er=In,oi.Arabic(Er)||oi["Arabic Supplement"](Er)||oi["Arabic Extended-A"](Er)||oi["Arabic Presentation Forms-A"](Er)||oi["Arabic Presentation Forms-B"](Er))));if(rs.imageName){const ho=At[rs.imageName];if(!ho)continue;co=rs.imageName,Be.iconsInText=Be.iconsInText||!0,en=ho.paddedRect;const bs=ho.displaySize;Mr=Mr*Ft/si,Zn={width:bs[0],height:bs[1],left:Lo,top:-3,advance:vs?bs[1]:bs[0],localGlyph:!1},Cs=Li?-Zn.height*Mr:i1+Qi*Ft-bs[1]*Mr,Yn=Zn.advance;const Pl=(vs?bs[0]:bs[1])*Mr-Ft*Qi;Pl>0&&Pl>Wr&&(Wr=Pl)}else{const ho=dt[rs.fontStack];if(!ho)continue;ho[In]&&(en=ho[In]);const bs=gt[rs.fontStack];if(!bs)continue;const Pl=bs.glyphs[In];if(!Pl)continue;if(Zn=Pl.metrics,Yn=In!==8203?Ft:0,Li){const Vp=bs.ascender!==void 0?Math.abs(bs.ascender):0,yg=bs.descender!==void 0?Math.abs(bs.descender):0,xg=(Vp+yg)*Mr;bn<xg&&(bn=xg,Un=(Vp-yg)/2*Mr),Cs=-Vp*Mr}else Cs=i1+(Qi-Mr)*Ft}vs?(Be.verticalizable=!0,Qr.push({glyph:In,imageName:co,x:wi,y:hi+Cs,vertical:vs,scale:Mr,localGlyph:Zn.localGlyph,fontStack:rs.fontStack,sectionIndex:Xn,metrics:Zn,rect:en}),wi+=Yn*Mr+Jt):(Qr.push({glyph:In,imageName:co,x:wi,y:hi+Cs,vertical:vs,scale:Mr,localGlyph:Zn.localGlyph,fontStack:rs.fontStack,sectionIndex:Xn,metrics:Zn,rect:en}),wi+=Zn.advance*Mr+Jt)}Qr.length!==0&&(qi=Math.max(wi-Jt,qi),Li?a1(Qr,Qt,Wr,Un,yt*Qi/2):a1(Qr,Qt,Wr,0,yt/2)),wi=0;const qn=yt*Qi+Wr;Jr.lineOffset=Math.max(Wr,Gr),hi+=qn,++Xi}var Er;const Zi=hi,{horizontalAlign:zi,verticalAlign:an}=kv(Ot);(function(Ji,Qi,Gr,Jr,Qr,Wr){const bn=(Qi-Gr)*Qr,Un=-Wr*Jr;for(const qn of Ji)for(const Hr of qn.positionedGlyphs)Hr.x+=bn,Hr.y+=Un})(Be.positionedLines,Qt,zi,an,qi,Zi),Be.top+=-an*Zi,Be.bottom=Be.top+Zi,Be.left+=-zi*qi,Be.right=Be.left+qi,Be.hasBaseline=Li}(Ve,e,r,a,de,y,w,M,U,k,G,Y),!function(Be){for(const gt of Be)if(gt.positionedGlyphs.length!==0)return!1;return!0}(De)&&Ve}const ly={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function r1(i,e,r,a,h,m){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*Ft/m+h:0}{const y=r[e.fontStack],w=y&&y.glyphs[i];return w?w.metrics.advance*e.scale+h:0}}function n1(i,e,r,a){const h=Math.pow(i-e,2);return a?i<e?h/2:2*h:h+Math.abs(r)*r}function xM(i,e,r){let a=0;return i===10&&(a-=1e4),r&&(a+=150),i!==40&&i!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function s1(i,e,r,a,h,m){let y=null,w=n1(e,r,h,m);for(const M of a){const k=n1(e-M.x,r,h,m)+M.badness;k<=w&&(y=M,w=k)}return{index:i,x:e,priorBreak:y,badness:w}}function o1(i){return i?o1(i.priorBreak).concat(i.index):[]}function kv(i){let e=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function a1(i,e,r,a,h){if(!(e||r||a||h))return;const m=i.length-1,y=i[m],w=(y.x+y.metrics.advance*y.scale)*e;for(let M=0;M<=m;M++)i[M].x-=w,i[M].y+=r+a+h}function vM(i,e,r){const{horizontalAlign:a,verticalAlign:h}=kv(r),m=e[0]-i.displaySize[0]*a,y=e[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function l1(i,e,r,a,h,m){const y=i.image;let w;if(y.content){const de=y.content,Ee=y.pixelRatio||1;w=[de[0]/Ee,de[1]/Ee,y.displaySize[0]-de[2]/Ee,y.displaySize[1]-de[3]/Ee]}const M=e.left*m,k=e.right*m;let B,U,G,X;r==="width"||r==="both"?(X=h[0]+M-a[3],U=h[0]+k+a[1]):(X=h[0]+(M+k-y.displaySize[0])/2,U=X+y.displaySize[0]);const Y=e.top*m,ie=e.bottom*m;return r==="height"||r==="both"?(B=h[1]+Y-a[0],G=h[1]+ie+a[2]):(B=h[1]+(Y+ie-y.displaySize[1])/2,G=B+y.displaySize[1]),{image:y,top:B,right:U,bottom:G,left:X,collisionPadding:w}}class gh extends He{constructor(e,r,a,h,m){super(e,r),this.angle=h,this.z=a,m!==void 0&&(this.segment=m)}clone(){return new gh(this.x,this.y,this.z,this.angle,this.segment)}}function c1(i,e,r,a,h){if(e.segment===void 0)return!0;let m=e,y=e.segment+1,w=0;for(;w>-r/2;){if(y--,y<0)return!1;w-=i[y].dist(m),m=i[y]}w+=i[y].dist(i[y+1]),y++;const M=[];let k=0;for(;w<r/2;){const B=i[y],U=i[y+1];if(!U)return!1;let G=i[y-1].angleTo(B)-B.angleTo(U);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:w,angleDelta:G}),k+=G;w-M[0].distance>a;)k-=M.shift().angleDelta;if(k>h)return!1;y++,w+=B.dist(U)}return!0}function h1(i){let e=0;for(let r=0;r<i.length-1;r++)e+=i[r].dist(i[r+1]);return e}function u1(i,e,r){return i?.6*e*r:0}function d1(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function bM(i,e,r,a,h,m){const y=u1(r,h,m),w=d1(r,a)*m;let M=0;const k=h1(i)/2;for(let B=0;B<i.length-1;B++){const U=i[B],G=i[B+1],X=U.dist(G);if(M+X>k){const Y=(k-M)/X,ie=pr(U.x,G.x,Y),de=pr(U.y,G.y,Y),Ee=new gh(ie,de,0,G.angleTo(U),B);return!y||c1(i,Ee,w,y,e)?Ee:void 0}M+=X}}function wM(i,e,r,a,h,m,y,w,M){const k=u1(a,m,y),B=d1(a,h),U=B*y,G=i[0].x===0||i[0].x===M||i[0].y===0||i[0].y===M;return e-U<e/4&&(e=U+e/4),f1(i,G?e/2*w%e:(B/2+2*m)*y*w%e,e,k,r,U,G,!1,M)}function f1(i,e,r,a,h,m,y,w,M){const k=m/2,B=h1(i);let U=0,G=e-r,X=[];for(let Y=0;Y<i.length-1;Y++){const ie=i[Y],de=i[Y+1],Ee=ie.dist(de),Re=de.angleTo(ie);for(;G+r<U+Ee;){G+=r;const Se=(G-U)/Ee,De=pr(ie.x,de.x,Se),Ve=pr(ie.y,de.y,Se);if(De>=0&&De<M&&Ve>=0&&Ve<M&&G-k>=0&&G+k<=B){const Be=new gh(De,Ve,0,Re,Y);Be._round(),a&&!c1(i,Be,m,a,h)||X.push(Be)}}U+=Ee}return w||X.length||y||(X=f1(i,U/2,r,a,h,m,y,!0,M)),X}function p1(i,e,r,a,h){const m=[];for(let y=0;y<i.length;y++){const w=i[y];let M;for(let k=0;k<w.length-1;k++){let B=w[k],U=w[k+1];B.x<e&&U.x<e||(B.x<e?B=new He(e,B.y+(e-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x<e&&(U=new He(e,B.y+(e-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y<r&&U.y<r||(B.y<r?B=new He(B.x+(r-B.y)/(U.y-B.y)*(U.x-B.x),r)._round():U.y<r&&(U=new He(B.x+(r-B.y)/(U.y-B.y)*(U.x-B.x),r)._round()),B.x>=a&&U.x>=a||(B.x>=a?B=new He(a,B.y+(a-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x>=a&&(U=new He(a,B.y+(a-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y>=h&&U.y>=h||(B.y>=h?B=new He(B.x+(h-B.y)/(U.y-B.y)*(U.x-B.x),h)._round():U.y>=h&&(U=new He(B.x+(h-B.y)/(U.y-B.y)*(U.x-B.x),h)._round()),M&&B.equals(M[M.length-1])||(M=[B],m.push(M)),M.push(U)))))}}return m}_i(gh,"Anchor");const cy=1e20;function m1(i,e,r,a,h,m,y,w,M){for(let k=e;k<e+a;k++)g1(i,r*m+k,m,h,y,w,M);for(let k=r;k<r+h;k++)g1(i,k*m+e,1,a,y,w,M)}function g1(i,e,r,a,h,m,y){m[0]=0,y[0]=-1e20,y[1]=cy,h[0]=i[e];for(let w=1,M=0,k=0;w<a;w++){h[w]=i[e+w*r];const B=w*w;do{const U=m[M];k=(h[w]-h[U]+B-U*U)/(w-U)/2}while(k<=y[M]&&--M>-1);M++,m[M]=w,y[M]=k,y[M+1]=cy}for(let w=0,M=0;w<a;w++){for(;y[M+1]<w;)M++;const k=m[M],B=w-k;i[e+w*r]=h[k]+B*B}}const Il=2,Pv={none:0,ideographs:1,all:2};class zp{constructor(e,r,a){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const a=[];for(const h in e)for(const m of e[h])a.push({stack:h,id:m});nr(a,({stack:h,id:m},y)=>{let w=this.entries[h];w||(w=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=w.glyphs[m];if(M!==void 0)return void y(null,{stack:h,id:m,glyph:M});if(M=this._tinySDF(w,h,m),M)return w.glyphs[m]=M,void y(null,{stack:h,id:m,glyph:M});const k=Math.floor(m/256);if(256*k>65535)return void y(new Error("glyphs > 65535 not supported"));if(w.ranges[k])return void y(null,{stack:h,id:m,glyph:M});let B=w.requests[k];B||(B=w.requests[k]=[],zp.loadGlyphRange(h,k,this.url,this.requestManager,(U,G)=>{if(G){w.ascender=G.ascender,w.descender=G.descender;for(const X in G.glyphs)this._doesCharSupportLocalGlyph(+X)||(w.glyphs[+X]=G.glyphs[+X]);w.ranges[k]=!0}for(const X of B)X(U,G);delete w.requests[k]})),B.push((U,G)=>{U?y(U):G&&y(null,{stack:h,id:m,glyph:G.glyphs[m]||null})})},(h,m)=>{if(h)r(h);else if(m){const y={};for(const{stack:w,id:M,glyph:k}of m)y[w]===void 0&&(y[w]={}),y[w].glyphs===void 0&&(y[w].glyphs={}),y[w].glyphs[M]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},y[w].ascender=this.entries[w].ascender,y[w].descender=this.entries[w].descender;r(null,y)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Pv.none&&(this.localGlyphMode===Pv.all?!!this.localFontFamily:!!this.localFontFamily&&(oi["CJK Unified Ideographs"](e)||oi["Hangul Syllables"](e)||oi.Hiragana(e)||oi.Katakana(e)||oi["CJK Symbols and Punctuation"](e)))}_tinySDF(e,r,a){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(a))return;let m=e.tinySDF;if(!m){let ie="400";/bold/i.test(r)?ie="900":/medium/i.test(r)?ie="500":/light/i.test(r)&&(ie="200"),m=e.tinySDF=new zp.TinySDF({fontFamily:h,fontWeight:ie,fontSize:24*Il,buffer:3*Il,radius:8*Il}),m.fontWeight=ie}if(this.localGlyphs[m.fontWeight][a])return this.localGlyphs[m.fontWeight][a];const y=String.fromCharCode(a),{data:w,width:M,height:k,glyphWidth:B,glyphHeight:U,glyphLeft:G,glyphTop:X,glyphAdvance:Y}=m.draw(y);return this.localGlyphs[m.fontWeight][a]={id:a,bitmap:new Ml({width:M,height:k},w),metrics:{width:B/Il,height:U/Il,left:G/Il,top:X/Il-27,advance:Y/Il,localGlyph:!0}}}}zp.loadGlyphRange=function(i,e,r,a,h){const m=256*e,y=m+255,w=a.transformRequest(a.normalizeGlyphsURL(r).replace("{fontstack}",i).replace("{range}",`${m}-${y}`),hs.Glyphs);ss(w,(M,k)=>{if(M)h(M);else if(k){const B={},U=function(G){return new ay(G).readFields(pM,{})}(k);for(const G of U.glyphs)B[G.id]=G;h(null,{glyphs:B,ascender:U.ascender,descender:U.descender})}})},zp.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:r=8,cutoff:a=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=r;const w=this.size=i+4*e,M=this._createCanvas(w),k=this.ctx=M.getContext("2d",{willReadFrequently:!0});k.font=`${y} ${m} ${i}px ${h}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:a,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(i),y=Math.ceil(r),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),M=Math.min(this.size-this.buffer,y+Math.ceil(a)),k=w+2*this.buffer,B=M+2*this.buffer,U=Math.max(k*B,0),G=new Uint8ClampedArray(U),X={data:G,width:k,height:B,glyphWidth:w,glyphHeight:M,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(w===0||M===0)return X;const{ctx:Y,buffer:ie,gridInner:de,gridOuter:Ee}=this;Y.clearRect(ie,ie,w,M),Y.fillText(i,ie,ie+y);const Re=Y.getImageData(ie,ie,w,M);Ee.fill(cy,0,U),de.fill(0,0,U);for(let Se=0;Se<M;Se++)for(let De=0;De<w;De++){const Ve=Re.data[4*(Se*w+De)+3]/255;if(Ve===0)continue;const Be=(Se+ie)*k+De+ie;if(Ve===1)Ee[Be]=0,de[Be]=cy;else{const gt=.5-Ve;Ee[Be]=gt>0?gt*gt:0,de[Be]=gt<0?gt*gt:0}}m1(Ee,0,0,k,B,k,this.f,this.v,this.z),m1(de,ie,ie,w,M,k,this.f,this.v,this.z);for(let Se=0;Se<U;Se++){const De=Math.sqrt(Ee[Se])-Math.sqrt(de[Se]);G[Se]=Math.round(255-255*(De/this.radius+this.cutoff))}return X}};const cg=Lo;function _1(i,e,r,a){const h=[],m=i.image,y=m.pixelRatio,w=m.paddedRect.w-2*cg,M=m.paddedRect.h-2*cg,k=i.right-i.left,B=i.bottom-i.top,U=m.stretchX||[[0,w]],G=m.stretchY||[[0,M]],X=(yt,Ot)=>yt+Ot[1]-Ot[0],Y=U.reduce(X,0),ie=G.reduce(X,0),de=w-Y,Ee=M-ie;let Re=0,Se=Y,De=0,Ve=ie,Be=0,gt=de,dt=0,At=Ee;if(m.content&&a){const yt=m.content;Re=hy(U,0,yt[0]),De=hy(G,0,yt[1]),Se=hy(U,yt[0],yt[2]),Ve=hy(G,yt[1],yt[3]),Be=yt[0]-Re,dt=yt[1]-De,gt=yt[2]-yt[0]-Se,At=yt[3]-yt[1]-Ve}const qt=(yt,Ot,Rt,Ut)=>{const Jt=uy(yt.stretch-Re,Se,k,i.left),St=dy(yt.fixed-Be,gt,yt.stretch,Y),si=uy(Ot.stretch-De,Ve,B,i.top),wi=dy(Ot.fixed-dt,At,Ot.stretch,ie),hi=uy(Rt.stretch-Re,Se,k,i.left),qi=dy(Rt.fixed-Be,gt,Rt.stretch,Y),Qt=uy(Ut.stretch-De,Ve,B,i.top),Li=dy(Ut.fixed-dt,At,Ut.stretch,ie),Xi=new He(Jt,si),Er=new He(hi,si),Zi=new He(hi,Qt),zi=new He(Jt,Qt),an=new He(St/y,wi/y),Ji=new He(qi/y,Li/y),Qi=e*Math.PI/180;if(Qi){const Qr=Math.sin(Qi),Wr=Math.cos(Qi),bn=[Wr,-Qr,Qr,Wr];Xi._matMult(bn),Er._matMult(bn),zi._matMult(bn),Zi._matMult(bn)}const Gr=yt.stretch+yt.fixed,Jr=Ot.stretch+Ot.fixed;return{tl:Xi,tr:Er,bl:zi,br:Zi,tex:{x:m.paddedRect.x+cg+Gr,y:m.paddedRect.y+cg+Jr,w:Rt.stretch+Rt.fixed-Gr,h:Ut.stretch+Ut.fixed-Jr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:an,pixelOffsetBR:Ji,minFontScaleX:gt/y/k,minFontScaleY:At/y/B,isSDF:r}};if(a&&(m.stretchX||m.stretchY)){const yt=y1(U,de,Y),Ot=y1(G,Ee,ie);for(let Rt=0;Rt<yt.length-1;Rt++){const Ut=yt[Rt],Jt=yt[Rt+1];for(let St=0;St<Ot.length-1;St++)h.push(qt(Ut,Ot[St],Jt,Ot[St+1]))}}else h.push(qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:M+1}));return h}function hy(i,e,r){let a=0;for(const h of i)a+=Math.max(e,Math.min(r,h[1]))-Math.max(e,Math.min(r,h[0]));return a}function y1(i,e,r){const a=[{fixed:-1,stretch:0}];for(const[h,m]of i){const y=a[a.length-1];a.push({fixed:h-y.stretch,stretch:y.stretch}),a.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return a.push({fixed:e+cg,stretch:r}),a}function uy(i,e,r,a){return i/e*r+a}function dy(i,e,r,a){return i-e*r/a}function TM(i,e,r,a){const h=e+i.positionedLines[a].lineOffset;return a===0?r+h/2:r+(h+(e+i.positionedLines[a-1].lineOffset))/2}class EM{constructor(e=[],r=SM){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:a}=this,h=r[e];for(;e>0;){const m=e-1>>1,y=r[m];if(a(h,y)>=0)break;r[e]=y,e=m}r[e]=h}_down(e){const{data:r,compare:a}=this,h=this.length>>1,m=r[e];for(;e<h;){let y=1+(e<<1),w=r[y];const M=y+1;if(M<this.length&&a(r[M],w)<0&&(y=M,w=r[M]),a(w,m)>=0)break;r[e]=w,e=y}r[e]=m}}function SM(i,e){return i<e?-1:i>e?1:0}function CM(i,e=1,r=!1){let a=1/0,h=1/0,m=-1/0,y=-1/0;const w=i[0];for(let X=0;X<w.length;X++){const Y=w[X];(!X||Y.x<a)&&(a=Y.x),(!X||Y.y<h)&&(h=Y.y),(!X||Y.x>m)&&(m=Y.x),(!X||Y.y>y)&&(y=Y.y)}const M=Math.min(m-a,y-h);let k=M/2;const B=new EM([],AM);if(M===0)return new He(a,h);for(let X=a;X<m;X+=M)for(let Y=h;Y<y;Y+=M)B.push(new Bp(X+k,Y+k,k,i));let U=function(X){let Y=0,ie=0,de=0;const Ee=X[0];for(let Re=0,Se=Ee.length,De=Se-1;Re<Se;De=Re++){const Ve=Ee[Re],Be=Ee[De],gt=Ve.x*Be.y-Be.x*Ve.y;ie+=(Ve.x+Be.x)*gt,de+=(Ve.y+Be.y)*gt,Y+=3*gt}return new Bp(ie/Y,de/Y,0,X)}(i),G=B.length;for(;B.length;){const X=B.pop();(X.d>U.d||!U.d)&&(U=X,r&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,G)),X.max-U.d<=e||(k=X.h/2,B.push(new Bp(X.p.x-k,X.p.y-k,k,i)),B.push(new Bp(X.p.x+k,X.p.y-k,k,i)),B.push(new Bp(X.p.x-k,X.p.y+k,k,i)),B.push(new Bp(X.p.x+k,X.p.y+k,k,i)),G+=4)}return r&&(console.log(`num probes: ${G}`),console.log(`best distance: ${U.d}`)),U.p}function AM(i,e){return e.max-i.max}class Bp{constructor(e,r,a,h){this.p=new He(e,r),this.h=a,this.d=function(m,y){let w=!1,M=1/0;for(let k=0;k<y.length;k++){const B=y[k];for(let U=0,G=B.length,X=G-1;U<G;X=U++){const Y=B[U],ie=B[X];Y.y>m.y!=ie.y>m.y&&m.x<(ie.x-Y.x)*(m.y-Y.y)/(ie.y-Y.y)+Y.x&&(w=!w),M=Math.min(M,bu(m,Y,ie))}}return(w?1:-1)*Math.sqrt(M)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const Fp=7,Lv=Number.POSITIVE_INFINITY,MM=Math.sqrt(2);function x1(i,[e,r]){let a=0,h=0;if(r===Lv){e<0&&(e=0);const m=e/MM;switch(i){case"top-right":case"top-left":h=m-Fp;break;case"bottom-right":case"bottom-left":h=-m+Fp;break;case"bottom":h=-e+Fp;break;case"top":h=e-Fp}switch(i){case"top-right":case"bottom-right":a=-m;break;case"top-left":case"bottom-left":a=m;break;case"left":a=e;break;case"right":a=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),i){case"top-right":case"top-left":case"top":h=r-Fp;break;case"bottom-right":case"bottom-left":case"bottom":h=-r+Fp}switch(i){case"top-right":case"bottom-right":case"right":a=-e;break;case"top-left":case"bottom-left":case"left":a=e}}return[a,h]}function IM(i,e,r,a,h,m,y,w,M,k){i.createArrays(),i.tilePixelRatio=Ai/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const B=i.layers[0].layout,U=i.layers[0]._unevaluatedLayout._values,G={};if(i.textSizeData.kind==="composite"){const{minZoom:ie,maxZoom:de}=i.textSizeData;G.compositeTextSizes=[U["text-size"].possiblyEvaluate(new F(ie),w),U["text-size"].possiblyEvaluate(new F(de),w)]}if(i.iconSizeData.kind==="composite"){const{minZoom:ie,maxZoom:de}=i.iconSizeData;G.compositeIconSizes=[U["icon-size"].possiblyEvaluate(new F(ie),w),U["icon-size"].possiblyEvaluate(new F(de),w)]}G.layoutTextSize=U["text-size"].possiblyEvaluate(new F(M+1),w),G.layoutIconSize=U["icon-size"].possiblyEvaluate(new F(M+1),w),G.textMaxSize=U["text-size"].possiblyEvaluate(new F(18),w);const X=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Y=B.get("text-size");for(const ie of i.features){const de=B.get("text-font").evaluate(ie,{},w).join(","),Ee=Y.evaluate(ie,{},w),Re=G.layoutTextSize.evaluate(ie,{},w),Se=(G.layoutIconSize.evaluate(ie,{},w),{horizontal:{},vertical:void 0}),De=ie.text;let Ve,Be=[0,0];if(De){const At=De.toString(),qt=B.get("text-letter-spacing").evaluate(ie,{},w)*Ft,yt=B.get("text-line-height").evaluate(ie,{},w)*Ft,Ot=Pm(At)?qt:0,Rt=B.get("text-anchor").evaluate(ie,{},w),Ut=B.get("text-variable-anchor");if(!Ut){const hi=B.get("text-radial-offset").evaluate(ie,{},w);Be=hi?x1(Rt,[hi*Ft,Lv]):B.get("text-offset").evaluate(ie,{},w).map(qi=>qi*Ft)}let Jt=X?"center":B.get("text-justify").evaluate(ie,{},w);const St=B.get("symbol-placement")==="point",si=St?B.get("text-max-width").evaluate(ie,{},w)*Ft:1/0,wi=hi=>{i.allowVerticalPlacement&&Pd(At)&&(Se.vertical=Iv(De,e,r,h,de,si,yt,Rt,hi,Ot,Be,Da.vertical,!0,Re,Ee))};if(!X&&Ut){const hi=Jt==="auto"?Ut.map(Qt=>Dv(Qt)):[Jt];let qi=!1;for(let Qt=0;Qt<hi.length;Qt++){const Li=hi[Qt];if(!Se.horizontal[Li])if(qi)Se.horizontal[Li]=Se.horizontal[0];else{const Xi=Iv(De,e,r,h,de,si,yt,"center",Li,Ot,Be,Da.horizontal,!1,Re,Ee);Xi&&(Se.horizontal[Li]=Xi,qi=Xi.positionedLines.length===1)}}wi("left")}else{if(Jt==="auto"&&(Jt=Dv(Rt)),St||B.get("text-writing-mode").indexOf("horizontal")>=0||!Pd(At)){const hi=Iv(De,e,r,h,de,si,yt,Rt,Jt,Ot,Be,Da.horizontal,!1,Re,Ee);hi&&(Se.horizontal[Jt]=hi)}wi(St?"left":Jt)}}let gt=!1;if(ie.icon&&ie.icon.name){const At=a[ie.icon.name];At&&(Ve=vM(h[ie.icon.name],B.get("icon-offset").evaluate(ie,{},w),B.get("icon-anchor").evaluate(ie,{},w)),gt=At.sdf,i.sdfIcons===void 0?i.sdfIcons=At.sdf:i.sdfIcons!==At.sdf&&Lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(At.pixelRatio!==i.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const dt=b1(Se.horizontal)||Se.vertical;i.iconsInText||(i.iconsInText=!!dt&&dt.iconsInText),(dt||Ve)&&kM(i,ie,Se,Ve,a,G,Re,0,Be,gt,y,w,k)}m&&i.generateCollisionDebugBuffers(M,i.collisionBoxArray)}function Dv(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function kM(i,e,r,a,h,m,y,w,M,k,B,U,G){let X=m.textMaxSize.evaluate(e,{},U);X===void 0&&(X=y);const Y=i.layers[0].layout,ie=Y.get("icon-offset").evaluate(e,{},U),de=b1(r.horizontal)||r.vertical,Ee=G.name==="globe",Re=Ft,Se=y/Re,De=i.tilePixelRatio*X/Re,Ve=(Rt=i.overscaling,i.zoom>18&&Rt>2&&(Rt>>=1),Math.max(Ai/(512*Rt),1)*Y.get("symbol-spacing")),Be=Y.get("text-padding")*i.tilePixelRatio,gt=Y.get("icon-padding")*i.tilePixelRatio,dt=wt(Y.get("text-max-angle")),At=Y.get("text-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",qt=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",yt=Y.get("symbol-placement"),Ot=Ve/2;var Rt;const Ut=Y.get("icon-text-fit");let Jt;a&&Ut!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(Jt=l1(a,r.vertical,Ut,Y.get("icon-text-fit-padding"),ie,Se)),de&&(a=l1(a,de,Ut,Y.get("icon-text-fit-padding"),ie,Se)));const St=(si,wi,hi)=>{if(wi.x<0||wi.x>=Ai||wi.y<0||wi.y>=Ai)return;let qi=null;if(Ee){const{x:Qt,y:Li,z:Xi}=G.projectTilePoint(wi.x,wi.y,hi);qi={anchor:new gh(Qt,Li,Xi,0,void 0),up:G.upVector(hi,wi.x,wi.y)}}(function(Qt,Li,Xi,Er,Zi,zi,an,Ji,Qi,Gr,Jr,Qr,Wr,bn,Un,qn,Hr,rs,Xn,In,Mr,Zn,en,co,Yn){const Cs=Qt.addToLineVertexArray(Li,Er);let vs,ho,bs,Pl,Vp,yg,xg,ew=0,tw=0,iw=0,rw=0,Xv=-1,Zv=-1;const Cc={};let nw=Om("");const xf=Xi?Xi.anchor:Li;let Yv=0,Kv=0;if(Qi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Yv,Kv]=Qi.layout.get("text-offset").evaluate(Mr,{},Yn).map(ia=>ia*Ft):(Yv=Qi.layout.get("text-radial-offset").evaluate(Mr,{},Yn)*Ft,Kv=Lv),Qt.allowVerticalPlacement&&Zi.vertical){const ia=Zi.vertical;if(Un)yg=Ov(ia),Ji&&(xg=Ov(Ji));else{const ra=Qi.layout.get("text-rotate").evaluate(Mr,{},Yn)+90;bs=fy(Gr,xf,Li,Jr,Qr,Wr,ia,bn,ra,qn),Ji&&(Pl=fy(Gr,xf,Li,Jr,Qr,Wr,Ji,rs,ra))}}if(zi){const ia=Qi.layout.get("icon-rotate").evaluate(Mr,{},Yn),ra=Qi.layout.get("icon-text-fit")!=="none",vg=_1(zi,ia,en,ra),Qv=Ji?_1(Ji,ia,en,ra):void 0;ho=fy(Gr,xf,Li,Jr,Qr,Wr,zi,rs,ia),ew=4*vg.length;const sw=Qt.iconSizeData;let vf=null;sw.kind==="source"?(vf=[ci*Qi.layout.get("icon-size").evaluate(Mr,{},Yn)],vf[0]>Mu&&Lt(`${Qt.layerIds[0]}: Value for "icon-size" is >= ${hg}. Reduce your "icon-size".`)):sw.kind==="composite"&&(vf=[ci*Zn.compositeIconSizes[0].evaluate(Mr,{},Yn),ci*Zn.compositeIconSizes[1].evaluate(Mr,{},Yn)],(vf[0]>Mu||vf[1]>Mu)&&Lt(`${Qt.layerIds[0]}: Value for "icon-size" is >= ${hg}. Reduce your "icon-size".`)),Qt.addSymbols(Qt.icon,vg,vf,In,Xn,Mr,!1,Xi,Li,Cs.lineStartIndex,Cs.lineLength,-1,co,Yn),Xv=Qt.icon.placedSymbolArray.length-1,Qv&&(tw=4*Qv.length,Qt.addSymbols(Qt.icon,Qv,vf,In,Xn,Mr,Da.vertical,Xi,Li,Cs.lineStartIndex,Cs.lineLength,-1,co,Yn),Zv=Qt.icon.placedSymbolArray.length-1)}for(const ia in Zi.horizontal){const ra=Zi.horizontal[ia];vs||(nw=Om(ra.text),Un?Vp=Ov(ra):vs=fy(Gr,xf,Li,Jr,Qr,Wr,ra,bn,Qi.layout.get("text-rotate").evaluate(Mr,{},Yn),qn));const vg=ra.positionedLines.length===1;if(iw+=v1(Qt,Xi,Li,ra,an,Qi,Un,Mr,qn,Cs,Zi.vertical?Da.horizontal:Da.horizontalOnly,vg?Object.keys(Zi.horizontal):[ia],Cc,Xv,Zn,co,Yn),vg)break}Zi.vertical&&(rw+=v1(Qt,Xi,Li,Zi.vertical,an,Qi,Un,Mr,qn,Cs,Da.vertical,["vertical"],Cc,Zv,Zn,co,Yn));let Ou=-1;const Jv=(ia,ra)=>ia?Math.max(ia,ra):ra;Ou=Jv(Vp,Ou),Ou=Jv(yg,Ou),Ou=Jv(xg,Ou);const nI=Ou>-1?1:0;Qt.glyphOffsetArray.length>=ku.MAX_GLYPHS&&Lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mr.sortKey!==void 0&&Qt.addToSortKeyRanges(Qt.symbolInstances.length,Mr.sortKey),Qt.symbolInstances.emplaceBack(xf.x,xf.y,xf.z,Li.x,Li.y,Cc.right>=0?Cc.right:-1,Cc.center>=0?Cc.center:-1,Cc.left>=0?Cc.left:-1,Cc.vertical>=0?Cc.vertical:-1,Xv,Zv,nw,vs!==void 0?vs:Qt.collisionBoxArray.length,vs!==void 0?vs+1:Qt.collisionBoxArray.length,bs!==void 0?bs:Qt.collisionBoxArray.length,bs!==void 0?bs+1:Qt.collisionBoxArray.length,ho!==void 0?ho:Qt.collisionBoxArray.length,ho!==void 0?ho+1:Qt.collisionBoxArray.length,Pl||Qt.collisionBoxArray.length,Pl?Pl+1:Qt.collisionBoxArray.length,Jr,iw,rw,ew,tw,nI,0,Yv,Kv,Ou)})(i,wi,qi,si,r,a,h,Jt,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,Be,At,M,0,gt,qt,ie,e,m,k,B,U)};if(yt==="line")for(const si of p1(e.geometry,0,0,Ai,Ai)){const wi=wM(si,Ve,dt,r.vertical||de,a,Re,De,i.overscaling,Ai);for(const hi of wi)de&&PM(i,de.text,Ot,hi)||St(si,hi,U)}else if(yt==="line-center"){for(const si of e.geometry)if(si.length>1){const wi=bM(si,dt,r.vertical||de,a,Re,De);wi&&St(si,wi,U)}}else if(e.type==="Polygon")for(const si of Lp(e.geometry,0)){const wi=CM(si,16);St(si[0],new gh(wi.x,wi.y,0,0,void 0),U)}else if(e.type==="LineString")for(const si of e.geometry)St(si,new gh(si[0].x,si[0].y,0,0,void 0),U);else if(e.type==="Point")for(const si of e.geometry)for(const wi of si)St([wi],new gh(wi.x,wi.y,0,0,void 0),U)}const hg=255,Mu=hg*ci;function v1(i,e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de){const Ee=function(De,Ve,Be,gt,dt,At,qt,yt){const Ot=[];if(Ve.positionedLines.length===0)return Ot;const Rt=gt.layout.get("text-rotate").evaluate(At,{})*Math.PI/180,Ut=function(hi){const qi=hi[0],Qt=hi[1],Li=qi*Qt;return Li>0?[qi,-Qt]:Li<0?[-qi,Qt]:qi===0?[Qt,qi]:[Qt,-qi]}(Be);let Jt=Math.abs(Ve.top-Ve.bottom);for(const hi of Ve.positionedLines)Jt-=hi.lineOffset;const St=Ve.positionedLines.length,si=Jt/St;let wi=Ve.top-Be[1];for(let hi=0;hi<St;++hi){const qi=Ve.positionedLines[hi];wi=TM(Ve,si,wi,hi);for(const Qt of qi.positionedGlyphs){if(!Qt.rect)continue;const Li=Qt.rect||{};let Xi=_M+1,Er=!0,Zi=1,zi=0;if(Qt.imageName){const en=qt[Qt.imageName];if(!en)continue;if(en.sdf){Lt("SDF images are not supported in formatted text and will be ignored.");continue}Er=!1,Zi=en.pixelRatio,Xi=Lo/Zi}const an=(dt||yt)&&Qt.vertical,Ji=Qt.metrics.advance*Qt.scale/2,Qi=Qt.metrics,Gr=Qt.rect;if(Gr===null)continue;yt&&Ve.verticalizable&&(zi=Qt.imageName?Ji-Qt.metrics.width*Qt.scale/2:0);const Jr=dt?[Qt.x+Ji,Qt.y]:[0,0];let Qr=[0,0],Wr=[0,0],bn=!1;dt||(an?(Wr=[Qt.x+Ji+Ut[0],Qt.y+Ut[1]-zi],bn=!0):Qr=[Qt.x+Ji+Be[0],Qt.y+Be[1]-zi]);const Un=Gr.w*Qt.scale/(Zi*(Qt.localGlyph?Il:1)),qn=Gr.h*Qt.scale/(Zi*(Qt.localGlyph?Il:1));let Hr,rs,Xn,In;if(an){const en=Qt.y-wi,co=new He(-Ji,Ji-en),Yn=-Math.PI/2,Cs=new He(...Wr);Hr=new He(-Ji+Qr[0],Qr[1]),Hr._rotateAround(Yn,co)._add(Cs),Hr.x+=-en+Ji,Hr.y-=(Qi.left-Xi)*Qt.scale;const vs=Qt.imageName?Qi.advance*Qt.scale:Ft*Qt.scale,ho=String.fromCharCode(Qt.glyph);vr(ho)?Hr.x+=(1-Xi)*Qt.scale:Ss(ho)?Hr.x+=vs-Qi.height*Qt.scale+(-Xi-1)*Qt.scale:Hr.x+=Qt.imageName||Qi.width+2*Xi===Gr.w&&Qi.height+2*Xi===Gr.h?(vs-qn)/2:(vs-(Qi.height+2*Xi)*Qt.scale)/2,rs=new He(Hr.x,Hr.y-Un),Xn=new He(Hr.x+qn,Hr.y),In=new He(Hr.x+qn,Hr.y-Un)}else{const en=(Qi.left-Xi)*Qt.scale-Ji+Qr[0],co=(-Qi.top-Xi)*Qt.scale+Qr[1],Yn=en+Un,Cs=co+qn;Hr=new He(en,co),rs=new He(Yn,co),Xn=new He(en,Cs),In=new He(Yn,Cs)}if(Rt){let en;en=dt?new He(0,0):bn?new He(Ut[0],Ut[1]):new He(Be[0],Be[1]),Hr._rotateAround(Rt,en),rs._rotateAround(Rt,en),Xn._rotateAround(Rt,en),In._rotateAround(Rt,en)}const Mr=new He(0,0),Zn=new He(0,0);Ot.push({tl:Hr,tr:rs,bl:Xn,br:In,tex:Li,writingMode:Ve.writingMode,glyphOffset:Jr,sectionIndex:Qt.sectionIndex,isSDF:Er,pixelOffsetTL:Mr,pixelOffsetBR:Zn,minFontScaleX:0,minFontScaleY:0})}}return Ot}(0,a,M,m,y,w,h,i.allowVerticalPlacement),Re=i.textSizeData;let Se=null;Re.kind==="source"?(Se=[ci*m.layout.get("text-size").evaluate(w,{},de)],Se[0]>Mu&&Lt(`${i.layerIds[0]}: Value for "text-size" is >= ${hg}. Reduce your "text-size".`)):Re.kind==="composite"&&(Se=[ci*Y.compositeTextSizes[0].evaluate(w,{},de),ci*Y.compositeTextSizes[1].evaluate(w,{},de)],(Se[0]>Mu||Se[1]>Mu)&&Lt(`${i.layerIds[0]}: Value for "text-size" is >= ${hg}. Reduce your "text-size".`)),i.addSymbols(i.text,Ee,Se,M,y,w,B,e,r,k.lineStartIndex,k.lineLength,X,ie,de);for(const De of U)G[De]=i.text.placedSymbolArray.length-1;return 4*Ee.length}function b1(i){for(const e in i)return i[e];return null}function fy(i,e,r,a,h,m,y,w,M,k){let B=y.top,U=y.bottom,G=y.left,X=y.right;const Y=y.collisionPadding;if(Y&&(G-=Y[0],B-=Y[1],X+=Y[2],U+=Y[3]),M){const ie=new He(G,B),de=new He(X,B),Ee=new He(G,U),Re=new He(X,U),Se=wt(M);let De=new He(0,0);k&&(De=new He(k[0],k[1])),ie._rotateAround(Se,De),de._rotateAround(Se,De),Ee._rotateAround(Se,De),Re._rotateAround(Se,De),G=Math.min(ie.x,de.x,Ee.x,Re.x),X=Math.max(ie.x,de.x,Ee.x,Re.x),B=Math.min(ie.y,de.y,Ee.y,Re.y),U=Math.max(ie.y,de.y,Ee.y,Re.y)}return i.emplaceBack(e.x,e.y,e.z,r.x,r.y,G,B,X,U,w,a,h,m),i.length-1}function Ov(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function PM(i,e,r,a){const h=i.compareText;if(e in h){const m=h[e];for(let y=m.length-1;y>=0;y--)if(a.dist(m[y])<r)return!0}else h[e]=[];return h[e].push(a),!1}function w1(i,e){const r=i.fovAboveCenter,a=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,h=(i._camera.position[2]*i.worldSize-a)/Math.cos(i._pitch),m=Math.sin(r)*h/Math.sin(Math.max(Math.PI/2-i._pitch-r,.01)),y=Math.sin(i._pitch)*m+h;return Math.min(1.01*y,h*(1/i._horizonShift))}function _f(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const r=Math.pow(2,-i.z),a=i.x*r,h=(i.x+1)*r,m=i.y*r,y=(i.y+1)*r,w=Io(a),M=Io(h),k=xs(m),B=xs(y),U=e.project(w,k),G=e.project(M,k),X=e.project(M,B),Y=e.project(w,B);let ie=Math.min(U.x,G.x,X.x,Y.x),de=Math.min(U.y,G.y,X.y,Y.y),Ee=Math.max(U.x,G.x,X.x,Y.x),Re=Math.max(U.y,G.y,X.y,Y.y);const Se=r/16;function De(Be,gt,dt,At,qt,yt){const Ot=(dt+qt)/2,Rt=(At+yt)/2,Ut=e.project(Io(Ot),xs(Rt)),Jt=Math.max(0,ie-Ut.x,de-Ut.y,Ut.x-Ee,Ut.y-Re);ie=Math.min(ie,Ut.x),Ee=Math.max(Ee,Ut.x),de=Math.min(de,Ut.y),Re=Math.max(Re,Ut.y),Jt>Se&&(De(Be,Ut,dt,At,Ot,Rt),De(Ut,gt,Ot,Rt,qt,yt))}De(U,G,a,m,h,m),De(G,X,h,m,h,y),De(X,Y,h,y,a,y),De(Y,U,a,y,a,m),ie-=Se,de-=Se,Ee+=Se,Re+=Se;const Ve=1/Math.max(Ee-ie,Re-de);return{scale:Ve,x:ie*Ve,y:de*Ve,x2:Ee*Ve,y2:Re*Ve,projection:e}}const LM=Co(new Float32Array(16));class Iu{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new Rr(0,0)}projectTilePoint(e,r,a){return{x:e,y:r,z:0}}locationPoint(e,r,a=!0){return e._coordinatePoint(e.locationCoordinate(r),a)}pixelsPerMeter(e,r){return ka(1,e)*r}pixelSpaceConversion(e,r,a){return 1}farthestPixelDistance(e){return w1(e,e.pixelsPerMeter)}pointCoordinate(e,r,a,h){const m=e.horizonLineFromTop(!1),y=new He(r,Math.max(m,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(y,h))}pointCoordinate3D(e,r,a){const h=new He(r,a);if(e.elevation)return e.elevation.pointCoordinate(h);{const m=this.pointCoordinate(e,h.x,h.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const a=e.horizonLineFromTop();return r.y<a}createInversionMatrix(e,r){return LM}createTileMatrix(e,r,a){let h,m,y;const w=a.canonical,M=Co(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=_f(w,this);h=1,m=k.x+a.wrap*k.scale,y=k.y,Al(M,M,[h/k.scale,h/k.scale,e.pixelsPerMeter/r])}else h=r/e.zoomScale(w.z),m=(w.x+Math.pow(2,w.z)*a.wrap)*h,y=w.y*h;return Fd(M,M,[m,y,0]),Al(M,M,[h/Ai,h/Ai,1]),M}upVector(e,r,a){return[0,0,1]}upVectorScale(e,r,a){return{metersToTile:1}}}class DM extends Iu{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,a]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(wt(r));this.n=(h+Math.sin(wt(a)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n:a,c:h,r0:m}=this,y=wt(e-this.center[0]),w=wt(r),M=Math.sqrt(h-2*a*Math.sin(w))/a;return{x:M*Math.sin(y*a),y:M*Math.cos(y*a)-m,z:0}}unproject(e,r){const{n:a,c:h,r0:m}=this,y=m+r;let w=Math.atan2(e,Math.abs(y))*Math.sign(y);y*a<0&&(w-=Math.PI*Math.sign(e)*Math.sign(y));const M=wt(this.center[0])*a;w=tr(w,-Math.PI-M,Math.PI-M);const k=xi(xt(w/a)+this.center[0],-180,180),B=Math.asin(xi((h-(e*e+y*y)*a*a)/(2*a),-1,1)),U=xi(xt(B),-85.051129,ko);return new Rr(k,U)}}const ug=1.340264,dg=-.081106,fg=893e-6,pg=.003796,py=Math.sqrt(3)/2;class OM extends Iu{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(py*Math.sin(r)),h=a*a,m=h*h*h;return{x:.5*(e*Math.cos(a)/(py*(ug+3*dg*h+m*(7*fg+9*pg*h)))/Math.PI+.5),y:1-.5*(a*(ug+dg*h+m*(fg+pg*h))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let a=r=(2*(1-r)-1)*Math.PI,h=a*a,m=h*h*h;for(let B,U,G,X=0;X<12&&(U=a*(ug+dg*h+m*(fg+pg*h))-r,G=ug+3*dg*h+m*(7*fg+9*pg*h),B=U/G,a=xi(a-B,-Math.PI/3,Math.PI/3),h=a*a,m=h*h*h,!(Math.abs(B)<1e-12));++X);const y=py*e*(ug+3*dg*h+m*(7*fg+9*pg*h))/Math.cos(a),w=Math.asin(Math.sin(a)/py),M=xi(180*y/Math.PI,-180,180),k=xi(180*w/Math.PI,-85.051129,ko);return new Rr(M,k)}}class RM extends Iu{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const a=360*(e-.5),h=xi(360*(.5-r),-85.051129,ko);return new Rr(a,h)}}const Np=Math.PI/2;function my(i){return Math.tan((Np+i)/2)}class zM extends Iu{constructor(e){super(e),this.center=e.center||[0,30];const[r,a]=this.parallels=e.parallels||[30,30];let h=wt(r),m=wt(a);this.southernCenter=h+m<0,this.southernCenter&&(h=-h,m=-m);const y=Math.cos(h),w=my(h);this.n=h===m?Math.sin(h):Math.log(y/Math.cos(m))/Math.log(my(m)/w),this.f=y*Math.pow(my(h),this.n)/this.n}project(e,r){r=wt(r),this.southernCenter&&(r=-r),e=wt(e-this.center[0]);const a=1e-6,{n:h,f:m}=this;m>0?r<-Np+a&&(r=-Np+a):r>Np-a&&(r=Np-a);const y=m/Math.pow(my(r),h);let w=y*Math.sin(h*e),M=m-y*Math.cos(h*e);return w=.5*(w/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:w,y:this.southernCenter?M:1-M,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:a,f:h}=this,m=h-r,y=Math.sign(m),w=Math.sign(a)*Math.sqrt(e*e+m*m);let M=Math.atan2(e,Math.abs(m))*y;m*a<0&&(M-=Math.PI*Math.sign(e)*y);const k=xi(xt(M/a)+this.center[0],-180,180),B=xi(xt(2*Math.atan(Math.pow(h/w,1/a))-Np),-85.051129,ko);return new Rr(k,this.southernCenter?-B:B)}}class T1 extends Iu{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:Ia(e),y:ea(r),z:0}}unproject(e,r){const a=Io(e),h=xs(r);return new Rr(a,h)}}const E1=wt(ko);class BM extends Iu{project(e,r){const a=(r=wt(r))*r,h=a*a;return{x:.5*((e=wt(e))*(.8707-.131979*a+h*(h*(.003971*a-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+a*(.015085+h*(.028874*a-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let a=r=(2*(1-r)-1)*Math.PI,h=25,m=0,y=a*a;do{y=a*a;const k=y*y;m=(a*(1.007226+y*(.015085+k*(.028874*y-.044475-.005916*k)))-r)/(1.007226+y*(.045255+k*(.259866*y-.311325-.005916*11*k))),a=xi(a-m,-E1,E1)}while(Math.abs(m)>1e-6&&--h>0);y=a*a;const w=xi(xt(e/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),M=xt(a);return new Rr(w,M)}}const S1=wt(ko);class FM extends Iu{project(e,r){r=wt(r),e=wt(e);const a=Math.cos(r),h=2/Math.PI,m=Math.acos(a*Math.cos(e/2)),y=Math.sin(m)/m,w=.5*(e*h+2*a*Math.sin(e/2)/y)||0,M=.5*(r+Math.sin(r)/y)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(e,r){let a=e=(2*e-.5)*Math.PI,h=r=(2*(1-r)-1)*Math.PI,m=25;const y=1e-6;let w=0,M=0;do{const k=Math.cos(h),B=Math.sin(h),U=2*B*k,G=B*B,X=k*k,Y=Math.cos(a/2),ie=Math.sin(a/2),de=2*Y*ie,Ee=ie*ie,Re=1-X*Y*Y,Se=Re?1/Re:0,De=Re?Math.acos(k*Y)*Math.sqrt(1/Re):0,Ve=.5*(2*De*k*ie+2*a/Math.PI)-e,Be=.5*(De*B+h)-r,gt=.5*Se*(X*Ee+De*k*Y*G)+1/Math.PI,dt=Se*(de*U/4-De*B*ie),At=.125*Se*(U*ie-De*B*X*de),qt=.5*Se*(G*Y+De*Ee*k)+.5,yt=dt*At-qt*gt;w=(Be*dt-Ve*qt)/yt,M=(Ve*At-Be*gt)/yt,a=xi(a-w,-Math.PI,Math.PI),h=xi(h-M,-S1,S1)}while((Math.abs(w)>y||Math.abs(M)>y)&&--m>0);return new Rr(xt(a),xt(h))}}class C1 extends Iu{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(wt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:a,cosPhi:h}=this;return{x:wt(e)*h*a+.5,y:-Math.sin(wt(r))/h*a+.5,z:0}}unproject(e,r){const{scale:a,cosPhi:h}=this,m=-(r-.5)/a,y=xi(xt((e-.5)/a)/h,-180,180),w=Math.asin(xi(m*h,-1,1)),M=xi(xt(w),-85.051129,ko);return new Rr(y,M)}}class NM extends T1{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,a){const h=Xd(e,r,a);return pn(h,h,hh(Qo(a))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,r){const a=mu(r.lat,r.lng),h=zs([],a),m=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude;Vd(a,a,h,ka(1,0)*Ai*m);const y=Co(new Float64Array(16));return Cl(y,e.pixelMatrix,e.globeMatrix),pn(a,a,y),new He(a[0],a[1])}pixelsPerMeter(e,r){return ka(1,0)*r}pixelSpaceConversion(e,r,a){const h=ka(1,e)*r,m=pr(ka(1,45)*r,h,a);return this.pixelsPerMeter(e,r)/m}createTileMatrix(e,r,a){const h=Vm(Qo(a.canonical));return Cl(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,r){const{center:a}=e,h=hh(Qo(r));return hp(h,h,wt(a.lng)),Nd(h,h,wt(a.lat)),Al(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,r,a,h){return I_(e,r,a,!0)||new yu(0,0)}pointCoordinate3D(e,r,a){const h=this.pointCoordinate(e,r,a,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,r){return!I_(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(h,m){const y=h.cameraToCenterDistance,w=h._centerAltitude*m,M=h._camera,k=h._camera.forward(),B=Aa([],so([],k,-y),[0,0,w]),U=h.worldSize/(2*Math.PI),G=[0,0,-U],X=h.width/h.height,Y=Math.tan(h.fovAboveCenter),ie=so([],M.up(),Y),de=so([],M.right(),Y*X),Ee=zs([],Aa([],Aa([],k,ie),de)),Re=[];let Se;if(new Fm(B,Ee).closestPointOnSphere(G,U,Re)){const De=Aa([],Re,G),Ve=Ao([],De,B);Se=Math.cos(h.fovAboveCenter)*fu(Ve)}else{const De=Ao([],B,G),Ve=Ao([],G,B);zs(Ve,Ve);const Be=fu(De)-U;Se=Math.sqrt(Be*(Be+2*U));const gt=Math.acos(Se/(U+Be))-Math.acos(oo(k,Ve));Se*=Math.cos(gt)}return 1.01*Se}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=_u(e.zoom);if(a>0){const h=w1(e,ka(1,e.center.lat)*e.worldSize),m=e.worldSize/(2*Math.PI),y=Math.max(e.width,e.height)/e.worldSize*Math.PI;return pr(r,h+m*(1-Math.cos(y)),Math.pow(a,10))}return r}upVector(e,r,a){return Xd(r,a,e,1)}upVectorScale(e){return{metersToTile:_p(gu(Qo(e)))}}}function A1(i){const e=i.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new T1(i);case"equirectangular":return new RM(i);case"naturalEarth":return new BM(i);case"equalEarth":return new OM(i);case"winkelTripel":return new FM(i);case"albers":return r?new C1(i):new DM(i);case"lambertConformalConic":return r?new C1(i):new zM(i);case"globe":return new NM(i)}throw new Error(`Invalid projection name: ${i.name}`)}const UM=cf.types,VM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gy(i,e,r,a,h,m,y,w,M,k,B,U,G){const X=w?Math.min(Mu,Math.round(w[0])):0,Y=w?Math.min(Mu,Math.round(w[1])):0;i.emplaceBack(e,r,Math.round(32*a),Math.round(32*h),m,y,(X<<1)+(M?1:0),Y,16*k,16*B,256*U,256*G)}function _y(i,e,r,a,h,m,y){i.emplaceBack(e,r,a,h,m,y)}function yy(i,e,r,a,h){i.emplaceBack(e,r,a,h),i.emplaceBack(e,r,a,h),i.emplaceBack(e,r,a,h),i.emplaceBack(e,r,a,h)}function jM(i){for(const e of i.sections)if(Lm(e.text))return!0;return!1}class Rv{constructor(e){this.layoutVertexArray=new Ct,this.indexArray=new Ci,this.programConfigurations=e,this.segments=new An,this.dynamicLayoutVertexArray=new Vt,this.opacityVertexArray=new Ii,this.placedSymbolArray=new Fn,this.globeExtVertexArray=new Ht}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$e.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,tt.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,VM,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,pt.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}_i(Rv,"SymbolBuffers");class zv{constructor(e,r,a){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new a,this.segments=new An,this.collisionVertexArray=new Gi,this.collisionVertexArrayExt=new Wi}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,mt.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Bt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}_i(zv,"CollisionBuffers");class ku{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Co([]),this.placementViewportMatrix=Co([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=mi(this.zoom,r["text-size"]),this.iconSizeData=mi(this.zoom,r["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(y=>Da[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Rv(new pc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Rv(new pc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Wn,this.lineVertexArray=new hu,this.symbolInstances=new Yr}calculateGlyphDependencies(e,r,a,h,m){for(let y=0;y<e.length;y++)if(r[e.charCodeAt(y)]=!0,h&&m){const w=ar[e.charAt(y)];w&&(r[w.charCodeAt(0)]=!0)}}populate(e,r,a,h){const m=this.layers[0],y=m.layout,w=this.projection.name==="globe",M=y.get("text-font"),k=y.get("text-field"),B=y.get("icon-image"),U=(k.value.kind!=="constant"||k.value.value instanceof Os&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),G=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,X=y.get("symbol-sort-key");if(this.features=[],!U&&!G)return;const Y=r.iconDependencies,ie=r.glyphDependencies,de=r.availableImages,Ee=new F(this.zoom);for(const{feature:Re,id:Se,index:De,sourceLayerIndex:Ve}of e){const Be=m._featureFilter.needGeometry,gt=uh(Re,Be);if(!m._featureFilter.filter(Ee,gt,a))continue;if(Be||(gt.geometry=Pa(Re,a,h)),w&&Re.type!==1&&a.z<=5){const yt=gt.geometry,Ot=.98078528056,Rt=(Ut,Jt)=>oo(Xd(Ut.x,Ut.y,a,1),Xd(Jt.x,Jt.y,a,1))<Ot;for(let Ut=0;Ut<yt.length;Ut++)yt[Ut]=iv(yt[Ut],Rt)}let dt,At;if(U){const yt=m.getValueAndResolveTokens("text-field",gt,a,de),Ot=Os.factory(yt);jM(Ot)&&(this.hasRTLText=!0),(!this.hasRTLText||E()==="unavailable"||this.hasRTLText&&D.isParsed())&&(dt=gr(Ot,m,gt))}if(G){const yt=m.getValueAndResolveTokens("icon-image",gt,a,de);At=yt instanceof Ts?yt:Ts.fromString(yt)}if(!dt&&!At)continue;const qt=this.sortFeaturesByKey?X.evaluate(gt,{},a):void 0;if(this.features.push({id:Se,text:dt,icon:At,index:De,sourceLayerIndex:Ve,geometry:gt.geometry,properties:Re.properties,type:UM[Re.type],sortKey:qt}),At&&(Y[At.name]=!0),dt){const yt=M.evaluate(gt,{},a).join(","),Ot=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Da.vertical)>=0;for(const Rt of dt.sections)if(Rt.image)Y[Rt.image.name]=!0;else{const Ut=Pd(dt.toString()),Jt=Rt.fontStack||yt,St=ie[Jt]=ie[Jt]||{};this.calculateGlyphDependencies(Rt.text,St,Ot,this.allowVerticalPlacement,Ut)}}}y.get("symbol-placement")==="line"&&(this.features=function(Re){const Se={},De={},Ve=[];let Be=0;function gt(yt){Ve.push(Re[yt]),Be++}function dt(yt,Ot,Rt){const Ut=De[yt];return delete De[yt],De[Ot]=Ut,Ve[Ut].geometry[0].pop(),Ve[Ut].geometry[0]=Ve[Ut].geometry[0].concat(Rt[0]),Ut}function At(yt,Ot,Rt){const Ut=Se[Ot];return delete Se[Ot],Se[yt]=Ut,Ve[Ut].geometry[0].shift(),Ve[Ut].geometry[0]=Rt[0].concat(Ve[Ut].geometry[0]),Ut}function qt(yt,Ot,Rt){const Ut=Rt?Ot[0][Ot[0].length-1]:Ot[0][0];return`${yt}:${Ut.x}:${Ut.y}`}for(let yt=0;yt<Re.length;yt++){const Ot=Re[yt],Rt=Ot.geometry,Ut=Ot.text?Ot.text.toString():null;if(!Ut){gt(yt);continue}const Jt=qt(Ut,Rt),St=qt(Ut,Rt,!0);if(Jt in De&&St in Se&&De[Jt]!==Se[St]){const si=At(Jt,St,Rt),wi=dt(Jt,St,Ve[si].geometry);delete Se[Jt],delete De[St],De[qt(Ut,Ve[wi].geometry,!0)]=wi,Ve[si].geometry=null}else Jt in De?dt(Jt,St,Rt):St in Se?At(Jt,St,Rt):(gt(yt),Se[Jt]=Be-1,De[St]=Be-1)}return Ve.filter(yt=>yt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Re,Se)=>Re.sortKey-Se.sortKey)}update(e,r,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,a,h),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,a,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=A1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const a=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:h,y:m}of r)this.lineVertexArray.emplaceBack(h,m);return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,r,a,h,m,y,w,M,k,B,U,G,X,Y){const ie=e.indexArray,de=e.layoutVertexArray,Ee=e.globeExtVertexArray,Re=e.segments.prepareSegment(4*r.length,de,ie,this.canOverlap?y.sortKey:void 0),Se=this.glyphOffsetArray.length,De=Re.vertexLength,Ve=this.allowVerticalPlacement&&w===Da.vertical?Math.PI/2:0,Be=y.text&&y.text.sections;for(let dt=0;dt<r.length;dt++){const{tl:At,tr:qt,bl:yt,br:Ot,tex:Rt,pixelOffsetTL:Ut,pixelOffsetBR:Jt,minFontScaleX:St,minFontScaleY:si,glyphOffset:wi,isSDF:hi,sectionIndex:qi}=r[dt],Qt=Re.vertexLength,Li=wi[1];if(gy(de,k.x,k.y,At.x,Li+At.y,Rt.x,Rt.y,a,hi,Ut.x,Ut.y,St,si),gy(de,k.x,k.y,qt.x,Li+qt.y,Rt.x+Rt.w,Rt.y,a,hi,Jt.x,Ut.y,St,si),gy(de,k.x,k.y,yt.x,Li+yt.y,Rt.x,Rt.y+Rt.h,a,hi,Ut.x,Jt.y,St,si),gy(de,k.x,k.y,Ot.x,Li+Ot.y,Rt.x+Rt.w,Rt.y+Rt.h,a,hi,Jt.x,Jt.y,St,si),M){const{x:Xi,y:Er,z:Zi}=M.anchor,[zi,an,Ji]=M.up;_y(Ee,Xi,Er,Zi,zi,an,Ji),_y(Ee,Xi,Er,Zi,zi,an,Ji),_y(Ee,Xi,Er,Zi,zi,an,Ji),_y(Ee,Xi,Er,Zi,zi,an,Ji),yy(e.dynamicLayoutVertexArray,Xi,Er,Zi,Ve)}else yy(e.dynamicLayoutVertexArray,k.x,k.y,k.z,Ve);ie.emplaceBack(Qt,Qt+1,Qt+2),ie.emplaceBack(Qt+1,Qt+2,Qt+3),Re.vertexLength+=4,Re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wi[0]),dt!==r.length-1&&qi===r[dt+1].sectionIndex||e.programConfigurations.populatePaintArrays(de.length,y,y.index,{},X,Y,Be&&Be[qi])}const gt=M?M.anchor:k;e.placedSymbolArray.emplaceBack(gt.x,gt.y,gt.z,k.x,k.y,Se,this.glyphOffsetArray.length-Se,De,B,U,k.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],w,0,!1,0,G,0)}_commitLayoutVertex(e,r,a,h,m,y,w){e.emplaceBack(r,a,h,m,y,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(e,r,a,h,m,y,w){const M=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),k=M.vertexLength,B=w.tileAnchorX,U=w.tileAnchorY;for(let X=0;X<4;X++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x1,e.y2)),M.vertexLength+=4;const G=a.indexArray;G.emplaceBack(k,k+1),G.emplaceBack(k+1,k+2),G.emplaceBack(k+2,k+3),G.emplaceBack(k+3,k),M.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceTextSize(e,y,r,w);this._addCollisionDebugVertices(M,k,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceIconSize(e,r,y.placedIconSymbolIndex);this._addCollisionDebugVertices(M,k,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,y)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zv(vi,Yt.members,is),this.iconCollisionBox=new zv(vi,Yt.members,is);const a=bi(this.iconSizeData,e),h=bi(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(h,e,r,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,e,r,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(a,e,r,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(a,e,r,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(e,r,a,h){const m=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:h),y=Ni(this.textSizeData,e,m)/Ft;return this.tilePixelRatio*y}getSymbolInstanceIconSize(e,r,a){const h=this.icon.placedSymbolArray.get(a),m=Ni(this.iconSizeData,e,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(e,r,a){e.emplaceBack(r,-a,-a),e.emplaceBack(r,a,-a),e.emplaceBack(r,a,a),e.emplaceBack(r,-a,a)}_updateTextDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceTextSize(e,y,r,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,M.padding)}}_updateIconDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceIconSize(e,r,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,M.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=bi(this.iconSizeData,e),h=bi(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(h,e,r,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,e,r,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(a,e,r,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,r,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,a,h,m,y,w,M,k){const B={};if(r<a){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ve}=e.get(r);B.textBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.textFeatureIndex=Ve}if(h<m){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ve}=e.get(h);B.verticalTextBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.verticalTextFeatureIndex=Ve}if(y<w){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ve}=e.get(y);B.iconBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.iconFeatureIndex=Ve}if(M<k){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ve}=e.get(M);B.verticalIconBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.verticalIconFeatureIndex=Ve}return B}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const a=e.placedSymbolArray.get(r),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),a=Math.cos(e),h=[],m=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const M=this.symbolInstances.get(w);h.push(0|Math.round(r*M.tileAnchorX+a*M.tileAnchorY)),m.push(M.featureIndex)}return y.sort((w,M)=>h[w]-h[M]||m[M]-m[w]),y}addToSortKeyRanges(e,r){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===r?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const a=this.symbolInstances.get(r);this.featureSortOrder.push(a.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:k}=a;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&this.addIndicesForPlacedSymbol(this.text,m),y>=0&&y!==m&&y!==h&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}_i(ku,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ku.MAX_GLYPHS=65535,ku.addDynamicAttributes=yy;const $M=new ke({"symbol-placement":new ee(Et.layout_symbol["symbol-placement"]),"symbol-spacing":new ee(Et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ee(Et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pe(Et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ee(Et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ee(Et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ee(Et.layout_symbol["icon-ignore-placement"]),"icon-optional":new ee(Et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ee(Et.layout_symbol["icon-rotation-alignment"]),"icon-size":new pe(Et.layout_symbol["icon-size"]),"icon-text-fit":new ee(Et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ee(Et.layout_symbol["icon-text-fit-padding"]),"icon-image":new pe(Et.layout_symbol["icon-image"]),"icon-rotate":new pe(Et.layout_symbol["icon-rotate"]),"icon-padding":new ee(Et.layout_symbol["icon-padding"]),"icon-keep-upright":new ee(Et.layout_symbol["icon-keep-upright"]),"icon-offset":new pe(Et.layout_symbol["icon-offset"]),"icon-anchor":new pe(Et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ee(Et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ee(Et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ee(Et.layout_symbol["text-rotation-alignment"]),"text-field":new pe(Et.layout_symbol["text-field"]),"text-font":new pe(Et.layout_symbol["text-font"]),"text-size":new pe(Et.layout_symbol["text-size"]),"text-max-width":new pe(Et.layout_symbol["text-max-width"]),"text-line-height":new pe(Et.layout_symbol["text-line-height"]),"text-letter-spacing":new pe(Et.layout_symbol["text-letter-spacing"]),"text-justify":new pe(Et.layout_symbol["text-justify"]),"text-radial-offset":new pe(Et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ee(Et.layout_symbol["text-variable-anchor"]),"text-anchor":new pe(Et.layout_symbol["text-anchor"]),"text-max-angle":new ee(Et.layout_symbol["text-max-angle"]),"text-writing-mode":new ee(Et.layout_symbol["text-writing-mode"]),"text-rotate":new pe(Et.layout_symbol["text-rotate"]),"text-padding":new ee(Et.layout_symbol["text-padding"]),"text-keep-upright":new ee(Et.layout_symbol["text-keep-upright"]),"text-transform":new pe(Et.layout_symbol["text-transform"]),"text-offset":new pe(Et.layout_symbol["text-offset"]),"text-allow-overlap":new ee(Et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ee(Et.layout_symbol["text-ignore-placement"]),"text-optional":new ee(Et.layout_symbol["text-optional"])});var Bv={paint:new ke({"icon-opacity":new pe(Et.paint_symbol["icon-opacity"]),"icon-color":new pe(Et.paint_symbol["icon-color"]),"icon-halo-color":new pe(Et.paint_symbol["icon-halo-color"]),"icon-halo-width":new pe(Et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pe(Et.paint_symbol["icon-halo-blur"]),"icon-translate":new ee(Et.paint_symbol["icon-translate"]),"icon-translate-anchor":new ee(Et.paint_symbol["icon-translate-anchor"]),"text-opacity":new pe(Et.paint_symbol["text-opacity"]),"text-color":new pe(Et.paint_symbol["text-color"],{runtimeType:Ps,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new pe(Et.paint_symbol["text-halo-color"]),"text-halo-width":new pe(Et.paint_symbol["text-halo-width"]),"text-halo-blur":new pe(Et.paint_symbol["text-halo-blur"]),"text-translate":new ee(Et.paint_symbol["text-translate"]),"text-translate-anchor":new ee(Et.paint_symbol["text-translate-anchor"])}),layout:$M};class M1{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Gl,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_i(M1,"FormatSectionOverride",{omit:["defaultValue"]});class xy extends Ca{constructor(e){super(e,Bv)}recalculate(e,r){super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,a,h){const m=this.layout.get(e).evaluate(r,{},a,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Cr(y.value)||!m?m:function(w,M){return M.replace(/{([^{}]+)}/g,(k,B)=>B in w?String(w[B]):"")}(r.properties,m)}createBucket(e){return new ku(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Bv.paint.overridableProperties){if(!xy.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),a=new M1(r),h=new ps(a,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new iu("source",h):new _l("composite",h,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new _e(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,a){return!(!this.layout||r.isDataDriven()||a.isDataDriven())&&xy.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const a=e.get("text-field"),h=Bv.paint.properties[r];let m=!1;const y=w=>{for(const M of w)if(h.overrides&&h.overrides.hasOverride(M))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Os)y(a.value.value.sections);else if(a.value.kind==="source"){const w=k=>{m||(k instanceof ma&&yn(k.value)===ds?y(k.value.sections):k instanceof _a?y(k.sections):k.eachChild(w))},M=a.value;M._styleExpression&&w(M._styleExpression.expression)}return m}getProgramConfiguration(e){return new fc(this,e)}}var GM={paint:new ke({"background-color":new ee(Et.paint_background["background-color"]),"background-pattern":new ee(Et.paint_background["background-pattern"]),"background-opacity":new ee(Et.paint_background["background-opacity"])})},WM={paint:new ke({"raster-opacity":new ee(Et.paint_raster["raster-opacity"]),"raster-hue-rotate":new ee(Et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ee(Et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ee(Et.paint_raster["raster-brightness-max"]),"raster-saturation":new ee(Et.paint_raster["raster-saturation"]),"raster-contrast":new ee(Et.paint_raster["raster-contrast"]),"raster-resampling":new ee(Et.paint_raster["raster-resampling"]),"raster-fade-duration":new ee(Et.paint_raster["raster-fade-duration"])})};class HM extends Ca{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var qM={paint:new ke({"sky-type":new ee(Et.paint_sky["sky-type"]),"sky-atmosphere-sun":new ee(Et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ee(Et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ee(Et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ee(Et.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ce(Et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ee(Et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ee(Et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ee(Et.paint_sky["sky-opacity"])})};function Fv(i,e,r){const a=[0,0,1],h=ys([]);return Bm(h,h,r?-wt(i)+Math.PI:wt(i)),E_(h,h,-wt(e)),Tr(a,a,h),zs(a,a)}const XM={circle:class extends Ca{constructor(i){super(i,vc)}createBucket(i){return new vu(i)}queryRadius(i){const e=i;return wu("circle-radius",this,e)+wu("circle-stroke-width",this,e)+Qa(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,r,a,h,m,y,w){const M=Ep(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return Tu(i,a,m,y,w,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,k)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new fc(this,i)}},heatmap:class extends Ca{createBucket(i){return new qm(i)}constructor(i){super(i,ov),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Xm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return wu("heatmap-radius",this,i)}queryIntersectsFeature(i,e,r,a,h,m,y,w){const M=this.paint.get("heatmap-radius").evaluate(e,r);return Tu(i,a,m,y,w,!0,!0,new He(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new fc(this,i)}},hillshade:class extends Ca{constructor(i){super(i,av)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ca{constructor(i){super(i,_v)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(i){return new fc(this,i)}recalculate(i,e){super.recalculate(i,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new lf(i)}queryRadius(){return Qa(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,r,a,h,m){return!i.queryGeometry.isAboveHorizon&&Wm(Hm(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends Ca{constructor(i){super(i,o)}createBucket(i){return new df(i)}queryRadius(){return Qa(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new fc(this,i)}queryIntersectsFeature(i,e,r,a,h,m,y,w,M){const k=Ep(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),B=this.paint.get("fill-extrusion-height").evaluate(e,r),U=this.paint.get("fill-extrusion-base").evaluate(e,r),G=[0,0],X=w&&m.elevation,Y=m.elevation?m.elevation.exaggeration():1,ie=i.tile.getBucket(this);if(X&&ie instanceof df){const De=ie.centroidVertexArray,Ve=M+1;Ve<De.length&&(G[0]=De.geta_centroid_pos0(Ve),G[1]=De.geta_centroid_pos1(Ve))}if(G[0]===0&&G[1]===1)return!1;m.projection.name==="globe"&&(a=ag([a],[new He(0,0),new He(Ai,Ai)],i.tileID.canonical).map(De=>De.polygon).flat());const de=X?w:null,[Ee,Re]=function(De,Ve,Be,gt,dt,At,qt,yt,Ot,Rt,Ut){return De.projection.name==="globe"?function(Jt,St,si,wi,hi,qi,Qt,Li,Xi,Er,Zi){const zi=[],an=[],Ji=Jt.projection.upVectorScale(Zi,Jt.center.lat,Jt.worldSize).metersToTile,Qi=[0,0,0,1],Gr=[0,0,0,1],Jr=(Wr,bn,Un,qn)=>{Wr[0]=bn,Wr[1]=Un,Wr[2]=qn,Wr[3]=1},Qr=oy();si>0&&(si+=Qr),wi+=Qr;for(const Wr of St){const bn=[],Un=[];for(const qn of Wr){const Hr=qn.x+hi.x,rs=qn.y+hi.y,Xn=Jt.projection.projectTilePoint(Hr,rs,Zi),In=Jt.projection.upVector(Zi,qn.x,qn.y);let Mr=si,Zn=wi;if(Qt){const en=N(Hr,rs,si,wi,Qt,Li,Xi,Er);Mr+=en.base,Zn+=en.top}si!==0?Jr(Qi,Xn.x+In[0]*Ji*Mr,Xn.y+In[1]*Ji*Mr,Xn.z+In[2]*Ji*Mr):Jr(Qi,Xn.x,Xn.y,Xn.z),Jr(Gr,Xn.x+In[0]*Ji*Zn,Xn.y+In[1]*Ji*Zn,Xn.z+In[2]*Ji*Zn),pn(Qi,Qi,qi),pn(Gr,Gr,qi),bn.push(new A(Qi[0],Qi[1],Qi[2])),Un.push(new A(Gr[0],Gr[1],Gr[2]))}zi.push(bn),an.push(Un)}return[zi,an]}(De,Ve,Be,gt,dt,At,qt,yt,Ot,Rt,Ut):qt?function(Jt,St,si,wi,hi,qi,Qt,Li,Xi){const Er=[],Zi=[],zi=[0,0,0,1];for(const an of Jt){const Ji=[],Qi=[];for(const Gr of an){const Jr=Gr.x+wi.x,Qr=Gr.y+wi.y,Wr=N(Jr,Qr,St,si,qi,Qt,Li,Xi);zi[0]=Jr,zi[1]=Qr,zi[2]=Wr.base,zi[3]=1,Bs(zi,zi,hi),zi[3]=Math.max(zi[3],1e-5);const bn=new A(zi[0]/zi[3],zi[1]/zi[3],zi[2]/zi[3]);zi[0]=Jr,zi[1]=Qr,zi[2]=Wr.top,zi[3]=1,Bs(zi,zi,hi),zi[3]=Math.max(zi[3],1e-5);const Un=new A(zi[0]/zi[3],zi[1]/zi[3],zi[2]/zi[3]);Ji.push(bn),Qi.push(Un)}Er.push(Ji),Zi.push(Qi)}return[Er,Zi]}(Ve,Be,gt,dt,At,qt,yt,Ot,Rt):function(Jt,St,si,wi,hi){const qi=[],Qt=[],Li=hi[8]*St,Xi=hi[9]*St,Er=hi[10]*St,Zi=hi[11]*St,zi=hi[8]*si,an=hi[9]*si,Ji=hi[10]*si,Qi=hi[11]*si;for(const Gr of Jt){const Jr=[],Qr=[];for(const Wr of Gr){const bn=Wr.x+wi.x,Un=Wr.y+wi.y,qn=hi[0]*bn+hi[4]*Un+hi[12],Hr=hi[1]*bn+hi[5]*Un+hi[13],rs=hi[2]*bn+hi[6]*Un+hi[14],Xn=hi[3]*bn+hi[7]*Un+hi[15],In=qn+Li,Mr=Hr+Xi,Zn=rs+Er,en=Math.max(Xn+Zi,1e-5),co=qn+zi,Yn=Hr+an,Cs=rs+Ji,vs=Math.max(Xn+Qi,1e-5);Jr.push(new A(In/en,Mr/en,Zn/en)),Qr.push(new A(co/vs,Yn/vs,Cs/vs))}qi.push(Jr),Qt.push(Qr)}return[qi,Qt]}(Ve,Be,gt,dt,At)}(m,a,U,B,k,y,de,G,Y,m.center.lat,i.tileID.canonical),Se=i.queryGeometry;return function(De,Ve,Be){let gt=1/0;Wm(Be,Ve)&&(gt=O(Be,Ve[0]));for(let dt=0;dt<Ve.length;dt++){const At=Ve[dt],qt=De[dt];for(let yt=0;yt<At.length-1;yt++){const Ot=At[yt],Rt=[Ot,At[yt+1],qt[yt+1],qt[yt],Ot];Jd(Be,Rt)&&(gt=Math.min(gt,O(Be,Rt)))}}return gt!==1/0&&gt}(Ee,Re,Se.isPointQuery()?Se.screenBounds:Se.screenGeometry)}},line:class extends Ca{constructor(i){super(i,fe),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ud,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=Xe.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new te(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new fc(this,i)}queryRadius(i){const e=i,r=Ue(wu("line-width",this,e),wu("line-gap-width",this,e)),a=wu("line-offset",this,e);return r/2+Math.abs(a)+Qa(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,r,a,h,m){if(i.queryGeometry.isAboveHorizon)return!1;const y=Hm(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),w=i.pixelToTileUnitsFactor/2*Ue(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),M=this.paint.get("line-offset").evaluate(e,r);return M&&(a=function(k,B){const U=[],G=new He(0,0);for(let X=0;X<k.length;X++){const Y=k[X],ie=[];for(let de=0;de<Y.length;de++){const Ee=Y[de],Re=Y[de+1],Se=de===0?G:Ee.sub(Y[de-1])._unit()._perp(),De=de===Y.length-1?G:Re.sub(Ee)._unit()._perp(),Ve=Se._add(De)._unit();Ve._mult(1/(Ve.x*De.x+Ve.y*De.y)),ie.push(Ve._mult(B)._add(Ee))}U.push(ie)}return U}(a,M*i.pixelToTileUnitsFactor)),function(k,B,U){for(let G=0;G<B.length;G++){const X=B[G];if(k.length>=3){for(let Y=0;Y<X.length;Y++)if(Ja(k,X[Y]))return!0}if(F_(k,X,U))return!0}return!1}(y,a,w)}isTileClipped(){return!0}},symbol:xy,background:class extends Ca{constructor(i){super(i,GM)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ca{constructor(i){super(i,WM)}getProgramIds(){return["raster"]}},sky:class extends Ca{constructor(i){super(i,qM),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Xm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const a=this.paint.get("sky-atmosphere-sun"),h=!a,m=i.style.light,y=m.properties.get("position");return h&&m.properties.get("anchor")==="viewport"&&Lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Fv(y.azimuthal,90-y.polar,e):Fv(a[0],90-a[1],e)}const r=this.paint.get("sky-gradient-center");return Fv(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class mg{constructor(e,r,a,h){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(r,h)}update(e,r,a){const{width:h,height:m}=e,{context:y}=this,{gl:w}=y,{HTMLImageElement:M,HTMLCanvasElement:k,HTMLVideoElement:B,ImageData:U,ImageBitmap:G}=$;if(w.bindTexture(w.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!r||r.premultiply!==!1)),a||this.size&&this.size[0]===h&&this.size[1]===m){const{x:X,y:Y}=a||{x:0,y:0};e instanceof M||e instanceof k||e instanceof B||e instanceof U||G&&e instanceof G?w.texSubImage2D(w.TEXTURE_2D,0,X,Y,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,X,Y,h,m,w.RGBA,w.UNSIGNED_BYTE,e.data)}else this.size=[h,m],e instanceof M||e instanceof k||e instanceof B||e instanceof U||G&&e instanceof G?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,h,m,0,this.format,w.UNSIGNED_BYTE,e.data);this.useMipmap=!!(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(e,r){const{context:a}=this,{gl:h}=a;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,r),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ZM{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class YM{constructor(){this.tasks={},this.taskQueue=[],Ti(["process"],this),this.invoker=new ZM(this.process),this.nextId=0}add(e,r){const a=this.nextId++,h=function({type:m,isSymbolTile:y,zoom:w}){return w=w||0,m==="message"?0:m!=="maybePrepare"||y?m!=="parseTile"||y?m==="parseTile"&&y?300-w:m==="maybePrepare"&&y?400-w:500:200-w:100-w}(r);if(h===0){ni();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:r,priority:h,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){ni();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<r&&(r=m.priority,e=h)}if(e===null)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class I1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const a=e[r];this._stringToNumber[a]=r,this._numberToString[r]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const KM=["tile","layer","source","sourceLayer","state"];class k1{constructor(e,r,a,h,m){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=a,this._y=h,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const r of KM)this[r]!==void 0&&(e[r]=this[r]);return e}}const el=32,Tc=33,Pu=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,r=0,a=0,h=0,m=0,y=0,w=0;for(1&e?h=m=y=el:r=a=w=el;(e>>=1)>1;){const k=r+h>>1,B=a+m>>1;1&e?(h=r,m=a,r=y,a=w):(r=h,a=m,h=y,m=w),y=k,w=B}const M=4*i;Pu[M+0]=r,Pu[M+1]=a,Pu[M+2]=h,Pu[M+3]=m}const Ec=new Uint16Array(2178),Lu=new Uint8Array(1089),vy=new Uint16Array(1089);function P1(i){return i===0?-.03125:i===32?.03125:0}var L1=et([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const D1={type:2,extent:Ai,loadGeometry:()=>[[new He(0,0),new He(Ai+1,0),new He(Ai+1,Ai+1),new He(0,Ai+1),new He(0,0)]]};class Nv{constructor(e,r,a,h,m){this.tileID=e,this.uid=nn(),this.uses=0,this.tileSize=r,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<Uo.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=_f(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const y={};if(!m)return y;for(const w of h){const M=w.layerIds.map(k=>m.getLayer(k)).filter(Boolean);if(M.length!==0){w.layers=M,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(k=>M.filter(B=>B.id===k)[0]));for(const k of M)y[k.id]=w}}return y}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof ku){if(this.hasSymbolBuckets=!0,!a)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof ku&&m.hasRTLText){this.hasRTLText=!0,D.isLoading()||D.isLoaded()||E()!=="deferred"||L();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Ur}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const h=this.buckets[a];h.uploadPending()&&h.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new mg(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new mg(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new mg(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,a,h,m,y,w,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:w,transform:y,params:m,tileTransform:this.tileTransform},e,r,a):{}}querySourceFeatures(e,r){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const h=a.loadVTLayers(),m=r?r.sourceLayer:"",y=h._geojsonTileLayer||h[m];if(!y)return;const w=ru(r&&r.filter),{z:M,x:k,y:B}=this.tileID.canonical,U={z:M,x:k,y:B};for(let G=0;G<y.length;G++){const X=y.feature(G);if(w.needGeometry){const de=uh(X,!0);if(!w.filter(new F(this.tileID.overscaledZ),de,this.tileID.canonical))continue}else if(!w.filter(new F(this.tileID.overscaledZ),X))continue;const Y=a.getId(X,m),ie=new k1(X,M,k,B,Y);ie.tile=U,e.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const a=Te(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let h=!1;if(this.expirationTime>a)h=!1;else if(r)if(this.expirationTime<r)h=!0;else{const m=this.expirationTime-r;m?this.expirationTime=a+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!r)return;const a=this.latestFeatureIndex.loadVTLayers(),h=r.style.listImages();for(const m in this.buckets){if(!r.style.hasLayer(m))continue;const y=this.buckets[m],w=y.layers[0].sourceLayer||"_geojsonTileLayer",M=a[w],k=e[w];if(!M||!k||Object.keys(k).length===0)continue;if(y.update(k,M,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof te||y instanceof lf){const U=r.style._getSourceCache(y.layers[0].source);r._terrain&&r._terrain.enabled&&U&&y.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(U.id,this.tileID)}const B=r&&r.style&&r.style.getLayer(m);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Uo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Uo.now()+e}setTexture(e,r){const a=r.context,h=a.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new mg(a,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(e,r){const a={};for(const h of r)a[h]=!0;this.dependencies[e]=a}hasDependency(e,r){for(const a of e){const h=this.dependencies[a];if(h){for(const m of r)if(h[m])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const a=Pa(D1,this.tileID.canonical,this.tileTransform)[0],h=new Nt,m=new ro;for(let y=0;y<a.length;y++){const{x:w,y:M}=a[y];h.emplaceBack(w,M),m.emplaceBack(y)}m.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(m),this._tileDebugBuffer=e.createVertexBuffer(h,Jo.members),this._tileDebugSegments=An.simpleSegment(0,0,h.length,m.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const a=Pa(D1,this.tileID.canonical,this.tileTransform)[0];let h,m;if(this.isRaster){const y=function(w,M){const k=_f(w,M),B=Math.pow(2,w.z);for(let de=0;de<Tc;de++)for(let Ee=0;Ee<Tc;Ee++){const Re=Io((w.x+(Ee+P1(Ee))/el)/B),Se=xs((w.y+(de+P1(de))/el)/B),De=M.project(Re,Se),Ve=de*Tc+Ee;Ec[2*Ve+0]=Math.round((De.x*k.scale-k.x)*Ai),Ec[2*Ve+1]=Math.round((De.y*k.scale-k.y)*Ai)}Lu.fill(0),vy.fill(0);for(let de=2045;de>=0;de--){const Ee=4*de,Re=Pu[Ee+0],Se=Pu[Ee+1],De=Pu[Ee+2],Ve=Pu[Ee+3],Be=Re+De>>1,gt=Se+Ve>>1,dt=Be+gt-Se,At=gt+Re-Be,qt=Se*Tc+Re,yt=Ve*Tc+De,Ot=gt*Tc+Be,Rt=Math.hypot((Ec[2*qt+0]+Ec[2*yt+0])/2-Ec[2*Ot+0],(Ec[2*qt+1]+Ec[2*yt+1])/2-Ec[2*Ot+1])>=16;Lu[Ot]=Lu[Ot]||(Rt?1:0),de<1022&&(Lu[Ot]=Lu[Ot]||Lu[(Se+At>>1)*Tc+(Re+dt>>1)]||Lu[(Ve+At>>1)*Tc+(De+dt>>1)])}const U=new Mt,G=new Ci;let X=0;function Y(de,Ee){const Re=Ee*Tc+de;return vy[Re]===0&&(U.emplaceBack(Ec[2*Re+0],Ec[2*Re+1],de*Ai/el,Ee*Ai/el),vy[Re]=++X),vy[Re]-1}function ie(de,Ee,Re,Se,De,Ve){const Be=de+Re>>1,gt=Ee+Se>>1;if(Math.abs(de-De)+Math.abs(Ee-Ve)>1&&Lu[gt*Tc+Be])ie(De,Ve,de,Ee,Be,gt),ie(Re,Se,De,Ve,Be,gt);else{const dt=Y(de,Ee),At=Y(Re,Se),qt=Y(De,Ve);G.emplaceBack(dt,At,qt)}}return ie(0,0,el,el,el,0),ie(el,el,0,0,0,el),{vertices:U,indices:G}}(this.tileID.canonical,r);h=y.vertices,m=y.indices}else{h=new Mt,m=new Ci;for(const{x:w,y:M}of a)h.emplaceBack(w,M,0,0);const y=eg(h.int16,void 0,4);for(let w=0;w<y.length;w+=3)m.emplaceBack(y[w],y[w+1],y[w+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,L1.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(m),this._tileBoundsSegments=An.simpleSegment(0,0,h.length,m.length)}_makeGlobeTileDebugBuffers(e,r){const a=r.projection;if(!a||a.name!=="globe"||r.freezeTileCoverage)return;const h=this.tileID.canonical,m=hh(Um(h,r)),y=_u(r.zoom);let w;y>0&&(w=cp(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,h,r,m,w,y),this._makeGlobeTileDebugTextBuffer(e,h,r,m,w,y)}_globePoint(e,r,a,h,m,y,w){let M=Xd(e,r,a);if(y){const k=1<<a.z,B=Ia(h.center.lng),U=ea(h.center.lat),G=(a.x+.5)/k-B;let X=0;G>.5?X=-1:G<-.5&&(X=1);let Y=(e/Ai+a.x)/k+X,ie=(r/Ai+a.y)/k;Y=(Y-B)*h._pixelsPerMercatorPixel+B,ie=(ie-U)*h._pixelsPerMercatorPixel+U;const de=[Y*h.worldSize,ie*h.worldSize,0];pn(de,de,y),M=Ma(M,de,w)}return pn(M,M,m)}_makeGlobeTileDebugBorderBuffer(e,r,a,h,m,y){const w=new Nt,M=new ro,k=new ht,B=(G,X,Y,ie,de)=>{const Ee=(Y-G)/(de-1),Re=(ie-X)/(de-1),Se=w.length;for(let De=0;De<de;De++){const Ve=G+De*Ee,Be=X+De*Re;w.emplaceBack(Ve,Be);const gt=this._globePoint(Ve,Be,r,a,h,m,y);k.emplaceBack(gt[0],gt[1],gt[2]),M.emplaceBack(Se+De)}},U=Ai;B(0,0,U,0,16),B(U,0,U,U,16),B(U,U,0,U,16),B(0,U,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(M),this._tileDebugBuffer=e.createVertexBuffer(w,Jo.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(k,A_.members),this._tileDebugSegments=An.simpleSegment(0,0,w.length,M.length)}_makeGlobeTileDebugTextBuffer(e,r,a,h,m,y){const w=Ai/4,M=new Nt,k=new Ci,B=new ht,U=25;k.reserve(32),M.reserve(U),B.reserve(U);const G=(X,Y)=>U*X+Y;for(let X=0;X<U;X++){const Y=X*w;for(let ie=0;ie<U;ie++){const de=ie*w;M.emplaceBack(de,Y);const Ee=this._globePoint(de,Y,r,a,h,m,y);B.emplaceBack(Ee[0],Ee[1],Ee[2])}}for(let X=0;X<4;X++)for(let Y=0;Y<4;Y++){const ie=G(X,Y),de=G(X,Y+1),Ee=G(X+1,Y),Re=G(X+1,Y+1);k.emplaceBack(ie,de,Ee),k.emplaceBack(Ee,de,Re)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(k),this._tileDebugTextBuffer=e.createVertexBuffer(M,Jo.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(B,A_.members),this._tileDebugTextSegments=An.simpleSegment(0,0,U,32)}}class JM{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,a){const h=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},dr(this.stateChanges[e][h],a),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])a[m]||(this.deletedStates[e][h][m]=null)}else for(const m in a)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,r,a){if(this.deletedStates[e]===null)return;const h=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&r!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][a]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(a in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][a]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,r){const a=String(r),h=dr({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][r];if(m===null)return{};for(const y in m)delete h[y]}return h}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const a={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),dr(this.state[h][y],this.stateChanges[h][y]),m[y]=this.state[h][y];a[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const y in this.state[h])m[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(this.deletedStates[h][y]===null)this.state[h][y]={};else if(this.state[h][y])for(const w of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][w];m[y]=this.state[h][y]}a[h]=a[h]||{},dr(a[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(const h in e)e[h].setFeatureState(a,r)}}class O1{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const a=this.toIdx(e,r);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function R1(i,e,r,a){let h=0,m=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(a[y])<1e-15){if(r[y]<i[y]||r[y]>e[y])return null}else{const w=1/a[y];let M=(i[y]-r[y])*w,k=(e[y]-r[y])*w;if(M>k){const B=M;M=k,k=B}if(M>h&&(h=M),k<m&&(m=k),h>m)return null}return h}function z1(i,e,r,a,h,m,y,w,M,k,B){const U=a-i,G=h-e,X=m-r,Y=y-i,ie=w-e,de=M-r,Ee=B[1]*de-B[2]*ie,Re=B[2]*Y-B[0]*de,Se=B[0]*ie-B[1]*Y,De=U*Ee+G*Re+X*Se;if(Math.abs(De)<1e-15)return null;const Ve=1/De,Be=k[0]-i,gt=k[1]-e,dt=k[2]-r,At=(Be*Ee+gt*Re+dt*Se)*Ve;if(At<0||At>1)return null;const qt=gt*X-dt*G,yt=dt*U-Be*X,Ot=Be*G-gt*U,Rt=(B[0]*qt+B[1]*yt+B[2]*Ot)*Ve;return Rt<0||At+Rt>1?null:(Y*qt+ie*yt+de*Ot)*Ve}function B1(i,e,r){return(i-e)/(r-e)}function F1(i,e,r,a,h,m,y,w,M){const k=1<<r,B=m-a,U=y-h,G=(i+1)/k*B+a,X=(e+0)/k*U+h,Y=(e+1)/k*U+h;w[0]=(i+0)/k*B+a,w[1]=X,M[0]=G,M[1]=Y}class N1{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(m){const y=Math.ceil(Math.log2(m.dim/8)),w=[];let M=Math.ceil(Math.pow(2,y));const k=1/M,B=(X,Y,ie,de,Ee)=>{const Re=de?1:0,Se=(X+1)*ie-Re,De=Y*ie,Ve=(Y+1)*ie-Re;Ee[0]=X*ie,Ee[1]=De,Ee[2]=Se,Ee[3]=Ve};let U=new O1(M);const G=[];for(let X=0;X<M*M;X++){B(X%M,Math.floor(X/M),k,!1,G);const Y=Du(G[0],G[1],m),ie=Du(G[2],G[1],m),de=Du(G[2],G[3],m),Ee=Du(G[0],G[3],m);U.minimums.push(Math.min(Y,ie,de,Ee)),U.maximums.push(Math.max(Y,ie,de,Ee)),U.leaves.push(1)}for(w.push(U),M/=2;M>=1;M/=2){const X=w[w.length-1];U=new O1(M);for(let Y=0;Y<M*M;Y++){B(Y%M,Math.floor(Y/M),2,!0,G);const ie=X.getElevation(G[0],G[1]),de=X.getElevation(G[2],G[1]),Ee=X.getElevation(G[2],G[3]),Re=X.getElevation(G[0],G[3]),Se=X.isLeaf(G[0],G[1]),De=X.isLeaf(G[2],G[1]),Ve=X.isLeaf(G[2],G[3]),Be=X.isLeaf(G[0],G[3]),gt=Math.min(ie.min,de.min,Ee.min,Re.min),dt=Math.max(ie.max,de.max,Ee.max,Re.max),At=Se&&De&&Ve&&Be;U.maximums.push(dt),U.minimums.push(gt),U.leaves.push(dt-gt<=5&&At?1:0)}w.push(U)}return w}(this.dem),a=r.length-1,h=r[a];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(r,0,0,a,0)}raycastRoot(e,r,a,h,m,y,w=1){return R1([e,r,-100],[a,h,this.maximums[0]*w],m,y)}raycast(e,r,a,h,m,y,w=1){if(!this.nodeCount)return null;const M=this.raycastRoot(e,r,a,h,m,y,w);if(M==null)return null;const k=[],B=[],U=[],G=[],X=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;X.length>0;){const{idx:Y,t:ie,nodex:de,nodey:Ee,depth:Re}=X.pop();if(this.leaves[Y]){F1(de,Ee,Re,e,r,a,h,U,G);const De=1<<Re,Ve=(de+0)/De,Be=(de+1)/De,gt=(Ee+0)/De,dt=(Ee+1)/De,At=Du(Ve,gt,this.dem)*w,qt=Du(Be,gt,this.dem)*w,yt=Du(Be,dt,this.dem)*w,Ot=Du(Ve,dt,this.dem)*w,Rt=z1(U[0],U[1],At,G[0],U[1],qt,G[0],G[1],yt,m,y),Ut=z1(G[0],G[1],yt,U[0],G[1],Ot,U[0],U[1],At,m,y),Jt=Math.min(Rt!==null?Rt:Number.MAX_VALUE,Ut!==null?Ut:Number.MAX_VALUE);if(Jt!==Number.MAX_VALUE)return Jt;{const St=Vd([],m,y,ie);if(U1(At,qt,Ot,yt,B1(St[0],U[0],G[0]),B1(St[1],U[1],G[1]))>=St[2])return ie}continue}let Se=0;for(let De=0;De<this._siblingOffset.length;De++){F1((de<<1)+this._siblingOffset[De][0],(Ee<<1)+this._siblingOffset[De][1],Re+1,e,r,a,h,U,G),U[2]=-100,G[2]=this.maximums[this.childOffsets[Y]+De]*w;const Ve=R1(U,G,m,y);if(Ve!=null){const Be=Ve;k[De]=Be;let gt=!1;for(let dt=0;dt<Se&&!gt;dt++)Be>=k[B[dt]]&&(B.splice(dt,0,De),gt=!0);gt||(B[Se]=De),Se++}}for(let De=0;De<Se;De++){const Ve=B[De];X.push({idx:this.childOffsets[Y]+Ve,t:k[Ve],nodex:(de<<1)+this._siblingOffset[Ve][0],nodey:(Ee<<1)+this._siblingOffset[Ve][1],depth:Re+1})}}return null}_addNode(e,r,a){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,a,h,m){if(e[h].isLeaf(r,a)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const y=h-1,w=e[y];let M=0,k=0;for(let B=0;B<this._siblingOffset.length;B++){const U=2*r+this._siblingOffset[B][0],G=2*a+this._siblingOffset[B][1],X=w.getElevation(U,G),Y=w.isLeaf(U,G),ie=this._addNode(X.min,X.max,Y);Y&&(M|=1<<B),k||(k=ie)}for(let B=0;B<this._siblingOffset.length;B++)M&1<<B||this._construct(e,2*r+this._siblingOffset[B][0],2*a+this._siblingOffset[B][1],y,k+B)}}function U1(i,e,r,a,h,m){return pr(pr(i,r,m),pr(e,a,m),h)}function Du(i,e,r){const a=r.dim,h=xi(i*a-.5,0,a-1),m=xi(e*a-.5,0,a-1),y=Math.floor(h),w=Math.floor(m),M=Math.min(y+1,a-1),k=Math.min(w+1,a-1);return U1(r.get(y,w),r.get(M,w),r.get(y,k),r.get(M,k),h-y,m-w)}const V1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function QM(i,e,r){return(256*i*256+256*e+r)/10-1e4}function eI(i,e,r){return 256*i+e+r/256-32768}class by{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,a,h=!1,m=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return Lt(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const y=this.dim=r.height-2,w=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=a||"mapbox",this.borderReady=h,!h){for(let M=0;M<y;M++)w[this._idx(-1,M)]=w[this._idx(0,M)],w[this._idx(y,M)]=w[this._idx(y-1,M)],w[this._idx(M,-1)]=w[this._idx(M,0)],w[this._idx(M,y)]=w[this._idx(M,y-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(y,-1)]=w[this._idx(y-1,0)],w[this._idx(-1,y)]=w[this._idx(0,y-1)],w[this._idx(y,y)]=w[this._idx(y-1,y-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new N1(this)}get(e,r,a=!1){a&&(e=xi(e,-1,this.dim),r=xi(r,-1,this.dim));const h=4*this._idx(e,r);return(this.encoding==="terrarium"?eI:QM)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return V1[e]}get unpackVector(){return V1[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}static pack(e,r){const a=[0,0,0,0],h=by.getUnpackVector(r);let m=Math.floor((e+h[3])/h[2]);return a[2]=m%256,m=Math.floor(m/256),a[1]=m%256,m=Math.floor(m/256),a[0]=m,a}getPixels(){return new ao({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,m=r*this.dim+this.dim,y=a*this.dim,w=a*this.dim+this.dim;switch(r){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:y=w-1;break;case 1:w=y+1}const M=-r*this.dim,k=-a*this.dim;for(let B=y;B<w;B++)for(let U=h;U<m;U++){const G=4*this._idx(U,B),X=4*this._idx(U+M,B+k);this.pixels[G+0]=e.pixels[X+0],this.pixels[G+1]=e.pixels[X+1],this.pixels[G+2]=e.pixels[X+2],this.pixels[G+3]=e.pixels[X+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}_i(by,"DEMData"),_i(N1,"DemMinMaxQuadTree",{omit:["dem"]});class tI{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,a){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:r,timeout:void 0};if(a!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},a)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const a=e.wrapped().key,h=r===void 0?0:this.data[a].indexOf(r),m=this.data[a][h];return this.data[a].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(m.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const a in this.data)for(const h of this.data[a])e(h.value)||r.push(h);for(const a of r)this.remove(a.value.tileID,a)}}class Up{constructor(e,r,a){this.func=e,this.mask=r,this.range=a}}Up.ReadOnly=!1,Up.ReadWrite=!0,Up.disabled=new Up(519,Up.ReadOnly,[0,1]);const Uv=7680;class Vv{constructor(e,r,a,h,m,y){this.test=e,this.ref=r,this.mask=a,this.fail=h,this.depthFail=m,this.pass=y}}Vv.disabled=new Vv({func:519,mask:0},0,0,Uv,Uv,Uv);class Sc{constructor(e,r,a){this.blendFunction=e,this.blendColor=r,this.mask=a}}Sc.Replace=[1,0],Sc.disabled=new Sc(Sc.Replace,Sn.transparent,[!1,!1,!1,!1]),Sc.unblended=new Sc(Sc.Replace,Sn.transparent,[!0,!0,!0,!0]),Sc.alphaBlended=new Sc([1,771],Sn.transparent,[!0,!0,!0,!0]);const jv=1029,$v=2305;class kl{constructor(e,r,a){this.enable=e,this.mode=r,this.frontFace=a}}kl.disabled=new kl(!1,jv,$v),kl.backCCW=new kl(!0,jv,$v),kl.backCW=new kl(!0,jv,2304),kl.frontCW=new kl(!0,1028,2304),kl.frontCCW=new kl(!0,1028,$v);class yf extends Vr{constructor(e,r,a){super(),this.id=e,this._onlySymbols=a,r.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new tI(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new JM,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const a=this._tiles[r];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return rn(this._tiles).map(e=>e.tileID).sort(j1).map(e=>e.key)}getRenderableIds(e){const r=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&r.push(this._tiles[a]);return e?r.sort((a,h)=>{const m=a.tileID,y=h.tileID,w=new He(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),M=new He(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-y.overscaledZ||M.y-w.y||M.x-w.x}).map(a=>a.tileID.key):r.map(a=>a.tileID).sort(j1).map(a=>a.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const a=this._tiles[e];a&&(a.state!=="loading"&&(a.state=r),this._loadTile(a,this._tileLoaded.bind(this,a,e,r)))}_tileLoaded(e,r,a,h){if(h)if(e.state="errored",h.status!==404)this._source.fire(new da(h,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Uo.now(),a==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Vo("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let h=0;h<r.length;h++){const m=r[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);a(e,y),a(y,e)}}function a(h,m){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=m.tileID.canonical.x-h.tileID.canonical.x;const w=m.tileID.canonical.y-h.tileID.canonical.y,M=Math.pow(2,h.tileID.canonical.z),k=m.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+M)===1?y+=M:Math.abs(y-M)===1&&(y-=M)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,y,w),h.neighboringTiles&&h.neighboringTiles[k]&&(h.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,a,h){for(const m in this._tiles){let y=this._tiles[m];if(h[m]||!y.hasData()||y.tileID.overscaledZ<=r||y.tileID.overscaledZ>a)continue;let w=y.tileID;for(;y&&y.tileID.overscaledZ>r+1;){const k=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[k.key],y&&y.hasData()&&(w=k)}let M=w;for(;M.overscaledZ>r;)if(M=M.scaledTo(M.overscaledZ-1),e[M.key]){h[w.key]=w;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=r?a:null}for(let a=e.overscaledZ-1;a>=r;a--){const h=e.scaledTo(a),m=this._getLoadedTile(h);if(m)return m}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const a=Math.ceil(e.width/r)+1,h=Math.ceil(e.height/r)+1,m=Math.floor(a*h*5),y=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,m):m,w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(w)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const a={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+r),a[m.tileID.key]=m}this._tiles=a;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,r,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let h;this.updateCacheSize(e,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new v(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(h=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(w=>this._source.hasTile(w)))):h=[];const m=this._updateRetainedTiles(h);if($1(this._source.type)&&h.length!==0){const w={},M={},k=Object.keys(m);for(const U of k){const G=m[U],X=this._tiles[U];if(!X||X.fadeEndTime&&X.fadeEndTime<=Uo.now())continue;const Y=this.findLoadedParent(G,Math.max(G.overscaledZ-yf.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),w[Y.tileID.key]=Y.tileID),M[U]=G}const B=h[h.length-1].overscaledZ;for(const U in this._tiles){const G=this._tiles[U];if(m[U]||!G.hasData())continue;let X=G.tileID;for(;X.overscaledZ>B;){X=X.scaledTo(X.overscaledZ-1);const Y=this._tiles[X.key];if(Y&&Y.hasData()&&M[X.key]){m[U]=G.tileID;break}}}for(const U in w)m[U]||(this._coveredTiles[U]=!0,m[U]=w[U])}for(const w in m)this._tiles[w].clearFadeHold();const y=function(w,M){const k=[];for(const B in w)B in M||k.push(B);return k}(this._tiles,m);for(const w of y){const M=this._tiles[w];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(e.length===0)return r;const a={},h=e.reduce((k,B)=>Math.min(k,B.overscaledZ),1/0),m=e[0].overscaledZ,y=Math.max(m-yf.maxOverzooming,this._source.minzoom),w=Math.max(m+yf.maxUnderzooming,this._source.minzoom),M={};for(const k of e){const B=this._addTile(k);r[k.key]=k,B.hasData()||h<this._source.maxzoom&&(M[k.key]=k)}this._retainLoadedChildren(M,h,w,r);for(const k of e){let B=this._tiles[k.key];if(B.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const G=k.children(this._source.maxzoom)[0],X=this.getTile(G);if(X&&X.hasData()){r[G.key]=G;continue}}else{const G=k.children(this._source.maxzoom);if(r[G[0].key]&&r[G[1].key]&&r[G[2].key]&&r[G[3].key])continue}let U=B.wasRequested();for(let G=k.overscaledZ-1;G>=y;--G){const X=k.scaledTo(G);if(a[X.key]||(a[X.key]=!0,B=this.getTile(X),!B&&U&&(B=this._addTile(X)),B&&(r[X.key]=X,U=B.wasRequested(),B.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let a,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){a=this._loadedParentTiles[h.key];break}r.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(a=this._getLoadedTile(m),a)break;h=m}for(const m of r)this._loadedParentTiles[m]=a}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const a=!!r;if(!a){const h=this.map?this.map.painter:null;r=new Nv(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,a||this._source.fire(new Vo("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=r.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,a){const h=[],m=this.transform;if(!m)return h;const y=m.projection.name==="globe",w=Ia(m.center.lng);for(const M in this._tiles){const k=this._tiles[M];if(a&&k.clearQueryDebugViz(),k.holdingForFade())continue;let B;if(y){const U=k.tileID.canonical;if(U.z===0){const G=[Math.abs(xi(w,...gg(U,-1))-w),Math.abs(xi(w,...gg(U,1))-w)];B=[0,2*G.indexOf(Math.min(...G))-1]}else{const G=[Math.abs(xi(w,...gg(U,-1))-w),Math.abs(xi(w,...gg(U,0))-w),Math.abs(xi(w,...gg(U,1))-w)];B=[G.indexOf(Math.min(...G))-1]}}else B=[0];for(const U of B){const G=e.containsTile(k,m,r,U);G&&h.push(G)}}return h}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of r)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if($1(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Uo.now())return!0}return!1}setFeatureState(e,r,a){this._state.updateState(e=e||"_geojsonTileLayer",r,a)}removeFeatureState(e,r,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,a)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,a){const h=this._tiles[e];h&&h.setDependencies(r,a)}reloadTilesForDependencies(e,r){for(const a in this._tiles)this._tiles[a].hasDependency(e,r)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(e,r))};return void this._source.on("data",w)}const a=new Map,h=Array.isArray(e)?e:[e],m=this.map.painter.terrain,y=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const w of h){const M=w.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of M)a.set(k.key,k);this.usedForTerrain&&w.updateElevation(!1)}nr(Array.from(a.values()),(w,M)=>{const k=new Nv(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,B=>{this._source.type==="raster-dem"&&k.dem&&this._backfillDEM(k),M(B,k)})},r)}}function j1(i,e){const r=Math.abs(2*i.wrap)-+(i.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||a-r||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function $1(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function gg(i,e){const r=1<<i.z;return[i.x/r+e,(i.x+1)/r+e]}yf.maxOverzooming=10,yf.maxUnderzooming=3;class wy{constructor(e,r,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=a}static create(e,r,a){const h=a||e.findDEMTileFor(r);if(!h||!h.dem)return;const m=h.dem,y=h.tileID,w=1<<r.canonical.z-y.canonical.z;return new wy(h,h.tileSize/Ai/w,[(r.canonical.x/w-y.canonical.x)*m.dim,(r.canonical.y/w-y.canonical.y)*m.dim])}tileCoordToPixel(e,r){const a=r*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),m=Math.floor(a);return new He(h,m)}getElevationAt(e,r,a,h){const m=e*this._scale+this._offset[0],y=r*this._scale+this._offset[1],w=Math.floor(m),M=Math.floor(y),k=this._dem;return h=!!h,a?pr(pr(k.get(w,M,h),k.get(w,M+1,h),y-M),pr(k.get(w+1,M,h),k.get(w+1,M+1,h),y-M),m-w):k.get(w,M,h)}getElevationAtPixel(e,r,a){return this._dem.get(e,r,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*ka(1,e)*this._dem.stride}}class G1{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new xl(Ai,16,0),this.featureIndexArray=new dc,this.promoteId=r}insert(e,r,a,h,m,y=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m,y);const M=this.grid;for(let k=0;k<r.length;k++){const B=r[k],U=[1/0,1/0,-1/0,-1/0];for(let G=0;G<B.length;G++){const X=B[G];U[0]=Math.min(U[0],X.x),U[1]=Math.min(U[1],X.y),U[2]=Math.max(U[2],X.x),U[3]=Math.max(U[3],X.y)}U[0]<Ai&&U[1]<Ai&&U[2]>=0&&U[3]>=0&&M.insert(w,U[0],U[1],U[2],U[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new og(new ay(this.rawTileData)).layers,this.sourceLayerCoder=new I1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,a,h){this.loadVTLayers();const m=e.params||{},y=ru(m.filter),w=e.tileResult,M=e.transform,k=w.bufferedTilespaceBounds,B=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Y,ie,de,Ee)=>ef(w.bufferedTilespaceGeometry,Y,ie,de,Ee));B.sort(iI);let U=null;M.elevation&&B.length>0&&(U=wy.create(M.elevation,this.tileID));const G={};let X;for(let Y=0;Y<B.length;Y++){const ie=B[Y];if(ie===X)continue;X=ie;const de=this.featureIndexArray.get(ie);let Ee=null;this.loadMatchingFeature(G,de,y,m.layers,m.availableImages,r,a,h,(Re,Se,De,Ve=0)=>(Ee||(Ee=Pa(Re,this.tileID.canonical,e.tileTransform)),Se.queryIntersectsFeature(w,Re,De,Ee,this.z,e.transform,e.pixelPosMatrix,U,Ve)))}return G}loadMatchingFeature(e,r,a,h,m,y,w,M,k){const{featureIndex:B,bucketIndex:U,sourceLayerIndex:G,layoutVertexArrayOffset:X}=r,Y=this.bucketLayerIDs[U];if(h&&!function(Re,Se){for(let De=0;De<Re.length;De++)if(Se.indexOf(Re[De])>=0)return!0;return!1}(h,Y))return;const ie=this.sourceLayerCoder.decode(G),de=this.vtLayers[ie].feature(B);if(a.needGeometry){const Re=uh(de,!0);if(!a.filter(new F(this.tileID.overscaledZ),Re,this.tileID.canonical))return}else if(!a.filter(new F(this.tileID.overscaledZ),de))return;const Ee=this.getId(de,ie);for(let Re=0;Re<Y.length;Re++){const Se=Y[Re];if(h&&h.indexOf(Se)<0)continue;const De=y[Se];if(!De)continue;let Ve={};Ee!==void 0&&M&&(Ve=M.getState(De.sourceLayer||"_geojsonTileLayer",Ee));const Be=dr({},w[Se]);Be.paint=W1(Be.paint,De.paint,de,Ve,m),Be.layout=W1(Be.layout,De.layout,de,Ve,m);const gt=!k||k(de,De,Ve,X);if(!gt)continue;const dt=new k1(de,this.z,this.x,this.y,Ee);dt.layer=Be;let At=e[Se];At===void 0&&(At=e[Se]=[]),At.push({featureIndex:B,feature:dt,intersectionZ:gt})}}lookupSymbolFeatures(e,r,a,h,m,y,w,M){const k={};this.loadVTLayers();const B=ru(m);for(const U of e)this.loadMatchingFeature(k,{bucketIndex:a,sourceLayerIndex:h,featureIndex:U,layoutVertexArrayOffset:0},B,y,w,M,r);return k}loadFeature(e){const{featureIndex:r,sourceLayerIndex:a}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(a),m=this.vtFeatures[h];if(m[r])return m[r];const y=this.vtLayers[h].feature(r);return m[r]=y,y}hasLayer(e){for(const r of this.bucketLayerIDs)for(const a of r)if(e===a)return!0;return!1}getId(e,r){let a=e.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];h!=null&&(a=e.properties[h]),typeof a=="boolean"&&(a=Number(a))}return a}}function W1(i,e,r,a,h){return Ei(i,(m,y)=>{const w=e instanceof be?e.get(y):null;return w&&w.evaluate?w.evaluate(r,a,h):w})}function iI(i,e){return e-i}_i(G1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class H1{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new Ml({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const a=this.getKey(e,r);return this.positions[a]}trim(){const e=this.width,r=this.height=fi(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,a){const h=[];let m=e.length%2==1?-e[e.length-1]*a:0,y=e[0]*a,w=!0;h.push({left:m,right:y,isDash:w,zeroLength:e[0]===0});let M=e[0];for(let k=1;k<e.length;k++){w=!w;const B=e[k];m=M*a,M+=B,y=M*a,h.push({left:m,right:y,isDash:w,zeroLength:B===0})}return h}addRoundDash(e,r,a){const h=r/2;for(let m=-a;m<=a;m++){const y=this.width*(this.nextRow+a+m);let w=0,M=e[w];for(let k=0;k<this.width;k++){k/M.right>1&&(M=e[++w]);const B=Math.abs(k-M.left),U=Math.abs(k-M.right),G=Math.min(B,U);let X;const Y=m/a*(h+1);if(M.isDash){const ie=h-Math.abs(Y);X=Math.sqrt(G*G+ie*ie)}else X=h-Math.sqrt(G*G+Y*Y);this.image.data[y+k]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(e,r){for(let M=e.length-1;M>=0;--M){const k=e[M],B=e[M+1];k.zeroLength?e.splice(M,1):B&&B.isDash===k.isDash&&(B.left=k.left,e.splice(M,1))}const a=e[0],h=e[e.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const m=this.width*this.nextRow;let y=0,w=e[y];for(let M=0;M<this.width;M++){M/w.right>1&&(w=e[++y]);const k=Math.abs(M-w.left),B=Math.abs(M-w.right),U=Math.min(k,B);this.image.data[m+M]=Math.max(0,Math.min(255,(w.isDash?U:-U)+r+128))}}addDash(e,r){const a=this.getKey(e,r);if(this.positions[a])return this.positions[a];const h=r==="round",m=h?7:0,y=2*m+1;if(this.nextRow+y>this.height)return Lt("LineAtlas out of space"),null;e.length===0&&e.push(1);let w=0;for(let B=0;B<e.length;B++)e[B]<0&&(Lt("Negative value is found in line dasharray, replacing values with 0"),e[B]=0),w+=e[B];if(w!==0){const B=this.width/w,U=this.getDashRanges(e,this.width,B);h?this.addRoundDash(U,B,m):this.addRegularDash(U,r==="square"?.5*B:0)}const M=this.nextRow+m;this.nextRow+=y;const k={tl:[M,m],br:[w,0]};return this.positions[a]=k,k}}_i(H1,"LineAtlas");const q1=1*Il;class X1{constructor(e){const r={},a=[];for(const w in e){const M=e[w],k=r[w]={};for(const B in M.glyphs){const U=M.glyphs[+B];if(!U||U.bitmap.width===0||U.bitmap.height===0)continue;const G=U.metrics.localGlyph?q1:1,X={x:0,y:0,w:U.bitmap.width+2*G,h:U.bitmap.height+2*G};a.push(X),k[B]=X}}const{w:h,h:m}=Av(a),y=new Ml({width:h||1,height:m||1});for(const w in e){const M=e[w];for(const k in M.glyphs){const B=M.glyphs[+k];if(!B||B.bitmap.width===0||B.bitmap.height===0)continue;const U=r[w][k],G=B.metrics.localGlyph?q1:1;Ml.copy(B.bitmap,y,{x:0,y:0},{x:U.x+G,y:U.y+G},B.bitmap)}}this.image=y,this.positions=r}}_i(X1,"GlyphAtlas");class rI{constructor(e){this.tileID=new v(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=_f(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,a,h,m){this.status="parsing",this.data=e,this.collisionBoxArray=new Ur;const y=new I1(Object.keys(e.layers).sort()),w=new G1(this.tileID,this.promoteId);w.bucketLayerIDs=[];const M={},k=new H1(256,256),B={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:a},U=r.familiesBySource[this.source];for(const Ve in U){const Be=e.layers[Ve];if(!Be)continue;let gt=!1,dt=!1;for(const yt of U[Ve])yt[0].type==="symbol"?gt=!0:dt=!0;if(this.isSymbolTile===!0&&!gt||this.isSymbolTile===!1&&!dt)continue;Be.version===1&&Lt(`Vector tile source "${this.source}" layer "${Ve}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const At=y.encode(Ve),qt=[];for(let yt=0;yt<Be.length;yt++){const Ot=Be.feature(yt),Rt=w.getId(Ot,Ve);qt.push({feature:Ot,id:Rt,index:yt,sourceLayerIndex:At})}for(const yt of U[Ve]){const Ot=yt[0];this.isSymbolTile!==void 0&&Ot.type==="symbol"!==this.isSymbolTile||Ot.minzoom&&this.zoom<Math.floor(Ot.minzoom)||Ot.maxzoom&&this.zoom>=Ot.maxzoom||Ot.visibility!=="none"&&(Gv(yt,this.zoom,a),(M[Ot.id]=Ot.createBucket({index:w.bucketLayerIDs.length,layers:yt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:At,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(qt,B,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(yt.map(Rt=>Rt.id)))}}let G,X,Y,ie;k.trim();const de={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ee=()=>{if(G)return m(G);if(X&&Y&&ie){const Ve=new X1(X),Be=new t1(Y,ie);for(const gt in M){const dt=M[gt];dt instanceof ku?(Gv(dt.layers,this.zoom,a),IM(dt,X,Ve.positions,Y,Be.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):dt.hasPattern&&(dt instanceof te||dt instanceof lf||dt instanceof df)&&(Gv(dt.layers,this.zoom,a),dt.addFeatures(B,this.tileID.canonical,Be.patternPositions,a,this.tileTransform))}this.status="done",m(null,{buckets:rn(M).filter(gt=>!gt.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ve.image,lineAtlas:k,imageAtlas:Be,glyphMap:this.returnDependencies?X:null,iconMap:this.returnDependencies?Y:null,glyphPositions:this.returnDependencies?Ve.positions:null})}},Re=Ei(B.glyphDependencies,Ve=>Object.keys(Ve).map(Number));Object.keys(Re).length?h.send("getGlyphs",{uid:this.uid,stacks:Re},(Ve,Be)=>{G||(G=Ve,X=Be,Ee())},void 0,!1,de):X={};const Se=Object.keys(B.iconDependencies);Se.length?h.send("getImages",{icons:Se,source:this.source,tileID:this.tileID,type:"icons"},(Ve,Be)=>{G||(G=Ve,Y=Be,Ee())},void 0,!1,de):Y={};const De=Object.keys(B.patternDependencies);De.length?h.send("getImages",{icons:De,source:this.source,tileID:this.tileID,type:"patterns"},(Ve,Be)=>{G||(G=Ve,ie=Be,Ee())},void 0,!1,de):ie={},Ee()}}function Gv(i,e,r){const a=new F(e);for(const h of i)h.recalculate(a,r)}class Z1{constructor(e){this.entries={},this.scheduler=e}request(e,r,a,h){const m=this.entries[e]=this.entries[e]||{callbacks:[]};if(m.result){const[y,w]=m.result;return this.scheduler?this.scheduler.add(()=>{h(y,w)},r):h(y,w),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=a((y,w)=>{m.result=[y,w];for(const M of m.callbacks)this.scheduler?this.scheduler.add(()=>{M(y,w)},r):M(y,w);setTimeout(()=>delete this.entries[e],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(y=>y!==h),m.callbacks.length||(m.cancel(),delete this.entries[e]))}}}function Y1(i,e,r){const a=JSON.stringify(i.request);return i.data&&(this.deduped.entries[a]={result:[null,i.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},h=>{const m=ss(i.request,(y,w,M,k)=>{y?h(y):w&&h(null,{vectorTile:r?void 0:new og(new ay(w)),rawData:w,cacheControl:M,expires:k})});return()=>{m.cancel(),h()}},e)}const K1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Wv{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,a]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=K1[15&a];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[w]=new Uint32Array(e,4,1);return new Wv(w,y,m,e)}constructor(e,r=64,a=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const m=K1.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,w=e*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-w%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+M,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+w+M),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+M,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=r,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Hv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:w}=this,M=[0,m.length-1,0],k=[];for(;M.length;){const B=M.pop()||0,U=M.pop()||0,G=M.pop()||0;if(U-G<=w){for(let de=G;de<=U;de++){const Ee=y[2*de],Re=y[2*de+1];Ee>=e&&Ee<=a&&Re>=r&&Re<=h&&k.push(m[de])}continue}const X=G+U>>1,Y=y[2*X],ie=y[2*X+1];Y>=e&&Y<=a&&ie>=r&&ie<=h&&k.push(m[X]),(B===0?e<=Y:r<=ie)&&(M.push(G),M.push(X-1),M.push(1-B)),(B===0?a>=Y:h>=ie)&&(M.push(X+1),M.push(U),M.push(1-B))}return k}within(e,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,w=[0,h.length-1,0],M=[],k=a*a;for(;w.length;){const B=w.pop()||0,U=w.pop()||0,G=w.pop()||0;if(U-G<=y){for(let de=G;de<=U;de++)Q1(m[2*de],m[2*de+1],e,r)<=k&&M.push(h[de]);continue}const X=G+U>>1,Y=m[2*X],ie=m[2*X+1];Q1(Y,ie,e,r)<=k&&M.push(h[X]),(B===0?e-a<=Y:r-a<=ie)&&(w.push(G),w.push(X-1),w.push(1-B)),(B===0?e+a>=Y:r+a>=ie)&&(w.push(X+1),w.push(U),w.push(1-B))}return M}}function Hv(i,e,r,a,h,m){if(h-a<=r)return;const y=a+h>>1;J1(i,e,y,a,h,m),Hv(i,e,r,a,y-1,1-m),Hv(i,e,r,y+1,h,1-m)}function J1(i,e,r,a,h,m){for(;h>a;){if(h-a>600){const k=h-a+1,B=r-a+1,U=Math.log(k),G=.5*Math.exp(2*U/3),X=.5*Math.sqrt(U*G*(k-G)/k)*(B-k/2<0?-1:1);J1(i,e,r,Math.max(a,Math.floor(r-B*G/k+X)),Math.min(h,Math.floor(r+(k-B)*G/k+X)),m)}const y=e[2*r+m];let w=a,M=h;for(_g(i,e,a,r),e[2*h+m]>y&&_g(i,e,a,h);w<M;){for(_g(i,e,w,M),w++,M--;e[2*w+m]<y;)w++;for(;e[2*M+m]>y;)M--}e[2*a+m]===y?_g(i,e,a,M):(M++,_g(i,e,M,h)),M<=r&&(a=M+1),r<=M&&(h=M-1)}}function _g(i,e,r,a){qv(i,r,a),qv(e,2*r,2*a),qv(e,2*r+1,2*a+1)}function qv(i,e,r){const a=i[e];i[e]=i[r],i[r]=a}function Q1(i,e,r,a){const h=i-r,m=e-a;return h*h+m*m}s.ARRAY_TYPE=no,s.AUTH_ERR_MSG=je,s.Aabb=ls,s.Actor=class{constructor(i,e,r){this.target=i,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},Ti(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ni()?i:$,this.scheduler=new YM}send(i,e,r,a,h=!1,m){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=m,this.callbacks[y]=r);const w=Qe(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:i,hasCallback:!!r,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:vl(e,w)},w),{cancel:()=>{r&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(i){const e=i.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const a=this.cancelCallbacks[r];delete this.cancelCallbacks[r],a&&a.cancel()}else if(e.mustQueue||ni()){const a=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),a&&a.metadata||{type:"message"})}else this.processTask(r,e)}processTask(i,e){if(e.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(e.error?r(qa(e.error)):r(null,qa(e.data)))}else{const r=Qe(this.globalScope)?void 0:[],a=e.hasCallback?(m,y)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:m?vl(m):null,data:vl(y,r)},r)}:m=>{},h=qa(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,a);else if(this.parent.getWorkerSource){const m=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,m[0],h.source)[m[1]](h,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=p,s.Color=Sn,s.ColorMode=Sc,s.CullFaceMode=kl,s.DEMData=by,s.DataConstantProperty=ee,s.DedupedRequest=Z1,s.DepthMode=Up,s.EXTENT=Ai,s.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(this.isUsingMockSource()||!e||i.y<0||i.y>1)return!1;const r=e.getSource().maxzoom,a=1<<r,h=Math.floor(i.x),m=Math.floor((i.x-h)*a),y=Math.floor(i.y*a),w=this.findDEMTileFor(new v(r,h,r,m,y));return!(!w||!w.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,r=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const a=this._source();if(!a||i.y<0||i.y>1)return e;const h=a.getSource().maxzoom,m=1<<h,y=Math.floor(i.x),w=i.x-y,M=new v(h,y,h,Math.floor(w*m),Math.floor(i.y*m)),k=this.findDEMTileFor(M);if(!k||!k.dem)return e;const B=k.dem,U=1<<k.tileID.canonical.z,G=(w*U-k.tileID.canonical.x)*B.dim,X=(i.y*U-k.tileID.canonical.y)*B.dim,Y=Math.floor(G),ie=Math.floor(X);return(r?this.exaggeration():1)*pr(pr(B.get(Y,ie),B.get(Y,ie+1),X-ie),pr(B.get(Y+1,ie),B.get(Y+1,ie+1),X-ie),G-Y)}getAtTileOffset(i,e,r){const a=1<<i.canonical.z;return this.getAtPointOrZero(new yu(i.wrap+(i.canonical.x+e/Ai)/a,(i.canonical.y+r/Ai)/a))}getAtTileOffsetFunc(i,e,r,a){return h=>{const m=this.getAtTileOffset(i,h.x,h.y),y=a.upVector(i.canonical,h.x,h.y);return so(y,y,m*a.upVectorScale(i.canonical,e,r).metersToTile),y}}getForTilePoints(i,e,r,a){if(this.isUsingMockSource())return!1;const h=wy.create(this,i,a);return!!h&&(e.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],r)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const r=e.dem.tree,a=e.tileID,h=1<<i.canonical.z-a.canonical.z;let m=i.canonical.x/h-a.canonical.x,y=i.canonical.y/h-a.canonical.y,w=0;for(let M=0;M<i.canonical.z-a.canonical.z&&!r.leaves[w];M++){m*=2,y*=2;const k=2*Math.floor(y)+Math.floor(m);w=r.childOffsets[w]+k,m%=1,y%=1}return{min:this.exaggeration()*r.minimums[w],max:this.exaggeration()*r.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=da,s.EvaluationParameters=F,s.Event=Vo,s.Evented=Vr,s.FillExtrusionBucket=df,s.Frustum=Ya,s.FrustumCorners=Nm,s.GLOBE_RADIUS=Ka,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=gp,s.GLOBE_ZOOM_THRESHOLD_MIN=Gd,s.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,e){const r=new Nt,a=new Ci,h=[],m=i+1+2,y=e[0]+1,w=e[0]+1+(1+e.length),M=(k,B,U)=>{let G=k===m-1?k-2:k===0?k:k-1;return G+=U?24575:0,[G,B]};for(let k=0;k<m;++k)r.emplaceBack(...M(k,0,!0));for(let k=0;k<y;++k)for(let B=0;B<m;++B)r.emplaceBack(...M(B,k,(B===0||B===m-1)&&!0));for(let k=0;k<e.length;++k){const B=e[k];for(let U=0;U<m;++U)r.emplaceBack(...M(U,B,!0))}for(let k=0;k<e.length;++k){const B=a.length,U=e[k]+1+2,G=new Ci;for(let ie=0;ie<U-1;ie++){const de=ie===U-2,Ee=de?m*(w-e.length+k-ie):m;for(let Re=0;Re<m-1;Re++){const Se=ie*m+Re;ie===0||de||Re===0||Re===m-2?(G.emplaceBack(Se+1,Se,Se+Ee),G.emplaceBack(Se+Ee,Se+Ee+1,Se+1)):(a.emplaceBack(Se+1,Se,Se+Ee),a.emplaceBack(Se+Ee,Se+Ee+1,Se+1))}}const X=An.simpleSegment(0,B,r.length,a.length-B);for(let ie=0;ie<G.uint16.length;ie+=3)a.emplaceBack(G.uint16[ie],G.uint16[ie+1],G.uint16[ie+2]);const Y=An.simpleSegment(0,B,r.length,a.length-B);h.push({withoutSkirts:X,withSkirts:Y})}return{vertices:r,indices:a,segments:h}}_createGrid(i){const e=this._fillGridMeshWithLods(_c,Wd);this._gridSegments=e.segments,this._gridBuffer=i.createVertexBuffer(e.vertices,Jo.members),this._gridIndexBuffer=i.createIndexBuffer(e.indices,!0)}_createPoles(i){const e=new Ci;for(let h=0;h<=_c;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const r=new Or,a=new Or;this._poleSegments=[];for(let h=0,m=0;h<Gd;h++){const y=360/(1<<h);r.emplaceBack(0,-Ka,0,.5,0),a.emplaceBack(0,-Ka,0,.5,1);for(let w=0;w<=_c;w++){const M=w/_c,k=pr(0,y,M),[B,U,G]=ch(ev,tv,k,Ka);r.emplaceBack(B,U,G,M,0),a.emplaceBack(B,U,G,M,1)}this._poleSegments.push(An.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(r,C_,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(a,C_,!1)}getGridBuffers(i,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,e){if(!this._wireframeSegments){const r=new is,a=_c,h=a+1+2,m=1;this._wireframeSegments=[];for(let y=0,w=0;y<Wd.length;y++){const M=Wd[y];for(let B=m;B<M+m;B++)for(let U=m;U<a+m;U++){const G=B*h+U;r.emplaceBack(G,G+1),r.emplaceBack(G,G+h),r.emplaceBack(G,G+h+1)}const k=M*a*3;this._wireframeSegments.push(An.simpleSegment(0,w,(M+1)*h,k)),w+=k}this._wireframeIndexBuffer=i.createIndexBuffer(r)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=zp,s.ImagePosition=Mv,s.KDBush=Wv,s.LivePerformanceUtils=Bf,s.LngLat=Rr,s.LngLatBounds=as,s.LocalGlyphMode=Pv,s.MAX_MERCATOR_LATITUDE=ko,s.MercatorCoordinate=yu,s.ONE_EM=Ft,s.OverscaledTileID=v,s.PerformanceMarkers=En,s.Point=He,s.Properties=ke,s.RGBAImage=ao,s.Ray=Fm,s.RequestManager=class{constructor(i,e,r){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ae,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!qe(i))return i;const r=ii(i);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!qe(i))return i;const r=ii(i);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(i,e,r,a){if(!qe(i))return i;const h=ii(i);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),r&&h.params.push(`language=${r}`),a&&h.params.push(`worldview=${a}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(i,e,r,a){const h=ii(i);return qe(i)?(h.path=`/styles/v1${h.path}/sprite${e}${r}`,this._makeAPIURL(h,this._customAccessToken||a)):(h.path+=`${e}${r}`,Wt(h))}normalizeTileURL(i,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!qe(i))return i;const a=ii(i);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&a.authority!=="raster"&&r===512?"@2x":""}${ue.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${ne.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${ne.TILE_URL_VERSION}${a.path}`);const h=this._customAccessToken||function(m){for(const y of m){const w=y.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(a.params)||ne.ACCESS_TOKEN;return ne.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,h)}canonicalizeTileURL(i,e){const r=ii(i);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return i;let a="mapbox://";r.path.match(/^\/raster\/v1\//)?a+=`raster/${r.path.replace(`/${ne.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${r.path.replace(`/${ne.TILE_URL_VERSION}/`,"")}`;let h=r.params;return e&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(a+=`?${h.join("&")}`),a}canonicalizeTileset(i,e){const r=!!e&&qe(e),a=[];for(const h of i.tiles||[])ct(h)?a.push(this.canonicalizeTileURL(h,r)):a.push(h);return a}_makeAPIURL(i,e){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=ii(ne.API_URL);if(i.protocol=a.protocol,i.authority=a.authority,i.protocol==="http"){const h=i.params.indexOf("secure");h>=0&&i.params.splice(h,1)}if(a.path!=="/"&&(i.path=`${a.path}${i.path}`),!ne.REQUIRE_ACCESS_TOKEN)return Wt(i);if(e=e||ne.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return i.params=i.params.filter(h=>h.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),Wt(i)}},s.ResourceType=hs,s.SegmentVector=An,s.SourceCache=yf,s.StencilMode=Vv,s.StructArrayLayout1ui2=ro,s.StructArrayLayout2f1f2i16=Pi,s.StructArrayLayout2i4=Nt,s.StructArrayLayout2ui4=is,s.StructArrayLayout3f12=Wi,s.StructArrayLayout3ui6=Ci,s.StructArrayLayout4i8=Mt,s.StructArrayLayout5f20=Or,s.Texture=mg,s.Tile=Nv,s.Transitionable=Q,s.Uniform1f=Gn,s.Uniform1i=class extends Xa{constructor(i){super(i),this.current=0}set(i,e,r){this.fetchUniformLocation(i,e)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},s.Uniform2f=class extends Xa{constructor(i){super(i),this.current=[0,0]}set(i,e,r){this.fetchUniformLocation(i,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}},s.Uniform3f=class extends Xa{constructor(i){super(i),this.current=[0,0,0]}set(i,e,r){this.fetchUniformLocation(i,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}},s.Uniform4f=y_,s.UniformColor=du,s.UniformMatrix2f=class extends Xa{constructor(i){super(i),this.current=Hx}set(i,e,r){if(this.fetchUniformLocation(i,e)){for(let a=0;a<4;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}}},s.UniformMatrix3f=class extends Xa{constructor(i){super(i),this.current=Cn}set(i,e,r){if(this.fetchUniformLocation(i,e)){for(let a=0;a<9;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}}},s.UniformMatrix4f=class extends Xa{constructor(i){super(i),this.current=Rm}set(i,e,r){if(this.fetchUniformLocation(i,e)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let a=1;a<16;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}},s.UnwrappedTileID=x,s.ValidationError=ui,s.VectorTileFeature=cf,s.VectorTileWorkerSource=class extends Vr{constructor(i,e,r,a,h){super(),this.actor=i,this.layerIndex=e,this.availableImages=r,this.loadVectorData=h||Y1,this.loading={},this.loaded={},this.deduped=new Z1(i.scheduler),this.isSpriteLoaded=a,this.scheduler=i.scheduler}loadTile(i,e){const r=i.uid,a=i&&i.request,h=a&&a.collectResourceTiming,m=this.loading[r]=new rI(i);m.abort=this.loadVectorData(i,(y,w)=>{const M=!this.loading[r];if(delete this.loading[r],M||y||!w)return m.status="done",M||(this.loaded[r]=m),e(y);const k=w.rawData,B={};w.expires&&(B.expires=w.expires),w.cacheControl&&(B.cacheControl=w.cacheControl),m.vectorTile=w.vectorTile||new og(new ay(k));const U=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(G,X)=>{if(G||!X)return e(G);const Y={};if(h){const ie=td(a);ie.length>0&&(Y.resourceTiming=JSON.parse(JSON.stringify(ie)))}e(null,dr({rawTileData:k.slice(0)},X,B,Y))})};this.isSpriteLoaded?U():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(U,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):U()}),this.loaded=this.loaded||{},this.loaded[r]=m})}reloadTile(i,e){const r=this.loaded,a=i.uid,h=this;if(r&&r[a]){const m=r[a];m.showCollisionBoxes=i.showCollisionBoxes,m.enableTerrain=!!i.enableTerrain,m.projection=i.projection,m.tileTransform=_f(i.tileID.canonical,i.projection);const y=(w,M)=>{const k=m.reloadCallback;k&&(delete m.reloadCallback,m.parse(m.vectorTile,h.layerIndex,this.availableImages,h.actor,k)),e(w,M)};m.status==="parsing"?m.reloadCallback=y:m.status==="done"&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(i,e){const r=i.uid,a=this.loading[r];a&&(a.abort&&a.abort(),delete this.loading[r]),e()}removeTile(i,e){const r=this.loaded,a=i.uid;r&&r[a]&&delete r[a],e()}},s.WritingMode=Da,s.ZoomDependentExpression=_l,s.add=Aa,s.addDynamicAttributes=yy,s.adjoint=function(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=e[4],w=e[5],M=e[6],k=e[7],B=e[8];return i[0]=y*B-w*k,i[1]=h*k-a*B,i[2]=a*w-h*y,i[3]=w*M-m*B,i[4]=r*B-h*M,i[5]=h*m-r*w,i[6]=m*k-y*M,i[7]=a*M-r*k,i[8]=r*y-a*m,i},s.asyncAll=nr,s.bezier=ai,s.bindAll=Ti,s.boundsAttributes=L1,s.bufferConvexPolygon=function(i,e){const r=[];for(let a=0;a<i.length;a++){const h=tr(a-1,-1,i.length-1),m=tr(a+1,-1,i.length-1),y=i[a],w=i[m],M=i[h].sub(y).unit(),k=w.sub(y).unit(),B=k.angleWithSep(M.x,M.y),U=M.add(k).unit().mult(-1*e/Math.sin(B/2));r.push(y.add(U))}return r},s.cacheEntryPossiblyAdded=function(i){lr++,lr>Pt&&(i.getActor().send("enforceCacheSizeLimit",ut),lr=0)},s.calculateGlobeLabelMatrix=function(i,e){const{x:r,y:a}=i.point,h=L_(r,a,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Cl(h,h,Vm(Qo(e)))},s.calculateGlobeMatrix=function(i){const{x:e,y:r}=i.point,{lng:a,lat:h}=i._center;return L_(e,r,i.worldSize,a,h)},s.calculateGlobeMercatorMatrix=function(i){const e=i.pixelsPerMeter,r=e/ka(1,i.center.lat),a=Co(new Float64Array(16));return Fd(a,a,[i.point.x,i.point.y,0]),Al(a,a,[r,r,e]),Float32Array.from(a)},s.circumferenceAtLatitude=$m,s.clamp=xi,s.clearTileCache=function(i){if(!$r())return;const e=$.caches.delete(Zt);i&&e.catch(i).then(()=>i())},s.clipLine=p1,s.clone=function(i){var e=new no(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},s.clone$1=ve,s.collisionCircleLayout=ei,s.config=ne,s.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},s.create=function(){var i=new no(16);return no!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},s.create$1=v_,s.createExpression=oc,s.createLayout=et,s.createStyleLayer=function(i){return i.type==="custom"?new HM(i):new XM[i.type](i)},s.cross=Za,s.degToRad=wt,s.distance=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},s.div=function(i,e,r){return i[0]=e[0]/r[0],i[1]=e[1]/r[1],i[2]=e[2]/r[2],i},s.dot=oo,s.earthRadius=Zd,s.ease=yi,s.easeCubicInOut=vt,s.ecefToLatLng=function([i,e,r]){const a=Math.hypot(i,e,r),h=Math.atan2(i,r),m=.5*Math.PI-Math.acos(-e/a);return new Rr(xt(h),xt(m))},s.emitValidationErrors=tp,s.endsWith=sr,s.enforceCacheSizeLimit=function(i){Nr(),Mi&&Mi.then(e=>{e.keys().then(r=>{for(let a=0;a<r.length-i;a++)e.delete(r[a])})})},s.evaluateSizeForFeature=Ni,s.evaluateSizeForZoom=bi,s.evaluateVariableOffset=x1,s.evented=b,s.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},s.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},s.exported=Uo,s.exported$1=ue,s.extend=dr,s.extend$1=jo,s.fillExtrusionHeightLift=oy,s.filterObject=xe,s.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},s.fromQuat=function(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=r+r,w=a+a,M=h+h,k=r*y,B=a*y,U=a*w,G=h*y,X=h*w,Y=h*M,ie=m*y,de=m*w,Ee=m*M;return i[0]=1-U-Y,i[1]=B+Ee,i[2]=G-de,i[3]=0,i[4]=B-Ee,i[5]=1-k-Y,i[6]=X+ie,i[7]=0,i[8]=G+de,i[9]=X-ie,i[10]=1-k-U,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},s.fromRotation=function(i,e){var r=Math.sin(e),a=Math.cos(e);return i[0]=a,i[1]=r,i[2]=0,i[3]=-r,i[4]=a,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},s.fromScaling=zm,s.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Tt[e]},s.getAABBPointSquareDist=function(i,e,r){let a=0;for(let h=0;h<2;++h){const m=r?r[h]:0;i[h]>m&&(a+=(i[h]-m)*(i[h]-m)),e[h]<m&&(a+=(m-e[h])*(m-e[h]))}return a},s.getAnchorAlignment=kv,s.getAnchorJustification=Dv,s.getBounds=function(i){let e=1/0,r=1/0,a=-1/0,h=-1/0;for(const m of i)e=Math.min(e,m.x),r=Math.min(r,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{min:new He(e,r),max:new He(a,h)}},s.getColumn=Gt,s.getDefaultExportFromCjs=ge,s.getGridMatrix=function(i,e,r,a){const h=e.getNorth(),m=e.getSouth(),y=e.getWest(),w=e.getEast(),M=1<<i.z,k=w-y,B=h-m,U=k/_c,G=-B/Wd[r],X=[0,U,0,G,0,0,h,y,0];if(i.z>0){const Y=180/a;b_(X,X,[Y/k+1,0,0,0,Y/B+1,0,-.5*Y/U,.5*Y/G,1])}return X[2]=M,X[5]=i.x,X[8]=i.y,X},s.getImage=Pe,s.getJSON=function(i,e){return Kn(dr(i,{type:"json"}),e)},s.getLatitudinalLod=function(i){const e=ko-5;i=xi(i,-80.051129,e)/e*90;const r=Math.pow(Math.abs(Math.sin(wt(i))),3);return Math.round(r*(Wd.length-1))},s.getMapSessionAPI=$n,s.getPerformanceMeasurement=td,s.getProjection=A1,s.getRTLTextPluginStatus=E,s.getReferrer=zn,s.getTilePoint=function(i,{x:e,y:r},a=0){return new He(((e-a)*i.scale-i.x)*Ai,(r*i.scale-i.y)*Ai)},s.getTileVec3=function(i,e,r=0){return gc(((e.x-r)*i.scale-i.x)*Ai,(e.y*i.scale-i.y)*Ai,Yd(e.z,e.y))},s.getVideo=function(i,e){const r=$.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let a=0;a<i.length;a++){const h=$.document.createElement("source");$l(i[a])||(r.crossOrigin="Anonymous"),h.src=i[a],r.appendChild(h)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(i){const e=[0,0,0],r=Co(new Float64Array(16));return Cl(r,i.pixelMatrix,i.globeMatrix),pn(e,e,r),new He(e[0],e[1])},s.globeDenormalizeECEF=Vm,s.globeECEFOrigin=function(i,e){const r=[0,0,0];return pn(r,r,hh(Qo(e.canonical))),pn(r,r,i),r},s.globeMetersToEcef=_p,s.globeNormalizeECEF=hh,s.globePixelsToTileUnits=function(i,e){return Ai/(512*Math.pow(2,i))*gu(Qo(e))},s.globePoleMatrixForTile=function(i,e,r){const a=Co(new Float64Array(16)),h=(e/(1<<i)-.5)*Math.PI*2;return hp(a,r.globeMatrix,h),Float32Array.from(a)},s.globeTileBounds=Qo,s.globeTiltAtLngLat=D_,s.globeToMercatorTransition=_u,s.globeUseCustomAntiAliasing=function(i,e,r){const a=_u(r.zoom),h=i.style.map._antialias,m=!!e.extStandardDerivatives,y=e.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return a===0&&!h&&!y&&m},s.identity=Co,s.identity$1=ys,s.invert=cp,s.isFullscreen=function(){return!!$.document.fullscreenElement||!!$.document.webkitFullscreenElement},s.isLngLatBehindGlobe=jm,s.isMapAuthenticated=function(i){return us.has(i)},s.isMapboxURL=qe,s.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!Qe(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=xs,s.latLngToECEF=mu,s.len=pu,s.length=fu,s.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},s.lngFromMercatorX=Io,s.loadVectorTile=Y1,s.makeRequest=Kn,s.mapValue=function(i,e,r,a,h){return xi((i-e)/(r-e)*(h-a)+a,a,h)},s.mercatorScale=Gm,s.mercatorXfromLng=Ia,s.mercatorYfromLat=ea,s.mercatorZfromAltitude=ka,s.mul=Ud,s.mul$1=Kx,s.multiply=Cl,s.multiply$1=b_,s.multiply$2=fp,s.nextPowerOfTwo=fi,s.normalize=zs,s.normalize$1=S_,s.normalize$2=$d,s.number=pr,s.ortho=function(i,e,r,a,h,m,y){var w=1/(e-r),M=1/(a-h),k=1/(m-y);return i[0]=-2*w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*M,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(e+r)*w,i[13]=(h+a)*M,i[14]=(y+m)*k,i[15]=1,i},s.pbf=_r,s.perspective=function(i,e,r,a,h){var m,y=1/Math.tan(e/2);return i[0]=y/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+a)*(m=1/(a-h)),i[14]=2*h*a*m):(i[10]=-1,i[14]=-2*a),i},s.pick=function(i,e){const r={};for(let a=0;a<e.length;a++){const h=e[a];h in i&&(r[h]=i[h])}return r},s.plugin=D,s.pointGeometry=Ie,s.polesInViewport=function(i){const e=Co(new Float64Array(16));Cl(e,i.pixelMatrix,i.globeMatrix);const r=[0,Mo,0],a=[0,Fs,0];return pn(r,r,e),pn(a,a,e),[r[0]>0&&r[0]<=i.width&&r[1]>0&&r[1]<=i.height&&!jm(i,new Rr(i.center.lat,90)),a[0]>0&&a[0]<=i.width&&a[1]>0&&a[1]<=i.height&&!jm(i,new Rr(i.center.lat,-90))]},s.polygonContainsPoint=Ja,s.polygonIntersectsBox=ef,s.polygonIntersectsPolygon=Jd,s.polygonizeBounds=function(i,e,r=0,a=!0){const h=new He(r,r),m=i.sub(h),y=e.add(h),w=[m,new He(y.x,m.y),y,new He(m.x,y.y)];return a&&w.push(m.clone()),w},s.posAttributes=Jo,s.postMapLoadEvent=_n,s.postPerformanceEvent=jn,s.postTurnstileEvent=ur,s.potpack=Av,s.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},s.radToDeg=xt,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(i){return i({pluginStatus:f,pluginURL:n}),b.on("pluginStateChange",i),i},s.removeAuthState=function(i){us.delete(i)},s.renderColorRamp=Xm,s.resample=yp,s.rotateX=Nd,s.rotateX$1=E_,s.rotateY=hp,s.rotateY$1=Bm,s.rotateZ=function(i,e,r){var a=Math.sin(r),h=Math.cos(r),m=e[0],y=e[1],w=e[2],M=e[3],k=e[4],B=e[5],U=e[6],G=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*h+k*a,i[1]=y*h+B*a,i[2]=w*h+U*a,i[3]=M*h+G*a,i[4]=k*h-m*a,i[5]=B*h-y*a,i[6]=U*h-w*a,i[7]=G*h-M*a,i},s.rotateZ$1=function(i,e,r){r*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(r),M=Math.cos(r);return i[0]=a*M+h*w,i[1]=h*M-a*w,i[2]=m*M+y*w,i[3]=y*M-m*w,i},s.scale=Al,s.scale$1=T_,s.scale$2=so,s.scaleAndAdd=Vd,s.set=function(i,e,r,a){return i[0]=e,i[1]=r,i[2]=a,i},s.setCacheLimits=function(i,e){ut=i,Pt=e},s.setColumn=function(i,e,r){i[4*e+0]=r[0],i[4*e+1]=r[1],i[4*e+2]=r[2],i[4*e+3]=r[3]},s.setRTLTextPlugin=function(i,e,r=!1){if(f===oh||f===cu||f===Od)throw new Error("setRTLTextPlugin cannot be called multiple times.");n=Uo.resolveURL(i),f=oh,uc=e,g(),r||L()},s.smoothstep=Pr,s.spec=Et,s.squaredLength=function(i){var e=i[0],r=i[1],a=i[2];return e*e+r*r+a*a},s.storeAuthState=function(i,e){e?us.add(i):us.delete(i)},s.sub=Ao,s.subtract=dp,s.symbolSize=Vi,s.tileAABB=function(i,e,r,a,h,m,y,w,M){if(M.name==="globe")return Qx(i,e,new p(r,a,h));const k=_f({z:r,x:a,y:h},M);return new ls([(m+k.x/k.scale)*e,e*(k.y/k.scale),y],[(m+k.x2/k.scale)*e,e*(k.y2/k.scale),w])},s.tileCornersToBounds=qd,s.tileTransform=_f,s.transformMat3=function(i,e,r){var a=e[0],h=e[1],m=e[2];return i[0]=a*r[0]+h*r[3]+m*r[6],i[1]=a*r[1]+h*r[4]+m*r[7],i[2]=a*r[2]+h*r[5]+m*r[8],i},s.transformMat4=pn,s.transformMat4$1=Bs,s.transformQuat=Tr,s.transitionTileAABBinECEF=Um,s.translate=Fd,s.transpose=function(i,e){if(i===e){var r=e[1],a=e[2],h=e[5];i[1]=e[3],i[2]=e[6],i[3]=r,i[5]=e[7],i[6]=a,i[7]=h}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},s.triggerPluginCompletionEvent=c,s.uniqueId=nn,s.updateGlobeVertexNormal=function(i,e,r,a,h){const m=5*e+2;i.float32[m+0]=r,i.float32[m+1]=a,i.float32[m+2]=h},s.validateCustomStyleLayer=function(i){const e=[],r=i.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=i=>io(rh(i)),s.validateFog=i=>io(Qf(i)),s.validateLayer=i=>io(Kf(i)),s.validateLight=i=>io(Jf(i)),s.validateSource=i=>io(Cd(i)),s.validateStyle=sh,s.validateTerrain=i=>io(Ad(i)),s.values=rn,s.vectorTile=Dp,s.version=Z,s.warnOnce=Lt,s.window=$,s.wrap=tr}),P(["./shared"],function(s){function $(Le){if(typeof Le=="number"||typeof Le=="boolean"||typeof Le=="string"||Le==null)return JSON.stringify(Le);if(Array.isArray(Le)){let le="[";for(const Pe of Le)le+=`${$(Pe)},`;return`${le}]`}let oe="{";for(const le of Object.keys(Le).sort())oe+=`${le}:${$(Le[le])},`;return`${oe}}`}function Z(Le){let oe="";for(const le of s.refProperties)oe+=`/${$(Le[le])}`;return oe}class J{constructor(oe){this.keyCache={},oe&&this.replace(oe)}replace(oe){this._layerConfigs={},this._layers={},this.update(oe,[])}update(oe,le){for(const je of oe)this._layerConfigs[je.id]=je,(this._layers[je.id]=s.createStyleLayer(je)).compileFilter(),this.keyCache[je.id]&&delete this.keyCache[je.id];for(const je of le)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const Pe=function(je,qe){const ct={};for(let Ke=0;Ke<je.length;Ke++){const st=qe&&qe[je[Ke].id]||Z(je[Ke]);qe&&(qe[je[Ke].id]=st);let Kt=ct[st];Kt||(Kt=ct[st]=[]),Kt.push(je[Ke])}const at=[];for(const Ke in ct)at.push(ct[Ke]);return at}(s.values(this._layerConfigs),this.keyCache);for(const je of Pe){const qe=je.map(ii=>this._layers[ii.id]),ct=qe[0];if(ct.visibility==="none")continue;const at=ct.source||"";let Ke=this.familiesBySource[at];Ke||(Ke=this.familiesBySource[at]={});const st=ct.sourceLayer||"_geojsonTileLayer";let Kt=Ke[st];Kt||(Kt=Ke[st]=[]),Kt.push(qe)}}}class ne{loadTile(oe,le){const{uid:Pe,encoding:je,rawImageData:qe,padding:ct,buildQuadTree:at}=oe,Ke=s.window.ImageBitmap&&qe instanceof s.window.ImageBitmap?this.getImageData(qe,ct):qe;le(null,new s.DEMData(Pe,Ke,je,ct<1,at))}getImageData(oe,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(oe.width,oe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=oe.width,this.offscreenCanvas.height=oe.height,this.offscreenCanvasContext.drawImage(oe,0,0,oe.width,oe.height);const Pe=this.offscreenCanvasContext.getImageData(-le,-le,oe.width+2*le,oe.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Pe}}function ue(Le,oe){if(Le.length!==0){we(Le[0],oe);for(var le=1;le<Le.length;le++)we(Le[le],!oe)}}function we(Le,oe){for(var le=0,Pe=0,je=0,qe=Le.length,ct=qe-1;je<qe;ct=je++){var at=(Le[je][0]-Le[ct][0])*(Le[ct][1]+Le[je][1]),Ke=le+at;Pe+=Math.abs(le)>=Math.abs(at)?le-Ke+at:at-Ke+le,le=Ke}le+Pe>=0!=!!oe&&Le.reverse()}var Me=s.getDefaultExportFromCjs(function Le(oe,le){var Pe,je=oe&&oe.type;if(je==="FeatureCollection")for(Pe=0;Pe<oe.features.length;Pe++)Le(oe.features[Pe],le);else if(je==="GeometryCollection")for(Pe=0;Pe<oe.geometries.length;Pe++)Le(oe.geometries[Pe],le);else if(je==="Feature")Le(oe.geometry,le);else if(je==="Polygon")ue(oe.coordinates,le);else if(je==="MultiPolygon")for(Pe=0;Pe<oe.coordinates.length;Pe++)ue(oe.coordinates[Pe],le);return oe});const Ye=s.VectorTileFeature.prototype.toGeoJSON;var Ze={exports:{}},Fe=s.pointGeometry,ae=s.vectorTile.VectorTileFeature,ge=Oe;function Oe(Le,oe){this.options=oe||{},this.features=Le,this.length=Le.length}function ze(Le,oe){this.id=typeof Le.id=="number"?Le.id:void 0,this.type=Le.type,this.rawGeometry=Le.type===1?[Le.geometry]:Le.geometry,this.properties=Le.tags,this.extent=oe||4096}Oe.prototype.feature=function(Le){return new ze(this.features[Le],this.options.extent)},ze.prototype.loadGeometry=function(){var Le=this.rawGeometry;this.geometry=[];for(var oe=0;oe<Le.length;oe++){for(var le=Le[oe],Pe=[],je=0;je<le.length;je++)Pe.push(new Fe(le[je][0],le[je][1]));this.geometry.push(Pe)}return this.geometry},ze.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Le=this.geometry,oe=1/0,le=-1/0,Pe=1/0,je=-1/0,qe=0;qe<Le.length;qe++)for(var ct=Le[qe],at=0;at<ct.length;at++){var Ke=ct[at];oe=Math.min(oe,Ke.x),le=Math.max(le,Ke.x),Pe=Math.min(Pe,Ke.y),je=Math.max(je,Ke.y)}return[oe,Pe,le,je]},ze.prototype.toGeoJSON=ae.prototype.toGeoJSON;var rt=s.pbf,Ie=ge;function Je(Le){var oe=new rt;return function(le,Pe){for(var je in le.layers)Pe.writeMessage(3,He,le.layers[je])}(Le,oe),oe.finish()}function He(Le,oe){var le;oe.writeVarintField(15,Le.version||1),oe.writeStringField(1,Le.name||""),oe.writeVarintField(5,Le.extent||4096);var Pe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<Le.length;le++)Pe.feature=Le.feature(le),oe.writeMessage(2,ti,Pe);var je=Pe.keys;for(le=0;le<je.length;le++)oe.writeStringField(3,je[le]);var qe=Pe.values;for(le=0;le<qe.length;le++)oe.writeMessage(4,vt,qe[le])}function ti(Le,oe){var le=Le.feature;le.id!==void 0&&oe.writeVarintField(1,le.id),oe.writeMessage(2,bt,Le),oe.writeVarintField(3,le.type),oe.writeMessage(4,Tt,le)}function bt(Le,oe){var le=Le.feature,Pe=Le.keys,je=Le.values,qe=Le.keycache,ct=Le.valuecache;for(var at in le.properties){var Ke=le.properties[at],st=qe[at];if(Ke!==null){st===void 0&&(Pe.push(at),qe[at]=st=Pe.length-1),oe.writeVarint(st);var Kt=typeof Ke;Kt!=="string"&&Kt!=="boolean"&&Kt!=="number"&&(Ke=JSON.stringify(Ke));var ii=Kt+":"+Ke,Wt=ct[ii];Wt===void 0&&(je.push(Ke),ct[ii]=Wt=je.length-1),oe.writeVarint(Wt)}}}function wt(Le,oe){return(oe<<3)+(7&Le)}function xt(Le){return Le<<1^Le>>31}function Tt(Le,oe){for(var le=Le.loadGeometry(),Pe=Le.type,je=0,qe=0,ct=le.length,at=0;at<ct;at++){var Ke=le[at],st=1;Pe===1&&(st=Ke.length),oe.writeVarint(wt(1,st));for(var Kt=Pe===3?Ke.length-1:Ke.length,ii=0;ii<Kt;ii++){ii===1&&Pe!==1&&oe.writeVarint(wt(2,Kt-1));var Wt=Ke[ii].x-je,ji=Ke[ii].y-qe;oe.writeVarint(xt(Wt)),oe.writeVarint(xt(ji)),je+=Wt,qe+=ji}Pe===3&&oe.writeVarint(wt(7,1))}}function vt(Le,oe){var le=typeof Le;le==="string"?oe.writeStringField(1,Le):le==="boolean"?oe.writeBooleanField(7,Le):le==="number"&&(Le%1!=0?oe.writeDoubleField(3,Le):Le<0?oe.writeSVarintField(6,Le):oe.writeVarintField(5,Le))}Ze.exports=Je,Ze.exports.fromVectorTileJs=Je,Ze.exports.fromGeojsonVt=function(Le,oe){oe=oe||{};var le={};for(var Pe in Le)le[Pe]=new Ie(Le[Pe].features,oe),le[Pe].name=Pe,le[Pe].version=oe.version,le[Pe].extent=oe.extent;return Je({layers:le})},Ze.exports.GeoJSONWrapper=Ie;var ai=s.getDefaultExportFromCjs(Ze.exports);const yi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Le=>Le},xi=Math.fround||(Pr=new Float32Array(1),Le=>(Pr[0]=+Le,Pr[0]));var Pr;const tr=3,nr=5,rn=6;class dr{constructor(oe){this.options=Object.assign(Object.create(yi),oe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(oe){const{log:le,minZoom:Pe,maxZoom:je}=this.options;le&&console.time("total time");const qe=`prepare ${oe.length} points`;le&&console.time(qe),this.points=oe;const ct=[];for(let Ke=0;Ke<oe.length;Ke++){const st=oe[Ke];if(!st.geometry)continue;const[Kt,ii]=st.geometry.coordinates,Wt=xi(zt(Kt)),ji=xi(fi(ii));ct.push(Wt,ji,1/0,Ke,-1,1),this.options.reduce&&ct.push(0)}let at=this.trees[je+1]=this._createTree(ct);le&&console.timeEnd(qe);for(let Ke=je;Ke>=Pe;Ke--){const st=+Date.now();at=this.trees[Ke]=this._createTree(this._cluster(at,Ke)),le&&console.log("z%d: %d clusters in %dms",Ke,at.numItems,+Date.now()-st)}return le&&console.timeEnd("total time"),this}getClusters(oe,le){let Pe=((oe[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,oe[1]));let qe=oe[2]===180?180:((oe[2]+180)%360+360)%360-180;const ct=Math.max(-90,Math.min(90,oe[3]));if(oe[2]-oe[0]>=360)Pe=-180,qe=180;else if(Pe>qe){const ii=this.getClusters([Pe,je,180,ct],le),Wt=this.getClusters([-180,je,qe,ct],le);return ii.concat(Wt)}const at=this.trees[this._limitZoom(le)],Ke=at.range(zt(Pe),fi(ct),zt(qe),fi(je)),st=at.data,Kt=[];for(const ii of Ke){const Wt=this.stride*ii;Kt.push(st[Wt+nr]>1?Rn(st,Wt,this.clusterProps):this.points[st[Wt+tr]])}return Kt}getChildren(oe){const le=this._getOriginId(oe),Pe=this._getOriginZoom(oe),je="No cluster with the specified id.",qe=this.trees[Pe];if(!qe)throw new Error(je);const ct=qe.data;if(le*this.stride>=ct.length)throw new Error(je);const at=this.options.radius/(this.options.extent*Math.pow(2,Pe-1)),Ke=qe.within(ct[le*this.stride],ct[le*this.stride+1],at),st=[];for(const Kt of Ke){const ii=Kt*this.stride;ct[ii+4]===oe&&st.push(ct[ii+nr]>1?Rn(ct,ii,this.clusterProps):this.points[ct[ii+tr]])}if(st.length===0)throw new Error(je);return st}getLeaves(oe,le,Pe){const je=[];return this._appendLeaves(je,oe,le=le||10,Pe=Pe||0,0),je}getTile(oe,le,Pe){const je=this.trees[this._limitZoom(oe)],qe=Math.pow(2,oe),{extent:ct,radius:at}=this.options,Ke=at/ct,st=(Pe-Ke)/qe,Kt=(Pe+1+Ke)/qe,ii={features:[]};return this._addTileFeatures(je.range((le-Ke)/qe,st,(le+1+Ke)/qe,Kt),je.data,le,Pe,qe,ii),le===0&&this._addTileFeatures(je.range(1-Ke/qe,st,1,Kt),je.data,qe,Pe,qe,ii),le===qe-1&&this._addTileFeatures(je.range(0,st,Ke/qe,Kt),je.data,-1,Pe,qe,ii),ii.features.length?ii:null}getClusterExpansionZoom(oe){let le=this._getOriginZoom(oe)-1;for(;le<=this.options.maxZoom;){const Pe=this.getChildren(oe);if(le++,Pe.length!==1)break;oe=Pe[0].properties.cluster_id}return le}_appendLeaves(oe,le,Pe,je,qe){const ct=this.getChildren(le);for(const at of ct){const Ke=at.properties;if(Ke&&Ke.cluster?qe+Ke.point_count<=je?qe+=Ke.point_count:qe=this._appendLeaves(oe,Ke.cluster_id,Pe,je,qe):qe<je?qe++:oe.push(at),oe.length===Pe)break}return qe}_createTree(oe){const le=new s.KDBush(oe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Pe=0;Pe<oe.length;Pe+=this.stride)le.add(oe[Pe],oe[Pe+1]);return le.finish(),le.data=oe,le}_addTileFeatures(oe,le,Pe,je,qe,ct){for(const at of oe){const Ke=at*this.stride,st=le[Ke+nr]>1;let Kt,ii,Wt;if(st)Kt=nn(le,Ke,this.clusterProps),ii=le[Ke],Wt=le[Ke+1];else{const $i=this.points[le[Ke+tr]];Kt=$i.properties;const[or,ur]=$i.geometry.coordinates;ii=zt(or),Wt=fi(ur)}const ji={type:1,geometry:[[Math.round(this.options.extent*(ii*qe-Pe)),Math.round(this.options.extent*(Wt*qe-je))]],tags:Kt};let Ri;Ri=st||this.options.generateId?le[Ke+tr]:this.points[le[Ke+tr]].id,Ri!==void 0&&(ji.id=Ri),ct.features.push(ji)}}_limitZoom(oe){return Math.max(this.options.minZoom,Math.min(Math.floor(+oe),this.options.maxZoom+1))}_cluster(oe,le){const{radius:Pe,extent:je,reduce:qe,minPoints:ct}=this.options,at=Pe/(je*Math.pow(2,le)),Ke=oe.data,st=[],Kt=this.stride;for(let ii=0;ii<Ke.length;ii+=Kt){if(Ke[ii+2]<=le)continue;Ke[ii+2]=le;const Wt=Ke[ii],ji=Ke[ii+1],Ri=oe.within(Ke[ii],Ke[ii+1],at),$i=Ke[ii+nr];let or=$i;for(const ur of Ri){const hn=ur*Kt;Ke[hn+2]>le&&(or+=Ke[hn+nr])}if(or>$i&&or>=ct){let ur,hn=Wt*$i,_n=ji*$i,os=-1;const jn=((ii/Kt|0)<<5)+(le+1)+this.points.length;for(const No of Ri){const $n=No*Kt;if(Ke[$n+2]<=le)continue;Ke[$n+2]=le;const us=Ke[$n+nr];hn+=Ke[$n]*us,_n+=Ke[$n+1]*us,Ke[$n+4]=jn,qe&&(ur||(ur=this._map(Ke,ii,!0),os=this.clusterProps.length,this.clusterProps.push(ur)),qe(ur,this._map(Ke,$n)))}Ke[ii+4]=jn,st.push(hn/or,_n/or,1/0,jn,-1,or),qe&&st.push(os)}else{for(let ur=0;ur<Kt;ur++)st.push(Ke[ii+ur]);if(or>1)for(const ur of Ri){const hn=ur*Kt;if(!(Ke[hn+2]<=le)){Ke[hn+2]=le;for(let _n=0;_n<Kt;_n++)st.push(Ke[hn+_n])}}}}return st}_getOriginId(oe){return oe-this.points.length>>5}_getOriginZoom(oe){return(oe-this.points.length)%32}_map(oe,le,Pe){if(oe[le+nr]>1){const ct=this.clusterProps[oe[le+rn]];return Pe?Object.assign({},ct):ct}const je=this.points[oe[le+tr]].properties,qe=this.options.map(je);return Pe&&qe===je?Object.assign({},qe):qe}}function Rn(Le,oe,le){return{type:"Feature",id:Le[oe+tr],properties:nn(Le,oe,le),geometry:{type:"Point",coordinates:[(Pe=Le[oe],360*(Pe-.5)),ri(Le[oe+1])]}};var Pe}function nn(Le,oe,le){const Pe=Le[oe+nr],je=Pe>=1e4?`${Math.round(Pe/1e3)}k`:Pe>=1e3?Math.round(Pe/100)/10+"k":Pe,qe=Le[oe+rn],ct=qe===-1?{}:Object.assign({},le[qe]);return Object.assign(ct,{cluster:!0,cluster_id:Le[oe+tr],point_count:Pe,point_count_abbreviated:je})}function zt(Le){return Le/360+.5}function fi(Le){const oe=Math.sin(Le*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function ri(Le){const oe=(180-360*Le)*Math.PI/180;return 360*Math.atan(Math.exp(oe))/Math.PI-90}function Ti(Le,oe,le,Pe){for(var je,qe=Pe,ct=le-oe>>1,at=le-oe,Ke=Le[oe],st=Le[oe+1],Kt=Le[le],ii=Le[le+1],Wt=oe+3;Wt<le;Wt+=3){var ji=sr(Le[Wt],Le[Wt+1],Ke,st,Kt,ii);if(ji>qe)je=Wt,qe=ji;else if(ji===qe){var Ri=Math.abs(Wt-ct);Ri<at&&(je=Wt,at=Ri)}}qe>Pe&&(je-oe>3&&Ti(Le,oe,je,Pe),Le[je+2]=qe,le-je>3&&Ti(Le,je,le,Pe))}function sr(Le,oe,le,Pe,je,qe){var ct=je-le,at=qe-Pe;if(ct!==0||at!==0){var Ke=((Le-le)*ct+(oe-Pe)*at)/(ct*ct+at*at);Ke>1?(le=je,Pe=qe):Ke>0&&(le+=ct*Ke,Pe+=at*Ke)}return(ct=Le-le)*ct+(at=oe-Pe)*at}function Ei(Le,oe,le,Pe){var je={id:Le===void 0?null:Le,type:oe,geometry:le,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qe){var ct=qe.geometry,at=qe.type;if(at==="Point"||at==="MultiPoint"||at==="LineString")xe(qe,ct);else if(at==="Polygon"||at==="MultiLineString")for(var Ke=0;Ke<ct.length;Ke++)xe(qe,ct[Ke]);else if(at==="MultiPolygon")for(Ke=0;Ke<ct.length;Ke++)for(var st=0;st<ct[Ke].length;st++)xe(qe,ct[Ke][st])}(je),je}function xe(Le,oe){for(var le=0;le<oe.length;le+=3)Le.minX=Math.min(Le.minX,oe[le]),Le.minY=Math.min(Le.minY,oe[le+1]),Le.maxX=Math.max(Le.maxX,oe[le]),Le.maxY=Math.max(Le.maxY,oe[le+1])}function ve(Le,oe,le,Pe){if(oe.geometry){var je=oe.geometry.coordinates,qe=oe.geometry.type,ct=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),at=[],Ke=oe.id;if(le.promoteId?Ke=oe.properties[le.promoteId]:le.generateId&&(Ke=Pe||0),qe==="Point")nt(je,at);else if(qe==="MultiPoint")for(var st=0;st<je.length;st++)nt(je[st],at);else if(qe==="LineString")Lt(je,at,ct,!1);else if(qe==="MultiLineString"){if(le.lineMetrics){for(st=0;st<je.length;st++)Lt(je[st],at=[],ct,!1),Le.push(Ei(Ke,"LineString",at,oe.properties));return}It(je,at,ct,!1)}else if(qe==="Polygon")It(je,at,ct,!0);else{if(qe!=="MultiPolygon"){if(qe==="GeometryCollection"){for(st=0;st<oe.geometry.geometries.length;st++)ve(Le,{id:Ke,geometry:oe.geometry.geometries[st],properties:oe.properties},le,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(st=0;st<je.length;st++){var Kt=[];It(je[st],Kt,ct,!0),at.push(Kt)}}Le.push(Ei(Ke,qe,at,oe.properties))}}function nt(Le,oe){oe.push(Xt(Le[0])),oe.push(ni(Le[1])),oe.push(0)}function Lt(Le,oe,le,Pe){for(var je,qe,ct=0,at=0;at<Le.length;at++){var Ke=Xt(Le[at][0]),st=ni(Le[at][1]);oe.push(Ke),oe.push(st),oe.push(0),at>0&&(ct+=Pe?(je*st-Ke*qe)/2:Math.sqrt(Math.pow(Ke-je,2)+Math.pow(st-qe,2))),je=Ke,qe=st}var Kt=oe.length-3;oe[2]=1,Ti(oe,0,Kt,le),oe[Kt+2]=1,oe.size=Math.abs(ct),oe.start=0,oe.end=oe.size}function It(Le,oe,le,Pe){for(var je=0;je<Le.length;je++){var qe=[];Lt(Le[je],qe,le,Pe),oe.push(qe)}}function Xt(Le){return Le/360+.5}function ni(Le){var oe=Math.sin(Le*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function Te(Le,oe,le,Pe,je,qe,ct,at){if(Pe/=oe,qe>=(le/=oe)&&ct<Pe)return Le;if(ct<le||qe>=Pe)return null;for(var Ke=[],st=0;st<Le.length;st++){var Kt=Le[st],ii=Kt.geometry,Wt=Kt.type,ji=je===0?Kt.minX:Kt.minY,Ri=je===0?Kt.maxX:Kt.maxY;if(ji>=le&&Ri<Pe)Ke.push(Kt);else if(!(Ri<le||ji>=Pe)){var $i=[];if(Wt==="Point"||Wt==="MultiPoint")Ae(ii,$i,le,Pe,je);else if(Wt==="LineString")Qe(ii,$i,le,Pe,je,!1,at.lineMetrics);else if(Wt==="MultiLineString")Gt(ii,$i,le,Pe,je,!1);else if(Wt==="Polygon")Gt(ii,$i,le,Pe,je,!0);else if(Wt==="MultiPolygon")for(var or=0;or<ii.length;or++){var ur=[];Gt(ii[or],ur,le,Pe,je,!0),ur.length&&$i.push(ur)}if($i.length){if(at.lineMetrics&&Wt==="LineString"){for(or=0;or<$i.length;or++)Ke.push(Ei(Kt.id,Wt,$i[or],Kt.tags));continue}Wt!=="LineString"&&Wt!=="MultiLineString"||($i.length===1?(Wt="LineString",$i=$i[0]):Wt="MultiLineString"),Wt!=="Point"&&Wt!=="MultiPoint"||(Wt=$i.length===3?"Point":"MultiPoint"),Ke.push(Ei(Kt.id,Wt,$i,Kt.tags))}}}return Ke.length?Ke:null}function Ae(Le,oe,le,Pe,je){for(var qe=0;qe<Le.length;qe+=3){var ct=Le[qe+je];ct>=le&&ct<=Pe&&(oe.push(Le[qe]),oe.push(Le[qe+1]),oe.push(Le[qe+2]))}}function Qe(Le,oe,le,Pe,je,qe,ct){for(var at,Ke,st=$t(Le),Kt=je===0?ut:Pt,ii=Le.start,Wt=0;Wt<Le.length-3;Wt+=3){var ji=Le[Wt],Ri=Le[Wt+1],$i=Le[Wt+2],or=Le[Wt+3],ur=Le[Wt+4],hn=je===0?ji:Ri,_n=je===0?or:ur,os=!1;ct&&(at=Math.sqrt(Math.pow(ji-or,2)+Math.pow(Ri-ur,2))),hn<le?_n>le&&(Ke=Kt(st,ji,Ri,or,ur,le),ct&&(st.start=ii+at*Ke)):hn>Pe?_n<Pe&&(Ke=Kt(st,ji,Ri,or,ur,Pe),ct&&(st.start=ii+at*Ke)):Zt(st,ji,Ri,$i),_n<le&&hn>=le&&(Ke=Kt(st,ji,Ri,or,ur,le),os=!0),_n>Pe&&hn<=Pe&&(Ke=Kt(st,ji,Ri,or,ur,Pe),os=!0),!qe&&os&&(ct&&(st.end=ii+at*Ke),oe.push(st),st=$t(Le)),ct&&(ii+=at)}var jn=Le.length-3;ji=Le[jn],Ri=Le[jn+1],$i=Le[jn+2],(hn=je===0?ji:Ri)>=le&&hn<=Pe&&Zt(st,ji,Ri,$i),jn=st.length-3,qe&&jn>=3&&(st[jn]!==st[0]||st[jn+1]!==st[1])&&Zt(st,st[0],st[1],st[2]),st.length&&oe.push(st)}function $t(Le){var oe=[];return oe.size=Le.size,oe.start=Le.start,oe.end=Le.end,oe}function Gt(Le,oe,le,Pe,je,qe){for(var ct=0;ct<Le.length;ct++)Qe(Le[ct],oe,le,Pe,je,qe,!1)}function Zt(Le,oe,le,Pe){Le.push(oe),Le.push(le),Le.push(Pe)}function ut(Le,oe,le,Pe,je,qe){var ct=(qe-oe)/(Pe-oe);return Le.push(qe),Le.push(le+(je-le)*ct),Le.push(1),ct}function Pt(Le,oe,le,Pe,je,qe){var ct=(qe-le)/(je-le);return Le.push(oe+(Pe-oe)*ct),Le.push(qe),Le.push(1),ct}function Mi(Le,oe){for(var le=[],Pe=0;Pe<Le.length;Pe++){var je,qe=Le[Pe],ct=qe.type;if(ct==="Point"||ct==="MultiPoint"||ct==="LineString")je=Di(qe.geometry,oe);else if(ct==="MultiLineString"||ct==="Polygon"){je=[];for(var at=0;at<qe.geometry.length;at++)je.push(Di(qe.geometry[at],oe))}else if(ct==="MultiPolygon")for(je=[],at=0;at<qe.geometry.length;at++){for(var Ke=[],st=0;st<qe.geometry[at].length;st++)Ke.push(Di(qe.geometry[at][st],oe));je.push(Ke)}le.push(Ei(qe.id,ct,je,qe.tags))}return le}function Di(Le,oe){var le=[];le.size=Le.size,Le.start!==void 0&&(le.start=Le.start,le.end=Le.end);for(var Pe=0;Pe<Le.length;Pe+=3)le.push(Le[Pe]+oe,Le[Pe+1],Le[Pe+2]);return le}function $r(Le,oe){if(Le.transformed)return Le;var le,Pe,je,qe=1<<Le.z,ct=Le.x,at=Le.y;for(le=0;le<Le.features.length;le++){var Ke=Le.features[le],st=Ke.geometry,Kt=Ke.type;if(Ke.geometry=[],Kt===1)for(Pe=0;Pe<st.length;Pe+=2)Ke.geometry.push(Nr(st[Pe],st[Pe+1],oe,qe,ct,at));else for(Pe=0;Pe<st.length;Pe++){var ii=[];for(je=0;je<st[Pe].length;je+=2)ii.push(Nr(st[Pe][je],st[Pe][je+1],oe,qe,ct,at));Ke.geometry.push(ii)}}return Le.transformed=!0,Le}function Nr(Le,oe,le,Pe,je,qe){return[Math.round(le*(Le*Pe-je)),Math.round(le*(oe*Pe-qe))]}function cn(Le,oe,le,Pe,je){for(var qe=oe===je.maxZoom?0:je.tolerance/((1<<oe)*je.extent),ct={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:Pe,z:oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},at=0;at<Le.length;at++){ct.numFeatures++,lr(ct,Le[at],qe,je);var Ke=Le[at].minX,st=Le[at].minY,Kt=Le[at].maxX,ii=Le[at].maxY;Ke<ct.minX&&(ct.minX=Ke),st<ct.minY&&(ct.minY=st),Kt>ct.maxX&&(ct.maxX=Kt),ii>ct.maxY&&(ct.maxY=ii)}return ct}function lr(Le,oe,le,Pe){var je=oe.geometry,qe=oe.type,ct=[];if(qe==="Point"||qe==="MultiPoint")for(var at=0;at<je.length;at+=3)ct.push(je[at]),ct.push(je[at+1]),Le.numPoints++,Le.numSimplified++;else if(qe==="LineString")hs(ct,je,Le,le,!1,!1);else if(qe==="MultiLineString"||qe==="Polygon")for(at=0;at<je.length;at++)hs(ct,je[at],Le,le,qe==="Polygon",at===0);else if(qe==="MultiPolygon")for(var Ke=0;Ke<je.length;Ke++){var st=je[Ke];for(at=0;at<st.length;at++)hs(ct,st[at],Le,le,!0,at===0)}if(ct.length){var Kt=oe.tags||null;if(qe==="LineString"&&Pe.lineMetrics){for(var ii in Kt={},oe.tags)Kt[ii]=oe.tags[ii];Kt.mapbox_clip_start=je.start/je.size,Kt.mapbox_clip_end=je.end/je.size}var Wt={geometry:ct,type:qe==="Polygon"||qe==="MultiPolygon"?3:qe==="LineString"||qe==="MultiLineString"?2:1,tags:Kt};oe.id!==null&&(Wt.id=oe.id),Le.features.push(Wt)}}function hs(Le,oe,le,Pe,je,qe){var ct=Pe*Pe;if(Pe>0&&oe.size<(je?ct:Pe))le.numPoints+=oe.length/3;else{for(var at=[],Ke=0;Ke<oe.length;Ke+=3)(Pe===0||oe[Ke+2]>ct)&&(le.numSimplified++,at.push(oe[Ke]),at.push(oe[Ke+1])),le.numPoints++;je&&function(st,Kt){for(var ii=0,Wt=0,ji=st.length,Ri=ji-2;Wt<ji;Ri=Wt,Wt+=2)ii+=(st[Wt]-st[Ri])*(st[Wt+1]+st[Ri+1]);if(ii>0===Kt)for(Wt=0,ji=st.length;Wt<ji/2;Wt+=2){var $i=st[Wt],or=st[Wt+1];st[Wt]=st[ji-2-Wt],st[Wt+1]=st[ji-1-Wt],st[ji-2-Wt]=$i,st[ji-1-Wt]=or}}(at,qe),Le.push(at)}}function _o(Le,oe){var le=(oe=this.options=function(je,qe){for(var ct in qe)je[ct]=qe[ct];return je}(Object.create(this.options),oe)).debug;if(le&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Pe=function(je,qe){var ct=[];if(je.type==="FeatureCollection")for(var at=0;at<je.features.length;at++)ve(ct,je.features[at],qe,at);else ve(ct,je.type==="Feature"?je:{geometry:je},qe);return ct}(Le,oe);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Pe=function(je,qe){var ct=qe.buffer/qe.extent,at=je,Ke=Te(je,1,-1-ct,ct,0,-1,2,qe),st=Te(je,1,1-ct,2+ct,0,-1,2,qe);return(Ke||st)&&(at=Te(je,1,-ct,1+ct,0,-1,2,qe)||[],Ke&&(at=Mi(Ke,1).concat(at)),st&&(at=at.concat(Mi(st,-1)))),at}(Pe,oe),Pe.length&&this.splitTile(Pe,0,0,0),le&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zn(Le,oe,le){return 32*((1<<Le)*le+oe)+Le}function Kn(Le,oe){const le=Le.tileID.canonical;if(!this._geoJSONIndex)return oe(null,null);const Pe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!Pe)return oe(null,null);const je=new class{constructor(ct){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=ct.length,this._features=ct}feature(ct){return new class{constructor(at){this._feature=at,this.extent=s.EXTENT,this.type=at.type,this.properties=at.tags,"id"in at&&!isNaN(at.id)&&(this.id=parseInt(at.id,10))}loadGeometry(){if(this._feature.type===1){const at=[];for(const Ke of this._feature.geometry)at.push([new s.Point(Ke[0],Ke[1])]);return at}{const at=[];for(const Ke of this._feature.geometry){const st=[];for(const Kt of Ke)st.push(new s.Point(Kt[0],Kt[1]));at.push(st)}return at}}toGeoJSON(at,Ke,st){return Ye.call(this,at,Ke,st)}}(this._features[ct])}}(Pe.features);let qe=ai(je);qe.byteOffset===0&&qe.byteLength===qe.buffer.byteLength||(qe=new Uint8Array(qe)),oe(null,{vectorTile:je,rawData:qe.buffer})}_o.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_o.prototype.splitTile=function(Le,oe,le,Pe,je,qe,ct){for(var at=[Le,oe,le,Pe],Ke=this.options,st=Ke.debug;at.length;){Pe=at.pop(),le=at.pop(),oe=at.pop(),Le=at.pop();var Kt=1<<oe,ii=zn(oe,le,Pe),Wt=this.tiles[ii];if(!Wt&&(st>1&&console.time("creation"),Wt=this.tiles[ii]=cn(Le,oe,le,Pe,Ke),this.tileCoords.push({z:oe,x:le,y:Pe}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,le,Pe,Wt.numFeatures,Wt.numPoints,Wt.numSimplified),console.timeEnd("creation"));var ji="z"+oe;this.stats[ji]=(this.stats[ji]||0)+1,this.total++}if(Wt.source=Le,je){if(oe===Ke.maxZoom||oe===je)continue;var Ri=1<<je-oe;if(le!==Math.floor(qe/Ri)||Pe!==Math.floor(ct/Ri))continue}else if(oe===Ke.indexMaxZoom||Wt.numPoints<=Ke.indexMaxPoints)continue;if(Wt.source=null,Le.length!==0){st>1&&console.time("clipping");var $i,or,ur,hn,_n,os,jn=.5*Ke.buffer/Ke.extent,No=.5-jn,$n=.5+jn,us=1+jn;$i=or=ur=hn=null,_n=Te(Le,Kt,le-jn,le+$n,0,Wt.minX,Wt.maxX,Ke),os=Te(Le,Kt,le+No,le+us,0,Wt.minX,Wt.maxX,Ke),Le=null,_n&&($i=Te(_n,Kt,Pe-jn,Pe+$n,1,Wt.minY,Wt.maxY,Ke),or=Te(_n,Kt,Pe+No,Pe+us,1,Wt.minY,Wt.maxY,Ke),_n=null),os&&(ur=Te(os,Kt,Pe-jn,Pe+$n,1,Wt.minY,Wt.maxY,Ke),hn=Te(os,Kt,Pe+No,Pe+us,1,Wt.minY,Wt.maxY,Ke),os=null),st>1&&console.timeEnd("clipping"),at.push($i||[],oe+1,2*le,2*Pe),at.push(or||[],oe+1,2*le,2*Pe+1),at.push(ur||[],oe+1,2*le+1,2*Pe),at.push(hn||[],oe+1,2*le+1,2*Pe+1)}}},_o.prototype.getTile=function(Le,oe,le){var Pe=this.options,je=Pe.extent,qe=Pe.debug;if(Le<0||Le>24)return null;var ct=1<<Le,at=zn(Le,oe=(oe%ct+ct)%ct,le);if(this.tiles[at])return $r(this.tiles[at],je);qe>1&&console.log("drilling down to z%d-%d-%d",Le,oe,le);for(var Ke,st=Le,Kt=oe,ii=le;!Ke&&st>0;)st--,Kt=Math.floor(Kt/2),ii=Math.floor(ii/2),Ke=this.tiles[zn(st,Kt,ii)];return Ke&&Ke.source?(qe>1&&console.log("found parent tile z%d-%d-%d",st,Kt,ii),qe>1&&console.time("drilling down"),this.splitTile(Ke.source,st,Kt,ii,Le,oe,le),qe>1&&console.timeEnd("drilling down"),this.tiles[at]?$r(this.tiles[at],je):null):null};class ss extends s.VectorTileWorkerSource{constructor(oe,le,Pe,je,qe){super(oe,le,Pe,je,Kn),qe&&(this.loadGeoJSON=qe)}loadData(oe,le){const Pe=oe&&oe.request,je=Pe&&Pe.collectResourceTiming;this.loadGeoJSON(oe,(qe,ct)=>{if(qe||!ct)return le(qe);if(typeof ct!="object")return le(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`));{Me(ct,!0);try{if(oe.filter){const Ke=s.createExpression(oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ke.result==="error")throw new Error(Ke.value.map(Kt=>`${Kt.key}: ${Kt.message}`).join(", "));ct={type:"FeatureCollection",features:ct.features.filter(Kt=>Ke.value.evaluate({zoom:0},Kt))}}this._geoJSONIndex=oe.cluster?new dr(function({superclusterOptions:Ke,clusterProperties:st}){if(!st||!Ke)return Ke;const Kt={},ii={},Wt={accumulated:null,zoom:0},ji={properties:null},Ri=Object.keys(st);for(const $i of Ri){const[or,ur]=st[$i],hn=s.createExpression(ur),_n=s.createExpression(typeof or=="string"?[or,["accumulated"],["get",$i]]:or);Kt[$i]=hn.value,ii[$i]=_n.value}return Ke.map=$i=>{ji.properties=$i;const or={};for(const ur of Ri)or[ur]=Kt[ur].evaluate(Wt,ji);return or},Ke.reduce=($i,or)=>{ji.properties=or;for(const ur of Ri)Wt.accumulated=$i[ur],$i[ur]=ii[ur].evaluate(Wt,ji)},Ke}(oe)).load(ct.features):function(Ke,st){return new _o(Ke,st)}(ct,oe.geojsonVtOptions)}catch(Ke){return le(Ke)}this.loaded={};const at={};if(je){const Ke=s.getPerformanceMeasurement(Pe);Ke&&(at.resourceTiming={},at.resourceTiming[oe.source]=JSON.parse(JSON.stringify(Ke)))}le(null,at)}})}reloadTile(oe,le){const Pe=this.loaded;return Pe&&Pe[oe.uid]?super.reloadTile(oe,le):this.loadTile(oe,le)}loadGeoJSON(oe,le){if(oe.request)s.getJSON(oe.request,le);else{if(typeof oe.data!="string")return le(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(oe.data))}catch{return le(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(oe,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(oe.clusterId))}catch(Pe){le(Pe)}}getClusterChildren(oe,le){try{le(null,this._geoJSONIndex.getChildren(oe.clusterId))}catch(Pe){le(Pe)}}getClusterLeaves(oe,le){try{le(null,this._geoJSONIndex.getLeaves(oe.clusterId,oe.limit,oe.offset))}catch(Pe){le(Pe)}}}class $l{constructor(oe){this.self=oe,this.actor=new s.Actor(oe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:ss},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,Pe)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=Pe},this.self.registerRTLTextPlugin=le=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=le.applyArabicShaping,s.plugin.processBidirectionalText=le.processBidirectionalText,s.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(oe,le,Pe){delete this.layerIndexes[oe],delete this.availableImages[oe],delete this.workerSources[oe],delete this.demWorkerSources[oe],Pe()}checkIfReady(oe,le,Pe){Pe()}setReferrer(oe,le){this.referrer=le}spriteLoaded(oe,le){this.isSpriteLoaded[oe]=le;for(const Pe in this.workerSources[oe]){const je=this.workerSources[oe][Pe];for(const qe in je)je[qe]instanceof s.VectorTileWorkerSource&&(je[qe].isSpriteLoaded=le,je[qe].fire(new s.Event("isSpriteLoaded")))}}setImages(oe,le,Pe){this.availableImages[oe]=le;for(const je in this.workerSources[oe]){const qe=this.workerSources[oe][je];for(const ct in qe)qe[ct].availableImages=le}Pe()}enableTerrain(oe,le,Pe){this.terrain=le,Pe()}setProjection(oe,le){this.projections[oe]=s.getProjection(le)}setLayers(oe,le,Pe){this.getLayerIndex(oe).replace(le),Pe()}updateLayers(oe,le,Pe){this.getLayerIndex(oe).update(le.layers,le.removedIds),Pe()}loadTile(oe,le,Pe){const je=this.enableTerrain?s.extend({enableTerrain:this.terrain},le):le;je.projection=this.projections[oe]||this.defaultProjection,this.getWorkerSource(oe,le.type,le.source).loadTile(je,Pe)}loadDEMTile(oe,le,Pe){const je=this.enableTerrain?s.extend({buildQuadTree:this.terrain},le):le;this.getDEMWorkerSource(oe,le.source).loadTile(je,Pe)}reloadTile(oe,le,Pe){const je=this.enableTerrain?s.extend({enableTerrain:this.terrain},le):le;je.projection=this.projections[oe]||this.defaultProjection,this.getWorkerSource(oe,le.type,le.source).reloadTile(je,Pe)}abortTile(oe,le,Pe){this.getWorkerSource(oe,le.type,le.source).abortTile(le,Pe)}removeTile(oe,le,Pe){this.getWorkerSource(oe,le.type,le.source).removeTile(le,Pe)}removeSource(oe,le,Pe){if(!this.workerSources[oe]||!this.workerSources[oe][le.type]||!this.workerSources[oe][le.type][le.source])return;const je=this.workerSources[oe][le.type][le.source];delete this.workerSources[oe][le.type][le.source],je.removeSource!==void 0?je.removeSource(le,Pe):Pe()}loadWorkerSource(oe,le,Pe){try{this.self.importScripts(le.url),Pe()}catch(je){Pe(je.toString())}}syncRTLPluginState(oe,le,Pe){try{s.plugin.setState(le);const je=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&je!=null){this.self.importScripts(je);const qe=s.plugin.isParsed();Pe(qe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${je}`),qe)}}catch(je){Pe(je.toString())}}getAvailableImages(oe){let le=this.availableImages[oe];return le||(le=[]),le}getLayerIndex(oe){let le=this.layerIndexes[oe];return le||(le=this.layerIndexes[oe]=new J),le}getWorkerSource(oe,le,Pe){if(this.workerSources[oe]||(this.workerSources[oe]={}),this.workerSources[oe][le]||(this.workerSources[oe][le]={}),!this.workerSources[oe][le][Pe]){const je={send:(qe,ct,at,Ke,st,Kt)=>{this.actor.send(qe,ct,at,oe,st,Kt)},scheduler:this.actor.scheduler};this.workerSources[oe][le][Pe]=new this.workerSourceTypes[le](je,this.getLayerIndex(oe),this.getAvailableImages(oe),this.isSpriteLoaded[oe])}return this.workerSources[oe][le][Pe]}getDEMWorkerSource(oe,le){return this.demWorkerSources[oe]||(this.demWorkerSources[oe]={}),this.demWorkerSources[oe][le]||(this.demWorkerSources[oe][le]=new ne),this.demWorkerSources[oe][le]}enforceCacheSizeLimit(oe,le){s.enforceCacheSizeLimit(le)}getWorkerPerformanceMetrics(oe,le,Pe){Pe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new $l(self)),$l}),P(["./shared"],function(s){function $(f,n){if(Array.isArray(f)){if(!Array.isArray(n)||f.length!==n.length)return!1;for(let c=0;c<f.length;c++)if(!$(f[c],n[c]))return!1;return!0}if(typeof f=="object"&&f!==null&&n!==null){if(typeof n!="object"||Object.keys(f).length!==Object.keys(n).length)return!1;for(const c in f)if(!$(f[c],n[c]))return!1;return!0}return f===n}var Z=J;function J(f){return!function(n){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,b,E=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(E);try{b=new Worker(L),g=!0}catch{g=!1}return b&&b.terminate(),URL.revokeObjectURL(L),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var b=g.getContext("2d");if(!b)return!1;var E=b.getImageData(0,0,1,1);return E&&E.width===g.width}()?(ne[c=n&&n.failIfMajorPerformanceCaveat]===void 0&&(ne[c]=function(g){var b,E=function(L){var D=document.createElement("canvas"),F=Object.create(J.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=L,D.getContext("webgl",F)||D.getContext("experimental-webgl",F)}(g);if(!E)return!1;try{b=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!b||E.isContextLost())&&(E.shaderSource(b,"void main() {}"),E.compileShader(b),E.getShaderParameter(b,E.COMPILE_STATUS)===!0)}(c)),ne[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(f)}var ne={};function ue(f,n,c){const g=s.window.document.createElement(f);return n!==void 0&&(g.className=n),c&&c.appendChild(g),g}function we(f,n,c){const g=s.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const b of Object.keys(n))g.setAttributeNS(null,b,n[b]);return c&&c.appendChild(g),g}J.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Me=s.window.document&&s.window.document.documentElement.style,Ye=Me&&Me.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ze;function Fe(){Me&&Ye&&(Ze=Me[Ye],Me[Ye]="none")}function ae(){Me&&Ye&&(Me[Ye]=Ze)}function ge(f){f.preventDefault(),f.stopPropagation(),s.window.removeEventListener("click",ge,!0)}function Oe(){s.window.addEventListener("click",ge,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",ge,!0)},0)}function ze(f,n){const c=f.getBoundingClientRect();return Je(f,c,n)}function rt(f,n){const c=f.getBoundingClientRect(),g=[];for(let b=0;b<n.length;b++)g.push(Je(f,c,n[b]));return g}function Ie(f){return s.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function Je(f,n,c){const g=f.offsetWidth===n.width?1:f.offsetWidth/n.width;return new s.Point((c.clientX-n.left)*g,(c.clientY-n.top)*g)}function He(f,n){var c=n[0],g=n[1],b=n[2],E=n[3],L=c*E-b*g;return L?(f[0]=E*(L=1/L),f[1]=-g*L,f[2]=-b*L,f[3]=c*L,f):null}function ti(f){const{userImage:n}=f;return!!(n&&n.render&&n.render())&&(f.data.replace(new Uint8Array(n.data.buffer)),!0)}class bt extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:c,callback:g}of this.requestors)this._notify(c,g);this.requestors=[]}}hasImage(n){return!!this.getImage(n)}getImage(n){return this.images[n]}addImage(n,c){this._validate(n,c)&&(this.images[n]=c)}_validate(n,c){let g=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),g=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),g=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),g=!1),g}_validateStretch(n,c){if(!n)return!0;let g=0;for(const b of n){if(b[0]<g||b[1]<b[0]||c<b[1])return!1;g=b[1]}return!0}_validateContent(n,c){return!(n&&(n.length!==4||n[0]<0||c.data.width<n[0]||n[1]<0||c.data.height<n[1]||n[2]<0||c.data.width<n[2]||n[3]<0||c.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,c){c.version=this.images[n].version+1,this.images[n]=c,this.updatedImages[n]=!0}removeImage(n){const c=this.images[n];delete this.images[n],delete this.patterns[n],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,c){let g=!0;if(!this.isLoaded())for(const b of n)this.images[b]||(g=!1);this.isLoaded()||g?this._notify(n,c):this.requestors.push({ids:n,callback:c})}_notify(n,c){const g={};for(const b of n){this.images[b]||this.fire(new s.Event("styleimagemissing",{id:b}));const E=this.images[b];E?g[b]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:s.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,g)}getPixelSize(){const{width:n,height:c}=this.atlasImage;return{width:n,height:c}}getPattern(n){const c=this.patterns[n],g=this.getImage(n);if(!g)return null;if(c&&c.position.version===g.version)return c.position;if(c)c.position.version=g.version;else{const b={w:g.data.width+2,h:g.data.height+2,x:0,y:0},E=new s.ImagePosition(b,g);this.patterns[n]={bin:b,position:E}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const c=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(n,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const E in this.patterns)n.push(this.patterns[E].bin);const{w:c,h:g}=s.potpack(n),b=this.atlasImage;b.resize({width:c||1,height:g||1});for(const E in this.patterns){const{bin:L}=this.patterns[E],D=L.x+1,F=L.y+1,W=this.images[E].data,H=W.width,Q=W.height;s.RGBAImage.copy(W,b,{x:0,y:0},{x:D,y:F},{width:H,height:Q}),s.RGBAImage.copy(W,b,{x:0,y:Q-1},{x:D,y:F-1},{width:H,height:1}),s.RGBAImage.copy(W,b,{x:0,y:0},{x:D,y:F+Q},{width:H,height:1}),s.RGBAImage.copy(W,b,{x:H-1,y:0},{x:D-1,y:F},{width:1,height:Q}),s.RGBAImage.copy(W,b,{x:0,y:0},{x:D+H,y:F},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const c of n){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const g=this.images[c];ti(g)&&this.updateImage(c,g)}}}const wt=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(f,n){return function([c,g,b]){const E=s.degToRad(g+90),L=s.degToRad(b);return{x:c*Math.cos(E)*Math.sin(L),y:c*Math.sin(E)*Math.sin(L),z:c*Math.cos(L),azimuthal:g,polar:b}}(f.expression.evaluate(n))}interpolate(f,n,c){return{x:s.number(f.x,n.x,c),y:s.number(f.y,n.y,c),z:s.number(f.z,n.z,c),azimuthal:s.number(f.azimuthal,n.azimuthal,c),polar:s.number(f.polar,n.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class xt extends s.Evented{constructor(n){super(),this._transitionable=new s.Transitionable(wt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,c={}){if(!this._validate(s.validateLight,n,c))for(const g in n){const b=n[g];s.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,n.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const Tt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let vt=class extends s.Evented{constructor(f,n){super(),this._transitionable=new s.Transitionable(Tt),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(f){for(const n in f){const c=f[n];s.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),c):this._transitionable.setValue(n,c)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}};function ai(f,n,c,g){const b=s.smoothstep(45,65,c),[E,L]=yi(f,g),D=s.length(n);let F=1-Math.min(1,Math.exp((D-E)/(L-E)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*b*f.alpha}function yi(f,n){const c=.5/Math.tan(.5*n);return[f.range[0]+c,f.range[1]+c]}const xi=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class Pr extends s.Evented{constructor(n,c){super(),this._transitionable=new s.Transitionable(xi),this.set(n),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const n=this._transform,c=n.projection.name==="globe",g=s.globeToMercatorTransition(n.zoom),b=this.properties.get("range"),E=[.5,3];return{range:c?[s.number(E[0],b[0],g),s.number(E[1],b[1],g)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,c={}){if(!this._validate(s.validateFog,n,c)){for(const g of Object.keys(s.spec.fog))n&&n[g]===void 0&&(n[g]=s.spec.fog[g].default);for(const g in n){const b=n[g];s.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,n))*c.a}getOpacityAtLatLng(n,c){return this._transform.projection.supportsFog?function(g,b,E){const L=s.MercatorCoordinate.fromLngLat(b),D=E.elevation?E.elevation.getAtPointOrZero(L):0,F=[L.x,L.y,D];return s.transformMat4(F,F,E.mercatorFogMatrix),ai(g,F,E.pitch,E._fov)}(this.state,n,c):0}getFovAdjustedRange(n){return this._transform.projection.supportsFog?yi(this.state,n):[0,1]}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,n.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class tr{constructor(n,c){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const g=this.workerPool.acquire(this.id);for(let b=0;b<g.length;b++){const E=new tr.Actor(g[b],c,this.id);E.name=`Worker ${b}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,c,g){s.asyncAll(this.actors,(b,E)=>{b.send(n,c,E)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function nr(f,n,c){return n*(s.EXTENT/(f.tileSize*Math.pow(2,c-f.tileID.overscaledZ)))}tr.Actor=s.Actor;class rn{constructor(n,c,g,b){this.screenBounds=n,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(n,c){let g,b;if(n instanceof s.Point||typeof n[0]=="number"){const E=s.Point.convert(n);g=[E],b=c.isPointAboveHorizon(E)}else{const E=s.Point.convert(n[0]),L=s.Point.convert(n[1]);g=[E,L],b=s.polygonizeBounds(E,L).every(D=>c.isPointAboveHorizon(D))}return new rn(g,c.getCameraPoint(),b,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const c=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],b=s.polygonizeBounds(c,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<g.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?b[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(b[3]=this.cameraPoint)),s.bufferConvexPolygon(b,n)}bufferedCameraGeometryGlobe(n){const c=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],b=s.polygonizeBounds(c,g,n),E=this.cameraPoint.clone();switch(3*((E.y>c.y)+(E.y>g.y))+((E.x>c.x)+(E.x>g.x))){case 0:b[0]=E,b[4]=E.clone();break;case 1:b.splice(1,0,E);break;case 2:b[1]=E;break;case 3:b.splice(4,0,E);break;case 5:b.splice(2,0,E);break;case 6:b[3]=E;break;case 7:b.splice(3,0,E);break;case 8:b[2]=E}return b}containsTile(n,c,g,b=0){const E=n.queryPadding/c._pixelsPerMercatorPixel+1,L=g?this._bufferedCameraMercator(E,c):this._bufferedScreenMercator(E,c);let D=n.tileID.wrap+(L.unwrapped?b:0);const F=L.polygon.map(be=>s.getTilePoint(n.tileTransform,be,D));if(!s.polygonIntersectsBox(F,0,0,s.EXTENT,s.EXTENT))return;D=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const W=this.screenGeometryMercator.polygon.map(be=>s.getTileVec3(n.tileTransform,be,D)),H=W.map(be=>new s.Point(be[0],be[1])),Q=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),he=s.getTileVec3(n.tileTransform,Q,D),me=W.map(be=>{const ee=s.sub(be,be,he);return s.normalize(ee,ee),new s.Ray(he,ee)}),ye=nr(n,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:me,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(_e=s.getBounds(F),_e.min.x=s.clamp(_e.min.x,0,s.EXTENT),_e.min.y=s.clamp(_e.min.y,0,s.EXTENT),_e.max.x=s.clamp(_e.max.x,0,s.EXTENT),_e.max.y=s.clamp(_e.max.y,0,s.EXTENT),_e),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:ye};var _e}_bufferedScreenMercator(n,c){const g=nn(n);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let b;return b=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),c):{polygon:this.bufferedScreenGeometry(n).map(E=>c.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[g]=b,b}}_bufferedCameraMercator(n,c){const g=nn(n);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let b;return b=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),c):{polygon:this.bufferedCameraGeometry(n).map(E=>c.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[g]=b,b}}_projectAndResample(n,c){const g=function(E,L){const D=s.multiply([],L.pixelMatrix,L.globeMatrix),F=[0,-s.GLOBE_RADIUS,0,1],W=[0,s.GLOBE_RADIUS,0,1],H=[0,0,0,1];s.transformMat4$1(F,F,D),s.transformMat4$1(W,W,D),s.transformMat4$1(H,H,D);const Q=new s.Point(F[0]/F[3],F[1]/F[3]),he=new s.Point(W[0]/W[3],W[1]/W[3]),me=s.polygonContainsPoint(E,Q)&&F[3]<H[3],ye=s.polygonContainsPoint(E,he)&&W[3]<H[3];if(!me&&!ye)return null;const _e=function(We,it,et){for(let ft=1;ft<We.length;ft++){const Nt=Rn(it.pointCoordinate3D(We[ft-1]).x),ht=Rn(it.pointCoordinate3D(We[ft]).x);if(et<0){if(Nt<ht)return{idx:ft,t:-Nt/(ht-1-Nt)}}else if(ht<Nt)return{idx:ft,t:(1-Nt)/(ht+1-Nt)}}return null}(E,L,me?-1:1);if(!_e)return null;const{idx:be,t:ee}=_e;let pe=be>1?dr(E.slice(0,be),L):[],Ce=be<E.length?dr(E.slice(be),L):[];pe=pe.map(We=>new s.Point(Rn(We.x),We.y)),Ce=Ce.map(We=>new s.Point(Rn(We.x),We.y));const ke=[...pe];ke.length===0&&ke.push(Ce[Ce.length-1]);const Ge=s.number(ke[ke.length-1].y,(Ce.length===0?pe[0]:Ce[0]).y,ee);let Ne;return Ne=me?[new s.Point(0,Ge),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Ge)]:[new s.Point(1,Ge),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Ge)],ke.push(...Ne),Ce.length===0?ke.push(pe[0]):ke.push(...Ce),{polygon:ke.map(We=>new s.MercatorCoordinate(We.x,We.y)),unwrapped:!1}}(n,c);if(g)return g;const b=function(E,L){let D=!1,F=-1/0,W=0;for(let Q=0;Q<E.length-1;Q++)E[Q].x>F&&(F=E[Q].x,W=Q);for(let Q=0;Q<E.length-1;Q++){const he=(W+Q)%(E.length-1),me=E[he],ye=E[he+1];Math.abs(me.x-ye.x)>.5&&(me.x<ye.x?(me.x+=1,he===0&&(E[E.length-1].x+=1)):(ye.x+=1,he+1===E.length-1&&(E[0].x+=1)),D=!0)}const H=s.mercatorXfromLng(L.center.lng);return D&&H<Math.abs(H-1)&&E.forEach(Q=>{Q.x-=1}),{polygon:E,unwrapped:D}}(dr(n,c).map(E=>new s.Point(Rn(E.x),E.y)),c);return{polygon:b.polygon.map(E=>new s.MercatorCoordinate(E.x,E.y)),unwrapped:b.unwrapped}}}function dr(f,n){return s.resample(f,c=>{const g=n.pointCoordinate3D(c);c.x=g.x,c.y=g.y},1/256)}function Rn(f){return f<0?1+f%1:f%1}function nn(f){return 100*f|0}function zt(f,n,c,g,b){const E=function(L,D){if(L)return b(L);if(D){f.url&&D.tiles&&f.tiles&&delete f.tiles;const F=s.pick(s.extend(D,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(F.vectorLayers=D.vector_layers,F.vectorLayerIds=F.vectorLayers.map(W=>W.id)),F.tiles=n.canonicalizeTileset(F,f.url),b(null,F)}};return f.url?s.getJSON(n.transformRequest(n.normalizeSourceURL(f.url,null,c,g),s.ResourceType.Source),E):s.exported.frame(()=>E(null,f))}class fi{constructor(n,c,g){this.bounds=s.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=c||0,this.maxzoom=g||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const c=Math.pow(2,n.z),g=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),b=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),E=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),L=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return n.x>=g&&n.x<E&&n.y>=b&&n.y<L}}class ri{constructor(n,c,g){this.context=n;const b=n.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ti={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class sr{constructor(n,c,g,b){this.length=c.length,this.attributes=g,this.itemSize=c.bytesPerElement,this.dynamicDraw=b,this.context=n;const E=n.gl;this.buffer=E.createBuffer(),n.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,c){for(let g=0;g<this.attributes.length;g++){const b=c.attributes[this.attributes[g].name];b!==void 0&&n.enableVertexAttribArray(b)}}setVertexAttribPointers(n,c,g){for(let b=0;b<this.attributes.length;b++){const E=this.attributes[b],L=c.attributes[E.name];L!==void 0&&n.vertexAttribPointer(L,E.components,n[Ti[E.type]],!1,this.itemSize,E.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ei{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class xe extends Ei{getDefault(){return s.Color.transparent}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ve extends Ei{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class nt extends Ei{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Lt extends Ei{getDefault(){return[!0,!0,!0,!0]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class It extends Ei{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Xt extends Ei{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class ni extends Ei{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Te extends Ei{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Ae extends Ei{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}}class Qe extends Ei{getDefault(){return[0,1]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class $t extends Ei{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}}class Gt extends Ei{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Zt extends Ei{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}}class ut extends Ei{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Pt extends Ei{getDefault(){return s.Color.transparent}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Mi extends Ei{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Di extends Ei{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}}class $r extends Ei{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Nr extends Ei{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let cn,lr=class extends Ei{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class hs extends Ei{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class _o extends Ei{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class zn extends Ei{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Kn extends Ei{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ss extends Ei{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class $l extends Ei{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Le extends Ei{getDefault(){return null}set(n){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class oe extends Ei{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class le extends Ei{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Pe extends Ei{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class je extends Ei{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class qe extends Ei{constructor(n,c){super(n),this.context=n,this.parent=c}getDefault(){return null}}class ct extends qe{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class at extends qe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Ke extends at{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class st{constructor(n,c,g,b){this.context=n,this.width=c,this.height=g;const E=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new ct(n,E),b&&(this.depthAttachment=new at(n,E))}destroy(){const n=this.context.gl,c=this.colorAttachment.get();if(c&&n.deleteTexture(c),this.depthAttachment){const g=this.depthAttachment.get();g&&n.deleteRenderbuffer(g)}n.deleteFramebuffer(this.framebuffer)}}class Kt{constructor(n,c=!1){if(this.gl=n,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const g=n;this.extVertexArrayObject={createVertexArrayOES:g.createVertexArray.bind(n),deleteVertexArrayOES:g.deleteVertexArray.bind(n),bindVertexArrayOES:g.bindVertexArray.bind(n)}}this.clearColor=new xe(this),this.clearDepth=new ve(this),this.clearStencil=new nt(this),this.colorMask=new Lt(this),this.depthMask=new It(this),this.stencilMask=new Xt(this),this.stencilFunc=new ni(this),this.stencilOp=new Te(this),this.stencilTest=new Ae(this),this.depthRange=new Qe(this),this.depthTest=new $t(this),this.depthFunc=new Gt(this),this.blend=new Zt(this),this.blendFunc=new ut(this),this.blendColor=new Pt(this),this.blendEquation=new Mi(this),this.cullFace=new Di(this),this.cullFaceSide=new $r(this),this.frontFace=new Nr(this),this.program=new lr(this),this.activeTexture=new hs(this),this.viewport=new _o(this),this.bindFramebuffer=new zn(this),this.bindRenderbuffer=new Kn(this),this.bindTexture=new ss(this),this.bindVertexBuffer=new $l(this),this.bindElementBuffer=new Le(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new oe(this),this.pixelStoreUnpack=new le(this),this.pixelStoreUnpackPremultiplyAlpha=new Pe(this),this.pixelStoreUnpackFlipY=new je(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=n.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&n.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||n.getExtension("OES_standard_derivatives"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,c){return new ri(this,n,c)}createVertexBuffer(n,c,g){return new sr(this,n,c,g)}createRenderbuffer(n,c,g){const b=this.gl,E=b.createRenderbuffer();return this.bindRenderbuffer.set(E),b.renderbufferStorage(b.RENDERBUFFER,n,c,g),this.bindRenderbuffer.set(null),E}createFramebuffer(n,c,g){return new st(this,n,c,g)}clear({color:n,depth:c,stencil:g}){const b=this.gl;let E=0;n&&(E|=b.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(E|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),g!==void 0&&(E|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),b.clear(E)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){$(n.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ii extends s.Evented{constructor(n,c,g,b){if(super(),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(c,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(n){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=zt(this._options,this.map._requestManager,c,g,(b,E)=>{this._tileJSONRequest=null,this._loaded=!0,b?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new s.ErrorEvent(b))):E&&(s.extend(this,E),E.bounds&&(this.tileBounds=new fi(E.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),n&&n(b)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(n,c){const g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(g,s.ResourceType.Tile),data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile};if(b.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=c:n.request=n.actor.send("reloadTile",b,E.bind(this));else if(n.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",b,E.bind(this),void 0,!0);else{const L=s.loadVectorTile.call({deduped:this._deduped},b,(D,F)=>{D||!F?E.call(this,D):(b.data={cacheControl:F.cacheControl,expires:F.expires,rawData:F.rawData.slice(0)},n.actor&&n.actor.send("loadTile",b,E.bind(this),void 0,!0))},!0);n.request={cancel:L}}function E(L,D){return delete n.request,n.aborted?c(null):L&&L.status!==404?c(L):(D&&D.resourceTiming&&(n.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&n.setExpiryData(D),n.loadVectorData(D,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id})}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Wt extends s.Evented{constructor(n,c,g,b){super(),this.id=n,this.dispatcher=g,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zt(this._options,this.map._requestManager,null,null,(c,g)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):g&&(s.extend(this,g),g.bounds&&(this.tileBounds=new fi(g.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(g.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),n&&n(c)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,c){const g=s.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);n.request=s.getImage(this.map._requestManager.transformRequest(b,s.ResourceType.Tile),(E,L,D,F)=>(delete n.request,n.aborted?(n.state="unloaded",c(null)):E?(n.state="errored",c(E)):L?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:D,expires:F}),n.setTexture(L,this.map.painter),n.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(n,c,g){n.setTexture(c,g)}static unloadTileData(n,c){n.texture&&c.saveTileTexture(n.texture)}abortTile(n,c){n.request&&(n.request.cancel(),delete n.request),c()}unloadTile(n,c){n.texture&&this.map.painter.saveTileTexture(n.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function ji(f,n,c,g,b,E,L,D){const F=[f,c,b,n,g,E,1,1,1],W=[L,D,1],H=s.adjoint([],F),[Q,he,me]=s.transformMat3(W,W,s.transpose(H,H));return s.multiply$1(F,[Q,0,0,0,he,0,0,0,me],F)}class Ri extends s.Evented{constructor(n,c,g,b){super(),this.id=n,this.dispatcher=g,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=c,this._dirty=!1}load(n,c){this._loaded=c||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(g,b)=>{if(this._imageRequest=null,this._loaded=!0,g)this.fire(new s.ErrorEvent(g));else if(b){const{HTMLImageElement:E}=s.window;this.image=b instanceof E?s.exported.getImageData(b):b,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading()}})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(n){this.coordinates=n,this._boundsArray=void 0;const c=n.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let b=1/0,E=1/0,L=-1/0,D=-1/0;for(const Q of g)b=Math.min(b,Q.x),E=Math.min(E,Q.y),L=Math.max(L,Q.x),D=Math.max(D,Q.y);const F=Math.max(L-b,D-E),W=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),H=Math.pow(2,W);return new s.CanonicalTileID(W,Math.floor((b+L)/2*H),Math.floor((E+D)/2*H))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(n){for(const F in this.tiles){const W=this.tiles[F];W.state!=="loaded"&&(W.state="loaded",W.texture=this.texture)}if(this._boundsArray)return;const c=s.tileTransform(this.tileID,this.map.transform.projection),[g,b,E,L]=this.coordinates.map(F=>{const W=c.projection.project(F[0],F[1]);return s.getTilePoint(c,W)._round()});this.perspectiveTransform=function(F,W,H,Q,he,me,ye,_e,be,ee){const pe=ji(0,0,F,0,0,W,F,W),Ce=ji(H,Q,he,me,ye,_e,be,ee);return s.multiply$1(Ce,s.adjoint(pe,pe),Ce),[Ce[6]/Ce[8]*F/s.EXTENT,Ce[7]/Ce[8]*W/s.EXTENT]}(this.width,this.height,g.x,g.y,b.x,b.y,L.x,L.y,E.x,E.y);const D=this._boundsArray=new s.StructArrayLayout4i8;D.emplaceBack(g.x,g.y,0,0),D.emplaceBack(b.x,b.y,s.EXTENT,0),D.emplaceBack(L.x,L.y,0,s.EXTENT),D.emplaceBack(E.x,E.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=n.createVertexBuffer(D,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,c=n.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(n,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(n)}loadTile(n,c){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},c(null)):(n.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const $i={vector:ii,raster:Wt,"raster-dem":class extends Wt{constructor(f,n,c,g){super(f,n,c,g),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(f,n){const c=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(b,E){b&&(f.state="errored",n(b)),E&&(f.dem=E,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",n(null))}f.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),(function(b,E,L,D){if(delete f.request,f.aborted)f.state="unloaded",n(null);else if(b)f.state="errored",n(b);else if(E){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:L,expires:D});const F=s.window.ImageBitmap&&E instanceof s.window.ImageBitmap&&(cn==null&&(cn=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),cn),W=1-(E.width-s.prevPowerOfTwo(E.width))/2;W<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const H=F?E:s.exported.getImageData(E,W),Q={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:W};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",Q,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const n=f.canonical,c=Math.pow(2,n.z),g=(n.x-1+c)%c,b=n.x===0?f.wrap-1:f.wrap,E=(n.x+1+c)%c,L=n.x+1===c?f.wrap+1:f.wrap,D={};return D[new s.OverscaledTileID(f.overscaledZ,b,n.z,g,n.y).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,L,n.z,E,n.y).key]={backfilled:!1},n.y>0&&(D[new s.OverscaledTileID(f.overscaledZ,b,n.z,g,n.y-1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,f.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,L,n.z,E,n.y-1).key]={backfilled:!1}),n.y+1<c&&(D[new s.OverscaledTileID(f.overscaledZ,b,n.z,g,n.y+1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,f.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,L,n.z,E,n.y+1).key]={backfilled:!1}),D}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends s.Evented{constructor(f,n,c,g){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(g),this._data=n.data,this._options=s.extend({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const b=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*b,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*b,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:s.EXTENT,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*b,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},n),this}getClusterChildren(f,n){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},n),this}getClusterLeaves(f,n,c,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:n,offset:c},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=s.extend({},this.workerOptions),n=this._data;typeof n=="string"?(f.request=this.map._requestManager.transformRequest(s.exported.resolveURL(n),s.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(c,g)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(b.resourceTiming=g.resourceTiming[this.id]),this.fire(new s.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,n){const c=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(c,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,b)=>(delete f.request,f.unloadVectorData(),f.aborted?n(null):g?n(g):(f.loadVectorData(b,this.map.painter,c==="reloadTile"),n(null))),void 0,c==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ri{constructor(f,n,c,g){super(f,n,c,g),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const n of f.urls)this.urls.push(this.map._requestManager.transformRequest(n,s.ResourceType.Source).url);s.getVideo(this.urls,(n,c)=>{this._loaded=!0,n?this.fire(new s.ErrorEvent(n)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const n=this.video.seekable;f<n.start(0)||f>n.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,n=f.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(f,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ri,canvas:class extends Ri{constructor(f,n,c,g){super(f,n,c,g),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(E=>typeof E!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends s.Evented{constructor(f,n,c,g){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=n,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new fi(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:n,y:c,z:g}=f.canonical;return this._implementation.hasTile({x:n,y:c,z:g})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,n){const{x:c,y:g,z:b}=f.tileID.canonical,E=new s.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:c,y:g,z:b},{signal:E.signal})).then((function(L){return delete f.request,f.aborted?(f.state="unloaded",n(null)):L===void 0?(f.state="errored",n(null)):L===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",n(null)):function(D){return D instanceof s.window.ImageData||D instanceof s.window.HTMLCanvasElement||D instanceof s.window.ImageBitmap||D instanceof s.window.HTMLImageElement}(L)?(this.loadTileData(f,L),f.state="loaded",void n(null)):(f.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(L=>{L.code!==20&&(f.state="errored",n(L))}),f.request.cancel=()=>E.abort()}loadTileData(f,n){Wt.loadTileData(f,n,this._map.painter)}unloadTileData(f){Wt.unloadTileData(f,this._map.painter)}unloadTile(f,n){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:c,y:g,z:b}=f.tileID.canonical;this._implementation.unloadTile({x:c,y:g,z:b})}n()}abortTile(f,n){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),n()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},or=function(f,n,c,g){const b=new $i[n.type](f,n,c,g);if(b.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${b.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],b),b};function ur(f,n){const c=s.identity([]);return s.scale(c,c,[.5*f.width,.5*-f.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,f.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(c)}function hn(f,n,c,g,b,E,L,D=!1){const F=f.tilesIn(g,L,D);F.sort(os);const W=[];for(const Q of F)W.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(n,c,f._state,Q,b,E,ur(f.transform,Q.tile.tileID),D)});const H=function(Q){const he={},me={};for(const ye of Q){const _e=ye.queryResults,be=ye.wrappedTileID,ee=me[be]=me[be]||{};for(const pe in _e){const Ce=_e[pe],ke=ee[pe]=ee[pe]||{},Ge=he[pe]=he[pe]||[];for(const Ne of Ce)ke[Ne.featureIndex]||(ke[Ne.featureIndex]=!0,Ge.push(Ne))}}return he}(W);for(const Q in H)H[Q].forEach(he=>{const me=he.feature,ye=me.layer;ye&&ye.type!=="background"&&ye.type!=="sky"&&(me.source=ye.source,ye["source-layer"]&&(me.sourceLayer=ye["source-layer"]),me.state=me.id!==void 0?f.getFeatureState(ye["source-layer"],me.id):{})});return H}function _n(f,n){const c=f.getRenderableIds().map(E=>f.getTileByID(E)),g=[],b={};for(let E=0;E<c.length;E++){const L=c[E],D=L.tileID.canonical.key;b[D]||(b[D]=!0,L.querySourceFeatures(g,n))}return g}function os(f,n){const c=f.tileID,g=n.tileID;return c.overscaledZ-g.overscaledZ||c.canonical.y-g.canonical.y||c.wrap-g.wrap||c.canonical.x-g.canonical.x}function jn(){return uc.workerClass!=null?new uc.workerClass:new s.window.Worker(uc.workerUrl)}const No="mapboxgl_preloaded_worker_pool";class $n{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<$n.workerCount;)this.workers.push(new jn);return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[No]}numActive(){return Object.keys(this.active).length}}let us;function En(){return us||(us=new $n),us}function Bf(f,n){const c={};for(const g in f)g!=="ref"&&(c[g]=f[g]);return s.refProperties.forEach(g=>{g in n&&(c[g]=n[g])}),c}function Ff(f){f=f.slice();const n=Object.create(null);for(let c=0;c<f.length;c++)n[f[c].id]=f[c];for(let c=0;c<f.length;c++)"ref"in f[c]&&(f[c]=Bf(f[c],n[f[c].ref]));return f}$n.workerCount=2;const wr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function td(f,n,c){c.push({command:wr.addSource,args:[f,n[f]]})}function zc(f,n,c){n.push({command:wr.removeSource,args:[f]}),c[f]=!0}function Oh(f,n,c,g){zc(f,c,g),td(f,n,c)}function Rh(f,n,c){let g;for(g in f[c])if(f[c].hasOwnProperty(g)&&g!=="data"&&!$(f[c][g],n[c][g]))return!1;for(g in n[c])if(n[c].hasOwnProperty(g)&&g!=="data"&&!$(f[c][g],n[c][g]))return!1;return!0}function yo(f,n,c,g,b,E){let L;for(L in n=n||{},f=f||{})f.hasOwnProperty(L)&&($(f[L],n[L])||c.push({command:E,args:[g,L,n[L],b]}));for(L in n)n.hasOwnProperty(L)&&!f.hasOwnProperty(L)&&($(f[L],n[L])||c.push({command:E,args:[g,L,n[L],b]}))}function Uo(f){return f.id}function id(f,n){return f[n.id]=n,f}class Bc{constructor(n,c){this.reset(n,c)}reset(n,c){this.points=n||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=s.clamp(n,0,1);let c=1,g=this._distances[c];const b=n*this.paddedLength+this.padding;for(;g<b&&c<this._distances.length;)g=this._distances[++c];const E=c-1,L=this._distances[E],D=g-L,F=D>0?(b-L)/D:0;return this.points[E].mult(1-F).add(this.points[c].mult(F))}}class Vo{constructor(n,c,g){const b=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(n/g),this.yCellCount=Math.ceil(c/g);for(let L=0;L<this.xCellCount*this.yCellCount;L++)b.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=c,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,c,g,b,E){this._forEachCell(c,g,b,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(E)}insertCircle(n,c,g,b){this._forEachCell(c-b,g-b,c+b,g+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(c),this.circles.push(g),this.circles.push(b)}_insertBoxCell(n,c,g,b,E,L){this.boxCells[E].push(L)}_insertCircleCell(n,c,g,b,E,L){this.circleCells[E].push(L)}_query(n,c,g,b,E,L){if(g<0||n>this.width||b<0||c>this.height)return!E&&[];const D=[];if(n<=0&&c<=0&&this.width<=g&&this.height<=b){if(E)return!0;for(let F=0;F<this.boxKeys.length;F++)D.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const W=this.circles[3*F],H=this.circles[3*F+1],Q=this.circles[3*F+2];D.push({key:this.circleKeys[F],x1:W-Q,y1:H-Q,x2:W+Q,y2:H+Q})}return L?D.filter(L):D}return this._forEachCell(n,c,g,b,this._queryCell,D,{hitTest:E,seenUids:{box:{},circle:{}}},L),E?D.length>0:D}_queryCircle(n,c,g,b,E){const L=n-g,D=n+g,F=c-g,W=c+g;if(D<0||L>this.width||W<0||F>this.height)return!b&&[];const H=[];return this._forEachCell(L,F,D,W,this._queryCellCircle,H,{hitTest:b,circle:{x:n,y:c,radius:g},seenUids:{box:{},circle:{}}},E),b?H.length>0:H}query(n,c,g,b,E){return this._query(n,c,g,b,!1,E)}hitTest(n,c,g,b,E){return this._query(n,c,g,b,!0,E)}hitTestCircle(n,c,g,b){return this._queryCircle(n,c,g,!0,b)}_queryCell(n,c,g,b,E,L,D,F){const W=D.seenUids,H=this.boxCells[E];if(H!==null){const he=this.bboxes;for(const me of H)if(!W.box[me]){W.box[me]=!0;const ye=4*me;if(n<=he[ye+2]&&c<=he[ye+3]&&g>=he[ye+0]&&b>=he[ye+1]&&(!F||F(this.boxKeys[me]))){if(D.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[me],x1:he[ye],y1:he[ye+1],x2:he[ye+2],y2:he[ye+3]})}}}const Q=this.circleCells[E];if(Q!==null){const he=this.circles;for(const me of Q)if(!W.circle[me]){W.circle[me]=!0;const ye=3*me;if(this._circleAndRectCollide(he[ye],he[ye+1],he[ye+2],n,c,g,b)&&(!F||F(this.circleKeys[me]))){if(D.hitTest)return L.push(!0),!0;{const _e=he[ye],be=he[ye+1],ee=he[ye+2];L.push({key:this.circleKeys[me],x1:_e-ee,y1:be-ee,x2:_e+ee,y2:be+ee})}}}}}_queryCellCircle(n,c,g,b,E,L,D,F){const W=D.circle,H=D.seenUids,Q=this.boxCells[E];if(Q!==null){const me=this.bboxes;for(const ye of Q)if(!H.box[ye]){H.box[ye]=!0;const _e=4*ye;if(this._circleAndRectCollide(W.x,W.y,W.radius,me[_e+0],me[_e+1],me[_e+2],me[_e+3])&&(!F||F(this.boxKeys[ye])))return L.push(!0),!0}}const he=this.circleCells[E];if(he!==null){const me=this.circles;for(const ye of he)if(!H.circle[ye]){H.circle[ye]=!0;const _e=3*ye;if(this._circlesCollide(me[_e],me[_e+1],me[_e+2],W.x,W.y,W.radius)&&(!F||F(this.circleKeys[ye])))return L.push(!0),!0}}}_forEachCell(n,c,g,b,E,L,D,F){const W=this._convertToXCellCoord(n),H=this._convertToYCellCoord(c),Q=this._convertToXCellCoord(g),he=this._convertToYCellCoord(b);for(let me=W;me<=Q;me++)for(let ye=H;ye<=he;ye++)if(E.call(this,n,c,g,b,this.xCellCount*ye+me,L,D,F))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,c,g,b,E,L){const D=b-n,F=E-c,W=g+L;return W*W>D*D+F*F}_circleAndRectCollide(n,c,g,b,E,L,D){const F=(L-b)/2,W=Math.abs(n-(b+F));if(W>F+g)return!1;const H=(D-E)/2,Q=Math.abs(c-(E+H));if(Q>H+g)return!1;if(W<=F||Q<=H)return!0;const he=W-F,me=Q-H;return he*he+me*me<=g*g}}const da={unknown:0,flipRequired:1,flipNotRequired:2},Vr=Math.tan(85*Math.PI/180);function Et(f,n,c,g,b,E,L){const D=s.create();if(c)if(E.name==="globe"){const F=s.calculateGlobeLabelMatrix(b,n);s.multiply(D,D,F)}else{const F=He([],L);D[0]=F[0],D[1]=F[1],D[4]=F[2],D[5]=F[3],g||s.rotateZ(D,D,b.angle)}else s.multiply(D,b.labelPlaneMatrix,f);return D}function jo(f,n,c,g,b,E,L){const D=Et(f,n,c,g,b,E,L);return E.name==="globe"&&c||(D[2]=D[6]=D[10]=D[14]=0),D}function Bn(f,n,c,g,b,E,L){if(c){if(E.name==="globe"){const D=Et(f,n,c,g,b,E,L);return s.invert(D,D),s.multiply(D,f,D),D}{const D=s.clone(f),F=s.identity([]);return F[0]=L[0],F[1]=L[1],F[4]=L[2],F[5]=L[3],s.multiply(D,D,F),g||s.rotateZ(D,D,-b.angle),D}}return b.glCoordMatrix}function Jn(f,n,c,g){const b=[f,n,c,1];c?s.transformMat4$1(b,b,g):Ki(b,b,g);const E=b[3];return b[0]/=E,b[1]/=E,b[2]/=E,b}function Nf(f,n){return Math.min(.5+f/n*.5,1.5)}function $o(f,n){const c=f[0]/f[3],g=f[1]/f[3];return c>=-n[0]&&c<=n[0]&&g>=-n[1]&&g<=n[1]}function zh(f,n,c,g,b,E,L,D,F,W){const H=c.transform,Q=g?f.textSizeData:f.iconSizeData,he=s.evaluateSizeForZoom(Q,c.transform.zoom),me=H.projection.name==="globe",ye=[256/c.width*2+1,256/c.height*2+1],_e=g?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;_e.clear();let be=null;me&&(be=g?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const ee=f.lineVertexArray,pe=g?f.text.placedSymbolArray:f.icon.placedSymbolArray,Ce=c.transform.width/c.transform.height;let ke,Ge=!1;for(let Ne=0;Ne<pe.length;Ne++){const We=pe.get(Ne),{numGlyphs:it,writingMode:et}=We;if(et!==s.WritingMode.vertical||Ge||ke===s.WritingMode.horizontal||(Ge=!0),ke=et,(We.hidden||et===s.WritingMode.vertical)&&!Ge){Ys(it,_e);continue}Ge=!1;const ft=new s.Point(We.tileAnchorX,We.tileAnchorY);let{x:Nt,y:ht,z:Mt}=H.projection.projectTilePoint(ft.x,ft.y,W.canonical);if(F){const[Fi,vi,Pi]=F(ft);Nt+=Fi,ht+=vi,Mt+=Pi}const _t=[Nt,ht,Mt,1];if(s.transformMat4$1(_t,_t,n),!$o(_t,ye)){Ys(it,_e);continue}const Vt=Nf(c.transform.cameraToCenterDistance,_t[3]),lt=s.evaluateSizeForFeature(Q,he,We),kt=L?lt/Vt:lt*Vt,jt=Jn(Nt,ht,Mt,b);if(jt[3]<=0){Ys(it,_e);continue}let Ct={};const Ht=L?null:F,Ii=li(We,kt,!1,D,n,b,E,f.glyphOffsetArray,ee,_e,be,jt,ft,Ct,Ce,Ht,H.projection,W,L);Ge=Ii.useVertical,Ht&&Ii.needsFlipping&&(Ct={}),(Ii.notEnoughRoom||Ge||Ii.needsFlipping&&li(We,kt,!0,D,n,b,E,f.glyphOffsetArray,ee,_e,be,jt,ft,Ct,Ce,Ht,H.projection,W,L).notEnoughRoom)&&Ys(it,_e)}g?(f.text.dynamicLayoutVertexBuffer.updateData(_e),be&&f.text.globeExtVertexBuffer.updateData(be)):(f.icon.dynamicLayoutVertexBuffer.updateData(_e),be&&f.icon.globeExtVertexBuffer.updateData(be))}function Uf(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e){const{lineStartIndex:be,glyphStartIndex:ee,segment:pe}=D,Ce=ee+D.numGlyphs,ke=be+D.lineLength,Ge=n.getoffsetX(ee),Ne=n.getoffsetX(Ce-1),We=Ps(f*Ge,c,g,b,E,L,pe,be,ke,F,W,H,Q,he,!0,me,ye,_e);if(!We)return null;const it=Ps(f*Ne,c,g,b,E,L,pe,be,ke,F,W,H,Q,he,!0,me,ye,_e);return it?{first:We,last:it}:null}function Gl(f,n,c,g){return f===s.WritingMode.horizontal&&Math.abs(g)>Math.abs(c)?{useVertical:!0}:f===s.WritingMode.vertical?g>0?{needsFlipping:!0}:null:n!==da.unknown&&function(b,E){return b===0||Math.abs(E/b)>Vr}(c,g)?n===da.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function li(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be,ee,pe){const Ce=n/24,ke=f.lineOffsetX*Ce,Ge=f.lineOffsetY*Ce,{lineStartIndex:Ne,glyphStartIndex:We,numGlyphs:it,segment:et,writingMode:ft,flipState:Nt}=f,ht=Ne+f.lineLength,Mt=_t=>{if(H){const[jt,Ct,Ht]=_t.up,Ii=W.length;s.updateGlobeVertexNormal(H,Ii+0,jt,Ct,Ht),s.updateGlobeVertexNormal(H,Ii+1,jt,Ct,Ht),s.updateGlobeVertexNormal(H,Ii+2,jt,Ct,Ht),s.updateGlobeVertexNormal(H,Ii+3,jt,Ct,Ht)}const[Vt,lt,kt]=_t.point;s.addDynamicAttributes(W,Vt,lt,kt,_t.angle)};if(it>1){const _t=Uf(Ce,D,ke,Ge,c,Q,he,f,F,E,me,_e,!1,be,ee,pe);if(!_t)return{notEnoughRoom:!0};if(g&&!c){let[Vt,lt,kt]=_t.first.point,[jt,Ct,Ht]=_t.last.point;[Vt,lt]=Jn(Vt,lt,kt,L),[jt,Ct]=Jn(jt,Ct,Ht,L);const Ii=Gl(ft,Nt,(jt-Vt)*ye,Ct-lt);if(f.flipState=Ii&&Ii.needsFlipping?da.flipRequired:da.flipNotRequired,Ii)return Ii}Mt(_t.first);for(let Vt=We+1;Vt<We+it-1;Vt++){const lt=Ps(Ce*D.getoffsetX(Vt),ke,Ge,c,Q,he,et,Ne,ht,F,E,me,_e,!1,!1,be,ee,pe);if(!lt)return W.length-=4*(Vt-We),{notEnoughRoom:!0};Mt(lt)}Mt(_t.last)}else{if(g&&!c){const Vt=Jn(he.x,he.y,0,b),lt=Ne+et+1,kt=new s.Point(F.getx(lt),F.gety(lt)),jt=Jn(kt.x,kt.y,0,b),Ct=jt[3]>0?jt:Yi(he,kt,Vt,1,b,void 0,be,ee.canonical),Ht=Gl(ft,Nt,(Ct[0]-Vt[0])*ye,Ct[1]-Vt[1]);if(f.flipState=Ht&&Ht.needsFlipping?da.flipRequired:da.flipNotRequired,Ht)return Ht}const _t=Ps(Ce*D.getoffsetX(We),ke,Ge,c,Q,he,et,Ne,ht,F,E,me,_e,!1,!1,be,ee,pe);if(!_t)return{notEnoughRoom:!0};Mt(_t)}return{}}function cr(f,n,c,g,b){const{x:E,y:L,z:D}=g.projectTilePoint(f.x,f.y,n);if(!b)return Jn(E,L,D,c);const[F,W,H]=b(f);return Jn(E+F,L+W,D+H,c)}function Yi(f,n,c,g,b,E,L,D){const F=cr(f.sub(n)._unit()._add(f),D,b,L,E);return s.sub(F,c,F),s.normalize(F,F),s.scaleAndAdd(F,c,F,g)}function Ps(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be,ee){const pe=g?f-n:f+n;let Ce=pe>0?1:-1,ke=0;g&&(Ce*=-1,ke=Math.PI),Ce<0&&(ke+=Math.PI);let Ge=D+L+(Ce>0?0:1)|0,Ne=b,We=b,it=0,et=0;const ft=Math.abs(pe),Nt=[],ht=[];let Mt=E,_t=Mt;const Vt=()=>Yi(_t,Mt,We,ft-it+1,H,he,_e,be.canonical);for(;it+et<=ft;){if(Ge+=Ce,Ge<D||Ge>=F)return null;if(We=Ne,_t=Mt,Nt.push(We),me&&ht.push(_t),Mt=new s.Point(W.getx(Ge),W.gety(Ge)),Ne=Q[Ge],!Ne){const Pi=cr(Mt,be.canonical,H,_e,he);Ne=Pi[3]>0?Q[Ge]=Pi:Vt()}it+=et,et=s.distance(We,Ne)}ye&&he&&(Q[Ge]&&(Ne=Vt(),et=s.distance(We,Ne)),Q[Ge]=Ne);const lt=(ft-it)/et,kt=Mt.sub(_t)._mult(lt)._add(_t),jt=s.sub([],Ne,We),Ct=s.scaleAndAdd([],We,jt,lt);let Ht=[0,0,1],Ii=jt[0],Fi=jt[1];if(ee&&(Ht=_e.upVector(be.canonical,kt.x,kt.y),Ht[0]!==0||Ht[1]!==0||Ht[2]!==1)){const Pi=[Ht[2],0,-Ht[0]],Gi=s.cross([],Ht,Pi);s.normalize(Pi,Pi),s.normalize(Gi,Gi),Ii=s.dot(jt,Pi),Fi=s.dot(jt,Gi)}if(c){const Pi=s.cross([],Ht,jt);s.normalize(Pi,Pi),s.scaleAndAdd(Ct,Ct,Pi,c*Ce)}const vi=ke+Math.atan2(Fi,Ii);return Nt.push(Ct),me&&ht.push(kt),{point:Ct,angle:vi,path:Nt,tilePath:ht,up:Ht}}function Ys(f,n){const c=n.length,g=c+4*f;n.resize(g),n.float32.fill(-1/0,4*c,4*g)}function Ki(f,n,c){const g=n[0],b=n[1];return f[0]=c[0]*g+c[4]*b+c[12],f[1]=c[1]*g+c[5]*b+c[13],f[3]=c[3]*g+c[7]*b+c[15],f}const Ls=100;class ds{constructor(n,c,g=new Vo(n.width+200,n.height+200,25),b=new Vo(n.width+200,n.height+200,25)){this.transform=n,this.grid=g,this.ignoredGrid=b,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Ls,this.screenBottomBoundary=n.height+Ls,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=c}placeCollisionBox(n,c,g,b,E,L,D,F){let W=g.projectedAnchorX,H=g.projectedAnchorY,Q=g.projectedAnchorZ;const he=g.elevation,me=g.tileID,ye=n.getProjection();if(he&&me){const[Ne,We,it]=ye.upVector(me.canonical,g.tileAnchorX,g.tileAnchorY),et=ye.upVectorScale(me.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=Ne*he*et,H+=We*he*et,Q+=it*he*et}const _e=this.projectAndGetPerspectiveRatio(D,W,H,Q,g.tileID,ye.name==="globe"||!!he||this.transform.pitch>0,ye),be=L*_e.perspectiveRatio,ee=(g.x1*c+b.x-g.padding)*be+_e.point.x,pe=(g.y1*c+b.y-g.padding)*be+_e.point.y,Ce=(g.x2*c+b.x+g.padding)*be+_e.point.x,ke=(g.y2*c+b.y+g.padding)*be+_e.point.y,Ge=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(ee,pe,Ce,ke)||!E&&this.grid.hitTest(ee,pe,Ce,ke,F)||Ge?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[ee,pe,Ce,ke],offscreen:this.isOffscreen(ee,pe,Ce,ke),occluded:!1}}placeCollisionCircles(n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e){const be=[],ee=this.transform.elevation,pe=n.getProjection(),Ce=ee?ee.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,pe):null,ke=new s.Point(g.tileAnchorX,g.tileAnchorY);let{x:Ge,y:Ne,z:We}=pe.projectTilePoint(ke.x,ke.y,_e.canonical);if(Ce){const[kt,jt,Ct]=Ce(ke);Ge+=kt,Ne+=jt,We+=Ct}const it=pe.name==="globe",et=this.projectAndGetPerspectiveRatio(D,Ge,Ne,We,_e,it||!!ee||this.transform.pitch>0,pe),{perspectiveRatio:ft}=et,Nt=(Q?L/ft:L*ft)/s.ONE_EM,ht=Jn(Ge,Ne,We,F),Mt=et.signedDistanceFromCamera>0?Uf(Nt,E,g.lineOffsetX*Nt,g.lineOffsetY*Nt,!1,ht,ke,g,b,F,{},ee&&!Q?Ce:null,Q&&!!ee,pe,_e,Q):null;let _t=!1,Vt=!1,lt=!0;if(Mt&&!et.occluded){const kt=.5*me*ft+ye,jt=new s.Point(-100,-100),Ct=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),Ht=new Bc,{first:Ii,last:Fi}=Mt,vi=Ii.path.length;let Pi=[];for(let Ci=vi-1;Ci>=1;Ci--)Pi.push(Ii.path[Ci]);for(let Ci=1;Ci<Fi.path.length;Ci++)Pi.push(Fi.path[Ci]);const Gi=2.5*kt;W&&(Pi=Pi.map(([Ci,Ar,Lr],Dr)=>(Ce&&!it&&(Lr=Ce(Dr<vi-1?Ii.tilePath[vi-1-Dr]:Fi.tilePath[Dr-vi+2])[2]),Jn(Ci,Ar,Lr,W))),Pi.some(Ci=>Ci[3]<=0)&&(Pi=[]));let Wi=[];if(Pi.length>0){let Ci=1/0,Ar=-1/0,Lr=1/0,Dr=-1/0;for(const Or of Pi)Ci=Math.min(Ci,Or[0]),Lr=Math.min(Lr,Or[1]),Ar=Math.max(Ar,Or[0]),Dr=Math.max(Dr,Or[1]);Ar>=jt.x&&Ci<=Ct.x&&Dr>=jt.y&&Lr<=Ct.y&&(Wi=[Pi.map(Or=>new s.Point(Or[0],Or[1]))],(Ci<jt.x||Ar>Ct.x||Lr<jt.y||Dr>Ct.y)&&(Wi=s.clipLine(Wi,jt.x,jt.y,Ct.x,Ct.y)))}for(const Ci of Wi){Ht.reset(Ci,.25*kt);let Ar=0;Ar=Ht.length<=.5*kt?1:Math.ceil(Ht.paddedLength/Gi)+1;for(let Lr=0;Lr<Ar;Lr++){const Dr=Lr/Math.max(Ar-1,1),Or=Ht.lerp(Dr),gs=Or.x+Ls,is=Or.y+Ls;be.push(gs,is,kt,0);const ro=gs-kt,kr=is-kt,Zr=gs+kt,Ur=is+kt;if(lt=lt&&this.isOffscreen(ro,kr,Zr,Ur),Vt=Vt||this.isInsideGrid(ro,kr,Zr,Ur),!c&&this.grid.hitTestCircle(gs,is,kt,he)&&(_t=!0,!H))return{circles:[],offscreen:!1,collisionDetected:_t,occluded:!1}}}}return{circles:!H&&_t||!Vt?[]:be,offscreen:lt,collisionDetected:_t,occluded:et.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let g=1/0,b=1/0,E=-1/0,L=-1/0;for(const H of n){const Q=new s.Point(H.x+Ls,H.y+Ls);g=Math.min(g,Q.x),b=Math.min(b,Q.y),E=Math.max(E,Q.x),L=Math.max(L,Q.y),c.push(Q)}const D=this.grid.query(g,b,E,L).concat(this.ignoredGrid.query(g,b,E,L)),F={},W={};for(const H of D){const Q=H.key;if(F[Q.bucketInstanceId]===void 0&&(F[Q.bucketInstanceId]={}),F[Q.bucketInstanceId][Q.featureIndex])continue;const he=[new s.Point(H.x1,H.y1),new s.Point(H.x2,H.y1),new s.Point(H.x2,H.y2),new s.Point(H.x1,H.y2)];s.polygonIntersectsPolygon(c,he)&&(F[Q.bucketInstanceId][Q.featureIndex]=!0,W[Q.bucketInstanceId]===void 0&&(W[Q.bucketInstanceId]=[]),W[Q.bucketInstanceId].push(Q.featureIndex))}return W}insertCollisionBox(n,c,g,b,E){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:b,collisionGroupID:E},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,c,g,b,E){const L=c?this.ignoredGrid:this.grid,D={bucketInstanceId:g,featureIndex:b,collisionGroupID:E};for(let F=0;F<n.length;F+=4)L.insertCircle(D,n[F],n[F+1],n[F+2])}projectAndGetPerspectiveRatio(n,c,g,b,E,L,D){const F=[c,g,b,1];let W=!1;b||this.transform.pitch>0?(s.transformMat4$1(F,F,n),this.fogState&&E&&D.name!=="globe"&&(W=function(he,me,ye,_e,be,ee){const pe=ee.calculateFogTileMatrix(be),Ce=[me,ye,_e];return s.transformMat4(Ce,Ce,pe),ai(he,Ce,ee.pitch,ee._fov)}(this.fogState,c,g,b,E.toUnwrapped(),this.transform)>.9)):Ki(F,F,n);const H=F[3];return{point:new s.Point((F[0]/H+1)/2*this.transform.width+Ls,(-F[1]/H+1)/2*this.transform.height+Ls),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/H*.5,1.5),signedDistanceFromCamera:H,occluded:L&&F[2]>H||W}}isOffscreen(n,c,g,b){return g<Ls||n>=this.screenRightBoundary||b<Ls||c>this.screenBottomBoundary}isInsideGrid(n,c,g,b){return g>=0&&n<this.gridRightBoundary&&b>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const n=s.identity([]);return s.translate(n,n,[-100,-100,0]),n}}function xo(f,n,c){const g=n.createTileMatrix(f,f.worldSize,c.toUnwrapped());return s.multiply(new Float32Array(16),f.projMatrix,g)}function Ks(f,n,c){if(n.projection.name===c.projection.name)return f.projMatrix;const g=c.clone();return g.setProjection(n.projection),xo(g,n.getProjection(),f)}function sn(f,n,c){return n.name===c.projection.name?f.projMatrix:xo(c,n,f)}class Vf{constructor(n,c,g,b){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?c:-c))):b&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class vo{constructor(n,c,g,b,E,L=!1){this.text=new Vf(n?n.text:null,c,g,E),this.icon=new Vf(n?n.icon:null,c,b,E),this.clipped=L}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Na{constructor(n,c,g,b=!1){this.text=n,this.icon=c,this.skipFade=g,this.clipped=b}}class Fc{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class rd{constructor(n,c,g,b,E){this.bucketInstanceId=n,this.featureIndex=c,this.sourceLayerIndex=g,this.bucketIndex=b,this.tileID=E}}class nd{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const c=++this.maxGroupID;this.collisionGroups[n]={ID:c,predicate:g=>g.collisionGroupID===c}}return this.collisionGroups[n]}}function Wl(f,n,c,g,b){const{horizontalAlign:E,verticalAlign:L}=s.getAnchorAlignment(f),D=-(E-.5)*n,F=-(L-.5)*c,W=s.evaluateVariableOffset(f,g);return new s.Point(D+W[0]*b,F+W[1]*b)}function Go(f,n,c,g,b){const E=new s.Point(f,n);return c&&E._rotate(g?b:-b),E}class Bh{constructor(n,c,g,b,E){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new ds(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new nd(g),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,c,g,b){const E=g.getBucket(c),L=g.latestFeatureIndex;if(!E||!L||c.id!==E.layerIds[0])return;const D=E.layers[0].layout,F=g.collisionBoxArray,W=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),H=g.tileSize/s.EXTENT,Q=g.tileID.toUnwrapped();this.transform.setProjection(E.projection);const he=(me=g.tileID,ye=E.getProjection(),_e=this.transform,ye.name===this.projection?_e.calculateProjMatrix(me.toUnwrapped()):xo(_e,ye,me));var me,ye,_e;const be=D.get("text-pitch-alignment")==="map",ee=D.get("text-rotation-alignment")==="map";c.compileFilter();const pe=c.dynamicFilter(),Ce=c.dynamicFilterNeedsFeature(),ke=this.transform.calculatePixelsToTileUnitsMatrix(g),Ge=jo(he,g.tileID.canonical,be,ee,this.transform,E.getProjection(),ke);let Ne=null;if(be){const et=Bn(he,g.tileID.canonical,be,ee,this.transform,E.getProjection(),ke);Ne=s.multiply([],this.transform.labelPlaneMatrix,et)}let We=null;pe&&g.latestFeatureIndex&&(We={unwrappedTileID:Q,dynamicFilter:pe,dynamicFilterNeedsFeature:Ce,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new rd(E.bucketInstanceId,L,E.sourceLayerIndex,E.index,g.tileID);const it={bucket:E,layout:D,posMatrix:he,textLabelPlaneMatrix:Ge,labelToScreenMatrix:Ne,clippingData:We,scale:W,textPixelRatio:H,holdingForFade:g.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(b)for(const et of E.sortKeyRanges){const{sortKey:ft,symbolInstanceStart:Nt,symbolInstanceEnd:ht}=et;n.push({sortKey:ft,symbolInstanceStart:Nt,symbolInstanceEnd:ht,parameters:it})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:it})}attemptAnchorPlacement(n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be,ee,pe){const{textOffset0:Ce,textOffset1:ke,crossTileID:Ge}=he,Ne=[Ce,ke],We=Wl(n,g,b,Ne,E),it=this.collisionIndex.placeCollisionBox(ye,E,c,Go(We.x,We.y,L,D,this.transform.angle),Q,F,W,H.predicate);if(be){const et=ye.getSymbolInstanceIconSize(pe,this.transform.zoom,he.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ye,et,be,Go(We.x,We.y,L,D,this.transform.angle),Q,F,W,H.predicate).box.length===0)return}if(it.box.length>0){let et;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ge]&&this.prevPlacement.placements[Ge]&&this.prevPlacement.placements[Ge].text&&(et=this.prevPlacement.variableOffsets[Ge].anchor),this.variableOffsets[Ge]={textOffset:Ne,width:g,height:b,anchor:n,textScale:E,prevAnchor:et},this.markUsedJustification(ye,n,he,_e),ye.allowVerticalPlacement&&(this.markUsedOrientation(ye,_e,he),this.placedOrientations[Ge]=_e),{shift:We,placedGlyphBoxes:it}}}placeLayerBucketPart(n,c,g,b){const{bucket:E,layout:L,posMatrix:D,textLabelPlaneMatrix:F,labelToScreenMatrix:W,clippingData:H,textPixelRatio:Q,holdingForFade:he,collisionBoxArray:me,partiallyEvaluatedTextSize:ye,partiallyEvaluatedIconSize:_e,collisionGroup:be}=n.parameters,ee=L.get("text-optional"),pe=L.get("icon-optional"),Ce=L.get("text-allow-overlap"),ke=L.get("icon-allow-overlap"),Ge=L.get("text-rotation-alignment")==="map",Ne=L.get("text-pitch-alignment")==="map",We=L.get("icon-text-fit")!=="none",it=L.get("symbol-z-order")==="viewport-y";this.transform.setProjection(E.projection);let et=Ce&&(ke||!E.hasIconData()||pe),ft=ke&&(Ce||!E.hasTextData()||ee);!E.collisionArrays&&me&&E.deserializeCollisionBoxes(me),g&&b&&E.updateCollisionDebugBuffers(this.transform.zoom,me);const Nt=(ht,Mt,_t)=>{const{crossTileID:Vt,numVerticalGlyphVertices:lt}=ht;if(H){const Zr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ur=null;if(H.dynamicFilterNeedsFeature){const mr=this.retainedQueryData[E.bucketInstanceId];Ur=H.featureIndex.loadFeature({featureIndex:ht.featureIndex,bucketIndex:mr.bucketIndex,sourceLayerIndex:mr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,H.dynamicFilter)(Zr,Ur,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new s.Point(ht.tileAnchorX,ht.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[Vt]=new Na(!1,!1,!1,!0),void c.add(Vt)}if(c.has(Vt))return;if(he)return void(this.placements[Vt]=new Na(!1,!1,!1));let kt=!1,jt=!1,Ct=!0,Ht=!1,Ii=!1,Fi=null,vi={box:null,offscreen:null,occluded:null},Pi={box:null},Gi=null,Wi=null,Ci=null,Ar=0,Lr=0,Dr=0;_t.textFeatureIndex?Ar=_t.textFeatureIndex:ht.useRuntimeCollisionCircles&&(Ar=ht.featureIndex),_t.verticalTextFeatureIndex&&(Lr=_t.verticalTextFeatureIndex);const Or=Zr=>{Zr.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Ur=this.transform.elevation;(Ur||Zr.elevation)&&(Zr.elevation=Ur?Ur.getAtTileOffset(Zr.tileID,Zr.tileAnchorX,Zr.tileAnchorY):0)},gs=_t.textBox;if(gs){Or(gs);const Zr=mr=>{let Fn=s.WritingMode.horizontal;if(E.allowVerticalPlacement&&!mr&&this.prevPlacement){const Es=this.prevPlacement.placedOrientations[Vt];Es&&(this.placedOrientations[Vt]=Es,Fn=Es,this.markUsedOrientation(E,Fn,ht))}return Fn},Ur=(mr,Fn)=>{if(E.allowVerticalPlacement&&lt>0&&_t.verticalTextBox){for(const Es of E.writingModes)if(Es===s.WritingMode.vertical?(vi=Fn(),Pi=vi):vi=mr(),vi&&vi.box&&vi.box.length)break}else vi=mr()};if(L.get("text-variable-anchor")){let mr=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Vt]){const Yr=this.prevPlacement.variableOffsets[Vt];mr.indexOf(Yr.anchor)>0&&(mr=mr.filter(Wn=>Wn!==Yr.anchor),mr.unshift(Yr.anchor))}const Fn=(Yr,Wn,hu)=>{const Ta=E.getSymbolInstanceTextSize(ye,ht,this.transform.zoom,Mt),dc=(Yr.x2-Yr.x1)*Ta+2*Yr.padding,Yo=(Yr.y2-Yr.y1)*Ta+2*Yr.padding,Ea=We&&!ke?Wn:null;Ea&&Or(Ea);let wl={box:[],offscreen:!1,occluded:!1};const vn=Ce?2*mr.length:mr.length;for(let ah=0;ah<vn;++ah){const Rd=this.attemptAnchorPlacement(mr[ah%mr.length],Yr,dc,Yo,Ta,Ge,Ne,Q,D,be,ah>=mr.length,ht,Mt,E,hu,Ea,ye,_e);if(Rd&&(wl=Rd.placedGlyphBoxes,wl&&wl.box&&wl.box.length)){kt=!0,Fi=Rd.shift;break}}return wl};Ur(()=>Fn(gs,_t.iconBox,s.WritingMode.horizontal),()=>{const Yr=_t.verticalTextBox;return Yr&&Or(Yr),E.allowVerticalPlacement&&!(vi&&vi.box&&vi.box.length)&&lt>0&&Yr?Fn(Yr,_t.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),vi&&(kt=vi.box,Ct=vi.offscreen,Ht=vi.occluded);const Es=Zr(!(!vi||!vi.box));if(!kt&&this.prevPlacement){const Yr=this.prevPlacement.variableOffsets[Vt];Yr&&(this.variableOffsets[Vt]=Yr,this.markUsedJustification(E,Yr.anchor,ht,Es))}}else{const mr=(Fn,Es)=>{const Yr=E.getSymbolInstanceTextSize(ye,ht,this.transform.zoom,Mt),Wn=this.collisionIndex.placeCollisionBox(E,Yr,Fn,new s.Point(0,0),Ce,Q,D,be.predicate);return Wn&&Wn.box&&Wn.box.length&&(this.markUsedOrientation(E,Es,ht),this.placedOrientations[Vt]=Es),Wn};Ur(()=>mr(gs,s.WritingMode.horizontal),()=>{const Fn=_t.verticalTextBox;return E.allowVerticalPlacement&&lt>0&&Fn?(Or(Fn),mr(Fn,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Zr(!!(vi&&vi.box&&vi.box.length))}}if(Gi=vi,kt=Gi&&Gi.box&&Gi.box.length>0,Ct=Gi&&Gi.offscreen,Ht=Gi&&Gi.occluded,ht.useRuntimeCollisionCircles){const Zr=E.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex>=0?ht.centerJustifiedTextSymbolIndex:ht.verticalPlacedTextSymbolIndex),Ur=s.evaluateSizeForFeature(E.textSizeData,ye,Zr),mr=L.get("text-padding");Wi=this.collisionIndex.placeCollisionCircles(E,Ce,Zr,E.lineVertexArray,E.glyphOffsetArray,Ur,D,F,W,g,Ne,be.predicate,ht.collisionCircleDiameter*Ur/s.ONE_EM,mr,this.retainedQueryData[E.bucketInstanceId].tileID),kt=Ce||Wi.circles.length>0&&!Wi.collisionDetected,Ct=Ct&&Wi.offscreen,Ht=Wi.occluded}if(_t.iconFeatureIndex&&(Dr=_t.iconFeatureIndex),_t.iconBox){const Zr=Ur=>{Or(Ur);const mr=We&&Fi?Go(Fi.x,Fi.y,Ge,Ne,this.transform.angle):new s.Point(0,0),Fn=E.getSymbolInstanceIconSize(_e,this.transform.zoom,ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Fn,Ur,mr,ke,Q,D,be.predicate)};Pi&&Pi.box&&Pi.box.length&&_t.verticalIconBox?(Ci=Zr(_t.verticalIconBox),jt=Ci.box.length>0):(Ci=Zr(_t.iconBox),jt=Ci.box.length>0),Ct=Ct&&Ci.offscreen,Ii=Ci.occluded}const is=ee||ht.numHorizontalGlyphVertices===0&&lt===0,ro=pe||ht.numIconVertices===0;if(is||ro?ro?is||(jt=jt&&kt):kt=jt&&kt:jt=kt=jt&&kt,kt&&Gi&&Gi.box&&this.collisionIndex.insertCollisionBox(Gi.box,L.get("text-ignore-placement"),E.bucketInstanceId,Pi&&Pi.box&&Lr?Lr:Ar,be.ID),jt&&Ci&&this.collisionIndex.insertCollisionBox(Ci.box,L.get("icon-ignore-placement"),E.bucketInstanceId,Dr,be.ID),Wi&&(kt&&this.collisionIndex.insertCollisionCircles(Wi.circles,L.get("text-ignore-placement"),E.bucketInstanceId,Ar,be.ID),g)){const Zr=E.bucketInstanceId;let Ur=this.collisionCircleArrays[Zr];Ur===void 0&&(Ur=this.collisionCircleArrays[Zr]=new Fc);for(let mr=0;mr<Wi.circles.length;mr+=4)Ur.circles.push(Wi.circles[mr+0]),Ur.circles.push(Wi.circles[mr+1]),Ur.circles.push(Wi.circles[mr+2]),Ur.circles.push(Wi.collisionDetected?1:0)}const kr=E.projection.name!=="globe";et=et&&(kr||!Ht),ft=ft&&(kr||!Ii),this.placements[Vt]=new Na(kt||et,jt||ft,Ct||E.justReloaded),c.add(Vt)};if(it){const ht=E.getSortedSymbolIndexes(this.transform.angle);for(let Mt=ht.length-1;Mt>=0;--Mt){const _t=ht[Mt];Nt(E.symbolInstances.get(_t),_t,E.collisionArrays[_t])}}else for(let ht=n.symbolInstanceStart;ht<n.symbolInstanceEnd;ht++)Nt(E.symbolInstances.get(ht),ht,E.collisionArrays[ht]);if(g&&E.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[E.bucketInstanceId];s.invert(ht.invProjMatrix,D),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(n,c,g,b){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:F,crossTileID:W}=g,H=s.getAnchorJustification(c),Q=b===s.WritingMode.vertical?F:H==="left"?E:H==="center"?L:H==="right"?D:-1;E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=Q>=0&&E!==Q?0:W),L>=0&&(n.text.placedSymbolArray.get(L).crossTileID=Q>=0&&L!==Q?0:W),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=Q>=0&&D!==Q?0:W),F>=0&&(n.text.placedSymbolArray.get(F).crossTileID=Q>=0&&F!==Q?0:W)}markUsedOrientation(n,c,g){const b=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,E=c===s.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:W}=g,H=n.text.placedSymbolArray;L>=0&&(H.get(L).placedOrientation=b),D>=0&&(H.get(D).placedOrientation=b),F>=0&&(H.get(F).placedOrientation=b),W>=0&&(H.get(W).placedOrientation=E)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let g=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const b=c?c.symbolFadeChange(n):1,E=c?c.opacities:{},L=c?c.variableOffsets:{},D=c?c.placedOrientations:{};for(const F in this.placements){const W=this.placements[F],H=E[F];H?(this.opacities[F]=new vo(H,b,W.text,W.icon,null,W.clipped),g=g||W.text!==H.text.placed||W.icon!==H.icon.placed):(this.opacities[F]=new vo(null,b,W.text,W.icon,W.skipFade,W.clipped),g=g||W.text||W.icon)}for(const F in E){const W=E[F];if(!this.opacities[F]){const H=new vo(W,b,!1,!1);H.isHidden()||(this.opacities[F]=H,g=g||W.text.placed||W.icon.placed)}}for(const F in L)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=L[F]);for(const F in D)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=D[F]);g?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:n)}updateLayerOpacities(n,c){const g=new Set;for(const b of c){const E=b.getBucket(n);E&&b.latestFeatureIndex&&n.id===E.layerIds[0]&&this.updateBucketOpacities(E,g,b.collisionBoxArray)}}updateBucketOpacities(n,c,g){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const b=n.layers[0].layout,E=!!n.layers[0].dynamicFilter(),L=new vo(null,0,!1,!1,!0),D=b.get("text-allow-overlap"),F=b.get("icon-allow-overlap"),W=b.get("text-variable-anchor"),H=b.get("text-rotation-alignment")==="map",Q=b.get("text-pitch-alignment")==="map",he=b.get("icon-text-fit")!=="none",me=new vo(null,0,D&&(F||!n.hasIconData()||b.get("icon-optional")),F&&(D||!n.hasTextData()||b.get("text-optional")),!0);!n.collisionArrays&&g&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(g);const ye=(be,ee,pe)=>{for(let Ce=0;Ce<ee/4;Ce++)be.opacityVertexArray.emplaceBack(pe)};let _e=0;for(let be=0;be<n.symbolInstances.length;be++){const ee=n.symbolInstances.get(be),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:Ce,crossTileID:ke,numIconVertices:Ge}=ee,Ne=c.has(ke);let We=this.opacities[ke];Ne?We=L:We||(We=me,this.opacities[ke]=We),c.add(ke);const it=pe>0||Ce>0,et=Ge>0,ft=this.placedOrientations[ke],Nt=ft===s.WritingMode.vertical,ht=ft===s.WritingMode.horizontal||ft===s.WritingMode.horizontalOnly;if(!it&&!et||We.isHidden()||_e++,it){const Mt=Rs(We.text);ye(n.text,pe,Nt?yn:Mt),ye(n.text,Ce,ht?yn:Mt);const _t=We.text.isHidden(),{leftJustifiedTextSymbolIndex:Vt,centerJustifiedTextSymbolIndex:lt,rightJustifiedTextSymbolIndex:kt,verticalPlacedTextSymbolIndex:jt}=ee,Ct=n.text.placedSymbolArray,Ht=_t||Nt?1:0;Vt>=0&&(Ct.get(Vt).hidden=Ht),lt>=0&&(Ct.get(lt).hidden=Ht),kt>=0&&(Ct.get(kt).hidden=Ht),jt>=0&&(Ct.get(jt).hidden=_t||ht?1:0);const Ii=this.variableOffsets[ke];Ii&&this.markUsedJustification(n,Ii.anchor,ee,ft);const Fi=this.placedOrientations[ke];Fi&&(this.markUsedJustification(n,"left",ee,Fi),this.markUsedOrientation(n,Fi,ee))}if(et){const Mt=Rs(We.icon),{placedIconSymbolIndex:_t,verticalPlacedIconSymbolIndex:Vt}=ee,lt=n.icon.placedSymbolArray,kt=We.icon.isHidden()?1:0;_t>=0&&(ye(n.icon,Ge,Nt?yn:Mt),lt.get(_t).hidden=kt),Vt>=0&&(ye(n.icon,ee.numVerticalIconVertices,ht?yn:Mt),lt.get(Vt).hidden=kt)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Mt=n.collisionArrays[be];if(Mt){let _t=new s.Point(0,0),Vt=!0;if(Mt.textBox||Mt.verticalTextBox){if(W){const kt=this.variableOffsets[ke];kt?(_t=Wl(kt.anchor,kt.width,kt.height,kt.textOffset,kt.textScale),H&&_t._rotate(Q?this.transform.angle:-this.transform.angle)):Vt=!1}E&&(Vt=!We.clipped),Mt.textBox&&fa(n.textCollisionBox.collisionVertexArray,We.text.placed,!Vt||Nt,_t.x,_t.y),Mt.verticalTextBox&&fa(n.textCollisionBox.collisionVertexArray,We.text.placed,!Vt||ht,_t.x,_t.y)}const lt=Vt&&!!(!ht&&Mt.verticalIconBox);Mt.iconBox&&fa(n.iconCollisionBox.collisionVertexArray,We.icon.placed,lt,he?_t.x:0,he?_t.y:0),Mt.verticalIconBox&&fa(n.iconCollisionBox.collisionVertexArray,We.icon.placed,!lt,he?_t.x:0,he?_t.y:0)}}}if(n.fullyClipped=_e===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const be=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=be.invProjMatrix,n.placementViewportMatrix=be.viewportMatrix,n.collisionCircleArray=be.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,c){const g=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*g>n}setStale(){this.stale=!0}}function fa(f,n,c,g,b){f.emplaceBack(n?1:0,c?1:0,g||0,b||0),f.emplaceBack(n?1:0,c?1:0,g||0,b||0),f.emplaceBack(n?1:0,c?1:0,g||0,b||0),f.emplaceBack(n?1:0,c?1:0,g||0,b||0)}const Ds=Math.pow(2,25),Sn=Math.pow(2,24),sd=Math.pow(2,17),Nc=Math.pow(2,16),Os=Math.pow(2,9),Ts=Math.pow(2,8),od=Math.pow(2,1);function Rs(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const n=f.placed?1:0,c=Math.floor(127*f.opacity);return c*Ds+n*Sn+c*sd+n*Nc+c*Os+n*Ts+c*od+n}const yn=0;class pa{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,c,g,b,E){const L=this._bucketParts;for(;this._currentTileIndex<n.length;)if(c.getBucketParts(L,b,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((D,F)=>D.sortKey-F.sortKey));this._currentPartIndex<L.length;){const D=L[this._currentPartIndex];if(c.placeLayerBucketPart(D,this._seenCrossTileIDs,g,D.symbolInstanceStart===0),this._currentPartIndex++,E())return!0}return!1}}class Uc{constructor(n,c,g,b,E,L,D,F){this.placement=new Bh(n,E,L,D,F),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(n,c,g){const b=s.exported.now(),E=()=>{const L=s.exported.now()-b;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=c[n[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=D)&&(!L.maxzoom||L.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new pa(L)),this._inProgressLayer.continuePlacement(g[L.source],this.placement,this._showCollisionBoxes,L,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const ma=512/s.EXTENT/2;class Qn{constructor(n,c,g){this.tileID=n,this.bucketInstanceId=g,this.index=new s.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=n.canonical.x*s.EXTENT,E=n.canonical.y*s.EXTENT;for(let L=0;L<c.length;L++){const{key:D,crossTileID:F,tileAnchorX:W,tileAnchorY:H}=c.get(L),Q=Math.floor((b+W)*ma),he=Math.floor((E+H)*ma);this.index.add(Q,he),this.keys.push(D),this.crossTileIDs.push(F)}this.index.finish()}findMatches(n,c,g){const b=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),E=ma/Math.pow(2,c.canonical.z-this.tileID.canonical.z),L=c.canonical.x*s.EXTENT,D=c.canonical.y*s.EXTENT;for(let F=0;F<n.length;F++){const W=n.get(F);if(W.crossTileID)continue;const{key:H,tileAnchorX:Q,tileAnchorY:he}=W,me=Math.floor((L+Q)*E),ye=Math.floor((D+he)*E),_e=this.index.range(me-b,ye-b,me+b,ye+b);for(const be of _e){const ee=this.crossTileIDs[be];if(this.keys[be]===H&&!g.has(ee)){g.add(ee),W.crossTileID=ee;break}}}}}class Fh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ad{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const c=Math.round((n-this.lng)/360);if(c!==0)for(const g in this.indexes){const b=this.indexes[g],E={};for(const L in b){const D=b[L];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+c),E[D.tileID.key]=D}this.indexes[g]=E}this.lng=n}addBucket(n,c,g){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let E=0;E<c.symbolInstances.length;E++)c.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const b=this.usedCrossTileIDs[n.overscaledZ];for(const E in this.indexes){const L=this.indexes[E];if(Number(E)>n.overscaledZ)for(const D in L){const F=L[D];F.tileID.isChildOf(n)&&F.findMatches(c.symbolInstances,n,b)}else{const D=L[n.scaledTo(Number(E)).key];D&&D.findMatches(c.symbolInstances,n,b)}}for(let E=0;E<c.symbolInstances.length;E++){const L=c.symbolInstances.get(E);L.crossTileID||(L.crossTileID=g.generate(),b.add(L.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Qn(n,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(n,c){for(const g of c.crossTileIDs)this.usedCrossTileIDs[n].delete(g)}removeStaleBuckets(n){let c=!1;for(const g in this.indexes){const b=this.indexes[g];for(const E in b)n[b[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,b[E]),delete b[E],c=!0)}return c}}class ga{constructor(){this.layerIndexes={},this.crossTileIDs=new Fh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,c,g,b){let E=this.layerIndexes[n.id];E===void 0&&(E=this.layerIndexes[n.id]=new ad);let L=!1;const D={};b.name!=="globe"&&E.handleWrapJump(g);for(const F of c){const W=F.getBucket(n);W&&n.id===W.layerIds[0]&&(W.bucketInstanceId||(W.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(F.tileID,W,this.crossTileIDs)&&(L=!0),D[W.bucketInstanceId]=!0)}return E.removeStaleBuckets(D)&&(L=!0),L}pruneUnusedLayers(n){const c={};n.forEach(g=>{c[g]=!0});for(const g in this.layerIndexes)c[g]||delete this.layerIndexes[g]}}const _a=(f,n)=>s.emitValidationErrors(f,n&&n.filter(c=>c.identifier!=="source.canvas")),Hl=s.pick(wr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ql=s.pick(wr,["setCenter","setZoom","setBearing","setPitch"]),bo={version:8,layers:[],sources:{}},ya={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Wo extends s.Evented{constructor(n,c={}){super(),this.map=n,this.dispatcher=new tr(En(),this),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(n._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new ga,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const g=this;this._rtlTextPluginCallback=Wo.registerForPluginStateChange(b=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(E,L)=>{if(s.triggerPluginCompletionEvent(E),L&&L.every(D=>D))for(const D in g._sourceCaches){const F=g._sourceCaches[D],W=F.getSource().type;W!=="vector"&&W!=="geojson"||F.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const E=this.getSource(b.sourceId);if(E&&E.vectorLayerIds)for(const L in this._layers){const D=this._layers[L];D.source===E.id&&this._validateLayer(D)}})}loadURL(n,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const g=typeof c.validate=="boolean"?c.validate:!s.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,c.accessToken);const b=this.map._requestManager.transformRequest(n,s.ResourceType.Style);this._request=s.getJSON(b,(E,L)=>{this._request=null,E?this.fire(new s.ErrorEvent(E)):L&&this._load(L,g)})}loadJSON(n,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(n,c.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(bo,!1)}_updateLayerCount(n,c){const g=c?1:-1;n.is3D()&&(this._num3DLayers+=g),n.type==="circle"&&(this._numCircleLayers+=g),n.type==="symbol"&&(this._numSymbolLayers+=g)}_load(n,c){if(c&&_a(this,s.validateStyle(n)))return;this._loaded=!0,this.stylesheet=s.clone$1(n),this._updateMapProjection();for(const b in n.sources)this.addSource(b,n.sources[b],{validate:!1});this._changed=!1,n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(n.glyphs);const g=Ff(this.stylesheet.layers);this._order=g.map(b=>b.id),this._layers={},this._serializedLayers={};for(const b of g){const E=s.createStyleLayer(b);E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new xt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(n){this._spriteRequest=function(c,g,b){let E,L,D;const F=s.exported.devicePixelRatio>1?"@2x":"";let W=s.getJSON(g.transformRequest(g.normalizeSpriteURL(c,F,".json"),s.ResourceType.SpriteJSON),(he,me)=>{W=null,D||(D=he,E=me,Q())}),H=s.getImage(g.transformRequest(g.normalizeSpriteURL(c,F,".png"),s.ResourceType.SpriteImage),(he,me)=>{H=null,D||(D=he,L=me,Q())});function Q(){if(D)b(D);else if(E&&L){const he=s.exported.getImageData(L),me={};for(const ye in E){const{width:_e,height:be,x:ee,y:pe,sdf:Ce,pixelRatio:ke,stretchX:Ge,stretchY:Ne,content:We}=E[ye],it=new s.RGBAImage({width:_e,height:be});s.RGBAImage.copy(he,it,{x:ee,y:pe},{x:0,y:0},{width:_e,height:be}),me[ye]={data:it,pixelRatio:ke,sdf:Ce,stretchX:Ge,stretchY:Ne,content:We}}b(null,me)}}return{cancel(){W&&(W.cancel(),W=null),H&&(H.cancel(),H=null)}}}(n,this.map._requestManager,(c,g)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(g)for(const b in g)this.imageManager.addImage(b,g[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(n){const c=this.getSource(n.source);if(!c)return;const g=n.sourceLayer;g&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${c.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const c=[];for(const g of n){const b=this._layers[g];b.type!=="custom"&&c.push(b.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(n){return!!this.terrain&&(typeof n.isLayerDraped=="function"?n.isLayerDraped():ya[n.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(n){if(!this._loaded)return;const c=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(b.length||E.length)&&this._updateWorkerLayers(b,E);for(const L in this._updatedSources){const D=this._updatedSources[L];D==="reload"?this._reloadSource(L):D==="clear"&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(n);this.light.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._resetUpdates()}const g={};for(const b in this._sourceCaches){const E=this._sourceCaches[b];g[b]=E.used,E.used=!1}for(const b of this._order){const E=this._layers[b];if(E.recalculate(n,this._availableImages),!E.isHidden(n.zoom)){const D=this._getLayerSourceCache(E);D&&(D.used=!0)}const L=this.map.painter;if(L){const D=E.getProgramIds();if(!D)continue;const F=E.getProgramConfiguration(n.zoom);for(const W of D)L.useProgram(W,F)}}for(const b in g){const E=this._sourceCaches[b];g[b]!==E.used&&E.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),_a(this,s.validateStyle(n)))return!1;(n=s.clone$1(n)).layers=Ff(n.layers);const c=function(b,E){if(!b)return[{command:wr.setStyle,args:[E]}];let L=[];try{if(!$(b.version,E.version))return[{command:wr.setStyle,args:[E]}];$(b.center,E.center)||L.push({command:wr.setCenter,args:[E.center]}),$(b.zoom,E.zoom)||L.push({command:wr.setZoom,args:[E.zoom]}),$(b.bearing,E.bearing)||L.push({command:wr.setBearing,args:[E.bearing]}),$(b.pitch,E.pitch)||L.push({command:wr.setPitch,args:[E.pitch]}),$(b.sprite,E.sprite)||L.push({command:wr.setSprite,args:[E.sprite]}),$(b.glyphs,E.glyphs)||L.push({command:wr.setGlyphs,args:[E.glyphs]}),$(b.transition,E.transition)||L.push({command:wr.setTransition,args:[E.transition]}),$(b.light,E.light)||L.push({command:wr.setLight,args:[E.light]}),$(b.fog,E.fog)||L.push({command:wr.setFog,args:[E.fog]}),$(b.projection,E.projection)||L.push({command:wr.setProjection,args:[E.projection]});const D={},F=[];(function(Q,he,me,ye){let _e;for(_e in he=he||{},Q=Q||{})Q.hasOwnProperty(_e)&&(he.hasOwnProperty(_e)||zc(_e,me,ye));for(_e in he){if(!he.hasOwnProperty(_e))continue;const be=he[_e];Q.hasOwnProperty(_e)?$(Q[_e],be)||(Q[_e].type==="geojson"&&be.type==="geojson"&&Rh(Q,he,_e)?me.push({command:wr.setGeoJSONSourceData,args:[_e,be.data]}):Oh(_e,he,me,ye)):td(_e,he,me)}})(b.sources,E.sources,F,D);const W=[];b.layers&&b.layers.forEach(Q=>{Q.source&&D[Q.source]?L.push({command:wr.removeLayer,args:[Q.id]}):W.push(Q)});let H=b.terrain;H&&D[H.source]&&(L.push({command:wr.setTerrain,args:[void 0]}),H=void 0),L=L.concat(F),$(H,E.terrain)||L.push({command:wr.setTerrain,args:[E.terrain]}),function(Q,he,me){he=he||[];const ye=(Q=Q||[]).map(Uo),_e=he.map(Uo),be=Q.reduce(id,{}),ee=he.reduce(id,{}),pe=ye.slice(),Ce=Object.create(null);let ke,Ge,Ne,We,it,et,ft;for(ke=0,Ge=0;ke<ye.length;ke++)Ne=ye[ke],ee.hasOwnProperty(Ne)?Ge++:(me.push({command:wr.removeLayer,args:[Ne]}),pe.splice(pe.indexOf(Ne,Ge),1));for(ke=0,Ge=0;ke<_e.length;ke++)Ne=_e[_e.length-1-ke],pe[pe.length-1-ke]!==Ne&&(be.hasOwnProperty(Ne)?(me.push({command:wr.removeLayer,args:[Ne]}),pe.splice(pe.lastIndexOf(Ne,pe.length-Ge),1)):Ge++,et=pe[pe.length-ke],me.push({command:wr.addLayer,args:[ee[Ne],et]}),pe.splice(pe.length-ke,0,Ne),Ce[Ne]=!0);for(ke=0;ke<_e.length;ke++)if(Ne=_e[ke],We=be[Ne],it=ee[Ne],!Ce[Ne]&&!$(We,it))if($(We.source,it.source)&&$(We["source-layer"],it["source-layer"])&&$(We.type,it.type)){for(ft in yo(We.layout,it.layout,me,Ne,null,wr.setLayoutProperty),yo(We.paint,it.paint,me,Ne,null,wr.setPaintProperty),$(We.filter,it.filter)||me.push({command:wr.setFilter,args:[Ne,it.filter]}),$(We.minzoom,it.minzoom)&&$(We.maxzoom,it.maxzoom)||me.push({command:wr.setLayerZoomRange,args:[Ne,it.minzoom,it.maxzoom]}),We)We.hasOwnProperty(ft)&&ft!=="layout"&&ft!=="paint"&&ft!=="filter"&&ft!=="metadata"&&ft!=="minzoom"&&ft!=="maxzoom"&&(ft.indexOf("paint.")===0?yo(We[ft],it[ft],me,Ne,ft.slice(6),wr.setPaintProperty):$(We[ft],it[ft])||me.push({command:wr.setLayerProperty,args:[Ne,ft,it[ft]]}));for(ft in it)it.hasOwnProperty(ft)&&!We.hasOwnProperty(ft)&&ft!=="layout"&&ft!=="paint"&&ft!=="filter"&&ft!=="metadata"&&ft!=="minzoom"&&ft!=="maxzoom"&&(ft.indexOf("paint.")===0?yo(We[ft],it[ft],me,Ne,ft.slice(6),wr.setPaintProperty):$(We[ft],it[ft])||me.push({command:wr.setLayerProperty,args:[Ne,ft,it[ft]]}))}else me.push({command:wr.removeLayer,args:[Ne]}),et=pe[pe.lastIndexOf(Ne)+1],me.push({command:wr.addLayer,args:[it,et]})}(W,E.layers,L)}catch(D){console.warn("Unable to compute style diff:",D),L=[{command:wr.setStyle,args:[E]}]}return L}(this.serialize(),n).filter(b=>!(b.command in ql));if(c.length===0)return!1;const g=c.filter(b=>!(b.command in Hl));if(g.length>0)throw new Error(`Unimplemented: ${g.map(b=>b.command).join(", ")}.`);return c.forEach(b=>{b.command!=="setTransition"&&b.command!=="setProjection"&&this[b.command].apply(this,b.args)}),this.stylesheet=n,this._updateMapProjection(),!0}addImage(n,c){return this.getImage(n)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,c),this._afterImageUpdated(n),this)}updateImage(n,c){this.imageManager.updateImage(n,c)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n),this._afterImageUpdated(n),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(n,c,g={}){if(this._checkLoaded(),this.getSource(n)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateSource,`sources.${n}`,c,null,g))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const b=or(n,c,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(n),source:b.serialize(),sourceId:n}));const E=L=>{const D=(L?"symbol:":"other:")+n,F=this._sourceCaches[D]=new s.SourceCache(D,b,L);(L?this._symbolSourceCaches:this._otherSourceCaches)[n]=F,F.style=this,F.onAdd(this.map)};E(!1),c.type!=="vector"&&c.type!=="geojson"||E(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(n){this._checkLoaded();const c=this.getSource(n);if(!c)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===n)return this.fire(new s.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===n)return this.fire(new s.ErrorEvent(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(n);for(const b of g)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(n,c){this._checkLoaded(),this.getSource(n).setData(c),this._changed=!0}getSource(n){const c=this._getSourceCache(n);return c&&c.getSource()}_getSources(){const n=[];for(const c in this._otherSourceCaches){const g=this._getSourceCache(c);g&&n.push(g.getSource())}return n}addLayer(n,c,g={}){this._checkLoaded();const b=n.id;if(this.getLayer(b))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let E;if(n.type==="custom"){if(_a(this,s.validateCustomStyleLayer(n)))return;E=s.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(b,n.source),n=s.clone$1(n),n=s.extend(n,{source:b})),this._validate(s.validateLayer,`layers.${b}`,n,{arrayIndex:-1},g))return;E=s.createStyleLayer(n),this._validateLayer(E),E.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const L=c?this._order.indexOf(c):this._order.length;if(c&&L===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(L,0,b),this._layerOrderChanged=!0,this._layers[b]=E;const D=this._getLayerSourceCache(E);if(this._removedLayers[b]&&E.source&&D&&E.type!=="custom"){const F=this._removedLayers[b];delete this._removedLayers[b],F.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",D.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(n,c){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===c)return;const g=this._order.indexOf(n);this._order.splice(g,1);const b=c?this._order.indexOf(c):this._order.length;c&&b===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(b,0,n),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(n){this._checkLoaded();const c=this._layers[n];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const g=this._order.indexOf(n);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=c,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}hasLayerType(n){for(const c in this._layers)if(this._layers[c].type===n)return!0;return!1}setLayerZoomRange(n,c,g){this._checkLoaded();const b=this.getLayer(n);b?b.minzoom===c&&b.maxzoom===g||(c!=null&&(b.minzoom=c),g!=null&&(b.maxzoom=g),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,c,g={}){this._checkLoaded();const b=this.getLayer(n);if(b){if(!$(b.filter,c))return c==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(s.validateFilter,`layers.${b.id}.filter`,c,{layerType:b.type},g)||(b.filter=s.clone$1(c),this._updateLayer(b)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(n){const c=this.getLayer(n);return c&&s.clone$1(c.filter)}setLayoutProperty(n,c,g,b={}){this._checkLoaded();const E=this.getLayer(n);E?$(E.getLayoutProperty(c),g)||(E.setLayoutProperty(c,g,b),this._updateLayer(E)):this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(n,c){const g=this.getLayer(n);if(g)return g.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style.`)))}setPaintProperty(n,c,g,b={}){this._checkLoaded();const E=this.getLayer(n);E?$(E.getPaintProperty(c),g)||(E.setPaintProperty(c,g,b)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(n,c){const g=this.getLayer(n);return g&&g.getPaintProperty(c)}setFeatureState(n,c){this._checkLoaded();const g=n.source,b=n.sourceLayer,E=this.getSource(g);if(!E)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const L=E.type;if(L==="geojson"&&b)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(L==="vector"&&!b)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const D=this._getSourceCaches(g);for(const F of D)F.setFeatureState(b,n.id,c)}removeFeatureState(n,c){this._checkLoaded();const g=n.source,b=this.getSource(g);if(!b)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const E=b.type,L=E==="vector"?n.sourceLayer:void 0;if(E==="vector"&&!L)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const D=this._getSourceCaches(g);for(const F of D)F.removeFeatureState(L,n.id,c)}getFeatureState(n){this._checkLoaded();const c=n.source,g=n.sourceLayer,b=this.getSource(c);if(b){if(b.type!=="vector"||g)return n.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(g,n.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n={};for(const c in this._sourceCaches){const g=this._sourceCaches[c].getSource();n[g.id]||(n[g.id]=g.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:n,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0;const c=this._getLayerSourceCache(n);n.source&&!this._updatedSources[n.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",c.pause()),this._changed=!0,n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const c=L=>this._layers[L].type==="fill-extrusion",g={},b=[];for(let L=this._order.length-1;L>=0;L--){const D=this._order[L];if(c(D)){g[D]=L;for(const F of n){const W=F[D];if(W)for(const H of W)b.push(H)}}}b.sort((L,D)=>D.intersectionZ-L.intersectionZ);const E=[];for(let L=this._order.length-1;L>=0;L--){const D=this._order[L];if(c(D))for(let F=b.length-1;F>=0;F--){const W=b[F].feature;if(g[W.layer.id]<L)break;E.push(W),b.pop()}else for(const F of n){const W=F[D];if(W)for(const H of W)E.push(H.feature)}}return E}queryRenderedFeatures(n,c,g){c&&c.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const b={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of c.layers){const W=this._layers[F];if(!W)return this.fire(new s.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];b[W.source]=!0}}const E=[];c.availableImages=this._availableImages;const L=c&&c.layers?c.layers.some(F=>{const W=this.getLayer(F);return W&&W.is3D()}):this.has3DLayers(),D=rn.createFromScreenPoints(n,g);for(const F in this._sourceCaches){const W=this._sourceCaches[F].getSource().id;c.layers&&!b[W]||E.push(hn(this._sourceCaches[F],this._layers,this._serializedLayers,D,c,g,L,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(F,W,H,Q,he,me,ye){const _e={},be=me.queryRenderedSymbols(Q),ee=[];for(const pe of Object.keys(be).map(Number))ee.push(ye[pe]);ee.sort(os);for(const pe of ee){const Ce=pe.featureIndex.lookupSymbolFeatures(be[pe.bucketInstanceId],W,pe.bucketIndex,pe.sourceLayerIndex,he.filter,he.layers,he.availableImages,F);for(const ke in Ce){const Ge=_e[ke]=_e[ke]||[],Ne=Ce[ke];Ne.sort((We,it)=>{const et=pe.featureSortOrder;if(et){const ft=et.indexOf(We.featureIndex);return et.indexOf(it.featureIndex)-ft}return it.featureIndex-We.featureIndex});for(const We of Ne)Ge.push(We)}}for(const pe in _e)_e[pe].forEach(Ce=>{const ke=Ce.feature,Ge=H(F[pe]);if(!Ge)return;const Ne=Ge.getFeatureState(ke.layer["source-layer"],ke.id);ke.source=ke.layer.source,ke.layer["source-layer"]&&(ke.sourceLayer=ke.layer["source-layer"]),ke.state=Ne});return _e}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),D.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(n,c){c&&c.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const g=this._getSourceCaches(n);let b=[];for(const E of g)b=b.concat(_n(E,c));return b}addSourceType(n,c,g){return Wo.getSourceType(n)?g(new Error(`A source type called "${n}" already exists.`)):(Wo.setSourceType(n,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:c.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(n,c={}){this._checkLoaded();const g=this.light.getLight();let b=!1;for(const L in n)if(!$(n[L],g[L])){b=!0;break}if(!b)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(n,c),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n,c=1){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let g=n;if(c===1){if(typeof g.source=="object"){const b="terrain-dem-src";this.addSource(b,g.source),g=s.clone$1(g),g=s.extend(g,{source:b})}if(this._validate(s.validateTerrain,"terrain",g))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,c)}else{const b=this.terrain,E=b.get();for(const L of Object.keys(s.spec.terrain))!g.hasOwnProperty(L)&&s.spec.terrain[L].default&&(g[L]=s.spec.terrain[L].default);for(const L in g)if(!$(g[L],E[L])){b.set(g),this.stylesheet.terrain=g;const D=this._setTransitionParameters({duration:0});b.updateTransitions(D);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const c=this.fog=new Pr(n,this.map.transform);this.stylesheet.fog=n;const g=this._setTransitionParameters({duration:0});c.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,g=c.get();Object.keys(n).length===0&&c.set(n);for(const b in n)if(!$(n[b],g[b])){c.set(n),this.stylesheet.fog=n;const E=this._setTransitionParameters({duration:0});c.updateTransitions(E);break}}else this._createFog(n);this._markersNeedUpdate=!0}_setTransitionParameters(n){return{now:s.exported.now(),transition:s.extend(n,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const n=this._order.filter(g=>this.isLayerDraped(this._layers[g])),c=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...c)}_createTerrain(n,c){const g=this.terrain=new vt(n,c);this.stylesheet.terrain=n,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const b=this._setTransitionParameters({duration:0});g.updateTransitions(b)}_force3DLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="symbol"&&this._updateLayer(c)}}_validate(n,c,g,b,E={}){return(!E||E.validate!==!1)&&_a(this,n.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:g,styleSpec:s.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){const c=this._getSourceCaches(n);for(const g of c)g.clearTiles()}_reloadSource(n){const c=this._getSourceCaches(n);for(const g of c)g.resume(),g.reload()}_reloadSources(){for(const n of this._getSources())n.reload&&n.reload()}_updateSources(n){for(const c in this._sourceCaches)this._sourceCaches[c].update(n)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const c=this._sourceCaches[n];c.resume(),c.reload()}}_updatePlacement(n,c,g,b,E=!1){let L=!1,D=!1;const F={};for(const W of this._order){const H=this._layers[W];if(H.type!=="symbol")continue;if(!F[H.source]){const he=this._getLayerSourceCache(H);if(!he)continue;F[H.source]=he.getRenderableIds(!0).map(me=>he.getTileByID(me)).sort((me,ye)=>ye.tileID.overscaledZ-me.tileID.overscaledZ||(me.tileID.isLessThan(ye.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(H,F[H.source],n.center.lng,n.projection);L=L||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),n.zoom))&&(this.pauseablePlacement=new Uc(n,this._order,E,c,g,b,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),D=!0),L&&this.pauseablePlacement.placement.setStale()),D||L)for(const W of this._order){const H=this._layers[W];H.type==="symbol"&&this.placement.updateLayerOpacities(H,F[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,c,g){this.imageManager.getImages(c.icons,g),this._updateTilesForChangedImages();const b=E=>{E&&E.setDependencies(c.tileID.key,c.type,c.icons)};b(this._otherSourceCaches[c.source]),b(this._symbolSourceCaches[c.source])}getGlyphs(n,c,g){this.glyphManager.getGlyphs(c.stacks,g)}getResource(n,c,g){return s.makeRequest(c,g)}_getSourceCache(n){return this._otherSourceCaches[n]}_getLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}_getSourceCaches(n){const c=[];return this._otherSourceCaches[n]&&c.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&c.push(this._symbolSourceCaches[n]),c}_isSourceCacheLoaded(n){const c=this._getSourceCaches(n);return c.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${n}'`))),!1):c.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Wo.getSourceType=function(f){return $i[f]},Wo.setSourceType=function(f,n){$i[f]=n},Wo.registerForPluginStateChange=s.registerForPluginStateChange;var ld=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,al="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Ho=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,xn=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,es=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Vc={},Xl={};const Zl=[];Js(ld,Zl),Js(Ho,Zl),Js(xn,Zl),Js(es,Zl),Vc=br("",Ho),Xl=br(es,xn);const Yl=br(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Nh=ld,Kl=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Uh={background:br(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:br(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:br(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:br(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:br(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:br("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:br(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:br(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:br(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:br(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:br(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:br(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:br(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:br(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:br(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:br(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:br(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:br(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:br(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:br(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:br(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:br(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:br(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,al),skyboxGradient:br(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,al),skyboxCapture:br(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:br(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:br(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Js(f,n){const c=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of c)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=g.split(" ");for(const E of b)n.includes(E)||n.push(E)}}function br(f,n){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=n.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),b={},E=[...Zl];return Js(f,E),Js(n,E),{fragmentSource:f=f.replace(c,(L,D,F,W,H)=>(b[H]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${F} ${W} ${H};
#else
uniform ${F} ${W} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${F} ${W} ${H} = u_${H};
#endif
`)),vertexSource:n=n.replace(c,(L,D,F,W,H)=>{const Q=W==="float"?"vec2":"vec4",he=H.match(/color/)?"color":Q;return b[H]?D==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${F} ${Q} a_${H};
varying ${F} ${W} ${H};
#else
uniform ${F} ${W} u_${H};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${F} ${W} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${he}(a_${H}, u_${H}_t);
#else
    ${F} ${W} ${H} = u_${H};
#endif
`:D==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${F} ${Q} a_${H};
#else
uniform ${F} ${W} u_${H};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${F} ${W} ${H} = a_${H};
#else
    ${F} ${W} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${F} ${W} ${H} = unpack_mix_${he}(a_${H}, u_${H}_t);
#else
    ${F} ${W} ${H} = u_${H};
#endif
`}),staticAttributes:g,usedDefines:E}}class vm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,c,g,b,E,L,D){this.context=n;let F=this.boundPaintVertexBuffers.length!==b.length;for(let H=0;!F&&H<b.length;H++)this.boundPaintVertexBuffers[H]!==b[H]&&(F=!0);let W=this.boundDynamicVertexBuffers.length!==D.length;for(let H=0;!W&&H<D.length;H++)this.boundDynamicVertexBuffers[H]!==D[H]&&(W=!0);if(!n.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==g||F||W||this.boundIndexBuffer!==E||this.boundVertexOffset!==L)this.freshBind(c,g,b,E,L,D);else{n.bindVertexArrayOES.set(this.vao);for(const H of D)H&&H.bind();E&&E.dynamicDraw&&E.bind()}}freshBind(n,c,g,b,E,L){let D;const F=n.numAttributes,W=this.context,H=W.gl;if(W.extVertexArrayObject)this.vao&&this.destroy(),this.vao=W.extVertexArrayObject.createVertexArrayOES(),W.bindVertexArrayOES.set(this.vao),D=0,this.boundProgram=n,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=b,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=L;else{D=W.currentNumAttributes||0;for(let Q=F;Q<D;Q++)H.disableVertexAttribArray(Q)}c.enableAttributes(H,n),c.bind(),c.setVertexAttribPointers(H,n,E);for(const Q of g)Q.enableAttributes(H,n),Q.bind(),Q.setVertexAttribPointers(H,n,E);for(const Q of L)Q&&(Q.enableAttributes(H,n),Q.bind(),Q.setVertexAttribPointers(H,n,E));b&&b.bind(),W.currentNumAttributes=F}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ll(f,n){const c=Math.pow(2,n.canonical.z),g=n.canonical.y;return[new s.MercatorCoordinate(0,g/c).toLngLat().lat,new s.MercatorCoordinate(0,(g+1)/c).toLngLat().lat]}function cd(f,n,c,g,b,E,L){const D=f.context,F=D.gl,W=c.fbo;if(!W)return;f.prepareDrawTile();const H=f.useProgram("hillshade");D.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,W.colorAttachment.get());const Q=((_e,be,ee,pe)=>{const Ce=ee.paint.get("hillshade-shadow-color"),ke=ee.paint.get("hillshade-highlight-color"),Ge=ee.paint.get("hillshade-accent-color");let Ne=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ne-=_e.transform.angle);const We=!_e.options.moving;return{u_matrix:pe||_e.transform.calculateProjMatrix(be.tileID.toUnwrapped(),We),u_image:0,u_latrange:ll(0,be.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),Ne],u_shadow:Ce,u_highlight:ke,u_accent:Ge}})(f,c,g,f.terrain?n.projMatrix:null);f.prepareDrawProgram(D,H,n.toUnwrapped());const{tileBoundsBuffer:he,tileBoundsIndexBuffer:me,tileBoundsSegments:ye}=f.getTileBoundsBuffers(c);H.draw(D,F.TRIANGLES,b,E,L,s.CullFaceMode.disabled,Q,g.id,he,me,ye)}function Vh(f,n,c){if(!n.needsDEMTextureUpload)return;const g=f.context,b=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||f.getTileTexture(c.stride);const E=c.getPixels();n.demTexture?n.demTexture.update(E,{premultiply:!1}):n.demTexture=new s.Texture(g,E,b.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function jh(f,n,c,g,b,E){const L=f.context,D=L.gl;if(!n.dem)return;const F=n.dem;if(L.activeTexture.set(D.TEXTURE1),Vh(f,n,F),!n.demTexture)return;n.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE);const W=F.dim;L.activeTexture.set(D.TEXTURE0);let H=n.fbo;if(!H){const ye=new s.Texture(L,{width:W,height:W,data:null},D.RGBA);ye.bind(D.LINEAR,D.CLAMP_TO_EDGE),H=n.fbo=L.createFramebuffer(W,W,!0),H.colorAttachment.set(ye.texture)}L.bindFramebuffer.set(H.framebuffer),L.viewport.set([0,0,W,W]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:he,tileBoundsSegments:me}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(L,D.TRIANGLES,g,b,E,s.CullFaceMode.disabled,((ye,_e)=>{const be=_e.stride,ee=s.create();return s.ortho(ee,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ee,ee,[0,-s.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[be,be],u_zoom:ye.overscaledZ,u_unpack:_e.unpackVector}})(n.tileID,F),c.id,Q,he,me),n.needsHillshadePrepare=!1}const $h=f=>({u_matrix:new s.UniformMatrix4f(f),u_image0:new s.Uniform1i(f),u_skirt_height:new s.Uniform1f(f)}),Ua=(f,n)=>({u_matrix:f,u_image0:0,u_skirt_height:n}),Gh=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:c,u_zoom_transition:b,u_merc_center:E,u_image0:0,u_frustum_tl:L,u_frustum_tr:D,u_frustum_br:F,u_frustum_bl:W,u_globe_pos:H,u_globe_radius:Q,u_viewport:he,u_grid_matrix:ye?Float32Array.from(ye):new Float32Array(9),u_skirt_height:me});function cl(f,n){return f!=null&&n!=null&&!(!f.hasData()||!n.hasData())&&f.demTexture!=null&&n.demTexture!=null&&f.tileID.key!==n.tileID.key}const wo=new class{constructor(){this.operations={}}newMorphing(f,n,c,g,b){if(f in this.operations){const E=this.operations[f];E.to.tileID.key!==c.tileID.key&&(E.queued=c)}else this.operations[f]={startTime:g,phase:0,duration:b,from:n,to:c,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const n=this.operations[f];return{from:n.from,to:n.to,phase:n.phase}}update(f){for(const n in this.operations){const c=this.operations[n];for(c.phase=(f-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,f)){delete this.operations[n];break}}}_nextOp(f,n){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=n,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},hl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Wh(f){return 6*Math.pow(1.5,22-f)}function jf(f,n){const c=1<<f.z;return!n&&(f.x===0||f.x===c-1)||f.y===0||f.y===c-1}const jc=f=>({u_matrix:f});function hd(f,n,c,g,b){if(b>0){const E=s.exported.now(),L=(E-f.timeAdded)/b,D=n?(E-n.timeAdded)/b:-1,F=c.getSource(),W=g.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),H=!n||Math.abs(n.tileID.overscaledZ-W)>Math.abs(f.tileID.overscaledZ-W),Q=H&&f.refreshedUponExpiration?1:s.clamp(H?L:1-D,0,1);return f.refreshedUponExpiration&&L>=1&&(f.refreshedUponExpiration=!1),n?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class $c extends s.SourceCache{constructor(n){const c={type:"raster-dem",maxzoom:n.transform.maxZoom},g=new tr(En(),null),b=or("mock-dem",c,g,n.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,c){n.state="loaded",c(null)}}class Hh extends s.SourceCache{constructor(n){const c=or("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new tr(En(),null),n.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,c,g){if(n.freezeTileCoverage)return;this.transform=n;const b=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,L)=>{if(E[L.key]="",!this._tiles[L.key]){const D=new s.Tile(L,this._source.tileSize*L.overscaleFactor(),n.tileZoom);D.state="loaded",this._tiles[L.key]=D}return E},{});for(const E in this._tiles)E in b||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(n){const c=this.proxyCachedFBO[n];if(c!==void 0){const g=Object.values(c);this.renderCachePool.push(...g),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class qh extends s.OverscaledTileID{constructor(n,c,g){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=c,this.projMatrix=g}}class ud extends s.Elevation{constructor(n,c){super(),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,b,E]=function(F){const W=new s.StructArrayLayout2i4,H=new s.StructArrayLayout3ui6,Q=131;W.reserve(17161),H.reserve(33800);const he=s.EXTENT/128,me=s.EXTENT+he/2,ye=me+he;for(let be=-he;be<ye;be+=he)for(let ee=-he;ee<ye;ee+=he){const pe=ee<0||ee>me||be<0||be>me?24575:0,Ce=s.clamp(Math.round(ee),0,s.EXTENT),ke=s.clamp(Math.round(be),0,s.EXTENT);W.emplaceBack(Ce+pe,ke)}const _e=(be,ee)=>{const pe=ee*Q+be;H.emplaceBack(pe+1,pe,pe+Q),H.emplaceBack(pe+Q,pe+Q+1,pe+1)};for(let be=1;be<129;be++)for(let ee=1;ee<129;ee++)_e(ee,be);return[0,129].forEach(be=>{for(let ee=0;ee<130;ee++)_e(ee,be),_e(be,ee)}),[W,H,32768]}(),L=n.context;this.gridBuffer=L.createVertexBuffer(g,s.posAttributes.members),this.gridIndexBuffer=L.createIndexBuffer(b),this.gridSegments=s.SegmentVector.simpleSegment(0,0,g.length,b.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,g.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Hh(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const D=L.gl;this._overlapStencilMode=new s.StencilMode({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new $c(c.map)}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),n.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=n,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,c,g){if(n&&n.terrain){this._style!==n&&(this.style=n),this.enabled=!0;const b=n.terrain.properties;this.sourceCache=n.terrain.drapeRenderMode===0?this._mockSourceCache:n._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const E=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const L=this.getScaledDemTileSize();this.sourceCache.update(c,L,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),c.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const n=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||n.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${n.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${n.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._sourceCaches)this._style._sourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=c.getIds().map(F=>{const W=c.getTileByID(F).tileID;return W.projMatrix=g.calculateProjMatrix(W.toUnwrapped()),W});(function(F,W){const H=W.transform.pointCoordinate(W.transform.getCameraPoint()),Q=new s.Point(H.x,H.y);F.sort((he,me)=>{if(me.overscaledZ-he.overscaledZ)return me.overscaledZ-he.overscaledZ;const ye=new s.Point(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),_e=new s.Point(me.canonical.x+(1<<me.canonical.z)*me.wrap,me.canonical.y),be=Q.mult(1<<he.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ye)-be.distSqr(_e)})})(b,this.painter),this._previousZoom=g.zoom;const E=this.proxyToSource||{};this.proxyToSource={},b.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const L=this._style._sourceCaches;for(const F in L){const W=L[F];if(!W.used||(W!==this.sourceCache&&this.resetTileLookupCache(W.id),this._setupProxiedCoordsForOrtho(W,n[F],E),W.usedForTerrain))continue;const H=n[F];W.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[c.id]=b.map(F=>new qh(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const D={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const W=this.terrainTileForTile[F.key];if(!W)continue;const H=W.tileID.key;H in D||(this._visibleDemTiles.push(W),D[H]=H)}}_assignTerrainTiles(n){this._initializing||n.forEach(c=>{if(this.terrainTileForTile[c.key])return;const g=this._findTileCoveringTileID(c,this.sourceCache);g&&(this.terrainTileForTile[c.key]=g)})}_prepareDEMTextures(){const n=this.painter.context,c=n.gl;for(const g in this.terrainTileForTile){const b=this.terrainTileForTile[g],E=b.dem;!E||b.demTexture&&!b.needsDEMTextureUpload||(n.activeTexture.set(c.TEXTURE1),Vh(this.painter,b,E))}}_prepareDemTileUniforms(n,c,g,b){if(!c||c.demTexture==null)return!1;const E=n.tileID.canonical,L=Math.pow(2,c.tileID.canonical.z-E.z),D=b||"";return g[`u_dem_tl${D}`]=[E.x*L%1,E.y*L%1],g[`u_dem_scale${D}`]=L,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const n=this.painter.context,c=n.gl;if(!this._emptyDepthBufferTexture){const g=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(n,g,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let n=0;const c=this._visibleDemTiles.reduce((g,b)=>{if(!b.dem)return g;const E=b.dem.tree.minimums[0];return E>0&&n++,g+E},0);return n?c/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,c=n.gl;n.activeTexture.set(c.TEXTURE2);const g=this._getLoadedAreaMinimum(),b=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(b,{premultiply:!1}):E=this._emptyDEMTexture=new s.Texture(n,b,c.RGBA,{premultiply:!1}),E}setupElevationDraw(n,c,g){const b=this.painter.context,E=b.gl,L=(D=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(D),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var D;L.u_dem_size=this.sourceCache.getSource().tileSize,L.u_exaggeration=this.exaggeration();let F=null,W=null,H=1;if(g&&g.morphing&&this._useVertexMorphing){const Q=g.morphing.srcDemTile,he=g.morphing.dstDemTile;H=g.morphing.phase,Q&&he&&(this._prepareDemTileUniforms(n,Q,L,"_prev")&&(W=Q),this._prepareDemTileUniforms(n,he,L)&&(F=he))}if(W&&F?(b.activeTexture.set(E.TEXTURE2),F.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),b.activeTexture.set(E.TEXTURE4),W.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),L.u_dem_lerp=H):(F=this.terrainTileForTile[n.tileID.key],b.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(n,F,L)?F.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),b.activeTexture.set(E.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(L.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),L.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&F){const Q=(1<<F.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;L.u_meter_to_dem=Q}if(g&&g.labelPlaneMatrixInv&&(L.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),c.setTerrainUniformValues(b,L),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,n.tileID.canonical,g&&g.useDenormalizedUpVectorScale);c.setGlobeUniformValues(b,Q)}}globeUniformValues(n,c,g){const b=n.projection;return{u_tile_tl_up:b.upVector(c,0,0),u_tile_tr_up:b.upVector(c,s.EXTENT,0),u_tile_br_up:b.upVector(c,s.EXTENT,s.EXTENT),u_tile_bl_up:b.upVector(c,0,s.EXTENT),u_tile_up_scale:g?s.globeMetersToEcef(1):b.upVectorScale(c,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const c=this.painter,g=this.painter.context;n.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,E,L,D,F){if(b.transform.projection.name==="globe")(function(W,H,Q,he,me){const ye=W.context,_e=ye.gl;let be,ee;const pe=W.options.showTerrainWireframe?2:0,Ce=W.transform,ke=s.globeUseCustomAntiAliasing(W,ye,Ce),Ge=(Vt,lt)=>{if(ee===Vt)return;const kt=[hl[Vt],"PROJECTION_GLOBE_VIEW"];ke&&kt.push("CUSTOM_ANTIALIASING"),lt&&kt.push(hl[pe]),be=W.useProgram("globeRaster",null,kt),ee=Vt},Ne=W.colorModeForRenderPass(),We=new s.DepthMode(_e.LEQUAL,s.DepthMode.ReadWrite,W.depthRangeFor3D);wo.update(me);const it=s.calculateGlobeMercatorMatrix(Ce),et=[s.mercatorXfromLng(Ce.center.lng),s.mercatorYfromLat(Ce.center.lat)],ft=pe?[!1,!0]:[!1],Nt=W.globeSharedBuffers,ht=[Ce.width*s.exported.devicePixelRatio,Ce.height*s.exported.devicePixelRatio],Mt=Float32Array.from(Ce.globeMatrix),_t={useDenormalizedUpVectorScale:!0};if(ft.forEach(Vt=>{const lt=W.transform,kt=Wh(lt.zoom)*H.exaggeration();ee=-1;const jt=Vt?_e.LINES:_e.TRIANGLES;for(const Ct of he){const Ht=Q.getTile(Ct),Ii=s.StencilMode.disabled,Fi=H.prevTerrainTileForTile[Ct.key],vi=H.terrainTileForTile[Ct.key];cl(Fi,vi)&&wo.newMorphing(Ct.key,Fi,vi,me,250),ye.activeTexture.set(_e.TEXTURE0),Ht.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Pi=wo.getMorphValuesForProxy(Ct.key),Gi=Pi?1:0;Pi&&s.extend$1(_t,{morphing:{srcDemTile:Pi.from,dstDemTile:Pi.to,phase:s.easeCubicInOut(Pi.phase)}});const Wi=s.tileCornersToBounds(Ct.canonical),Ci=s.getLatitudinalLod(Wi.getCenter().lat),Ar=s.getGridMatrix(Ct.canonical,Wi,Ci,lt.worldSize/lt._pixelsPerMercatorPixel),Lr=s.globeNormalizeECEF(s.globeTileBounds(Ct.canonical)),Dr=Gh(lt.projMatrix,Mt,it,Lr,s.globeToMercatorTransition(lt.zoom),et,lt.frustumCorners.TL,lt.frustumCorners.TR,lt.frustumCorners.BR,lt.frustumCorners.BL,lt.globeCenterInViewSpace,lt.globeRadius,ht,kt,Ar);if(Ge(Gi,Vt),H.setupElevationDraw(Ht,be,_t),W.prepareDrawProgram(ye,be,Ct.toUnwrapped()),Nt){const[Or,gs,is]=Vt?Nt.getWirefameBuffers(W.context,Ci):Nt.getGridBuffers(Ci,kt!==0);be.draw(ye,jt,We,Ii,Ne,s.CullFaceMode.backCCW,Dr,"globe_raster",Or,gs,is)}}}),Nt){const Vt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ke&&Vt.push("CUSTOM_ANTIALIASING"),be=W.useProgram("globeRaster",null,Vt);for(const lt of he){const{x:kt,y:jt,z:Ct}=lt.canonical,Ht=jt===0,Ii=jt===(1<<Ct)-1,[Fi,vi,Pi,Gi]=Nt.getPoleBuffers(Ct);if(Gi&&(Ht||Ii)){const Wi=Q.getTile(lt);ye.activeTexture.set(_e.TEXTURE0),Wi.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let Ci=s.globePoleMatrixForTile(Ct,kt,Ce);const Ar=s.globeNormalizeECEF(s.globeTileBounds(lt.canonical)),Lr=(Dr,Or)=>Dr.draw(ye,_e.TRIANGLES,We,s.StencilMode.disabled,Ne,s.CullFaceMode.disabled,Gh(Ce.projMatrix,Ci,Ci,Ar,0,et,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,ht,0),"globe_pole_raster",Or,Pi,Gi);H.setupElevationDraw(Wi,be,_t),W.prepareDrawProgram(ye,be,lt.toUnwrapped()),Ht&&Lr(be,Fi),Ii&&(Ci=s.scale(s.create(),Ci,[1,-1,1]),Lr(be,vi))}}}})(b,E,L,D,F);else{const W=b.context,H=W.gl;let Q,he;const me=b.options.showTerrainWireframe?2:0,ye=(Ce,ke)=>{if(he===Ce)return;const Ge=[hl[Ce]];ke&&Ge.push(hl[me]),Q=b.useProgram("terrainRaster",null,Ge),he=Ce},_e=b.colorModeForRenderPass(),be=new s.DepthMode(H.LEQUAL,s.DepthMode.ReadWrite,b.depthRangeFor3D);wo.update(F);const ee=b.transform,pe=Wh(ee.zoom)*E.exaggeration();(me?[!1,!0]:[!1]).forEach(Ce=>{he=-1;const ke=Ce?H.LINES:H.TRIANGLES,[Ge,Ne]=Ce?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const We of D){const it=L.getTile(We),et=s.StencilMode.disabled,ft=E.prevTerrainTileForTile[We.key],Nt=E.terrainTileForTile[We.key];cl(ft,Nt)&&wo.newMorphing(We.key,ft,Nt,F,250),W.activeTexture.set(H.TEXTURE0),it.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);const ht=wo.getMorphValuesForProxy(We.key),Mt=ht?1:0;let _t;ht&&(_t={morphing:{srcDemTile:ht.from,dstDemTile:ht.to,phase:s.easeCubicInOut(ht.phase)}});const Vt=Ua(We.projMatrix,jf(We.canonical,ee.renderWorldCopies)?pe/10:pe);ye(Mt,Ce),E.setupElevationDraw(it,Q,_t),b.prepareDrawProgram(W,Q,We.toUnwrapped()),Q.draw(W,ke,be,et,_e,s.CullFaceMode.backCCW,Vt,"terrain_raster",E.gridBuffer,Ge,Ne)}})}}(c,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const c=this.painter,g=this.painter.context,b=this.proxySourceCache,E=this.proxiedCoords[b.id],L=this._drapedRenderBatches.shift(),D=[],F=c.style.order;let W=0;for(const H of E){const Q=b.getTileByID(H.proxyTileKey),he=b.proxyCachedFBO[H.key]?b.proxyCachedFBO[H.key][n]:void 0,me=he!==void 0?b.renderCache[he]:this.pool[W++],ye=he!==void 0;if(Q.texture=me.tex,ye&&!me.dirty){D.push(Q.tileID);continue}let _e;g.bindFramebuffer.set(me.fb.framebuffer),this.renderedToTile=!1,me.dirty&&(g.clear({color:s.Color.transparent,stencil:0}),me.dirty=!1);for(let be=L.start;be<=L.end;++be){const ee=c.style._layers[F[be]];if(ee.isHidden(c.transform.zoom))continue;const pe=c.style._getLayerSourceCache(ee),Ce=pe?this.proxyToSource[H.key][pe.id]:[H];if(!Ce)continue;const ke=Ce;g.viewport.set([0,0,me.fb.width,me.fb.height]),_e!==(pe?pe.id:null)&&(this._setupStencil(me,Ce,ee,pe),_e=pe?pe.id:null),c.renderLayer(c,pe,ee,ke)}this.renderedToTile?(me.dirty=!0,D.push(Q.tileID)):ye||--W,W===5&&(W=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,c.width,c.height]),L.end+1}postRender(){}renderCacheEfficiency(n){const c=n.order.length;if(c===0)return{efficiency:100};let g,b=0,E=0,L=!1;for(let D=0;D<c;++D){const F=n._layers[n.order[D]];this._style.isLayerDraped(F)?(L&&++b,++E):L||(L=!0,g=F.id)}return E===0?{efficiency:100}:{efficiency:100*(1-b/E),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{n=Math.min(n,c.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,c,g){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const L=E.tileID,D=1<<L.overscaledZ,{x:F,y:W}=L.canonical,H=F/D,Q=(F+1)/D,he=W/D,me=(W+1)/D;return{minx:H,miny:he,maxx:Q,maxy:me,t:E.dem.tree.raycastRoot(H,he,Q,me,n,c,g),tile:E}});b.sort((E,L)=>(E.t!==null?E.t:Number.MAX_VALUE)-(L.t!==null?L.t:Number.MAX_VALUE));for(const E of b){if(E.t==null)return null;const L=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,n,c,g);if(L!=null)return L}return null}_createFBO(){const n=this.painter.context,c=n.gl,g=this.drapeBufferSize;n.activeTexture.set(c.TEXTURE0);const b=new s.Texture(n,{width:g[0],height:g[1],data:null},c.RGBA);b.bind(c.LINEAR,c.CLAMP_TO_EDGE);const E=n.createFramebuffer(g[0],g[1],!1);return E.colorAttachment.set(b.texture),E.depthAttachment=new Ke(n,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&!n.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:E,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const c=this._style._layers[n],g=c.isHidden(this.painter.transform.zoom);return c.type==="custom"?!g&&c.shouldRedrape():!g&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const g of this._style._getSources())if(g instanceof ii){n=!0;break}if(!n)return;const c={};for(let g=0;g<this._style.order.length;++g){const b=this._style._layers[this._style.order[g]],E=this._style._getLayerSourceCache(b);if(E&&!c[E.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof s.ZoomDependentExpression){c[E.id]=!0;for(const L of this.proxyCoords){const D=this.proxyToSource[L.key][E.id];if(D)for(const F of D)this._clearRenderCacheForTile(E.id,F)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const g in this._style._sourceCaches)if(this._style._sourceCaches[g]._source instanceof Wt){n=!0;break}if(!n)return;const c={};for(let g=0;g<this._style.order.length;++g){const b=this._style._layers[this._style.order[g]],E=this._style._getLayerSourceCache(b);if(!E||c[E.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const L=b.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const F=this.proxyToSource[D.key][E.id];if(F)for(const W of F){const H=hd(E.getTile(W),E.findLoadedParent(W,0),E,this.painter.transform,L);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(E.id,W)}}}}_setupDrapedRenderBatches(){const n=this._style.order,c=n.length;if(c===0)return;const g=[];let b,E=0,L=this._style._layers[n[E]];for(;!this._style.isLayerDraped(L)&&L.isHidden(this.painter.transform.zoom)&&++E<c;)L=this._style._layers[n[E]];for(;E<c;++E){const D=this._style._layers[n[E]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?b===void 0&&(b=E):b!==void 0&&(g.push({start:b,end:E-1}),b=void 0))}b!==void 0&&g.push({start:b,end:E-1}),this._drapedRenderBatches=g}_setupRenderCache(n){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const L=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let D=0;D<L.length;++D){const F=Object.values(L[D]);c.renderCachePool.push(...F)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,b=this._tilesDirty;for(let L=g.length-1;L>=0;L--){const D=g[L];if(c.getTileByID(D.key),c.proxyCachedFBO[D.key]!==void 0){const F=n[D.key],W=this.proxyToSource[D.key];let H=0;for(const Q in W){const he=W[Q],me=F[Q];if(!me||me.length!==he.length||he.some((ye,_e)=>ye!==me[_e]||b[Q]&&b[Q].hasOwnProperty(ye.key))){H=-1;break}++H}for(const Q in c.proxyCachedFBO[D.key])c.renderCache[c.proxyCachedFBO[D.key][Q]].dirty=H<0||H!==Object.values(F).length}}const E=[...this._drapedRenderBatches];E.sort((L,D)=>D.end-D.start-(L.end-L.start));for(const L of E)for(const D of g){if(c.proxyCachedFBO[D.key])continue;let F=c.renderCachePool.pop();F===void 0&&c.renderCache.length<50&&(F=c.renderCache.length,c.renderCache.push(this._createFBO())),F!==void 0&&(c.proxyCachedFBO[D.key]={},c.proxyCachedFBO[D.key][L.start]=F,c.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(n,c,g,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,L=E.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let D;if(g.isTileClipped())D=c.length,this._overlapStencilMode.test={func:L.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:L.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(n,c){const g=this.painter,b=this.painter.context,E=b.gl;g._tileClippingMaskIDs={},b.setColorMode(s.ColorMode.disabled),b.setDepthMode(s.DepthMode.disabled);const L=g.useProgram("clippingMask");for(const D of n){const F=g._tileClippingMaskIDs[D.key]=--c;L.draw(b,E.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:E.ALWAYS,mask:0},F,255,E.KEEP,E.KEEP,E.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,jc(D.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(n){const c=this.painter.transform;if(n.x<0||n.x>c.width||n.y<0||n.y>c.height)return null;const g=[n.x,n.y,1,1];s.transformMat4$1(g,g,c.pixelMatrixInverse),s.scale$1(g,g,1/g[3]),g[0]/=c.worldSize,g[1]/=c.worldSize;const b=c._camera.position,E=s.mercatorZfromAltitude(1,c.center.lat),L=[b[0],b[1],b[2]/E,0],D=s.subtract([],g.slice(0,3),L);s.normalize(D,D);const F=this.raycast(L,D,this._exaggeration);return F!==null&&F?(s.scaleAndAdd(L,L,D,F),L[3]=L[2],L[2]*=E,L):null}drawDepth(){const n=this.painter,c=n.context,g=this.proxySourceCache,b=Math.ceil(n.width),E=Math.ceil(n.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const L=c.gl,D=c.createFramebuffer(b,E,!0);c.activeTexture.set(L.TEXTURE0);const F=new s.Texture(c,{width:b,height:E,data:null},L.RGBA);F.bind(L.NEAREST,L.CLAMP_TO_EDGE),D.colorAttachment.set(F.texture);const W=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,b,E);D.depthAttachment.set(W),this._depthFBO=D,this._depthTexture=F}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,b,E]),function(L,D,F,W){if(L.transform.projection.name==="globe")return;const H=L.context,Q=H.gl;H.clear({depth:1});const he=L.useProgram("terrainDepth"),me=new s.DepthMode(Q.LESS,s.DepthMode.ReadWrite,L.depthRangeFor3D);for(const ye of W){const _e=F.getTile(ye),be=Ua(ye.projMatrix,0);D.setupElevationDraw(_e,he),he.draw(H,Q.TRIANGLES,me,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,be,"terrain_depth",D.gridBuffer,D.gridIndexBuffer,D.gridNoSkirtSegments)}}(n,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(n,c,g){if(n.getSource()instanceof Ri)return this._setupProxiedCoordsForImageSource(n,c,g);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const b=this.proxiedCoords[n.id]=[],E=this.proxyCoords;for(let D=0;D<E.length;D++){const F=E[D],W=this._findTileCoveringTileID(F,n);if(W){const H=this._createProxiedId(F,W,g[F.key]&&g[F.key][n.id]);b.push(H),this.proxyToSource[F.key][n.id]=[H]}}let L=!1;for(let D=0;D<c.length;D++){const F=n.getTile(c[D]);if(!F||!F.hasData())continue;const W=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==F.tileID.canonical.z){const H=this.proxyToSource[W.tileID.key][n.id],Q=this._createProxiedId(W.tileID,F,g[W.tileID.key]&&g[W.tileID.key][n.id]);H?H.splice(H.length-1,0,Q):this.proxyToSource[W.tileID.key][n.id]=[Q],b.push(Q),L=!0}}this._sourceTilesOverlap[n.id]=L}_setupProxiedCoordsForImageSource(n,c,g){if(!n.getSource().loaded())return;const b=this.proxiedCoords[n.id]=[],E=this.proxyCoords,L=n.getSource(),D=new s.Point(L.tileID.x,L.tileID.y)._div(1<<L.tileID.z),F=L.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((H,Q)=>(H.min.x=Math.min(H.min.x,Q.x-D.x),H.min.y=Math.min(H.min.y,Q.y-D.y),H.max.x=Math.max(H.max.x,Q.x-D.x),H.max.y=Math.max(H.max.y,Q.y-D.y),H),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(H,Q)=>{const he=H.wrap+H.canonical.x/(1<<H.canonical.z),me=H.canonical.y/(1<<H.canonical.z),ye=s.EXTENT/(1<<H.canonical.z),_e=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),be=Q.canonical.y/(1<<Q.canonical.z);return he+ye<_e+F.min.x||he>_e+F.max.x||me+ye<be+F.min.y||me>be+F.max.y};for(let H=0;H<E.length;H++){const Q=E[H];for(let he=0;he<c.length;he++){const me=n.getTile(c[he]);if(!me||!me.hasData()||W(Q,me.tileID))continue;const ye=this._createProxiedId(Q,me,g[Q.key]&&g[Q.key][n.id]),_e=this.proxyToSource[Q.key][n.id];_e?_e.push(ye):this.proxyToSource[Q.key][n.id]=[ye],b.push(ye)}}}_createProxiedId(n,c,g){let b=this.orthoMatrix;if(g){const E=g.find(L=>L.key===c.tileID.key);if(E)return E}if(c.tileID.key!==n.key){const E=n.canonical.z-c.tileID.canonical.z;let L,D,F;b=s.create();const W=c.tileID.wrap-n.wrap<<n.overscaledZ;E>0?(L=s.EXTENT>>E,D=L*((c.tileID.canonical.x<<E)-n.canonical.x+W),F=L*((c.tileID.canonical.y<<E)-n.canonical.y)):(L=s.EXTENT<<-E,D=s.EXTENT*(c.tileID.canonical.x-(n.canonical.x+W<<-E)),F=s.EXTENT*(c.tileID.canonical.y-(n.canonical.y<<-E))),s.ortho(b,0,L,0,L,0,1),s.translate(b,b,[D,F,0])}return new qh(c.tileID,n.key,b)}_findTileCoveringTileID(n,c){let g=c.getTile(n);if(g&&g.hasData())return g;const b=this._findCoveringTileCache[c.id],E=b[n.key];if(g=E?c.getTileByID(E):null,g&&g.hasData()||E===null)return g;let L=g?g.tileID:n,D=L.overscaledZ;const F=c.getSource().minzoom,W=[];if(!E){const Q=c.getSource().maxzoom;if(n.canonical.z>=Q){const he=n.canonical.z-Q;c.getSource().reparseOverscaled?(D=Math.max(n.canonical.z+2,c.transform.tileZoom),L=new s.OverscaledTileID(D,n.wrap,Q,n.canonical.x>>he,n.canonical.y>>he)):he!==0&&(D=Q,L=new s.OverscaledTileID(D,n.wrap,Q,n.canonical.x>>he,n.canonical.y>>he))}L.key!==n.key&&(W.push(L.key),g=c.getTile(L))}const H=Q=>{W.forEach(he=>{b[he]=Q}),W.length=0};for(D-=1;D>=F&&(!g||!g.hasData());D--){g&&H(g.tileID.key);const Q=L.calculateScaledKey(D);if(g=c.getTileByID(Q),g&&g.hasData())break;const he=b[Q];if(he===null)break;he===void 0?W.push(Q):g=c.getTileByID(he)}return H(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,c){let g=this._tilesDirty[n];g||(g=this._tilesDirty[n]={}),g[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const n=function(c){let g=0;const b=new s.StructArrayLayout2ui4,E=131;for(let L=1;L<129;L++){for(let D=1;D<129;D++)g=L*E+D,b.emplaceBack(g,g+1),b.emplaceBack(g,g+E),b.emplaceBack(g+1,g+E),L===128&&b.emplaceBack(g+E,g+E+1);b.emplaceBack(g+1,g+1+E)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(n),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class pr{static cacheKey(n,c,g,b){let E=`${c}${b?b.cacheKey:""}`;for(const L of g)n.usedDefines.includes(L)&&(E+=`/${L}`);return E}constructor(n,c,g,b,E,L){const D=n.gl;this.program=D.createProgram();const F=function(ee){const pe=[];for(let Ce=0;Ce<ee.length;Ce++){if(ee[Ce]===null)continue;const ke=ee[Ce].split(" ");pe.push(ke.pop())}return pe}(g.staticAttributes),W=b?b.getBinderAttributes():[],H=F.concat(W);let Q=b?b.defines():[];Q=Q.concat(L.map(ee=>`#define ${ee}`));const he=n.isWebGL2?`#version 300 es
`:"",me=he+Q.concat(n.extStandardDerivatives&&he.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Kl):Kl,Kl,Nh,Yl.fragmentSource,Xl.fragmentSource,g.fragmentSource).join(`
`),ye=he+Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Nh,Yl.vertexSource,Xl.vertexSource,Vc.vertexSource,g.vertexSource).join(`
`),_e=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(_e,me),D.compileShader(_e),D.attachShader(this.program,_e);const be=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(be,ye),D.compileShader(be),D.attachShader(this.program,be),this.attributes={},this.numAttributes=H.length;for(let ee=0;ee<this.numAttributes;ee++)H[ee]&&(D.bindAttribLocation(this.program,ee,H[ee]),this.attributes[H[ee]]=ee);D.linkProgram(this.program),D.deleteShader(be),D.deleteShader(_e),this.fixedUniforms=E(n),this.binderUniforms=b?b.getUniforms(n):[],L.includes("TERRAIN")&&(this.terrainUniforms=(ee=>({u_dem:new s.Uniform1i(ee),u_dem_prev:new s.Uniform1i(ee),u_dem_unpack:new s.Uniform4f(ee),u_dem_tl:new s.Uniform2f(ee),u_dem_scale:new s.Uniform1f(ee),u_dem_tl_prev:new s.Uniform2f(ee),u_dem_scale_prev:new s.Uniform1f(ee),u_dem_size:new s.Uniform1f(ee),u_dem_lerp:new s.Uniform1f(ee),u_exaggeration:new s.Uniform1f(ee),u_depth:new s.Uniform1i(ee),u_depth_size_inv:new s.Uniform2f(ee),u_meter_to_dem:new s.Uniform1f(ee),u_label_plane_matrix_inv:new s.UniformMatrix4f(ee)}))(n)),L.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new s.Uniform3f(ee),u_tile_tr_up:new s.Uniform3f(ee),u_tile_br_up:new s.Uniform3f(ee),u_tile_bl_up:new s.Uniform3f(ee),u_tile_up_scale:new s.Uniform1f(ee)}))(n)),L.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new s.UniformMatrix4f(ee),u_fog_range:new s.Uniform2f(ee),u_fog_color:new s.Uniform4f(ee),u_fog_horizon_blend:new s.Uniform1f(ee),u_fog_temporal_offset:new s.Uniform1f(ee),u_frustum_tl:new s.Uniform3f(ee),u_frustum_tr:new s.Uniform3f(ee),u_frustum_br:new s.Uniform3f(ee),u_frustum_bl:new s.Uniform3f(ee),u_globe_pos:new s.Uniform3f(ee),u_globe_radius:new s.Uniform1f(ee),u_globe_transition:new s.Uniform1f(ee),u_is_globe:new s.Uniform1i(ee),u_viewport:new s.Uniform2f(ee)}))(n))}}setTerrainUniformValues(n,c){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const b in c)g[b]&&g[b].set(this.program,b,c[b])}}setGlobeUniformValues(n,c){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const b in c)g[b]&&g[b].set(this.program,b,c[b])}}setFogUniformValues(n,c){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const b in c)g[b].set(this.program,b,c[b])}}draw(n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e){const be=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(g),n.setStencilMode(b),n.setColorMode(E),n.setCullFace(L);for(const pe of Object.keys(this.fixedUniforms))this.fixedUniforms[pe].set(this.program,pe,D[pe]);ye&&ye.setUniforms(this.program,n,this.binderUniforms,he,{zoom:me});const ee={[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[c];for(const pe of Q.get()){const Ce=pe.vaos||(pe.vaos={});(Ce[F]||(Ce[F]=new vm)).bind(n,this,W,ye?ye.getPaintVertexBuffers():[],H,pe.vertexOffset,_e||[]),be.drawElements(c,pe.primitiveLength*ee,be.UNSIGNED_SHORT,pe.primitiveOffset*ee*2)}}}function qo(f,n){const c=Math.pow(2,n.tileID.overscaledZ),g=n.tileSize*Math.pow(2,f.transform.tileZoom)/c,b=g*(n.tileID.canonical.x+n.tileID.wrap*c),E=g*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_tile_units_to_pixels:1/nr(n,1,f.transform.tileZoom),u_pixel_coord_upper:[b>>16,E>>16],u_pixel_coord_lower:[65535&b,65535&E]}}const dd=s.create(),Xh=(f,n,c,g,b,E,L,D,F,W,H)=>{const Q=n.style.light,he=Q.properties.get("position"),me=[he.x,he.y,he.z],ye=s.create$1();Q.properties.get("anchor")==="viewport"&&(s.fromRotation(ye,-n.transform.angle),s.transformMat3(me,me,ye));const _e=Q.properties.get("color"),be=n.transform,ee={u_matrix:f,u_lightpos:me,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[_e.r,_e.g,_e.b],u_vertical_gradient:+c,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:dd,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:b,u_edge_radius:E};return be.projection.name==="globe"&&(ee.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],ee.u_zoom_transition=F,ee.u_inv_rot_matrix=H,ee.u_merc_center=W,ee.u_up_dir=be.projection.upVector(new s.CanonicalTileID(0,0,0),W[0]*s.EXTENT,W[1]*s.EXTENT),ee.u_height_lift=D),ee},$f=(f,n,c,g,b,E,L,D,F,W,H,Q)=>{const he=Xh(f,n,c,g,b,E,L,F,W,H,Q),me={u_height_factor:-Math.pow(2,L.overscaledZ)/D.tileSize/8};return s.extend(he,qo(n,D),me)},ul=f=>({u_matrix:f}),fd=(f,n,c)=>s.extend(ul(f),qo(n,c)),pd=(f,n)=>({u_matrix:f,u_world:n}),md=(f,n,c,g)=>s.extend(fd(f,n,c),{u_world:g}),Zh=s.create(),Jl=(f,n,c,g,b,E)=>{const L=f.transform,D=L.projection.name==="globe";let F;if(E.paint.get("circle-pitch-alignment")==="map")if(D){const H=s.globePixelsToTileUnits(L.zoom,n.canonical)*L._pixelsPerMercatorPixel;F=Float32Array.from([H,0,0,H])}else F=L.calculatePixelsToTileUnitsMatrix(c);else F=new Float32Array([L.pixelsToGLUnits[0],0,0,L.pixelsToGLUnits[1]]);const W={u_camera_to_center_distance:L.cameraToCenterDistance,u_matrix:f.translatePosMatrix(n.projMatrix,c,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:F,u_inv_rot_matrix:Zh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){W.u_inv_rot_matrix=g,W.u_merc_center=b,W.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],W.u_zoom_transition=s.globeToMercatorTransition(L.zoom);const H=b[0]*s.EXTENT,Q=b[1]*s.EXTENT;W.u_up_dir=L.projection.upVector(new s.CanonicalTileID(0,0,0),H,Q)}return W},gd=f=>{const n=[];return f.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n},Yh=(f,n,c,g)=>{const b=s.EXTENT/c.tileSize;return{u_matrix:f,u_camera_to_center_distance:n.getCameraToCenterDistance(g),u_extrude_scale:[n.pixelsToGLUnits[0]/b,n.pixelsToGLUnits[1]/b]}},dl=(f,n,c=1)=>({u_matrix:f,u_color:n,u_overlay:0,u_overlay_scale:c}),Va=s.create(),Gf=(f,n,c,g,b,E,L)=>{const D=f.transform,F=D.projection.name==="globe",W=F?s.globePixelsToTileUnits(D.zoom,n.canonical)*D._pixelsPerMercatorPixel:nr(c,1,E),H={u_matrix:n.projMatrix,u_extrude_scale:W,u_intensity:L,u_inv_rot_matrix:Va,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){H.u_inv_rot_matrix=g,H.u_merc_center=b,H.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],H.u_zoom_transition=s.globeToMercatorTransition(D.zoom);const Q=b[0]*s.EXTENT,he=b[1]*s.EXTENT;H.u_up_dir=D.projection.upVector(new s.CanonicalTileID(0,0,0),Q,he)}return H},fl=(f,n,c,g,b,E,L)=>{const D=f.transform,F=D.calculatePixelsToTileUnitsMatrix(n);return{u_matrix:pl(f,n,c,g),u_pixels_to_tile_units:F,u_device_pixel_ratio:E,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:Wc(c)?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:To(n,f.transform),u_alpha_discard_threshold:0,u_trim_offset:L}},Gc=(f,n,c,g,b)=>{const E=f.transform;return{u_matrix:pl(f,n,c,g),u_texsize:n.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:b,u_image:0,u_tile_units_to_pixels:To(n,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function To(f,n){return 1/nr(f,1,n.tileZoom)}function pl(f,n,c,g){return f.translatePosMatrix(g||n.tileID.projMatrix,n,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Wc(f){const n=f.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}const Hc=(f,n,c,g,b,E)=>{return{u_matrix:f,u_tl_parent:n,u_scale_parent:c,u_fade_t:g.mix,u_opacity:g.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(D=b.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(L=b.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:Qs(b.paint.get("raster-hue-rotate")),u_perspective_transform:E};var L,D};function Qs(f){f*=Math.PI/180;const n=Math.sin(f),c=Math.cos(f);return[(2*c+1)/3,(-Math.sqrt(3)*n-c+1)/3,(Math.sqrt(3)*n-c+1)/3]}const Kh=s.create(),_d=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e)=>{const be=b.transform,ee={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:be.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:be.width/be.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:L,u_coord_matrix:D,u_is_text:+F,u_pitch_with_map:+g,u_texsize:W,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Kh,u_up_vector:[0,-1,0]};return _e.name==="globe"&&(ee.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],ee.u_zoom_transition=Q,ee.u_inv_rot_matrix=me,ee.u_merc_center=he,ee.u_camera_forward=be._camera.forward(),ee.u_ecef_origin=s.globeECEFOrigin(be.globeMatrix,H.toUnwrapped()),ee.u_tile_matrix=Float32Array.from(be.globeMatrix),ee.u_up_vector=ye),ee},Jh=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be)=>s.extend(_d(f,n,c,g,b,E,L,D,F,W,Q,he,me,ye,_e,be),{u_gamma_scale:g?b.transform.cameraToCenterDistance*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:1}),qc=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e)=>s.extend(Jh(f,n,c,g,b,E,L,D,!0,F,!0,H,Q,he,me,ye,_e),{u_texsize_icon:W,u_texture_icon:1}),yd=(f,n,c)=>({u_matrix:f,u_opacity:n,u_color:c}),bm=(f,n,c,g,b)=>s.extend(function(E,L,D){const F=L.imageManager.getPattern(E.toString()),{width:W,height:H}=L.imageManager.getPixelSize(),Q=Math.pow(2,D.tileID.overscaledZ),he=D.tileSize*Math.pow(2,L.transform.tileZoom)/Q,me=he*(D.tileID.canonical.x+D.tileID.wrap*Q),ye=he*D.tileID.canonical.y;return{u_image:0,u_pattern_tl:F.tl,u_pattern_br:F.br,u_texsize:[W,H],u_pattern_size:F.displaySize,u_tile_units_to_pixels:1/nr(D,1,L.transform.tileZoom),u_pixel_coord_upper:[me>>16,ye>>16],u_pixel_coord_lower:[65535&me,65535&ye]}}(g,c,b),{u_matrix:f,u_opacity:n}),xd={fillExtrusion:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_height_factor:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f)}),fill:f=>({u_matrix:new s.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),fillOutline:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),collisionBox:f=>({u_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new s.UniformMatrix4f(f),u_inv_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_viewport_size:new s.Uniform2f(f)}),debug:f=>({u_color:new s.UniformColor(f),u_matrix:new s.UniformMatrix4f(f),u_overlay:new s.Uniform1i(f),u_overlay_scale:new s.Uniform1f(f)}),clippingMask:f=>({u_matrix:new s.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new s.Uniform1f(f),u_intensity:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),heatmapTexture:f=>({u_image:new s.Uniform1i(f),u_color_ramp:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f)}),hillshade:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_latrange:new s.Uniform2f(f),u_light:new s.Uniform2f(f),u_shadow:new s.UniformColor(f),u_highlight:new s.UniformColor(f),u_accent:new s.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_dimension:new s.Uniform2f(f),u_zoom:new s.Uniform1f(f),u_unpack:new s.Uniform4f(f)}),line:f=>({u_matrix:new s.UniformMatrix4f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_units_to_pixels:new s.Uniform2f(f),u_dash_image:new s.Uniform1i(f),u_gradient_image:new s.Uniform1i(f),u_image_height:new s.Uniform1f(f),u_texsize:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f),u_trim_offset:new s.Uniform2f(f)}),linePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_texsize:new s.Uniform2f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_units_to_pixels:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f)}),raster:f=>({u_matrix:new s.UniformMatrix4f(f),u_tl_parent:new s.Uniform2f(f),u_scale_parent:new s.Uniform1f(f),u_fade_t:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_image0:new s.Uniform1i(f),u_image1:new s.Uniform1i(f),u_brightness_low:new s.Uniform1f(f),u_brightness_high:new s.Uniform1f(f),u_saturation_factor:new s.Uniform1f(f),u_contrast_factor:new s.Uniform1f(f),u_spin_weights:new s.Uniform3f(f),u_perspective_transform:new s.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_texture:new s.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_is_halo:new s.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texsize_icon:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_texture_icon:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_is_halo:new s.Uniform1i(f)}),background:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_color:new s.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_pattern_tl:new s.Uniform2f(f),u_pattern_br:new s.Uniform2f(f),u_texsize:new s.Uniform2f(f),u_pattern_size:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),terrainRaster:$h,terrainDepth:$h,skybox:f=>({u_matrix:new s.UniformMatrix4f(f),u_sun_direction:new s.Uniform3f(f),u_cubemap:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new s.UniformMatrix4f(f),u_color_ramp:new s.Uniform1i(f),u_center_direction:new s.Uniform3f(f),u_radius:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new s.UniformMatrix3f(f),u_sun_direction:new s.Uniform3f(f),u_sun_intensity:new s.Uniform1f(f),u_color_tint_r:new s.Uniform4f(f),u_color_tint_m:new s.Uniform4f(f),u_luminance:new s.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new s.UniformMatrix4f(f),u_globe_matrix:new s.UniformMatrix4f(f),u_normalize_matrix:new s.UniformMatrix4f(f),u_merc_matrix:new s.UniformMatrix4f(f),u_zoom_transition:new s.Uniform1f(f),u_merc_center:new s.Uniform2f(f),u_image0:new s.Uniform1i(f),u_grid_matrix:new s.UniformMatrix3f(f),u_skirt_height:new s.Uniform1f(f),u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_globe_pos:new s.Uniform3f(f),u_globe_radius:new s.Uniform1f(f),u_viewport:new s.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_horizon:new s.Uniform1f(f),u_transition:new s.Uniform1f(f),u_fadeout_range:new s.Uniform1f(f),u_color:new s.Uniform4f(f),u_high_color:new s.Uniform4f(f),u_space_color:new s.Uniform4f(f),u_star_intensity:new s.Uniform1f(f),u_star_density:new s.Uniform1f(f),u_star_size:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f),u_horizon_angle:new s.Uniform1f(f),u_rotation_matrix:new s.UniformMatrix4f(f)})};let Eo;function Xc(f,n,c,g,b,E,L){const D=f.context,F=D.gl,W=f.transform,H=f.useProgram("collisionBox"),Q=[];let he=0,me=0;for(let ke=0;ke<g.length;ke++){const Ge=g[ke],Ne=n.getTile(Ge),We=Ne.getBucket(c);if(!We)continue;const it=Ks(Ge,We,W);let et=it;b[0]===0&&b[1]===0||(et=f.translatePosMatrix(it,Ne,b,E));const ft=L?We.textCollisionBox:We.iconCollisionBox,Nt=We.collisionCircleArray;if(Nt.length>0){const ht=s.create(),Mt=et;s.mul(ht,We.placementInvProjMatrix,W.glCoordMatrix),s.mul(ht,ht,We.placementViewportMatrix),Q.push({circleArray:Nt,circleOffset:me,transform:Mt,invTransform:ht,projection:We.getProjection()}),he+=Nt.length/4,me=he}ft&&(f.terrain&&f.terrain.setupElevationDraw(Ne,H),H.draw(D,F.LINES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,Yh(et,W,Ne,We.getProjection()),c.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,null,W.zoom,null,[ft.collisionVertexBuffer,ft.collisionVertexBufferExt]))}if(!L||!Q.length)return;const ye=f.useProgram("collisionCircle"),_e=new s.StructArrayLayout2f1f2i16;_e.resize(4*he),_e._trim();let be=0;for(const ke of Q)for(let Ge=0;Ge<ke.circleArray.length/4;Ge++){const Ne=4*Ge,We=ke.circleArray[Ne+0],it=ke.circleArray[Ne+1],et=ke.circleArray[Ne+2],ft=ke.circleArray[Ne+3];_e.emplace(be++,We,it,et,ft,0),_e.emplace(be++,We,it,et,ft,1),_e.emplace(be++,We,it,et,ft,2),_e.emplace(be++,We,it,et,ft,3)}(!Eo||Eo.length<2*he)&&(Eo=function(ke){const Ge=2*ke,Ne=new s.StructArrayLayout3ui6;Ne.resize(Ge),Ne._trim();for(let We=0;We<Ge;We++){const it=6*We;Ne.uint16[it+0]=4*We+0,Ne.uint16[it+1]=4*We+1,Ne.uint16[it+2]=4*We+2,Ne.uint16[it+3]=4*We+2,Ne.uint16[it+4]=4*We+3,Ne.uint16[it+5]=4*We+0}return Ne}(he));const ee=D.createIndexBuffer(Eo,!0),pe=D.createVertexBuffer(_e,s.collisionCircleLayout.members,!0);for(const ke of Q){const Ge={u_matrix:ke.transform,u_inv_matrix:ke.invTransform,u_camera_to_center_distance:(Ce=W).getCameraToCenterDistance(ke.projection),u_viewport_size:[Ce.width,Ce.height]};ye.draw(D,F.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,Ge,c.id,pe,ee,s.SegmentVector.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,W.zoom)}var Ce;pe.destroy(),ee.destroy()}const vd=s.create();function bd({width:f,height:n,anchor:c,textOffset:g,textScale:b},E){const{horizontalAlign:L,verticalAlign:D}=s.getAnchorAlignment(c),F=-(L-.5)*f,W=-(D-.5)*n,H=s.evaluateVariableOffset(c,g);return new s.Point((F/b+H[0])*E,(W/b+H[1])*E)}function wm(f,n,c,g,b,E,L,D,F,W,H){const Q=f.text.placedSymbolArray,he=f.text.dynamicLayoutVertexArray,me=f.icon.dynamicLayoutVertexArray,ye={},_e=f.getProjection(),be=sn(D,_e,E),ee=E.elevation,pe=_e.upVectorScale(D.canonical,E.center.lat,E.worldSize).metersToTile;he.clear();for(let Ce=0;Ce<Q.length;Ce++){const ke=Q.get(Ce),{tileAnchorX:Ge,tileAnchorY:Ne,numGlyphs:We}=ke,it=ke.hidden||!ke.crossTileID||f.allowVerticalPlacement&&!ke.placedOrientation?null:g[ke.crossTileID];if(it){let et=0,ft=0,Nt=0;if(ee){const Ht=ee?ee.getAtTileOffset(D,Ge,Ne):0,[Ii,Fi,vi]=_e.upVector(D.canonical,Ge,Ne);et=Ht*Ii*pe,ft=Ht*Fi*pe,Nt=Ht*vi*pe}let[ht,Mt,_t,Vt]=Jn(ke.projectedAnchorX+et,ke.projectedAnchorY+ft,ke.projectedAnchorZ+Nt,c?be:L);const lt=Nf(E.getCameraToCenterDistance(_e),Vt);let kt=b.evaluateSizeForFeature(f.textSizeData,W,ke)*lt/s.ONE_EM;c&&(kt*=f.tilePixelRatio/F);const jt=bd(it,kt);c?({x:ht,y:Mt,z:_t}=_e.projectTilePoint(Ge+jt.x,Ne+jt.y,D.canonical),[ht,Mt,_t]=Jn(ht+et,Mt+ft,_t+Nt,L)):(n&&jt._rotate(-E.angle),ht+=jt.x,Mt+=jt.y,_t=0);const Ct=f.allowVerticalPlacement&&ke.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<We;Ht++)s.addDynamicAttributes(he,ht,Mt,_t,Ct);H&&ke.associatedIconIndex>=0&&(ye[ke.associatedIconIndex]={x:ht,y:Mt,z:_t,angle:Ct})}else Ys(We,he)}if(H){me.clear();const Ce=f.icon.placedSymbolArray;for(let ke=0;ke<Ce.length;ke++){const Ge=Ce.get(ke),{numGlyphs:Ne}=Ge,We=ye[ke];if(Ge.hidden||!We)Ys(Ne,me);else{const{x:it,y:et,z:ft,angle:Nt}=We;for(let ht=0;ht<Ne;ht++)s.addDynamicAttributes(me,it,et,ft,Nt)}}f.icon.dynamicLayoutVertexBuffer.updateData(me)}f.text.dynamicLayoutVertexBuffer.updateData(he)}function Ql(f,n,c){return c.iconsInText&&n?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Wf(f,n,c,g,b,E,L,D,F,W,H,Q){const he=f.context,me=he.gl,ye=f.transform,_e=D==="map",be=F==="map",ee=_e&&c.layout.get("symbol-placement")!=="point",pe=_e&&!be&&!ee,Ce=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ke=!1;const Ge=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),Ne=[s.mercatorXfromLng(ye.center.lng),s.mercatorYfromLat(ye.center.lat)],We=c.layout.get("text-variable-anchor"),it=ye.projection.name==="globe",et=[],ft=[0,-1,0];let Nt=ft;!it&&!ye.mercatorFromTransition||_e||(Nt=function(ht){const Mt=ht._camera.getWorldToCamera(ht.worldSize,1),_t=s.multiply([],Mt,ht.globeMatrix);s.invert(_t,_t);const Vt=[0,0,0],lt=[0,1,0,0];return s.transformMat4$1(lt,lt,_t),Vt[0]=lt[0],Vt[1]=lt[1],Vt[2]=lt[2],s.normalize(Vt,Vt),Vt}(ye));for(const ht of g){const Mt=n.getTile(ht),_t=Mt.getBucket(c);if(!_t||_t.projection.name==="mercator"&&it)continue;const Vt=b?_t.text:_t.icon;if(!Vt||_t.fullyClipped||!Vt.segments.get().length)continue;const lt=Vt.programConfigurations.get(c.id),kt=b||_t.sdfIcons,jt=b?_t.textSizeData:_t.iconSizeData,Ct=be||ye.pitch!==0,Ht=s.evaluateSizeForZoom(jt,ye.zoom);let Ii,Fi,vi,Pi,Gi=[0,0],Wi=null;if(b)Fi=Mt.glyphAtlasTexture,vi=me.LINEAR,Ii=Mt.glyphAtlasTexture.size,_t.iconsInText&&(Gi=Mt.imageAtlasTexture.size,Wi=Mt.imageAtlasTexture,Pi=Ct||f.options.rotating||f.options.zooming||jt.kind==="composite"||jt.kind==="camera"?me.LINEAR:me.NEAREST);else{const Yo=c.layout.get("icon-size").constantOr(0)!==1||_t.iconsNeedLinear;Fi=Mt.imageAtlasTexture,vi=kt||f.options.rotating||f.options.zooming||Yo||Ct?me.LINEAR:me.NEAREST,Ii=Mt.imageAtlasTexture.size}const Ci=_t.projection.name==="globe",Ar=Ci?Nt:ft,Lr=Ci?s.globeToMercatorTransition(ye.zoom):0,Dr=sn(ht,_t.getProjection(),ye),Or=ye.calculatePixelsToTileUnitsMatrix(Mt),gs=Et(Dr,Mt.tileID.canonical,be,_e,ye,_t.getProjection(),Or),is=f.terrain&&be&&ee?s.invert(s.create(),gs):vd,ro=Bn(Dr,Mt.tileID.canonical,be,_e,ye,_t.getProjection(),Or),kr=We&&_t.hasTextData(),Zr=c.layout.get("icon-text-fit")!=="none"&&kr&&_t.hasIconData();if(ee){const Yo=ye.elevation,Ea=Yo?Yo.getAtTileOffsetFunc(ht,ye.center.lat,ye.worldSize,_t.getProjection()):null,wl=jo(Dr,Mt.tileID.canonical,be,_e,ye,_t.getProjection(),Or);zh(_t,Dr,f,b,wl,ro,be,W,Ea,ht)}const Ur=ee||b&&We||Zr,mr=f.translatePosMatrix(Dr,Mt,E,L),Fn=Ur?vd:gs,Es=f.translatePosMatrix(ro,Mt,E,L,!0),Yr=_t.getProjection().createInversionMatrix(ye,ht.canonical),Wn=[];f.terrainRenderModeElevated()&&be&&Wn.push("PITCH_WITH_MAP_TERRAIN"),Ci&&Wn.push("PROJECTION_GLOBE_VIEW"),Ur&&Wn.push("PROJECTED_POS_ON_VIEWPORT");const hu=kt&&c.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ta;Ta=kt?_t.iconsInText?qc(jt.kind,Ht,pe,be,f,mr,Fn,Es,Ii,Gi,ht,Lr,Ne,Yr,Ar,_t.getProjection()):Jh(jt.kind,Ht,pe,be,f,mr,Fn,Es,b,Ii,!0,ht,Lr,Ne,Yr,Ar,_t.getProjection()):_d(jt.kind,Ht,pe,be,f,mr,Fn,Es,b,Ii,ht,Lr,Ne,Yr,Ar,_t.getProjection());const dc={program:f.useProgram(Ql(kt,b,_t),lt,Wn),buffers:Vt,uniformValues:Ta,atlasTexture:Fi,atlasTextureIcon:Wi,atlasInterpolation:vi,atlasInterpolationIcon:Pi,isSDF:kt,hasHalo:hu,tile:Mt,labelPlaneMatrixInv:is};if(Ce&&_t.canOverlap){ke=!0;const Yo=Vt.segments.get();for(const Ea of Yo)et.push({segments:new s.SegmentVector([Ea]),sortKey:Ea.sortKey,state:dc})}else et.push({segments:Vt.segments,sortKey:0,state:dc})}ke&&et.sort((ht,Mt)=>ht.sortKey-Mt.sortKey);for(const ht of et){const Mt=ht.state;if(f.terrain&&f.terrain.setupElevationDraw(Mt.tile,Mt.program,{useDepthForOcclusion:!it,labelPlaneMatrixInv:Mt.labelPlaneMatrixInv}),he.activeTexture.set(me.TEXTURE0),Mt.atlasTexture.bind(Mt.atlasInterpolation,me.CLAMP_TO_EDGE),Mt.atlasTextureIcon&&(he.activeTexture.set(me.TEXTURE1),Mt.atlasTextureIcon&&Mt.atlasTextureIcon.bind(Mt.atlasInterpolationIcon,me.CLAMP_TO_EDGE)),Mt.isSDF){const _t=Mt.uniformValues;Mt.hasHalo&&(_t.u_is_halo=1,Zc(Mt.buffers,ht.segments,c,f,Mt.program,Ge,H,Q,_t)),_t.u_is_halo=0}Zc(Mt.buffers,ht.segments,c,f,Mt.program,Ge,H,Q,Mt.uniformValues)}}function Zc(f,n,c,g,b,E,L,D,F){const W=g.context,H=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];b.draw(W,W.gl.TRIANGLES,E,L,D,s.CullFaceMode.disabled,F,c.id,f.layoutVertexBuffer,f.indexBuffer,n,c.paint,g.transform.zoom,f.programConfigurations.get(c.id),H)}function wd(f,n,c,g,b,E,L){const D=f.context.gl,F=c.paint.get("fill-pattern"),W=F&&F.constantOr(1);let H,Q,he,me,ye;L?(Q=W&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=D.LINES):(Q=W?"fillPattern":"fill",H=D.TRIANGLES);for(const _e of g){const be=n.getTile(_e);if(W&&!be.patternsLoaded())continue;const ee=be.getBucket(c);if(!ee)continue;f.prepareDrawTile();const pe=ee.programConfigurations.get(c.id),Ce=f.useProgram(Q,pe);W&&(f.context.activeTexture.set(D.TEXTURE0),be.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),pe.updatePaintBuffers());const ke=F.constantOr(null);if(ke&&be.imageAtlas){const Ne=be.imageAtlas.patternPositions[ke.toString()];Ne&&pe.setConstantPatternPositions(Ne)}const Ge=f.translatePosMatrix(_e.projMatrix,be,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(L){me=ee.indexBuffer2,ye=ee.segments2;const Ne=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];he=Q==="fillOutlinePattern"&&W?md(Ge,f,be,Ne):pd(Ge,Ne)}else me=ee.indexBuffer,ye=ee.segments,he=W?fd(Ge,f,be):ul(Ge);f.prepareDrawProgram(f.context,Ce,_e.toUnwrapped()),Ce.draw(f.context,H,b,f.stencilModeForClipping(_e),E,s.CullFaceMode.disabled,he,c.id,ee.layoutVertexBuffer,me,ye,c.paint,f.transform.zoom,pe)}}function Qh(f,n,c,g,b,E,L){const D=f.context,F=D.gl,W=f.transform,H=c.paint.get("fill-extrusion-pattern"),Q=H.constantOr(1),he=c.paint.get("fill-extrusion-opacity"),me=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],ye=c.layout.get("fill-extrusion-edge-radius"),_e=ye>0&&!c.paint.get("fill-extrusion-rounded-roof"),be=_e?0:ye,ee=W.projection.name==="globe"?s.fillExtrusionHeightLift():0,pe=W.projection.name==="globe",Ce=pe?s.globeToMercatorTransition(W.zoom):0,ke=[s.mercatorXfromLng(W.center.lng),s.mercatorYfromLat(W.center.lat)],Ge=[];pe&&Ge.push("PROJECTION_GLOBE_VIEW"),me[0]>0&&Ge.push("FAUX_AO"),_e&&Ge.push("ZERO_ROOF_RADIUS");for(const Ne of g){const We=n.getTile(Ne),it=We.getBucket(c);if(!it||it.projection.name!==W.projection.name)continue;const et=it.programConfigurations.get(c.id),ft=f.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",et,Ge);if(f.terrain){const kt=f.terrain;if(f.style.terrainSetForDrapingOnly())kt.setupElevationDraw(We,ft,{useMeterToDem:!0});else{if(!it.enableTerrain)continue;if(kt.setupElevationDraw(We,ft,{useMeterToDem:!0}),ml(D,n,Ne,it,c,kt),!it.centroidVertexBuffer){const jt=ft.attributes.a_centroid_pos;jt!==void 0&&F.vertexAttrib2f(jt,0,0)}}}Q&&(f.context.activeTexture.set(F.TEXTURE0),We.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),et.updatePaintBuffers());const Nt=H.constantOr(null);if(Nt&&We.imageAtlas){const kt=We.imageAtlas.patternPositions[Nt.toString()];kt&&et.setConstantPatternPositions(kt)}const ht=f.translatePosMatrix(Ne.projMatrix,We,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Mt=W.projection.createInversionMatrix(W,Ne.canonical),_t=c.paint.get("fill-extrusion-vertical-gradient"),Vt=Q?$f(ht,f,_t,he,me,be,Ne,We,ee,Ce,ke,Mt):Xh(ht,f,_t,he,me,be,Ne,ee,Ce,ke,Mt);f.prepareDrawProgram(D,ft,Ne.toUnwrapped());const lt=[];f.terrain&&lt.push(it.centroidVertexBuffer),pe&&lt.push(it.layoutVertexExtBuffer),ft.draw(D,D.gl.TRIANGLES,b,E,L,s.CullFaceMode.backCCW,Vt,c.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,c.paint,f.transform.zoom,et,lt)}}function ml(f,n,c,g,b,E){const L=[ee=>{let pe=ee.canonical.x-1,Ce=ee.wrap;return pe<0&&(pe=(1<<ee.canonical.z)-1,Ce--),new s.OverscaledTileID(ee.overscaledZ,Ce,ee.canonical.z,pe,ee.canonical.y)},ee=>{let pe=ee.canonical.x+1,Ce=ee.wrap;return pe===1<<ee.canonical.z&&(pe=0,Ce++),new s.OverscaledTileID(ee.overscaledZ,Ce,ee.canonical.z,pe,ee.canonical.y)},ee=>new s.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,(ee.canonical.y===0?1<<ee.canonical.z:ee.canonical.y)-1),ee=>new s.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y===(1<<ee.canonical.z)-1?0:ee.canonical.y+1)],D=ee=>{const pe=n.getSource().minzoom,Ce=Ge=>{const Ne=n.getTileByID(Ge);if(Ne&&Ne.hasData())return Ne.getBucket(b)},ke=[0,-1,1];for(const Ge of ke){if(ee.overscaledZ+Ge<pe)continue;const Ne=Ce(ee.calculateScaledKey(ee.overscaledZ+Ge));if(Ne)return Ne}},F=[0,0,0],W=(ee,pe)=>(F[0]=Math.min(ee.min.y,pe.min.y),F[1]=Math.max(ee.max.y,pe.max.y),F[2]=s.EXTENT-pe.min.x>ee.max.x?pe.min.x-s.EXTENT:ee.max.x,F),H=(ee,pe)=>(F[0]=Math.min(ee.min.x,pe.min.x),F[1]=Math.max(ee.max.x,pe.max.x),F[2]=s.EXTENT-pe.min.y>ee.max.y?pe.min.y-s.EXTENT:ee.max.y,F),Q=[(ee,pe)=>W(ee,pe),(ee,pe)=>W(pe,ee),(ee,pe)=>H(ee,pe),(ee,pe)=>H(pe,ee)],he=new s.Point(0,0);let me,ye,_e;const be=(ee,pe,Ce,ke,Ge)=>{const Ne=[[ke?Ce:ee,ke?ee:Ce,0],[ke?Ce:pe,ke?pe:Ce,0]],We=Ge<0?s.EXTENT+Ge:Ge,it=[ke?We:(ee+pe)/2,ke?(ee+pe)/2:We,0];return Ce===0&&Ge<0||Ce!==0&&Ge>0?E.getForTilePoints(_e,[it],!0,ye):Ne.push(it),E.getForTilePoints(c,Ne,!0,me),Math.max(Ne[0][2],Ne[1][2],it[2])/E.exaggeration()};for(let ee=0;ee<4;ee++){const pe=(ee<2?1:5)-ee,Ce=g.borders[ee];if(Ce.length===0)continue;const ke=_e=L[ee](c),Ge=D(ke);if(!(Ge&&Ge instanceof s.FillExtrusionBucket&&Ge.enableTerrain)||g.borderDoneWithNeighborZ[ee]===Ge.canonical.z&&Ge.borderDoneWithNeighborZ[pe]===g.canonical.z||(ye=E.findDEMTileFor(ke),!ye||!ye.dem))continue;if(!me){const et=E.findDEMTileFor(c);if(!et||!et.dem)return;me=et}const Ne=Ge.borders[pe];let We=0;const it=Ge.borderDoneWithNeighborZ[pe]!==g.canonical.z;if(g.canonical.z===Ge.canonical.z){for(let et=0;et<Ce.length;et++){const ft=g.featuresOnBorder[Ce[et]],Nt=ft.borders[ee];let ht;for(;We<Ne.length&&(ht=Ge.featuresOnBorder[Ne[We]],!(ht.borders[pe][1]>Nt[0]+3));)it&&Ge.encodeCentroid(void 0,ht,!1),We++;if(ht&&We<Ne.length){const Mt=We;let _t=0;for(;!(ht.borders[pe][0]>Nt[1]-3)&&(_t++,++We!==Ne.length);)ht=Ge.featuresOnBorder[Ne[We]];if(ht=Ge.featuresOnBorder[Ne[Mt]],ft.intersectsCount()>1||ht.intersectsCount()>1||_t!==1){_t!==1&&(We=Mt),g.encodeCentroid(void 0,ft,!1),it&&Ge.encodeCentroid(void 0,ht,!1);continue}const Vt=Q[ee](ft,ht),lt=ee%2?s.EXTENT-1:0;he.x=be(Vt[0],Math.min(s.EXTENT-1,Vt[1]),lt,ee<2,Vt[2]),he.y=0,g.encodeCentroid(he,ft,!1),it&&Ge.encodeCentroid(he,ht,!1)}else g.encodeCentroid(void 0,ft,!1)}g.borderDoneWithNeighborZ[ee]=Ge.canonical.z,g.needsCentroidUpdate=!0,it&&(Ge.borderDoneWithNeighborZ[pe]=g.canonical.z,Ge.needsCentroidUpdate=!0)}else{for(const et of Ce)g.encodeCentroid(void 0,g.featuresOnBorder[et],!1);if(it){for(const et of Ne)Ge.encodeCentroid(void 0,Ge.featuresOnBorder[et],!1);Ge.borderDoneWithNeighborZ[pe]=g.canonical.z,Ge.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[ee]=Ge.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(f)}const eo=new s.Color(1,0,0,1),Tm=new s.Color(0,1,0,1),Em=new s.Color(0,0,1,1),Sm=new s.Color(1,0,1,1),Cm=new s.Color(0,1,1,1);function Am(f,n,c){const g=f.context,b=f.transform,E=g.gl,L=b.projection.name==="globe",D=L?["PROJECTION_GLOBE_VIEW"]:null;let F=c.projMatrix;if(L&&s.globeToMercatorTransition(b.zoom)>0){const ft=s.transitionTileAABBinECEF(c.canonical,b),Nt=s.globeDenormalizeECEF(ft);F=s.multiply(new Float32Array(16),b.globeMatrix,Nt),s.multiply(F,b.projMatrix,F)}const W=f.useProgram("debug",null,D),H=n.getTileByID(c.key);f.terrain&&f.terrain.setupElevationDraw(H,W);const Q=s.DepthMode.disabled,he=s.StencilMode.disabled,me=f.colorModeForRenderPass(),ye="$debug";g.activeTexture.set(E.TEXTURE0),f.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),L?H._makeGlobeTileDebugBuffers(f.context,b):H._makeDebugTileBoundsBuffers(f.context,b.projection);const _e=H._tileDebugBuffer||f.debugBuffer,be=H._tileDebugIndexBuffer||f.debugIndexBuffer,ee=H._tileDebugSegments||f.debugSegments;W.draw(g,E.LINE_STRIP,Q,he,me,s.CullFaceMode.disabled,dl(F,s.Color.red),ye,_e,be,ee,null,null,null,[H._globeTileDebugBorderBuffer]);const pe=H.latestRawTileData,Ce=Math.floor((pe&&pe.byteLength||0)/1024),ke=n.getTile(c).tileSize,Ge=512/Math.min(ke,512)*(c.overscaledZ/b.zoom)*.5;let Ne=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Ne+=` => ${c.overscaledZ}`),Ne+=` ${Ce}kb`,function(ft,Nt){ft.initDebugOverlayCanvas();const ht=ft.debugOverlayCanvas,Mt=ft.context.gl,_t=ft.debugOverlayCanvas.getContext("2d");_t.clearRect(0,0,ht.width,ht.height),_t.shadowColor="white",_t.shadowBlur=2,_t.lineWidth=1.5,_t.strokeStyle="white",_t.textBaseline="top",_t.font="bold 36px Open Sans, sans-serif",_t.fillText(Nt,5,5),_t.strokeText(Nt,5,5),ft.debugOverlayTexture.update(ht),ft.debugOverlayTexture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE)}(f,Ne);const We=H._tileDebugTextBuffer||f.debugBuffer,it=H._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,et=H._tileDebugTextSegments||f.debugSegments;W.draw(g,E.TRIANGLES,Q,he,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,dl(F,s.Color.transparent,Ge),ye,We,it,et,null,null,null,[H._globeTileDebugTextBuffer])}function Yc(f,n,c,g){tc(f,0,n+c/2,f.transform.width,c,g)}function ec(f,n,c,g){tc(f,n-c/2,0,c,f.transform.height,g)}function tc(f,n,c,g,b,E){const L=f.context,D=L.gl;D.enable(D.SCISSOR_TEST),D.scissor(n*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,g*s.exported.devicePixelRatio,b*s.exported.devicePixelRatio),L.clear({color:E}),D.disable(D.SCISSOR_TEST)}const Kc=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:eu}=Kc;function xa(f,n,c,g){f.emplaceBack(n,c,g)}class Jc{constructor(n){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,xa(this.vertexArray,-1,-1,1),xa(this.vertexArray,1,-1,1),xa(this.vertexArray,-1,1,1),xa(this.vertexArray,1,1,1),xa(this.vertexArray,-1,-1,-1),xa(this.vertexArray,1,-1,-1),xa(this.vertexArray,-1,1,-1),xa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,eu),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function fs(f,n,c,g,b,E){const L=f.gl,D=n.paint.get("sky-atmosphere-color"),F=n.paint.get("sky-atmosphere-halo-color"),W=n.paint.get("sky-atmosphere-sun-intensity"),H=((Q,he,me,ye,_e)=>({u_matrix_3f:Q,u_sun_direction:he,u_sun_intensity:me,u_color_tint_r:[ye.r,ye.g,ye.b,ye.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),g),b,W,D,F);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+E,n.skyboxTexture,0),c.draw(f,L.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,H,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Qc=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class eh{constructor(n){const c=new s.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const g=new s.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(c,Qc.members),this.indexBuffer=n.createIndexBuffer(g),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const gl={symbol:function(f,n,c,g,b){if(f.renderPass!=="translucent")return;const E=s.StencilMode.disabled,L=f.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(D,F,W,H,Q,he,me){const ye=F.transform,_e=Q==="map",be=he==="map";for(const ee of D){const pe=H.getTile(ee),Ce=pe.getBucket(W);if(!Ce||!Ce.text||!Ce.text.segments.get().length)continue;const ke=s.evaluateSizeForZoom(Ce.textSizeData,ye.zoom),Ge=sn(ee,Ce.getProjection(),ye),Ne=ye.calculatePixelsToTileUnitsMatrix(pe),We=Et(Ge,pe.tileID.canonical,be,_e,ye,Ce.getProjection(),Ne),it=W.layout.get("icon-text-fit")!=="none"&&Ce.hasIconData();if(ke){const et=Math.pow(2,ye.zoom-pe.tileID.overscaledZ);wm(Ce,_e,be,me,s.symbolSize,ye,We,ee,et,ke,it)}}}(g,f,c,n,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),b),c.paint.get("icon-opacity").constantOr(1)!==0&&Wf(f,n,c,g,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),E,L),c.paint.get("text-opacity").constantOr(1)!==0&&Wf(f,n,c,g,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),E,L),n.map.showCollisionBoxes&&(Xc(f,n,c,g,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Xc(f,n,c,g,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(f,n,c,g){if(f.renderPass!=="translucent")return;const b=c.paint.get("circle-opacity"),E=c.paint.get("circle-stroke-width"),L=c.paint.get("circle-stroke-opacity"),D=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(b.constantOr(1)===0&&(E.constantOr(1)===0||L.constantOr(1)===0))return;const F=f.context,W=F.gl,H=f.transform,Q=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),he=s.StencilMode.disabled,me=f.colorModeForRenderPass(),ye=H.projection.name==="globe",_e=[s.mercatorXfromLng(H.center.lng),s.mercatorYfromLat(H.center.lat)],be=[];for(let pe=0;pe<g.length;pe++){const Ce=g[pe],ke=n.getTile(Ce),Ge=ke.getBucket(c);if(!Ge||Ge.projection.name!==H.projection.name)continue;const Ne=Ge.programConfigurations.get(c.id),We=gd(c);ye&&We.push("PROJECTION_GLOBE_VIEW");const it=f.useProgram("circle",Ne,We),et=Ge.layoutVertexBuffer,ft=Ge.globeExtVertexBuffer,Nt=Ge.indexBuffer,ht=H.projection.createInversionMatrix(H,Ce.canonical),Mt={programConfiguration:Ne,program:it,layoutVertexBuffer:et,globeExtVertexBuffer:ft,indexBuffer:Nt,uniformValues:Jl(f,Ce,ke,ht,_e,c),tile:ke};if(D){const _t=Ge.segments.get();for(const Vt of _t)be.push({segments:new s.SegmentVector([Vt]),sortKey:Vt.sortKey,state:Mt})}else be.push({segments:Ge.segments,sortKey:0,state:Mt})}D&&be.sort((pe,Ce)=>pe.sortKey-Ce.sortKey);const ee={useDepthForOcclusion:!ye};for(const pe of be){const{programConfiguration:Ce,program:ke,layoutVertexBuffer:Ge,globeExtVertexBuffer:Ne,indexBuffer:We,uniformValues:it,tile:et}=pe.state,ft=pe.segments;f.terrain&&f.terrain.setupElevationDraw(et,ke,ee),f.prepareDrawProgram(F,ke,et.tileID.toUnwrapped()),ke.draw(F,W.TRIANGLES,Q,he,me,s.CullFaceMode.disabled,it,c.id,Ge,We,ft,c.paint,H.zoom,Ce,[Ne])}},heatmap:function(f,n,c,g){if(c.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const b=f.context,E=b.gl,L=s.StencilMode.disabled,D=new s.ColorMode([E.ONE,E.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(me,ye,_e,be){const ee=me.gl,pe=ye.width*be,Ce=ye.height*be;me.activeTexture.set(ee.TEXTURE1),me.viewport.set([0,0,pe,Ce]);let ke=_e.heatmapFbo;if(!ke||ke&&(ke.width!==pe||ke.height!==Ce)){ke&&ke.destroy();const Ge=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,Ge),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),ke=_e.heatmapFbo=me.createFramebuffer(pe,Ce,!1),function(Ne,We,it,et,ft,Nt){const ht=Ne.gl;ht.texImage2D(ht.TEXTURE_2D,0,Ne.isWebGL2&&Ne.extRenderToTextureHalfFloat?ht.RGBA16F:ht.RGBA,ft,Nt,0,ht.RGBA,Ne.extRenderToTextureHalfFloat?Ne.isWebGL2?ht.HALF_FLOAT:Ne.extTextureHalfFloat.HALF_FLOAT_OES:ht.UNSIGNED_BYTE,null),et.colorAttachment.set(it)}(me,0,Ge,ke,pe,Ce)}else ee.bindTexture(ee.TEXTURE_2D,ke.colorAttachment.get()),me.bindFramebuffer.set(ke.framebuffer)})(b,f,c,f.transform.projection.name==="globe"?.5:.25),b.clear({color:s.Color.transparent});const F=f.transform,W=F.projection.name==="globe",H=W?["PROJECTION_GLOBE_VIEW"]:null,Q=W?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,he=[s.mercatorXfromLng(F.center.lng),s.mercatorYfromLat(F.center.lat)];for(let me=0;me<g.length;me++){const ye=g[me];if(n.hasRenderableParent(ye))continue;const _e=n.getTile(ye),be=_e.getBucket(c);if(!be||be.projection.name!==F.projection.name)continue;const ee=be.programConfigurations.get(c.id),pe=f.useProgram("heatmap",ee,H),{zoom:Ce}=f.transform;f.terrain&&f.terrain.setupElevationDraw(_e,pe),f.prepareDrawProgram(b,pe,ye.toUnwrapped());const ke=F.projection.createInversionMatrix(F,ye.canonical);pe.draw(b,E.TRIANGLES,s.DepthMode.disabled,L,D,Q,Gf(f,ye,_e,ke,he,Ce,c.paint.get("heatmap-intensity")),c.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,c.paint,f.transform.zoom,ee,W?[be.globeExtVertexBuffer]:null)}b.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(b,E){const L=b.context,D=L.gl,F=E.heatmapFbo;if(!F)return;L.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,F.colorAttachment.get()),L.activeTexture.set(D.TEXTURE1);let W=E.colorRampTexture;W||(W=E.colorRampTexture=new s.Texture(L,E.colorRamp,D.RGBA)),W.bind(D.LINEAR,D.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(L,D.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,b.colorModeForRenderPass(),s.CullFaceMode.disabled,((H,Q,he,me)=>({u_image:0,u_color_ramp:1,u_opacity:Q.paint.get("heatmap-opacity")}))(0,E),E.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,E.paint,b.transform.zoom)}(f,c))},line:function(f,n,c,g){if(f.renderPass!=="translucent")return;const b=c.paint.get("line-opacity"),E=c.paint.get("line-width");if(b.constantOr(1)===0||E.constantOr(1)===0)return;const L=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),D=f.colorModeForRenderPass(),F=f.terrain&&f.terrain.renderingToTexture?1:s.exported.devicePixelRatio,W=c.paint.get("line-dasharray"),H=W.constantOr(1),Q=c.layout.get("line-cap"),he=c.paint.get("line-pattern"),me=he.constantOr(1),ye=c.paint.get("line-gradient"),_e=me?"linePattern":"line",be=f.context,ee=be.gl,pe=(ke=>{const Ge=[];Wc(ke)&&Ge.push("RENDER_LINE_DASH"),ke.paint.get("line-gradient")&&Ge.push("RENDER_LINE_GRADIENT");const Ne=ke.paint.get("line-trim-offset");Ne[0]===0&&Ne[1]===0||Ge.push("RENDER_LINE_TRIM_OFFSET");const We=ke.paint.get("line-pattern").constantOr(1),it=ke.paint.get("line-opacity").constantOr(1)!==1;return!We&&it&&Ge.push("RENDER_LINE_ALPHA_DISCARD"),Ge})(c);let Ce=pe.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(Ce=!1);for(const ke of g){const Ge=n.getTile(ke);if(me&&!Ge.patternsLoaded())continue;const Ne=Ge.getBucket(c);if(!Ne)continue;f.prepareDrawTile();const We=Ne.programConfigurations.get(c.id),it=f.useProgram(_e,We,pe),et=he.constantOr(null);if(et&&Ge.imageAtlas){const kt=Ge.imageAtlas.patternPositions[et.toString()];kt&&We.setConstantPatternPositions(kt)}const ft=W.constantOr(null),Nt=Q.constantOr(null);if(!me&&ft&&Nt&&Ge.lineAtlas){const kt=Ge.lineAtlas.getDash(ft,Nt);kt&&We.setConstantPatternPositions(kt)}let[ht,Mt]=c.paint.get("line-trim-offset");(Nt==="round"||Nt==="square")&&ht!==Mt&&(ht===0&&(ht-=1),Mt===1&&(Mt+=1));const _t=f.terrain?ke.projMatrix:null,Vt=me?Gc(f,Ge,c,_t,F):fl(f,Ge,c,_t,Ne.lineClipsArray.length,F,[ht,Mt]);if(ye){const kt=Ne.gradients[c.id];let jt=kt.texture;if(c.gradientVersion!==kt.version){let Ct=256;if(c.stepInterpolant){const Ht=n.getSource().maxzoom,Ii=ke.canonical.z===Ht?Math.ceil(1<<f.transform.maxZoom-ke.canonical.z):1;Ct=s.clamp(s.nextPowerOfTwo(Ne.maxLineLength/s.EXTENT*1024*Ii),256,be.maxTextureSize)}kt.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Ct,image:kt.gradient||void 0,clips:Ne.lineClipsArray}),kt.texture?kt.texture.update(kt.gradient):kt.texture=new s.Texture(be,kt.gradient,ee.RGBA),kt.version=c.gradientVersion,jt=kt.texture}be.activeTexture.set(ee.TEXTURE1),jt.bind(c.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}H&&(be.activeTexture.set(ee.TEXTURE0),Ge.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),We.updatePaintBuffers()),me&&(be.activeTexture.set(ee.TEXTURE0),Ge.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),We.updatePaintBuffers()),f.prepareDrawProgram(be,it,ke.toUnwrapped());const lt=kt=>{it.draw(be,ee.TRIANGLES,L,kt,D,s.CullFaceMode.disabled,Vt,c.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,c.paint,f.transform.zoom,We,[Ne.layoutVertexBuffer2])};if(Ce){const kt=f.stencilModeForClipping(ke).ref;kt===0&&f.terrain&&be.clear({stencil:0});const jt={func:ee.EQUAL,mask:255};Vt.u_alpha_discard_threshold=.8,lt(new s.StencilMode(jt,kt,255,ee.KEEP,ee.KEEP,ee.INVERT)),Vt.u_alpha_discard_threshold=0,lt(new s.StencilMode(jt,kt,255,ee.KEEP,ee.KEEP,ee.KEEP))}else lt(f.stencilModeForClipping(ke))}Ce&&(f.resetStencilClippingMasks(),f.terrain&&be.clear({stencil:0}))},fill:function(f,n,c,g){const b=c.paint.get("fill-color"),E=c.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const L=f.colorModeForRenderPass(),D=c.paint.get("fill-pattern"),F=f.opaquePassEnabledForLayer()&&!D.constantOr(1)&&b.constantOr(s.Color.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===F){const W=f.depthModeForSublayer(1,f.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);wd(f,n,c,g,W,L,!1)}if(f.renderPass==="translucent"&&c.paint.get("fill-antialias")){const W=f.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);wd(f,n,c,g,W,L,!0)}},"fill-extrusion":function(f,n,c,g){const b=c.paint.get("fill-extrusion-opacity");if(b!==0&&f.renderPass==="translucent"){const E=new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D);if(b!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))Qh(f,n,c,g,E,s.StencilMode.disabled,s.ColorMode.disabled),Qh(f,n,c,g,E,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const L=f.colorModeForRenderPass();Qh(f,n,c,g,E,s.StencilMode.disabled,L)}}},hillshade:function(f,n,c,g){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const b=f.context,E=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),L=f.colorModeForRenderPass(),D=f.terrain&&f.terrain.renderingToTexture,[F,W]=f.renderPass!=="translucent"||D?[{},g]:f.stencilConfigForOverlap(g);for(const H of W){const Q=n.getTile(H);if(Q.needsHillshadePrepare&&f.renderPass==="offscreen")jh(f,Q,c,E,s.StencilMode.disabled,L);else if(f.renderPass==="translucent"){const he=D&&f.terrain?f.terrain.stencilModeForRTTOverlap(H):F[H.overscaledZ];cd(f,H,Q,c,E,he,L)}}b.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,n,c,g,b,E){if(f.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!g.length)return;const L=f.context,D=L.gl,F=n.getSource(),W=f.useProgram("raster"),H=f.colorModeForRenderPass(),Q=f.terrain&&f.terrain.renderingToTexture,[he,me]=F instanceof Ri||Q?[{},g]:f.stencilConfigForOverlap(g),ye=me[me.length-1].overscaledZ,_e=!f.options.moving;for(const be of me){const ee=Q?s.DepthMode.disabled:f.depthModeForSublayer(be.overscaledZ-ye,c.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,D.LESS),pe=be.toUnwrapped(),Ce=n.getTile(be);if(Q&&(!Ce||!Ce.hasData()))continue;const ke=Q?be.projMatrix:f.transform.calculateProjMatrix(pe,_e),Ge=f.terrain&&Q?f.terrain.stencilModeForRTTOverlap(be):he[be.overscaledZ],Ne=E?0:c.paint.get("raster-fade-duration");Ce.registerFadeDuration(Ne);const We=n.findLoadedParent(be,0),it=hd(Ce,We,n,f.transform,Ne);let et,ft;f.terrain&&f.terrain.prepareDrawTile();const Nt=c.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;L.activeTexture.set(D.TEXTURE0),Ce.texture.bind(Nt,D.CLAMP_TO_EDGE),L.activeTexture.set(D.TEXTURE1),We?(We.texture.bind(Nt,D.CLAMP_TO_EDGE),et=Math.pow(2,We.tileID.overscaledZ-Ce.tileID.overscaledZ),ft=[Ce.tileID.canonical.x*et%1,Ce.tileID.canonical.y*et%1]):Ce.texture.bind(Nt,D.CLAMP_TO_EDGE),Ce.texture.useMipmap&&L.extTextureFilterAnisotropic&&f.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);const ht=Hc(ke,ft||[0,0],et||1,it,c,F instanceof Ri?F.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(L,W,pe),F instanceof Ri)F.boundsBuffer&&F.boundsSegments&&W.draw(L,D.TRIANGLES,ee,s.StencilMode.disabled,H,s.CullFaceMode.disabled,ht,c.id,F.boundsBuffer,f.quadTriangleIndexBuffer,F.boundsSegments);else{const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:_t,tileBoundsSegments:Vt}=f.getTileBoundsBuffers(Ce);W.draw(L,D.TRIANGLES,ee,Ge,H,s.CullFaceMode.disabled,ht,c.id,Mt,_t,Vt)}}f.resetStencilClippingMasks()},background:function(f,n,c,g){const b=c.paint.get("background-color"),E=c.paint.get("background-opacity");if(E===0)return;const L=f.context,D=L.gl,F=f.transform,W=F.tileSize,H=c.paint.get("background-pattern");if(f.isPatternMissing(H))return;const Q=!H&&b.a===1&&E===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==Q)return;const he=s.StencilMode.disabled,me=f.depthModeForSublayer(0,Q==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),ye=f.colorModeForRenderPass(),_e=f.useProgram(H?"backgroundPattern":"background");let be,ee=g;ee||(be=f.getBackgroundTiles(),ee=Object.values(be).map(pe=>pe.tileID)),H&&(L.activeTexture.set(D.TEXTURE0),f.imageManager.bind(f.context));for(const pe of ee){const Ce=pe.toUnwrapped(),ke=g?pe.projMatrix:f.transform.calculateProjMatrix(Ce);f.prepareDrawTile();const Ge=n?n.getTile(pe):be?be[pe.key]:new s.Tile(pe,W,F.zoom,f),Ne=H?bm(ke,E,f,H,{tileID:pe,tileSize:W}):yd(ke,E,b);f.prepareDrawProgram(L,_e,Ce);const{tileBoundsBuffer:We,tileBoundsIndexBuffer:it,tileBoundsSegments:et}=f.getTileBoundsBuffers(Ge);_e.draw(L,D.TRIANGLES,me,he,ye,s.CullFaceMode.disabled,Ne,c.id,We,it,et)}},sky:function(f,n,c){const g=f.transform,b=g.projection.name==="mercator"||g.projection.name==="globe"?1:s.smoothstep(7,8,g.zoom),E=c.paint.get("sky-opacity")*b;if(E===0)return;const L=f.context,D=c.paint.get("sky-type"),F=new s.DepthMode(L.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),W=f.frameCounter/1e3%1;D==="atmosphere"?f.renderPass==="offscreen"?c.needsSkyboxCapture(f)&&(function(H,Q,he,me){const ye=H.context,_e=ye.gl;let be=Q.skyboxFbo;if(!be){be=Q.skyboxFbo=ye.createFramebuffer(32,32,!1),Q.skyboxGeometry=new Jc(ye),Q.skyboxTexture=ye.gl.createTexture(),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Q.skyboxTexture),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MAG_FILTER,_e.LINEAR);for(let ke=0;ke<6;++ke)_e.texImage2D(_e.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,_e.RGBA,32,32,0,_e.RGBA,_e.UNSIGNED_BYTE,null)}ye.bindFramebuffer.set(be.framebuffer),ye.viewport.set([0,0,32,32]);const ee=Q.getCenter(H,!0),pe=H.useProgram("skyboxCapture"),Ce=new Float64Array(16);s.identity(Ce),s.rotateY(Ce,Ce,.5*-Math.PI),fs(ye,Q,pe,Ce,ee,0),s.identity(Ce),s.rotateY(Ce,Ce,.5*Math.PI),fs(ye,Q,pe,Ce,ee,1),s.identity(Ce),s.rotateX(Ce,Ce,.5*-Math.PI),fs(ye,Q,pe,Ce,ee,2),s.identity(Ce),s.rotateX(Ce,Ce,.5*Math.PI),fs(ye,Q,pe,Ce,ee,3),s.identity(Ce),fs(ye,Q,pe,Ce,ee,4),s.identity(Ce),s.rotateY(Ce,Ce,Math.PI),fs(ye,Q,pe,Ce,ee,5),ye.viewport.set([0,0,H.width,H.height])}(f,c),c.markSkyboxValid(f)):f.renderPass==="sky"&&function(H,Q,he,me,ye){const _e=H.context,be=_e.gl,ee=H.transform,pe=H.useProgram("skybox");_e.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_CUBE_MAP,Q.skyboxTexture);const Ce=((ke,Ge,Ne,We,it)=>({u_matrix:ke,u_sun_direction:Ge,u_cubemap:0,u_opacity:We,u_temporal_offset:it}))(ee.skyboxMatrix,Q.getCenter(H,!1),0,me,ye);H.prepareDrawProgram(_e,pe),pe.draw(_e,be.TRIANGLES,he,s.StencilMode.disabled,H.colorModeForRenderPass(),s.CullFaceMode.backCW,Ce,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(f,c,F,E,W):D==="gradient"&&f.renderPass==="sky"&&function(H,Q,he,me,ye){const _e=H.context,be=_e.gl,ee=H.transform,pe=H.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Jc(_e)),_e.activeTexture.set(be.TEXTURE0);let Ce=Q.colorRampTexture;Ce||(Ce=Q.colorRampTexture=new s.Texture(_e,Q.colorRamp,be.RGBA)),Ce.bind(be.LINEAR,be.CLAMP_TO_EDGE);const ke=((Ge,Ne,We,it,et)=>({u_matrix:Ge,u_color_ramp:0,u_center_direction:Ne,u_radius:s.degToRad(We),u_opacity:it,u_temporal_offset:et}))(ee.skyboxMatrix,Q.getCenter(H,!1),Q.paint.get("sky-gradient-radius"),me,ye);H.prepareDrawProgram(_e,pe),pe.draw(_e,be.TRIANGLES,he,s.StencilMode.disabled,H.colorModeForRenderPass(),s.CullFaceMode.backCW,ke,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(f,c,F,E,W)},debug:function(f,n,c){for(let g=0;g<c.length;g++)Am(f,n,c[g])},custom:function(f,n,c,g){const b=f.context,E=c.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&c.isLayerDraped()){if(f.renderPass==="offscreen"){const L=E.prerender;if(L){if(f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const D=f.transform.pointMerc;L.call(E,b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[D.x,D.y],f.transform.pixelsPerMeterRatio)}else L.call(E,b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const D=E.renderToTile;if(D){const F=g[0].canonical,W=new s.MercatorCoordinate(F.x+g[0].wrap*(1<<F.z),F.y,F.z);b.setDepthMode(s.DepthMode.disabled),b.setStencilMode(s.StencilMode.disabled),b.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),D.call(E,b.gl,W),b.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),b.setStencilMode(s.StencilMode.disabled);const L=E.renderingMode==="3d"?new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(b.setDepthMode(L),f.transform.projection.name==="globe"){const D=f.transform.pointMerc;E.render(b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[D.x,D.y],f.transform.pixelsPerMeterRatio)}else E.render(b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState(),b.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class ic{constructor(n,c,g=!1){this.context=new Kt(n,g),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(n,c){const g=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ud(this,n));const b=this._terrain;this.transform.elevation=g?b:null,b.update(n,this.transform,c)}_updateFog(n){const c=n.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,b]=c.getFovAdjustedRange(this.transform._fov);if(g>b)return void(this.transform.fogCullDistSq=null);const E=g+.78*(b-g);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(n,c){if(this.width=n*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const n=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const g=new s.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(s.EXTENT,0),g.emplaceBack(0,s.EXTENT),g.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=n.createVertexBuffer(g,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const b=new s.StructArrayLayout2i4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(b,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const E=new s.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(s.EXTENT,0,s.EXTENT,0),E.emplaceBack(0,s.EXTENT,0,s.EXTENT),E.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=n.createVertexBuffer(E,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const L=new s.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(L);const D=new s.StructArrayLayout1ui2;for(const W of[0,1,3,2,0])D.emplaceBack(W);this.debugIndexBuffer=n.createIndexBuffer(D),this.emptyTexture=new s.Texture(n,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA),this.identityMat=s.create();const F=this.context.gl;this.stencilClearMode=new s.StencilMode({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new eh(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context,c=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(n,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,jc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,c,g){if(!c||this.currentStencilSource===c.id||!n.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const F of g)if(this._tileClippingMaskIDs[F.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=c.id;const b=this.context,E=b.gl;this.nextStencilID+g.length>256&&this.clearStencil(),b.setColorMode(s.ColorMode.disabled),b.setDepthMode(s.DepthMode.disabled);const L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of g){const F=c.getTile(D),W=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:Q,tileBoundsSegments:he}=this.getTileBoundsBuffers(F);L.draw(b,E.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:E.ALWAYS,mask:0},W,255,E.KEEP,E.KEEP,E.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,jc(D.projMatrix),"$clipping",H,Q,he)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},n,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(n){const c=this.context.gl,g=n.sort((L,D)=>D.overscaledZ-L.overscaledZ),b=g[g.length-1].overscaledZ,E=g[0].overscaledZ-b+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const L={};for(let D=0;D<E;D++)L[D+b]=new s.StencilMode({func:c.GEQUAL,mask:255},D+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=E,[L,g]}return[{[b]:s.StencilMode.disabled},g]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([n.CONSTANT_COLOR,n.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(n,c,g){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new s.DepthMode(g||this.context.gl.LEQUAL,c,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,c){this.style=n,this.options=c,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const g=this.style.order,b=this.style._sourceCaches;for(const W in b){const H=b[W];H.used&&H.prepare(this.context)}const E={},L={},D={};for(const W in b){const H=b[W];E[W]=H.getVisibleCoordinates(),L[W]=E[W].slice().reverse(),D[W]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let W=0;W<g.length;W++)if(this.style._layers[g[W]].is3D()){this.opaquePassCutoff=W;break}if(this.terrain&&(this.terrain.updateTileBinding(D),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const W of g){const H=this.style._layers[W],Q=n._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const he=Q?L[Q.id]:void 0;(H.type==="custom"||H.isSky()||he&&he.length)&&this.renderLayer(this,Q,H,he)}this.depthRangeFor3D=[0,1-(n.order.length+2)*this.numSublayers*this.depthEpsilon];const F=this.terrain;if(F&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&F.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const W=this.style._layers[g[this.currentLayer]],H=n._getLayerSourceCache(W);if(W.isSky())continue;const Q=H?L[H.id]:void 0;this._renderTileClippingMasks(W,H,Q),this.renderLayer(this,H,W,Q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(W,H){const Q=W.context,he=Q.gl,me=W.transform,ye=new s.DepthMode(he.LEQUAL,s.DepthMode.ReadOnly,[0,1]),_e=W.useProgram("globeAtmosphere",null,me.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),be=s.globeToMercatorTransition(me.zoom),ee=H.properties.get("color").toArray01(),pe=H.properties.get("high-color").toArray01(),Ce=H.properties.get("space-color").toArray01PremultipliedAlpha(),ke=s.identity$1([]);s.rotateY$1(ke,ke,-s.degToRad(me._center.lng)),s.rotateX$1(ke,ke,s.degToRad(me._center.lat)),s.rotateZ$1(ke,ke,me.angle),s.rotateX$1(ke,ke,-me._pitch);const Ge=s.fromQuat(new Float32Array(16),ke),Ne=s.mapValue(H.properties.get("star-intensity"),0,1,0,.25),We=5e-4,it=s.mapValue(H.properties.get("horizon-blend"),0,1,We,.25),et=s.globeUseCustomAntiAliasing(W,Q,me)&&it===We?me.worldSize/(2*Math.PI*1.025)-1:me.globeRadius,ft=W.frameCounter/1e3%1,Nt=s.length(me.globeCenterInViewSpace),ht=Math.sqrt(Math.pow(Nt,2)-Math.pow(et,2)),Mt=Math.acos(ht/Nt),_t=((lt,kt,jt,Ct,Ht,Ii,Fi,vi,Pi,Gi,Wi,Ci,Ar,Lr)=>({u_frustum_tl:lt,u_frustum_tr:kt,u_frustum_br:jt,u_frustum_bl:Ct,u_horizon:Ht,u_transition:Ii,u_fadeout_range:Fi,u_color:vi,u_high_color:Pi,u_space_color:Gi,u_star_intensity:Wi,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ci,u_horizon_angle:Ar,u_rotation_matrix:Lr}))(me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.frustumCorners.horizon,be,it,ee,pe,Ce,Ne,ft,Mt,Ge);W.prepareDrawProgram(Q,_e);const Vt=W.atmosphereBuffer;Vt&&_e.draw(Q,he.TRIANGLES,ye,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,_t,"skybox",Vt.vertexBuffer,Vt.indexBuffer,Vt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const W=this.style._layers[g[this.currentLayer]],H=n._getLayerSourceCache(W);W.isSky()&&this.renderLayer(this,H,W,H?L[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const W=this.style._layers[g[this.currentLayer]],H=n._getLayerSourceCache(W);if(W.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(W)){if(W.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=H?(W.type==="symbol"?D:L)[H.id]:void 0;this._renderTileClippingMasks(W,H,H?E[H.id]:void 0),this.renderLayer(this,H,W,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let W=null;s.values(this.style._layers).forEach(H=>{const Q=n._getLayerSourceCache(H);Q&&!H.isHidden(this.transform.zoom)&&(!W||W.getSource().maxzoom<Q.getSource().maxzoom)&&(W=Q)}),W&&this.options.showTileBoundaries&&gl.debug(this,W,W.getVisibleCoordinates())}this.options.showPadding&&function(W){const H=W.transform.padding;Yc(W,W.transform.height-(H.top||0),3,eo),Yc(W,H.bottom||0,3,Tm),ec(W,H.left||0,3,Em),ec(W,W.transform.width-(H.right||0),3,Sm);const Q=W.transform.centerPoint;(function(he,me,ye,_e){tc(he,me-1,ye-10,2,20,_e),tc(he,me-10,ye-1,20,2,_e)})(W,Q.x,W.transform.height-Q.y,Cm)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(n,c,g,b){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||b&&b.length)&&(this.id=g.id,this.gpuTimingStart(g),(!n.transform.projection.unsupportedLayers||!n.transform.projection.unsupportedLayers.includes(g.type)||n.terrain&&g.type==="custom")&&gl[g.type](n,c,g,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let g=this.gpuTimers[n.id];g||(g=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),g.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,c=n.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),n.beginQueryEXT(n.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const c={};for(const g in n){const b=n[g],E=this.context.extTimerQuery,L=E.getQueryObjectEXT(b.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(b.query),c[g]=L}return c}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let g=0;for(const b of n)g+=c.getQueryObjectEXT(b,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(b);return g}translatePosMatrix(n,c,g,b,E){if(!g[0]&&!g[1])return n;const L=E?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(L){const W=Math.sin(L),H=Math.cos(L);g=[g[0]*H-g[1]*W,g[0]*W+g[1]*H]}const D=[E?g[0]:nr(c,g[0],this.transform.zoom),E?g[1]:nr(c,g[1],this.transform.zoom),0],F=new Float32Array(16);return s.translate(F,n,D),F}saveTileTexture(n){const c=this._tileTextures[n.size[0]];c?c.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const c=this._tileTextures[n];return c&&c.length>0?c.pop():null}isPatternMissing(n){return n===null||n!==void 0&&!this.imageManager.getPattern(n.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const n=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&this.terrain.exaggeration()===0,g=this.style&&this.style.fog,b=[];return this.terrainRenderModeElevated()&&b.push("TERRAIN"),this.transform.projection.name==="globe"&&b.push("GLOBE"),c&&b.push("ZERO_EXAGGERATION"),g&&!n&&g.getOpacity(this.transform.pitch)!==0&&b.push("FOG"),n&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}useProgram(n,c,g){this.cache=this.cache||{};const b=g||[],E=this.currentGlobalDefines().concat(b),L=pr.cacheKey(Uh[n],n,E,c);return this.cache[L]||(this.cache[L]=new pr(this.context,n,Uh[n],c,xd[n],E)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(n,c,g){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const E=b.getOpacity(this.transform.pitch),L=((D,F,W,H,Q,he,me,ye,_e,be,ee)=>{const pe=D.transform,Ce=F.properties.get("color").toArray01();Ce[3]=H;const ke=D.frameCounter/1e3%1;return{u_fog_matrix:W?pe.calculateFogTileMatrix(W):D.identityMat,u_fog_range:F.getFovAdjustedRange(pe._fov),u_fog_color:Ce,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_temporal_offset:ke,u_frustum_tl:Q,u_frustum_tr:he,u_frustum_br:me,u_frustum_bl:ye,u_globe_pos:_e,u_globe_radius:be,u_viewport:ee,u_globe_transition:s.globeToMercatorTransition(pe.zoom),u_is_globe:+(pe.projection.name==="globe")}})(this,b,g,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);c.setFogUniformValues(n,L)}}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,c=n.createTexture();return n.bindTexture(n.TEXTURE_2D,c),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,c=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const b of g)c[b.key]=n[b.key]||new s.Tile(b,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class $s{constructor(n=0,c=0,g=0,b=0){if(isNaN(n)||n<0||isNaN(c)||c<0||isNaN(g)||g<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=c,this.left=g,this.right=b}interpolate(n,c,g){return c.top!=null&&n.top!=null&&(this.top=s.number(n.top,c.top,g)),c.bottom!=null&&n.bottom!=null&&(this.bottom=s.number(n.bottom,c.bottom,g)),c.left!=null&&n.left!=null&&(this.left=s.number(n.left,c.left,g)),c.right!=null&&n.right!=null&&(this.right=s.number(n.right,c.right,g)),this}getCenter(n,c){const g=s.clamp((this.left+n-this.right)/2,0,n),b=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.Point(g,b)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new $s(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function va(f,n){const c=s.getColumn(f,3);s.fromQuat(f,n),s.setColumn(f,3,c)}function xr(f,n){const c=s.identity$1([]);return s.rotateZ$1(c,c,-n),s.rotateX$1(c,c,-f),c}function rc(f,n){const c=[f[0],f[1],0],g=[n[0],n[1],0];if(s.length(c)>=1e-15){const L=s.normalize([],c);s.scale$2(g,L,s.dot(g,L)),n[0]=g[0],n[1]=g[1]}const b=s.cross([],n,f);if(s.len(b)<1e-15)return null;const E=Math.atan2(-b[1],b[0]);return xr(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),E)}class Hf{constructor(n,c){this.position=n,this.orientation=c}get position(){return this._position}set position(n){if(n){const c=n instanceof s.MercatorCoordinate?n:new s.MercatorCoordinate(n[0],n[1],n[2]);this._renderWorldCopies&&(c.x=s.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(n,c){if(this.orientation=null,!this.position)return;const g=this.position,b=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(n)):0,E=s.MercatorCoordinate.fromLngLat(n,b),L=[E.x-g.x,E.y-g.y,E.z-g.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=rc(L,c)}setPitchBearing(n,c){this.orientation=xr(s.degToRad(n),s.degToRad(-c))}}class nc{constructor(n,c){this._transform=s.identity([]),this.orientation=c,this.position=n}get mercatorPosition(){const n=this.position;return new s.MercatorCoordinate(n[0],n[1],n[2])}get position(){const n=s.getColumn(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var c;n&&s.setColumn(this._transform,3,[(c=n)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||s.identity$1([]),n&&va(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,c){this._orientation=xr(n,c),va(this._transform,this._orientation)}forward(){const n=s.getColumn(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=s.getColumn(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=s.getColumn(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,c){const g=new Float64Array(16);return s.invert(g,this.getWorldToCamera(n,c)),g}getWorldToCameraPosition(n,c,g){const b=this.position;s.scale$2(b,b,-n);const E=new Float64Array(16);return s.fromScaling(E,[g,g,g]),s.translate(E,E,b),E[10]*=c,E}getWorldToCamera(n,c){const g=new Float64Array(16),b=new Float64Array(4),E=this.position;return s.conjugate(b,this._orientation),s.scale$2(E,E,-n),s.fromQuat(g,b),s.translate(g,g,E),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=c,g[9]*=c,g[10]*=c,g[11]*=c,g}getCameraToClipPerspective(n,c,g,b){const E=new Float64Array(16);return s.perspective(E,n,c,g,b),E}getDistanceToElevation(n,c=!1){const g=n===0?0:s.mercatorZfromAltitude(n,c?s.latFromMercatorY(this.position[1]):this.position[1]),b=this.forward();return(g-this.position[2])/b[2]}clone(){return new nc([...this.position],[...this.orientation])}}function sc(f,n){const c=th(f.projection,f.zoom,f.width,f.height),g=function(E,L,D,F,W){const H=new s.LngLat(D.lng-180*ba,D.lat),Q=new s.LngLat(D.lng+180*ba,D.lat),he=E.project(H.lng,H.lat),me=E.project(Q.lng,Q.lat),ye=-Math.atan2(me.y-he.y,me.x-he.x),_e=s.MercatorCoordinate.fromLngLat(D);_e.y=s.clamp(_e.y,-1+ba,1-ba);const be=_e.toLngLat(),ee=E.project(be.lng,be.lat),pe=s.MercatorCoordinate.fromLngLat(be);pe.x+=ba;const Ce=pe.toLngLat(),ke=E.project(Ce.lng,Ce.lat),Ge=ps(ke.x-ee.x,ke.y-ee.y,ye),Ne=s.MercatorCoordinate.fromLngLat(be);Ne.y+=ba;const We=Ne.toLngLat(),it=E.project(We.lng,We.lat),et=ps(it.x-ee.x,it.y-ee.y,ye),ft=Math.abs(Ge.x)/Math.abs(et.y),Nt=s.identity([]);s.rotateZ(Nt,Nt,-ye*(1-(W?0:F)));const ht=s.identity([]);return s.scale(ht,ht,[1,1-(1-ft)*F,1]),ht[4]=-et.x/et.y*F,s.rotateZ(ht,ht,ye),s.multiply(ht,Nt,ht),ht}(f.projection,0,f.center,c,n),b=qf(f);return s.scale(g,g,[b,b,1]),g}function qf(f){const n=f.projection,c=th(f.projection,f.zoom,f.width,f.height),g=tu(n,f.center),b=tu(n,s.LngLat.convert(n.center));return Math.pow(2,g*c+(1-c)*b)}function th(f,n,c,g,b=1/0){const E=f.range;if(!E)return 0;const L=Math.min(b,Math.max(c,g)),D=Math.log(L/1024)/Math.LN2;return s.smoothstep(E[0]+D,E[1]+D,n)}const ba=1/4e4;function tu(f,n){const c=s.clamp(n.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=new s.LngLat(n.lng-180*ba,c),b=new s.LngLat(n.lng+180*ba,c),E=f.project(g.lng,c),L=f.project(b.lng,c),D=s.MercatorCoordinate.fromLngLat(g),F=s.MercatorCoordinate.fromLngLat(b),W=L.x-E.x,H=L.y-E.y,Q=F.x-D.x,he=F.y-D.y,me=Math.sqrt((Q*Q+he*he)/(W*W+H*H));return Math.log(me)/Math.LN2}function ps(f,n,c){const g=Math.cos(c),b=Math.sin(c);return{x:f*g-n*b,y:f*b+n*g}}class Cr{constructor(n,c,g,b,E,L,D){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=g??0,this._maxPitch=b??60,this.setProjection(L),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new $s,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new nc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const n=new Cr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(n,c=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(n||g)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const g=!$(c,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const c=n!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const c=-n*Math.PI/180;var g;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(g=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(b,E,L){var D=E[0],F=E[1],W=E[2],H=E[3],Q=Math.sin(L),he=Math.cos(L);b[0]=D*he+W*Q,b[1]=F*he+H*Q,b[2]=D*-Q+W*he,b[3]=F*-Q+H*he}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const c=s.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=s.degToRad(n),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const c=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const n=this._elevation;this._centerAltitude=n.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=n.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let b=0,E=0;for(let L=0;L<c.length;L++){const D=new s.Point(c[L][0]*this.width,g+c[L][1]*(this.height-g)),F=n.pointCoordinate(D);if(!F)continue;const W=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);b+=F[3]*W,E+=W}return E===0?NaN:b/E}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*c,b=this._mercatorZfromZoom(n),E=this._mercatorZfromZoom(this._maxZoom),L=Math.max(b-g,E);this._setZoom(this._zoomFromMercatorZ(L))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let g;g=n.z<this._camera.position[2]?[c.x,c.y,c.z]:[n.x,n.y,n.z];const b=s.length(s.sub([],this._camera.position,g));return s.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let c=!1;if(n.orientation&&!s.exactEquals(n.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(n.orientation)),n.position){const g=[n.position.x,n.position.y,n.position.z];s.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,c=new Hf;return c.position=new s.MercatorCoordinate(n[0],n[1],n[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(n){if(!s.length$1(n))return!1;s.normalize$1(n,n);const c=s.transformQuat([],[0,0,-1],n),g=s.transformQuat([],[0,-1,0],n);if(g[2]<0)return!1;const b=rc(c,g);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(n){const c=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;n[2]=s.clamp(n[2],b/g,b/c),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,c,g){this._unmodified=!1,this._edgeInsets.interpolate(n,c,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const c=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(n){const c=[new s.UnwrappedTileID(0,n)];if(this.renderWorldCopies){const g=this.pointCoordinate(new s.Point(0,0)),b=this.pointCoordinate(new s.Point(this.width,0)),E=this.pointCoordinate(new s.Point(this.width,this.height)),L=this.pointCoordinate(new s.Point(0,this.height)),D=Math.floor(Math.min(g.x,b.x,E.x,L.x)),F=Math.floor(Math.max(g.x,b.x,E.x,L.x)),W=1;for(let H=D-W;H<=F+W;H++)H!==0&&c.push(new s.UnwrappedTileID(H,n))}return c}coveringTiles(n){let c=this.coveringZoomLevel(n);const g=c,b=this.elevation&&!n.isTerrainDEM,E=this.projection.name==="mercator";if(n.minzoom!==void 0&&c<n.minzoom)return[];n.maxzoom!==void 0&&c>n.maxzoom&&(c=n.maxzoom);const L=this.locationCoordinate(this.center),D=this.center.lat,F=1<<c,W=[F*L.x,F*L.y,0],H=this.projection.name==="globe",Q=!H,he=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,Q),me=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ye=F*s.mercatorZfromAltitude(1,this.center.lat),_e=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),be=[F*me.x,F*me.y,_e*(Q?1:ye)],ee=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),pe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,Ce=n.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ke=n.isTerrainDEM?-Ce:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ge=this.projection.isReprojectedInTileSpace?qf(this):1,Ne=lt=>{const jt=new s.MercatorCoordinate(lt.x+25e-6,lt.y,lt.z),Ct=new s.MercatorCoordinate(lt.x,lt.y+25e-6,lt.z),Ht=lt.toLngLat(),Ii=jt.toLngLat(),Fi=Ct.toLngLat(),vi=this.locationCoordinate(Ht),Pi=this.locationCoordinate(Ii),Gi=this.locationCoordinate(Fi),Wi=Math.hypot(Pi.x-vi.x,Pi.y-vi.y),Ci=Math.hypot(Gi.x-vi.x,Gi.y-vi.y);return Math.sqrt(Wi*Ci)*Ge/25e-6},We=lt=>{const kt=Ce,jt=ke;return{aabb:s.tileAABB(this,F,0,0,0,lt,jt,kt,this.projection),zoom:0,x:0,y:0,minZ:jt,maxZ:kt,wrap:lt,fullyVisible:!1}},it=[];let et=[];const ft=c,Nt=n.reparseOverscaled?g:c,ht=lt=>lt*lt,Mt=ht((_e-this._centerAltitude)*ye),_t=lt=>{if(!this._elevation||!lt.tileID||!E)return;const kt=this._elevation.getMinMaxForTile(lt.tileID),jt=lt.aabb;kt?(jt.min[2]=kt.min,jt.max[2]=kt.max,jt.center[2]=(jt.min[2]+jt.max[2])/2):(lt.shouldSplit=Vt(lt),lt.shouldSplit||(jt.min[2]=jt.max[2]=jt.center[2]=this._centerAltitude))},Vt=lt=>{if(lt.zoom<pe)return!0;if(lt.zoom===ft)return!1;if(lt.shouldSplit!=null)return lt.shouldSplit;const kt=lt.aabb.distanceX(be),jt=lt.aabb.distanceY(be);let Ct=Mt,Ht=1;if(H){Ct=ht(lt.aabb.distanceZ(be));const vi=Math.pow(2,lt.zoom),Pi=s.latFromMercatorY((lt.y+1)/vi),Gi=s.latFromMercatorY(lt.y/vi),Wi=Math.min(Math.max(D,Pi),Gi),Ci=s.circumferenceAtLatitude(Wi)/s.circumferenceAtLatitude(D);if(Ht=Wi===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ci/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&lt.zoom===ft-1&&Ci>=.9)return!0}else if(b&&(Ct=ht(lt.aabb.distanceZ(be)*ye)),this.projection.isReprojectedInTileSpace&&g<=5){const vi=Math.pow(2,lt.zoom),Pi=Ne(new s.MercatorCoordinate((lt.x+.5)/vi,(lt.y+.5)/vi));Ht=Pi>.85?1:Pi}const Ii=kt*kt+jt*jt+Ct,Fi=ht((1<<ft-lt.zoom)*ee*Ht*((vi,Pi)=>{if(Pi*ht(.707)<vi)return 1;const Gi=Math.sqrt(Pi/vi);return Gi/(1.4144271570014144+(Math.pow(1.1,Gi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ct,Mt),Ii));return Ii<Fi};if(this.renderWorldCopies)for(let lt=1;lt<=3;lt++)it.push(We(-lt)),it.push(We(lt));for(it.push(We(0));it.length>0;){const lt=it.pop(),kt=lt.x,jt=lt.y;let Ct=lt.fullyVisible;if(!Ct){const Ht=lt.aabb.intersects(he);if(Ht===0)continue;Ct=Ht===2}if(lt.zoom!==ft&&Vt(lt))for(let Ht=0;Ht<4;Ht++){const Ii=(kt<<1)+Ht%2,Fi=(jt<<1)+(Ht>>1),vi={aabb:E?lt.aabb.quadrant(Ht):s.tileAABB(this,F,lt.zoom+1,Ii,Fi,lt.wrap,lt.minZ,lt.maxZ,this.projection),zoom:lt.zoom+1,x:Ii,y:Fi,wrap:lt.wrap,fullyVisible:Ct,tileID:void 0,shouldSplit:void 0,minZ:lt.minZ,maxZ:lt.maxZ};b&&!H&&(vi.tileID=new s.OverscaledTileID(lt.zoom+1===ft?Nt:lt.zoom+1,lt.wrap,lt.zoom+1,Ii,Fi),_t(vi)),it.push(vi)}else{const Ht=lt.zoom===ft?Nt:lt.zoom;if(n.minzoom&&n.minzoom>Ht)continue;const Ii=W[0]-(.5+kt+(lt.wrap<<lt.zoom))*(1<<c-lt.zoom),Fi=W[1]-.5-jt,vi=lt.tileID?lt.tileID:new s.OverscaledTileID(Ht,lt.wrap,lt.zoom,kt,jt);et.push({tileID:vi,distanceSq:Ii*Ii+Fi*Fi})}}if(this.fogCullDistSq){const lt=this.fogCullDistSq,kt=this.horizonLineFromTop();et=et.filter(jt=>{const Ct=[0,0,0,1],Ht=[s.EXTENT,s.EXTENT,0,1],Ii=this.calculateFogTileMatrix(jt.tileID.toUnwrapped());s.transformMat4$1(Ct,Ct,Ii),s.transformMat4$1(Ht,Ht,Ii);const Fi=s.getAABBPointSquareDist(Ct,Ht);if(Fi===0)return!0;let vi=!1;const Pi=this._elevation;if(Pi&&Fi>lt&&kt!==0){const Gi=this.calculateProjMatrix(jt.tileID.toUnwrapped());let Wi;n.isTerrainDEM||(Wi=Pi.getMinMaxForTile(jt.tileID)),Wi||(Wi={min:ke,max:Ce});const Ci=s.furthestTileCorner(this.rotation),Ar=[Ci[0]*s.EXTENT,Ci[1]*s.EXTENT,Wi.max];s.transformMat4(Ar,Ar,Gi),vi=(1-Ar[1])*this.height*.5<kt}return Fi<lt||vi})}return et.sort((lt,kt)=>lt.distanceSq-kt.distanceSq).map(lt=>lt.tileID)}resize(n,c){this.width=n,this.height=c,this.pixelsToGLUnits=[2/n,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const c=s.clamp(n.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=this.projection.project(n.lng,c);return new s.Point(g.x*this.worldSize,g.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,c){let g,b;const E=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;g=(c.x-E.x)/D,b=(c.y-E.y)/D}else{const D=this.pointCoordinate(c),F=this.pointCoordinate(E);g=D.x-F.x,b=D.y-F.y}const L=this.locationCoordinate(n);this.setLocation(new s.MercatorCoordinate(L.x-g,L.y-b))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,c){const g=c?s.mercatorZfromAltitude(c,n.lat):void 0,b=this.projection.project(n.lng,n.lat);return new s.MercatorCoordinate(b.x,b.y,g)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,c){const g=c??this._centerAltitude,b=[n.x,n.y,0,1],E=[n.x,n.y,1,1];s.transformMat4$1(b,b,this.pixelMatrixInverse),s.transformMat4$1(E,E,this.pixelMatrixInverse);const L=E[3];s.scale$1(b,b,1/b[3]),s.scale$1(E,E,1/L);const D=b[2],F=E[2];return{p0:b,p1:E,t:D===F?0:(g-D)/(F-D)}}screenPointToMercatorRay(n){const c=[n.x,n.y,0,1],g=[n.x,n.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(g,g,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(g,g,1/g[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,g[2]=s.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(g,g,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],g,c)))}rayIntersectionCoordinate(n){const{p0:c,p1:g,t:b}=n,E=s.mercatorZfromAltitude(c[2],this._center.lat),L=s.mercatorZfromAltitude(g[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],g[0],b)/this.worldSize,s.number(c[1],g[1],b)/this.worldSize,s.number(E,L,b))}pointCoordinate(n,c=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,c)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let c=this.projection.pointCoordinate3D(this,n.x,n.y);if(c)return new s.MercatorCoordinate(c[0],c[1],c[2]);let g=0,b=this.horizonLineFromTop();if(n.y>b)return this.pointCoordinate(n);const E=.02*b,L=n.clone();for(let D=0;D<10&&b-g>E;D++){L.y=s.number(g,b,.66);const F=this.projection.pointCoordinate3D(this,L.x,L.y);F?(b=L.y,c=F):g=L.y}return c?new s.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(n);const c=this.pointCoordinate(n);return c.y>=0&&c.y<=1}_coordinatePoint(n,c){const g=c&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,b=[n.x*this.worldSize,n.y*this.worldSize,g+n.toAltitude(),1];return s.transformMat4$1(b,b,this.pixelMatrix),b[3]>0?new s.Point(b[0]/b[3],b[1]/b[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:c}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,E=this.pointLocation3D(new s.Point(c,n)),L=this.pointLocation3D(new s.Point(b,n)),D=this.pointLocation3D(new s.Point(b,g)),F=this.pointLocation3D(new s.Point(c,g));let W=Math.min(E.lng,L.lng,D.lng,F.lng),H=Math.max(E.lng,L.lng,D.lng,F.lng),Q=Math.min(E.lat,L.lat,D.lat,F.lat),he=Math.max(E.lat,L.lat,D.lat,F.lat);const me=Math.pow(2,-this.zoom)/16*270,ye=this.projection.name==="globe"?1:4,_e=(be,ee,pe,Ce,ke)=>{const Ge=(be+pe)/2,Ne=(ee+Ce)/2,We=new s.Point(Ge,Ne),{lng:it,lat:et}=this.pointLocation3D(We),ft=Math.max(0,W-it,Q-et,it-H,et-he);W=Math.min(W,it),H=Math.max(H,it),Q=Math.min(Q,et),he=Math.max(he,et),(ke<ye||ft>me)&&(_e(be,ee,Ge,Ne,ke+1),_e(Ge,Ne,pe,Ce,ke+1))};if(_e(c,n,b,n,1),_e(b,n,b,g,1),_e(b,g,c,g,1),_e(c,g,c,n,1),this.projection.name==="globe"){const[be,ee]=s.polesInViewport(this);be?(he=90,H=180,W=-180):ee&&(Q=-90,H=180,W=-180)}return new s.LngLatBounds(new s.LngLat(W,Q),new s.LngLat(H,he))}_getBoundsRectangular(n,c){const{top:g,left:b}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,L=this.width-this._edgeInsets.right,D=new s.Point(b,g),F=new s.Point(L,g),W=new s.Point(L,E),H=new s.Point(b,E);let Q=this.pointCoordinate(D,n),he=this.pointCoordinate(F,n);const me=this.pointCoordinate(W,c),ye=this.pointCoordinate(H,c),_e=(be,ee)=>(ee.y-be.y)/(ee.x-be.x);return Q.y>1&&he.y>=0?Q=new s.MercatorCoordinate((1-ye.y)/_e(ye,Q)+ye.x,1):Q.y<0&&he.y<=1&&(Q=new s.MercatorCoordinate(-ye.y/_e(ye,Q)+ye.x,0)),he.y>1&&Q.y>=0?he=new s.MercatorCoordinate((1-me.y)/_e(me,he)+me.x,1):he.y<0&&Q.y<=1&&(he=new s.MercatorCoordinate(-me.y/_e(me,he)+me.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(he)).extend(this.coordinateLocation(ye)).extend(this.coordinateLocation(me))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=n.visibleDemTiles.reduce((g,b)=>{if(b.dem){const E=b.dem.tree;g.min=Math.min(g.min,E.minimums[0]),g.max=Math.max(g.max,E.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*n.exaggeration(),c.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-c*(1-this._horizonShift);return n?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,c){return this.projection.createTileMatrix(this,c,n)}calculateDistanceTileData(n){const c=n.key,g=this._distanceTileDataCache;if(g[c])return g[c];const b=n.canonical,E=1/this.height,L=this.cameraWorldSize,D=L/this.zoomScale(b.z),F=(b.x+Math.pow(2,b.z)*n.wrap)*D,W=b.y*D,H=this.point;H.x*=L/this.worldSize,H.y*=L/this.worldSize;const Q=this.angle,he=Math.sin(-Q),me=-Math.cos(-Q);return g[c]={bearing:[he,me],center:[(H.x-F)*E,(H.y-W)*E],scale:D/s.EXTENT*E},g[c]}calculateFogTileMatrix(n){const c=n.key,g=this._fogTileMatrixCache;if(g[c])return g[c];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return s.multiply(b,this.worldToFogMatrix,b),g[c]=new Float32Array(b),g[c]}calculateProjMatrix(n,c=!1){const g=n.key,b=c?this._alignedProjMatrixCache:this._projMatrixCache;if(b[g])return b[g];const E=this.calculatePosMatrix(n,this.worldSize);return s.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,E),b[g]=new Float32Array(E),b[g]}calculatePixelsToTileUnitsMatrix(n){const c=n.tileID.key,g=this._pixelsToTileUnitsCache;if(g[c])return g[c];const b=function(E,L){const{scale:D}=E.tileTransform,F=D*s.EXTENT/(E.tileSize*Math.pow(2,L.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return W=new Float32Array(4),he=(H=L.inverseAdjustmentMatrix)[1],me=H[2],ye=H[3],be=(Q=[F,F])[1],W[0]=H[0]*(_e=Q[0]),W[1]=he*_e,W[2]=me*be,W[3]=ye*be,W;var W,H,Q,he,me,ye,_e,be}(n,this);return g[c]=b,g[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,c=s.fromScaling([],[n,n,n]);return s.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(c),b=this._camera.forward(),E=s.mercatorZfromAltitude(1,this._center.lat);g[2]/=E,b[2]/=E,s.normalize(b,b);const L=n.raycast(g,b,n.exaggeration());if(L){const D=s.scaleAndAdd([],g,b,L),F=new s.MercatorCoordinate(D[0],D[1],s.mercatorZfromAltitude(D[2],s.latFromMercatorY(D[1]))),W=(F.z+s.length([F.x-g[0],F.y-g[1],F.z-g[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(W),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const c=this._elevation,g=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(g),E=c.getAtPointOrZero(new s.MercatorCoordinate(...b)),L=this.pixelsPerMeter/this.worldSize*E,D=this._minimumHeightOverTerrain(),F=b[2]-L;if(F<=D)if(F<0||n){const W=this.locationCoordinate(this._center,this._centerAltitude),H=[b[0],b[1],W.z-b[2]],Q=s.length(H);H[2]-=(D-F)/this._pixelsPerMercatorPixel;const he=s.length(H);if(he===0)return;s.scale$2(H,H,Q/he*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],W.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const he=this.center;return he.lat=s.clamp(he.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(he.lng=s.clamp(he.lng,this.minLng,this.maxLng)),this.center=he,void(this._constraining=!1)}const c=this._unmodified,{x:g,y:b}=this.point;let E=0,L=g,D=b;const F=this.width/2,W=this.height/2,H=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(b-W<H&&(D=H+W),b+W>Q&&(D=Q-W),Q-H<this.height&&(E=Math.max(E,this.height/(Q-H)),D=(Q+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const he=this.worldMinX*this.scale,me=this.worldMaxX*this.scale,ye=this.worldSize/2-(he+me)/2;L=(g+ye+this.worldSize)%this.worldSize-ye,L-F<he&&(L=he+F),L+F>me&&(L=me-F),me-he<this.width&&(E=Math.max(E,this.width/(me-he)),L=(me+he)/2)}L===g&&D===b||(this.center=this.unproject(new s.Point(L,D))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const g=th(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?c:1,E=this._camera.getWorldToCamera(this.worldSize,b),L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);L[8]=2*-n.x/this.width,L[9]=2*n.y/this.height;let D=s.mul([],L,E);if(this.projection.isReprojectedInTileSpace){const Ne=this.locationCoordinate(this.center),We=s.identity([]);s.translate(We,We,[Ne.x*this.worldSize,Ne.y*this.worldSize,0]),s.multiply(We,We,sc(this)),s.translate(We,We,[-Ne.x*this.worldSize,-Ne.y*this.worldSize,0]),s.multiply(D,D,We),this.inverseAdjustmentMatrix=function(it){const et=sc(it,!0);return He([],[et[0],et[1],et[4],et[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],D,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=D,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const F=s.invert([],L);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(F,this.horizonLineFromTop(),this.height);const W=new Float32Array(16);s.identity(W),s.scale(W,W,[1,-1,1]),s.rotateX(W,W,this._pitch),s.rotateZ(W,W,this.angle);const H=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-n.x/this.width,H[9]=2*(n.y+Q)/this.height,this.skyboxMatrix=s.multiply(W,H,W);const he=this.point,me=he.x,ye=he.y,_e=this.width%2/2,be=this.height%2/2,ee=Math.cos(this.angle),pe=Math.sin(this.angle),Ce=me-Math.round(me)+ee*_e+pe*be,ke=ye-Math.round(ye)+ee*be+pe*_e,Ge=new Float64Array(D);if(s.translate(Ge,Ge,[Ce>.5?Ce-1:Ce,ke>.5?ke-1:ke,0]),this.alignedProjMatrix=Ge,D=s.create(),s.scale(D,D,[this.width/2,-this.height/2,1]),s.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=s.create(),s.scale(D,D,[1,-1,1]),s.translate(D,D,[-1,-1,0]),s.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},D=s.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Ne,Ne,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,g=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,E=[n,n,c];s.scale$2(E,E,b),s.scale$2(g,g,-1),s.multiply$2(g,g,E);const L=s.create();s.translate(L,L,g),s.scale(L,L,E),this.mercatorFogMatrix=L,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,c,b)}_computeCameraPosition(n){const c=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),b=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-n/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-g[0]*E,b.y/this.worldSize-g[1]*E,n/this.worldSize*this._centerAltitude-g[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],b=n[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(E=Math.min((c-g)/b,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,n,E),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,c=this._camera.forward(),{pitch:g,bearing:b}=this._camera.getPitchBearing(),E=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,L=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),D=Math.max((n[2]-E)/Math.cos(g),L),F=this._zoomFromMercatorZ(D);s.scaleAndAdd(n,n,c,D),this._pitch=s.clamp(g,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(b,-Math.PI,Math.PI),this._setZoom(s.clamp(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}zoomFromMercatorZAdjusted(n){let c=0,g=s.GLOBE_ZOOM_THRESHOLD_MAX,b=0,E=1/0;for(;g-c>1e-6&&g>c;){const L=c+.5*(g-c),D=this.tileSize*Math.pow(2,L),F=this.getCameraToCenterDistance(this.projection,L,D),W=this.scaleZoom(F/(n*this.tileSize)),H=Math.abs(L-W);H<E&&(E=H,b=L),L<W?c=L:g=L}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,c){const g=Math.min(n.x,c.x),b=Math.max(n.x,c.x),E=Math.min(n.y,c.y),L=Math.max(n.y,c.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new s.Point(g,E),new s.Point(b,L),new s.Point(g,L),new s.Point(b,E)],F=this.renderWorldCopies?-3:0,W=this.renderWorldCopies?4:1;for(const H of D){const Q=this.pointRayIntersection(H);if(Q.t<0)return!0;const he=this.rayIntersectionCoordinate(Q);if(he.x<F||he.y<0||he.x>W||he.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(n,c){const g=s.length(s.sub([],this._camera.position,n)),b=this._zoomFromMercatorZ(g)+c;return g-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([c,g,b],E){const L=[c,g,b,1];s.transformMat4$1(L,L,E);const D=L[3]=Math.max(L[3],1e-6);return L[0]/=D,L[1]/=D,L[2]/=D,L}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,n))}}getCameraToCenterDistance(n,c=this.zoom,g=this.worldSize){const b=th(n,c,this.width,this.height,1024),E=n.pixelSpaceConversion(this.center.lat,g,b);return .5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(n,n,this.globeMatrix),n}}function oc(f,n){let c=!1,g=null;const b=()=>{g=null,c&&(f(),g=setTimeout(b,n),c=!1)};return()=>(c=!0,g||b(),g)}class iu{constructor(n){this._hashName=n&&encodeURIComponent(n),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=oc(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,s.window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const c=_l(n);if(this._hashName){const g=this._hashName;let b=!1;const E=s.window.location.hash.slice(1).split("&").map(L=>{const D=L.split("=")[0];return D===g?(b=!0,`${D}=${c}`):L}).filter(L=>L);return b||E.push(`${g}=${c}`),`#${E.join("&")}`}return`#${c}`}_getCurrentHash(){const n=s.window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(c=g)}),(c&&c[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(g=>isNaN(g))){const g=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(c[3]||0):n.getBearing();return n.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:g,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,n)}}function _l(f,n){const c=f.getCenter(),g=Math.round(100*f.getZoom())/100,b=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,b),L=Math.round(c.lng*E)/E,D=Math.round(c.lat*E)/E,F=f.getBearing(),W=f.getPitch();let H=n?`/${L}/${D}/${g}`:`${g}/${D}/${L}`;return(F||W)&&(H+="/"+Math.round(10*F)/10),W&&(H+=`/${Math.round(W)}`),H}const ja={linearity:.3,easing:s.bezier(0,0,.3,1)},Xr=s.extend({deceleration:2500,maxSpeed:1400},ja),ih=s.extend({deceleration:20,maxSpeed:1400},ja),ui=s.extend({deceleration:1e3,maxSpeed:360},ja),to=s.extend({deceleration:1e3,maxSpeed:90},ja);class Bi{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,c=s.exported.now();for(;n.length>0&&c-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)c.zoom+=E.zoomDelta||0,c.bearing+=E.bearingDelta||0,c.pitch+=E.pitchDelta||0,E.panDelta&&c.pan._add(E.panDelta),E.around&&(c.around=E.around),E.pinchAround&&(c.pinchAround=E.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(c.pan.mag()){const E=$a(c.pan.mag(),g,s.extend({},Xr,n||{}));b.offset=c.pan.mult(E.amount/c.pan.mag()),b.center=this._map.transform.center,ac(b,E)}if(c.zoom){const E=$a(c.zoom,g,ih);b.zoom=this._map.transform.zoom+E.amount,ac(b,E)}if(c.bearing){const E=$a(c.bearing,g,ui);b.bearing=this._map.transform.bearing+s.clamp(E.amount,-179,179),ac(b,E)}if(c.pitch){const E=$a(c.pitch,g,to);b.pitch=this._map.transform.pitch+E.amount,ac(b,E)}if(b.zoom||b.bearing){const E=c.pinchAround===void 0?c.around:c.pinchAround;b.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function ac(f,n){(!f.duration||f.duration<n.duration)&&(f.duration=n.duration,f.easing=n.easing)}function $a(f,n,c){const{maxSpeed:g,linearity:b,deceleration:E}=c,L=s.clamp(f*b/(n/1e3),-g,g),D=Math.abs(L)/(E*b);return{easing:c.easing,duration:1e3*D,amount:L*(D/2)}}class ts extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,g,b={}){const E=ze(c.getCanvasContainer(),g),L=c.unproject(E);super(n,s.extend({point:E,lngLat:L,originalEvent:g},b)),this._defaultPrevented=!1,this.target=c}}class Ga extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,g){const b=n==="touchend"?g.changedTouches:g.touches,E=rt(c.getCanvasContainer(),b),L=E.map(F=>c.unproject(F)),D=E.reduce((F,W,H,Q)=>F.add(W.div(Q.length)),new s.Point(0,0));super(n,{points:E,point:D,lngLats:L,lngLat:c.unproject(D),originalEvent:g}),this._defaultPrevented=!1}}class ir extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,g){super(n,{originalEvent:g}),this._defaultPrevented=!1}}class lc{constructor(n,c){this._map=n,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new ir(n.type,this._map,n))}mousedown(n,c){return this._mousedownPos=c,this._firePreventable(new ts(n.type,this._map,n))}mouseup(n){this._map.fire(new ts(n.type,this._map,n))}preclick(n){const c=s.extend({},n);c.type="preclick",this._map.fire(new ts(c.type,this._map,c))}click(n,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(n),this._map.fire(new ts(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new ts(n.type,this._map,n))}mouseover(n){this._map.fire(new ts(n.type,this._map,n))}mouseout(n){this._map.fire(new ts(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Ga(n.type,this._map,n))}touchmove(n){this._map.fire(new Ga(n.type,this._map,n))}touchend(n){this._map.fire(new Ga(n.type,this._map,n))}touchcancel(n){this._map.fire(new Ga(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ru{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new ts(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ts("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ts(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xf{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,c){this.isEnabled()&&n.shiftKey&&n.button===0&&(Fe(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(n,c){if(!this._active)return;const g=c,b=this._startPos,E=this._lastPos;if(!b||!E||E.equals(g)||!this._box&&g.dist(b)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=ue("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const L=Math.min(b.x,g.x),D=Math.max(b.x,g.x),F=Math.min(b.y,g.y),W=Math.max(b.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${L}px,${F}px)`,this._box.style.width=D-L+"px",this._box.style.height=W-F+"px")})}mouseupWindow(n,c){if(!this._active)return;const g=this._startPos,b=c;if(g&&n.button===0){if(this.reset(),Oe(),g.x!==b.x||g.y!==b.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:E=>E.fitScreenCoordinates(g,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ae(),delete this._startPos,delete this._lastPos}_fireEvent(n,c){return this._map.fire(new s.Event(n,{originalEvent:c}))}}function nu(f,n){const c={};for(let g=0;g<f.length;g++)c[f[g].identifier]=n[g];return c}class yl{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,c,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),g.length===this.numTouches&&(this.centroid=function(b){const E=new s.Point(0,0);for(const L of b)E._add(L);return E.div(b.length)}(c),this.touches=nu(g,c)))}touchmove(n,c,g){if(this.aborted||!this.centroid)return;const b=nu(g,c);for(const E in this.touches){const L=b[E];(!L||L.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(n,c,g){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Wa{constructor(n){this.singleTap=new yl(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,c,g){this.singleTap.touchstart(n,c,g)}touchmove(n,c,g){this.singleTap.touchmove(n,c,g)}touchend(n,c,g){const b=this.singleTap.touchend(n,c,g);if(b){const E=n.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(b)<30;if(E&&L||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Mm{constructor(){this._zoomIn=new Wa({numTouches:1,numTaps:2}),this._zoomOut=new Wa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,c,g){this._zoomIn.touchstart(n,c,g),this._zoomOut.touchstart(n,c,g)}touchmove(n,c,g){this._zoomIn.touchmove(n,c,g),this._zoomOut.touchmove(n,c,g)}touchend(n,c,g){const b=this._zoomIn.touchend(n,c,g),E=this._zoomOut.touchend(n,c,g);return b?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(b)},{originalEvent:n})}):E?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(E)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Zf={0:1,2:2};class cc{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,c){return!1}_move(n,c){return{}}mousedown(n,c){if(this._lastPoint)return;const g=Ie(n);this._correctButton(n,g)&&(this._lastPoint=c,this._eventButton=g)}mousemoveWindow(n,c){const g=this._lastPoint;if(g){if(n.preventDefault(),this._eventButton!=null&&function(b,E){const L=Zf[E];return b.buttons===void 0||(b.buttons&L)!==L}(n,this._eventButton))this.reset();else if(this._moved||!(c.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(g,c)}}mouseupWindow(n){this._lastPoint&&Ie(n)===this._eventButton&&(this._moved&&Oe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hc extends cc{mousedown(n,c){super.mousedown(n,c),this._lastPoint&&(this._active=!0)}_correctButton(n,c){return c===0&&!n.ctrlKey}_move(n,c){return{around:c,panDelta:c.sub(n)}}}class Td extends cc{_correctButton(n,c){return c===0&&n.ctrlKey||c===2}_move(n,c){const g=.8*(c.x-n.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(n){n.preventDefault()}}class su extends cc{_correctButton(n,c){return c===0&&n.ctrlKey||c===2}_move(n,c){const g=-.5*(c.y-n.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(n){n.preventDefault()}}class ou{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(n,c,g){return this._calculateTransform(n,c,g)}touchmove(n,c,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,c,g)}}touchend(n,c,g){this._calculateTransform(n,c,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,c,g){g.length>0&&(this._active=!0);const b=nu(g,c),E=new s.Point(0,0),L=new s.Point(0,0);let D=0;for(const W in b){const H=b[W],Q=this._touches[W];Q&&(E._add(H),L._add(H.sub(Q)),D++,b[W]=H)}if(this._touches=b,D<this._minTouches||!L.mag())return;const F=L.div(D);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(D),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ue("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class rh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,c,g){return{}}touchstart(n,c,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([c[0],c[1]]))}touchmove(n,c,g){const b=this._firstTwoTouches;if(!b)return;n.preventDefault();const[E,L]=b,D=nh(g,c,E),F=nh(g,c,L);if(!D||!F)return;const W=this._aroundCenter?null:D.add(F).div(2);return this._move([D,F],W,n)}touchend(n,c,g){if(!this._firstTwoTouches)return;const[b,E]=this._firstTwoTouches,L=nh(g,c,b),D=nh(g,c,E);L&&D||(this._active&&Oe(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function nh(f,n,c){for(let g=0;g<f.length;g++)if(f[g].identifier===c)return n[g]}function Ed(f,n){return Math.log(f/n)/Math.LN2}class Yf extends rh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,c){const g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Ed(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ed(this._distance,g),pinchAround:c}}}function au(f,n){return 180*f.angleWith(n)/Math.PI}class Kf extends rh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,c){const g=this._vector;if(this._vector=n[0].sub(n[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:au(this._vector,g),pinchAround:c}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const c=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const b=au(n,g);return Math.abs(b)<c}}function Ha(f){return Math.abs(f.y)>Math.abs(f.x)}class Sd extends rh{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Ha(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,c,g){const b=this._lastPoints;if(!b)return;const E=n[0].sub(b[0]),L=n[1].sub(b[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(E,L,g.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(E.y+L.y)/2*-.5})}gestureBeginsVertically(n,c,g){if(this._valid!==void 0)return this._valid;const b=n.mag()>=2,E=c.mag()>=2;if(!b&&!E)return;if(!b||!E)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const L=n.y>0==c.y>0;return Ha(n)&&Ha(c)&&L}}const Cd={panStep:100,bearingStep:15,pitchStep:10};class Xo{constructor(){const n=Cd;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let c=0,g=0,b=0,E=0,L=0;switch(n.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:n.shiftKey?g=-1:(n.preventDefault(),E=-1);break;case 39:n.shiftKey?g=1:(n.preventDefault(),E=1);break;case 38:n.shiftKey?b=1:(n.preventDefault(),L=-1);break;case 40:n.shiftKey?b=-1:(n.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(g=0,b=0),{cameraAnimation:D=>{const F=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:Jf,zoom:c?Math.round(F)+c*(n.shiftKey?2:1):F,bearing:D.getBearing()+g*this._bearingStep,pitch:D.getPitch()+b*this._pitchStep,offset:[-E*this._panStep,-L*this._panStep],center:D.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jf(f){return f*(2-f)}const Ad=4.000244140625;class Qf{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=n.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const g=s.exported.now(),b=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,c!==0&&c%Ad==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(b*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),n.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=n,this._delta-=c,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=ze(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>Ad?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&W!==0&&(W=1/W);const H=c(),Q=Math.pow(2,H),he=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(he*W))),this._type==="wheel"&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:c(),b=this._startZoom,E=this._easing;let L,D=!1;if(this._type==="wheel"&&b&&E){const F=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),W=E(F);L=s.number(b,g,W),F<1?this._frameId||(this._frameId=!0):D=!0}else L=g,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:L-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let c=s.ease;if(this._prevEase){const g=this._prevEase,b=(s.exported.now()-g.start)/g.duration,E=g.easing(b+.01)-g.easing(b),L=.27/Math.sqrt(E*E+1e-4)*.01,D=Math.sqrt(.0729-L*L);c=s.bezier(L,D,.25,1)}return this._prevEase={start:s.exported.now(),duration:n,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ue("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Md{constructor(n,c){this._clickZoom=n,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ms{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,c){return n.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(n.shiftKey?-1:1),around:g.unproject(c)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Im{constructor(){this._tap=new Wa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,c,g){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=c[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(n,c,g))}touchmove(n,c,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const b=c[0],E=b.y-this._swipePoint.y;return this._swipePoint=b,n.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(n,c,g)}touchend(n,c,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(n,c,g)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sh{constructor(n,c,g){this._el=n,this._mousePan=c,this._touchPan=g}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class km{constructor(n,c,g){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=c,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ep{constructor(n,c,g,b){this._el=n,this._touchZoom=c,this._touchRotate=g,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const io=f=>f.zoom||f.drag||f.pitch||f.rotate;class tp extends s.Event{}class ip{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,c){const g=s.sub([],c,n);this.radius=s.length(g[2]<0?s.div([],g,this.constants):[g[0],g[1],0])}projectRay(n){s.div(n,n,this.constants),s.normalize(n,n),s.mul$1(n,n,this.constants);const c=s.scale$2([],n,this.radius);if(c[2]>0){const g=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),b=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),E=s.add([],c,s.scale$2([],s.sub([],s.add([],b,g),c),2));c[0]=E[0],c[1]=E[1]}return c}}function So(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Zo{constructor(n,c){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bi(n),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ip,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[b,E,L]of this._listeners)b.addEventListener(E,b===s.window.document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[n,c,g]of this._listeners)n.removeEventListener(c,n===s.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(n){const c=this._map,g=c.getCanvasContainer();this._add("mapEvent",new lc(c,n));const b=c.boxZoom=new Xf(c,n);this._add("boxZoom",b);const E=new Mm,L=new ms;c.doubleClickZoom=new Md(L,E),this._add("tapZoom",E),this._add("clickZoom",L);const D=new Im;this._add("tapDragZoom",D);const F=c.touchPitch=new Sd(c);this._add("touchPitch",F);const W=new Td(n),H=new su(n);c.dragRotate=new km(n,W,H),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const Q=new hc(n),he=new ou(c,n);c.dragPan=new sh(g,Q,he),this._add("mousePan",Q),this._add("touchPan",he,["touchZoom","touchRotate"]);const me=new Kf,ye=new Yf;c.touchZoomRotate=new ep(g,ye,me,D),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",ye,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ru(c));const _e=c.scrollZoom=new Qf(c,this);this._add("scrollZoom",_e,["mousePan"]);const be=c.keyboard=new Xo;this._add("keyboard",be);for(const ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[ee]&&c[ee].enable(n[ee])}_add(n,c,g){this._handlers.push({handlerName:n,handler:c,allowed:g}),this._handlersById[n]=c}stop(n){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!io(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,c,g){for(const b in n)if(b!==g&&(!c||c.indexOf(b)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const c=[];for(const g of n)this._el.contains(g.target)&&c.push(g);return c}handleEvent(n,c){this._updatingCamera=!0;const g=n.type==="renderFrame",b=g?void 0:n,E={needsRenderFrame:!1},L={},D={},F=n.touches?this._getMapTouches(n.touches):void 0,W=F?rt(this._el,F):g?void 0:ze(this._el,n);for(const{handlerName:he,handler:me,allowed:ye}of this._handlers){if(!me.isEnabled())continue;let _e;this._blockedByActive(D,ye,he)?me.reset():me[c||n.type]&&(_e=me[c||n.type](n,W,F),this.mergeHandlerResult(E,L,_e,he,b),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||me.isActive())&&(D[he]=me)}const H={};for(const he in this._previousActiveHandlers)D[he]||(H[he]=b);this._previousActiveHandlers=D,(Object.keys(H).length||So(E))&&(this._changes.push([E,L,H]),this._triggerRenderFrame()),(Object.keys(D).length||So(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=E;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(n,c,g,b,E){if(!g)return;s.extend(n,g);const L={handlerName:b,originalEvent:g.originalEvent||E};g.zoomDelta!==void 0&&(c.zoom=L),g.panDelta!==void 0&&(c.drag=L),g.pitchDelta!==void 0&&(c.pitch=L),g.bearingDelta!==void 0&&(c.rotate=L)}_applyChanges(){const n={},c={},g={};for(const[b,E,L]of this._changes)b.panDelta&&(n.panDelta=(n.panDelta||new s.Point(0,0))._add(b.panDelta)),b.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(n.around=b.around),b.aroundCoord!==void 0&&(n.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(n.pinchAround=b.pinchAround),b.noInertia&&(n.noInertia=b.noInertia),s.extend(c,E),s.extend(g,L);this._updateMapTransform(n,c,g),this._changes=[]}_updateMapTransform(n,c,g){const b=this._map,E=b.transform,L=pe=>[pe.x,pe.y,pe.z];if((pe=>{const Ce=this._eventsInProgress.drag;return Ce&&!this._handlersById[Ce.handlerName].isActive()})()&&!So(n)){const pe=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",pe!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&b._stop(!0),!So(n))return void this._fireEvents(c,g,!0);let{panDelta:D,zoomDelta:F,bearingDelta:W,pitchDelta:H,around:Q,aroundCoord:he,pinchAround:me}=n;E._isCameraConstrained&&(F>0&&(F=0),E._isCameraConstrained=!1),me!==void 0&&(Q=me),(F||(pe=>c[pe]&&!this._eventsInProgress[pe])("drag"))&&Q&&(this._dragOrigin=L(E.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",b._stop(!0),Q=Q||b.transform.centerPoint,W&&(E.bearing+=W),H&&(E.pitch+=H),E._updateCameraState();const ye=[0,0,0];if(D)if(E.projection.name==="mercator"){const pe=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Q).dir),Ce=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Q.sub(D)).dir);ye[0]=Ce[0]-pe[0],ye[1]=Ce[1]-pe[1]}else{const pe=E.pointCoordinate(Q);if(E.projection.name==="globe"){D=D.rotate(-E.angle);const Ce=E._pixelsPerMercatorPixel/E.worldSize;ye[0]=-D.x*s.mercatorScale(s.latFromMercatorY(pe.y))*Ce,ye[1]=-D.y*s.mercatorScale(E.center.lat)*Ce}else{const Ce=E.pointCoordinate(Q.sub(D));pe&&Ce&&(ye[0]=Ce.x-pe.x,ye[1]=Ce.y-pe.y)}}const _e=E.zoom,be=[0,0,0];if(F){const pe=L(he||E.pointCoordinate3D(Q)),Ce={dir:s.normalize([],s.sub([],pe,E._camera.position))};if(Ce.dir[2]<0){const ke=E.zoomDeltaToMovement(pe,F);s.scale$2(be,Ce.dir,ke)}}const ee=s.add(ye,ye,be);E._translateCameraConstrained(ee),F&&Math.abs(E.zoom-_e)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(c,g,!0)}_fireEvents(n,c,g){const b=io(this._eventsInProgress),E=io(n),L={};for(const H in n){const{originalEvent:Q}=n[H];this._eventsInProgress[H]||(L[`${H}start`]=Q),this._eventsInProgress[H]=n[H]}!b&&E&&this._fireEvent("movestart",E.originalEvent);for(const H in L)this._fireEvent(H,L[H]);E&&this._fireEvent("move",E.originalEvent);for(const H in n){const{originalEvent:Q}=n[H];this._fireEvent(H,Q)}const D={};let F;for(const H in this._eventsInProgress){const{handlerName:Q,originalEvent:he}=this._eventsInProgress[H];this._handlersById[Q].isActive()||(delete this._eventsInProgress[H],F=c[Q]||he,D[`${H}end`]=F)}for(const H in D)this._fireEvent(H,D[H]);const W=io(this._eventsInProgress);if(g&&(b||E)&&!W){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=he=>he!==0&&-this._bearingSnap<he&&he<this._bearingSnap;H?(Q(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:F})):(this._map.fire(new s.Event("moveend",{originalEvent:F})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,c){this._map.fire(new s.Event(n,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new tp("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const xl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class wa extends s.Evented{constructor(n,c){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,c){return this.jumpTo({center:n},c)}panBy(n,c,g){return n=s.Point.convert(n).mult(-1),this.panTo(this.transform.center,s.extend({offset:n},c),g)}panTo(n,c,g){return this.easeTo(s.extend({center:n},c),g)}getZoom(){return this.transform.zoom}setZoom(n,c){return this.jumpTo({zoom:n},c),this}zoomTo(n,c,g){return this.easeTo(s.extend({zoom:n},c),g)}zoomIn(n,c){return this.zoomTo(this.getZoom()+1,n,c),this}zoomOut(n,c){return this.zoomTo(this.getZoom()-1,n,c),this}getBearing(){return this.transform.bearing}setBearing(n,c){return this.jumpTo({bearing:n},c),this}getPadding(){return this.transform.padding}setPadding(n,c){return this.jumpTo({padding:n},c),this}rotateTo(n,c,g){return this.easeTo(s.extend({bearing:n},c),g)}resetNorth(n,c){return this.rotateTo(0,s.extend({duration:1e3},n),c),this}resetNorthPitch(n,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},n),c),this}snapToNorth(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this}getPitch(){return this.transform.pitch}setPitch(n,c){return this.jumpTo({pitch:n},c),this}cameraForBounds(n,c){n=s.LngLatBounds.convert(n);const g=c&&c.bearing||0,b=c&&c.pitch||0,E=n.getNorthWest(),L=n.getSouthEast();return this._cameraForBounds(this.transform,E,L,g,b,c)}_extendCameraOptions(n){const c={top:0,bottom:0,right:0,left:0};if(typeof(n=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=="number"){const g=n.padding;n.padding={top:g,bottom:g,right:g,left:g}}return n.padding=s.extend(c,n.padding),n}_minimumAABBFrustumDistance(n,c){const g=c.max[0]-c.min[0],b=c.max[1]-c.min[1];return g/b>n.aspect?g/(2*Math.tan(.5*n.fovX)*n.aspect):b/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,c,g,b,E,L){const D=n.clone(),F=this._extendCameraOptions(L);D.bearing=b,D.pitch=E;const W=s.LngLat.convert(c),H=s.LngLat.convert(g),Q=.5*(W.lat+H.lat),he=.5*(W.lng+H.lng),me=s.latLngToECEF(Q,he),ye=s.normalize([],me),_e=s.normalize([],s.cross([],ye,[0,1,0])),be=s.cross([],_e,ye),ee=[_e[0],_e[1],_e[2],0,be[0],be[1],be[2],0,ye[0],ye[1],ye[2],0,0,0,0,1],pe=[me,s.latLngToECEF(W.lat,W.lng),s.latLngToECEF(H.lat,W.lng),s.latLngToECEF(H.lat,H.lng),s.latLngToECEF(W.lat,H.lng),s.latLngToECEF(Q,W.lng),s.latLngToECEF(Q,H.lng),s.latLngToECEF(W.lat,he),s.latLngToECEF(H.lat,he)];let Ce=s.Aabb.fromPoints(pe.map(Ct=>[s.dot(_e,Ct),s.dot(be,Ct),s.dot(ye,Ct)]));const ke=s.transformMat4([],Ce.center,ee);s.squaredLength(ke)===0&&s.set(ke,0,0,1),s.normalize(ke,ke),s.scale$2(ke,ke,s.GLOBE_RADIUS),D.center=s.ecefToLatLng(ke);const Ge=D.getWorldToCameraMatrix(),Ne=s.invert(new Float64Array(16),Ge);Ce=s.Aabb.applyTransform(Ce,s.multiply([],Ge,ee)),s.transformMat4(ke,ke,Ge);const We=.5*(Ce.max[2]-Ce.min[2]),it=this._minimumAABBFrustumDistance(D,Ce),et=s.scale$2([],[0,0,1],We),ft=s.add(et,ke,et),Nt=it+(D.pitch===0?0:s.distance(ke,ft)),ht=D.globeCenterInViewSpace,Mt=s.sub([],ke,[ht[0],ht[1],ht[2]]);s.normalize(Mt,Mt),s.scale$2(Mt,Mt,Nt);const _t=s.add([],ke,Mt);s.transformMat4(_t,_t,Ne);const Vt=s.earthRadius/s.GLOBE_RADIUS,lt=s.length(_t),kt=s.mercatorZfromAltitude(Math.max(lt*Vt-s.earthRadius,Number.EPSILON),0),jt=Math.min(D.zoomFromMercatorZAdjusted(kt),F.maxZoom);return jt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"mercator"}),D.zoom=jt,this._cameraForBounds(D,c,g,b,E,L)):{center:D.center,zoom:jt,bearing:b,pitch:E}}queryTerrainElevation(n,c){const g=this.transform.elevation;return g?(c=s.extend({},{exaggerated:!0},c),g.getAtPoint(s.MercatorCoordinate.fromLngLat(n),null,c.exaggerated)):null}_cameraForBounds(n,c,g,b,E,L){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,c,g,b,E,L);const D=n.clone(),F=this._extendCameraOptions(L),W=D.padding;D.bearing=b,D.pitch=E;const H=s.LngLat.convert(c),Q=s.LngLat.convert(g),he=new s.LngLat(H.lng,Q.lat),me=new s.LngLat(Q.lng,H.lat),ye=D.project(H),_e=D.project(Q),be=this.queryTerrainElevation(H),ee=this.queryTerrainElevation(Q),pe=this.queryTerrainElevation(he),Ce=this.queryTerrainElevation(me),ke=[[ye.x,ye.y,Math.min(be||0,ee||0,pe||0,Ce||0)],[_e.x,_e.y,Math.max(be||0,ee||0,pe||0,Ce||0)]];let Ge=s.Aabb.fromPoints(ke);const Ne=D.getWorldToCameraMatrix(),We=s.invert(new Float64Array(16),Ne);Ge=s.Aabb.applyTransform(Ge,Ne);const it=s.sub([],Ge.max,Ge.min),et=W.left||0,ft=W.right||0,Nt=W.bottom||0,ht=W.top||0,{left:Mt,right:_t,top:Vt,bottom:lt}=F.padding,kt=.5*(et+ft),jt=.5*(ht+Nt),Ct=Math.min(D.scaleZoom(D.scale*Math.min((D.width-(et+ft+Mt+_t))/it[0],(D.height-(Nt+ht+lt+Vt))/it[1])),F.maxZoom),Ht=D.scale/D.zoomScale(Ct);Ge=new s.Aabb([Ge.min[0]-(Mt+kt)*Ht,Ge.min[1]-(lt+jt)*Ht,Ge.min[2]],[Ge.max[0]+(_t+kt)*Ht,Ge.max[1]+(Vt+jt)*Ht,Ge.max[2]]);const Ii=.5*it[2],Fi=this._minimumAABBFrustumDistance(D,Ge),vi=[0,0,1,0];s.transformMat4$1(vi,vi,Ne),s.normalize$2(vi,vi);const Pi=s.scale$2([],vi,Fi+Ii),Gi=s.add([],Ge.center,Pi),Wi=(typeof F.offset.x=="number"&&typeof F.offset.y=="number"?new s.Point(F.offset.x,F.offset.y):s.Point.convert(F.offset)).rotate(-s.degToRad(b));Ge.center[0]-=Wi.x*Ht,Ge.center[1]+=Wi.y*Ht,s.transformMat4(Ge.center,Ge.center,We),s.transformMat4(Gi,Gi,We);const Ci=[Ge.center[0],Ge.center[1],Gi[2]*D.pixelsPerMeter];s.scale$2(Ci,Ci,1/D.worldSize);const Ar=s.lngFromMercatorX(Ci[0]),Lr=s.latFromMercatorY(Ci[1]),Dr=Math.min(D._zoomFromMercatorZ(Ci[2]),F.maxZoom),Or=new s.LngLat(Ar,Lr);return D.mercatorFromTransition&&Dr<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"globe"}),D.zoom=Dr,this._cameraForBounds(D,c,g,b,E,L)):{center:Or,zoom:Dr,bearing:b,pitch:E}}fitBounds(n,c,g){const b=this.cameraForBounds(n,c);return this._fitInternal(b,c,g)}fitScreenCoordinates(n,c,g,b,E){const L=s.Point.convert(n),D=s.Point.convert(c),F=new s.Point(Math.min(L.x,D.x),Math.min(L.y,D.y)),W=new s.Point(Math.max(L.x,D.x),Math.max(L.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(L,D))return this;const H=this.transform.pointLocation3D(F),Q=this.transform.pointLocation3D(W),he=this.transform.pointLocation3D(new s.Point(F.x,W.y)),me=this.transform.pointLocation3D(new s.Point(W.x,F.y)),ye=[Math.min(H.lng,Q.lng,he.lng,me.lng),Math.min(H.lat,Q.lat,he.lat,me.lat)],_e=[Math.max(H.lng,Q.lng,he.lng,me.lng),Math.max(H.lat,Q.lat,he.lat,me.lat)],be=b&&b.pitch?b.pitch:this.getPitch(),ee=this._cameraForBounds(this.transform,ye,_e,g,be,b);return this._fitInternal(ee,b,E)}_fitInternal(n,c,g){return n?(delete(c=s.extend(n,c)).padding,c.linear?this.easeTo(c,g):this.flyTo(c,g)):this}jumpTo(n,c){this.stop();const g=n.preloadOnly?this.transform.clone():this.transform;let b=!1,E=!1,L=!1;return"zoom"in n&&g.zoom!==+n.zoom&&(b=!0,g.zoom=+n.zoom),n.center!==void 0&&(g.center=s.LngLat.convert(n.center)),"bearing"in n&&g.bearing!==+n.bearing&&(E=!0,g.bearing=+n.bearing),"pitch"in n&&g.pitch!==+n.pitch&&(L=!0,g.pitch=+n.pitch),n.padding==null||g.isPaddingEqual(n.padding)||(g.padding=n.padding),n.preloadOnly?(this._preloadTiles(g),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),b&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),E&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),L&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(xl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,c){const g=this.transform;if(!g.projection.supportsFreeCamera)return s.warnOnce(xl),this;this.stop();const b=g.zoom,E=g.pitch,L=g.bearing;g.setFreeCameraOptions(n);const D=b!==g.zoom,F=E!==g.pitch,W=L!==g.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),D&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),W&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),F&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(n,c){this._stop(!1,n.easeId),((n=s.extend({offset:[0,0],duration:500,easing:s.ease},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const g=this.transform,b=this.getZoom(),E=this.getBearing(),L=this.getPitch(),D=this.getPadding(),F="zoom"in n?+n.zoom:b,W="bearing"in n?this._normalizeBearing(n.bearing,E):E,H="pitch"in n?+n.pitch:L,Q="padding"in n?n.padding:g.padding,he=s.Point.convert(n.offset);let me,ye,_e;if(g.projection.name==="globe"){const et=s.MercatorCoordinate.fromLngLat(g.center),ft=he.rotate(-g.angle);et.x+=ft.x/g.worldSize,et.y+=ft.y/g.worldSize;const Nt=et.toLngLat(),ht=s.LngLat.convert(n.center||Nt);this._normalizeCenter(ht),me=g.centerPoint.add(ft),ye=new s.Point(et.x,et.y).mult(g.worldSize),_e=new s.Point(s.mercatorXfromLng(ht.lng),s.mercatorYfromLat(ht.lat)).mult(g.worldSize).sub(ye)}else{me=g.centerPoint.add(he);const et=g.pointLocation(me),ft=s.LngLat.convert(n.center||et);this._normalizeCenter(ft),ye=g.project(et),_e=g.project(ft).sub(ye)}const be=g.zoomScale(F-b);let ee,pe;n.around&&(ee=s.LngLat.convert(n.around),pe=g.locationPoint(ee));const Ce=this._zooming||F!==b,ke=this._rotating||E!==W,Ge=this._pitching||H!==L,Ne=!g.isPaddingEqual(Q),We=et=>ft=>{if(Ce&&(et.zoom=s.number(b,F,ft)),ke&&(et.bearing=s.number(E,W,ft)),Ge&&(et.pitch=s.number(L,H,ft)),Ne&&(et.interpolatePadding(D,Q,ft),me=et.centerPoint.add(he)),ee)et.setLocationAtPoint(ee,pe);else{const Nt=et.zoomScale(et.zoom-b),ht=F>b?Math.min(2,be):Math.max(.5,be),Mt=Math.pow(ht,1-ft),_t=et.unproject(ye.add(_e.mult(ft*Mt)).mult(Nt));et.setLocationAtPoint(et.renderWorldCopies?_t.wrap():_t,me)}return n.preloadOnly||this._fireMoveEvents(c),et};if(n.preloadOnly){const et=this._emulate(We,n.duration,g);return this._preloadTiles(et),this}const it={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ce,this._rotating=ke,this._pitching=Ge,this._padding=Ne,this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,it),this._ease(We(g),et=>{g.recenterOnTerrain(),this._afterEase(c,et)},n),this}_prepareEase(n,c,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||g.moving||this.fire(new s.Event("movestart",n)),this._zooming&&!g.zooming&&this.fire(new s.Event("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new s.Event("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new s.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new s.Event("move",n)),this._zooming&&this.fire(new s.Event("zoom",n)),this._rotating&&this.fire(new s.Event("rotate",n)),this._pitching&&this.fire(new s.Event("pitch",n))}_afterEase(n,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,b=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new s.Event("zoomend",n)),b&&this.fire(new s.Event("rotateend",n)),E&&this.fire(new s.Event("pitchend",n)),this.fire(new s.Event("moveend",n))}flyTo(n,c){if(this._prefersReducedMotion(n)){const Ct=s.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ct,c)}this.stop(),n=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},n);const g=this.transform,b=this.getZoom(),E=this.getBearing(),L=this.getPitch(),D=this.getPadding(),F="zoom"in n?s.clamp(+n.zoom,g.minZoom,g.maxZoom):b,W="bearing"in n?this._normalizeBearing(n.bearing,E):E,H="pitch"in n?+n.pitch:L,Q="padding"in n?n.padding:g.padding,he=g.zoomScale(F-b),me=s.Point.convert(n.offset);let ye=g.centerPoint.add(me);const _e=g.pointLocation(ye),be=s.LngLat.convert(n.center||_e);this._normalizeCenter(be);const ee=g.project(_e),pe=g.project(be).sub(ee);let Ce=n.curve;const ke=Math.max(g.width,g.height),Ge=ke/he,Ne=pe.mag();if("minZoom"in n){const Ct=s.clamp(Math.min(n.minZoom,b,F),g.minZoom,g.maxZoom),Ht=ke/g.zoomScale(Ct-b);Ce=Math.sqrt(Ht/Ne*2)}const We=Ce*Ce;function it(Ct){const Ht=(Ge*Ge-ke*ke+(Ct?-1:1)*We*We*Ne*Ne)/(2*(Ct?Ge:ke)*We*Ne);return Math.log(Math.sqrt(Ht*Ht+1)-Ht)}function et(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function ft(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const Nt=it(0);let ht=function(Ct){return ft(Nt)/ft(Nt+Ce*Ct)},Mt=function(Ct){return ke*((ft(Nt)*(et(Ht=Nt+Ce*Ct)/ft(Ht))-et(Nt))/We)/Ne;var Ht},_t=(it(1)-Nt)/Ce;if(Math.abs(Ne)<1e-6||!isFinite(_t)){if(Math.abs(ke-Ge)<1e-6)return this.easeTo(n,c);const Ct=Ge<ke?-1:1;_t=Math.abs(Math.log(Ge/ke))/Ce,Mt=function(){return 0},ht=function(Ht){return Math.exp(Ct*Ce*Ht)}}n.duration="duration"in n?+n.duration:1e3*_t/("screenSpeed"in n?+n.screenSpeed/Ce:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const Vt=E!==W,lt=H!==L,kt=!g.isPaddingEqual(Q),jt=Ct=>Ht=>{const Ii=Ht*_t,Fi=1/ht(Ii);Ct.zoom=Ht===1?F:b+Ct.scaleZoom(Fi),Vt&&(Ct.bearing=s.number(E,W,Ht)),lt&&(Ct.pitch=s.number(L,H,Ht)),kt&&(Ct.interpolatePadding(D,Q,Ht),ye=Ct.centerPoint.add(me));const vi=Ht===1?be:Ct.unproject(ee.add(pe.mult(Mt(Ii))).mult(Fi));return Ct.setLocationAtPoint(Ct.renderWorldCopies?vi.wrap():vi,ye),Ct._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(c),Ct};if(n.preloadOnly){const Ct=this._emulate(jt,n.duration,g);return this._preloadTiles(Ct),this}return this._zooming=!0,this._rotating=Vt,this._pitching=lt,this._padding=kt,this._prepareEase(c,!1),this._ease(jt(g),()=>this._afterEase(c),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,c)}if(!n){const g=this.handlers;g&&g.stop(!1)}return this}_ease(n,c,g){g.animate===!1||g.duration===0?(n(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,c){n=s.wrap(n,-180,180);const g=Math.abs(n-c);return Math.abs(n-360-c)<g&&(n-=360),Math.abs(n+360-c)<g&&(n+=360),n}_normalizeCenter(n){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const g=n.lng-c.center.lng;n.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,c,g){const b=Math.ceil(15*c/1e3),E=[],L=n(g.clone());for(let D=0;D<=b;D++){const F=L(D/b);E.push(F.clone())}return E}}class _i{constructor(n={}){this.options=n,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const c=this.options&&this.options.compact;return this._map=n,this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ue("button","mapboxgl-ctrl-attrib-button",this._container),ue("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ue("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(n,c){const g=this._map._getUIString(`AttributionControl.${c}`);n.setAttribute("aria-label",g),n.removeAttribute("title"),n.firstElementChild&&n.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(n){const g=c.reduce((b,E,L)=>(E.value&&(b+=`${E.key}=${E.value}${L<c.length-1?"&":""}`),b),"?");n.href=`${s.config.FEEDBACK_URL}/${g}#${_l(this._map,!0)}`,n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const c=this._map.style._sourceCaches;for(const b in c){const E=c[b];if(E.used){const L=E.getSource();L.attribution&&n.indexOf(L.attribution)<0&&n.push(L.attribution)}}n.sort((b,E)=>b.length-E.length),n=n.filter((b,E)=>{for(let L=E+1;L<n.length;L++)if(n[L].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const g=n.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Id{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=ue("div","mapboxgl-ctrl");const c=ue("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const c in n){const g=n[c].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class kd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const c=++this._id;return this._queue.push({callback:n,id:c,cancelled:!1}),c}remove(n){const c=this._currentlyRunning,g=c?this._queue.concat(c):this._queue;for(const b of g)if(b.id===n)return void(b.cancelled=!0)}run(n=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const g of c)if(!g.cancelled&&(g.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function vl(f,n,c){if(f=new s.LngLat(f.lng,f.lat),n){const g=new s.LngLat(f.lng-360,f.lat),b=new s.LngLat(f.lng+360,f.lat),E=360*Math.ceil(Math.abs(f.lng-c.center.lng)/360),L=c.locationPoint(f).distSqr(n),D=n.x<0||n.y<0||n.x>c.width||n.y>c.height;c.locationPoint(g).distSqr(n)<L&&(D||Math.abs(g.lng-c.center.lng)<E)?f=g:c.locationPoint(b).distSqr(n)<L&&(D||Math.abs(b.lng-c.center.lng)<E)&&(f=b)}for(;Math.abs(f.lng-c.center.lng)>180;){const g=c.locationPoint(f);if(g.x>=0&&g.y>=0&&g.x<=c.width&&g.y<=c.height)break;f.lng>c.center.lng?f.lng-=360:f.lng+=360}return f}const qa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class oi extends s.Evented{constructor(n,c){if(super(),(n instanceof s.window.HTMLElement||c)&&(n=s.extend({element:n},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=n&&n.occludedOpacity||.2,n&&n.element)this._element=n.element,this._offset=s.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=ue("div");const b=41,E=27,L=we("svg",{display:"block",height:b*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${b}`},this._element),D=we("radialGradient",{id:"shadowGradient"},we("defs",{},L));we("stop",{offset:"10%","stop-opacity":.4},D),we("stop",{offset:"100%","stop-opacity":.05},D),we("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),we("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),we("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),we("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=s.Point.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const g=this._element.classList;for(const b in qa)g.remove(`mapboxgl-marker-anchor-${b}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=s.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const c=n.code,g=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(n){const c=n.originalEvent.target,g=this._element;this._popup&&(c===g||g.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,c=this._pos;if(!n||!c)return!1;const g=n.unproject(c),b=n.getFreeCameraOptions();if(!b.position)return!1;const E=b.position.toLngLat();return E.distanceTo(g)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const c=this._pos;if(!c||c.x<0||c.x>n.transform.width||c.y<0||c.y>n.transform.height)return void this._clearFadeTimer();const g=n.unproject(c);let b;n._showingGlobe()&&s.isLngLatBehindGlobe(n.transform,this._lngLat)?b=0:(b=1-n._queryFogOpacity(g),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${qa[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const n=this._pos,c=this._map,g=this.getPitchAlignment();if(!c||!n||g!=="map")return"";if(!c._showingGlobe()){const F=c.getPitch();return F?`rotateX(${F}deg)`:""}const b=s.radToDeg(s.globeTiltAtLngLat(c.transform,this._lngLat)),E=n.sub(s.globeCenterToScreenPoint(c.transform)),L=Math.abs(E.x)+Math.abs(E.y);if(L===0)return"";const D=b/L;return`rotateX(${-E.y*D}deg) rotateY(${E.x*D}deg)`}_calculateZTransform(){const n=this._pos,c=this._map;if(!c||!n)return"";let g=0;const b=this.getRotationAlignment();if(b==="map")if(c._showingGlobe()){const E=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),L=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);g=s.radToDeg(Math.atan2(L.y,L.x))-90}else g=-c.getBearing();else if(b==="horizon"){const E=s.smoothstep(4,6,c.getZoom()),L=s.globeCenterToScreenPoint(c.transform);L.y+=E*c.transform.height;const D=n.sub(L),F=s.radToDeg(Math.atan2(D.y,D.x));g=(F>90?F-270:F+90)*(1-E)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(n){s.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=vl(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),n===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=s.Point.convert(n),this._update(),this}_onMove(n){const c=this._map;if(!c)return;const g=this._pointerdownPos,b=this._positionDelta;if(g&&b){if(!this._isDragging){const E=this._clickTolerance||c._clickTolerance;if(n.point.dist(g)<E)return;this._isDragging=!0}this._pos=n.point.sub(b),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(n){const c=this._map,g=this._pos;c&&g&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(g),this._pointerdownPos=n.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const c=this._map;return c&&(n?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Pd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Pm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lu(f=new s.Point(0,0),n="bottom"){if(typeof f=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(n){case"top":return new s.Point(0,f);case"top-left":return new s.Point(c,c);case"top-right":return new s.Point(-c,c);case"bottom":return new s.Point(0,-f);case"bottom-left":return new s.Point(c,-c);case"bottom-right":return new s.Point(-c,-c);case"left":return new s.Point(f,0);case"right":return new s.Point(-f,0)}return new s.Point(0,0)}return f instanceof s.Point||Array.isArray(f)?s.Point.convert(f):s.Point.convert(f[n]||[0,0])}class Ld{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const c=s.easeCubicInOut((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,c,g){this._start=this.getValue(c),this._end=n,this._startTime=c,this._endTime=c+g}}const bl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},rp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Dd={showCompass:!0,showZoom:!0,visualizePitch:!1};class Lm{constructor(n,c,g=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Td({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,g&&(this.mousePitch=new su({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(n,c){this.mouseRotate.mousedown(n,c),this.mousePitch&&this.mousePitch.mousedown(n,c),Fe()}move(n,c){const g=this.map,b=this.mouseRotate.mousemoveWindow(n,c),E=b&&b.bearingDelta;if(E&&g.setBearing(g.getBearing()+E),this.mousePitch){const L=this.mousePitch.mousemoveWindow(n,c),D=L&&L.pitchDelta;D&&g.setPitch(g.getPitch()+D)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ae(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(s.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),ze(this.element,n)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,ze(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=rt(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=rt(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const oh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},cu={maxWidth:100,unit:"metric"},Od={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},uc={version:s.version,supported:Z,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends wa{constructor(f){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(f=s.extend({},rp,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(f.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Cr(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new kd,this._domRenderTaskQueue=new kd,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},bl,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ld(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=s.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Zo(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new iu(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,s.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new _i({customAttribution:f.customAttribution})),this._logoControl=new Id,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new s.Event(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new s.Event(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(f,n){if(n===void 0&&(n=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=f.onAdd(this);this._controls.push(f);const g=this._controlPositions[n];return n.indexOf("bottom")!==-1?g.insertBefore(c,g.firstChild):g.appendChild(c),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(f);return n>-1&&this._controls.splice(n,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new s.Event("movestart",f)).fire(new s.Event("move",f)),this.fire(new s.Event("resize",f)),n&&this.fire(new s.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(s.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?s.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(n=>n==="auto"?s.window.navigator.language:n):f}setLanguage(f){const n=this._parseLanguage(f);if(!this.style||n===this._language)return this;this._language=n,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,n=f.projection.name;let c;n==="globe"&&f.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),c=!0):n==="mercator"&&f.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,n){return this._updateProjection(f||n||{name:"mercator"})}_updateProjection(f){let n;if(n=f.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),n){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(s.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(s.Point.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,n,c){if(f==="mouseenter"||f==="mouseover"){let g=!1;const b=L=>{const D=n.filter(W=>this.getLayer(W)),F=D.length?this.queryRenderedFeatures(L.point,{layers:D}):[];F.length?g||(g=!0,c.call(this,new ts(f,this,L.originalEvent,{features:F}))):g=!1},E=()=>{g=!1};return{layers:new Set(n),listener:c,delegates:{mousemove:b,mouseout:E}}}if(f==="mouseleave"||f==="mouseout"){let g=!1;const b=L=>{const D=n.filter(F=>this.getLayer(F));(D.length?this.queryRenderedFeatures(L.point,{layers:D}):[]).length?g=!0:g&&(g=!1,c.call(this,new ts(f,this,L.originalEvent)))},E=L=>{g&&(g=!1,c.call(this,new ts(f,this,L.originalEvent)))};return{layers:new Set(n),listener:c,delegates:{mousemove:b,mouseout:E}}}{const g=b=>{const E=n.filter(D=>this.getLayer(D)),L=E.length?this.queryRenderedFeatures(b.point,{layers:E}):[];L.length&&(b.features=L,c.call(this,b),delete b.features)};return{layers:new Set(n),listener:c,delegates:{[f]:g}}}}on(f,n,c){if(c===void 0)return super.on(f,n);Array.isArray(n)||(n=[n]);const g=this._createDelegatedListener(f,n,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(g);for(const b in g.delegates)this.on(b,g.delegates[b]);return this}once(f,n,c){if(c===void 0)return super.once(f,n);Array.isArray(n)||(n=[n]);const g=this._createDelegatedListener(f,n,c);for(const b in g.delegates)this.once(b,g.delegates[b]);return this}off(f,n,c){if(c===void 0)return super.off(f,n);n=new Set(Array.isArray(n)?n:[n]);const g=(E,L)=>{if(E.size!==L.size)return!1;for(const D of E)if(!L.has(D))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[f]:void 0;return b&&(E=>{for(let L=0;L<E.length;L++){const D=E[L];if(D.listener===c&&g(D.layers,n)){for(const F in D.delegates)this.off(F,D.delegates[F]);return E.splice(L,1),this}}})(b),this}queryRenderedFeatures(f,n){return this.style?(n!==void 0||f===void 0||f instanceof s.Point||Array.isArray(f)||(n=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(f,n){return this.style.querySourceFeatures(f,n)}isPointOnSurface(f){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&s.warnOnce(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(f))}setStyle(f,n){return(n=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(f,n))}_getUIString(f){const n=this._locale[f];if(n==null)throw new Error(`Missing UI string '${f}'`);return n}_updateStyle(f,n){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Wo(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Wo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,n){if(typeof f=="string"){const c=this._requestManager.normalizeStyleURL(f),g=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(g,(b,E)=>{b?this.fire(new s.ErrorEvent(b)):E&&this._updateDiff(E,n)})}else typeof f=="object"&&this._updateDiff(f,n)}_updateDiff(f,n){try{this.style.setState(f)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(f,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(f,n){return this._lazyInitEmptyStyle(),this.style.addSource(f,n),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const n in f){const c=f[n]._tiles;for(const g in c){const b=c[g];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}addSourceType(f,n,c){this._lazyInitEmptyStyle(),this.style.addSourceType(f,n,c)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,n,{pixelRatio:c=1,sdf:g=!1,stretchX:b,stretchY:E,content:L}={}){if(this._lazyInitEmptyStyle(),n instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&n instanceof s.window.ImageBitmap){const{width:D,height:F,data:W}=s.exported.getImageData(n);this.style.addImage(f,{data:new s.RGBAImage({width:D,height:F},W),pixelRatio:c,stretchX:b,stretchY:E,content:L,sdf:g,version:0})}else if(n.width===void 0||n.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:F}=n,W=n;this.style.addImage(f,{data:new s.RGBAImage({width:D,height:F},new Uint8Array(W.data)),pixelRatio:c,stretchX:b,stretchY:E,content:L,sdf:g,version:0,userImage:W}),W.onAdd&&W.onAdd(this,f)}}updateImage(f,n){const c=this.style.getImage(f);if(!c)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=n instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&n instanceof s.window.ImageBitmap?s.exported.getImageData(n):n,{width:b,height:E}=g;b!==void 0&&E!==void 0?b===c.data.width&&E===c.data.height?(c.data.replace(g.data,!(n instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&n instanceof s.window.ImageBitmap)),this.style.updateImage(f,c)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${b}, ${E})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,n){s.getImage(this._requestManager.transformRequest(f,s.ResourceType.Image),(c,g)=>{n(c,g instanceof s.window.HTMLImageElement?s.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(f,n){return this._lazyInitEmptyStyle(),this.style.addLayer(f,n),this._update(!0)}moveLayer(f,n){return this.style.moveLayer(f,n),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,n,c){return this.style.setLayerZoomRange(f,n,c),this._update(!0)}setFilter(f,n,c={}){return this.style.setFilter(f,n,c),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,n,c,g={}){return this.style.setPaintProperty(f,n,c,g),this._update(!0)}getPaintProperty(f,n){return this.style.getPaintProperty(f,n)}setLayoutProperty(f,n,c,g={}){return this.style.setLayoutProperty(f,n,c,g),this._update(!0)}getLayoutProperty(f,n){return this.style.getLayoutProperty(f,n)}setLight(f,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,n),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(f),this.transform):0}setFeatureState(f,n){return this.style.setFeatureState(f,n),this._update()}removeFeatureState(f,n){return this.style.removeFeatureState(f,n),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let c,g,b,E=this._container;for(;E&&(!g||!b);){const L=s.window.getComputedStyle(E).transform;L&&L!=="none"&&(c=L.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(g=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(b=c[3])),E=E.parentElement}this._containerWidth=g?Math.abs(f/g):f,this._containerHeight=b?Math.abs(n/b):n}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=ue("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=ue("div","mapboxgl-canvas-container",f);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=ue("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=ue("div","mapboxgl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{g[b]=ue("div",`mapboxgl-ctrl-${b}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,n){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(f),this._canvas.height=c*Math.ceil(n),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${n}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const n=this._markers.indexOf(f);n!==-1&&this._markers.splice(n,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const n=this._popups.indexOf(f);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const f=s.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._useWebGL2&&this._canvas.getContext("webgl2",f),c=n||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);c?(this._useWebGL2&&!n&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(c,!0),this.painter=new ic(c,this.transform,!!n),this.on("data",g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(c)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let n;const c=this.painter.context.extTimerQuery,g=s.exported.now();if(this.listens("gpu-timing-frame")&&(n=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,F=this.transform.pitch,W=s.exported.now(),H=new s.EvaluationParameters(D,{now:W,fadeDuration:b,pitch:F,transition:this.style.getTransition()});this.style.update(H)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const D=s.exported.now()-g;c.endQueryEXT(c.TIME_ELAPSED_EXT,n),setTimeout(()=>{const F=c.getQueryObjectEXT(n,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(n),this.fire(new s.Event("gpu-timing-frame",{cpuTime:D,gpuTime:F})),s.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:F}})},50)}if(this.listens("gpu-timing-layer")){const D=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(D);this.fire(new s.Event("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const D=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(D);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:F}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(L||this._repaint)this.triggerRepaint();else{const D=!this.isMoving()&&this.loaded();if(D&&(E=this._updateAverageElevation(g,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),D&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const n of this._markers)f&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!f||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(f,n=!1){const c=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((n||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const g=this.transform.averageElevation;let b=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=f;const L=Math.abs(g-b);if(L>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(b),c(b);this._averageElevation.easeTo(b,f,300)}else if(L>1e-4)return this._averageElevation.jumpTo(b),c(b)}return!!this._averageElevation.isEasing(f)&&c(this._averageElevation.getValue(f))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===s.AUTH_ERR_MSG||f.status===401)){const n=this.painter.context.gl;s.storeAuthState(n,!1),this._logoControl instanceof Id&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const c=this.painter.context.gl,g=c.createFramebuffer();function b(E){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,E,0);const L=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,L),L}return c.bindFramebuffer(c.FRAMEBUFFER,g),this._canvasPixelComparison(b(f),n.canvasCopies.map(b),n.timeStamps)}_canvasPixelComparison(f,n,c){let g=c[1]-c[0];const b=f.length/4;for(let E=0;E<n.length;E++){const L=n[E];let D=0;for(let F=0;F<L.length;F+=4)L[F]===f[F]&&L[F+1]===f[F+1]&&L[F+2]===f[F+2]&&L[F+3]===f[F+3]&&(D+=1);g+=(c[E+2]-c[E+1])*(1-D/b)}return g}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=s.exported.frame(n=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(n)}))}_preloadTiles(f){const n=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(n,(c,g)=>c._preloadTiles(f,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,n){s.setCacheLimits(f,n)}get version(){return s.version}},NavigationControl:class{constructor(f){this.options=s.extend({},Dd,f),this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),ue("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),ue("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:n}):c.resetNorth({},{originalEvent:n}))}),this._compassIcon=ue("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const n=f.getZoom(),c=n===f.getMaxZoom(),g=n===f.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Lm(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,n){const c=ue("button",f,this._container);return c.type="button",c.addEventListener("click",n),c}_setButtonTitle(f,n){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${n}`);f.setAttribute("aria-label",c),f.firstElementChild&&f.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(f){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},oh,f),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=oc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const n=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,f(c)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>n(c.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(f){const n=this._map.getMaxBounds(),c=f.coords;return!!n&&(c.longitude<n.getWest()||c.longitude>n.getEast()||c.latitude<n.getSouth()||c.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",f)),this._finish()}}_updateCamera(f){const n=new s.LngLat(f.coords.longitude,f.coords.latitude),c=f.coords.accuracy,g=this._map.getBearing(),b=s.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(c),b,{geolocateSource:!0})}_updateMarker(f){if(f){const n=new s.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,n=s.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,c=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=ue("button","mapboxgl-ctrl-geolocate",this._container),ue("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ue("div","mapboxgl-user-location"),this._dotElement.appendChild(ue("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ue("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new oi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ue("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new oi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:_i,ScaleControl:class{constructor(f){this.options=s.extend({},cu,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,n=this._map,c=n._containerHeight/2,g=n._containerWidth/2-f/2,b=n.unproject([g,c]),E=n.unproject([g+f,c]),L=b.distanceTo(E);if(this.options.unit==="imperial"){const D=3.2808*L;D>5280?this._setScale(f,D/5280,"mile"):this._setScale(f,D,"foot")}else this.options.unit==="nautical"?this._setScale(f,L/1852,"nautical-mile"):L>=1e3?this._setScale(f,L/1e3,"kilometer"):this._setScale(f,L,"meter")}_setScale(f,n,c){this._map._requestDomTask(()=>{const g=function(E){const L=Math.pow(10,`${Math.floor(E)}`.length-1);let D=E/L;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(F){const W=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*W)/W}(D),L*D}(n),b=g/n;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(g):`${g}&nbsp;${Od[c]}`,this._container.style.width=f*b+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof s.window.HTMLElement?this._container=f.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=ue("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ue("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(f){super(),this.options=s.extend(Object.create(Pd),f),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=s.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(s.window.document.createTextNode(f))}setHTML(f){const n=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let g;for(c.innerHTML=f;g=c.firstChild,g;)n.appendChild(g);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=ue("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(f),this.options.closeButton){const c=this._closeButton=ue("button","mapboxgl-popup-close-button",n);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let n;return this._classList.delete(f)?n=!1:(this._classList.add(f),n=!0),this._updateClassList(),n}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const n=this._map,c=this._container,g=this._pos;if(!n||!c||!g)return"bottom";const b=c.offsetWidth,E=c.offsetHeight,L=g.x<b/2,D=g.x>n.transform.width-b/2;if(g.y+f<E)return L?"top-left":D?"top-right":"top";if(g.y>n.transform.height-E){if(L)return"bottom-left";if(D)return"bottom-right"}return L?"left":D?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),f.className=n.join(" ")}_update(f){const n=this._map,c=this._content;if(!n||!this._lngLat&&!this._trackPointer||!c)return;let g=this._container;if(g||(g=this._container=ue("div","mapboxgl-popup",n.getContainer()),this._tip=ue("div","mapboxgl-popup-tip",g),g.appendChild(c)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=vl(this._lngLat,this._pos,n.transform)),!this._trackPointer||f){const b=this._pos=this._trackPointer&&f?f:n.project(this._lngLat),E=lu(this.options.offset),L=this._anchor=this._getAnchor(E.y),D=lu(this.options.offset,L),F=b.add(D).round();n._requestDomTask(()=>{this._container&&L&&(this._container.style.transform=`${qa[L]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&n._showingGlobe()){const b=s.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Pm);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:oi,Style:Wo,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Hf,Evented:s.Evented,config:s.config,prewarm:function(){En().acquire(No)},clearPrewarmedResources:function(){const f=us;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(No),us=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(f){s.config.ACCESS_TOKEN=f},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(f){s.config.API_URL=f},get workerCount(){return $n.workerCount},set workerCount(f){$n.workerCount=f},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){s.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){s.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return uc});var V=C;return V})})(qA);var Z3=qA.exports;const $y=HA(Z3),Jb=dA("map",{state:()=>({map:null,boundaries:{},visibleLayer:null,basemapStyle:"light"}),actions:{setMap(t){this.map=t},setBoundaries(t){this.boundaries={country:t.country||{type:"FeatureCollection",features:[]},watershed:t.watershed||{type:"FeatureCollection",features:[]},commune:t.commune||{type:"FeatureCollection",features:[]}}},setBasemapStyle(t){this.basemapStyle=t},highlightFeature(t,l){var s,$;if(!this.map||!t)return;const d={country:"countries-outline",watershed:"watersheds-outline",commune:"communes-outline"},_=d[l],T=Object.values(d);for(const Z of T)(s=this.map)!=null&&s.getLayer(Z)&&(this.map.setLayoutProperty(Z,"visibility","none"),this.map.setPaintProperty(Z,"line-color","rgba(0,0,0,0)"));($=this.map)!=null&&$.getLayer(_)&&(this.map.setLayoutProperty(_,"visibility","visible"),this.map.setPaintProperty(_,"line-color","#000000"),this.map.setPaintProperty(_,"line-width",4)),this.visibleLayer=l;const C=t.geometry.coordinates.flat(1/0),P=C.filter((Z,J)=>J%2===0),V=C.filter((Z,J)=>J%2!==0);if(P.length&&V.length){const Z=new $y.LngLatBounds([Math.min(...P),Math.min(...V)],[Math.max(...P),Math.max(...V)]);this.map.fitBounds(Z,{padding:40})}},resetView(){if(!this.map)return;this.map.flyTo({center:[1.8,11.5],zoom:4.2,essential:!0});const t=["countries-outline","watersheds-outline","communes-outline"];for(const l of t)this.map.getLayer(l)&&this.map.setLayoutProperty(l,"visibility","none");this.visibleLayer=null}}}),Y3="/projects/soil_values/assets/LC_MAPLAYERS-SEb8qRKn.png",K3="/projects/soil_values/assets/LC_BIOPHYSICAL_HEALTH_2-HHlmRK23.png",J3="/projects/soil_values/assets/LC_BIOPHYSICAL_HEALTH-BGgneVEh.png",Q3="/projects/soil_values/assets/LC_LANDCOVER-BTufKOfp.png",eB="/projects/soil_values/assets/LC_LANDCOVER_%202-Dfxvtyu_.png",tB={},iB={class:"biophysical-panel"},rB={class:"panel-title"},nB={class:"panel-description"},sB={class:"image-section"},oB={class:"chart-title"},aB={class:"image-section"},lB={class:"chart-title"},cB={class:"image-section"},hB={class:"chart-title"},uB={class:"image-section"},dB={class:"chart-title"},fB={class:"image-section"},pB={class:"chart-title"};function mB(t,l){return gi(),ki("div",iB,[ot("h2",rB,pi(t.$t("biophysical.title")),1),ot("p",nB,pi(t.$t("biophysical.description")),1),ot("section",sB,[ot("h3",oB,pi(t.$t("biophysical.mapLayers")),1),l[0]||(l[0]=ot("img",{src:Y3,alt:"Map Layers",class:"chart-image"},null,-1))]),ot("section",aB,[ot("h3",lB,pi(t.$t("biophysical.evi")),1),l[1]||(l[1]=ot("img",{src:K3,alt:"EVI Trend",class:"chart-image"},null,-1))]),ot("section",cB,[ot("h3",hB,pi(t.$t("biophysical.health")),1),l[2]||(l[2]=ot("img",{src:J3,alt:"Biophysical Donut",class:"chart-image"},null,-1))]),ot("section",uB,[ot("h3",dB,pi(t.$t("biophysical.baseline")),1),l[3]||(l[3]=ot("img",{src:Q3,alt:"Baseline Chart",class:"chart-image"},null,-1))]),ot("section",fB,[ot("h3",pB,pi(t.$t("biophysical.evaluation")),1),l[4]||(l[4]=ot("img",{src:eB,alt:"Evaluation Chart",class:"chart-image"},null,-1))])])}const gB=ua(tB,[["render",mB],["__scopeId","data-v-cac63d4d"]]),_B={class:"fertility-panel"},yB={class:"panel-title"},xB={class:"panel-description"},vB={class:"indicator-title"},bB={class:"baseline-current"},wB={class:"baseline"},TB={class:"current"},EB={class:"progress-bar"},SB=On({__name:"FertilityMonitoringPanel",setup(t){const l=[{name:"organicMatter",baseline:"2.4%",current:"2.8%",change:"positive",changeClass:"change-positive",progress:65},{name:"nutrientLevels",baseline:"Medium",current:"High",change:"positive",changeClass:"change-positive",progress:75},{name:"erosionRisk",baseline:"Moderate",current:"No Change",change:"neutral",changeClass:"change-neutral",progress:50},{name:"waterRetention",baseline:"Low",current:"Moderate",change:"positive",changeClass:"change-positive",progress:40}];return(d,_)=>(gi(),ki("div",_B,[ot("h2",yB,pi(d.$t("fertility.title")),1),ot("p",xB,pi(d.$t("fertility.description")),1),(gi(),ki(jr,null,za(l,T=>ot("div",{key:T.name,class:"indicator-card"},[ot("div",vB,[ot("strong",null,pi(d.$t(`fertility.indicators.${T.name}`)),1),ot("span",{class:Us(T.changeClass)},pi(d.$t(`fertility.changes.${T.change}`)),3)]),ot("div",bB,[ot("span",wB,[Vs(pi(d.$t("fertility.baseline"))+": ",1),ot("strong",null,pi(T.baseline),1)]),ot("span",TB,[Vs(pi(d.$t("fertility.current"))+": ",1),ot("strong",null,pi(T.current),1)])]),ot("div",EB,[ot("div",{class:"progress",style:Rc({width:T.progress+"%"})},null,4)])])),64))]))}}),CB=ua(SB,[["__scopeId","data-v-0f70ca8a"]]),AB={class:"toolbox-container"},MB={class:"toolbox-header"},IB={class:"header-text"},kB={class:"toolbox-content"},PB=["onClick","title"],LB={class:"tool-icon"},DB={class:"icon-label"},OB={key:0,class:"floating-panel"},RB={key:2},zB={class:"text-lg font-semibold mb-2"},BB={class:"text-gray-700 text-sm leading-relaxed whitespace-pre-line"},FB=On({__name:"Toolbox",setup(t){const l=Ui(null),d=Jb(),_=[{id:"landcover",emoji:""},{id:"crop",emoji:""},{id:"degradation",emoji:""},{id:"drought",emoji:""},{id:"fertility",emoji:""},{id:"risk",emoji:""}];function T(P){const V=l.value===P;l.value=V?null:P;const s=d.map;if(!s)return;const $=l.value==="landcover";s.getLayer("komadougou-highlight")&&s.setLayoutProperty("komadougou-highlight","visibility",$?"visible":"none"),P==="landcover"&&!V&&s.flyTo({center:[3.3,14.5],zoom:7,speed:1.2,curve:1.3,essential:!0})}function C(P,V){const[s,...$]=P.split(" ");return V===0?s:$.join(" ")||"Monitoring"}return(P,V)=>(gi(),ki("div",AB,[ot("div",MB,[ot("span",IB,pi(P.$t("toolbox.title")),1)]),ot("div",kB,[(gi(),ki(jr,null,za(_,s=>ot("div",{key:s.id,class:"tool-item",onClick:$=>T(s.id),title:P.$t(`toolbox.tools.${s.id}.name`)},[ot("div",LB,pi(s.emoji),1),ot("div",DB,[ot("strong",null,pi(C(P.$t(`toolbox.tools.${s.id}.name`),0)),1),V[0]||(V[0]=ot("br",null,null,-1)),ot("span",null,pi(C(P.$t(`toolbox.tools.${s.id}.name`),1)),1)]),fr(zb,{name:"slide"},{default:Ns(()=>[l.value===s.id?(gi(),ki("div",OB,[s.id==="landcover"?(gi(),Fo(gB,{key:0})):s.id==="fertility"?(gi(),Fo(CB,{key:1})):(gi(),ki("div",RB,[ot("h3",zB,pi(P.$t(`toolbox.tools.${s.id}.name`)),1),ot("p",BB,pi(P.$t(`toolbox.tools.${s.id}.description`)),1)]))])):wn("",!0)]),_:2},1024)],8,PB)),64))])]))}}),NB=ua(FB,[["__scopeId","data-v-7bebdeb3"]]),UB=On({__name:"MapboxMap",setup(t){const l=Ui(null),d=Jb(),_="pk.eyJ1Ijoib3N1bWFpIiwiYSI6ImNtOThheGt3bDAxMDYyanM1cDVoZG5jaGIifQ.rhfXn8CCj3FZ-OTeH-z-Ag",T="http://127.0.0.1:8000/api/v1",C=location.hostname.includes("github.io");let P;ca(()=>d.basemapStyle,async ne=>{const ue={light:"mapbox://styles/mapbox/light-v10",satellite:"mapbox://styles/mapbox/satellite-streets-v12",streets:"mapbox://styles/mapbox/streets-v12",dark:"mapbox://styles/mapbox/dark-v10"},we=ue[ne]||ue.light;P.setStyle(we),P.once("styledata",async()=>{V(),await $()})});function V(){(P.getStyle().layers||[]).forEach(ue=>{if(["hillshade","terrain","3d-buildings","building"].some(we=>ue.id.includes(we)))try{P.removeLayer(ue.id)}catch{}});try{P.setTerrain(null)}catch{}}async function s(){let ne=!1;try{const we=await fetch(`${T}/config`).then(Me=>Me.json());ne=(we==null?void 0:we.DEMO_MODE)===!0}catch(we){console.warn("Could not fetch config, defaulting to LIVE_MODE",we)}function ue(we,Me){return we?((Array.isArray(we)?we:we.features)||[]).map(Ze=>({...Ze,properties:{...Ze.properties,layer:Me}})):[]}if(C){const[we,Me,Ye]=await Promise.all([fetch("/projects/soil_values/data/countries.geojson").then(Ze=>Ze.json()),fetch("/projects/soil_values/data/intervention_watersheds.geojson").then(Ze=>Ze.json()),fetch("/projects/soil_values/data/communes.geojson").then(Ze=>Ze.json())]);return[...ue(we,"country"),...ue(Me,"watershed"),...ue(Ye,"commune")]}else if(ne){const{countries:we,watersheds:Me,communes:Ye}=await fetch(`${T}/synthetic/boundaries`).then(Ze=>Ze.json());return[...ue(we,"country"),...ue(Me,"watershed"),...ue(Ye,"commune")]}else{const{countries:we,watersheds:Me,communes:Ye}=await fetch(`${T}/boundaries/all`).then(Ze=>Ze.json());return[...ue(we,"country"),...ue(Me,"watershed"),...ue(Ye,"commune")]}}async function $(){const ne=await s();window._allBoundaryFeatures=ne||[]["communes-outline"].forEach(ue=>{P.getLayer(ue)&&P.removeLayer(ue)}),P.getSource("boundaries")&&P.removeSource("boundaries"),ne.length>0&&(P.addSource("boundaries",{type:"geojson",data:{type:"FeatureCollection",features:ne.filter(we=>we.properties.layer==="country")}}),P.addLayer({id:"selected-boundary-highlight",type:"line",source:"boundaries",filter:["==",["get","id"],""],paint:{"line-color":"#000","line-width":5,"line-opacity":.8}}),[{id:"countries-outline",key:"country",width:2.5},{id:"watersheds-outline",key:"watershed",width:1.5},{id:"communes-outline",key:"commune",width:.8}].forEach(({id:we,key:Me,width:Ye})=>{P.addLayer({id:we,type:"line",source:"boundaries",filter:["==",["get","layer"],Me],paint:{"line-color":"#000","line-width":Ye}})})),Z()}function Z(){const ne=`${T}/proxy_geoserver/komadogou-landcover/{z}/{x}/{y}.png`,ue=`${T}/proxy_geoserver/komadogou-river-streams/{z}/{x}/{y}.png`;["komadogou-landcover","komadogou-river-streams"].forEach(we=>{P.getLayer(we)&&P.removeLayer(we),P.getSource(we)&&P.removeSource(we)}),P.addSource("komadogou-landcover",{type:"raster",tiles:[ne],tileSize:256}),P.addLayer({id:"komadogou-landcover",type:"raster",source:"komadogou-landcover",paint:{"raster-opacity":1}}),P.addSource("komadogou-river-streams",{type:"raster",tiles:[ue],tileSize:256}),P.addLayer({id:"komadogou-river-streams",type:"raster",source:"komadogou-river-streams",paint:{"raster-opacity":.2}})}Dh(async()=>{P=new $y.Map({container:l.value,style:"mapbox://styles/mapbox/light-v10",center:[1,12],zoom:4.2,accessToken:_}),d.setMap(P),P.addControl(new $y.NavigationControl,"top-right"),P.on("load",async()=>{V(),await $()})});function J(ne,ue){const Me=(window._allBoundaryFeatures||[]).find(ae=>ae.properties.id===ne&&ae.properties.layer===ue);if(!Me)return;P.getSource("boundaries").setData({type:"FeatureCollection",features:[Me]}),P.getLayer("selected-boundary-highlight")&&P.setFilter("selected-boundary-highlight",["==",["get","id"],ne]);const Ze=new $y.LngLatBounds;function Fe(ae){ae.type==="Polygon"?ae.coordinates.forEach(ge=>ge.forEach(Oe=>Ze.extend(Oe))):ae.type==="MultiPolygon"&&ae.coordinates.forEach(ge=>ge.forEach(Oe=>Oe.forEach(ze=>Ze.extend(ze))))}Fe(Me.geometry),Ze.isEmpty()||P.fitBounds(Ze,{padding:40,duration:800})}return window.highlightBoundaryById=J,(ne,ue)=>(gi(),ki("div",{ref_key:"mapContainer",ref:l,class:"mapbox-map w-full h-full"},null,512))}}),VB=ua(UB,[["__scopeId","data-v-51461c27"]]),jB={class:"map-control-wrapper"},$B={class:"dropdown-group"},GB={key:0,class:"map-control-panel"},WB={class:"panel-header"},HB={class:"panel-title"},qB={class:"dropdown-group"},XB={class:"dropdown-label"},ZB={disabled:"",value:""},YB=["value"],KB={key:0,class:"spinner"},JB={key:0,class:"dropdown-group"},QB={class:"dropdown-label"},eF={disabled:"",value:""},tF=["value"],iF={key:0,class:"spinner"},rF={key:1,class:"dropdown-group"},nF={class:"dropdown-label"},sF={disabled:"",value:""},oF=["value"],aF={key:0,class:"spinner"},lF={key:2,class:"dropdown-group"},cF=["value"],hF=On({__name:"MapControlPanel",setup(t){const{t:l}=f_(),d=Jb(),_=ym(),T=Ui(!0),C=Ui(null),P=Ui(null),V=Ui(null),s=Ui(""),$=Ui(!1),Z=Ui(!1),J=Ui(!1),ne=Ui([]),ue=Ui([]),we=Ui([]),Me=Ui([]);async function Ye(){try{const xt=location.hostname.includes("github.io");if($.value=!0,xt)console.info("GitHub Pages mode  using static data"),await Ze();else try{const Tt=await fetch("http://127.0.0.1:8000/api/v1/boundaries/all");if(!Tt.ok)throw new Error(`Backend returned ${Tt.status}`);const vt=await Tt.json();ne.value=Fe(vt.countries,"ADM0_FR","country"),ue.value=Fe(vt.watersheds,"layer","watershed"),we.value=Fe(vt.communes,"ADM3_FR","commune")}catch(Tt){console.warn("Backend boundaries failed  falling back to static data",Tt),await Ze()}d.setBoundaries({countries:ne.value,watersheds:ue.value,communes:we.value}),window._allBoundaryFeatures=[...ne.value,...ue.value,...we.value]}catch(xt){console.error("Failed to load boundaries at all:",xt)}finally{$.value=!1}}async function Ze(){const[xt,Tt,vt]=await Promise.all([fetch("/projects/soil_values/data/countries.geojson").then(ai=>ai.json()),fetch("/projects/soil_values/data/intervention_watersheds.geojson").then(ai=>ai.json()),fetch("/projects/soil_values/data/communes.geojson").then(ai=>ai.json())]);ne.value=Fe(xt,"ADM0_FR","country"),ue.value=Fe(Tt,"layer","watershed"),we.value=Fe(vt,"ADM3_FR","commune")}function Fe(xt,Tt,vt){return xt?((Array.isArray(xt)?xt:xt.features)||[]).map(yi=>{var xi,Pr;return{...yi,properties:{...yi.properties,name:((xi=yi.properties)==null?void 0:xi[Tt])||((Pr=yi.properties)==null?void 0:Pr.name),layer:vt}}}):[]}async function ae(){var xt;try{const Tt=await dn.get("http://127.0.0.1:8000/api/v1/admin/layers",{headers:{Authorization:`Bearer ${_.token}`}});(xt=Tt.data.coverageStores)!=null&&xt.coverageStore&&(Me.value=Tt.data.coverageStores.coverageStore.map(vt=>vt.name))}catch(Tt){console.warn("Failed to load rasters  hiding dropdown",Tt),Me.value=[]}}function ge(){!s.value||!window.map||(window.map.getSource(s.value)&&(window.map.removeLayer(s.value),window.map.removeSource(s.value)),window.map.addSource(s.value,{type:"raster",tiles:[`undefined?service=WMS&version=1.1.0&request=GetMap&layers=soil_values:${s.value}&styles=&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=image/png`],tileSize:256}),window.map.addLayer({id:s.value,type:"raster",source:s.value,paint:{"raster-opacity":.7}}))}function Oe(){wt()}Dh(()=>{Ye(),ae()}),ca(()=>C.value,()=>{P.value=null,V.value=null}),ca(()=>P.value,()=>{V.value=null});const ze=un(()=>{if(!C.value)return[];const xt=Ie(C.value);return ue.value.filter(Tt=>Je(Tt,xt))}),rt=un(()=>{if(!P.value)return[];const xt=Ie(P.value);return we.value.filter(Tt=>Je(Tt,xt))});function Ie(xt){const Tt=xt.geometry.coordinates.flat(1/0),vt=Tt.filter((yi,xi)=>xi%2===0),ai=Tt.filter((yi,xi)=>xi%2!==0);return[Math.min(...vt),Math.min(...ai),Math.max(...vt),Math.max(...ai)]}function Je(xt,[Tt,vt,ai,yi]){const[xi,Pr,tr,nr]=Ie(xt);return!(tr<Tt||xi>ai||nr<vt||Pr>yi)}function He(){var Tt,vt;Z.value=!0;const xt=(vt=(Tt=C.value)==null?void 0:Tt.properties)==null?void 0:vt.id;xt&&window.highlightBoundaryById(xt,"country"),setTimeout(()=>Z.value=!1,500)}function ti(){var Tt,vt;J.value=!0;const xt=(vt=(Tt=P.value)==null?void 0:Tt.properties)==null?void 0:vt.id;xt&&window.highlightBoundaryById(xt,"watershed"),setTimeout(()=>J.value=!1,500)}function bt(){var Tt,vt;const xt=(vt=(Tt=V.value)==null?void 0:Tt.properties)==null?void 0:vt.id;xt&&window.highlightBoundaryById(xt,"commune")}function wt(){C.value=null,P.value=null,V.value=null,s.value="",d.resetView()}return(xt,Tt)=>(gi(),ki("div",jB,[T.value?wn("",!0):(gi(),ki("button",{key:0,class:"reopen-button",onClick:Tt[0]||(Tt[0]=vt=>T.value=!0)}," Map Controls ")),ot("div",$B,[Tt[8]||(Tt[8]=ot("label",{class:"dropdown-label"},"Basemap",-1)),uo(ot("select",{"onUpdate:modelValue":Tt[1]||(Tt[1]=vt=>ns(d).basemapStyle=vt),onChange:Oe},Tt[7]||(Tt[7]=[ot("option",{value:"light"},"Light",-1),ot("option",{value:"streets"},"Streets",-1),ot("option",{value:"satellite"},"Satellite",-1),ot("option",{value:"dark"},"Dark",-1)]),544),[[Sh,ns(d).basemapStyle]])]),fr(zb,{name:"fade-slide"},{default:Ns(()=>[T.value?(gi(),ki("div",GB,[ot("div",WB,[ot("h3",HB,pi(ns(l)("mapControls.title")),1),ot("button",{class:"close-button",onClick:Tt[2]||(Tt[2]=vt=>T.value=!1)},"")]),ot("div",qB,[ot("label",XB,pi(ns(l)("mapControls.country")),1),uo(ot("select",{"onUpdate:modelValue":Tt[3]||(Tt[3]=vt=>C.value=vt),onChange:He},[ot("option",ZB,pi(ns(l)("mapControls.select")),1),(gi(!0),ki(jr,null,za(ne.value,vt=>(gi(),ki("option",{key:vt.properties.id,value:vt},pi(vt.properties.name),9,YB))),128))],544),[[Sh,C.value]]),$.value?(gi(),ki("span",KB,"")):wn("",!0)]),ze.value.length?(gi(),ki("div",JB,[ot("label",QB,pi(ns(l)("mapControls.watershed")),1),uo(ot("select",{"onUpdate:modelValue":Tt[4]||(Tt[4]=vt=>P.value=vt),onChange:ti},[ot("option",eF,pi(ns(l)("mapControls.select")),1),(gi(!0),ki(jr,null,za(ze.value,vt=>(gi(),ki("option",{key:vt.properties.id,value:vt},pi(vt.properties.name),9,tF))),128))],544),[[Sh,P.value]]),Z.value?(gi(),ki("span",iF,"")):wn("",!0)])):wn("",!0),rt.value.length?(gi(),ki("div",rF,[ot("label",nF,pi(ns(l)("mapControls.commune")),1),uo(ot("select",{"onUpdate:modelValue":Tt[5]||(Tt[5]=vt=>V.value=vt),onChange:bt},[ot("option",sF,pi(ns(l)("mapControls.select")),1),(gi(!0),ki(jr,null,za(rt.value,vt=>(gi(),ki("option",{key:vt.properties.id,value:vt},pi(vt.properties.name),9,oF))),128))],544),[[Sh,V.value]]),J.value?(gi(),ki("span",aF,"")):wn("",!0)])):wn("",!0),Me.value.length?(gi(),ki("div",lF,[Tt[10]||(Tt[10]=ot("label",{class:"dropdown-label"},"Raster Layer",-1)),uo(ot("select",{"onUpdate:modelValue":Tt[6]||(Tt[6]=vt=>s.value=vt),onChange:ge},[Tt[9]||(Tt[9]=ot("option",{disabled:"",value:""},"Select Raster",-1)),(gi(!0),ki(jr,null,za(Me.value,vt=>(gi(),ki("option",{key:vt,value:vt},pi(vt),9,cF))),128))],544),[[Sh,s.value]])])):wn("",!0),ot("button",{class:"reset-btn",onClick:wt},pi(ns(l)("mapControls.reset")),1)])):wn("",!0)]),_:1})]))}}),uF=ua(hF,[["__scopeId","data-v-e8dc8510"]]),dF={class:"legend-wrapper"},fF={key:1,class:"legend-container"},pF={class:"legend-header"},mF={class:"legend-title"},gF={class:"legend-list"},_F=On({__name:"MapLegend",props:{show:{type:Boolean}},emits:["close"],setup(t){const l=Ui(!0),d={water:"#2b83ba",forest:"#1a9850",cropland:"#d7191c",grassland:"#fdae61",shrubland:"#abdda4",wetland:"#66c2a5",bareland:"#ffffbf",urban:"#f46d43",boundary:"#000000"};return(_,T)=>(gi(),ki("div",dF,[l.value?(gi(),ki("div",fF,[ot("div",pF,[ot("h4",mF,pi(_.$t("legend.title")),1),ot("button",{class:"legend-close",onClick:T[1]||(T[1]=C=>l.value=!1)},"")]),ot("ul",gF,[(gi(),ki(jr,null,za(d,(C,P)=>ot("li",{key:P},[ot("span",{class:"legend-swatch",style:Rc({backgroundColor:C})},null,4),Vs(" "+pi(_.$t(`legend.labels.${P}`)),1)])),64))])])):(gi(),ki("button",{key:0,class:"legend-reopen",onClick:T[0]||(T[0]=C=>l.value=!0)}," Legend "))]))}}),yF=ua(_F,[["__scopeId","data-v-8141ab19"]]),xF={class:"dashboard-layout"},vF={class:"map-section"},bF={class:"map-container"},wF={class:"overlay-panels"},TF=On({__name:"MapView",setup(t){const l=Ui(!0),d=Ui(!0);return(_,T)=>(gi(),ki("div",xF,[ot("div",vF,[fr(NB),ot("div",bF,[fr(VB),ot("div",wF,[l.value?(gi(),Fo(uF,{key:0,onClose:T[0]||(T[0]=C=>l.value=!1)})):wn("",!0),fr(yF,{show:d.value,onClose:T[1]||(T[1]=C=>d.value=!1)},null,8,["show"])])])])]))}}),EF=ua(TF,[["__scopeId","data-v-7cb25c9c"]]),SF={class:"p-8 max-w-5xl mx-auto"},CF={class:"text-4xl font-bold text-indigo-800 mb-6"},AF={class:"text-gray-700 leading-relaxed whitespace-pre-line"},MF={__name:"MonitoringView",setup(t){return(l,d)=>(gi(),ki("div",SF,[ot("h1",CF,pi(l.$t("monitoring.title")),1),ot("p",AF,pi(l.$t("monitoring.description")),1)]))}},IF=ua(MF,[["__scopeId","data-v-533c53c9"]]),kF={class:"p-8 max-w-5xl mx-auto"},PF={class:"text-4xl font-bold text-green-800 mb-6"},LF={class:"text-gray-700 leading-relaxed whitespace-pre-line"},DF={__name:"CatalogView",setup(t){return(l,d)=>(gi(),ki("div",kF,[ot("h1",PF,pi(l.$t("catalog.title")),1),ot("p",LF,pi(l.$t("catalog.description")),1)]))}},OF=ua(DF,[["__scopeId","data-v-83e12bfa"]]),RF="/projects/soil_values/assets/hand_soil-1gZV898M.jpeg",zF="/projects/soil_values/assets/harvest-man-PU7mKcrC.jpg",BF="/projects/soil_values/assets/update-burkina-oEf6LrKK.jpg",FF="/projects/soil_values/assets/update-women-DMqvfeED.jpg",NF="/projects/soil_values/assets/update-dairy-D07hRLBv.jpg",UF={class:"about-container"},VF={class:"hero-section"},jF={class:"hero-text"},$F={class:"about-description"},GF={class:"outcomes-section"},WF={class:"partners-section"},HF={class:"note"},qF={class:"updates-section"},XF={class:"updates-grid"},ZF=["href"],YF=["src","alt"],KF={class:"update-info"},JF={class:"update-date"},QF={class:"update-title"},eN={__name:"AboutView",setup(t){const l=[{id:1,title:"ISFM Training in Burkina Faso: A Collaborative Approach",date:"News | April 2, 2025",image:BF,link:"https://ifdc.org/2025/04/02/isfm-training-in-burkina-faso-a-collaborative-approach-to-soil-fertility-and-land-restoration/"},{id:2,title:"Celebrating Women in Sustainable Agriculture",date:"Event Recap | March 26, 2025",image:FF,link:"https://ifdc.org/2025/03/26/celebrating-women-at-the-heart-of-sustainable-agriculture/"},{id:3,title:"Improving Nigerias Dairy Sector and Empowering Pastoralist Communities",date:"News | May 1, 2025",image:NF,link:"https://ifdc.org/2025/05/01/improving-nigerias-dairy-sector-and-empowering-pastoralist-communities/"}];return(d,_)=>(gi(),ki("div",UF,[ot("section",VF,[_[0]||(_[0]=ot("img",{src:RF,alt:"African Farmer",class:"hero-image"},null,-1)),ot("div",jF,[ot("h1",null,pi(d.$t("about.hero.title")),1),ot("p",null,pi(d.$t("about.hero.subtitle")),1)])]),ot("section",$F,[ot("p",null,[ot("strong",null,pi(d.$t("about.description.program")),1),Vs(" "+pi(d.$t("about.description.intro")),1)]),ot("p",null,pi(d.$t("about.description.impact")),1),ot("p",null,pi(d.$t("about.description.approach")),1)]),_[2]||(_[2]=ot("img",{src:zF,alt:"Harvesting Legumes",class:"mid-image"},null,-1)),ot("section",GF,[ot("h2",null,pi(d.$t("about.outcomes.title")),1),ot("ul",null,[ot("li",null,pi(d.$t("about.outcomes.item1")),1),ot("li",null,pi(d.$t("about.outcomes.item2")),1),ot("li",null,pi(d.$t("about.outcomes.item3")),1),ot("li",null,pi(d.$t("about.outcomes.item4")),1)])]),ot("section",WF,[ot("h2",null,pi(d.$t("about.partners.title")),1),ot("p",null,pi(d.$t("about.partners.description1")),1),ot("p",HF,pi(d.$t("about.partners.note")),1),_[1]||(_[1]=Zg('<div class="partner-logos" data-v-7d9b0679><div class="logo-row" data-v-7d9b0679><a href="https://www.government.nl/ministries/ministry-of-foreign-affairs" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+Nb+'" alt="DGIS" class="logo-lg" data-v-7d9b0679></a></div><div class="logo-row" data-v-7d9b0679><a href="https://ifdc.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+BA+'" alt="IFDC" class="logo-md" data-v-7d9b0679></a><a href="https://snv.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+NA+'" alt="SNV" class="logo-md" data-v-7d9b0679></a><a href="https://wur.nl" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+FA+'" alt="WUR" class="logo-md" data-v-7d9b0679></a></div><div class="logo-row" data-v-7d9b0679><a href="https://agra.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+UA+'" alt="AGRA" data-v-7d9b0679></a><a href="https://www.iita.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+VA+'" alt="IITA" data-v-7d9b0679></a><a href="https://www.iwmi.cgiar.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+jA+'" alt="IWMI" data-v-7d9b0679></a><a href="https://www.isric.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+$A+'" alt="ISRIC" data-v-7d9b0679></a><a href="https://www.cifor-icraf.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+GA+'" alt="CIFOR-ICRAF" data-v-7d9b0679></a></div></div>',1))]),ot("section",qF,[ot("h2",null,pi(d.$t("about.updates.title")),1),ot("div",XF,[(gi(),ki(jr,null,za(l,T=>ot("a",{key:T.id,href:T.link,target:"_blank",class:"update-card"},[ot("img",{src:T.image,alt:T.title},null,8,YF),ot("div",KF,[ot("p",JF,pi(T.date),1),ot("h3",QF,pi(T.title),1)])],8,ZF)),64))])])]))}},tN=ua(eN,[["__scopeId","data-v-7d9b0679"]]),iN={class:"login-page"},rN={class:"hero"},nN={class:"hero-overlay"},sN={class:"hero-title"},oN={class:"hero-subtitle"},aN={class:"form-section"},lN={class:"form-card"},cN=["disabled"],hN={key:0,class:"error"},uN=On({__name:"LoginView",setup(t){const l=Ui(""),d=Ui(""),_=Ui(!1),T=Ui(""),C=AC(),P=ym(),V=async()=>{if(_.value=!0,T.value="",await P.login(l.value,d.value)){const $=PN(C);C.push($)}else T.value="Invalid email or password";_.value=!1};return(s,$)=>(gi(),ki("div",iN,[ot("section",rN,[ot("div",nN,[ot("h1",sN,pi(s.$t("nav.login")),1),ot("p",oN,pi(s.$t("login.subtitle")||"Access your account to manage and upload data"),1)])]),ot("section",aN,[ot("div",lN,[$[2]||($[2]=ot("h2",{class:"form-title"},"Sign In",-1)),ot("form",{onSubmit:Yg(V,["prevent"]),class:"login-form"},[uo(ot("input",{"onUpdate:modelValue":$[0]||($[0]=Z=>l.value=Z),type:"email",placeholder:"Email",required:"",class:"form-input"},null,512),[[il,l.value]]),uo(ot("input",{"onUpdate:modelValue":$[1]||($[1]=Z=>d.value=Z),type:"password",placeholder:"Password",required:"",class:"form-input"},null,512),[[il,d.value]]),ot("button",{type:"submit",disabled:_.value,class:"form-button"},pi(_.value?"Logging in...":"Login"),9,cN)],32),T.value?(gi(),ki("p",hN,pi(T.value),1)):wn("",!0)])])]))}}),dN=ua(uN,[["__scopeId","data-v-4e08ff3f"]]),fN={class:"admin-page"},pN={class:"content-section"},mN={class:"content-card"},gN={class:"tabs"},_N={key:0,class:"tab-content"},yN={key:0,class:"progress-container"},xN=["disabled"],vN={key:1,class:"layers-list"},bN={key:1,class:"tab-content"},wN={key:2,class:"tab-content"},TN=["disabled"],EN=["disabled"],SN={key:1,class:"count-list"},CN={key:2,class:"output"},AN={key:3,class:"tab-content"},MN=On({__name:"AdminPanel",setup(t){const l=Ui("upload"),d=ym(),_=Ui(""),T=Ui(""),C=Ui(""),P=Ui(""),V=Ui(null),s=Ui(""),$=Ui(!1),Z=Ui(!1),J=Ui(0),ne=Ui([]),ue=Ui(""),we=Ui(""),Me=Ui(""),Ye=Ui(""),Ze=Ui(!1),Fe=Ui(!1),ae=Ui(""),ge=Ui(!1),Oe=Ui({}),ze=Ui(""),rt=wt=>{var Tt;const xt=wt.target;(Tt=xt.files)!=null&&Tt.length&&(V.value=xt.files[0])},Ie=async()=>{try{const wt=await dn.get("http://127.0.0.1:8000/api/v1/admin/layers",{headers:{Authorization:`Bearer ${d.token}`}});ne.value=wt.data.coverageStores.coverageStore}catch(wt){console.error("Error fetching layers:",wt)}},Je=async()=>{var xt,Tt;if(!V.value)return;const wt=new FormData;wt.append("file",V.value),wt.append("name",_.value),wt.append("category",T.value),wt.append("year",C.value),wt.append("description",P.value),Z.value=!0,J.value=0,s.value="";try{const vt=await dn.post("http://127.0.0.1:8000/api/v1/admin/upload-raster",wt,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${d.token}`},onUploadProgress:ai=>{ai.total&&(J.value=Math.round(ai.loaded/ai.total*100))}});s.value=`Raster uploaded: ${vt.data.name}`,$.value=!0,_.value=T.value=C.value=P.value="",V.value=null,await Ie()}catch(vt){s.value=((Tt=(xt=vt.response)==null?void 0:xt.data)==null?void 0:Tt.detail)||"Upload failed",$.value=!1}finally{Z.value=!1}},He=async()=>{var wt,xt;try{const Tt=await dn.post("http://127.0.0.1:8000/api/v1/admin/create-user",{email:ue.value,password:we.value,role:Me.value},{headers:{Authorization:`Bearer ${d.token}`}});Ye.value=Tt.data.message,Ze.value=!0,ue.value=we.value=Me.value=""}catch(Tt){Ye.value=((xt=(wt=Tt.response)==null?void 0:wt.data)==null?void 0:xt.detail)||"Error creating user",Ze.value=!1}},ti=async()=>{var wt,xt;if(confirm("This will regenerate all synthetic data and swap views. Continue?")){Fe.value=!0,ae.value="",Oe.value={},ze.value="";try{const Tt=await dn.post("http://127.0.0.1:8000/api/v1/admin/synthetic/generate",{},{headers:{Authorization:`Bearer ${d.token}`}});ae.value=Tt.data.message,ge.value=!0,ze.value=Tt.data.output,Oe.value=Tt.data.counts||{},await Ie()}catch(Tt){ae.value=((xt=(wt=Tt.response)==null?void 0:wt.data)==null?void 0:xt.detail)||"Error generating synthetic data",ge.value=!1}finally{Fe.value=!1}}},bt=async()=>{var wt,xt;if(confirm("Swap views back to REAL data?")){Fe.value=!0,ae.value="",ze.value="";try{const Tt=await dn.post("http://127.0.0.1:8000/api/v1/admin/synthetic/swap?mode=real",{},{headers:{Authorization:`Bearer ${d.token}`}});ae.value=Tt.data.message,ge.value=!0,ze.value=Tt.data.output,await Ie()}catch(Tt){ae.value=((xt=(wt=Tt.response)==null?void 0:wt.data)==null?void 0:xt.detail)||"Error swapping to real data",ge.value=!1}finally{Fe.value=!1}}};return Dh(Ie),(wt,xt)=>(gi(),ki("div",fN,[xt[21]||(xt[21]=ot("section",{class:"hero"},[ot("div",{class:"hero-overlay"},[ot("h1",{class:"hero-title"},"Admin Panel"),ot("p",{class:"hero-subtitle"}," Manage users, upload data, and control synthetic datasets ")])],-1)),ot("section",pN,[ot("div",mN,[ot("div",gN,[ot("button",{class:Us({active:l.value==="upload"}),onClick:xt[0]||(xt[0]=Tt=>l.value="upload")}," Upload Raster ",2),ot("button",{class:Us({active:l.value==="createUser"}),onClick:xt[1]||(xt[1]=Tt=>l.value="createUser")}," Create User ",2),ot("button",{class:Us({active:l.value==="generateSynthetic"}),onClick:xt[2]||(xt[2]=Tt=>l.value="generateSynthetic")}," Generate Synthetic Data ",2),ot("button",{class:Us({active:l.value==="manageData"}),onClick:xt[3]||(xt[3]=Tt=>l.value="manageData")}," Manage Data (Coming Soon) ",2)]),l.value==="upload"?(gi(),ki("div",_N,[xt[12]||(xt[12]=ot("h3",null,"Upload Raster Layer",-1)),ot("form",{onSubmit:Yg(Je,["prevent"]),class:"form-grid"},[uo(ot("input",{"onUpdate:modelValue":xt[4]||(xt[4]=Tt=>_.value=Tt),placeholder:"Layer Name",required:""},null,512),[[il,_.value]]),uo(ot("input",{"onUpdate:modelValue":xt[5]||(xt[5]=Tt=>T.value=Tt),placeholder:"Category"},null,512),[[il,T.value]]),uo(ot("input",{"onUpdate:modelValue":xt[6]||(xt[6]=Tt=>C.value=Tt),placeholder:"Year"},null,512),[[il,C.value]]),uo(ot("textarea",{"onUpdate:modelValue":xt[7]||(xt[7]=Tt=>P.value=Tt),placeholder:"Description"},null,512),[[il,P.value]]),ot("input",{type:"file",onChange:rt,accept:".tif,.tiff,.zip",required:""},null,32),Z.value?(gi(),ki("div",yN,[ot("div",{class:"progress-bar",style:Rc({width:J.value+"%"})},null,4)])):wn("",!0),ot("button",{type:"submit",disabled:Z.value},pi(Z.value?"Uploading...":"Upload"),9,xN)],32),s.value?(gi(),ki("p",{key:0,class:Us({success:$.value,error:!$.value})},pi(s.value),3)):wn("",!0),ne.value.length?(gi(),ki("div",vN,[xt[11]||(xt[11]=ot("h4",null,"Published Layers",-1)),ot("ul",null,[(gi(!0),ki(jr,null,za(ne.value,Tt=>(gi(),ki("li",{key:Tt.name},pi(Tt.name),1))),128))])])):wn("",!0)])):wn("",!0),l.value==="createUser"?(gi(),ki("div",bN,[xt[15]||(xt[15]=ot("h3",null,"Create New User",-1)),ot("form",{onSubmit:Yg(He,["prevent"]),class:"form-grid"},[uo(ot("input",{"onUpdate:modelValue":xt[8]||(xt[8]=Tt=>ue.value=Tt),type:"email",placeholder:"Email",required:""},null,512),[[il,ue.value]]),uo(ot("input",{"onUpdate:modelValue":xt[9]||(xt[9]=Tt=>we.value=Tt),type:"password",placeholder:"Password",required:""},null,512),[[il,we.value]]),uo(ot("select",{"onUpdate:modelValue":xt[10]||(xt[10]=Tt=>Me.value=Tt),required:""},xt[13]||(xt[13]=[Zg('<option disabled value="" data-v-cc080e79>Select Role</option><option value="admin" data-v-cc080e79>Admin</option><option value="partner" data-v-cc080e79>Partner</option><option value="analyst" data-v-cc080e79>Analyst</option><option value="public" data-v-cc080e79>Public</option>',5)]),512),[[Sh,Me.value]]),xt[14]||(xt[14]=ot("button",{type:"submit"},"Create User",-1))],32),Ye.value?(gi(),ki("p",{key:0,class:Us({success:Ze.value,error:!Ze.value})},pi(Ye.value),3)):wn("",!0)])):wn("",!0),l.value==="generateSynthetic"?(gi(),ki("div",wN,[xt[18]||(xt[18]=ot("h3",null,"Generate Synthetic Data",-1)),xt[19]||(xt[19]=ot("p",null,"This will wipe existing synthetic tables and swap all views to synthetic versions.",-1)),ot("button",{onClick:ti,disabled:Fe.value},pi(Fe.value?"Generating...":"Generate Now"),9,TN),ot("button",{onClick:bt,disabled:Fe.value,style:{"margin-left":"10px"}},pi(Fe.value?"Swapping...":"Swap Back to Real Data"),9,EN),ae.value?(gi(),ki("p",{key:0,class:Us({success:ge.value,error:!ge.value})},pi(ae.value),3)):wn("",!0),Oe.value&&Object.keys(Oe.value).length?(gi(),ki("div",SN,[xt[16]||(xt[16]=ot("h4",null,"Inserted Row Counts:",-1)),ot("ul",null,[(gi(!0),ki(jr,null,za(Oe.value,(Tt,vt)=>(gi(),ki("li",{key:vt},pi(vt)+": "+pi(Tt),1))),128))])])):wn("",!0),ze.value?(gi(),ki("div",CN,[xt[17]||(xt[17]=ot("strong",null,"Output:",-1)),ot("pre",null,pi(ze.value),1)])):wn("",!0)])):wn("",!0),l.value==="manageData"?(gi(),ki("div",AN,xt[20]||(xt[20]=[ot("h3",null,"Data Management (Coming Soon)",-1),ot("p",null,"Future tools for managing datasets, users, and configurations will appear here.",-1)]))):wn("",!0)])])]))}}),IN=ua(MN,[["__scopeId","data-v-cc080e79"]]),kN=[{path:"/",name:"Home",component:q3},{path:"/map",name:"Map",component:EF},{path:"/catalog",name:"Catalog",component:OF},{path:"/about",name:"About",component:tN},{path:"/me-dashboard",name:"M&E Dashboard",component:IF,meta:{requiresAuth:!0,allowedRoles:["admin","partner","analyst"]}},{path:"/dashboard",redirect:"/map"},{path:"/monitoring",redirect:"/me-dashboard"},{path:"/admin-panel",name:"Admin Panel",component:IN,meta:{requiresAuth:!0,allowedRoles:["admin"]}},{path:"/login",name:"Login",component:dN},{path:"/:pathMatch(.*)*",redirect:"/"}],ZA=OD({history:cD("/projects/soil_values/"),routes:kN});ZA.beforeEach((t,l,d)=>{const _=ym(),{token:T,role:C}=KR(_),P=!!T.value;if(t.name==="Login"&&P)return d("/");if(t.meta.requiresAuth&&!P){const V=encodeURIComponent(t.fullPath);return d({path:"/login",query:{redirect:V}})}if(t.meta.allowedRoles&&P&&!(t.meta.allowedRoles.includes(C.value)||C.value==="admin"))return d("/");d()});function PN(t){const d=ym().role,_=t.currentRoute.value.query.redirect;return _?decodeURIComponent(_):d==="admin"?"/admin-panel":"/"}var YA={exports:{}},w0={exports:{}},sE;function LN(){return sE||(sE=1,function(t,l){(function(d,_){d._Highcharts=_(),t.exports=d._Highcharts})(typeof window>"u"?WA:window,()=>(()=>{var ag;let d,_;var T,C,P,V,s,$,Z,J,ne,ue,we,Me,Ye,Ze,Fe,ae,ge,Oe,ze={};ze.d=(R,o)=>{for(var u in o)ze.o(o,u)&&!ze.o(R,u)&&Object.defineProperty(R,u,{enumerable:!0,get:o[u]})},ze.o=(R,o)=>Object.prototype.hasOwnProperty.call(R,o);var rt={};ze.d(rt,{default:()=>oy}),function(R){var o,u,p,x,v,S,A;R.SVG_NS="http://www.w3.org/2000/svg",R.product="Highcharts",R.version="12.2.0",R.win=typeof window<"u"?window:{},R.doc=R.win.document,R.svg=!!((p=(u=(o=R.doc)==null?void 0:o.createElementNS)==null?void 0:u.call(o,R.SVG_NS,"svg"))!=null&&p.createSVGRect),R.pageLang=(S=(v=(x=R.doc)==null?void 0:x.documentElement)==null?void 0:v.closest("[lang]"))==null?void 0:S.lang,R.userAgent=((A=R.win.navigator)==null?void 0:A.userAgent)||"",R.isChrome=R.win.chrome,R.isFirefox=R.userAgent.indexOf("Firefox")!==-1,R.isMS=/(edge|msie|trident)/i.test(R.userAgent)&&!R.win.opera,R.isSafari=!R.isChrome&&R.userAgent.indexOf("Safari")!==-1,R.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(R.userAgent),R.isWebKit=R.userAgent.indexOf("AppleWebKit")!==-1,R.deg2rad=2*Math.PI/360,R.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],R.noop=function(){},R.supportsPassiveEvents=function(){let I=!1;if(!R.isMS){let O=Object.defineProperty({},"passive",{get:function(){I=!0}});R.win.addEventListener&&R.win.removeEventListener&&(R.win.addEventListener("testPassive",R.noop,O),R.win.removeEventListener("testPassive",R.noop,O))}return I}(),R.charts=[],R.composed=[],R.dateFormats={},R.seriesTypes={},R.symbolSizes={},R.chartCount=0}(T||(T={}));let Ie=T,{charts:Je,doc:He,win:ti}=Ie;function bt(R,o,u,p){let x=o?"Highcharts error":"Highcharts warning";R===32&&(R=`${x}: Deprecated member`);let v=xi(R),S=v?`${x} #${R}: www.highcharts.com/errors/${R}/`:R.toString();if(p!==void 0){let A="";v&&(S+="?"),ri(p,function(I,O){A+=`
 - ${O}: ${I}`,v&&(S+=encodeURI(O)+"="+encodeURI(I))}),S+=A}sr(Ie,"displayError",{chart:u,code:R,message:S,params:p},function(){if(o)throw Error(S);ti.console&&bt.messages.indexOf(S)===-1&&console.warn(S)}),bt.messages.push(S)}function wt(R,o){return parseInt(R,o||10)}function xt(R){return typeof R=="string"}function Tt(R){let o=Object.prototype.toString.call(R);return o==="[object Array]"||o==="[object Array Iterator]"}function vt(R,o){return!!R&&typeof R=="object"&&(!o||!Tt(R))}function ai(R){return vt(R)&&typeof R.nodeType=="number"}function yi(R){let o=R==null?void 0:R.constructor;return!!(vt(R,!0)&&!ai(R)&&(o!=null&&o.name)&&o.name!=="Object")}function xi(R){return typeof R=="number"&&!isNaN(R)&&R<1/0&&R>-1/0}function Pr(R){return R!=null}function tr(R,o,u){let p,x=xt(o)&&!Pr(u),v=(S,A)=>{Pr(S)?R.setAttribute(A,S):x?(p=R.getAttribute(A))||A!=="class"||(p=R.getAttribute(A+"Name")):R.removeAttribute(A)};return xt(o)?v(u,o):ri(o,v),p}function nr(R){return Tt(R)?R:[R]}function rn(R,o){let u;for(u in R||(R={}),o)R[u]=o[u];return R}function dr(){let R=arguments,o=R.length;for(let u=0;u<o;u++){let p=R[u];if(p!=null)return p}}function Rn(R,o){rn(R.style,o)}function nn(R){return Math.pow(10,Math.floor(Math.log(R)/Math.LN10))}function zt(R,o){return R>1e14?R:parseFloat(R.toPrecision(o||14))}(bt||(bt={})).messages=[],Math.easeInOutSine=function(R){return-.5*(Math.cos(Math.PI*R)-1)};let fi=Array.prototype.find?function(R,o){return R.find(o)}:function(R,o){let u,p=R.length;for(u=0;u<p;u++)if(o(R[u],u))return R[u]};function ri(R,o,u){for(let p in R)Object.hasOwnProperty.call(R,p)&&o.call(u||R[p],R[p],p,R)}function Ti(R,o,u){function p(S,A){let I=R.removeEventListener;I&&I.call(R,S,A,!1)}function x(S){let A,I;R.nodeName&&(o?(A={})[o]=!0:A=S,ri(A,function(O,N){if(S[N])for(I=S[N].length;I--;)p(N,S[N][I].fn)}))}let v=typeof R=="function"&&R.prototype||R;if(Object.hasOwnProperty.call(v,"hcEvents")){let S=v.hcEvents;if(o){let A=S[o]||[];u?(S[o]=A.filter(function(I){return u!==I.fn}),p(o,u)):(x(S),S[o]=[])}else x(S),delete v.hcEvents}}function sr(R,o,u,p){if(u=u||{},(He==null?void 0:He.createEvent)&&(R.dispatchEvent||R.fireEvent&&R!==Ie)){let x=He.createEvent("Events");x.initEvent(o,!0,!0),u=rn(x,u),R.dispatchEvent?R.dispatchEvent(u):R.fireEvent(o,u)}else if(R.hcEvents){u.target||rn(u,{preventDefault:function(){u.defaultPrevented=!0},target:R,type:o});let x=[],v=R,S=!1;for(;v.hcEvents;)Object.hasOwnProperty.call(v,"hcEvents")&&v.hcEvents[o]&&(x.length&&(S=!0),x.unshift.apply(x,v.hcEvents[o])),v=Object.getPrototypeOf(v);S&&x.sort((A,I)=>A.order-I.order),x.forEach(A=>{A.fn.call(R,u)===!1&&u.preventDefault()})}p&&!u.defaultPrevented&&p.call(R,u)}let Ei=function(){let R=Math.random().toString(36).substring(2,9)+"-",o=0;return function(){return"highcharts-"+(d?"":R)+o++}}();ti.jQuery&&(ti.jQuery.fn.highcharts=function(){let R=[].slice.call(arguments);if(this[0])return R[0]?(new Ie[xt(R[0])?R.shift():"Chart"](this[0],R[0],R[1]),this):Je[tr(this[0],"data-highcharts-chart")]});let xe={addEvent:function(R,o,u,p={}){let x=typeof R=="function"&&R.prototype||R;Object.hasOwnProperty.call(x,"hcEvents")||(x.hcEvents={});let v=x.hcEvents;Ie.Point&&R instanceof Ie.Point&&R.series&&R.series.chart&&(R.series.chart.runTrackerClick=!0);let S=R.addEventListener;S&&S.call(R,o,u,!!Ie.supportsPassiveEvents&&{passive:p.passive===void 0?o.indexOf("touch")!==-1:p.passive,capture:!1}),v[o]||(v[o]=[]);let A={fn:u,order:typeof p.order=="number"?p.order:1/0};return v[o].push(A),v[o].sort((I,O)=>I.order-O.order),function(){Ti(R,o,u)}},arrayMax:function(R){let o=R.length,u=R[0];for(;o--;)R[o]>u&&(u=R[o]);return u},arrayMin:function(R){let o=R.length,u=R[0];for(;o--;)R[o]<u&&(u=R[o]);return u},attr:tr,clamp:function(R,o,u){return R>o?R<u?R:u:o},clearTimeout:function(R){Pr(R)&&clearTimeout(R)},correctFloat:zt,createElement:function(R,o,u,p,x){let v=He.createElement(R);return o&&rn(v,o),x&&Rn(v,{padding:"0",border:"none",margin:"0"}),u&&Rn(v,u),p&&p.appendChild(v),v},crisp:function(R,o=0,u){let p=o%2/2,x=u?-1:1;return(Math.round(R*x-p)+p)*x},css:Rn,defined:Pr,destroyObjectProperties:function(R,o,u){ri(R,function(p,x){p!==o&&(p!=null&&p.destroy)&&p.destroy(),(p!=null&&p.destroy||!u)&&delete R[x]})},diffObjects:function(R,o,u,p){let x={};return function v(S,A,I,O){let N=u?A:S;ri(S,function(z,j){if(!O&&p&&p.indexOf(j)>-1&&A[j]){z=nr(z),I[j]=[];for(let q=0;q<Math.max(z.length,A[j].length);q++)A[j][q]&&(z[q]===void 0?I[j][q]=A[j][q]:(I[j][q]={},v(z[q],A[j][q],I[j][q],O+1)))}else vt(z,!0)&&!z.nodeType?(I[j]=Tt(z)?[]:{},v(z,A[j]||{},I[j],O+1),Object.keys(I[j]).length===0&&(j!=="colorAxis"||O!==0)&&delete I[j]):(S[j]!==A[j]||j in S&&!(j in A))&&j!=="__proto__"&&j!=="constructor"&&(I[j]=N[j])})}(R,o,x,0),x},discardElement:function(R){var o;(o=R==null?void 0:R.parentElement)==null||o.removeChild(R)},erase:function(R,o){let u=R.length;for(;u--;)if(R[u]===o){R.splice(u,1);break}},error:bt,extend:rn,extendClass:function(R,o){let u=function(){};return u.prototype=new R,rn(u.prototype,o),u},find:fi,fireEvent:sr,getAlignFactor:(R="")=>({center:.5,right:1,middle:.5,bottom:1})[R]||0,getClosestDistance:function(R,o){let u,p,x,v=!o;return R.forEach(S=>{if(S.length>1)for(x=S.length-1;x>0;x--)(p=S[x]-S[x-1])<0&&!v?(o==null||o(),o=void 0):p&&(u===void 0||p<u)&&(u=p)}),u},getMagnitude:nn,getNestedProperty:function(R,o){let u=R.split(".");for(;u.length&&Pr(o);){let p=u.shift();if(p===void 0||p==="__proto__")return;if(p==="this"){let v;return vt(o)&&(v=o["@this"]),v??o}let x=o[p.replace(/[\\'"]/g,"")];if(!Pr(x)||typeof x=="function"||typeof x.nodeType=="number"||x===ti)return;o=x}return o},getStyle:function R(o,u,p){var S;let x;if(u==="width"){let A=Math.min(o.offsetWidth,o.scrollWidth),I=(S=o.getBoundingClientRect)==null?void 0:S.call(o).width;return I<A&&I>=A-1&&(A=Math.floor(I)),Math.max(0,A-(R(o,"padding-left",!0)||0)-(R(o,"padding-right",!0)||0))}if(u==="height")return Math.max(0,Math.min(o.offsetHeight,o.scrollHeight)-(R(o,"padding-top",!0)||0)-(R(o,"padding-bottom",!0)||0));let v=ti.getComputedStyle(o,void 0);return v&&(x=v.getPropertyValue(u),dr(p,u!=="opacity")&&(x=wt(x))),x},insertItem:function(R,o){let u,p=R.options.index,x=o.length;for(u=R.options.isInternal?x:0;u<x+1;u++)if(!o[u]||xi(p)&&p<dr(o[u].options.index,o[u]._i)||o[u].options.isInternal){o.splice(u,0,R);break}return u},isArray:Tt,isClass:yi,isDOMElement:ai,isFunction:function(R){return typeof R=="function"},isNumber:xi,isObject:vt,isString:xt,merge:function(R,...o){let u,p=[R,...o],x={},v=function(A,I){return typeof A!="object"&&(A={}),ri(I,function(O,N){N!=="__proto__"&&N!=="constructor"&&(!vt(O,!0)||yi(O)||ai(O)?A[N]=I[N]:A[N]=v(A[N]||{},O))}),A};R===!0&&(x=p[1],p=Array.prototype.slice.call(p,2));let S=p.length;for(u=0;u<S;u++)x=v(x,p[u]);return x},normalizeTickInterval:function(R,o,u,p,x){let v,S=R;u=dr(u,nn(R));let A=R/u;for(!o&&(o=x?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],p===!1&&(u===1?o=o.filter(function(I){return I%1==0}):u<=.1&&(o=[1/u]))),v=0;v<o.length&&(S=o[v],(!x||!(S*u>=R))&&(x||!(A<=(o[v]+(o[v+1]||o[v]))/2)));v++);return zt(S*u,-Math.round(Math.log(.001)/Math.LN10))},objectEach:ri,offset:function(R){let o=He.documentElement,u=R.parentElement||R.parentNode?R.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:u.top+(ti.pageYOffset||o.scrollTop)-(o.clientTop||0),left:u.left+(ti.pageXOffset||o.scrollLeft)-(o.clientLeft||0),width:u.width,height:u.height}},pad:function(R,o,u){return Array((o||2)+1-String(R).replace("-","").length).join(u||"0")+R},pick:dr,pInt:wt,pushUnique:function(R,o){return 0>R.indexOf(o)&&!!R.push(o)},relativeLength:function(R,o,u){return/%$/.test(R)?o*parseFloat(R)/100+(u||0):parseFloat(R)},removeEvent:Ti,replaceNested:function(R,...o){let u,p;do for(p of(u=R,o))R=R.replace(p[0],p[1]);while(R!==u);return R},splat:nr,stableSort:function(R,o){let u,p,x=R.length;for(p=0;p<x;p++)R[p].safeI=p;for(R.sort(function(v,S){return(u=o(v,S))===0?v.safeI-S.safeI:u}),p=0;p<x;p++)delete R[p].safeI},syncTimeout:function(R,o,u){return o>0?setTimeout(R,o,u):(R.call(0,u),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(R){return xt(R)?R.substring(0,1).toUpperCase()+R.substring(1):String(R)},uniqueKey:Ei,useSerialIds:function(R){return d=dr(R,d)},wrap:function(R,o,u){let p=R[o];R[o]=function(){let x=arguments,v=this;return u.apply(this,[function(){return p.apply(v,arguments.length?arguments:x)}].concat([].slice.call(arguments)))}}},{pageLang:ve,win:nt}=Ie,{defined:Lt,error:It,extend:Xt,isNumber:ni,isObject:Te,isString:Ae,merge:Qe,objectEach:$t,pad:Gt,splat:Zt,timeUnits:ut,ucfirst:Pt}=xe,Mi=Ie.isSafari&&nt.Intl&&!nt.Intl.DateTimeFormat.prototype.formatRange,Di=R=>R.main===void 0,$r=class{constructor(R,o){this.options={timezone:"UTC"},this.variableTimezone=!1,this.Date=nt.Date,this.update(R),this.lang=o}update(R={}){this.dTLCache={},this.options=R=Qe(!0,this.options,R);let{timezoneOffset:o,useUTC:u}=R;this.Date=R.Date||nt.Date||Date;let p=R.timezone;Lt(u)&&(p=u?"UTC":void 0),o&&o%60==0&&(p="Etc/GMT"+(o>0?"+":"")+o/60),this.variableTimezone=p!=="UTC"&&(p==null?void 0:p.indexOf("Etc/GMT"))!==0,this.timezone=p,["months","shortMonths","weekdays","shortWeekdays"].forEach(x=>{let v=/months/i.test(x),S=/short/.test(x),A={timeZone:"UTC"};A[v?"month":"weekday"]=S?"short":"long",this[x]=(v?[0,1,2,3,4,5,6,7,8,9,10,11]:[3,4,5,6,7,8,9]).map(I=>this.dateFormat(A,(v?31:1)*24*36e5*I))})}toParts(R){let[o,u,p,x,v,S,A]=this.dateTimeFormat({weekday:"narrow",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},R,"es").split(/(?:, | |\/|:)/g);return[x,+p-1,u,v,S,A,Math.floor(Number(R)||0)%1e3,"DLMXJVS".indexOf(o)].map(Number)}dateTimeFormat(R,o,u=this.options.locale||ve){let p=JSON.stringify(R)+u;Ae(R)&&(R=this.str2dtf(R));let x=this.dTLCache[p];if(!x){R.timeZone??(R.timeZone=this.timezone);try{x=new Intl.DateTimeFormat(u,R)}catch(v){/Invalid time zone/i.test(v.message)?(It(34),R.timeZone="UTC",x=new Intl.DateTimeFormat(u,R)):It(v.message,!1)}}return this.dTLCache[p]=x,(x==null?void 0:x.format(o))||""}str2dtf(R,o={}){let u={L:{fractionalSecondDigits:3},S:{second:"2-digit"},M:{minute:"numeric"},H:{hour:"2-digit"},k:{hour:"numeric"},E:{weekday:"narrow"},a:{weekday:"short"},A:{weekday:"long"},d:{day:"2-digit"},e:{day:"numeric"},b:{month:"short"},B:{month:"long"},m:{month:"2-digit"},o:{month:"numeric"},y:{year:"2-digit"},Y:{year:"numeric"}};return Object.keys(u).forEach(p=>{R.indexOf(p)!==-1&&Xt(o,u[p])}),o}makeTime(R,o,u=1,p=0,x,v,S){let A=this.Date.UTC(R,o,u,p,x||0,v||0,S||0);if(this.timezone!=="UTC"){let I=this.getTimezoneOffset(A);if(A+=I,[2,3,8,9,10,11].indexOf(o)!==-1&&(p<5||p>20)){let O=this.getTimezoneOffset(A);I!==O?A+=O-I:I-36e5!==this.getTimezoneOffset(A-36e5)||Mi||(A-=36e5)}}return A}parse(R){if(!Ae(R))return R??void 0;let o=(R=R.replace(/\//g,"-").replace(/(GMT|UTC)/,"")).indexOf("Z")>-1||/([+-][0-9]{2}):?[0-9]{2}$/.test(R),u=/^[0-9]{4}-[0-9]{2}(-[0-9]{2}|)$/.test(R);o||u||(R+="Z");let p=Date.parse(R);if(ni(p))return p+(!o||u?this.getTimezoneOffset(p):0)}getTimezoneOffset(R){if(this.timezone!=="UTC"){let[o,u,p,x,v=0]=this.dateTimeFormat({timeZoneName:"shortOffset"},R,"en").split(/(GMT|:)/).map(Number),S=-(36e5*(p+v/60));if(ni(S))return S}return 0}dateFormat(R,o,u){let p=this.lang;if(!Lt(o)||isNaN(o))return(p==null?void 0:p.invalidDate)||"";if(Ae(R=R??"%Y-%m-%d %H:%M:%S")){let x,v=/%\[([a-zA-Z]+)\]/g;for(;x=v.exec(R);)R=R.replace(x[0],this.dateTimeFormat(x[1],o,p==null?void 0:p.locale))}if(Ae(R)&&R.indexOf("%")!==-1){let x=this,[v,S,A,I,O,N,z,j]=this.toParts(o),q=(p==null?void 0:p.weekdays)||this.weekdays,K=(p==null?void 0:p.shortWeekdays)||this.shortWeekdays,se=(p==null?void 0:p.months)||this.months,re=(p==null?void 0:p.shortMonths)||this.shortMonths;$t(Xt({a:K?K[j]:q[j].substr(0,3),A:q[j],d:Gt(A),e:Gt(A,2," "),w:j,v:(p==null?void 0:p.weekFrom)??"",b:re[S],B:se[S],m:Gt(S+1),o:S+1,y:v.toString().substr(2,2),Y:v,H:Gt(I),k:I,I:Gt(I%12||12),l:I%12||12,M:Gt(O),p:I<12?"AM":"PM",P:I<12?"am":"pm",S:Gt(N),L:Gt(z,3)},Ie.dateFormats),function(te,ce){if(Ae(R))for(;R.indexOf("%"+ce)!==-1;)R=R.replace("%"+ce,typeof te=="function"?te.call(x,o):te)})}else if(Te(R)){let x=(this.getTimezoneOffset(o)||0)/36e5,v=this.timezone||"Etc/GMT"+(x>=0?"+":"")+x,{prefix:S="",suffix:A=""}=R;R=S+this.dateTimeFormat(Xt({timeZone:v},R),o)+A}return u?Pt(R):R}resolveDTLFormat(R){return Te(R,!0)?Te(R,!0)&&Di(R)?{main:R}:R:{main:(R=Zt(R))[0],from:R[1],to:R[2]}}getDateFormat(R,o,u,p){let x=this.dateFormat("%m-%d %H:%M:%S.%L",o),v="01-01 00:00:00.000",S={millisecond:15,second:12,minute:9,hour:6,day:3},A="millisecond",I=A;for(A in ut){if(R&&R===ut.week&&+this.dateFormat("%w",o)===u&&x.substr(6)===v.substr(6)){A="week";break}if(R&&ut[A]>R){A=I;break}if(S[A]&&x.substr(S[A])!==v.substr(S[A]))break;A!=="week"&&(I=A)}return this.resolveDTLFormat(p[A]).main}},{defined:Nr,extend:cn,timeUnits:lr}=xe,hs=class extends $r{getTimeTicks(R,o,u,p){let x=this,v=[],S={},{count:A=1,unitRange:I}=R,[O,N,z,j,q,K]=x.toParts(o),se=(o||0)%1e3,re;if(p??(p=1),Nr(o)){if(se=I>=lr.second?0:A*Math.floor(se/A),I>=lr.second&&(K=I>=lr.minute?0:A*Math.floor(K/A)),I>=lr.minute&&(q=I>=lr.hour?0:A*Math.floor(q/A)),I>=lr.hour&&(j=I>=lr.day?0:A*Math.floor(j/A)),I>=lr.day&&(z=I>=lr.month?1:Math.max(1,A*Math.floor(z/A))),I>=lr.month&&(N=I>=lr.year?0:A*Math.floor(N/A)),I>=lr.year&&(O-=O%A),I===lr.week){A&&(o=x.makeTime(O,N,z,j,q,K,se));let fe=this.dateTimeFormat({timeZone:this.timezone,weekday:"narrow"},o,"es"),Xe="DLMXJVS".indexOf(fe);z+=-Xe+p+(Xe<p?-7:0)}o=x.makeTime(O,N,z,j,q,K,se),x.variableTimezone&&Nr(u)&&(re=u-o>4*lr.month||x.getTimezoneOffset(o)!==x.getTimezoneOffset(u));let te=o,ce=1;for(;te<u;)v.push(te),I===lr.year?te=x.makeTime(O+ce*A,0):I===lr.month?te=x.makeTime(O,N+ce*A):re&&(I===lr.day||I===lr.week)?te=x.makeTime(O,N,z+ce*A*(I===lr.day?1:7)):re&&I===lr.hour&&A>1?te=x.makeTime(O,N,z,j+ce*A):te+=I*A,ce++;v.push(te),I<=lr.hour&&v.length<1e4&&v.forEach(fe=>{fe%18e5==0&&x.dateFormat("%H%M%S%L",fe)==="000000000"&&(S[fe]="day")})}return v.info=cn(R,{higherRanks:S,totalRange:I*A}),v}},{isTouchDevice:_o}=Ie,{fireEvent:zn,merge:Kn}=xe,ss={colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{weekFrom:"week from",chartTitle:"Chart title",locale:void 0,loading:"Loading...",months:void 0,seriesName:"Series {add index 1}",shortMonths:void 0,weekdays:void 0,numericSymbols:["k","M","G","T","P","E"],pieSliceName:"Slice",resetZoom:"Reset zoom",yAxisTitle:"Values",resetZoomTitle:"Reset zoom level 1:1"},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,timezone:"UTC",timezoneOffset:0,useUTC:void 0},chart:{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",margin:15,minScale:.67},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:""},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:R=>Math.sqrt(1-Math.pow(R-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%[AebHMSL]",second:"%[AebHMS]",minute:"%[AebHM]",hour:"%[AebHM]",day:"%[AebY]",week:"%v %[AebY]",month:"%[BY]",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,position:{x:0,y:3},shared:!1,snap:_o?25:10,headerFormat:'<span style="font-size: 0.8em">{ucfirst point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}},$l=new hs(ss.time,ss.lang),Le={defaultOptions:ss,defaultTime:$l,getOptions:function(){return ss},setOptions:function(R){var o;return zn(Ie,"setOptions",{options:R}),Kn(!0,ss,R),R.time&&$l.update(ss.time),R.lang&&"locale"in R.lang&&$l.update({locale:R.lang.locale}),(o=R.lang)!=null&&o.chartTitle&&(ss.title={...ss.title,text:R.lang.chartTitle}),ss}},{win:oe}=Ie,{isNumber:le,isString:Pe,merge:je,pInt:qe,defined:ct}=xe,at=(R,o,u)=>`color-mix(in srgb,${R},${o} ${100*u}%)`,Ke=R=>Pe(R)&&!!R&&R!=="none";class st{static parse(o){return o?new st(o):st.None}constructor(o){let u,p,x,v;this.rgba=[NaN,NaN,NaN,NaN],this.input=o;let S=Ie.Color;if(S&&S!==st)return new S(o);if(typeof o=="object"&&o.stops!==void 0)this.stops=o.stops.map(A=>new st(A[1]));else if(typeof o=="string")for(this.input=o=st.names[o.toLowerCase()]||o,x=st.parsers.length;x--&&!p;)(u=(v=st.parsers[x]).regex.exec(o))&&(p=v.parse(u));p&&(this.rgba=p)}get(o){let u=this.input,p=this.rgba;if(this.output)return this.output;if(typeof u=="object"&&this.stops!==void 0){let x=je(u);return x.stops=[].slice.call(x.stops),this.stops.forEach((v,S)=>{x.stops[S]=[x.stops[S][0],v.get(o)]}),x}return p&&le(p[0])?o!=="rgb"&&(o||p[3]!==1)?o==="a"?`${p[3]}`:"rgba("+p.join(",")+")":"rgb("+p[0]+","+p[1]+","+p[2]+")":u}brighten(o){let u=this.rgba;if(this.stops)this.stops.forEach(function(p){p.brighten(o)});else if(le(o)&&o!==0)if(le(u[0]))for(let p=0;p<3;p++)u[p]+=qe(255*o),u[p]<0&&(u[p]=0),u[p]>255&&(u[p]=255);else st.useColorMix&&Ke(this.input)&&(this.output=at(this.input,o>0?"white":"black",Math.abs(o)));return this}setOpacity(o){return this.rgba[3]=o,this}tweenTo(o,u){let p=this.rgba,x=o.rgba;if(!le(p[0])||!le(x[0]))return st.useColorMix&&Ke(this.input)&&Ke(o.input)&&u<.99?at(this.input,o.input,u):o.input||"none";let v=x[3]!==1||p[3]!==1,S=(I,O)=>I+(p[O]-I)*(1-u),A=x.slice(0,3).map(S).map(Math.round);return v&&A.push(S(x[3],3)),(v?"rgba(":"rgb(")+A.join(",")+")"}}st.names={white:"#ffffff",black:"#000000"},st.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(R){return[qe(R[1]),qe(R[2]),qe(R[3]),parseFloat(R[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(R){return[qe(R[1]),qe(R[2]),qe(R[3]),1]}},{regex:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?$/i,parse:function(R){return[qe(R[1]+R[1],16),qe(R[2]+R[2],16),qe(R[3]+R[3],16),ct(R[4])?qe(R[4]+R[4],16)/255:1]}},{regex:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?$/i,parse:function(R){return[qe(R[1],16),qe(R[2],16),qe(R[3],16),ct(R[4])?qe(R[4],16)/255:1]}}],st.useColorMix=(ag=oe.CSS)==null?void 0:ag.supports("color","color-mix(in srgb,red,blue 9%)"),st.None=new st("");let{parse:Kt}=st,{win:ii}=Ie,{isNumber:Wt,objectEach:ji}=xe;class Ri{constructor(o,u,p){this.pos=NaN,this.options=u,this.elem=o,this.prop=p}dSetter(){let o=this.paths,u=o==null?void 0:o[0],p=o==null?void 0:o[1],x=this.now||0,v=[];if(x!==1&&u&&p)if(u.length===p.length&&x<1)for(let S=0;S<p.length;S++){let A=u[S],I=p[S],O=[];for(let N=0;N<I.length;N++){let z=A[N],j=I[N];Wt(z)&&Wt(j)&&(I[0]!=="A"||N!==4&&N!==5)?O[N]=z+x*(j-z):O[N]=j}v.push(O)}else v=p;else v=this.toD||[];this.elem.attr("d",v,void 0,!0)}update(){let o=this.elem,u=this.prop,p=this.now,x=this.options.step;this[u+"Setter"]?this[u+"Setter"]():o.attr?o.element&&o.attr(u,p,null,!0):o.style[u]=p+this.unit,x&&x.call(o,p,this)}run(o,u,p){let x=this,v=x.options,S=function(O){return!S.stopped&&x.step(O)},A=ii.requestAnimationFrame||function(O){setTimeout(O,13)},I=function(){for(let O=0;O<Ri.timers.length;O++)Ri.timers[O]()||Ri.timers.splice(O--,1);Ri.timers.length&&A(I)};o!==u||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=o,this.end=u,this.unit=p,this.now=this.start,this.pos=0,S.elem=this.elem,S.prop=this.prop,S()&&Ri.timers.push(S)===1&&A(I)):(delete v.curAnim[this.prop],v.complete&&Object.keys(v.curAnim).length===0&&v.complete.call(this.elem))}step(o){let u,p,x=+new Date,v=this.options,S=this.elem,A=v.complete,I=v.duration,O=v.curAnim;return S.attr&&!S.element?u=!1:o||x>=I+this.startTime?(this.now=this.end,this.pos=1,this.update(),O[this.prop]=!0,p=!0,ji(O,function(N){N!==!0&&(p=!1)}),p&&A&&A.call(S),u=!1):(this.pos=v.easing((x-this.startTime)/I),this.now=this.start+(this.end-this.start)*this.pos,this.update(),u=!0),u}initPath(o,u,p){let x=o.startX,v=o.endX,S=p.slice(),A=o.isArea,I=A?2:1,O=u&&p.length>u.length&&p.hasStackedCliffs,N,z,j,q,K=u==null?void 0:u.slice();if(!K||O)return[S,S];function se(te,ce){for(;te.length<z;){let fe=te[0],Xe=ce[z-te.length];if(Xe&&fe[0]==="M"&&(Xe[0]==="C"?te[0]=["C",fe[1],fe[2],fe[1],fe[2],fe[1],fe[2]]:te[0]=["L",fe[1],fe[2]]),te.unshift(fe),A){let Ue=te.pop();te.push(te[te.length-1],Ue)}}}function re(te){for(;te.length<z;){let ce=te[Math.floor(te.length/I)-1].slice();if(ce[0]==="C"&&(ce[1]=ce[5],ce[2]=ce[6]),A){let fe=te[Math.floor(te.length/I)].slice();te.splice(te.length/2,0,ce,fe)}else te.push(ce)}}if(x&&v&&v.length){for(j=0;j<x.length;j++){if(x[j]===v[0]){N=j;break}if(x[0]===v[v.length-x.length+j]){N=j,q=!0;break}if(x[x.length-1]===v[v.length-x.length+j]){N=x.length-j;break}}N===void 0&&(K=[])}return K.length&&Wt(N)&&(z=S.length+N*I,q?(se(K,S),re(S)):(se(S,K),re(K))),[K,S]}fillSetter(){Ri.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,Kt(this.start).tweenTo(Kt(this.end),this.pos),void 0,!0)}}Ri.timers=[];let{defined:$i,getStyle:or,isArray:ur,isNumber:hn,isObject:_n,merge:os,objectEach:jn,pick:No}=xe;function $n(R){return _n(R)?os({duration:500,defer:0},R):{duration:500*!!R,defer:0}}function us(R,o){let u=Ri.timers.length;for(;u--;)Ri.timers[u].elem!==R||o&&o!==Ri.timers[u].prop||(Ri.timers[u].stopped=!0)}let En={animate:function(R,o,u){let p,x="",v,S,A;_n(u)||(A=arguments,u={duration:A[2],easing:A[3],complete:A[4]}),hn(u.duration)||(u.duration=400),u.easing=typeof u.easing=="function"?u.easing:Math[u.easing]||Math.easeInOutSine,u.curAnim=os(o),jn(o,function(I,O){us(R,O),S=new Ri(R,u,O),v=void 0,O==="d"&&ur(o.d)?(S.paths=S.initPath(R,R.pathArray,o.d),S.toD=o.d,p=0,v=1):R.attr?p=R.attr(O):(p=parseFloat(or(R,O))||0,O!=="opacity"&&(x="px")),v||(v=I),typeof v=="string"&&v.match("px")&&(v=v.replace(/px/g,"")),S.run(p,v,x)})},animObject:$n,getDeferredAnimation:function(R,o,u){let p=$n(o),x=u?[u]:R.series,v=0,S=0;return x.forEach(A=>{let I=$n(A.options.animation);v=_n(o)&&$i(o.defer)?p.defer:Math.max(v,I.duration+I.defer),S=Math.min(p.duration,I.duration)}),R.renderer.forExport&&(v=0),{defer:Math.max(0,v-S),duration:Math.min(v,S)}},setAnimation:function(R,o){o.renderer.globalAnimation=No(R,o.options.chart.animation,!0)},stop:us},{SVG_NS:Bf,win:Ff}=Ie,{attr:wr,createElement:td,css:zc,error:Oh,isFunction:Rh,isString:yo,objectEach:Uo,splat:id}=xe,{trustedTypes:Bc}=Ff,Vo=Bc&&Rh(Bc.createPolicy)&&Bc.createPolicy("highcharts",{createHTML:R=>R}),da=Vo?Vo.createHTML(""):"";class Vr{static filterUserAttributes(o){return Uo(o,(u,p)=>{let x=!0;Vr.allowedAttributes.indexOf(p)===-1&&(x=!1),["background","dynsrc","href","lowsrc","src"].indexOf(p)!==-1&&(x=yo(u)&&Vr.allowedReferences.some(v=>u.indexOf(v)===0)),x||(Oh(33,!1,void 0,{"Invalid attribute in config":`${p}`}),delete o[p]),yo(u)&&o[p]&&(o[p]=u.replace(/</g,"&lt;"))}),o}static parseStyle(o){return o.split(";").reduce((u,p)=>{let x=p.split(":").map(S=>S.trim()),v=x.shift();return v&&x.length&&(u[v.replace(/-([a-z])/g,S=>S[1].toUpperCase())]=x.join(":")),u},{})}static setElementHTML(o,u){o.innerHTML=Vr.emptyHTML,u&&new Vr(u).addToDOM(o)}constructor(o){this.nodes=typeof o=="string"?this.parseMarkup(o):o}addToDOM(o){return function u(p,x){let v;return id(p).forEach(function(S){let A,I=S.tagName,O=S.textContent?Ie.doc.createTextNode(S.textContent):void 0,N=Vr.bypassHTMLFiltering;if(I)if(I==="#text")A=O;else if(Vr.allowedTags.indexOf(I)!==-1||N){let z=I==="svg"?Bf:x.namespaceURI||Bf,j=Ie.doc.createElementNS(z,I),q=S.attributes||{};Uo(S,function(K,se){se!=="tagName"&&se!=="attributes"&&se!=="children"&&se!=="style"&&se!=="textContent"&&(q[se]=K)}),wr(j,N?q:Vr.filterUserAttributes(q)),S.style&&zc(j,S.style),O&&j.appendChild(O),u(S.children||[],j),A=j}else Oh(33,!1,void 0,{"Invalid tagName in config":I});A&&x.appendChild(A),v=A}),v}(this.nodes,o)}parseMarkup(o){let u,p=[];o=o.trim().replace(/ style=(["'])/g," data-style=$1");try{u=new DOMParser().parseFromString(Vo?Vo.createHTML(o):o,"text/html")}catch{}if(!u){let v=td("div");v.innerHTML=o,u={body:v}}let x=(v,S)=>{let A=v.nodeName.toLowerCase(),I={tagName:A};A==="#text"&&(I.textContent=v.textContent||"");let O=v.attributes;if(O){let N={};[].forEach.call(O,z=>{z.name==="data-style"?I.style=Vr.parseStyle(z.value):N[z.name]=z.value}),I.attributes=N}if(v.childNodes.length){let N=[];[].forEach.call(v.childNodes,z=>{x(z,N)}),N.length&&(I.children=N)}S.push(I)};return[].forEach.call(u.body.childNodes,v=>x(v,p)),p}}Vr.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],Vr.allowedReferences=["https://","http://","mailto:","/","../","./","#"],Vr.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],Vr.emptyHTML=da,Vr.bypassHTMLFiltering=!1;let{defaultOptions:Et,defaultTime:jo}=Le,{pageLang:Bn}=Ie,{extend:Jn,getNestedProperty:Nf,isArray:$o,isNumber:zh,isObject:Uf,isString:Gl,pick:li,ucfirst:cr}=xe,Yi={add:(R,o)=>R+o,divide:(R,o)=>o!==0?R/o:"",eq:(R,o)=>R==o,each:function(R){let o=arguments[arguments.length-1];return!!$o(R)&&R.map((u,p)=>Ki(o.body,Jn(Uf(u)?u:{"@this":u},{"@index":p,"@first":p===0,"@last":p===R.length-1}))).join("")},ge:(R,o)=>R>=o,gt:(R,o)=>R>o,if:R=>!!R,le:(R,o)=>R<=o,lt:(R,o)=>R<o,multiply:(R,o)=>R*o,ne:(R,o)=>R!=o,subtract:(R,o)=>R-o,ucfirst:cr,unless:R=>!R},Ps={},Ys=R=>/^["'].+["']$/.test(R);function Ki(R="",o,u){var re;let p=/\{([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= #\(\)]+)\}/g,x=/\(([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= ]+)\)/g,v=[],S=/f$/,A=/\.(\d)/,I=((re=u==null?void 0:u.options)==null?void 0:re.lang)||Et.lang,O=(u==null?void 0:u.time)||jo,N=(u==null?void 0:u.numberFormatter)||Ls,z=(te="")=>{let ce;return te==="true"||te!=="false"&&((ce=Number(te)).toString()===te?ce:Ys(te)?te.slice(1,-1):Nf(te,o))},j,q,K=0,se;for(;(j=p.exec(R))!==null;){let te=j,ce=x.exec(j[1]);ce&&(j=ce,se=!0),q!=null&&q.isBlock||(q={ctx:o,expression:j[1],find:j[0],isBlock:j[1].charAt(0)==="#",start:j.index,startInner:j.index+j[0].length,length:j[0].length});let fe=(q.isBlock?te:j)[1].split(" ")[0].replace("#","");Yi[fe]&&(q.isBlock&&fe===q.fn&&K++,q.fn||(q.fn=fe));let Xe=j[1]==="else";if(q.isBlock&&q.fn&&(j[1]===`/${q.fn}`||Xe))if(K)!Xe&&K--;else{let Ue=q.startInner,$e=R.substr(Ue,j.index-Ue);q.body===void 0?(q.body=$e,q.startInner=j.index+j[0].length):q.elseBody=$e,q.find+=$e+j[0],Xe||(v.push(q),q=void 0)}else q.isBlock||v.push(q);if(ce&&!(q!=null&&q.isBlock))break}return v.forEach(te=>{let ce,fe,{body:Xe,elseBody:Ue,expression:$e,fn:pt}=te;if(pt){let tt=[te],mt=[],Bt=$e.length,Yt=0,ei;for(fe=0;fe<=Bt;fe++){let Ft=$e.charAt(fe);ei||Ft!=='"'&&Ft!=="'"?ei===Ft&&(ei=""):ei=Ft,ei||Ft!==" "&&fe!==Bt||(mt.push($e.substr(Yt,fe-Yt)),Yt=fe+1)}for(fe=Yi[pt].length;fe--;)tt.unshift(z(mt[fe+1]));ce=Yi[pt].apply(o,tt),te.isBlock&&typeof ce=="boolean"&&(ce=Ki(ce?Xe:Ue,o,u))}else{let tt=Ys($e)?[$e]:$e.split(":");if(ce=z(tt.shift()||""),tt.length&&typeof ce=="number"){let mt=tt.join(":");if(S.test(mt)){let Bt=parseInt((mt.match(A)||["","-1"])[1],10);ce!==null&&(ce=N(ce,Bt,I.decimalPoint,mt.indexOf(",")>-1?I.thousandsSep:""))}else ce=O.dateFormat(mt,ce)}x.lastIndex=0,x.test(te.find)&&Gl(ce)&&(ce=`"${ce}"`)}R=R.replace(te.find,li(ce,""))}),se?Ki(R,o,u):R}function Ls(R,o,u,p){var se;o*=1;let x,v,[S,A]=(R=+R||0).toString().split("e").map(Number),I=((se=this==null?void 0:this.options)==null?void 0:se.lang)||Et.lang,O=(R.toString().split(".")[1]||"").split("e")[0].length,N=o,z={};u??(u=I.decimalPoint),p??(p=I.thousandsSep),o===-1?o=Math.min(O,20):zh(o)?o&&A<0&&((v=o+A)>=0?(S=+S.toExponential(v).split("e")[0],o=v):(S=Math.floor(S),R=o<20?+(S*Math.pow(10,A)).toFixed(o):0,A=0)):o=2,A&&(o??(o=2),R=S),zh(o)&&o>=0&&(z.minimumFractionDigits=o,z.maximumFractionDigits=o),p===""&&(z.useGrouping=!1);let j=p||u,q=j?"en":(this==null?void 0:this.locale)||I.locale||Bn,K=JSON.stringify(z)+q;return x=(Ps[K]??(Ps[K]=new Intl.NumberFormat(q,z))).format(R),j&&(x=x.replace(/([,\.])/g,"_$1").replace(/_\,/g,p??",").replace("_.",u??".")),(o||+x!=0)&&(!(A<0)||N)||(x="0"),A&&+x!=0&&(x+="e"+(A<0?"":"+")+A),x}let ds={dateFormat:function(R,o,u){return jo.dateFormat(R,o,u)},format:Ki,helpers:Yi,numberFormat:Ls};(function(R){let o;R.rendererTypes={},R.getRendererType=function(u=o){return R.rendererTypes[u]||R.rendererTypes[o]},R.registerRendererType=function(u,p,x){R.rendererTypes[u]=p,(!o||x)&&(o=u,Ie.Renderer=p)}})(C||(C={}));let xo=C,{clamp:Ks,pick:sn,pushUnique:Vf,stableSort:vo}=xe;(P||(P={})).distribute=function R(o,u,p){let x=o,v=x.reducedLen||u,S=(fe,Xe)=>fe.target-Xe.target,A=[],I=o.length,O=[],N=A.push,z,j,q,K=!0,se,re,te=0,ce;for(z=I;z--;)te+=o[z].size;if(te>v){for(vo(o,(fe,Xe)=>(Xe.rank||0)-(fe.rank||0)),q=(ce=o[0].rank===o[o.length-1].rank)?I/2:-1,j=ce?q:I-1;q&&te>v;)se=o[z=Math.floor(j)],Vf(O,z)&&(te-=se.size),j+=q,ce&&j>=o.length&&(q/=2,j=q);O.sort((fe,Xe)=>Xe-fe).forEach(fe=>N.apply(A,o.splice(fe,1)))}for(vo(o,S),o=o.map(fe=>({size:fe.size,targets:[fe.target],align:sn(fe.align,.5)}));K;){for(z=o.length;z--;)se=o[z],re=(Math.min.apply(0,se.targets)+Math.max.apply(0,se.targets))/2,se.pos=Ks(re-se.size*se.align,0,u-se.size);for(z=o.length,K=!1;z--;)z>0&&o[z-1].pos+o[z-1].size>o[z].pos&&(o[z-1].size+=o[z].size,o[z-1].targets=o[z-1].targets.concat(o[z].targets),o[z-1].align=.5,o[z-1].pos+o[z-1].size>u&&(o[z-1].pos=u-o[z-1].size),o.splice(z,1),K=!0)}return N.apply(x,A),z=0,o.some(fe=>{let Xe=0;return(fe.targets||[]).some(()=>(x[z].pos=fe.pos+Xe,p!==void 0&&Math.abs(x[z].pos-x[z].target)>p?(x.slice(0,z+1).forEach(Ue=>delete Ue.pos),x.reducedLen=(x.reducedLen||u)-.1*u,x.reducedLen>.1*u&&R(x,u,p),!0):(Xe+=x[z].size,z++,!1)))}),vo(x,S),x};let Na=P,{animate:Fc,animObject:rd,stop:nd}=En,{deg2rad:Wl,doc:Go,svg:Bh,SVG_NS:fa,win:Ds,isFirefox:Sn}=Ie,{addEvent:sd,attr:Nc,createElement:Os,crisp:Ts,css:od,defined:Rs,erase:yn,extend:pa,fireEvent:Uc,getAlignFactor:ma,isArray:Qn,isFunction:Fh,isNumber:ad,isObject:ga,isString:_a,merge:Hl,objectEach:ql,pick:bo,pInt:ya,pushUnique:Wo,replaceNested:ld,syncTimeout:al,uniqueKey:Ho}=xe;class xn{_defaultGetter(o){let u=bo(this[o+"Value"],this[o],this.element?this.element.getAttribute(o):null,0);return/^-?[\d\.]+$/.test(u)&&(u=parseFloat(u)),u}_defaultSetter(o,u,p){p.setAttribute(u,o)}add(o){let u,p=this.renderer,x=this.element;return o&&(this.parentGroup=o),this.textStr!==void 0&&this.element.nodeName==="text"&&p.buildText(this),this.added=!0,(!o||o.handleZ||this.zIndex)&&(u=this.zIndexSetter()),u||(o?o.element:p.box).appendChild(x),this.onAdd&&this.onAdd(),this}addClass(o,u){let p=u?"":this.attr("class")||"";return(o=(o||"").split(/ /g).reduce(function(x,v){return p.indexOf(v)===-1&&x.push(v),x},p?[p]:[]).join(" "))!==p&&this.attr("class",o),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(o,u,p,x=!0){let v=this.renderer,S=v.alignedObjects,A=!!o;o?(this.alignOptions=o,this.alignByTranslate=u,this.alignTo=p):(o=this.alignOptions||{},u=this.alignByTranslate,p=this.alignTo);let I=!p||_a(p)?p||"renderer":void 0;I&&(A&&Wo(S,this),p=void 0);let O=bo(p,v[I],v),N=(O.x||0)+(o.x||0)+((O.width||0)-(o.width||0))*ma(o.align),z=(O.y||0)+(o.y||0)+((O.height||0)-(o.height||0))*ma(o.verticalAlign),j={"text-align":o==null?void 0:o.align};return j[u?"translateX":"x"]=Math.round(N),j[u?"translateY":"y"]=Math.round(z),x&&(this[this.placed?"animate":"attr"](j),this.placed=!0),this.alignAttr=j,this}alignSetter(o){let u={left:"start",center:"middle",right:"end"};u[o]&&(this.alignValue=o,this.element.setAttribute("text-anchor",u[o]))}animate(o,u,p){let x=rd(bo(u,this.renderer.globalAnimation,!0)),v=x.defer;return Go.hidden&&(x.duration=0),x.duration!==0?(p&&(x.complete=p),al(()=>{this.element&&Fc(this,o,x)},v)):(this.attr(o,void 0,p||x.complete),ql(o,function(S,A){x.step&&x.step.call(this,S,{prop:A,pos:1,elem:this})},this)),this}applyTextOutline(o){let u=this.element;o.indexOf("contrast")!==-1&&(o=o.replace(/contrast/g,this.renderer.getContrast(u.style.fill)));let p=o.indexOf(" "),x=o.substring(p+1),v=o.substring(0,p);if(v&&v!=="none"&&Ie.svg){this.fakeTS=!0,v=v.replace(/(^[\d\.]+)(.*?)$/g,function(N,z,j){return 2*Number(z)+j}),this.removeTextOutline();let S=Go.createElementNS(fa,"tspan");Nc(S,{class:"highcharts-text-outline",fill:x,stroke:x,"stroke-width":v,"stroke-linejoin":"round"});let A=u.querySelector("textPath")||u;[].forEach.call(A.childNodes,N=>{let z=N.cloneNode(!0);z.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(j=>z.removeAttribute(j)),S.appendChild(z)});let I=0;[].forEach.call(A.querySelectorAll("text tspan"),N=>{I+=Number(N.getAttribute("dy"))});let O=Go.createElementNS(fa,"tspan");O.textContent="",Nc(O,{x:Number(u.getAttribute("x")),dy:-I}),S.appendChild(O),A.insertBefore(S,A.firstChild)}}attr(o,u,p,x){let{element:v}=this,S=xn.symbolCustomAttribs,A,I,O=this,N;return typeof o=="string"&&u!==void 0&&(A=o,(o={})[A]=u),typeof o=="string"?O=(this[o+"Getter"]||this._defaultGetter).call(this,o,v):(ql(o,function(z,j){N=!1,x||nd(this,j),this.symbolName&&S.indexOf(j)!==-1&&(I||(this.symbolAttr(o),I=!0),N=!0),this.rotation&&(j==="x"||j==="y")&&(this.doTransform=!0),N||(this[j+"Setter"]||this._defaultSetter).call(this,z,j,v)},this),this.afterSetters()),p&&p.call(this),O}clip(o){if(o&&!o.clipPath){let u=Ho()+"-",p=this.renderer.createElement("clipPath").attr({id:u}).add(this.renderer.defs);pa(o,{clipPath:p,id:u,count:0}),o.add(p)}return this.attr("clip-path",o?`url(${this.renderer.url}#${o.id})`:"none")}crisp(o,u){u=Math.round(u||o.strokeWidth||0);let p=o.x||this.x||0,x=o.y||this.y||0,v=(o.width||this.width||0)+p,S=(o.height||this.height||0)+x,A=Ts(p,u),I=Ts(x,u);return pa(o,{x:A,y:I,width:Ts(v,u)-A,height:Ts(S,u)-I}),Rs(o.strokeWidth)&&(o.strokeWidth=u),o}complexColor(o,u,p){let x=this.renderer,v,S,A,I,O,N,z,j,q,K,se=[],re;Uc(this.renderer,"complexColor",{args:arguments},function(){if(o.radialGradient?S="radialGradient":o.linearGradient&&(S="linearGradient"),S){if(A=o[S],O=x.gradients,N=o.stops,q=p.radialReference,Qn(A)&&(o[S]=A={x1:A[0],y1:A[1],x2:A[2],y2:A[3],gradientUnits:"userSpaceOnUse"}),S==="radialGradient"&&q&&!Rs(A.gradientUnits)&&(I=A,A=Hl(A,x.getRadialAttr(q,I),{gradientUnits:"userSpaceOnUse"})),ql(A,function(te,ce){ce!=="id"&&se.push(ce,te)}),ql(N,function(te){se.push(te)}),O[se=se.join(",")])K=O[se].attr("id");else{A.id=K=Ho();let te=O[se]=x.createElement(S).attr(A).add(x.defs);te.radAttr=I,te.stops=[],N.forEach(function(ce){ce[1].indexOf("rgba")===0?(z=(v=st.parse(ce[1])).get("rgb"),j=v.get("a")):(z=ce[1],j=1);let fe=x.createElement("stop").attr({offset:ce[0],"stop-color":z,"stop-opacity":j}).add(te);te.stops.push(fe)})}re="url("+x.url+"#"+K+")",p.setAttribute(u,re),p.gradient=se,o.toString=function(){return re}}})}css(o){let u=this.styles,p={},x=this.element,v,S=!u;if(u&&ql(o,function(A,I){u&&u[I]!==A&&(p[I]=A,S=!0)}),S){u&&(o=pa(u,p)),o.width===null||o.width==="auto"?delete this.textWidth:x.nodeName.toLowerCase()==="text"&&o.width&&(v=this.textWidth=ya(o.width)),pa(this.styles,o),v&&!Bh&&this.renderer.forExport&&delete o.width;let A=Sn&&o.fontSize||null;A&&(ad(A)||/^\d+$/.test(A))&&(o.fontSize+="px");let I=Hl(o);x.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","whiteSpace","width"].forEach(O=>I&&delete I[O]),I.color&&(I.fill=I.color,delete I.color)),od(x,I)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),o.textOutline&&this.applyTextOutline(o.textOutline)),this}dashstyleSetter(o){let u,p=this["stroke-width"];if(p==="inherit"&&(p=1),o){let x=(o=o.toLowerCase()).replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(u=x.length;u--;)x[u]=""+ya(x[u])*bo(p,NaN);o=x.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",o)}}destroy(){let o=this,u=o.element||{},p=o.renderer,x=u.ownerSVGElement,v=u.nodeName==="SPAN"&&o.parentGroup||void 0,S,A;if(u.onclick=u.onmouseout=u.onmouseover=u.onmousemove=u.point=null,nd(o),o.clipPath&&x){let I=o.clipPath;[].forEach.call(x.querySelectorAll("[clip-path],[CLIP-PATH]"),function(O){O.getAttribute("clip-path").indexOf(I.element.id)>-1&&O.removeAttribute("clip-path")}),o.clipPath=I.destroy()}if(o.stops){for(A=0;A<o.stops.length;A++)o.stops[A].destroy();o.stops.length=0,o.stops=void 0}for(o.safeRemoveChild(u);v!=null&&v.div&&v.div.childNodes.length===0;)S=v.parentGroup,o.safeRemoveChild(v.div),delete v.div,v=S;o.alignOptions&&yn(p.alignedObjects,o),ql(o,(I,O)=>{var N,z,j;(((N=o[O])==null?void 0:N.parentGroup)===o||["connector","foreignObject"].indexOf(O)!==-1)&&((j=(z=o[O])==null?void 0:z.destroy)==null||j.call(z)),delete o[O]})}dSetter(o,u,p){Qn(o)&&(typeof o[0]=="string"&&(o=this.renderer.pathToSegments(o)),this.pathArray=o,o=o.reduce((x,v,S)=>v!=null&&v.join?(S?x+" ":"")+v.join(" "):(v||"").toString(),"")),/(NaN| {2}|^$)/.test(o)&&(o="M 0 0"),this[u]!==o&&(p.setAttribute(u,o),this[u]=o)}fillSetter(o,u,p){typeof o=="string"?p.setAttribute(u,o):o&&this.complexColor(o,u,p)}hrefSetter(o,u,p){p.setAttributeNS("http://www.w3.org/1999/xlink",u,o)}getBBox(o,u){let p,x,v,S,{alignValue:A,element:I,renderer:O,styles:N,textStr:z}=this,{cache:j,cacheKeys:q}=O,K=I.namespaceURI===this.SVG_NS,se=bo(u,this.rotation,0),re=O.styledMode?I&&xn.prototype.getStyle.call(I,"font-size"):N.fontSize;if(Rs(z)&&((S=z.toString()).indexOf("<")===-1&&(S=S.replace(/\d/g,"0")),S+=["",O.rootFontSize,re,se,this.textWidth,A,N.lineClamp,N.textOverflow,N.fontWeight].join(",")),S&&!o&&(p=j[S]),!p||p.polygon){if(K||O.forExport){try{v=this.fakeTS&&function(ce){let fe=I.querySelector(".highcharts-text-outline");fe&&od(fe,{display:ce})},Fh(v)&&v("none"),p=I.getBBox?pa({},I.getBBox()):{width:I.offsetWidth,height:I.offsetHeight,x:0,y:0},Fh(v)&&v("")}catch{}(!p||p.width<0)&&(p={x:0,y:0,width:0,height:0})}else p=this.htmlGetBBox();x=p.height,K&&(p.height=x={"11px,17":14,"13px,20":16}[`${re||""},${Math.round(x)}`]||x),se&&(p=this.getRotatedBox(p,se));let te={bBox:p};Uc(this,"afterGetBBox",te),p=te.bBox}if(S&&(z===""||p.height>0)){for(;q.length>250;)delete j[q.shift()];j[S]||q.push(S),j[S]=p}return p}getRotatedBox(o,u){let{x:p,y:x,width:v,height:S}=o,{alignValue:A,translateY:I,rotationOriginX:O=0,rotationOriginY:N=0}=this,z=ma(A),j=Number(this.element.getAttribute("y")||0)-(I?0:x),q=u*Wl,K=(u-90)*Wl,se=Math.cos(q),re=Math.sin(q),te=v*se,ce=v*re,fe=Math.cos(K),Xe=Math.sin(K),[[Ue,$e],[pt,tt]]=[O,N].map(vr=>[vr-vr*se,vr*re]),mt=p+z*(v-te)+Ue+tt+j*fe,Bt=mt+te,Yt=Bt-S*fe,ei=Yt-te,Ft=x+j-z*ce-$e+pt+j*Xe,ci=Ft+ce,mi=ci-S*Xe,Ni=mi-ce,bi=Math.min(mt,Bt,Yt,ei),Vi=Math.min(Ft,ci,mi,Ni),gr=Math.max(mt,Bt,Yt,ei)-bi,ar=Math.max(Ft,ci,mi,Ni)-Vi;return{x:bi,y:Vi,width:gr,height:ar,polygon:[[mt,Ft],[Bt,ci],[Yt,mi],[ei,Ni]]}}getStyle(o){return Ds.getComputedStyle(this.element||this,"").getPropertyValue(o)}hasClass(o){return(""+this.attr("class")).split(" ").indexOf(o)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(o,u){this.onEvents={},this.opacity=1,this.SVG_NS=fa,this.element=u==="span"||u==="body"?Os(u):Go.createElementNS(this.SVG_NS,u),this.renderer=o,this.styles={},Uc(this,"afterInit")}on(o,u){let{onEvents:p}=this;return p[o]&&p[o](),p[o]=sd(this.element,o,u),this}opacitySetter(o,u,p){let x=Number(Number(o).toFixed(3));this.opacity=x,p.setAttribute(u,x)}reAlign(){var o;(o=this.alignOptions)!=null&&o.width&&this.alignOptions.align!=="left"&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(o){return this.attr("class",(""+this.attr("class")).replace(_a(o)?RegExp(`(^| )${o}( |$)`):o," ").replace(/ +/g," ").trim())}removeTextOutline(){let o=this.element.querySelector("tspan.highcharts-text-outline");o&&this.safeRemoveChild(o)}safeRemoveChild(o){let u=o.parentNode;u&&u.removeChild(o)}setRadialReference(o){let u=this.element.gradient&&this.renderer.gradients[this.element.gradient]||void 0;return this.element.radialReference=o,u!=null&&u.radAttr&&u.animate(this.renderer.getRadialAttr(o,u.radAttr)),this}shadow(o){var v;let{renderer:u}=this,p=Hl(((v=this.parentGroup)==null?void 0:v.rotation)===90?{offsetX:-1,offsetY:-1}:{},ga(o)?o:{}),x=u.shadowDefinition(p);return this.attr({filter:o?`url(${u.url}#${x})`:"none"})}show(o=!0){return this.attr({visibility:o?"inherit":"visible"})}"stroke-widthSetter"(o,u,p){this[u]=o,p.setAttribute(u,o)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let o=this.getStyle("stroke-width"),u=0,p;return/px$/.test(o)?u=ya(o):o!==""&&(Nc(p=Go.createElementNS(fa,"rect"),{width:o,"stroke-width":0}),this.element.parentNode.appendChild(p),u=p.getBBox().width,p.parentNode.removeChild(p)),u}symbolAttr(o){let u=this;xn.symbolCustomAttribs.forEach(function(p){u[p]=bo(o[p],u[p])}),u.attr({d:u.renderer.symbols[u.symbolName](u.x,u.y,u.width,u.height,u)})}textSetter(o){o!==this.textStr&&(delete this.textPxLength,this.textStr=o,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(o){let u=this.element,p=u.getElementsByTagName("title")[0]||Go.createElementNS(this.SVG_NS,"title");u.insertBefore?u.insertBefore(p,u.firstChild):u.appendChild(p),p.textContent=ld(bo(o,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let o=this.element;return o.parentNode.appendChild(o),this}translate(o,u){return this.attr({translateX:o,translateY:u})}updateTransform(o="transform"){let{element:u,foreignObject:p,matrix:x,padding:v,rotation:S=0,rotationOriginX:A,rotationOriginY:I,scaleX:O,scaleY:N,text:z,translateX:j=0,translateY:q=0}=this,K=["translate("+j+","+q+")"];Rs(x)&&K.push("matrix("+x.join(",")+")"),S&&(K.push("rotate("+S+" "+(A??u.getAttribute("x")??this.x??0)+" "+(I??u.getAttribute("y")??this.y??0)+")"),(z==null?void 0:z.element.tagName)!=="SPAN"||z!=null&&z.foreignObject||z.attr({rotation:S,rotationOriginX:(A||0)-v,rotationOriginY:(I||0)-v})),(Rs(O)||Rs(N))&&K.push("scale("+bo(O,1)+" "+bo(N,1)+")"),K.length&&!(z||this).textPath&&((p==null?void 0:p.element)||u).setAttribute(o,K.join(" "))}visibilitySetter(o,u,p){o==="inherit"?p.removeAttribute(u):this[u]!==o&&p.setAttribute(u,o),this[u]=o}xGetter(o){return this.element.nodeName==="circle"&&(o==="x"?o="cx":o==="y"&&(o="cy")),this._defaultGetter(o)}zIndexSetter(o,u){let p=this.renderer,x=this.parentGroup,v=(x||p).element||p.box,S=this.element,A=v===p.box,I,O,N,z=!1,j,q=this.added,K;if(Rs(o)?(S.setAttribute("data-z-index",o),o*=1,this[u]===o&&(q=!1)):Rs(this[u])&&S.removeAttribute("data-z-index"),this[u]=o,q){for((o=this.zIndex)&&x&&(x.handleZ=!0),K=(I=v.childNodes).length-1;K>=0&&!z;K--)j=!Rs(N=(O=I[K]).getAttribute("data-z-index")),O!==S&&(o<0&&j&&!A&&!K?(v.insertBefore(S,I[K]),z=!0):(ya(N)<=o||j&&(!Rs(o)||o>=0))&&(v.insertBefore(S,I[K+1]),z=!0));z||(v.insertBefore(S,I[3*!!A]),z=!0)}return z}}xn.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],xn.prototype.strokeSetter=xn.prototype.fillSetter,xn.prototype.yGetter=xn.prototype.xGetter,xn.prototype.matrixSetter=xn.prototype.rotationOriginXSetter=xn.prototype.rotationOriginYSetter=xn.prototype.rotationSetter=xn.prototype.scaleXSetter=xn.prototype.scaleYSetter=xn.prototype.translateXSetter=xn.prototype.translateYSetter=xn.prototype.verticalAlignSetter=function(R,o){this[o]=R,this.doTransform=!0};let es=xn,{defined:Vc,extend:Xl,getAlignFactor:Zl,isNumber:Yl,merge:Nh,pick:Kl,removeEvent:Uh}=xe;class Js extends es{constructor(o,u,p,x,v,S,A,I,O,N){let z;super(o,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=u,this.x=p,this.y=x,this.anchorX=S,this.anchorY=A,this.baseline=O,this.className=N,this.addClass(N==="button"?"highcharts-no-tooltip":"highcharts-label"),N&&this.addClass("highcharts-"+N),this.text=o.text(void 0,0,0,I).attr({zIndex:1}),typeof v=="string"&&((z=/^url\((.*?)\)$/.test(v))||this.renderer.symbols[v])&&(this.symbolKey=v),this.bBox=Js.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=o.styledMode||z,this.deferredAttr={},this.alignFactor=0}alignSetter(o){let u=Zl(o);this.textAlign=o,u!==this.alignFactor&&(this.alignFactor=u,this.bBox&&Yl(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(o,u){this.anchorX=o,this.boxAttr(u,Math.round(o)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(o,u){this.anchorY=o,this.boxAttr(u,o-this.ySetting)}boxAttr(o,u){this.box?this.box.attr(o,u):this.deferredAttr[o]=u}css(o){if(o){let u={};o=Nh(o),Js.textProps.forEach(p=>{o[p]!==void 0&&(u[p]=o[p],delete o[p])}),this.text.css(u),"fontSize"in u||"fontWeight"in u?this.updateTextPadding():("width"in u||"textOverflow"in u)&&this.updateBoxSize()}return es.prototype.css.call(this,o)}destroy(){Uh(this.element,"mouseenter"),Uh(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),es.prototype.destroy.call(this)}fillSetter(o,u){o&&(this.needsBox=!0),this.fill=o,this.boxAttr(u,o)}getBBox(o,u){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let{padding:p,height:x=0,translateX:v=0,translateY:S=0,width:A=0}=this,I=Kl(this.paddingLeft,p),O=u??(this.rotation||0),N={width:A,height:x,x:v+this.bBox.x-I,y:S+this.bBox.y-p+this.baselineOffset};return O&&(N=this.getRotatedBox(N,O)),N}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(o){this.heightSetting=o,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:Kl(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&Vc(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(o,u){Yl(o)?o!==this[u]&&(this[u]=o,this.updateTextPadding()):this[u]=void 0}rSetter(o,u){this.boxAttr(u,o)}strokeSetter(o,u){this.stroke=o,this.boxAttr(u,o)}"stroke-widthSetter"(o,u){o&&(this.needsBox=!0),this["stroke-width"]=o,this.boxAttr(u,o)}"text-alignSetter"(o){this.textAlign=this["text-align"]=o,this.updateTextPadding()}textSetter(o){o!==void 0&&this.text.attr({text:o}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let o,u=this.text,p={},x=this.padding,v=this.bBox=(!Yl(this.widthSetting)||!Yl(this.heightSetting)||this.textAlign)&&Vc(u.textStr)?u.getBBox(void 0,0):Js.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||v.height||0)+2*x;let S=this.renderer.fontMetrics(u);if(this.baselineOffset=x+Math.min((this.text.firstLineMetrics||S).b,v.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-S.h)/2),this.needsBox&&!u.textPath){if(!this.box){let A=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();A.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),A.add(this)}p.x=o=this.getCrispAdjust(),p.y=(this.baseline?-this.baselineOffset:0)+o,p.width=Math.round(this.width),p.height=Math.round(this.height),this.box.attr(Xl(p,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let o=this.text,u=o.styles.textAlign||this.textAlign;if(!o.textPath){this.updateBoxSize();let p=this.baseline?0:this.baselineOffset,x=(this.paddingLeft??this.padding)+Zl(u)*(this.widthSetting??this.bBox.width);(x!==o.x||p!==o.y)&&(o.attr({align:u,x}),p!==void 0&&o.attr("y",p)),o.x=x,o.y=p}}widthSetter(o){this.widthSetting=Yl(o)?o:void 0,this.doUpdate=!0}getPaddedWidth(){let o=this.padding,u=Kl(this.paddingLeft,o),p=Kl(this.paddingRight,o);return(this.widthSetting||this.bBox.width||0)+u+p}xSetter(o){this.x=o,this.alignFactor&&(o-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(o),this.attr("translateX",this.xSetting)}ySetter(o){this.ySetting=this.y=Math.round(o),this.attr("translateY",this.ySetting)}}Js.emptyBBox={width:0,height:0,x:0,y:0},Js.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineClamp","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"];let{defined:br,isNumber:vm,pick:ll}=xe;function cd(R,o,u,p,x){let v=[];if(x){let S=x.start||0,A=x.end||0,I=ll(x.r,u),O=ll(x.r,p||u),N=2e-4/(x.borderRadius?1:Math.max(I,1)),z=Math.abs(A-S-2*Math.PI)<N;z&&(S=Math.PI/2,A=2.5*Math.PI-N);let j=x.innerR,q=ll(x.open,z),K=Math.cos(S),se=Math.sin(S),re=Math.cos(A),te=Math.sin(A),ce=ll(x.longArc,A-S-Math.PI<N?0:1),fe=["A",I,O,0,ce,ll(x.clockwise,1),R+I*re,o+O*te];fe.params={start:S,end:A,cx:R,cy:o},v.push(["M",R+I*K,o+O*se],fe),br(j)&&((fe=["A",j,j,0,ce,br(x.clockwise)?1-x.clockwise:0,R+j*K,o+j*se]).params={start:A,end:S,cx:R,cy:o},v.push(q?["M",R+j*re,o+j*te]:["L",R+j*re,o+j*te],fe)),q||v.push(["Z"])}return v}function Vh(R,o,u,p,x){return x!=null&&x.r?jh(R,o,u,p,x):[["M",R,o],["L",R+u,o],["L",R+u,o+p],["L",R,o+p],["Z"]]}function jh(R,o,u,p,x){let v=(x==null?void 0:x.r)||0;return[["M",R+v,o],["L",R+u-v,o],["A",v,v,0,0,1,R+u,o+v],["L",R+u,o+p-v],["A",v,v,0,0,1,R+u-v,o+p],["L",R+v,o+p],["A",v,v,0,0,1,R,o+p-v],["L",R,o+v],["A",v,v,0,0,1,R+v,o],["Z"]]}let $h={arc:cd,callout:function(R,o,u,p,x){let v=Math.min((x==null?void 0:x.r)||0,u,p),S=v+6,A=x==null?void 0:x.anchorX,I=(x==null?void 0:x.anchorY)||0,O=jh(R,o,u,p,{r:v});if(!vm(A)||A<u&&A>0&&I<p&&I>0)return O;if(R+A>u-S)if(I>o+S&&I<o+p-S)O.splice(3,1,["L",R+u,I-6],["L",R+u+6,I],["L",R+u,I+6],["L",R+u,o+p-v]);else if(A<u){let N=I<o+S,z=N?o:o+p;O.splice(N?2:5,0,["L",A,I],["L",R+u-v,z])}else O.splice(3,1,["L",R+u,p/2],["L",A,I],["L",R+u,p/2],["L",R+u,o+p-v]);else if(R+A<S)if(I>o+S&&I<o+p-S)O.splice(7,1,["L",R,I+6],["L",R-6,I],["L",R,I-6],["L",R,o+v]);else if(A>0){let N=I<o+S,z=N?o:o+p;O.splice(N?1:6,0,["L",A,I],["L",R+v,z])}else O.splice(7,1,["L",R,p/2],["L",A,I],["L",R,p/2],["L",R,o+v]);else I>p&&A<u-S?O.splice(5,1,["L",A+6,o+p],["L",A,o+p+6],["L",A-6,o+p],["L",R+v,o+p]):I<0&&A>S&&O.splice(1,1,["L",A-6,o],["L",A,o-6],["L",A+6,o],["L",u-v,o]);return O},circle:function(R,o,u,p){return cd(R+u/2,o+p/2,u/2,p/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(R,o,u,p){return[["M",R+u/2,o],["L",R+u,o+p/2],["L",R+u/2,o+p],["L",R,o+p/2],["Z"]]},rect:Vh,roundedRect:jh,square:Vh,triangle:function(R,o,u,p){return[["M",R+u/2,o],["L",R+u,o+p],["L",R,o+p],["Z"]]},"triangle-down":function(R,o,u,p){return[["M",R,o],["L",R+u,o],["L",R+u/2,o+p],["Z"]]}},{doc:Ua,SVG_NS:Gh,win:cl}=Ie,{attr:wo,extend:hl,fireEvent:Wh,isString:jf,objectEach:jc,pick:hd}=xe,$c=(R,o)=>R.substring(0,o)+"",Hh=class{constructor(R){let o=R.styles;this.renderer=R.renderer,this.svgElement=R,this.width=R.textWidth,this.textLineHeight=o==null?void 0:o.lineHeight,this.textOutline=o==null?void 0:o.textOutline,this.ellipsis=(o==null?void 0:o.textOverflow)==="ellipsis",this.lineClamp=o==null?void 0:o.lineClamp,this.noWrap=(o==null?void 0:o.whiteSpace)==="nowrap"}buildSVG(){let R=this.svgElement,o=R.element,u=R.renderer,p=hd(R.textStr,"").toString(),x=p.indexOf("<")!==-1,v=o.childNodes,S=!R.added&&u.box,A=[p,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,R.getStyle("font-size"),R.styles.lineClamp,this.width].join(",");if(A!==R.textCache){R.textCache=A,delete R.actualWidth;for(let I=v.length;I--;)o.removeChild(v[I]);if(x||this.ellipsis||this.width||R.textPath||p.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(p))){if(p!==""){S&&S.appendChild(o);let I=new Vr(p);this.modifyTree(I.nodes),I.addToDOM(o),this.modifyDOM(),this.ellipsis&&(o.textContent||"").indexOf("")!==-1&&R.attr("title",this.unescapeEntities(R.textStr||"",["&lt;","&gt;"])),S&&S.removeChild(o)}}else o.appendChild(Ua.createTextNode(this.unescapeEntities(p)));jf(this.textOutline)&&R.applyTextOutline&&R.applyTextOutline(this.textOutline)}}modifyDOM(){let R,o=this.svgElement,u=wo(o.element,"x");for(o.firstLineMetrics=void 0;(R=o.element.firstChild)&&/^[\s\u200B]*$/.test(R.textContent||" ");)o.element.removeChild(R);[].forEach.call(o.element.querySelectorAll("tspan.highcharts-br"),(S,A)=>{S.nextSibling&&S.previousSibling&&(A===0&&S.previousSibling.nodeType===1&&(o.firstLineMetrics=o.renderer.fontMetrics(S.previousSibling)),wo(S,{dy:this.getLineHeight(S.nextSibling),x:u}))});let p=this.width||0;if(!p)return;let x=(S,A)=>{var se;let I=S.textContent||"",O=I.replace(/([^\^])-/g,"$1- ").split(" "),N=!this.noWrap&&(O.length>1||o.element.childNodes.length>1),z=this.getLineHeight(A),j=Math.max(0,p-.8*z),q=0,K=o.actualWidth;if(N){let re=[],te=[];for(;A.firstChild&&A.firstChild!==S;)te.push(A.firstChild),A.removeChild(A.firstChild);for(;O.length;)if(O.length&&!this.noWrap&&q>0&&(re.push(S.textContent||""),S.textContent=O.join(" ").replace(/- /g,"-")),this.truncate(S,void 0,O,q===0&&K||0,p,j,(ce,fe)=>O.slice(0,fe).join(" ").replace(/- /g,"-")),K=o.actualWidth,q++,this.lineClamp&&q>=this.lineClamp){O.length&&(this.truncate(S,S.textContent||"",void 0,0,p,j,$c),S.textContent=((se=S.textContent)==null?void 0:se.replace("",""))+"");break}te.forEach(ce=>{A.insertBefore(ce,S)}),re.forEach(ce=>{A.insertBefore(Ua.createTextNode(ce),S);let fe=Ua.createElementNS(Gh,"tspan");fe.textContent="",wo(fe,{dy:z,x:u}),A.insertBefore(fe,S)})}else this.ellipsis&&I&&this.truncate(S,I,void 0,0,p,j,$c)},v=S=>{[].slice.call(S.childNodes).forEach(A=>{A.nodeType===cl.Node.TEXT_NODE?x(A,S):(A.className.baseVal.indexOf("highcharts-br")!==-1&&(o.actualWidth=0),v(A))})};v(o.element)}getLineHeight(R){let o=R.nodeType===cl.Node.TEXT_NODE?R.parentElement:R;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(o||this.svgElement.element).h}modifyTree(R){let o=(u,p)=>{let{attributes:x={},children:v,style:S={},tagName:A}=u,I=this.renderer.styledMode;if(A==="b"||A==="strong"?I?x.class="highcharts-strong":S.fontWeight="bold":(A==="i"||A==="em")&&(I?x.class="highcharts-emphasized":S.fontStyle="italic"),S!=null&&S.color&&(S.fill=S.color),A==="br"){x.class="highcharts-br",u.textContent="";let O=R[p+1];O!=null&&O.textContent&&(O.textContent=O.textContent.replace(/^ +/gm,""))}else A==="a"&&v&&v.some(O=>O.tagName==="#text")&&(u.children=[{children:v,tagName:"tspan"}]);A!=="#text"&&A!=="a"&&(u.tagName="tspan"),hl(u,{attributes:x,style:S}),v&&v.filter(O=>O.tagName!=="#text").forEach(o)};R.forEach(o),Wh(this.svgElement,"afterModifyTree",{nodes:R})}truncate(R,o,u,p,x,v,S){let A,I,O=this.svgElement,{rotation:N}=O,z=[],j=u&&!p?1:0,q=(o||u||"").length,K=q;u||(x=v);let se=function(re,te){let ce=te||re,fe=R.parentNode;if(fe&&z[ce]===void 0&&fe.getSubStringLength)try{z[ce]=p+fe.getSubStringLength(0,u?ce+1:ce)}catch{}return z[ce]};if(O.rotation=0,p+(I=se(R.textContent.length))>x){for(;j<=q;)K=Math.ceil((j+q)/2),u&&(A=S(u,K)),I=se(K,A&&A.length-1),j===q?j=q+1:I>x?q=K-1:j=K;q===0?R.textContent="":o&&q===o.length-1||(R.textContent=A||S(o||u,K)),this.ellipsis&&I>x&&this.truncate(R,R.textContent||"",void 0,0,x,v,$c)}u&&u.splice(0,K),O.actualWidth=I,O.rotation=N}unescapeEntities(R,o){return jc(this.renderer.escapes,function(u,p){o&&o.indexOf(u)!==-1||(R=R.toString().replace(RegExp(u,"g"),p))}),R}},{defaultOptions:qh}=Le,{charts:ud,deg2rad:pr,doc:qo,isFirefox:dd,isMS:Xh,isWebKit:$f,noop:ul,SVG_NS:fd,symbolSizes:pd,win:md}=Ie,{addEvent:Zh,attr:Jl,createElement:gd,crisp:Yh,css:dl,defined:Va,destroyObjectProperties:Gf,extend:fl,isArray:Gc,isNumber:To,isObject:pl,isString:Wc,merge:Hc,pick:Qs,pInt:Kh,replaceNested:_d,uniqueKey:Jh}=xe;class qc{constructor(o,u,p,x,v,S,A){let I,O;this.x=0,this.y=0;let N=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),z=N.element;A||N.css(this.getStyle(x||{})),o.appendChild(z),Jl(o,"dir","ltr"),o.innerHTML.indexOf("xmlns")===-1&&Jl(z,"xmlns",this.SVG_NS),this.box=z,this.boxWrapper=N,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(qo.createTextNode("Created with Highcharts 12.2.0")),this.defs=this.createElement("defs").add(),this.allowHTML=S,this.forExport=v,this.styledMode=A,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=N.getStyle("font-size"),this.setSize(u,p,!1),dd&&o.getBoundingClientRect&&((I=function(){dl(o,{left:0,top:0}),O=o.getBoundingClientRect(),dl(o,{left:Math.ceil(O.left)-O.left+"px",top:Math.ceil(O.top)-O.top+"px"})})(),this.unSubPixelFix=Zh(md,"resize",I))}definition(o){return new Vr([o]).addToDOM(this.defs.element)}getReferenceURL(){if((dd||$f)&&qo.getElementsByTagName("base").length){if(!Va(_)){let o=Jh(),u=new Vr([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:o},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${o})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(qo.body);dl(u,{position:"fixed",top:0,left:0,zIndex:9e5});let p=qo.elementFromPoint(6,6);_=(p==null?void 0:p.id)==="hitme",qo.body.removeChild(u)}if(_)return _d(md.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(o){return this.style=fl({fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif',fontSize:"1rem"},o),this.style}setStyle(o){this.boxWrapper.css(this.getStyle(o))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let o=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),Gf(this.gradients||{}),this.gradients=null,this.defs=o.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(o){return new this.Element(this,o)}getRadialAttr(o,u){return{cx:o[0]-o[2]/2+(u.cx||0)*o[2],cy:o[1]-o[2]/2+(u.cy||0)*o[2],r:(u.r||0)*o[2]}}shadowDefinition(o){let u=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(o).map(x=>`${x}-${o[x]}`)].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),p=Hc({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},o);return this.defs.element.querySelector(`#${u}`)||this.definition({tagName:"filter",attributes:{id:u,filterUnits:p.filterUnits},children:this.getShadowFilterContent(p)}),u}getShadowFilterContent(o){return[{tagName:"feDropShadow",attributes:{dx:o.offsetX,dy:o.offsetY,"flood-color":o.color,"flood-opacity":Math.min(5*o.opacity,1),stdDeviation:o.width/2}}]}buildText(o){new Hh(o).buildSVG()}getContrast(o){let u=st.parse(o).rgba,p=" clamp(0,calc(9e9*(0.5 - (0.2126*r + 0.7152*g + 0.0722*b))),1)";if(To(u[0])||!st.useColorMix){let x=u.map(S=>{let A=S/255;return A<=.04?A/12.92:Math.pow((A+.055)/1.055,2.4)}),v=.2126*x[0]+.7152*x[1]+.0722*x[2];return 1.05/(v+.05)>(v+.05)/.05?"#FFFFFF":"#000000"}return"color(from "+o+" srgb"+p+p+p+")"}button(o,u,p,x,v={},S,A,I,O,N){let z=this.label(o,u,p,O,void 0,void 0,N,void 0,"button"),j=this.styledMode,q=arguments,K=0;v=Hc(qh.global.buttonTheme,v),j&&(delete v.fill,delete v.stroke,delete v["stroke-width"]);let se=v.states||{},re=v.style||{};delete v.states,delete v.style;let te=[Vr.filterUserAttributes(v)],ce=[re];return j||["hover","select","disabled"].forEach((fe,Xe)=>{te.push(Hc(te[0],Vr.filterUserAttributes(q[Xe+5]||se[fe]||{}))),ce.push(te[Xe+1].style),delete te[Xe+1].style}),Zh(z.element,Xh?"mouseover":"mouseenter",function(){K!==3&&z.setState(1)}),Zh(z.element,Xh?"mouseout":"mouseleave",function(){K!==3&&z.setState(K)}),z.setState=(fe=0)=>{if(fe!==1&&(z.state=K=fe),z.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][fe]),!j){z.attr(te[fe]);let Xe=ce[fe];pl(Xe)&&z.css(Xe)}},z.attr(te[0]),!j&&(z.css(fl({cursor:"default"},re)),N&&z.text.css({pointerEvents:"none"})),z.on("touchstart",fe=>fe.stopPropagation()).on("click",function(fe){K!==3&&(x==null||x.call(z,fe))})}crispLine(o,u){let[p,x]=o;return Va(p[1])&&p[1]===x[1]&&(p[1]=x[1]=Yh(p[1],u)),Va(p[2])&&p[2]===x[2]&&(p[2]=x[2]=Yh(p[2],u)),o}path(o){let u=this.styledMode?{}:{fill:"none"};return Gc(o)?u.d=o:pl(o)&&fl(u,o),this.createElement("path").attr(u)}circle(o,u,p){let x=pl(o)?o:o===void 0?{}:{x:o,y:u,r:p},v=this.createElement("circle");return v.xSetter=v.ySetter=function(S,A,I){I.setAttribute("c"+A,S)},v.attr(x)}arc(o,u,p,x,v,S){let A;pl(o)?(u=(A=o).y,p=A.r,x=A.innerR,v=A.start,S=A.end,o=A.x):A={innerR:x,start:v,end:S};let I=this.symbol("arc",o,u,p,p,A);return I.r=p,I}rect(o,u,p,x,v,S){let A=pl(o)?o:o===void 0?{}:{x:o,y:u,r:v,width:Math.max(p||0,0),height:Math.max(x||0,0)},I=this.createElement("rect");return this.styledMode||(S!==void 0&&(A["stroke-width"]=S,fl(A,I.crisp(A))),A.fill="none"),I.rSetter=function(O,N,z){I.r=O,Jl(z,{rx:O,ry:O})},I.rGetter=function(){return I.r||0},I.attr(A)}roundedRect(o){return this.symbol("roundedRect").attr(o)}setSize(o,u,p){this.width=o,this.height=u,this.boxWrapper.animate({width:o,height:u},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:Qs(p,!0)?void 0:0}),this.alignElements()}g(o){let u=this.createElement("g");return o?u.attr({class:"highcharts-"+o}):u}image(o,u,p,x,v,S){let A={preserveAspectRatio:"none"};To(u)&&(A.x=u),To(p)&&(A.y=p),To(x)&&(A.width=x),To(v)&&(A.height=v);let I=this.createElement("image").attr(A),O=function(N){I.attr({href:o}),S.call(I,N)};if(S){I.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let N=new md.Image;Zh(N,"load",O),N.src=o,N.complete&&O({})}else I.attr({href:o});return I}symbol(o,u,p,x,v,S){var re,te;let A,I,O,N,z=this,j=/^url\((.*?)\)$/,q=j.test(o),K=!q&&(this.symbols[o]?o:"circle"),se=K&&this.symbols[K];if(se)typeof u=="number"&&(I=se.call(this.symbols,u||0,p||0,x||0,v||0,S)),A=this.path(I),z.styledMode||A.attr("fill","none"),fl(A,{symbolName:K||void 0,x:u,y:p,width:x,height:v}),S&&fl(A,S);else if(q){O=o.match(j)[1];let ce=A=this.image(O);ce.imgwidth=Qs(S==null?void 0:S.width,(re=pd[O])==null?void 0:re.width),ce.imgheight=Qs(S==null?void 0:S.height,(te=pd[O])==null?void 0:te.height),N=fe=>fe.attr({width:fe.width,height:fe.height}),["width","height"].forEach(fe=>{ce[`${fe}Setter`]=function(Xe,Ue){this[Ue]=Xe;let{alignByTranslate:$e,element:pt,width:tt,height:mt,imgwidth:Bt,imgheight:Yt}=this,ei=Ue==="width"?Bt:Yt,Ft=1;S&&S.backgroundSize==="within"&&tt&&mt&&Bt&&Yt?(Ft=Math.min(tt/Bt,mt/Yt),Jl(pt,{width:Math.round(Bt*Ft),height:Math.round(Yt*Ft)})):pt&&ei&&pt.setAttribute(Ue,ei),!$e&&Bt&&Yt&&this.translate(((tt||0)-Bt*Ft)/2,((mt||0)-Yt*Ft)/2)}}),Va(u)&&ce.attr({x:u,y:p}),ce.isImg=!0,ce.symbolUrl=o,Va(ce.imgwidth)&&Va(ce.imgheight)?N(ce):(ce.attr({width:0,height:0}),gd("img",{onload:function(){let fe=ud[z.chartIndex];this.width===0&&(dl(this,{position:"absolute",top:"-999em"}),qo.body.appendChild(this)),pd[O]={width:this.width,height:this.height},ce.imgwidth=this.width,ce.imgheight=this.height,ce.element&&N(ce),this.parentNode&&this.parentNode.removeChild(this),z.imgCount--,z.imgCount||!fe||fe.hasLoaded||fe.onload()},src:O}),this.imgCount++)}return A}clipRect(o,u,p,x){return this.rect(o,u,p,x,0)}text(o,u,p,x){let v={};if(x&&(this.allowHTML||!this.forExport))return this.html(o,u,p);v.x=Math.round(u||0),p&&(v.y=Math.round(p)),Va(o)&&(v.text=o);let S=this.createElement("text").attr(v);return x&&(!this.forExport||this.allowHTML)||(S.xSetter=function(A,I,O){let N=O.getElementsByTagName("tspan"),z=O.getAttribute(I);for(let j=0,q;j<N.length;j++)(q=N[j]).getAttribute(I)===z&&q.setAttribute(I,A);O.setAttribute(I,A)}),S}fontMetrics(o){let u=Kh(es.prototype.getStyle.call(o,"font-size")||0),p=u<24?u+3:Math.round(1.2*u),x=Math.round(.8*p);return{h:p,b:x,f:u}}rotCorr(o,u,p){let x=o;return u&&p&&(x=Math.max(x*Math.cos(u*pr),4)),{x:-o/3*Math.sin(u*pr),y:x}}pathToSegments(o){let u=[],p=[],x={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let v=0;v<o.length;v++)Wc(p[0])&&To(o[v])&&p.length===x[p[0].toUpperCase()]&&o.splice(v,0,p[0].replace("M","L").replace("m","l")),typeof o[v]=="string"&&(p.length&&u.push(p.slice(0)),p.length=0),p.push(o[v]);return u.push(p.slice(0)),u}label(o,u,p,x,v,S,A,I,O){return new Js(this,o,u,p,x,v,S,A,I,O)}alignElements(){this.alignedObjects.forEach(o=>o.align())}}fl(qc.prototype,{Element:es,SVG_NS:fd,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:$h,draw:ul}),xo.registerRendererType("svg",qc,!0);let{composed:yd,isFirefox:bm}=Ie,{attr:xd,css:Eo,createElement:Xc,defined:vd,extend:bd,getAlignFactor:wm,isNumber:Ql,pInt:Wf,pushUnique:Zc}=xe;function wd(R,o,u){var x;let p=((x=this.div)==null?void 0:x.style)||u.style;es.prototype[`${o}Setter`].call(this,R,o,u),p&&(p[o]=R)}let Qh=(R,o)=>{var u;if(!R.div){let p=xd(R.element,"class"),x=R.css,v=Xc("div",p?{className:p}:void 0,{position:"absolute",left:`${R.translateX||0}px`,top:`${R.translateY||0}px`,...R.styles,display:R.display,opacity:R.opacity,visibility:R.visibility},((u=R.parentGroup)==null?void 0:u.div)||o);R.classSetter=(S,A,I)=>{I.setAttribute("class",S),v.className=S},R.translateXSetter=R.translateYSetter=(S,A)=>{R[A]=S,v.style[A==="translateX"?"left":"top"]=`${S}px`,R.doTransform=!0},R.opacitySetter=R.visibilitySetter=wd,R.css=S=>(x.call(R,S),S.cursor&&(v.style.cursor=S.cursor),S.pointerEvents&&(v.style.pointerEvents=S.pointerEvents),R),R.on=function(){return es.prototype.on.apply({element:v,onEvents:R.onEvents},arguments),R},R.div=v}return R.div};class ml extends es{static compose(o){Zc(yd,this.compose)&&(o.prototype.html=function(u,p,x){return new ml(this,"span").attr({text:u,x:Math.round(p),y:Math.round(x)})})}constructor(o,u){super(o,u),ml.useForeignObject?this.foreignObject=o.createElement("foreignObject").attr({zIndex:2}):this.css({position:"absolute",...o.styledMode?{}:{fontFamily:o.style.fontFamily,fontSize:o.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(o,u,p){this.xCorr=-o*p,this.yCorr=-u}css(o){let u,{element:p}=this,x=p.tagName==="SPAN"&&o&&"width"in o,v=x&&o.width;return x&&(delete o.width,this.textWidth=Wf(v)||void 0,u=!0),(o==null?void 0:o.textOverflow)==="ellipsis"&&(o.overflow="hidden",o.whiteSpace="nowrap"),o!=null&&o.lineClamp&&(o.display="-webkit-box",o.WebkitLineClamp=o.lineClamp,o.WebkitBoxOrient="vertical",o.overflow="hidden"),Ql(Number(o==null?void 0:o.fontSize))&&(o.fontSize+="px"),bd(this.styles,o),Eo(p,o),u&&this.updateTransform(),this}htmlGetBBox(){let{element:o}=this;return{x:o.offsetLeft,y:o.offsetTop,width:o.offsetWidth,height:o.offsetHeight}}updateTransform(){var ce;if(!this.added){this.alignOnAdd=!0;return}let{element:o,foreignObject:u,oldTextWidth:p,renderer:x,rotation:v,rotationOriginX:S,rotationOriginY:A,scaleX:I,scaleY:O,styles:{display:N="inline-block",whiteSpace:z},textAlign:j="left",textWidth:q,translateX:K=0,translateY:se=0,x:re=0,y:te=0}=this;if(u||Eo(o,{marginLeft:`${K}px`,marginTop:`${se}px`}),o.tagName==="SPAN"){let fe,Xe=[v,j,o.innerHTML,q,this.textAlign].join(","),Ue=-(((ce=this.parentGroup)==null?void 0:ce.padding)*1)||0;if(q!==p){let mt=this.textPxLength?this.textPxLength:(Eo(o,{width:"",whiteSpace:z||"nowrap"}),o.offsetWidth),Bt=q||0,Yt=o.style.textOverflow===""&&o.style.webkitLineClamp;(Bt>p||mt>Bt||Yt)&&(/[\-\s\u00AD]/.test(o.textContent||o.innerText)||o.style.textOverflow==="ellipsis")&&(Eo(o,{width:(v||I||mt>Bt||Yt)&&Ql(q)?q+"px":"auto",display:N,whiteSpace:z||"normal"}),this.oldTextWidth=q)}u&&(Eo(o,{display:"inline-block",verticalAlign:"top"}),u.attr({width:x.width,height:x.height})),Xe!==this.cTT&&(fe=x.fontMetrics(o).b,vd(v)&&!u&&(v!==(this.oldRotation||0)||j!==this.oldAlign)&&Eo(o,{transform:`rotate(${v}deg)`,transformOrigin:`${Ue}% ${Ue}px`}),this.getSpanCorrection(!vd(v)&&!this.textWidth&&this.textPxLength||o.offsetWidth,fe,wm(j)));let{xCorr:$e=0,yCorr:pt=0}=this,tt={left:`${re+$e}px`,top:`${te+pt}px`,textAlign:j,transformOrigin:`${(S??re)-$e-re-Ue}px ${(A??te)-pt-te-Ue}px`};(I||O)&&(tt.transform=`scale(${I??1},${O??1})`),u?(super.updateTransform(),Ql(re)&&Ql(te)?(u.attr({x:re+$e,y:te+pt,width:o.offsetWidth+3,height:o.offsetHeight,"transform-origin":o.getAttribute("transform-origin")||"0 0"}),Eo(o,{display:N,textAlign:j})):bm&&u.attr({width:0,height:0})):Eo(o,tt),this.cTT=Xe,this.oldRotation=v,this.oldAlign=j}}add(o){let{foreignObject:u,renderer:p}=this,x=p.box.parentNode,v=[];if(u)u.add(o),super.add(p.createElement("body").attr({xmlns:"http://www.w3.org/1999/xhtml"}).css({background:"transparent",margin:"0 3px 0 0"}).add(u));else{let S;if(this.parentGroup=o,o&&!(S=o.div)){let A=o;for(;A;)v.push(A),A=A.parentGroup;for(let I of v.reverse())S=Qh(I,x)}(S||x).appendChild(this.element)}return this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(o){o!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,Vr.setElementHTML(this.element,o??""),this.textStr=o,this.doTransform=!0)}alignSetter(o){this.alignValue=this.textAlign=o,this.doTransform=!0}xSetter(o,u){this[u]=o,this.doTransform=!0}}let eo=ml.prototype;eo.visibilitySetter=eo.opacitySetter=wd,eo.ySetter=eo.rotationSetter=eo.rotationOriginXSetter=eo.rotationOriginYSetter=eo.xSetter,function(R){R.xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%[HMSL]",range:!1},second:{main:"%[HMS]",range:!1},minute:{main:"%[HM]",range:!1},hour:{main:"%[HM]",range:!1},day:{main:"%[eb]"},week:{main:"%[eb]"},month:{main:"%[bY]"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em",textOverflow:"ellipsis"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},R.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:o}=this.axis.chart;return o(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0}}(V||(V={}));let Tm=V,{addEvent:Em,isFunction:Sm,objectEach:Cm,removeEvent:Am}=xe;(s||(s={})).registerEventOptions=function(R,o){R.eventOptions=R.eventOptions||{},Cm(o.events,function(u,p){R.eventOptions[p]!==u&&(R.eventOptions[p]&&(Am(R,p,R.eventOptions[p]),delete R.eventOptions[p]),Sm(u)&&(R.eventOptions[p]=u,Em(R,p,u,{order:0})))})};let Yc=s,{deg2rad:ec}=Ie,{clamp:tc,correctFloat:Kc,defined:eu,destroyObjectProperties:xa,extend:Jc,fireEvent:fs,getAlignFactor:Qc,isNumber:eh,merge:gl,objectEach:ic,pick:$s}=xe,va=class{constructor(R,o,u,p,x){this.isNew=!0,this.isNewLabel=!0,this.axis=R,this.pos=o,this.type=u||"",this.parameters=x||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,fs(this,"init"),u||p||this.addLabel()}addLabel(){var pt;let R=this,o=R.axis,u=o.options,p=o.chart,x=o.categories,v=o.logarithmic,S=o.names,A=R.pos,I=$s((pt=R.options)==null?void 0:pt.labels,u.labels),O=o.tickPositions,N=A===O[0],z=A===O[O.length-1],j=(!I.step||I.step===1)&&o.tickInterval===1,q=O.info,K=R.label,se,re,te,ce=this.parameters.category||(x?$s(x[A],S[A],A):A);v&&eh(ce)&&(ce=Kc(v.lin2log(ce))),o.dateTime&&(q?se=(re=p.time.resolveDTLFormat(u.dateTimeLabelFormats[!u.grid&&q.higherRanks[A]||q.unitName])).main:eh(ce)&&(se=o.dateTime.getXDateFormat(ce,u.dateTimeLabelFormats||{}))),R.isFirst=N,R.isLast=z;let fe={axis:o,chart:p,dateTimeLabelFormat:se,isFirst:N,isLast:z,pos:A,tick:R,tickPositionInfo:q,value:ce};fs(this,"labelFormat",fe);let Xe=tt=>I.formatter?I.formatter.call(tt,tt):I.format?(tt.text=o.defaultLabelFormatter.call(tt),ds.format(I.format,tt,p)):o.defaultLabelFormatter.call(tt),Ue=Xe.call(fe,fe),$e=re==null?void 0:re.list;$e?R.shortenLabel=function(){for(te=0;te<$e.length;te++)if(Jc(fe,{dateTimeLabelFormat:$e[te]}),K.attr({text:Xe.call(fe,fe)}),K.getBBox().width<o.getSlotWidth(R)-2*(I.padding||0))return;K.attr({text:""})}:R.shortenLabel=void 0,j&&o._addedPlotLB&&R.moveLabel(Ue,I),eu(K)||R.movedLabel?K&&K.textStr!==Ue&&!j&&(!K.textWidth||I.style.width||K.styles.width||K.css({width:null}),K.attr({text:Ue}),K.textPxLength=K.getBBox().width):(R.label=K=R.createLabel(Ue,I),R.rotation=0)}createLabel(R,o,u){let p=this.axis,{renderer:x,styledMode:v}=p.chart,S=o.style.whiteSpace,A=eu(R)&&o.enabled?x.text(R,u==null?void 0:u.x,u==null?void 0:u.y,o.useHTML).add(p.labelGroup):void 0;return A&&(v||A.css(gl(o.style)),A.textPxLength=A.getBBox().width,!v&&S&&A.css({whiteSpace:S})),A}destroy(){xa(this,this.axis)}getPosition(R,o,u,p){let x=this.axis,v=x.chart,S=p&&v.oldChartHeight||v.chartHeight,A={x:R?Kc(x.translate(o+u,void 0,void 0,p)+x.transB):x.left+x.offset+(x.opposite?(p&&v.oldChartWidth||v.chartWidth)-x.right-x.left:0),y:R?S-x.bottom+x.offset-(x.opposite?x.height:0):Kc(S-x.translate(o+u,void 0,void 0,p)-x.transB)};return A.y=tc(A.y,-1e9,1e9),fs(this,"afterGetPosition",{pos:A}),A}getLabelPosition(R,o,u,p,x,v,S,A){let I,O,N=this.axis,z=N.transA,j=N.isLinked&&N.linkedParent?N.linkedParent.reversed:N.reversed,q=N.staggerLines,K=N.tickRotCorr||{x:0,y:0},se=p||N.reserveSpaceDefault?0:-N.labelOffset*(N.labelAlign==="center"?.5:1),re=x.distance,te={};return I=N.side===0?u.rotation?-re:-u.getBBox().height:N.side===2?K.y+re:Math.cos(u.rotation*ec)*(K.y-u.getBBox(!1,0).height/2),eu(x.y)&&(I=N.side===0&&N.horiz?x.y+I:x.y),R=R+$s(x.x,[0,1,0,-1][N.side]*re)+se+K.x-(v&&p?v*z*(j?-1:1):0),o=o+I-(v&&!p?v*z*(j?1:-1):0),q&&(O=S/(A||1)%q,N.opposite&&(O=q-O-1),o+=O*(N.labelOffset/q)),te.x=R,te.y=Math.round(o),fs(this,"afterGetLabelPosition",{pos:te,tickmarkOffset:v,index:S}),te}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(R,o,u,p,x=!1,v){return v.crispLine([["M",R,o],["L",R+(x?0:-u),o+(x?u:0)]],p)}handleOverflow(R){var re;let o=this.axis,u=o.options.labels,p=R.x,x=o.chart.chartWidth,v=o.chart.spacing,S=$s(o.labelLeft,Math.min(o.pos,v[3])),A=$s(o.labelRight,Math.max(o.isRadial?0:o.pos+o.len,x-v[1])),I=this.label,O=this.rotation,N=Qc(o.labelAlign||I.attr("align")),z=I.getBBox().width,j=o.getSlotWidth(this),q=j,K=1,se;O||u.overflow!=="justify"?O<0&&p-N*z<S?se=Math.round(p/Math.cos(O*ec)-S):O>0&&p+N*z>A&&(se=Math.round((x-p)/Math.cos(O*ec))):(p-N*z<S?q=R.x+q*(1-N)-S:p+(1-N)*z>A&&(q=A-R.x+q*N,K=-1),(q=Math.min(j,q))<j&&o.labelAlign==="center"&&(R.x+=K*(j-q-N*(j-Math.min(z,q)))),(z>q||o.autoRotation&&((re=I==null?void 0:I.styles)!=null&&re.width))&&(se=q)),se&&I&&(this.shortenLabel?this.shortenLabel():I.css(Jc({},{width:Math.floor(se)+"px",lineClamp:+!o.isRadial})))}moveLabel(R,o){let u=this,p=u.label,x=u.axis,v=!1,S;p&&p.textStr===R?(u.movedLabel=p,v=!0,delete u.label):ic(x.ticks,function(A){v||A.isNew||A===u||!A.label||A.label.textStr!==R||(u.movedLabel=A.label,v=!0,A.labelPos=u.movedLabel.xy,delete A.label)}),!v&&(u.labelPos||p)&&(S=u.labelPos||p.xy,u.movedLabel=u.createLabel(R,o,S),u.movedLabel&&u.movedLabel.attr({opacity:0}))}render(R,o,u){var K;let p=this.axis,x=p.horiz,v=this.pos,S=$s(this.tickmarkOffset,p.tickmarkOffset),A=this.getPosition(x,v,S,o),I=A.x,O=A.y,N=p.pos,z=N+p.len,j=x?I:O,q=$s(u,(K=this.label)==null?void 0:K.newOpacity,1);!p.chart.polar&&(Kc(j)<N||j>z)&&(u=0),u??(u=1),this.isActive=!0,this.renderGridLine(o,u),this.renderMark(A,u),this.renderLabel(A,o,q,R),this.isNew=!1,fs(this,"afterRender")}renderGridLine(R,o){let u=this.axis,p=u.options,x={},v=this.pos,S=this.type,A=$s(this.tickmarkOffset,u.tickmarkOffset),I=u.chart.renderer,O=this.gridLine,N,z=p.gridLineWidth,j=p.gridLineColor,q=p.gridLineDashStyle;this.type==="minor"&&(z=p.minorGridLineWidth,j=p.minorGridLineColor,q=p.minorGridLineDashStyle),O||(u.chart.styledMode||(x.stroke=j,x["stroke-width"]=z||0,x.dashstyle=q),S||(x.zIndex=1),R&&(o=0),this.gridLine=O=I.path().attr(x).addClass("highcharts-"+(S?S+"-":"")+"grid-line").add(u.gridGroup)),O&&(N=u.getPlotLinePath({value:v+A,lineWidth:O.strokeWidth(),force:"pass",old:R,acrossPanes:!1}))&&O[R||this.isNew?"attr":"animate"]({d:N,opacity:o})}renderMark(R,o){let u=this.axis,p=u.options,x=u.chart.renderer,v=this.type,S=u.tickSize(v?v+"Tick":"tick"),A=R.x,I=R.y,O=$s(p[v!=="minor"?"tickWidth":"minorTickWidth"],!v&&u.isXAxis?1:0),N=p[v!=="minor"?"tickColor":"minorTickColor"],z=this.mark,j=!z;S&&(u.opposite&&(S[0]=-S[0]),z||(this.mark=z=x.path().addClass("highcharts-"+(v?v+"-":"")+"tick").add(u.axisGroup),u.chart.styledMode||z.attr({stroke:N,"stroke-width":O})),z[j?"attr":"animate"]({d:this.getMarkPath(A,I,S[0],z.strokeWidth(),u.horiz,x),opacity:o}))}renderLabel(R,o,u,p){let x=this.axis,v=x.horiz,S=x.options,A=this.label,I=S.labels,O=I.step,N=$s(this.tickmarkOffset,x.tickmarkOffset),z=R.x,j=R.y,q=!0;A&&eh(z)&&(A.xy=R=this.getLabelPosition(z,j,A,v,I,N,p,O),(!this.isFirst||this.isLast||S.showFirstLabel)&&(!this.isLast||this.isFirst||S.showLastLabel)?!v||I.step||I.rotation||o||u===0||this.handleOverflow(R):q=!1,O&&p%O&&(q=!1),q&&eh(R.y)?(R.opacity=u,A[this.isNewLabel?"attr":"animate"](R).show(!0),this.isNewLabel=!1):(A.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let R=this.label,o=this.axis;R&&!this.isNew&&(R.animate({opacity:0},void 0,R.destroy),delete this.label),o.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}},{animObject:xr}=En,{xAxis:rc,yAxis:Hf}=Tm,{defaultOptions:nc}=Le,{registerEventOptions:sc}=Yc,{deg2rad:qf}=Ie,{arrayMax:th,arrayMin:ba,clamp:tu,correctFloat:ps,defined:Cr,destroyObjectProperties:oc,erase:iu,error:_l,extend:ja,fireEvent:Xr,getClosestDistance:ih,insertItem:ui,isArray:to,isNumber:Bi,isString:ac,merge:$a,normalizeTickInterval:ts,objectEach:Ga,pick:ir,relativeLength:lc,removeEvent:ru,splat:Xf,syncTimeout:nu}=xe,yl=(R,o)=>ts(o,void 0,void 0,ir(R.options.allowDecimals,o<.5||R.tickAmount!==void 0),!!R.tickAmount);ja(nc,{xAxis:rc,yAxis:$a(rc,Hf)});class Wa{constructor(o,u,p){this.init(o,u,p)}init(o,u,p=this.coll){let x=p==="xAxis",v=this.isZAxis||(o.inverted?!x:x);this.chart=o,this.horiz=v,this.isXAxis=x,this.coll=p,Xr(this,"init",{userOptions:u}),this.opposite=ir(u.opposite,this.opposite),this.side=ir(u.side,this.side,v?2*!this.opposite:this.opposite?1:3),this.setOptions(u);let S=this.options,A=S.labels;this.type??(this.type=S.type||"linear"),this.uniqueNames??(this.uniqueNames=S.uniqueNames??!0),Xr(this,"afterSetType"),this.userOptions=u,this.minPixelPadding=0,this.reversed=ir(S.reversed,this.reversed),this.visible=S.visible,this.zoomEnabled=S.zoomEnabled,this.hasNames=this.type==="category"||S.categories===!0,this.categories=to(S.categories)&&S.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=Cr(S.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=S.minRange||S.maxZoom,this.range=S.range,this.offset=S.offset||0,this.max=void 0,this.min=void 0;let I=ir(S.crosshair,Xf(o.options.tooltip.crosshairs)[+!x]);this.crosshair=I===!0?{}:I,o.axes.indexOf(this)===-1&&(x?o.axes.splice(o.xAxis.length,0,this):o.axes.push(this),ui(this,o[this.coll])),o.orderItems(this.coll),this.series=this.series||[],o.inverted&&!this.isZAxis&&x&&!Cr(this.reversed)&&(this.reversed=!0),this.labelRotation=Bi(A.rotation)?A.rotation:void 0,sc(this,S),Xr(this,"afterInit")}setOptions(o){let u=this.horiz?{labels:{autoRotation:[-45],padding:3},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=$a(u,this.coll==="yAxis"?{title:{text:this.chart.options.lang.yAxisTitle}}:{},nc[this.coll],o),Xr(this,"afterSetOptions",{userOptions:o})}defaultLabelFormatter(){let o=this.axis,{numberFormatter:u}=this.chart,p=Bi(this.value)?this.value:NaN,x=o.chart.time,v=o.categories,S=this.dateTimeLabelFormat,A=nc.lang,I=A.numericSymbols,O=A.numericSymbolMagnitude||1e3,N=o.logarithmic?Math.abs(p):o.tickInterval,z=I==null?void 0:I.length,j,q;if(v)q=`${this.value}`;else if(S)q=x.dateFormat(S,p,!0);else if(z&&I&&N>=1e3)for(;z--&&q===void 0;)N>=(j=Math.pow(O,z+1))&&10*p%j==0&&I[z]!==null&&p!==0&&(q=u(p/j,-1)+I[z]);return q===void 0&&(q=Math.abs(p)>=1e4?u(p,-1):u(p,-1,void 0,"")),q}getSeriesExtremes(){let o,u=this;Xr(this,"getSeriesExtremes",null,function(){u.hasVisibleSeries=!1,u.dataMin=u.dataMax=u.threshold=void 0,u.softThreshold=!u.isXAxis,u.series.forEach(p=>{if(p.reserveSpace()){let x=p.options,v,S=x.threshold,A,I;if(u.hasVisibleSeries=!0,u.positiveValuesOnly&&0>=(S||0)&&(S=void 0),u.isXAxis)(v=p.getColumn("x")).length&&(v=u.logarithmic?v.filter(O=>O>0):v,A=(o=p.getXExtremes(v)).min,I=o.max,Bi(A)||A instanceof Date||(v=v.filter(Bi),A=(o=p.getXExtremes(v)).min,I=o.max),v.length&&(u.dataMin=Math.min(ir(u.dataMin,A),A),u.dataMax=Math.max(ir(u.dataMax,I),I)));else{let O=p.applyExtremes();Bi(O.dataMin)&&(A=O.dataMin,u.dataMin=Math.min(ir(u.dataMin,A),A)),Bi(O.dataMax)&&(I=O.dataMax,u.dataMax=Math.max(ir(u.dataMax,I),I)),Cr(S)&&(u.threshold=S),(!x.softThreshold||u.positiveValuesOnly)&&(u.softThreshold=!1)}}})}),Xr(this,"afterGetSeriesExtremes")}translate(o,u,p,x,v,S){var se;let A=this.linkedParent||this,I=x&&A.old?A.old.min:A.min;if(!Bi(I))return NaN;let O=A.minPixelPadding,N=(A.isOrdinal||((se=A.brokenAxis)==null?void 0:se.hasBreaks)||A.logarithmic&&v)&&A.lin2val,z=1,j=0,q=x&&A.old?A.old.transA:A.transA,K=0;return q||(q=A.transA),p&&(z*=-1,j=A.len),A.reversed&&(z*=-1,j-=z*(A.sector||A.len)),u?(K=(o=o*z+j-O)/q+I,N&&(K=A.lin2val(K))):(N&&(o=A.val2lin(o)),K=z*(o-I)*q+j+z*O+(Bi(S)?q*S:0),A.isRadial||(K=ps(K))),K}toPixels(o,u){var p;return this.translate(((p=this.chart)==null?void 0:p.time.parse(o))??NaN,!1,!this.horiz,void 0,!0)+(u?0:this.pos)}toValue(o,u){return this.translate(o-(u?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(o){let u=this,p=u.chart,x=u.left,v=u.top,S=o.old,A=o.value,I=o.lineWidth,O=S&&p.oldChartHeight||p.chartHeight,N=S&&p.oldChartWidth||p.chartWidth,z=u.transB,j=o.translatedValue,q=o.force,K,se,re,te,ce;function fe(Ue,$e,pt){return q!=="pass"&&(Ue<$e||Ue>pt)&&(q?Ue=tu(Ue,$e,pt):ce=!0),Ue}let Xe={value:A,lineWidth:I,old:S,force:q,acrossPanes:o.acrossPanes,translatedValue:j};return Xr(this,"getPlotLinePath",Xe,function(Ue){K=re=(j=tu(j=ir(j,u.translate(A,void 0,void 0,S)),-1e9,1e9))+z,se=te=O-j-z,Bi(j)?u.horiz?(se=v,te=O-u.bottom+(u.options.isInternal?0:p.scrollablePixelsY||0),K=re=fe(K,x,x+u.width)):(K=x,re=N-u.right+(p.scrollablePixelsX||0),se=te=fe(se,v,v+u.height)):(ce=!0,q=!1),Ue.path=ce&&!q?void 0:p.renderer.crispLine([["M",K,se],["L",re,te]],I||1)}),Xe.path}getLinearTickPositions(o,u,p){let x,v,S,A=ps(Math.floor(u/o)*o),I=ps(Math.ceil(p/o)*o),O=[];if(ps(A+o)===A&&(S=20),this.single)return[u];for(x=A;x<=I&&(O.push(x),(x=ps(x+o,S))!==v);)v=x;return O}getMinorTickInterval(){let{minorTicks:o,minorTickInterval:u}=this.options;return o===!0?ir(u,"auto"):o!==!1?u:void 0}getMinorTickPositions(){var N;let o=this.options,u=this.tickPositions,p=this.minorTickInterval,x=this.pointRangePadding||0,v=(this.min||0)-x,S=(this.max||0)+x,A=(N=this.brokenAxis)!=null&&N.hasBreaks?this.brokenAxis.unitLength:S-v,I=[],O;if(A&&A/p<this.len/3){let z=this.logarithmic;if(z)this.paddedTicks.forEach(function(j,q,K){q&&I.push.apply(I,z.getLogTickPositions(p,K[q-1],K[q],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")I=I.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(p),v,S,o.startOfWeek));else for(O=v+(u[0]-v)%p;O<=S&&O!==I[0];O+=p)I.push(O)}return I.length!==0&&this.trimTicks(I),I}adjustForMinRange(){let o=this.options,u=this.logarithmic,p=this.chart.time,{max:x,min:v,minRange:S}=this,A,I,O,N;this.isXAxis&&S===void 0&&!u&&(S=Cr(o.min)||Cr(o.max)||Cr(o.floor)||Cr(o.ceiling)?null:Math.min(5*(ih(this.series.map(z=>{let j=z.getColumn("x");return z.xIncrement?j.slice(0,2):j}))||0),this.dataMax-this.dataMin)),Bi(x)&&Bi(v)&&Bi(S)&&x-v<S&&(I=this.dataMax-this.dataMin>=S,A=(S-x+v)/2,O=[v-A,p.parse(o.min)??v-A],I&&(O[2]=u?u.log2lin(this.dataMin):this.dataMin),N=[(v=th(O))+S,p.parse(o.max)??v+S],I&&(N[2]=u?u.log2lin(this.dataMax):this.dataMax),(x=ba(N))-v<S&&(O[0]=x-S,O[1]=p.parse(o.min)??x-S,v=th(O))),this.minRange=S,this.min=v,this.max=x}getClosest(){let o,u;if(this.categories)u=1;else{let p=[];this.series.forEach(function(x){let v=x.closestPointRange,S=x.getColumn("x");S.length===1?p.push(S[0]):x.sorted&&Cr(v)&&x.reserveSpace()&&(u=Cr(u)?Math.min(u,v):v)}),p.length&&(p.sort((x,v)=>x-v),o=ih([p]))}return o&&u?Math.min(o,u):o||u}nameToX(o){let u=to(this.options.categories),p=u?this.categories:this.names,x=o.options.x,v;return o.series.requireSorting=!1,Cr(x)||(x=this.uniqueNames&&p?u?p.indexOf(o.name):ir(p.keys[o.name],-1):o.series.autoIncrement()),x===-1?!u&&p&&(v=p.length):Bi(x)&&(v=x),v!==void 0?(this.names[v]=o.name,this.names.keys[o.name]=v):o.x&&(v=o.x),v}updateNames(){let o=this,u=this.names;u.length>0&&(Object.keys(u.keys).forEach(function(p){delete u.keys[p]}),u.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(p=>{p.xIncrement=null,(!p.points||p.isDirtyData)&&(o.max=Math.max(o.max||0,p.dataTable.rowCount-1),p.processData(),p.generatePoints());let x=p.getColumn("x").slice();p.data.forEach((v,S)=>{let A=x[S];v!=null&&v.options&&v.name!==void 0&&(A=o.nameToX(v))!==void 0&&A!==v.x&&(x[S]=v.x=A)}),p.dataTable.setColumn("x",x)}))}setAxisTranslation(){var j;let o=this,u=o.max-o.min,p=o.linkedParent,x=!!o.categories,v=o.isXAxis,S=o.axisPointRange||0,A,I=0,O=0,N,z=o.transA;(v||x||S)&&(A=o.getClosest(),p?(I=p.minPointOffset,O=p.pointRangePadding):o.series.forEach(function(q){let K=x?1:v?ir(q.options.pointRange,A,0):o.axisPointRange||0,se=q.options.pointPlacement;if(S=Math.max(S,K),!o.single||x){let re=q.is("xrange")?!v:v;I=Math.max(I,re&&ac(se)?0:K/2),O=Math.max(O,re&&se==="on"?0:K)}}),N=(j=o.ordinal)!=null&&j.slope&&A?o.ordinal.slope/A:1,o.minPointOffset=I*=N,o.pointRangePadding=O*=N,o.pointRange=Math.min(S,o.single&&x?1:u),v&&(o.closestPointRange=A)),o.translationSlope=o.transA=z=o.staticScale||o.len/(u+O||1),o.transB=o.horiz?o.left:o.bottom,o.minPixelPadding=z*I,Xr(this,"afterSetAxisTranslation")}minFromRange(){let{max:o,min:u}=this;return Bi(o)&&Bi(u)&&o-u||void 0}setTickInterval(o){var mi,Ni,bi,Vi;let{categories:u,chart:p,dataMax:x,dataMin:v,dateTime:S,isXAxis:A,logarithmic:I,options:O,softThreshold:N}=this,z=p.time,j=Bi(this.threshold)?this.threshold:void 0,q=this.minRange||0,{ceiling:K,floor:se,linkedTo:re,softMax:te,softMin:ce}=O,fe=Bi(re)&&((mi=p[this.coll])==null?void 0:mi[re]),Xe=O.tickPixelInterval,Ue=O.maxPadding,$e=O.minPadding,pt=0,tt,mt=Bi(O.tickInterval)&&O.tickInterval>=0?O.tickInterval:void 0,Bt,Yt,ei,Ft;if(S||u||fe||this.getTickAmount(),ei=ir(this.userMin,z.parse(O.min)),Ft=ir(this.userMax,z.parse(O.max)),fe?(this.linkedParent=fe,tt=fe.getExtremes(),this.min=ir(tt.min,tt.dataMin),this.max=ir(tt.max,tt.dataMax),this.type!==fe.type&&_l(11,!0,p)):(N&&Cr(j)&&Bi(x)&&Bi(v)&&(v>=j?(Bt=j,$e=0):x<=j&&(Yt=j,Ue=0)),this.min=ir(ei,Bt,v),this.max=ir(Ft,Yt,x)),Bi(this.max)&&Bi(this.min)&&(I&&(this.positiveValuesOnly&&!o&&0>=Math.min(this.min,ir(v,this.min))&&_l(10,!0,p),this.min=ps(I.log2lin(this.min),16),this.max=ps(I.log2lin(this.max),16)),this.range&&Bi(v)&&(this.userMin=this.min=ei=Math.max(v,this.minFromRange()||0),this.userMax=Ft=this.max,this.range=void 0)),Xr(this,"foundExtremes"),this.adjustForMinRange(),Bi(this.min)&&Bi(this.max)){if(!Bi(this.userMin)&&Bi(ce)&&ce<this.min&&(this.min=ei=ce),!Bi(this.userMax)&&Bi(te)&&te>this.max&&(this.max=Ft=te),u||this.axisPointRange||(Ni=this.stacking)!=null&&Ni.usePercentage||fe||!(pt=this.max-this.min)||(!Cr(ei)&&$e&&(this.min-=pt*$e),Cr(Ft)||!Ue||(this.max+=pt*Ue)),!Bi(this.userMin)&&Bi(se)&&(this.min=Math.max(this.min,se)),!Bi(this.userMax)&&Bi(K)&&(this.max=Math.min(this.max,K)),N&&Bi(v)&&Bi(x)){let gr=j||0;!Cr(ei)&&this.min<gr&&v>=gr?this.min=O.minRange?Math.min(gr,this.max-q):gr:!Cr(Ft)&&this.max>gr&&x<=gr&&(this.max=O.minRange?Math.max(gr,this.min+q):gr)}!p.polar&&this.min>this.max&&(Cr(O.min)?this.max=this.min:Cr(O.max)&&(this.min=this.max)),pt=this.max-this.min}if(this.min!==this.max&&Bi(this.min)&&Bi(this.max)?fe&&!mt&&Xe===fe.options.tickPixelInterval?this.tickInterval=mt=fe.tickInterval:this.tickInterval=ir(mt,this.tickAmount?pt/Math.max(this.tickAmount-1,1):void 0,u?1:pt*Xe/Math.max(this.len,Xe)):this.tickInterval=1,A&&!o){let gr=this.min!==((bi=this.old)==null?void 0:bi.min)||this.max!==((Vi=this.old)==null?void 0:Vi.max);this.series.forEach(function(ar){var vr;ar.forceCrop=(vr=ar.forceCropping)==null?void 0:vr.call(ar),ar.processData(gr)}),Xr(this,"postProcessData",{hasExtremesChanged:gr})}this.setAxisTranslation(),Xr(this,"initialAxisTranslation"),this.pointRange&&!mt&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let ci=ir(O.minTickInterval,S&&!this.series.some(gr=>!gr.sorted)?this.closestPointRange:0);!mt&&ci&&this.tickInterval<ci&&(this.tickInterval=ci),S||I||mt||(this.tickInterval=yl(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){var N,z;let o=this.options,u=o.tickPositions,p=o.tickPositioner,x=this.getMinorTickInterval(),v=!this.isPanning,S=v&&o.startOnTick,A=v&&o.endOnTick,I=[],O;if(this.tickmarkOffset=this.categories&&o.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.single=this.min===this.max&&Cr(this.min)&&!this.tickAmount&&(this.min%1==0||o.allowDecimals!==!1),u)I=u.slice();else if(Bi(this.min)&&Bi(this.max)){if(!((N=this.ordinal)!=null&&N.positions)&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))I=[this.min,this.max],_l(19,!1,this.chart);else if(this.dateTime)I=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,o.units),this.min,this.max,o.startOfWeek,(z=this.ordinal)==null?void 0:z.positions,this.closestPointRange,!0);else if(this.logarithmic)I=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let j=this.tickInterval,q=j;for(;q<=2*j&&(I=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&I.length>this.tickAmount);)this.tickInterval=yl(this,q*=1.1)}I.length>this.len&&(I=[I[0],I[I.length-1]])[0]===I[1]&&(I.length=1),p&&(this.tickPositions=I,(O=p.apply(this,[this.min,this.max]))&&(I=O))}this.tickPositions=I,this.minorTickInterval=x==="auto"&&this.tickInterval?this.tickInterval/o.minorTicksPerMajor:x,this.paddedTicks=I.slice(0),this.trimTicks(I,S,A),!this.isLinked&&Bi(this.min)&&Bi(this.max)&&(this.single&&I.length<2&&!this.categories&&!this.series.some(j=>j.is("heatmap")&&j.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),u||O||this.adjustTickAmount()),Xr(this,"afterSetTickPositions")}trimTicks(o,u,p){let x=o[0],v=o[o.length-1],S=!this.isOrdinal&&this.minPointOffset||0;if(Xr(this,"trimTicks"),!this.isLinked||!this.grid){if(u&&x!==-1/0)this.min=x;else for(;this.min-S>o[0];)o.shift();if(p)this.max=v;else for(;this.max+S<o[o.length-1];)o.pop();o.length===0&&Cr(x)&&!this.options.tickPositions&&o.push((v+x)/2)}}alignToOthers(){let o,u=this,p=u.chart,x=[this],v=u.options,S=p.options.chart,A=this.coll==="yAxis"&&S.alignThresholds,I=[];if(u.thresholdAlignment=void 0,(S.alignTicks!==!1&&v.alignTicks||A)&&v.startOnTick!==!1&&v.endOnTick!==!1&&!u.logarithmic){let O=z=>{let{horiz:j,options:q}=z;return[j?q.left:q.top,q.width,q.height,q.pane].join(",")},N=O(this);p[this.coll].forEach(function(z){let{series:j}=z;j.length&&j.some(q=>q.visible)&&z!==u&&O(z)===N&&(o=!0,x.push(z))})}if(o&&A){x.forEach(N=>{let z=N.getThresholdAlignment(u);Bi(z)&&I.push(z)});let O=I.length>1?I.reduce((N,z)=>N+=z,0)/I.length:void 0;x.forEach(N=>{N.thresholdAlignment=O})}return o}getThresholdAlignment(o){if((!Bi(this.dataMin)||this!==o&&this.series.some(u=>u.isDirty||u.isDirtyData))&&this.getSeriesExtremes(),Bi(this.threshold)){let u=tu((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(u=1-u),u}}getTickAmount(){let o=this.options,u=o.tickPixelInterval,p=o.tickAmount;Cr(o.tickInterval)||p||!(this.len<u)||this.isRadial||this.logarithmic||!o.startOnTick||!o.endOnTick||(p=2),!p&&this.alignToOthers()&&(p=Math.ceil(this.len/u)+1),p<4&&(this.finalTickAmt=p,p=5),this.tickAmount=p}adjustTickAmount(){let o=this,{finalTickAmt:u,max:p,min:x,options:v,tickPositions:S,tickAmount:A,thresholdAlignment:I}=o,O=S==null?void 0:S.length,N=ir(o.threshold,o.softThreshold?0:null),z,j,q=o.tickInterval,K,se=()=>S.push(ps(S[S.length-1]+q)),re=()=>S.unshift(ps(S[0]-q));if(Bi(I)&&(K=I<.5?Math.ceil(I*(A-1)):Math.floor(I*(A-1)),v.reversed&&(K=A-1-K)),o.hasData()&&Bi(x)&&Bi(p)){let te=()=>{o.transA*=(O-1)/(A-1),o.min=v.startOnTick?S[0]:Math.min(x,S[0]),o.max=v.endOnTick?S[S.length-1]:Math.max(p,S[S.length-1])};if(Bi(K)&&Bi(o.threshold)){for(;S[K]!==N||S.length!==A||S[0]>x||S[S.length-1]<p;){for(S.length=0,S.push(o.threshold);S.length<A;)S[K]===void 0||S[K]>o.threshold?re():se();if(q>8*o.tickInterval)break;q*=2}te()}else if(O<A){for(;S.length<A;)S.length%2||x===N?se():re();te()}if(Cr(u)){for(j=z=S.length;j--;)(u===3&&j%2==1||u<=2&&j>0&&j<z-1)&&S.splice(j,1);o.finalTickAmt=void 0}}}setScale(){var S,A,I,O,N;let{coll:o,stacking:u}=this,p=!1,x=!1;this.series.forEach(z=>{var j;p=p||z.isDirtyData||z.isDirty,x=x||((j=z.xAxis)==null?void 0:j.isDirty)||!1}),this.setAxisSize();let v=this.len!==((S=this.old)==null?void 0:S.len);v||p||x||this.isLinked||this.forceRedraw||this.userMin!==((A=this.old)==null?void 0:A.userMin)||this.userMax!==((I=this.old)==null?void 0:I.userMax)||this.alignToOthers()?(u&&o==="yAxis"&&u.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),u&&o==="xAxis"&&u.buildStacks(),this.isDirty||(this.isDirty=v||this.min!==((O=this.old)==null?void 0:O.min)||this.max!==((N=this.old)==null?void 0:N.max))):u&&u.cleanStacks(),p&&delete this.allExtremes,Xr(this,"afterSetScale")}setExtremes(o,u,p=!0,x,v){let S=this.chart;this.series.forEach(A=>{delete A.kdTree}),o=S.time.parse(o),u=S.time.parse(u),Xr(this,"setExtremes",v=ja(v,{min:o,max:u}),A=>{this.userMin=A.min,this.userMax=A.max,this.eventArgs=A,p&&S.redraw(x)})}setAxisSize(){let o=this.chart,u=this.options,p=u.offsets||[0,0,0,0],x=this.horiz,v=this.width=Math.round(lc(ir(u.width,o.plotWidth-p[3]+p[1]),o.plotWidth)),S=this.height=Math.round(lc(ir(u.height,o.plotHeight-p[0]+p[2]),o.plotHeight)),A=this.top=Math.round(lc(ir(u.top,o.plotTop+p[0]),o.plotHeight,o.plotTop)),I=this.left=Math.round(lc(ir(u.left,o.plotLeft+p[3]),o.plotWidth,o.plotLeft));this.bottom=o.chartHeight-S-A,this.right=o.chartWidth-v-I,this.len=Math.max(x?v:S,0),this.pos=x?I:A}getExtremes(){let o=this.logarithmic;return{min:o?ps(o.lin2log(this.min)):this.min,max:o?ps(o.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(o){let u=this.logarithmic,p=u?u.lin2log(this.min):this.min,x=u?u.lin2log(this.max):this.max;return o===null||o===-1/0?o=p:o===1/0?o=x:p>o?o=p:x<o&&(o=x),this.translate(o,0,1,0,1)}autoLabelAlign(o){let u=(ir(o,0)-90*this.side+720)%360,p={align:"center"};return Xr(this,"autoLabelAlign",p,function(x){u>15&&u<165?x.align="right":u>195&&u<345&&(x.align="left")}),p.align}tickSize(o){let u=this.options,p=ir(u[o==="tick"?"tickWidth":"minorTickWidth"],o==="tick"&&this.isXAxis&&!this.categories?1:0),x=u[o==="tick"?"tickLength":"minorTickLength"],v;p&&x&&(u[o+"Position"]==="inside"&&(x=-x),v=[x,p]);let S={tickSize:v};return Xr(this,"afterTickSize",S),S.tickSize}labelMetrics(){let o=this.chart.renderer,u=this.ticks,p=u[Object.keys(u)[0]]||{};return this.chart.renderer.fontMetrics(p.label||p.movedLabel||o.box)}unsquish(){let o=this.options.labels,u=o.padding||0,p=this.horiz,x=this.tickInterval,v=this.len/((+!!this.categories+this.max-this.min)/x),S=o.rotation,A=ps(.8*this.labelMetrics().h),I=Math.max(this.max-this.min,0),O=function(K){let se=(K+2*u)/(v||1);return(se=se>1?Math.ceil(se):1)*x>I&&K!==1/0&&v!==1/0&&I&&(se=Math.ceil(I/x)),ps(se*x)},N=x,z,j=Number.MAX_VALUE,q;if(p){if(!o.staggerLines&&(Bi(S)?q=[S]:v<o.autoRotationLimit&&(q=o.autoRotation)),q){let K,se;for(let re of q)(re===S||re&&re>=-90&&re<=90)&&(se=(K=O(Math.abs(A/Math.sin(qf*re))))+Math.abs(re/360))<j&&(j=se,z=re,N=K)}}else N=O(.75*A);return this.autoRotation=q,this.labelRotation=ir(z,Bi(S)?S:0),o.step?x:N}getSlotWidth(o){let u=this.chart,p=this.horiz,x=this.options.labels,v=Math.max(this.tickPositions.length-+!this.categories,1),S=u.margin[3];if(o&&Bi(o.slotWidth))return o.slotWidth;if(p&&x.step<2&&!this.isRadial)return x.rotation?0:(this.staggerLines||1)*this.len/v;if(!p){let A=x.style.width;if(A!==void 0)return parseInt(String(A),10);if(S)return S-u.spacing[3]}return .33*u.chartWidth}renderUnsquish(){let o=this.chart,u=o.renderer,p=this.tickPositions,x=this.ticks,v=this.options.labels,S=v.style,A=this.horiz,I=this.getSlotWidth(),O=Math.max(1,Math.round(I-(A?2*(v.padding||0):v.distance||0))),N={},z=this.labelMetrics(),j=S.lineClamp,q,K=j??(Math.floor(this.len/(p.length*z.h))||1),se=0;ac(v.rotation)||(N.rotation=v.rotation||0),p.forEach(function(re){var fe;let te=x[re];te.movedLabel&&te.replaceMovedLabel();let ce=((fe=te.label)==null?void 0:fe.textPxLength)||0;ce>se&&(se=ce)}),this.maxLabelLength=se,this.autoRotation?se>O&&se>z.h?N.rotation=this.labelRotation:this.labelRotation=0:I&&(q=O),N.rotation&&(q=se>.5*o.chartHeight?.33*o.chartHeight:se,j||(K=1)),this.labelAlign=v.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(N.align=this.labelAlign),p.forEach(function(re){let te=x[re],ce=te==null?void 0:te.label,fe=S.width,Xe={};ce&&(ce.attr(N),te.shortenLabel?te.shortenLabel():q&&!fe&&S.whiteSpace!=="nowrap"&&(q<(ce.textPxLength||0)||ce.element.tagName==="SPAN")?ce.css(ja(Xe,{width:`${q}px`,lineClamp:K})):!ce.styles.width||Xe.width||fe||ce.css({width:"auto"}),te.rotation=N.rotation)},this),this.tickRotCorr=u.rotCorr(z.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(o){return o.hasData()})||this.options.showEmpty&&Cr(this.min)&&Cr(this.max)}addTitle(o){let u,p=this.chart.renderer,x=this.horiz,v=this.opposite,S=this.options.title,A=this.chart.styledMode;this.axisTitle||((u=S.textAlign)||(u=(x?{low:"left",middle:"center",high:"right"}:{low:v?"right":"left",middle:"center",high:v?"left":"right"})[S.align]),this.axisTitle=p.text(S.text||"",0,0,S.useHTML).attr({zIndex:7,rotation:S.rotation||0,align:u}).addClass("highcharts-axis-title"),A||this.axisTitle.css($a(S.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),A||S.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[o?"show":"hide"](o)}generateTick(o){let u=this.ticks;u[o]?u[o].addLabel():u[o]=new va(this,o)}createGroups(){let{axisParent:o,chart:u,coll:p,options:x}=this,v=u.renderer,S=(A,I,O)=>v.g(A).attr({zIndex:O}).addClass(`highcharts-${p.toLowerCase()}${I} `+(this.isRadial?`highcharts-radial-axis${I} `:"")+(x.className||"")).add(o);this.axisGroup||(this.gridGroup=S("grid","-grid",x.gridZIndex),this.axisGroup=S("axis","",x.zIndex),this.labelGroup=S("axis-labels","-labels",x.labels.zIndex))}getOffset(){let o=this,{chart:u,horiz:p,options:x,side:v,ticks:S,tickPositions:A,coll:I}=o,O=u.inverted&&!o.isZAxis?[1,0,3,2][v]:v,N=o.hasData(),z=x.title,j=x.labels,q=Bi(x.crossing),K=u.axisOffset,se=u.clipOffset,re=[-1,1,1,-1][v],te,ce=0,fe,Xe=0,Ue=0,$e,pt;if(o.showAxis=te=N||x.showEmpty,o.staggerLines=o.horiz&&j.staggerLines||void 0,o.createGroups(),N||o.isLinked?(A.forEach(function(tt){o.generateTick(tt)}),o.renderUnsquish(),o.reserveSpaceDefault=v===0||v===2||{1:"left",3:"right"}[v]===o.labelAlign,ir(j.reserveSpace,!q&&null,o.labelAlign==="center"||null,o.reserveSpaceDefault)&&A.forEach(function(tt){Ue=Math.max(S[tt].getLabelSize(),Ue)}),o.staggerLines&&(Ue*=o.staggerLines),o.labelOffset=Ue*(o.opposite?-1:1)):Ga(S,function(tt,mt){tt.destroy(),delete S[mt]}),z!=null&&z.text&&z.enabled!==!1&&(o.addTitle(te),te&&!q&&z.reserveSpace!==!1&&(o.titleOffset=ce=o.axisTitle.getBBox()[p?"height":"width"],Xe=Cr(fe=z.offset)?0:ir(z.margin,p?5:10))),o.renderLine(),o.offset=re*ir(x.offset,K[v]?K[v]+(x.margin||0):0),o.tickRotCorr=o.tickRotCorr||{x:0,y:0},pt=v===0?-o.labelMetrics().h:v===2?o.tickRotCorr.y:0,$e=Math.abs(Ue)+Xe,Ue&&($e-=pt,$e+=re*(p?ir(j.y,o.tickRotCorr.y+re*j.distance):ir(j.x,re*j.distance))),o.axisTitleMargin=ir(fe,$e),o.getMaxLabelDimensions&&(o.maxLabelDimensions=o.getMaxLabelDimensions(S,A)),I!=="colorAxis"&&se){let tt=this.tickSize("tick");K[v]=Math.max(K[v],(o.axisTitleMargin||0)+ce+re*o.offset,$e,A!=null&&A.length&&tt?tt[0]+re*o.offset:0);let mt=!o.axisLine||x.offset?0:o.axisLine.strokeWidth()/2;se[O]=Math.max(se[O],mt)}Xr(this,"afterGetOffset")}getLinePath(o){let u=this.chart,p=this.opposite,x=this.offset,v=this.horiz,S=this.left+(p?this.width:0)+x,A=u.chartHeight-this.bottom-(p?this.height:0)+x;return p&&(o*=-1),u.renderer.crispLine([["M",v?this.left:S,v?A:this.top],["L",v?u.chartWidth-this.right:S,v?A:u.chartHeight-this.bottom]],o)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(o){let u=this.horiz,p=this.left,x=this.top,v=this.len,S=this.options.title,A=u?p:x,I=this.opposite,O=this.offset,N=S.x,z=S.y,j=this.chart.renderer.fontMetrics(o),q=o?Math.max(o.getBBox(!1,0).height-j.h-1,0):0,K={low:A+(u?0:v),middle:A+v/2,high:A+(u?v:0)}[S.align],se=(u?x+this.height:p)+(u?1:-1)*(I?-1:1)*(this.axisTitleMargin||0)+[-q,q,j.f,-q][this.side],re={x:u?K+N:se+(I?this.width:0)+O+N,y:u?se+z-(I?this.height:0)+O:K+z};return Xr(this,"afterGetTitlePosition",{titlePosition:re}),re}renderMinorTick(o,u){let p=this.minorTicks;p[o]||(p[o]=new va(this,o,"minor")),u&&p[o].isNew&&p[o].render(null,!0),p[o].render(null,!1,1)}renderTick(o,u,p){var S;let x=this.isLinked,v=this.ticks;(!x||o>=this.min&&o<=this.max||(S=this.grid)!=null&&S.isColumn)&&(v[o]||(v[o]=new va(this,o)),p&&v[o].isNew&&v[o].render(u,!0,-1),v[o].render(u))}render(){let o,u,p=this,x=p.chart,v=p.logarithmic,S=x.renderer,A=p.options,I=p.isLinked,O=p.tickPositions,N=p.axisTitle,z=p.ticks,j=p.minorTicks,q=p.alternateBands,K=A.stackLabels,se=A.alternateGridColor,re=A.crossing,te=p.tickmarkOffset,ce=p.axisLine,fe=p.showAxis,Xe=xr(S.globalAnimation);if(p.labelEdge.length=0,p.overlap=!1,[z,j,q].forEach(function(Ue){Ga(Ue,function($e){$e.isActive=!1})}),Bi(re)){let Ue=this.isXAxis?x.yAxis[0]:x.xAxis[0],$e=[1,-1,-1,1][this.side];if(Ue){let pt=Ue.toPixels(re,!0);p.horiz&&(pt=Ue.len-pt),p.offset=$e*pt}}if(p.hasData()||I){let Ue=p.chart.hasRendered&&p.old&&Bi(p.old.min);p.minorTickInterval&&!p.categories&&p.getMinorTickPositions().forEach(function($e){p.renderMinorTick($e,Ue)}),O.length&&(O.forEach(function($e,pt){p.renderTick($e,pt,Ue)}),te&&(p.min===0||p.single)&&(z[-1]||(z[-1]=new va(p,-1,null,!0)),z[-1].render(-1))),se&&O.forEach(function($e,pt){u=O[pt+1]!==void 0?O[pt+1]+te:p.max-te,pt%2==0&&$e<p.max&&u<=p.max+(x.polar?-te:te)&&(q[$e]||(q[$e]=new Ie.PlotLineOrBand(p,{})),o=$e+te,q[$e].options={from:v?v.lin2log(o):o,to:v?v.lin2log(u):u,color:se,className:"highcharts-alternate-grid"},q[$e].render(),q[$e].isActive=!0)}),p._addedPlotLB||(p._addedPlotLB=!0,(A.plotLines||[]).concat(A.plotBands||[]).forEach(function($e){p.addPlotBandOrLine($e)}))}[z,j,q].forEach(function(Ue){let $e=[],pt=Xe.duration;Ga(Ue,function(tt,mt){tt.isActive||(tt.render(mt,!1,0),tt.isActive=!1,$e.push(mt))}),nu(function(){let tt=$e.length;for(;tt--;)Ue[$e[tt]]&&!Ue[$e[tt]].isActive&&(Ue[$e[tt]].destroy(),delete Ue[$e[tt]])},Ue!==q&&x.hasRendered&&pt?pt:0)}),ce&&(ce[ce.isPlaced?"animate":"attr"]({d:this.getLinePath(ce.strokeWidth())}),ce.isPlaced=!0,ce[fe?"show":"hide"](fe)),N&&fe&&(N[N.isNew?"attr":"animate"](p.getTitlePosition(N)),N.isNew=!1),K!=null&&K.enabled&&p.stacking&&p.stacking.renderStackTotals(),p.old={len:p.len,max:p.max,min:p.min,transA:p.transA,userMax:p.userMax,userMin:p.userMin},p.isDirty=!1,Xr(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(o){o.render()})),this.series.forEach(function(o){o.isDirty=!0})}getKeepProps(){return this.keepProps||Wa.keepProps}destroy(o){let u=this,p=u.plotLinesAndBands,x=this.eventOptions;if(Xr(this,"destroy",{keepEvents:o}),o||ru(u),[u.ticks,u.minorTicks,u.alternateBands].forEach(function(v){oc(v)}),p){let v=p.length;for(;v--;)p[v].destroy()}for(let v in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(S){u[S]&&(u[S]=u[S].destroy())}),u.plotLinesAndBandsGroups)u.plotLinesAndBandsGroups[v]=u.plotLinesAndBandsGroups[v].destroy();Ga(u,function(v,S){u.getKeepProps().indexOf(S)===-1&&delete u[S]}),this.eventOptions=x}drawCrosshair(o,u){var z;let p=this.crosshair,x=(p==null?void 0:p.snap)??!0,v=this.chart,S,A,I,O=this.cross,N;if(Xr(this,"drawCrosshair",{e:o,point:u}),o||(o=(z=this.cross)==null?void 0:z.e),p&&(Cr(u)||!x)!==!1){if(x?Cr(u)&&(A=ir(this.coll!=="colorAxis"?u.crosshairPos:null,this.isXAxis?u.plotX:this.len-u.plotY)):A=o&&(this.horiz?o.chartX-this.pos:this.len-o.chartY+this.pos),Cr(A)&&(N={value:u&&(this.isXAxis?u.x:ir(u.stackY,u.y)),translatedValue:A},v.polar&&ja(N,{isCrosshair:!0,chartX:o==null?void 0:o.chartX,chartY:o==null?void 0:o.chartY,point:u}),S=this.getPlotLinePath(N)||null),!Cr(S)){this.hideCrosshair();return}I=this.categories&&!this.isRadial,O||(this.cross=O=v.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(I?"category ":"thin ")+(p.className||"")).attr({zIndex:ir(p.zIndex,2)}).add(),!v.styledMode&&(O.attr({stroke:p.color||(I?st.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":ir(p.width,1)}).css({"pointer-events":"none"}),p.dashStyle&&O.attr({dashstyle:p.dashStyle}))),O.show().attr({d:S}),I&&!p.width&&O.attr({"stroke-width":this.transA}),this.cross.e=o}else this.hideCrosshair();Xr(this,"afterDrawCrosshair",{e:o,point:u})}hideCrosshair(){this.cross&&this.cross.hide(),Xr(this,"afterHideCrosshair")}update(o,u){let p=this.chart;o=$a(this.userOptions,o),this.destroy(!0),this.init(p,o),p.isDirtyBox=!0,ir(u,!0)&&p.redraw()}remove(o){let u=this.chart,p=this.coll,x=this.series,v=x.length;for(;v--;)x[v]&&x[v].remove(!1);iu(u.axes,this),iu(u[p]||[],this),u.orderItems(p),this.destroy(),u.isDirtyBox=!0,ir(o,!0)&&u.redraw()}setTitle(o,u){this.update({title:o},u)}setCategories(o,u){this.update({categories:o},u)}}Wa.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"];let{addEvent:Mm,getMagnitude:Zf,normalizeTickInterval:cc,timeUnits:hc}=xe;(function(R){function o(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function u(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new p(this))}R.compose=function(x){return x.keepProps.includes("dateTime")||(x.keepProps.push("dateTime"),x.prototype.getTimeTicks=o,Mm(x,"afterSetType",u)),x};class p{constructor(v){this.axis=v}normalizeTimeTickInterval(v,S){let A=S||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],I=A[A.length-1],O=hc[I[0]],N=I[1],z;for(z=0;z<A.length&&(O=hc[(I=A[z])[0]],N=I[1],!A[z+1]||!(v<=(O*N[N.length-1]+hc[A[z+1][0]])/2));z++);O===hc.year&&v<5*O&&(N=[1,2,5]);let j=cc(v/O,N,I[0]==="year"?Math.max(Zf(v/O),1):1);return{unitRange:O,count:j,unitName:I[0]}}getXDateFormat(v,S){let{axis:A}=this,I=A.chart.time;return A.closestPointRange?I.getDateFormat(A.closestPointRange,v,A.options.startOfWeek,S)||I.resolveDTLFormat(S.year).main:I.resolveDTLFormat(S.day).main}}R.Additions=p})($||($={}));let Td=$,{addEvent:su,normalizeTickInterval:ou,pick:rh}=xe;(function(R){function o(){this.type!=="logarithmic"?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new p(this))}function u(){let x=this.logarithmic;x&&(this.lin2val=function(v){return x.lin2log(v)},this.val2lin=function(v){return x.log2lin(v)})}R.compose=function(x){return x.keepProps.includes("logarithmic")||(x.keepProps.push("logarithmic"),su(x,"afterSetType",o),su(x,"afterInit",u)),x};class p{constructor(v){this.axis=v}getLogTickPositions(v,S,A,I){let O=this.axis,N=O.len,z=O.options,j=[];if(I||(this.minorAutoInterval=void 0),v>=.5)v=Math.round(v),j=O.getLinearTickPositions(v,S,A);else if(v>=.08){let q,K,se,re,te,ce,fe,Xe=Math.floor(S);for(q=v>.3?[1,2,4]:v>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],K=Xe;K<A+1&&!fe;K++)for(se=0,re=q.length;se<re&&!fe;se++)(te=this.log2lin(this.lin2log(K)*q[se]))>S&&(!I||ce<=A)&&ce!==void 0&&j.push(ce),ce>A&&(fe=!0),ce=te}else{let q=this.lin2log(S),K=this.lin2log(A),se=I?O.getMinorTickInterval():z.tickInterval,re=z.tickPixelInterval/(I?5:1),te=I?N/O.tickPositions.length:N;v=ou(v=rh(se==="auto"?null:se,this.minorAutoInterval,(K-q)*re/(te||1))),j=O.getLinearTickPositions(v,q,K).map(this.log2lin),I||(this.minorAutoInterval=v/5)}return I||(O.tickInterval=v),j}lin2log(v){return Math.pow(10,v)}log2lin(v){return Math.log(v)/Math.LN10}}R.Additions=p})(Z||(Z={}));let nh=Z,{erase:Ed,extend:Yf,isNumber:au}=xe;(function(R){let o;function u(O){return this.addPlotBandOrLine(O,"plotBands")}function p(O,N){let z=this.userOptions,j=new o(this,O);if(this.visible&&(j=j.render()),j){if(this._addedPlotLB||(this._addedPlotLB=!0,(z.plotLines||[]).concat(z.plotBands||[]).forEach(q=>{this.addPlotBandOrLine(q)})),N){let q=z[N]||[];q.push(O),z[N]=q}this.plotLinesAndBands.push(j)}return j}function x(O){return this.addPlotBandOrLine(O,"plotLines")}function v(O,N,z){z=z||this.options;let j=this.getPlotLinePath({value:N,force:!0,acrossPanes:z.acrossPanes}),q=[],K=this.horiz,se=!au(this.min)||!au(this.max)||O<this.min&&N<this.min||O>this.max&&N>this.max,re=this.getPlotLinePath({value:O,force:!0,acrossPanes:z.acrossPanes}),te,ce=1,fe;if(re&&j)for(se&&(fe=re.toString()===j.toString(),ce=0),te=0;te<re.length;te+=2){let Xe=re[te],Ue=re[te+1],$e=j[te],pt=j[te+1];(Xe[0]==="M"||Xe[0]==="L")&&(Ue[0]==="M"||Ue[0]==="L")&&($e[0]==="M"||$e[0]==="L")&&(pt[0]==="M"||pt[0]==="L")&&(K&&$e[1]===Xe[1]?($e[1]+=ce,pt[1]+=ce):K||$e[2]!==Xe[2]||($e[2]+=ce,pt[2]+=ce),q.push(["M",Xe[1],Xe[2]],["L",Ue[1],Ue[2]],["L",pt[1],pt[2]],["L",$e[1],$e[2]],["Z"])),q.isFlat=fe}return q}function S(O){this.removePlotBandOrLine(O)}function A(O){let N=this.plotLinesAndBands,z=this.options,j=this.userOptions;if(N){let q=N.length;for(;q--;)N[q].id===O&&N[q].destroy();[z.plotLines||[],j.plotLines||[],z.plotBands||[],j.plotBands||[]].forEach(function(K){var se;for(q=K.length;q--;)((se=K[q])==null?void 0:se.id)===O&&Ed(K,K[q])})}}function I(O){this.removePlotBandOrLine(O)}R.compose=function(O,N){let z=N.prototype;return z.addPlotBand||(o=O,Yf(z,{addPlotBand:u,addPlotLine:x,addPlotBandOrLine:p,getPlotBandPath:v,removePlotBand:S,removePlotLine:I,removePlotBandOrLine:A})),N}})(J||(J={}));let Kf=J,{addEvent:Ha,arrayMax:Sd,arrayMin:Cd,defined:Xo,destroyObjectProperties:Jf,erase:Ad,fireEvent:Qf,merge:Md,objectEach:ms,pick:Im}=xe;class sh{static compose(o,u){return Ha(o,"afterInit",function(){this.labelCollectors.push(()=>{var x;let p=[];for(let v of this.axes)for(let{label:S,options:A}of v.plotLinesAndBands)S&&!((x=A==null?void 0:A.label)!=null&&x.allowOverlap)&&p.push(S);return p})}),Kf.compose(sh,u)}constructor(o,u){this.axis=o,this.options=u,this.id=u.id}render(){Qf(this,"render");let{axis:o,options:u}=this,{horiz:p,logarithmic:x}=o,{color:v,events:S,zIndex:A=0}=u,{renderer:I,time:O}=o.chart,N={},z=O.parse(u.to),j=O.parse(u.from),q=O.parse(u.value),K=u.borderWidth,se=u.label,{label:re,svgElem:te}=this,ce=[],fe,Xe=Xo(j)&&Xo(z),Ue=Xo(q),$e=!te,pt={class:"highcharts-plot-"+(Xe?"band ":"line ")+(u.className||"")},tt=Xe?"bands":"lines";if(!o.chart.styledMode&&(Ue?(pt.stroke=v||"#999999",pt["stroke-width"]=Im(u.width,1),u.dashStyle&&(pt.dashstyle=u.dashStyle)):Xe&&(pt.fill=v||"#e6e9ff",K&&(pt.stroke=u.borderColor,pt["stroke-width"]=K))),N.zIndex=A,tt+="-"+A,(fe=o.plotLinesAndBandsGroups[tt])||(o.plotLinesAndBandsGroups[tt]=fe=I.g("plot-"+tt).attr(N).add()),te||(this.svgElem=te=I.path().attr(pt).add(fe)),Xo(q))ce=o.getPlotLinePath({value:(x==null?void 0:x.log2lin(q))??q,lineWidth:te.strokeWidth(),acrossPanes:u.acrossPanes});else{if(!(Xo(j)&&Xo(z)))return;ce=o.getPlotBandPath((x==null?void 0:x.log2lin(j))??j,(x==null?void 0:x.log2lin(z))??z,u)}return!this.eventsAdded&&S&&(ms(S,(mt,Bt)=>{te==null||te.on(Bt,Yt=>{S[Bt].apply(this,[Yt])})}),this.eventsAdded=!0),($e||!te.d)&&(ce!=null&&ce.length)?te.attr({d:ce}):te&&(ce?(te.show(),te.animate({d:ce})):te.d&&(te.hide(),re&&(this.label=re=re.destroy()))),se&&(Xo(se.text)||Xo(se.formatter))&&(ce!=null&&ce.length)&&o.width>0&&o.height>0&&!ce.isFlat?(se=Md({align:p&&Xe?"center":void 0,x:p?!Xe&&4:10,verticalAlign:!p&&Xe?"middle":void 0,y:p?Xe?16:10:Xe?6:-4,rotation:p&&!Xe?90:0,...Xe?{inside:!0}:{}},se),this.renderLabel(se,ce,Xe,A)):re&&re.hide(),this}renderLabel(o,u,p,x){var K;let v=this.axis,S=v.chart.renderer,A=o.inside,I=this.label;I||(this.label=I=S.text(this.getLabelText(o),0,0,o.useHTML).attr({align:o.textAlign||o.align,rotation:o.rotation,class:"highcharts-plot-"+(p?"band":"line")+"-label "+(o.className||""),zIndex:x}),v.chart.styledMode||I.css(Md({fontSize:"0.8em",textOverflow:p&&!A?"":"ellipsis"},o.style)),I.add());let O=u.xBounds||[u[0][1],u[1][1],p?u[2][1]:u[0][1]],N=u.yBounds||[u[0][2],u[1][2],p?u[2][2]:u[0][2]],z=Cd(O),j=Cd(N),q=Sd(O)-z;I.align(o,!1,{x:z,y:j,width:q,height:Sd(N)-j}),I.alignAttr.y-=S.fontMetrics(I).b,(!I.alignValue||I.alignValue==="left"||Xo(A))&&I.css({width:(((K=o.style)==null?void 0:K.width)||(p&&A?q:I.rotation===90?v.height-(I.alignAttr.y-v.top):(o.clip?v.width:v.chart.chartWidth)-(I.alignAttr.x-v.left)))+"px"}),I.show(!0)}getLabelText(o){return Xo(o.formatter)?o.formatter.call(this):o.text}destroy(){Ad(this.axis.plotLinesAndBands,this),delete this.axis,Jf(this)}}let{animObject:km}=En,{format:ep}=ds,{composed:io,dateFormats:tp,doc:ip,isSafari:So}=Ie,{distribute:Zo}=Na,{addEvent:xl,clamp:wa,css:_i,discardElement:Id,extend:kd,fireEvent:vl,getAlignFactor:qa,isArray:oi,isNumber:Pd,isObject:Pm,isString:lu,merge:Ld,pick:bl,pushUnique:rp,splat:Dd,syncTimeout:Lm}=xe;class oh{constructor(o,u,p){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=o,this.init(o,u),this.pointer=p}bodyFormatter(o){return o.map(u=>{let p=u.series.tooltipOptions,x=u.formatPrefix||"point";return(p[x+"Formatter"]||u.tooltipFormatter).call(u,p[x+"Format"]||"")})}cleanSplit(o){this.chart.series.forEach(function(u){let p=u==null?void 0:u.tt;p&&(!p.isActive||o?u.tt=p.destroy():p.isActive=!1)})}defaultFormatter(o){let u,p=this.points||Dd(this);return(u=(u=[o.headerFooterFormatter(p[0])]).concat(o.bodyFormatter(p))).push(o.headerFooterFormatter(p[0],!0)),u}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),Id(this.container)),xe.clearTimeout(this.hideTimer)}getAnchor(o,u){var O;let p,{chart:x,pointer:v}=this,S=x.inverted,A=x.plotTop,I=x.plotLeft;if(o=Dd(o),(O=o[0].series)!=null&&O.yAxis&&!o[0].series.yAxis.options.reversedStacks&&(o=o.slice().reverse()),this.followPointer&&u)u.chartX===void 0&&(u=v.normalize(u)),p=[u.chartX-I,u.chartY-A];else if(o[0].tooltipPos)p=o[0].tooltipPos;else{let N=0,z=0;o.forEach(function(j){let q=j.pos(!0);q&&(N+=q[0],z+=q[1])}),N/=o.length,z/=o.length,this.shared&&o.length>1&&u&&(S?N=u.chartX:z=u.chartY),p=[N-I,z-A]}return p.map(Math.round)}getClassName(o,u,p){let x=this.options,v=o.series,S=v.options;return[x.className,"highcharts-label",p&&"highcharts-tooltip-header",u?"highcharts-tooltip-box":"highcharts-tooltip",!p&&"highcharts-color-"+bl(o.colorIndex,v.colorIndex),S==null?void 0:S.className].filter(lu).join(" ")}getLabel({anchorX:o,anchorY:u}={anchorX:0,anchorY:0}){let p=this,x=this.chart.styledMode,v=this.options,S=this.split&&this.allowShared,A=this.container,I=this.chart.renderer;if(this.label){let O=!this.label.hasClass("highcharts-label");(!S&&O||S&&!O)&&this.destroy()}if(!this.label){if(this.outside){let O=this.chart,N=O.options.chart.style,z=xo.getRendererType();this.container=A=Ie.doc.createElement("div"),A.className="highcharts-tooltip-container "+(O.renderTo.className.match(/(highcharts[a-zA-Z0-9-]+)\s?/gm)||""),_i(A,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,((N==null?void 0:N.zIndex)||0)+3)}),this.renderer=I=new z(A,0,0,N,void 0,void 0,I.styledMode)}if(S?this.label=I.g("tooltip"):(this.label=I.label("",o,u,v.shape||"callout",void 0,void 0,v.useHTML,void 0,"tooltip").attr({padding:v.padding,r:v.borderRadius}),x||this.label.attr({fill:v.backgroundColor,"stroke-width":v.borderWidth||0}).css(v.style).css({pointerEvents:v.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),p.outside){let O=this.label;[O.xSetter,O.ySetter].forEach((N,z)=>{O[z?"ySetter":"xSetter"]=j=>{N.call(O,p.distance),O[z?"y":"x"]=j,A&&(A.style[z?"top":"left"]=`${j}px`)}})}this.label.attr({zIndex:8}).shadow(v.shadow??!v.fixed).add()}return A&&!A.parentElement&&Ie.doc.body.appendChild(A),this.label}getPlayingField(){let{body:o,documentElement:u}=ip,{chart:p,distance:x,outside:v}=this;return{width:v?Math.max(o.scrollWidth,u.scrollWidth,o.offsetWidth,u.offsetWidth,u.clientWidth)-2*x-2:p.chartWidth,height:v?Math.max(o.scrollHeight,u.scrollHeight,o.offsetHeight,u.offsetHeight,u.clientHeight):p.chartHeight}}getPosition(o,u,p){var mi,Ni;let{distance:x,chart:v,outside:S,pointer:A}=this,{inverted:I,plotLeft:O,plotTop:N,polar:z}=v,{plotX:j=0,plotY:q=0}=p,K={},se=I&&p.h||0,{height:re,width:te}=this.getPlayingField(),ce=A.getChartPosition(),fe=bi=>bi*ce.scaleX,Xe=bi=>bi*ce.scaleY,Ue=bi=>{let Vi=bi==="x";return[bi,Vi?te:re,Vi?o:u].concat(S?[Vi?fe(o):Xe(u),Vi?ce.left-x+fe(j+O):ce.top-x+Xe(q+N),0,Vi?te:re]:[Vi?o:u,Vi?j+O:q+N,Vi?O:N,Vi?O+v.plotWidth:N+v.plotHeight])},$e=Ue("y"),pt=Ue("x"),tt,mt=!!p.negative;!z&&((Ni=(mi=v.hoverSeries)==null?void 0:mi.yAxis)!=null&&Ni.reversed)&&(mt=!mt);let Bt=!this.followPointer&&bl(p.ttBelow,!z&&!I===mt),Yt=function(bi,Vi,gr,ar,vr,Ss,_r){let zr=S?bi==="y"?Xe(x):fe(x):x,Hi=(gr-ar)/2,di=ar<vr-x,Mn=vr+x+ar<Vi,Br=vr-zr-gr+Hi,Kr=vr+zr-Hi;if(Bt&&Mn)K[bi]=Kr;else if(!Bt&&di)K[bi]=Br;else if(di)K[bi]=Math.min(_r-ar,Br-se<0?Br:Br-se);else{if(!Mn)return K[bi]=0,!1;K[bi]=Math.max(Ss,Kr+se+gr>Vi?Kr:Kr+se)}},ei=function(bi,Vi,gr,ar,vr){if(vr<x||vr>Vi-x)return!1;vr<gr/2?K[bi]=1:vr>Vi-ar/2?K[bi]=Vi-ar-2:K[bi]=vr-gr/2},Ft=function(bi){[$e,pt]=[pt,$e],tt=bi},ci=()=>{Yt.apply(0,$e)!==!1?ei.apply(0,pt)!==!1||tt||(Ft(!0),ci()):tt?K.x=K.y=0:(Ft(!0),ci())};return(I&&!z||this.len>1)&&Ft(),ci(),K}getFixedPosition(o,u,p){var j;let x=p.series,{chart:v,options:S,split:A}=this,I=S.position,O=I.relativeTo,N=S.shared||(j=x==null?void 0:x.yAxis)!=null&&j.isRadial&&(O==="pane"||!O)?"plotBox":O,z=N==="chart"?v.renderer:v[N]||v.getClipBox(x,!0);return{x:z.x+(z.width-o)*qa(I.align)+I.x,y:z.y+(z.height-u)*qa(I.verticalAlign)+(!A&&I.y||0)}}hide(o){let u=this;xe.clearTimeout(this.hideTimer),o=bl(o,this.options.hideDelay),this.isHidden||(this.hideTimer=Lm(function(){let p=u.getLabel();u.getLabel().animate({opacity:0},{duration:o&&150,complete:()=>{p.hide(),u.container&&u.container.remove()}}),u.isHidden=!0},o))}init(o,u){this.chart=o,this.options=u,this.crosshairs=[],this.isHidden=!0,this.split=u.split&&!o.inverted&&!o.polar,this.shared=u.shared||this.split,this.outside=bl(u.outside,!!(o.scrollablePixelsX||o.scrollablePixelsY))}shouldStickOnContact(o){return!!(!this.followPointer&&this.options.stickOnContact&&(!o||this.pointer.inClass(o.target,"highcharts-tooltip")))}move(o,u,p,x){let{followPointer:v,options:S}=this,A=km(!v&&!this.isHidden&&!S.fixed&&S.animation),I=v||(this.len||0)>1,O={x:o,y:u};I?O.anchorX=O.anchorY=NaN:(O.anchorX=p,O.anchorY=x),A.step=()=>this.drawTracker(),this.getLabel().animate(O,A)}refresh(o,u){let{chart:p,options:x,pointer:v,shared:S}=this,A=Dd(o),I=A[0],O=x.format,N=x.formatter||this.defaultFormatter,z=p.styledMode,j=this.allowShared;if(!x.enabled||!I.series)return;xe.clearTimeout(this.hideTimer),this.allowShared=!(!oi(o)&&o.series&&o.series.noSharedTooltip),j=j&&!this.allowShared,this.followPointer=!this.split&&I.series.tooltipOptions.followPointer;let q=this.getAnchor(o,u),K=q[0],se=q[1];S&&this.allowShared&&(v.applyInactiveState(A),A.forEach(ce=>ce.setState("hover")),I.points=A),this.len=A.length;let re=lu(O)?ep(O,I,p):N.call(I,this);I.points=void 0;let te=I.series;if(this.distance=bl(te.tooltipOptions.distance,16),re===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(re,A);else{let ce=K,fe=se;if(u&&v.isDirectTouch&&(ce=u.chartX-p.plotLeft,fe=u.chartY-p.plotTop),p.polar||te.options.clip===!1||A.some(Xe=>v.isDirectTouch||Xe.series.shouldShowTooltip(ce,fe))){let Xe=this.getLabel(j&&this.tt||{});(!x.style.width||z)&&Xe.css({width:(this.outside?this.getPlayingField():p.spacingBox).width+"px"}),Xe.attr({class:this.getClassName(I),text:re&&re.join?re.join(""):re}),this.outside&&Xe.attr({x:wa(Xe.x||0,0,this.getPlayingField().width-(Xe.width||0)-1)}),z||Xe.attr({stroke:x.borderColor||I.color||te.color||"#666666"}),this.updatePosition({plotX:K,plotY:se,negative:I.negative,ttBelow:I.ttBelow,series:te,h:q[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}vl(this,"refresh")}renderSplit(o,u){var vr,Ss;let p=this,{chart:x,chart:{chartWidth:v,chartHeight:S,plotHeight:A,plotLeft:I,plotTop:O,scrollablePixelsY:N=0,scrollablePixelsX:z,styledMode:j},distance:q,options:K,options:{fixed:se,position:re,positioner:te},pointer:ce}=p,{scrollLeft:fe=0,scrollTop:Xe=0}=((vr=x.scrollablePlotArea)==null?void 0:vr.scrollingContainer)||{},Ue=p.outside&&typeof z!="number"?ip.documentElement.getBoundingClientRect():{left:fe,right:fe+v},$e=p.getLabel(),pt=this.renderer||x.renderer,tt=!!((Ss=x.xAxis[0])!=null&&Ss.opposite),{left:mt,top:Bt}=ce.getChartPosition(),Yt=te||se,ei=O+Xe,Ft=0,ci=A-N,mi=function(_r,zr,Hi,di=[0,0],Mn=!0){let Br,Kr;if(Hi.isHeader)Kr=tt?0:ci,Br=wa(di[0]-_r/2,Ue.left,Ue.right-_r-(p.outside?mt:0));else if(se&&Hi){let on=p.getFixedPosition(_r,zr,Hi);Br=on.x,Kr=on.y-ei}else Kr=di[1]-ei,Br=wa(Br=Mn?di[0]-_r-q:di[0]+q,Mn?Br:Ue.left,Ue.right);return{x:Br,y:Kr}};lu(o)&&(o=[!1,o]);let Ni=o.slice(0,u.length+1).reduce(function(_r,zr,Hi){if(zr!==!1&&zr!==""){let di=u[Hi-1]||{isHeader:!0,plotX:u[0].plotX,plotY:A,series:{}},Mn=di.isHeader,Br=Mn?p:di.series,Kr=Br.tt=function(Hs,Hn,pf){let wc=Hs,{isHeader:mh,series:mf}=Hn,La=mf.tooltipOptions||K;if(!wc){let Au={padding:La.padding,r:La.borderRadius};j||(Au.fill=La.backgroundColor,Au["stroke-width"]=La.borderWidth??(se&&!mh?0:1)),wc=pt.label("",0,0,La[mh?"headerShape":"shape"]||(se&&!mh?"rect":"callout"),void 0,void 0,La.useHTML).addClass(p.getClassName(Hn,!0,mh)).attr(Au).add($e)}return wc.isActive=!0,wc.attr({text:pf}),j||wc.css(La.style).attr({stroke:La.borderColor||Hn.color||mf.color||"#333333"}),wc}(Br.tt,di,zr.toString()),on=Kr.getBBox(),lo=on.width+Kr.strokeWidth();Mn&&(Ft=on.height,ci+=Ft,tt&&(ei-=Ft));let{anchorX:Po,anchorY:ta}=function(Hs){let Hn,pf,{isHeader:wc,plotX:mh=0,plotY:mf=0,series:La}=Hs;if(wc)Hn=Math.max(I+mh,I),pf=O+A/2;else{let{xAxis:Au,yAxis:gf}=La;Hn=Au.pos+wa(mh,-q,Au.len+q),La.shouldShowTooltip(0,gf.pos-O+mf,{ignoreX:!0})&&(pf=gf.pos+mf)}return{anchorX:Hn=wa(Hn,Ue.left-q,Ue.right+q),anchorY:pf}}(di);if(typeof ta=="number"){let Hs=on.height+1,Hn=(te||mi).call(p,lo,Hs,di,[Po,ta]);_r.push({align:Yt?0:void 0,anchorX:Po,anchorY:ta,boxWidth:lo,point:di,rank:bl(Hn.rank,+!!Mn),size:Hs,target:Hn.y,tt:Kr,x:Hn.x})}else Kr.isActive=!1}return _r},[]);!Yt&&Ni.some(_r=>{let{outside:zr}=p,Hi=(zr?mt:0)+_r.anchorX;return Hi<Ue.left&&Hi+_r.boxWidth<Ue.right||Hi<mt-Ue.left+_r.boxWidth&&Ue.right-Hi>Hi})&&(Ni=Ni.map(_r=>{let{x:zr,y:Hi}=mi.call(this,_r.boxWidth,_r.size,_r.point,[_r.anchorX,_r.anchorY],!1);return kd(_r,{target:Hi,x:zr})})),p.cleanSplit(),Zo(Ni,ci);let bi={left:mt,right:mt};Ni.forEach(function(_r){let{x:zr,boxWidth:Hi,isHeader:di}=_r;!di&&(p.outside&&mt+zr<bi.left&&(bi.left=mt+zr),!di&&p.outside&&bi.left+Hi>bi.right&&(bi.right=mt+zr))}),Ni.forEach(function(_r){let{x:zr,anchorX:Hi,anchorY:di,pos:Mn,point:{isHeader:Br}}=_r,Kr={visibility:Mn===void 0?"hidden":"inherit",x:zr,y:(Mn||0)+ei+(se&&re.y||0),anchorX:Hi,anchorY:di};if(p.outside&&zr<Hi){let on=mt-bi.left;on>0&&(Br||(Kr.x=zr+on,Kr.anchorX=Hi+on),Br&&(Kr.x=(bi.right-bi.left)/2,Kr.anchorX=Hi+on))}_r.tt.attr(Kr)});let{container:Vi,outside:gr,renderer:ar}=p;if(gr&&Vi&&ar){let{width:_r,height:zr,x:Hi,y:di}=$e.getBBox();ar.setSize(_r+Hi,zr+di,!1),Vi.style.left=bi.left+"px",Vi.style.top=Bt+"px"}So&&$e.attr({opacity:$e.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let o=this.chart,u=this.label,p=this.shared?o.hoverPoints:o.hoverPoint;if(!u||!p)return;let x={x:0,y:0,width:0,height:0},v=this.getAnchor(p),S=u.getBBox();v[0]+=o.plotLeft-(u.translateX||0),v[1]+=o.plotTop-(u.translateY||0),x.x=Math.min(0,v[0]),x.y=Math.min(0,v[1]),x.width=v[0]<0?Math.max(Math.abs(v[0]),S.width-v[0]):Math.max(Math.abs(v[0]),S.width),x.height=v[1]<0?Math.max(Math.abs(v[1]),S.height-Math.abs(v[1])):Math.max(Math.abs(v[1]),S.height),this.tracker?this.tracker.attr(x):(this.tracker=u.renderer.rect(x).addClass("highcharts-tracker").add(u),o.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(o){return o.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}headerFooterFormatter(o,u){let p=o.series,x=p.tooltipOptions,v=p.xAxis,S=v==null?void 0:v.dateTime,A={isFooter:u,point:o},I=x.xDateFormat||"",O=x[u?"footerFormat":"headerFormat"];return vl(this,"headerFormatter",A,function(N){if(S&&!I&&Pd(o.key)&&(I=S.getXDateFormat(o.key,x.dateTimeLabelFormats)),S&&I){if(Pm(I)){let z=I;tp[0]=j=>p.chart.time.dateFormat(z,j),I="%0"}(o.tooltipDateKeys||["key"]).forEach(z=>{O=O.replace(RegExp("point\\."+z+"([ \\)}])"),`(point.${z}:${I})$1`)})}p.chart.styledMode&&(O=this.styledModeFormat(O)),N.text=ep(O,o,this.chart)}),A.text||""}update(o){this.destroy(),this.init(this.chart,Ld(!0,this.options,o))}updatePosition(o){var Ue;let{chart:u,container:p,distance:x,options:v,pointer:S,renderer:A}=this,{height:I=0,width:O=0}=this.getLabel(),{fixed:N,positioner:z}=v,{left:j,top:q,scaleX:K,scaleY:se}=S.getChartPosition(),re=(z||N&&this.getFixedPosition||this.getPosition).call(this,O,I,o),te=Ie.doc,ce=(o.plotX||0)+u.plotLeft,fe=(o.plotY||0)+u.plotTop,Xe;if(A&&p){if(z||N){let{scrollLeft:$e=0,scrollTop:pt=0}=((Ue=u.scrollablePlotArea)==null?void 0:Ue.scrollingContainer)||{};re.x+=$e+j-x,re.y+=pt+q-x}Xe=(v.borderWidth||0)+2*x+2,A.setSize(wa(O+Xe,0,te.documentElement.clientWidth)-1,I+Xe,!1),(K!==1||se!==1)&&(_i(p,{transform:`scale(${K}, ${se})`}),ce*=K,fe*=se),ce+=j-re.x,fe+=q-re.y}this.move(Math.round(re.x),Math.round(re.y||0),ce,fe)}}(function(R){R.compose=function(o){rp(io,"Core.Tooltip")&&xl(o,"afterInit",function(){let u=this.chart;u.options.tooltip&&(u.tooltip=new R(u,u.options.tooltip,this))})}})(oh||(oh={}));let cu=oh,{animObject:Od}=En,{defaultOptions:uc}=Le,{format:f}=ds,{addEvent:n,crisp:c,erase:g,extend:b,fireEvent:E,getNestedProperty:L,isArray:D,isFunction:F,isNumber:W,isObject:H,merge:Q,pick:he,syncTimeout:me,removeEvent:ye,uniqueKey:_e}=xe;class be{animateBeforeDestroy(){let o=this,u={x:o.startXPos,opacity:0},p=o.getGraphicalProps();p.singular.forEach(function(x){o[x]=o[x].animate(x==="dataLabel"?{x:o[x].startXPos,y:o[x].startYPos,opacity:0}:u)}),p.plural.forEach(function(x){o[x].forEach(function(v){v.element&&v.animate(b({x:o.startXPos},v.startYPos?{x:v.startXPos,y:v.startYPos}:{}))})})}applyOptions(o,u){let p=this.series,x=p.options.pointValKey||p.pointValKey;return b(this,o=be.prototype.optionsToObject.call(this,o)),this.options=this.options?b(this.options,o):o,o.group&&delete this.group,o.dataLabels&&delete this.dataLabels,x&&(this.y=be.prototype.getNestedProperty.call(this,x)),this.selected&&(this.state="select"),"name"in this&&u===void 0&&p.xAxis&&p.xAxis.hasNames&&(this.x=p.xAxis.nameToX(this)),this.x===void 0&&p?this.x=u??p.autoIncrement():W(o.x)&&p.options.relativeXValue?this.x=p.autoIncrement(o.x):typeof this.x=="string"&&(u??(u=p.chart.time.parse(this.x)),W(u)&&(this.x=u)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let o=this,u=o.series,p=u.chart,x=u.options.dataSorting,v=p.hoverPoints,S=Od(o.series.chart.renderer.globalAnimation),A=()=>{for(let I in(o.graphic||o.graphics||o.dataLabel||o.dataLabels)&&(ye(o),o.destroyElements()),o)delete o[I]};o.legendItem&&p.legend.destroyItem(o),v&&(o.setState(),g(v,o),v.length||(p.hoverPoints=null)),o===p.hoverPoint&&o.onMouseOut(),x!=null&&x.enabled?(this.animateBeforeDestroy(),me(A,S.duration)):A(),p.pointCount--}this.destroyed=!0}destroyElements(o){let u=this,p=u.getGraphicalProps(o);p.singular.forEach(function(x){u[x]=u[x].destroy()}),p.plural.forEach(function(x){u[x].forEach(function(v){v!=null&&v.element&&v.destroy()}),delete u[x]})}firePointEvent(o,u,p){let x=this,v=this.series.options;x.manageEvent(o),o==="click"&&v.allowPointSelect&&(p=function(S){!x.destroyed&&x.select&&x.select(null,S.ctrlKey||S.metaKey||S.shiftKey)}),E(x,o,u,p)}getClassName(){var o;return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+((o=this.zone)!=null&&o.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(o){let u,p,x=this,v=[],S={singular:[],plural:[]};for((o=o||{graphic:1,dataLabel:1}).graphic&&v.push("graphic","connector"),o.dataLabel&&v.push("dataLabel","dataLabelPath","dataLabelUpper"),p=v.length;p--;)x[u=v[p]]&&S.singular.push(u);return["graphic","dataLabel"].forEach(function(A){let I=A+"s";o[A]&&x[I]&&S.plural.push(I)}),S}getNestedProperty(o){return o?o.indexOf("custom.")===0?L(o,this.options):this[o]:void 0}getZone(){let o=this.series,u=o.zones,p=o.zoneAxis||"y",x,v=0;for(x=u[0];this[p]>=x.value;)x=u[++v];return this.nonZonedColor||(this.nonZonedColor=this.color),x!=null&&x.color&&!this.options.color?this.color=x.color:this.color=this.nonZonedColor,x}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(o,u,p){this.formatPrefix="point",this.visible=!0,this.point=this,this.series=o,this.applyOptions(u,p),this.id??(this.id=_e()),this.resolveColor(),this.dataLabelOnNull??(this.dataLabelOnNull=o.options.nullInteraction),o.chart.pointCount++,E(this,"afterInit")}isValid(){return(W(this.x)||this.x instanceof Date)&&W(this.y)}optionsToObject(o){var N;let u=this.series,p=u.options.keys,x=p||u.pointArrayMap||["y"],v=x.length,S={},A,I=0,O=0;if(W(o)||o===null)S[x[0]]=o;else if(D(o))for(!p&&o.length>v&&((A=typeof o[0])=="string"?(N=u.xAxis)!=null&&N.dateTime?S.x=u.chart.time.parse(o[0]):S.name=o[0]:A==="number"&&(S.x=o[0]),I++);O<v;)p&&o[I]===void 0||(x[O].indexOf(".")>0?be.prototype.setNestedProperty(S,o[I],x[O]):S[x[O]]=o[I]),I++,O++;else typeof o=="object"&&(S=o,o.dataLabels&&(u.hasDataLabels=()=>!0),o.marker&&(u._hasPointMarkers=!0));return S}pos(o,u=this.plotY){if(!this.destroyed){let{plotX:p,series:x}=this,{chart:v,xAxis:S,yAxis:A}=x,I=0,O=0;if(W(p)&&W(u))return o&&(I=S?S.pos:v.plotLeft,O=A?A.pos:v.plotTop),v.inverted&&S&&A?[A.len-u+O,S.len-p+I]:[p+I,u+O]}}resolveColor(){let o=this.series,u=o.chart.options.chart,p=o.chart.styledMode,x,v,S=u.colorCount,A;delete this.nonZonedColor,o.options.colorByPoint?(p||(x=(v=o.options.colors||o.chart.options.colors)[o.colorCounter],S=v.length),A=o.colorCounter,o.colorCounter++,o.colorCounter===S&&(o.colorCounter=0)):(p||(x=o.color),A=o.colorIndex),this.colorIndex=he(this.options.colorIndex,A),this.color=he(this.options.color,x)}setNestedProperty(o,u,p){return p.split(".").reduce(function(x,v,S,A){let I=A.length-1===S;return x[v]=I?u:H(x[v],!0)?x[v]:{},x[v]},o),o}shouldDraw(){return!this.isNull}tooltipFormatter(o){var I;let{chart:u,pointArrayMap:p=["y"],tooltipOptions:x}=this.series,{valueDecimals:v="",valuePrefix:S="",valueSuffix:A=""}=x;return u.styledMode&&(o=((I=u.tooltip)==null?void 0:I.styledModeFormat(o))||o),p.forEach(O=>{O="{point."+O,(S||A)&&(o=o.replace(RegExp(O+"}","g"),S+O+"}"+A)),o=o.replace(RegExp(O+"}","g"),O+":,."+v+"f}")}),f(o,this,u)}update(o,u,p,x){let v,S=this,A=S.series,I=S.graphic,O=A.chart,N=A.options;function z(){S.applyOptions(o);let j=I&&S.hasMockGraphic,q=S.y===null?!j:j;I&&q&&(S.graphic=I.destroy(),delete S.hasMockGraphic),H(o,!0)&&(I!=null&&I.element&&o&&o.marker&&o.marker.symbol!==void 0&&(S.graphic=I.destroy()),o!=null&&o.dataLabels&&S.dataLabel&&(S.dataLabel=S.dataLabel.destroy())),v=S.index;let K={};for(let se of A.dataColumnKeys())K[se]=S[se];A.dataTable.setRow(K,v),N.data[v]=H(N.data[v],!0)||H(o,!0)?S.options:he(o,N.data[v]),A.isDirty=A.isDirtyData=!0,!A.fixedBox&&A.hasCartesianSeries&&(O.isDirtyBox=!0),N.legendType==="point"&&(O.isDirtyLegend=!0),u&&O.redraw(p)}u=he(u,!0),x===!1?z():S.firePointEvent("update",{options:o},z)}remove(o,u){this.series.removePoint(this.series.data.indexOf(this),o,u)}select(o,u){let p=this,x=p.series,v=x.chart;o=he(o,!p.selected),this.selectedStaging=o,p.firePointEvent(o?"select":"unselect",{accumulate:u},function(){p.selected=p.options.selected=o,x.options.data[x.data.indexOf(p)]=p.options,p.setState(o&&"select"),u||v.getSelectedPoints().forEach(function(S){let A=S.series;S.selected&&S!==p&&(S.selected=S.options.selected=!1,A.options.data[A.data.indexOf(S)]=S.options,S.setState(v.hoverPoints&&A.options.inactiveOtherPoints?"inactive":""),S.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(o){let{inverted:u,pointer:p}=this.series.chart;p&&(o=o?p.normalize(o):p.getChartCoordinatesFromPoint(this,u),p.runPointActions(o,this))}onMouseOut(){let o=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(o.hoverPoints||[]).forEach(function(u){u.setState()}),o.hoverPoints=o.hoverPoint=null}manageEvent(o){var x,v,S,A,I,O,N;let u=Q(this.series.options.point,this.options),p=(x=u.events)==null?void 0:x[o];F(p)&&(!((v=this.hcEvents)!=null&&v[o])||((A=(S=this.hcEvents)==null?void 0:S[o])==null?void 0:A.map(z=>z.fn).indexOf(p))===-1)?((I=this.importedUserEvent)==null||I.call(this),this.importedUserEvent=n(this,o,p),this.hcEvents&&(this.hcEvents[o].userEvent=!0)):this.importedUserEvent&&!p&&((O=this.hcEvents)!=null&&O[o])&&((N=this.hcEvents)!=null&&N[o].userEvent)&&(ye(this,o),delete this.hcEvents[o],Object.keys(this.hcEvents)||delete this.importedUserEvent)}setState(o,u){var $e,pt;let p=this.series,x=this.state,v=p.options.states[o||"normal"]||{},S=uc.plotOptions[p.type].marker&&p.options.marker,A=S&&S.enabled===!1,I=(($e=S==null?void 0:S.states)==null?void 0:$e[o||"normal"])||{},O=I.enabled===!1,N=this.marker||{},z=p.chart,j=S&&p.markerAttribs,q=p.halo,K,se,re,te=p.stateMarkerGraphic,ce;if((o=o||"")===this.state&&!u||this.selected&&o!=="select"||v.enabled===!1||o&&(O||A&&I.enabled===!1)||o&&N.states&&N.states[o]&&N.states[o].enabled===!1)return;if(this.state=o,j&&(K=p.markerAttribs(this,o)),this.graphic&&!this.hasMockGraphic){if(x&&this.graphic.removeClass("highcharts-point-"+x),o&&this.graphic.addClass("highcharts-point-"+o),!z.styledMode){se=p.pointAttribs(this,o),re=he(z.options.chart.animation,v.animation);let tt=se.opacity;p.options.inactiveOtherPoints&&W(tt)&&(this.dataLabels||[]).forEach(function(mt){mt&&!mt.hasClass("highcharts-data-label-hidden")&&(mt.animate({opacity:tt},re),mt.connector&&mt.connector.animate({opacity:tt},re))}),this.graphic.animate(se,re)}K&&this.graphic.animate(K,he(z.options.chart.animation,I.animation,S.animation)),te&&te.hide()}else o&&I&&(ce=N.symbol||p.symbol,te&&te.currentSymbol!==ce&&(te=te.destroy()),K&&(te?te[u?"animate":"attr"]({x:K.x,y:K.y}):ce&&(p.stateMarkerGraphic=te=z.renderer.symbol(ce,K.x,K.y,K.width,K.height,Q(S,I)).add(p.markerGroup),te.currentSymbol=ce)),!z.styledMode&&te&&this.state!=="inactive"&&te.attr(p.pointAttribs(this,o))),te&&(te[o&&this.isInside?"show":"hide"](),te.element.point=this,te.addClass(this.getClassName(),!0));let fe=v.halo,Xe=this.graphic||te,Ue=(Xe==null?void 0:Xe.visibility)||"inherit";fe!=null&&fe.size&&Xe&&Ue!=="hidden"&&!this.isCluster?(q||(p.halo=q=z.renderer.path().add(Xe.parentGroup)),q.show()[u?"animate":"attr"]({d:this.haloPath(fe.size)}),q.attr({class:"highcharts-halo highcharts-color-"+he(this.colorIndex,p.colorIndex)+(this.className?" "+this.className:""),visibility:Ue,zIndex:-1}),q.point=this,z.styledMode||q.attr(b({fill:this.color||p.color,"fill-opacity":fe.opacity},Vr.filterUserAttributes(fe.attributes||{})))):(pt=q==null?void 0:q.point)!=null&&pt.haloPath&&!q.point.destroyed&&q.animate({d:q.point.haloPath(0)},null,q.hide),E(this,"afterSetState",{state:o})}haloPath(o){let u=this.pos();return u?this.series.chart.renderer.symbols.circle(c(u[0],1)-o,u[1]-o,2*o,2*o):[]}}let ee=be,{parse:pe}=st,{charts:Ce,composed:ke,isTouchDevice:Ge}=Ie,{addEvent:Ne,attr:We,css:it,extend:et,find:ft,fireEvent:Nt,isNumber:ht,isObject:Mt,objectEach:_t,offset:Vt,pick:lt,pushUnique:kt,splat:jt}=xe;class Ct{applyInactiveState(o=[]){let u=[];o.forEach(p=>{let x=p.series;u.push(x),x.linkedParent&&u.push(x.linkedParent),x.linkedSeries&&u.push.apply(u,x.linkedSeries),x.navigatorSeries&&u.push(x.navigatorSeries),x.boosted&&x.markerGroup&&u.push.apply(u,this.chart.series.filter(v=>v.markerGroup===x.markerGroup))}),this.chart.series.forEach(p=>{u.indexOf(p)===-1?p.setState("inactive",!0):p.options.inactiveOtherPoints&&p.setAllPointsToState("inactive")})}destroy(){let o=this;this.eventsToUnbind.forEach(u=>u()),this.eventsToUnbind=[],!Ie.chartCount&&(Ct.unbindDocumentMouseUp.forEach(u=>u.unbind()),Ct.unbindDocumentMouseUp.length=0,Ct.unbindDocumentTouchEnd&&(Ct.unbindDocumentTouchEnd=Ct.unbindDocumentTouchEnd())),clearInterval(o.tooltipTimeout),_t(o,function(u,p){o[p]=void 0})}getSelectionMarkerAttrs(o,u){let p={args:{chartX:o,chartY:u},attrs:{},shapeType:"rect"};return Nt(this,"getSelectionMarkerAttrs",p,x=>{let v,{chart:S,zoomHor:A,zoomVert:I}=this,{mouseDownX:O=0,mouseDownY:N=0}=S,z=x.attrs;z.x=S.plotLeft,z.y=S.plotTop,z.width=A?1:S.plotWidth,z.height=I?1:S.plotHeight,A&&(z.width=Math.max(1,Math.abs(v=o-O)),z.x=(v>0?0:v)+O),I&&(z.height=Math.max(1,Math.abs(v=u-N)),z.y=(v>0?0:v)+N)}),p}drag(o){let{chart:u}=this,{mouseDownX:p=0,mouseDownY:x=0}=u,{panning:v,panKey:S,selectionMarkerFill:A}=u.options.chart,I=u.plotLeft,O=u.plotTop,N=u.plotWidth,z=u.plotHeight,j=Mt(v)?v.enabled:v,q=S&&o[`${S}Key`],K=o.chartX,se=o.chartY,re,te=this.selectionMarker;if((!te||!te.touch)&&(K<I?K=I:K>I+N&&(K=I+N),se<O?se=O:se>O+z&&(se=O+z),this.hasDragged=Math.sqrt(Math.pow(p-K,2)+Math.pow(x-se,2)),this.hasDragged>10)){re=u.isInsidePlot(p-I,x-O,{visiblePlotOnly:!0});let{shapeType:ce,attrs:fe}=this.getSelectionMarkerAttrs(K,se);(u.hasCartesianSeries||u.mapView)&&this.hasZoom&&re&&!q&&!te&&(this.selectionMarker=te=u.renderer[ce](),te.attr({class:"highcharts-selection-marker",zIndex:7}).add(),u.styledMode||te.attr({fill:A||pe("#334eff").setOpacity(.25).get()})),te&&te.attr(fe),re&&!te&&j&&u.pan(o,v)}}dragStart(o){let u=this.chart;u.mouseIsDown=o.type,u.cancelClick=!1,u.mouseDownX=o.chartX,u.mouseDownY=o.chartY}getSelectionBox(o){let u={args:{marker:o},result:o.getBBox()};return Nt(this,"getSelectionBox",u),u.result}drop(o){let u,{chart:p,selectionMarker:x}=this;for(let v of p.axes)v.isPanning&&(v.isPanning=!1,(v.options.startOnTick||v.options.endOnTick||v.series.some(S=>S.boosted))&&(v.forceRedraw=!0,v.setExtremes(v.userMin,v.userMax,!1),u=!0));if(u&&p.redraw(),x&&o){if(this.hasDragged){let v=this.getSelectionBox(x);p.transform({axes:p.axes.filter(S=>S.zoomEnabled&&(S.coll==="xAxis"&&this.zoomX||S.coll==="yAxis"&&this.zoomY)),selection:{originalEvent:o,xAxis:[],yAxis:[],...v},from:v})}ht(p.index)&&(this.selectionMarker=x.destroy())}p&&ht(p.index)&&(it(p.container,{cursor:p._cursor}),p.cancelClick=this.hasDragged>10,p.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(o,u,p){let x;return o.forEach(function(v){let S=!(v.noSharedTooltip&&u)&&0>v.options.findNearestPointBy.indexOf("y"),A=v.searchPoint(p,S);Mt(A,!0)&&A.series&&(!Mt(x,!0)||function(I,O){var q,K;let N=I.distX-O.distX,z=I.dist-O.dist,j=((q=O.series.group)==null?void 0:q.zIndex)-((K=I.series.group)==null?void 0:K.zIndex);return N!==0&&u?N:z!==0?z:j!==0?j:I.series.index>O.series.index?-1:1}(x,A)>0)&&(x=A)}),x}getChartCoordinatesFromPoint(o,u){let{xAxis:p,yAxis:x}=o.series,v=o.shapeArgs;if(p&&x){let S=o.clientX??o.plotX??0,A=o.plotY||0;return o.isNode&&v&&ht(v.x)&&ht(v.y)&&(S=v.x,A=v.y),u?{chartX:x.len+x.pos-A,chartY:p.len+p.pos-S}:{chartX:S+p.pos,chartY:A+x.pos}}if(v!=null&&v.x&&v.y)return{chartX:v.x,chartY:v.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:o}=this.chart,u=Vt(o);this.chartPosition={left:u.left,top:u.top,scaleX:1,scaleY:1};let{offsetHeight:p,offsetWidth:x}=o;return x>2&&p>2&&(this.chartPosition.scaleX=u.width/x,this.chartPosition.scaleY=u.height/p),this.chartPosition}getCoordinates(o){let u={xAxis:[],yAxis:[]};for(let p of this.chart.axes)u[p.isXAxis?"xAxis":"yAxis"].push({axis:p,value:p.toValue(o[p.horiz?"chartX":"chartY"])});return u}getHoverData(o,u,p,x,v,S){let A=[],I=function(q){return q.visible&&!(!v&&q.directTouch)&&lt(q.options.enableMouseTracking,!0)},O=u,N,z={chartX:S?S.chartX:void 0,chartY:S?S.chartY:void 0,shared:v};Nt(this,"beforeGetHoverData",z),N=O&&!O.stickyTracking?[O]:p.filter(q=>q.stickyTracking&&(z.filter||I)(q));let j=x&&o||!S?o:this.findNearestKDPoint(N,v,S);return O=j==null?void 0:j.series,j&&(v&&!O.noSharedTooltip?(N=p.filter(function(q){return z.filter?z.filter(q):I(q)&&!q.noSharedTooltip})).forEach(function(q){var re;let K=(re=q.options)==null?void 0:re.nullInteraction,se=ft(q.points,function(te){return te.x===j.x&&(!te.isNull||!!K)});Mt(se)&&(q.boosted&&q.boost&&(se=q.boost.getPoint(se)),A.push(se))}):A.push(j)),Nt(this,"afterGetHoverData",z={hoverPoint:j}),{hoverPoint:z.hoverPoint,hoverSeries:O,hoverPoints:A}}getPointFromEvent(o){let u=o.target,p;for(;u&&!p;)p=u.point,u=u.parentNode;return p}onTrackerMouseOut(o){let u=this.chart,p=o.relatedTarget,x=u.hoverSeries;this.isDirectTouch=!1,!x||!p||x.stickyTracking||this.inClass(p,"highcharts-tooltip")||this.inClass(p,"highcharts-series-"+x.index)&&this.inClass(p,"highcharts-tracker")||x.onMouseOut()}inClass(o,u){let p=o,x;for(;p;){if(x=We(p,"class")){if(x.indexOf(u)!==-1)return!0;if(x.indexOf("highcharts-container")!==-1)return!1}p=p.parentElement}}constructor(o,u){var p;this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=u,this.chart=o,this.runChartClick=!!((p=u.chart.events)!=null&&p.click),this.pinchDown=[],this.setDOMEvents(),Nt(this,"afterInit")}normalize(o,u){let p=o.touches,x=p?p.length?p.item(0):lt(p.changedTouches,o.changedTouches)[0]:o;u||(u=this.getChartPosition());let v=x.pageX-u.left,S=x.pageY-u.top;return et(o,{chartX:Math.round(v/=u.scaleX),chartY:Math.round(S/=u.scaleY)})}onContainerClick(o){let u=this.chart,p=u.hoverPoint,x=this.normalize(o),v=u.plotLeft,S=u.plotTop;!u.cancelClick&&(p&&this.inClass(x.target,"highcharts-tracker")?(Nt(p.series,"click",et(x,{point:p})),u.hoverPoint&&p.firePointEvent("click",x)):(et(x,this.getCoordinates(x)),u.isInsidePlot(x.chartX-v,x.chartY-S,{visiblePlotOnly:!0})&&Nt(u,"click",x)))}onContainerMouseDown(o){var p;let u=(1&(o.buttons||o.button))==1;o=this.normalize(o),Ie.isFirefox&&o.button!==0&&this.onContainerMouseMove(o),(o.button===void 0||u)&&(this.zoomOption(o),u&&((p=o.preventDefault)==null||p.call(o)),this.dragStart(o))}onContainerMouseLeave(o){let{pointer:u}=Ce[lt(Ct.hoverChartIndex,-1)]||{};o=this.normalize(o),this.onContainerMouseMove(o),u&&!this.inClass(o.relatedTarget,"highcharts-tooltip")&&(u.reset(),u.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(o){let u=this.chart,p=u.tooltip,x=this.normalize(o);this.setHoverChartIndex(o),(u.mouseIsDown==="mousedown"||this.touchSelect(x))&&this.drag(x),!u.openMenu&&(this.inClass(x.target,"highcharts-tracker")||u.isInsidePlot(x.chartX-u.plotLeft,x.chartY-u.plotTop,{visiblePlotOnly:!0}))&&!(p!=null&&p.shouldStickOnContact(x))&&(this.inClass(x.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(x))}onDocumentTouchEnd(o){this.onDocumentMouseUp(o)}onContainerTouchMove(o){this.touchSelect(o)?this.onContainerMouseMove(o):this.touch(o)}onContainerTouchStart(o){this.touchSelect(o)?this.onContainerMouseDown(o):(this.zoomOption(o),this.touch(o,!0))}onDocumentMouseMove(o){let u=this.chart,p=u.tooltip,x=this.chartPosition,v=this.normalize(o,x);!x||u.isInsidePlot(v.chartX-u.plotLeft,v.chartY-u.plotTop,{visiblePlotOnly:!0})||p!=null&&p.shouldStickOnContact(v)||v.target!==u.container.ownerDocument&&this.inClass(v.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(o){var u,p;(p=(u=Ce[lt(Ct.hoverChartIndex,-1)])==null?void 0:u.pointer)==null||p.drop(o)}pinch(o){let u=this,{chart:p,hasZoom:x,lastTouches:v}=u,S=[].map.call(o.touches||[],z=>u.normalize(z)),A=S.length,I=A===1&&(u.inClass(o.target,"highcharts-tracker")&&p.runTrackerClick||u.runChartClick),O=p.tooltip,N=A===1&&lt(O==null?void 0:O.options.followTouchMove,!0);A>1?u.initiated=!0:N&&(u.initiated=!1),x&&u.initiated&&!I&&o.cancelable!==!1&&o.preventDefault(),o.type==="touchstart"?(u.pinchDown=S,u.res=!0,p.mouseDownX=o.chartX):N?this.runPointActions(u.normalize(o)):v&&(Nt(p,"touchpan",{originalEvent:o,touches:S},()=>{let z=j=>{let q=j[0],K=j[1]||q;return{x:q.chartX,y:q.chartY,width:K.chartX-q.chartX,height:K.chartY-q.chartY}};p.transform({axes:p.axes.filter(j=>j.zoomEnabled&&(this.zoomHor&&j.horiz||this.zoomVert&&!j.horiz)),to:z(S),from:z(v),trigger:o.type})}),u.res&&(u.res=!1,this.reset(!1,0))),u.lastTouches=S}reset(o,u){let p=this.chart,x=p.hoverSeries,v=p.hoverPoint,S=p.hoverPoints,A=p.tooltip,I=A!=null&&A.shared?S:v;o&&I&&jt(I).forEach(function(O){O.series.isCartesian&&O.plotX===void 0&&(o=!1)}),o?A&&I&&jt(I).length&&(A.refresh(I),A.shared&&S?S.forEach(function(O){O.setState(O.state,!0),O.series.isCartesian&&(O.series.xAxis.crosshair&&O.series.xAxis.drawCrosshair(null,O),O.series.yAxis.crosshair&&O.series.yAxis.drawCrosshair(null,O))}):v&&(v.setState(v.state,!0),p.axes.forEach(function(O){O.crosshair&&v.series[O.coll]===O&&O.drawCrosshair(null,v)}))):(v&&v.onMouseOut(),S&&S.forEach(function(O){O.setState()}),x&&x.onMouseOut(),A&&A.hide(u),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),p.axes.forEach(function(O){O.hideCrosshair()}),p.hoverPoints=p.hoverPoint=void 0)}runPointActions(o,u,p){var se;let x=this.chart,v=x.series,S=(se=x.tooltip)!=null&&se.options.enabled?x.tooltip:void 0,A=!!S&&S.shared,I=u||x.hoverPoint,O=(I==null?void 0:I.series)||x.hoverSeries,N=(!o||o.type!=="touchmove")&&(!!u||(O==null?void 0:O.directTouch)&&this.isDirectTouch),z=this.getHoverData(I,O,v,N,A,o);I=z.hoverPoint,O=z.hoverSeries;let j=z.hoverPoints,q=(O==null?void 0:O.tooltipOptions.followPointer)&&!O.tooltipOptions.split,K=A&&O&&!O.noSharedTooltip;if(I&&(p||I!==x.hoverPoint||S!=null&&S.isHidden)){if((x.hoverPoints||[]).forEach(function(re){j.indexOf(re)===-1&&re.setState()}),x.hoverSeries!==O&&O.onMouseOver(),this.applyInactiveState(j),(j||[]).forEach(function(re){re.setState("hover")}),x.hoverPoint&&x.hoverPoint.firePointEvent("mouseOut"),!I.series)return;x.hoverPoints=j,x.hoverPoint=I,I.firePointEvent("mouseOver",void 0,()=>{S&&I&&S.refresh(K?j:I,o)})}else if(q&&S&&!S.isHidden){let re=S.getAnchor([{}],o);x.isInsidePlot(re[0],re[1],{visiblePlotOnly:!0})&&S.updatePosition({plotX:re[0],plotY:re[1]})}this.unDocMouseMove||(this.unDocMouseMove=Ne(x.container.ownerDocument,"mousemove",re=>{var te,ce;return(ce=(te=Ce[Ct.hoverChartIndex??-1])==null?void 0:te.pointer)==null?void 0:ce.onDocumentMouseMove(re)}),this.eventsToUnbind.push(this.unDocMouseMove)),x.axes.forEach(function(re){var fe;let te,ce=((fe=re.crosshair)==null?void 0:fe.snap)??!0;!ce||(te=x.hoverPoint)&&te.series[re.coll]===re||(te=ft(j,Xe=>{var Ue;return((Ue=Xe.series)==null?void 0:Ue[re.coll])===re})),te||!ce?re.drawCrosshair(o,te):re.hideCrosshair()})}setDOMEvents(){let o=this.chart.container,u=o.ownerDocument;o.onmousedown=this.onContainerMouseDown.bind(this),o.onmousemove=this.onContainerMouseMove.bind(this),o.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(Ne(o,"mouseenter",this.onContainerMouseEnter.bind(this)),Ne(o,"mouseleave",this.onContainerMouseLeave.bind(this))),Ct.unbindDocumentMouseUp.some(x=>x.doc===u)||Ct.unbindDocumentMouseUp.push({doc:u,unbind:Ne(u,"mouseup",this.onDocumentMouseUp.bind(this))});let p=this.chart.renderTo.parentElement;for(;p&&p.tagName!=="BODY";)this.eventsToUnbind.push(Ne(p,"scroll",()=>{delete this.chartPosition})),p=p.parentElement;this.eventsToUnbind.push(Ne(o,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),Ne(o,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),Ct.unbindDocumentTouchEnd||(Ct.unbindDocumentTouchEnd=Ne(u,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),Ne(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){var v,S;if(!Ge)return;let o=this.pointerCaptureEventsToUnbind,u=this.chart,p=u.container,x=lt((v=u.options.tooltip)==null?void 0:v.followTouchMove,!0)&&u.series.some(A=>A.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&x?(o.push(Ne(p,"pointerdown",A=>{var I,O;(I=A.target)!=null&&I.hasPointerCapture(A.pointerId)&&((O=A.target)==null||O.releasePointerCapture(A.pointerId))}),Ne(p,"pointermove",A=>{var I,O;(O=(I=u.pointer)==null?void 0:I.getPointFromEvent(A))==null||O.onMouseOver(A)})),u.styledMode||it(p,{"touch-action":"none"}),p.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!x&&(o.forEach(A=>A()),o.length=0,u.styledMode||it(p,{"touch-action":lt((S=u.options.chart.style)==null?void 0:S["touch-action"],"manipulation")}),p.className=p.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(o){var x;let u=this.chart,p=Ie.charts[lt(Ct.hoverChartIndex,-1)];if(p&&p!==u){let v={relatedTarget:u.container};o&&!(o!=null&&o.relatedTarget)&&Object.assign({},o,v),(x=p.pointer)==null||x.onContainerMouseLeave(o||v)}p!=null&&p.mouseIsDown||(Ct.hoverChartIndex=u.index)}touch(o,u){let p,{chart:x,pinchDown:v=[]}=this;this.setHoverChartIndex(),(o=this.normalize(o)).touches.length===1?x.isInsidePlot(o.chartX-x.plotLeft,o.chartY-x.plotTop,{visiblePlotOnly:!0})&&!x.openMenu?(u&&this.runPointActions(o),o.type==="touchmove"&&(p=!!v[0]&&Math.pow(v[0].chartX-o.chartX,2)+Math.pow(v[0].chartY-o.chartY,2)>=16),lt(p,!0)&&this.pinch(o)):u&&this.reset():o.touches.length===2&&this.pinch(o)}touchSelect(o){return!!(this.chart.zooming.singleTouch&&o.touches&&o.touches.length===1)}zoomOption(o){let u=this.chart,p=u.inverted,x=u.zooming.type||"",v,S;/touch/.test(o.type)&&(x=lt(u.zooming.pinchType,x)),this.zoomX=v=/x/.test(x),this.zoomY=S=/y/.test(x),this.zoomHor=v&&!p||S&&p,this.zoomVert=S&&!p||v&&p,this.hasZoom=v||S}}Ct.unbindDocumentMouseUp=[],function(R){R.compose=function(o){kt(ke,"Core.Pointer")&&Ne(o,"beforeRender",function(){this.pointer=new R(this,this.options)})}}(Ct||(Ct={}));let Ht=Ct;(function(R){R.setLength=function(o,u,p){return Array.isArray(o)?(o.length=u,o):o[p?"subarray":"slice"](0,u)},R.splice=function(o,u,p,x,v=[]){if(Array.isArray(o))return Array.isArray(v)||(v=Array.from(v)),{removed:o.splice(u,p,...v),array:o};let S=Object.getPrototypeOf(o).constructor,A=o[x?"subarray":"slice"](u,u+p),I=new S(o.length-p+v.length);return I.set(o.subarray(0,u),0),I.set(v,u),I.set(o.subarray(u+p),u+v.length),{removed:A,array:I}}})(ne||(ne={}));let{setLength:Ii,splice:Fi}=ne,{fireEvent:vi,objectEach:Pi,uniqueKey:Gi}=xe,Wi=class{constructor(R={}){this.autoId=!R.id,this.columns={},this.id=R.id||Gi(),this.modified=this,this.rowCount=0,this.versionTag=Gi();let o=0;Pi(R.columns||{},(u,p)=>{this.columns[p]=u.slice(),o=Math.max(o,u.length)}),this.applyRowCount(o)}applyRowCount(R){this.rowCount=R,Pi(this.columns,(o,u)=>{o.length!==R&&(this.columns[u]=Ii(o,R))})}deleteRows(R,o=1){if(o>0&&R<this.rowCount){let u=0;Pi(this.columns,(p,x)=>{this.columns[x]=Fi(p,R,o).array,u=p.length}),this.rowCount=u}vi(this,"afterDeleteRows",{rowIndex:R,rowCount:o}),this.versionTag=Gi()}getColumn(R,o){return this.columns[R]}getColumns(R,o){return(R||Object.keys(this.columns)).reduce((u,p)=>(u[p]=this.columns[p],u),{})}getRow(R,o){return(o||Object.keys(this.columns)).map(u=>{var p;return(p=this.columns[u])==null?void 0:p[R]})}setColumn(R,o=[],u=0,p){this.setColumns({[R]:o},u,p)}setColumns(R,o,u){let p=this.rowCount;Pi(R,(x,v)=>{this.columns[v]=x.slice(),p=x.length}),this.applyRowCount(p),u!=null&&u.silent||(vi(this,"afterSetColumns"),this.versionTag=Gi())}setRow(R,o=this.rowCount,u,p){let{columns:x}=this,v=u?this.rowCount+1:o+1;Pi(R,(S,A)=>{let I=x[A]||(p==null?void 0:p.addColumns)!==!1&&Array(v);I&&(u?I=Fi(I,o,0,!0,[S]).array:I[o]=S,x[A]=I)}),v>this.rowCount&&this.applyRowCount(v),p!=null&&p.silent||(vi(this,"afterSetRows"),this.versionTag=Gi())}},{extend:Ci,merge:Ar,pick:Lr}=xe;(function(R){function o(u,p,x){var Xe,Ue;let v=this.legendItem=this.legendItem||{},{chart:S,options:A}=this,{baseline:I=0,symbolWidth:O,symbolHeight:N}=u,z=this.symbol||"circle",j=N/2,q=S.renderer,K=v.group,se=I-Math.round((((Xe=u.fontMetrics)==null?void 0:Xe.b)||N)*(x?.4:.3)),re={},te,ce=A.marker,fe=0;if(S.styledMode||(re["stroke-width"]=Math.min(A.lineWidth||0,24),A.dashStyle?re.dashstyle=A.dashStyle:A.linecap==="square"||(re["stroke-linecap"]="round")),v.line=q.path().addClass("highcharts-graph").attr(re).add(K),x&&(v.area=q.path().addClass("highcharts-area").add(K)),re["stroke-linecap"]&&(fe=Math.min(v.line.strokeWidth(),O)/2),O){let $e=[["M",fe,se],["L",O-fe,se]];v.line.attr({d:$e}),(Ue=v.area)==null||Ue.attr({d:[...$e,["L",O-fe,I],["L",fe,I]]})}if(ce&&ce.enabled!==!1&&O){let $e=Math.min(Lr(ce.radius,j),j);z.indexOf("url")===0&&(ce=Ar(ce,{width:N,height:N}),$e=0),v.symbol=te=q.symbol(z,O/2-$e,se-$e,2*$e,2*$e,Ci({context:"legend"},ce)).addClass("highcharts-point").add(K),te.isMarker=!0}}R.areaMarker=function(u,p){o.call(this,u,p,!0)},R.lineMarker=o,R.rectangle=function(u,p){let x=p.legendItem||{},v=u.options,S=u.symbolHeight,A=v.squareSymbol,I=A?S:u.symbolWidth;x.symbol=this.chart.renderer.rect(A?(u.symbolWidth-S)/2:0,u.baseline-S+1,I,S,Lr(u.options.symbolRadius,S/2)).addClass("highcharts-point").attr({zIndex:3}).add(x.group)}})(ue||(ue={}));let Dr=ue,{defaultOptions:Or}=Le,{extend:gs,extendClass:is,merge:ro}=xe;(function(R){function o(u,p){let x=Or.plotOptions||{},v=p.defaultOptions,S=p.prototype;return S.type=u,S.pointClass||(S.pointClass=ee),!R.seriesTypes[u]&&(v&&(x[u]=v),R.seriesTypes[u]=p,!0)}R.seriesTypes=Ie.seriesTypes,R.registerSeriesType=o,R.seriesType=function(u,p,x,v,S){let A=Or.plotOptions||{};if(p=p||"",A[u]=ro(A[p],x),delete R.seriesTypes[u],o(u,is(R.seriesTypes[p]||function(){},v)),R.seriesTypes[u].prototype.type=u,S){class I extends ee{}gs(I.prototype,S),R.seriesTypes[u].prototype.pointClass=I}return R.seriesTypes[u]}})(we||(we={}));let kr=we,{animObject:Zr,setAnimation:Ur}=En,{defaultOptions:mr}=Le,{registerEventOptions:Fn}=Yc,{svg:Es,win:Yr}=Ie,{seriesTypes:Wn}=kr,{format:hu}=ds,{arrayMax:Ta,arrayMin:dc,clamp:Yo,correctFloat:Ea,crisp:wl,defined:vn,destroyObjectProperties:ah,diffObjects:Rd,erase:Dm,error:zd,extend:uu,find:Om,fireEvent:fn,getClosestDistance:__,getNestedProperty:np,insertItem:Bd,isArray:Xa,isNumber:Gn,isString:y_,merge:du,objectEach:Rm,pick:Cn,removeEvent:Hx,syncTimeout:sp}=xe;class Gs{constructor(){this.zoneAxis="y"}init(o,u){var I,O,N;let p;fn(this,"init",{options:u}),this.dataTable??(this.dataTable=new Wi);let x=o.series;this.eventsToUnbind=[],this.chart=o,this.options=this.setOptions(u);let v=this.options,S=v.visible!==!1;this.linkedSeries=[],this.bindAxes(),uu(this,{name:v.name,state:"",visible:S,selected:v.selected===!0}),Fn(this,v);let A=v.events;(A!=null&&A.click||(O=(I=v.point)==null?void 0:I.events)!=null&&O.click||v.allowPointSelect)&&(o.runTrackerClick=!0),this.getColor(),this.getSymbol(),this.isCartesian&&(o.hasCartesianSeries=!0),x.length&&(p=x[x.length-1]),this._i=Cn(p==null?void 0:p._i,-1)+1,this.opacity=this.options.opacity,o.orderItems("series",Bd(this,x)),(N=v.dataSorting)!=null&&N.enabled?this.setDataSortingOptions():this.points||this.data||this.setData(v.data,!1),fn(this,"afterInit")}is(o){return Wn[o]&&this instanceof Wn[o]}bindAxes(){let o,u=this,p=u.options,x=u.chart;fn(this,"bindAxes",null,function(){(u.axisTypes||[]).forEach(function(v){(x[v]||[]).forEach(function(S){o=S.options,(Cn(p[v],0)===S.index||p[v]!==void 0&&p[v]===o.id)&&(Bd(u,S.series),u[v]=S,S.isDirty=!0)}),u[v]||u.optionalAxis===v||zd(18,!0,x)})}),fn(this,"afterBindAxes")}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.dataTable.rowCount>0}hasMarkerChanged(o,u){let p=o.marker,x=u.marker||{};return p&&(x.enabled&&!p.enabled||x.symbol!==p.symbol||x.height!==p.height||x.width!==p.width)}autoIncrement(o){let u,p=this.options,{pointIntervalUnit:x,relativeXValue:v}=this.options,S=this.chart.time,A=this.xIncrement??S.parse(p.pointStart)??0;if(this.pointInterval=u=Cn(this.pointInterval,p.pointInterval,1),v&&Gn(o)&&(u*=o),x){let I=S.toParts(A);x==="day"?I[2]+=u:x==="month"?I[1]+=u:x==="year"&&(I[0]+=u),u=S.makeTime.apply(S,I)-A}return v&&Gn(o)?A+u:(this.xIncrement=A+u,A)}setDataSortingOptions(){let o=this.options;uu(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),vn(o.pointRange)||(o.pointRange=1)}setOptions(o){var re,te;let u,p=this.chart,x=p.options.plotOptions,v=p.userOptions||{},S=du(o),A=p.styledMode,I={plotOptions:x,userOptions:S};fn(this,"setOptions",I);let O=I.plotOptions[this.type],N=v.plotOptions||{},z=N.series||{},j=mr.plotOptions[this.type]||{},q=N[this.type]||{};O.dataLabels=this.mergeArrays(j.dataLabels,O.dataLabels),this.userOptions=I.userOptions;let K=du(O,x.series,q,S);this.tooltipOptions=du(mr.tooltip,(re=mr.plotOptions.series)==null?void 0:re.tooltip,j==null?void 0:j.tooltip,p.userOptions.tooltip,(te=N.series)==null?void 0:te.tooltip,q.tooltip,S.tooltip),this.stickyTracking=Cn(S.stickyTracking,q.stickyTracking,z.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||K.stickyTracking),O.marker===null&&delete K.marker,this.zoneAxis=K.zoneAxis||"y";let se=this.zones=(K.zones||[]).map(ce=>({...ce}));return(K.negativeColor||K.negativeFillColor)&&!K.zones&&(u={value:K[this.zoneAxis+"Threshold"]||K.threshold||0,className:"highcharts-negative"},A||(u.color=K.negativeColor,u.fillColor=K.negativeFillColor),se.push(u)),se.length&&vn(se[se.length-1].value)&&se.push(A?{}:{color:this.color,fillColor:this.fillColor}),fn(this,"afterSetOptions",{options:K}),K}getName(){return this.options.name??hu(this.chart.options.lang.seriesName,this,this.chart)}getCyclic(o,u,p){let x,v,S=this.chart,A=`${o}Index`,I=`${o}Counter`,O=(p==null?void 0:p.length)||S.options.chart.colorCount;!u&&(vn(v=Cn(o==="color"?this.options.colorIndex:void 0,this[A]))?x=v:(S.series.length||(S[I]=0),x=S[I]%O,S[I]+=1),p&&(u=p[x])),x!==void 0&&(this[A]=x),this[o]=u}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||mr.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let o=this.options.marker;this.getCyclic("symbol",o.symbol,this.chart.options.symbols)}getColumn(o,u){return(u?this.dataTable.modified:this.dataTable).getColumn(o,!0)||[]}findPointIndex(o,u){var z;let p,x,v,{id:S,x:A}=o,I=this.points,O=this.options.dataSorting,N=this.cropStart||0;if(S){let j=this.chart.get(S);j instanceof ee&&(p=j)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let j=q=>!q.touched&&q.index===o.index;if(O!=null&&O.matchByName?j=q=>!q.touched&&q.name===o.name:this.options.relativeXValue&&(j=q=>!q.touched&&q.options.x===o.x),!(p=Om(I,j)))return}return p&&(v=p==null?void 0:p.index)!==void 0&&(x=!0),v===void 0&&Gn(A)&&(v=this.getColumn("x").indexOf(A,u)),v!==-1&&v!==void 0&&this.cropped&&(v=v>=N?v-N:v),!x&&Gn(v)&&((z=I[v])!=null&&z.touched)&&(v=void 0),v}updateData(o,u){var se;let{options:p,requireSorting:x}=this,v=p.dataSorting,S=this.points,A=[],I=o.length===S.length,O,N,z,j,q=!0;if(this.xIncrement=null,o.forEach((re,te)=>{var $e;let ce,fe=vn(re)&&this.pointClass.prototype.optionsToObject.call({series:this},re)||{},{id:Xe,x:Ue}=fe;Xe||Gn(Ue)?((ce=this.findPointIndex(fe,j))===-1||ce===void 0?A.push(re):S[ce]&&re!==(($e=p.data)==null?void 0:$e[ce])?(S[ce].update(re,!1,void 0,!1),S[ce].touched=!0,x&&(j=ce+1)):S[ce]&&(S[ce].touched=!0),(!I||te!==ce||v!=null&&v.enabled||this.hasDerivedData)&&(O=!0)):A.push(re)},this),O)for(N=S.length;N--;)(z=S[N])&&!z.touched&&((se=z.remove)==null||se.call(z,!1,u));else I&&!(v!=null&&v.enabled)?(o.forEach((re,te)=>{re===S[te].y||S[te].destroyed||S[te].update(re,!1,void 0,!1)}),A.length=0):q=!1;if(S.forEach(re=>{re&&(re.touched=!1)}),!q)return!1;A.forEach(re=>{this.addPoint(re,!1,void 0,void 0,!1)},this);let K=this.getColumn("x");return this.xIncrement===null&&K.length&&(this.xIncrement=Ta(K),this.autoIncrement()),!0}dataColumnKeys(){return["x",...this.pointArrayMap||["y"]]}setData(o,u=!0,p,x){var pt,tt;let v=this.points,S=(v==null?void 0:v.length)||0,A=this.options,I=this.chart,O=A.dataSorting,N=this.xAxis,z=A.turboThreshold,j=this.dataTable,q=this.dataColumnKeys(),K=this.pointValKey||"y",se=(this.pointArrayMap||[]).length,re=A.keys,te,ce,fe=0,Xe=1,Ue;I.options.chart.allowMutatingData||(A.data&&delete this.options.data,this.userOptions.data&&delete this.userOptions.data,Ue=du(!0,o));let $e=(o=Ue||o||[]).length;if(O!=null&&O.enabled&&(o=this.sortData(o)),I.options.chart.allowMutatingData&&x!==!1&&$e&&S&&!this.cropped&&!this.hasGroupedData&&this.visible&&!this.boosted&&(ce=this.updateData(o,p)),!ce){this.xIncrement=null,this.colorCounter=0;let mt=z&&$e>z;if(mt){let Bt=this.getFirstValidPoint(o),Yt=this.getFirstValidPoint(o,$e-1,-1),ei=Ft=>!!(Xa(Ft)&&(re||Gn(Ft[0])));if(Gn(Bt)&&Gn(Yt)){let Ft=[],ci=[];for(let mi of o)Ft.push(this.autoIncrement()),ci.push(mi);j.setColumns({x:Ft,[K]:ci})}else if(ei(Bt)&&ei(Yt))if(se){let Ft=+(Bt.length===se),ci=Array(q.length).fill(0).map(()=>[]);for(let mi of o){Ft&&ci[0].push(this.autoIncrement());for(let Ni=Ft;Ni<=se;Ni++)(pt=ci[Ni])==null||pt.push(mi[Ni-Ft])}j.setColumns(q.reduce((mi,Ni,bi)=>(mi[Ni]=ci[bi],mi),{}))}else{re&&(fe=re.indexOf("x"),Xe=re.indexOf("y"),fe=fe>=0?fe:0,Xe=Xe>=0?Xe:1),Bt.length===1&&(Xe=0);let Ft=[],ci=[];if(fe===Xe)for(let mi of o)Ft.push(this.autoIncrement()),ci.push(mi[Xe]);else for(let mi of o)Ft.push(mi[fe]),ci.push(mi[Xe]);j.setColumns({x:Ft,[K]:ci})}else mt=!1}if(!mt){let Bt=q.reduce((Yt,ei)=>(Yt[ei]=[],Yt),{});for(te=0;te<$e;te++){let Yt=this.pointClass.prototype.applyOptions.apply({series:this},[o[te]]);for(let ei of q)Bt[ei][te]=Yt[ei]}j.setColumns(Bt)}for(y_(this.getColumn("y")[0])&&zd(14,!0,I),this.data=[],this.options.data=this.userOptions.data=o,te=S;te--;)(tt=v[te])==null||tt.destroy();N&&(N.minRange=N.userMinRange),this.isDirty=I.isDirtyBox=!0,this.isDirtyData=!!v,p=!1}A.legendType==="point"&&(this.processData(),this.generatePoints()),u&&I.redraw(p)}sortData(o){let u=this,p=u.options.dataSorting.sortKey||"y",x=function(v,S){return vn(S)&&v.pointClass.prototype.optionsToObject.call({series:v},S)||{}};return o.forEach(function(v,S){o[S]=x(u,v),o[S].index=S},this),o.concat().sort((v,S)=>{let A=np(p,v),I=np(p,S);return I<A?-1:+(I>A)}).forEach(function(v,S){v.x=S},this),u.linkedSeries&&u.linkedSeries.forEach(function(v){var I;let S=v.options,A=S.data;!((I=S.dataSorting)!=null&&I.enabled)&&A&&(A.forEach(function(O,N){A[N]=x(v,O),o[N]&&(A[N].x=o[N].x,A[N].index=N)}),v.setData(A,!1))}),o}getProcessedData(o){let u=this,{dataTable:p,isCartesian:x,options:v,xAxis:S}=u,A=v.cropThreshold,I=o||u.getExtremesFromAll,O=S==null?void 0:S.logarithmic,N=p.rowCount,z,j,q=0,K,se,re,te=u.getColumn("x"),ce=p,fe=!1;return S&&(se=(K=S.getExtremes()).min,re=K.max,fe=!!(S.categories&&!S.names.length),x&&u.sorted&&!I&&(!A||N>A||u.forceCrop)&&(te[N-1]<se||te[0]>re?ce=new Wi:u.getColumn(u.pointValKey||"y").length&&(te[0]<se||te[N-1]>re)&&(ce=(z=this.cropData(p,se,re)).modified,q=z.start,j=!0))),te=ce.getColumn("x")||[],{modified:ce,cropped:j,cropStart:q,closestPointRange:__([O?te.map(O.log2lin):te],()=>u.requireSorting&&!fe&&zd(15,!1,u.chart))}}processData(o){let u=this.xAxis,p=this.dataTable;if(this.isCartesian&&!this.isDirty&&!u.isDirty&&!this.yAxis.isDirty&&!o)return!1;let x=this.getProcessedData();p.modified=x.modified,this.cropped=x.cropped,this.cropStart=x.cropStart,this.closestPointRange=this.basePointRange=x.closestPointRange,fn(this,"afterProcessData")}cropData(o,u,p){let x=o.getColumn("x",!0)||[],v=x.length,S={},A,I,O=0,N=v;for(A=0;A<v;A++)if(x[A]>=u){O=Math.max(0,A-1);break}for(I=A;I<v;I++)if(x[I]>p){N=I+1;break}for(let z of this.dataColumnKeys()){let j=o.getColumn(z,!0);j&&(S[z]=j.slice(O,N))}return{modified:new Wi({columns:S}),start:O,end:N}}generatePoints(){var Ue,$e,pt;let o=this.options,u=this.processedData||o.data,p=this.dataTable.modified,x=this.getColumn("x",!0),v=this.pointClass,S=p.rowCount,A=this.cropStart||0,I=this.hasGroupedData,O=o.keys,N=[],z=(Ue=o.dataGrouping)!=null&&Ue.groupAll?A:0,j=($e=this.xAxis)==null?void 0:$e.categories,q=this.pointArrayMap||["y"],K=this.dataColumnKeys(),se,re,te,ce,fe=this.data,Xe;if(!fe&&!I){let tt=[];tt.length=(u==null?void 0:u.length)||0,fe=this.data=tt}for(O&&I&&(this.options.keys=!1),ce=0;ce<S;ce++)re=A+ce,I?((te=new v(this,p.getRow(ce,K)||[])).dataGroup=this.groupMap[z+ce],(pt=te.dataGroup)!=null&&pt.options&&(te.options=te.dataGroup.options,uu(te,te.dataGroup.options),delete te.dataLabels)):(te=fe[re],Xe=u?u[re]:p.getRow(ce,q),te||Xe===void 0||(fe[re]=te=new v(this,Xe,x[ce]))),te&&(te.index=I?z+ce:re,N[ce]=te,te.category=(j==null?void 0:j[te.x])??te.x,te.key=te.name??te.category);if(this.options.keys=O,fe&&(S!==(se=fe.length)||I))for(ce=0;ce<se;ce++)ce!==A||I||(ce+=S),fe[ce]&&(fe[ce].destroyElements(),fe[ce].plotX=void 0);this.data=fe,this.points=N,fn(this,"afterGeneratePoints")}getXExtremes(o){return{min:dc(o),max:Ta(o)}}getExtremes(o,u){var Ue;let{xAxis:p,yAxis:x}=this,v=u||this.getExtremesFromAll||this.options.getExtremesFromAll,S=v&&this.cropped?this.dataTable:this.dataTable.modified,A=S.rowCount,I=o||this.stackedYData,O=I?[I]:((Ue=this.keysAffectYAxis||this.pointArrayMap||["y"])==null?void 0:Ue.map($e=>S.getColumn($e,!0)||[]))||[],N=this.getColumn("x",!0),z=[],j=this.requireSorting&&!this.is("column")?1:0,q=!!x&&x.positiveValuesOnly,K=v||this.cropped||!p,se,re,te,ce=0,fe=0;for(p&&(ce=(se=p.getExtremes()).min,fe=se.max),te=0;te<A;te++)if(re=N[te],K||(N[te+j]||re)>=ce&&(N[te-j]||re)<=fe)for(let $e of O){let pt=$e[te];Gn(pt)&&(pt>0||!q)&&z.push(pt)}let Xe={activeYData:z,dataMin:dc(z),dataMax:Ta(z)};return fn(this,"afterGetExtremes",{dataExtremes:Xe}),Xe}applyExtremes(){let o=this.getExtremes();return this.dataMin=o.dataMin,this.dataMax=o.dataMax,o}getFirstValidPoint(o,u=0,p=1){let x=o.length,v=u;for(;v>=0&&v<x;){if(vn(o[v]))return o[v];v+=p}}translate(){var fe;this.generatePoints();let o=this.options,u=o.stacking,p=this.xAxis,x=this.enabledDataSorting,v=this.yAxis,S=this.points,A=S.length,I=this.pointPlacementToXValue(),O=!!I,N=o.threshold,z=o.startFromThreshold?N:0,j=(o==null?void 0:o.nullInteraction)&&v.len,q,K,se,re,te=Number.MAX_VALUE;function ce(Xe){return Yo(Xe,-1e9,1e9)}for(q=0;q<A;q++){let Xe,Ue=S[q],$e=Ue.x,pt,tt,mt=Ue.y,Bt=Ue.low,Yt=u&&((fe=v.stacking)==null?void 0:fe.stacks[(this.negStacks&&mt<(z?0:N)?"-":"")+this.stackKey]);Ue.plotX=Gn(K=p.translate($e,!1,!1,!1,!0,I))?Ea(ce(K)):void 0,u&&this.visible&&Yt&&Yt[$e]&&(re=this.getStackIndicator(re,$e,this.index),!Ue.isNull&&re.key&&(tt=(pt=Yt[$e]).points[re.key]),pt&&Xa(tt)&&(Bt=tt[0],mt=tt[1],Bt===z&&re.key===Yt[$e].base&&(Bt=Cn(Gn(N)?N:v.min)),v.positiveValuesOnly&&vn(Bt)&&Bt<=0&&(Bt=void 0),Ue.total=Ue.stackTotal=Cn(pt.total),Ue.percentage=vn(Ue.y)&&pt.total?Ue.y/pt.total*100:void 0,Ue.stackY=mt,this.irregularWidths||pt.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),Ue.yBottom=vn(Bt)?ce(v.translate(Bt,!1,!0,!1,!0)):void 0,this.dataModify&&(mt=this.dataModify.modifyValue(mt,q)),Gn(mt)&&Ue.plotX!==void 0?Xe=Gn(Xe=v.translate(mt,!1,!0,!1,!0))?ce(Xe):void 0:!Gn(mt)&&j&&(Xe=j),Ue.plotY=Xe,Ue.isInside=this.isPointInside(Ue),Ue.clientX=O?Ea(p.translate($e,!1,!1,!1,!0,I)):K,Ue.negative=(Ue.y||0)<(N||0),Ue.isNull||Ue.visible===!1||(se!==void 0&&(te=Math.min(te,Math.abs(K-se))),se=K),Ue.zone=this.zones.length?Ue.getZone():void 0,!Ue.graphic&&this.group&&x&&(Ue.isNew=!0)}this.closestPointRangePx=te,fn(this,"afterTranslate")}getValidPoints(o,u,p){let x=this.chart;return(o||this.points||[]).filter(function(v){let{plotX:S,plotY:A}=v;return!!((p||!v.isNull&&Gn(A))&&(!u||x.isInsidePlot(S,A,{inverted:x.inverted})))&&v.visible!==!1})}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:o,group:u,markerGroup:p}=this,x=o.sharedClips,v=o.renderer,S=o.getClipBox(this),A=this.getSharedClipKey(),I=x[A];I?I.animate(S):x[A]=I=v.clipRect(S),u&&u.clip(this.options.clip===!1?void 0:I),p&&p.clip()}animate(o){let{chart:u,group:p,markerGroup:x}=this,v=u.inverted,S=Zr(this.options.animation),A=[this.getSharedClipKey(),S.duration,S.easing,S.defer].join(","),I=u.sharedClips[A],O=u.sharedClips[A+"m"];if(o&&p){let N=u.getClipBox(this);if(I)I.attr("height",N.height);else{N.width=0,v&&(N.x=u.plotHeight),I=u.renderer.clipRect(N),u.sharedClips[A]=I;let z={x:-99,y:-99,width:v?u.plotWidth+199:99,height:v?99:u.plotHeight+199};O=u.renderer.clipRect(z),u.sharedClips[A+"m"]=O}p.clip(I),x==null||x.clip(O)}else if(I&&!I.hasClass("highcharts-animating")){let N=u.getClipBox(this),z=S.step;(x!=null&&x.element.childNodes.length||u.series.length>1)&&(S.step=function(j,q){z&&z.apply(q,arguments),q.prop==="width"&&(O!=null&&O.element)&&O.attr(v?"height":"width",j+99)}),I.addClass("highcharts-animating").animate(N,S)}}afterAnimate(){this.setClip(),Rm(this.chart.sharedClips,(o,u,p)=>{o&&!this.chart.container.querySelector(`[clip-path="url(#${o.id})"]`)&&(o.destroy(),delete p[u])}),this.finishedAnimating=!0,fn(this,"afterAnimate")}drawPoints(o=this.points){let u,p,x,v,S,A,I,O=this.chart,N=O.styledMode,{colorAxis:z,options:j}=this,q=j.marker,K=j.nullInteraction,se=this[this.specialGroup||"markerGroup"],re=this.xAxis,te=Cn(q.enabled,!re||!!re.isRadial||null,this.closestPointRangePx>=q.enabledThreshold*q.radius);if(q.enabled!==!1||this._hasPointMarkers)for(u=0;u<o.length;u++){v=(x=(p=o[u]).graphic)?"animate":"attr",S=p.marker||{},A=!!p.marker;let ce=p.isNull;if((te&&!vn(S.enabled)||S.enabled)&&(!ce||K)&&p.visible!==!1){let fe=Cn(S.symbol,this.symbol,"rect");I=this.markerAttribs(p,p.selected&&"select"),this.enabledDataSorting&&(p.startXPos=re.reversed?-(I.width||0):re.width);let Xe=p.isInside!==!1;if(!x&&Xe&&((I.width||0)>0||p.hasImage)&&(p.graphic=x=O.renderer.symbol(fe,I.x,I.y,I.width,I.height,A?S:q).add(se),this.enabledDataSorting&&O.hasRendered&&(x.attr({x:p.startXPos}),v="animate")),x&&v==="animate"&&x[Xe?"show":"hide"](Xe).animate(I),x){let Ue=this.pointAttribs(p,N||!p.selected?void 0:"select");N?z&&x.css({fill:Ue.fill}):x[v](Ue)}x&&x.addClass(p.getClassName(),!0)}else x&&(p.graphic=x.destroy())}}markerAttribs(o,u){let p=this.options,x=p.marker,v=o.marker||{},S=v.symbol||x.symbol,A={},I,O,N=Cn(v.radius,x==null?void 0:x.radius);u&&(I=x.states[u],O=v.states&&v.states[u],N=Cn(O==null?void 0:O.radius,I==null?void 0:I.radius,N&&N+((I==null?void 0:I.radiusPlus)||0))),o.hasImage=S&&S.indexOf("url")===0,o.hasImage&&(N=0);let z=o.pos();return Gn(N)&&z&&(p.crisp&&(z[0]=wl(z[0],o.hasImage?0:S==="rect"?(x==null?void 0:x.lineWidth)||0:1)),A.x=z[0]-N,A.y=z[1]-N),N&&(A.width=A.height=2*N),A}pointAttribs(o,u){var te;let p=this.options,x=p.marker,v=o==null?void 0:o.options,S=(v==null?void 0:v.marker)||{},A=v==null?void 0:v.color,I=o==null?void 0:o.color,O=(te=o==null?void 0:o.zone)==null?void 0:te.color,N,z,j=this.color,q,K,se=Cn(S.lineWidth,x.lineWidth),re=o!=null&&o.isNull&&p.nullInteraction?0:1;return j=A||O||I||j,q=S.fillColor||x.fillColor||j,K=S.lineColor||x.lineColor||j,u=u||"normal",N=x.states[u]||{},se=Cn((z=S.states&&S.states[u]||{}).lineWidth,N.lineWidth,se+Cn(z.lineWidthPlus,N.lineWidthPlus,0)),q=z.fillColor||N.fillColor||q,K=z.lineColor||N.lineColor||K,{stroke:K,"stroke-width":se,fill:q,opacity:re=Cn(z.opacity,N.opacity,re)}}destroy(o){var I,O;let u,p,x=this,v=x.chart,S=/AppleWebKit\/533/.test(Yr.navigator.userAgent),A=x.data||[];for(fn(x,"destroy",{keepEventsForUpdate:o}),this.removeEvents(o),(x.axisTypes||[]).forEach(function(N){p=x[N],p!=null&&p.series&&(Dm(p.series,x),p.isDirty=p.forceRedraw=!0)}),x.legendItem&&x.chart.legend.destroyItem(x),u=A.length;u--;)(O=(I=A[u])==null?void 0:I.destroy)==null||O.call(I);for(let N of x.zones)ah(N,void 0,!0);xe.clearTimeout(x.animationTimeout),Rm(x,function(N,z){N instanceof es&&!N.survive&&N[S&&z==="group"?"hide":"destroy"]()}),v.hoverSeries===x&&(v.hoverSeries=void 0),Dm(v.series,x),v.orderItems("series"),Rm(x,function(N,z){o&&z==="hcEvents"||delete x[z]})}applyZones(){let{area:o,chart:u,graph:p,zones:x,points:v,xAxis:S,yAxis:A,zoneAxis:I}=this,{inverted:O,renderer:N}=u,z=this[`${I}Axis`],{isXAxis:j,len:q=0,minPointOffset:K=0}=z||{},se=((p==null?void 0:p.strokeWidth())||0)/2+1,re=(te,ce=0,fe=0)=>{O&&(fe=q-fe);let{translated:Xe=0,lineClip:Ue}=te,$e=fe-Xe;Ue==null||Ue.push(["L",ce,Math.abs($e)<se?fe-se*($e<=0?-1:1):Xe])};if(x.length&&(p||o)&&z&&Gn(z.min)){let te=z.getExtremes().max+K,ce=Ue=>{Ue.forEach(($e,pt)=>{($e[0]==="M"||$e[0]==="L")&&(Ue[pt]=[$e[0],j?q-$e[1]:$e[1],j?$e[2]:q-$e[2]])})};if(x.forEach(Ue=>{Ue.lineClip=[],Ue.translated=Yo(z.toPixels(Cn(Ue.value,te),!0)||0,0,q)}),p&&!this.showLine&&p.hide(),o&&o.hide(),I==="y"&&v.length<S.len)for(let Ue of v){let{plotX:$e,plotY:pt,zone:tt}=Ue,mt=tt&&x[x.indexOf(tt)-1];tt&&re(tt,$e,pt),mt&&re(mt,$e,pt)}let fe=[],Xe=z.toPixels(z.getExtremes().min-K,!0);x.forEach(Ue=>{var Ni,bi;let $e=Ue.lineClip||[],pt=Math.round(Ue.translated||0);S.reversed&&$e.reverse();let{clip:tt,simpleClip:mt}=Ue,Bt=0,Yt=0,ei=S.len,Ft=A.len;j?(Bt=pt,ei=Xe):(Yt=pt,Ft=Xe);let ci=[["M",Bt,Yt],["L",ei,Yt],["L",ei,Ft],["L",Bt,Ft],["Z"]],mi=[ci[0],...$e,ci[1],ci[2],...fe,ci[3],ci[4]];fe=$e.reverse(),Xe=pt,O&&(ce(mi),o&&ce(ci)),tt?(tt.animate({d:mi}),mt==null||mt.animate({d:ci})):(tt=Ue.clip=N.path(mi),o&&(mt=Ue.simpleClip=N.path(ci))),p&&((Ni=Ue.graph)==null||Ni.clip(tt)),o&&((bi=Ue.area)==null||bi.clip(mt))})}else this.visible&&(p&&p.show(),o&&o.show())}plotGroup(o,u,p,x,v){let S=this[o],A=!S,I={visibility:p,zIndex:x||.1};return vn(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(I.opacity=this.opacity),S||(this[o]=S=this.chart.renderer.g().add(v)),S.addClass("highcharts-"+u+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(vn(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(S.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),S.attr(I)[A?"attr":"animate"](this.getPlotBox(u)),S}getPlotBox(o){let u=this.xAxis,p=this.yAxis,x=this.chart,v=x.inverted&&!x.polar&&u&&this.invertible&&o==="series";return x.inverted&&(u=p,p=this.xAxis),{translateX:u?u.left:x.plotLeft,translateY:p?p.top:x.plotTop,rotation:90*!!v,rotationOriginX:v?(u.len-p.len)/2:0,rotationOriginY:v?(u.len+p.len)/2:0,scaleX:v?-1:1,scaleY:1}}removeEvents(o){let{eventsToUnbind:u}=this;o||Hx(this),u.length&&(u.forEach(p=>{p()}),u.length=0)}render(){var N,z,j,q,K;let o=this,{chart:u,options:p,hasRendered:x}=o,v=Zr(p.animation),S=o.visible?"inherit":"hidden",A=p.zIndex,I=u.seriesGroup,O=o.finishedAnimating?0:v.duration;fn(this,"render"),o.plotGroup("group","series",S,A,I),o.markerGroup=o.plotGroup("markerGroup","markers",S,A,I),p.clip!==!1&&o.setClip(),O&&((N=o.animate)==null||N.call(o,!0)),o.drawGraph&&(o.drawGraph(),o.applyZones()),o.visible&&o.drawPoints(),(z=o.drawDataLabels)==null||z.call(o),(j=o.redrawPoints)==null||j.call(o),p.enableMouseTracking&&((q=o.drawTracker)==null||q.call(o)),O&&((K=o.animate)==null||K.call(o)),x||(O&&v.defer&&(O+=v.defer),o.animationTimeout=sp(()=>{o.afterAnimate()},O||0)),o.isDirty=!1,o.hasRendered=!0,fn(o,"afterRender")}redraw(){let o=this.isDirty||this.isDirtyData;this.translate(),this.render(),o&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(o,u){let{xAxis:p,yAxis:x}=this,v=this.chart.inverted;return this.searchKDTree({clientX:v?p.len-o.chartY+p.pos:o.chartX-p.pos,plotY:v?x.len-o.chartX+x.pos:o.chartY-x.pos},u,o)}buildKDTree(o){this.buildingKdTree=!0;let u=this,p=u.options,x=p.findNearestPointBy.indexOf("y")>-1?2:1;delete u.kdTree,sp(function(){u.kdTree=function v(S,A,I){let O,N,z=S==null?void 0:S.length;if(z)return O=u.kdAxisArray[A%I],S.sort((j,q)=>(j[O]||0)-(q[O]||0)),{point:S[N=Math.floor(z/2)],left:v(S.slice(0,N),A+1,I),right:v(S.slice(N+1),A+1,I)}}(u.getValidPoints(void 0,!u.directTouch,p==null?void 0:p.nullInteraction),x,x),u.buildingKdTree=!1},p.kdNow||(o==null?void 0:o.type)==="touchstart"?0:1)}searchKDTree(o,u,p,x,v){let S=this,[A,I]=this.kdAxisArray,O=u?"distX":"dist",N=(S.options.findNearestPointBy||"").indexOf("y")>-1?2:1,z=!!S.isBubble,j=x||((K,se,re)=>{let te=K[re]||0,ce=se[re]||0;return[te===ce&&K.index>se.index||te<ce?K:se,!1]}),q=v||((K,se)=>K<se);if(this.kdTree||this.buildingKdTree||this.buildKDTree(p),this.kdTree)return function K(se,re,te,ce){var Bt;let fe=re.point,Xe=S.kdAxisArray[te%ce],Ue=fe,$e=!1;(function(Yt,ei){var ar;let Ft=Yt[A],ci=ei[A],mi=vn(Ft)&&vn(ci)?Ft-ci:null,Ni=Yt[I],bi=ei[I],Vi=vn(Ni)&&vn(bi)?Ni-bi:0,gr=z&&((ar=ei.marker)==null?void 0:ar.radius)||0;ei.dist=Math.sqrt((mi&&mi*mi||0)+Vi*Vi)-gr,ei.distX=vn(mi)?Math.abs(mi)-gr:Number.MAX_VALUE})(se,fe);let pt=(se[Xe]||0)-(fe[Xe]||0)+(z&&((Bt=fe.marker)==null?void 0:Bt.radius)||0),tt=pt<0?"left":"right",mt=pt<0?"right":"left";return re[tt]&&([Ue,$e]=j(fe,K(se,re[tt],te+1,ce),O)),re[mt]&&q(Math.sqrt(pt*pt),Ue[O],$e)&&(Ue=j(Ue,K(se,re[mt],te+1,ce),O)[0]),Ue}(o,this.kdTree,N,N)}pointPlacementToXValue(){let{options:o,xAxis:u}=this,p=o.pointPlacement;return p==="between"&&(p=u.reversed?-.5:.5),Gn(p)?p*(o.pointRange||u.pointRange):0}isPointInside(o){let{chart:u,xAxis:p,yAxis:x}=this,{plotX:v=-1,plotY:S=-1}=o;return S>=0&&S<=(x?x.len:u.plotHeight)&&v>=0&&v<=(p?p.len:u.plotWidth)}drawTracker(){var j;let o=this,u=o.options,p=u.trackByArea,x=[].concat((p?o.areaPath:o.graphPath)||[]),v=o.chart,S=v.pointer,A=v.renderer,I=((j=v.options.tooltip)==null?void 0:j.snap)||0,O=()=>{u.enableMouseTracking&&v.hoverSeries!==o&&o.onMouseOver()},N="rgba(192,192,192,"+(Es?1e-4:.002)+")",z=o.tracker;z?z.attr({d:x}):o.graph&&(o.tracker=z=A.path(x).attr({visibility:o.visible?"inherit":"hidden",zIndex:2}).addClass(p?"highcharts-tracker-area":"highcharts-tracker-line").add(o.group),v.styledMode||z.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:N,fill:p?N:"none","stroke-width":o.graph.strokeWidth()+(p?0:2*I)}),[o.tracker,o.markerGroup,o.dataLabelsGroup].forEach(q=>{q&&(q.addClass("highcharts-tracker").on("mouseover",O).on("mouseout",K=>{S==null||S.onTrackerMouseOut(K)}),u.cursor&&!v.styledMode&&q.css({cursor:u.cursor}),q.on("touchstart",O))})),fn(this,"afterDrawTracker")}addPoint(o,u,p,x,v){let S,A,I=this.options,{chart:O,data:N,dataTable:z,xAxis:j}=this,q=(j==null?void 0:j.hasNames)&&j.names,K=I.data,se=this.getColumn("x");u=Cn(u,!0);let re={series:this};this.pointClass.prototype.applyOptions.apply(re,[o]);let te=re.x;if(A=se.length,this.requireSorting&&te<se[A-1])for(S=!0;A&&se[A-1]>te;)A--;z.setRow(re,A,!0,{addColumns:!1}),q&&re.name&&(q[te]=re.name),K==null||K.splice(A,0,o),(S||this.processedData)&&(this.data.splice(A,0,null),this.processData()),I.legendType==="point"&&this.generatePoints(),p&&(N[0]&&N[0].remove?N[0].remove(!1):([N,K].filter(vn).forEach(ce=>{ce.shift()}),z.deleteRows(0))),v!==!1&&fn(this,"addPoint",{point:re}),this.isDirty=!0,this.isDirtyData=!0,u&&O.redraw(x)}removePoint(o,u,p){let x=this,{chart:v,data:S,points:A,dataTable:I}=x,O=S[o],N=function(){[(A==null?void 0:A.length)===S.length?A:void 0,S,x.options.data].filter(vn).forEach(z=>{z.splice(o,1)}),I.deleteRows(o),O==null||O.destroy(),x.isDirty=!0,x.isDirtyData=!0,u&&v.redraw()};Ur(p,v),u=Cn(u,!0),O?O.firePointEvent("remove",null,N):N()}remove(o,u,p,x){let v=this,S=v.chart;function A(){v.destroy(x),S.isDirtyLegend=S.isDirtyBox=!0,S.linkSeries(x),Cn(o,!0)&&S.redraw(u)}p!==!1?fn(v,"remove",null,A):A()}update(o,u){var te,ce;fn(this,"update",{options:o=Rd(o,this.userOptions)});let p=this,x=p.chart,v=p.userOptions,S=p.initialType||p.type,A=x.options.plotOptions,I=Wn[S].prototype,O=p.finishedAnimating&&{animation:!1},N={},z,j,q=Gs.keepProps.slice(),K=o.type||v.type||x.options.chart.type,se=!(this.hasDerivedData||K&&K!==this.type||o.keys!==void 0||o.pointStart!==void 0||o.pointInterval!==void 0||o.relativeXValue!==void 0||o.joinBy||o.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(fe=>p.hasOptionChanged(fe)));K=K||S,se?(q.push.apply(q,Gs.keepPropsForPoints),o.visible!==!1&&q.push("area","graph"),p.parallelArrays.forEach(function(fe){q.push(fe+"Data")}),o.data&&(o.dataSorting&&uu(p.options.dataSorting,o.dataSorting),this.setData(o.data,!1))):this.dataTable.modified=this.dataTable,o=du(v,{index:v.index===void 0?p.index:v.index,pointStart:((te=A==null?void 0:A.series)==null?void 0:te.pointStart)??v.pointStart??p.getColumn("x")[0]},!se&&{data:p.options.data},o,O),se&&o.data&&(o.data=p.options.data),(q=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(q)).forEach(function(fe){q[fe]=p[fe],delete p[fe]});let re=!1;if(Wn[K]){if(re=K!==p.type,p.remove(!1,!1,!1,!0),re)if(x.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(p,Wn[K].prototype);else{let fe=Object.hasOwnProperty.call(p,"hcEvents")&&p.hcEvents;for(j in I)p[j]=void 0;uu(p,Wn[K].prototype),fe?p.hcEvents=fe:delete p.hcEvents}}else zd(17,!0,x,{missingModuleFor:K});if(q.forEach(function(fe){p[fe]=q[fe]}),p.init(x,o),se&&this.points)for(let fe of((z=p.options).visible===!1?(N.graphic=1,N.dataLabel=1):(this.hasMarkerChanged(z,v)&&(N.graphic=1),(ce=p.hasDataLabels)!=null&&ce.call(p)||(N.dataLabel=1)),this.points))fe!=null&&fe.series&&(fe.resolveColor(),Object.keys(N).length&&fe.destroyElements(N),z.showInLegend===!1&&fe.legendItem&&x.legend.destroyItem(fe));p.initialType=S,x.linkSeries(),x.setSortedData(),re&&p.linkedSeries.length&&(p.isDirtyData=!0),fn(this,"afterUpdate"),Cn(u,!0)&&x.redraw(!!se&&void 0)}setName(o){this.name=this.options.name=this.userOptions.name=o,this.chart.isDirtyLegend=!0}hasOptionChanged(o){var A,I;let u=this.chart,p=this.options[o],x=u.options.plotOptions,v=this.userOptions[o],S=Cn((A=x==null?void 0:x[this.type])==null?void 0:A[o],(I=x==null?void 0:x.series)==null?void 0:I[o]);return v&&!vn(S)?p!==v:p!==Cn(S,p)}onMouseOver(){let o=this.chart,u=o.hoverSeries,p=o.pointer;p==null||p.setHoverChartIndex(),u&&u!==this&&u.onMouseOut(),this.options.events.mouseOver&&fn(this,"mouseOver"),this.setState("hover"),o.hoverSeries=this}onMouseOut(){let o=this.options,u=this.chart,p=u.tooltip,x=u.hoverPoint;u.hoverSeries=null,x&&x.onMouseOut(),this&&o.events.mouseOut&&fn(this,"mouseOut"),p&&!this.stickyTracking&&(!p.shared||this.noSharedTooltip)&&p.hide(),u.series.forEach(function(v){v.setState("",!0)})}setState(o,u){let p=this,x=p.options,v=p.graph,S=x.inactiveOtherPoints,A=x.states,I=Cn(A[o||"normal"]&&A[o||"normal"].animation,p.chart.options.chart.animation),O=x.lineWidth,N=x.opacity;if(o=o||"",p.state!==o&&([p.group,p.markerGroup,p.dataLabelsGroup].forEach(function(z){z&&(p.state&&z.removeClass("highcharts-series-"+p.state),o&&z.addClass("highcharts-series-"+o))}),p.state=o,!p.chart.styledMode)){if(A[o]&&A[o].enabled===!1)return;if(o&&(O=A[o].lineWidth||O+(A[o].lineWidthPlus||0),N=Cn(A[o].opacity,N)),v&&!v.dashstyle&&Gn(O))for(let z of[v,...this.zones.map(j=>j.graph)])z==null||z.animate({"stroke-width":O},I);S||[p.group,p.markerGroup,p.dataLabelsGroup,p.labelBySeries].forEach(function(z){z&&z.animate({opacity:N},I)})}u&&S&&p.points&&p.setAllPointsToState(o||void 0)}setAllPointsToState(o){this.points.forEach(function(u){u.setState&&u.setState(o)})}setVisible(o,u){var I;let p=this,x=p.chart,v=x.options.chart.ignoreHiddenSeries,S=p.visible;p.visible=o=p.options.visible=p.userOptions.visible=o===void 0?!S:o;let A=o?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(O=>{var N;(N=p[O])==null||N[A]()}),(x.hoverSeries===p||((I=x.hoverPoint)==null?void 0:I.series)===p)&&p.onMouseOut(),p.legendItem&&x.legend.colorizeItem(p,o),p.isDirty=!0,p.options.stacking&&x.series.forEach(O=>{O.options.stacking&&O.visible&&(O.isDirty=!0)}),p.linkedSeries.forEach(O=>{O.setVisible(o,!1)}),v&&(x.isDirtyBox=!0),fn(p,A),u!==!1&&x.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(o){this.selected=o=this.options.selected=o===void 0?!this.selected:o,this.checkbox&&(this.checkbox.checked=o),fn(this,o?"select":"unselect")}shouldShowTooltip(o,u,p={}){return p.series=this,p.visiblePlotOnly=!0,this.chart.isInsidePlot(o,u,p)}drawLegendSymbol(o,u){var p;(p=Dr[this.options.legendSymbol||"rectangle"])==null||p.call(this,o,u)}}Gs.defaultOptions={lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:R}=this.series.chart;return typeof this.y!="number"?"":R(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},Gs.types=kr.seriesTypes,Gs.registerType=kr.registerSeriesType,Gs.keepProps=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],Gs.keepPropsForPoints=["data","isDirtyData","isDirtyCanvas","points","dataTable","processedData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"],uu(Gs.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:ee,requireSorting:!0,sorted:!0}),kr.series=Gs;let _s=Gs,{animObject:Tl,setAnimation:Sa}=En,{registerEventOptions:El}=Yc,{composed:fc,marginNames:pc}=Ie,{distribute:qx}=Na,{format:Xx}=ds,{addEvent:op,createElement:Zx,css:x_,defined:ap,discardElement:Ca,find:Yx,fireEvent:Sl,isNumber:An,merge:Ai,pick:as,pushUnique:lp,relativeLength:no,stableSort:v_,syncTimeout:b_}=xe;class Co{constructor(o,u){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=o,this.setOptions(u),u.enabled&&(this.render(),El(this,u),op(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),op(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(o){let u=as(o.padding,8);this.options=o,this.chart.styledMode||(this.itemStyle=o.itemStyle,this.itemHiddenStyle=Ai(this.itemStyle,o.itemHiddenStyle)),this.itemMarginTop=o.itemMarginTop,this.itemMarginBottom=o.itemMarginBottom,this.padding=u,this.initialItemY=u-5,this.symbolWidth=as(o.symbolWidth,16),this.pages=[],this.proximate=o.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(o,u){let p=this.chart;this.setOptions(Ai(!0,this.options,o)),"events"in this.options&&El(this,this.options),this.destroy(),p.isDirtyLegend=p.isDirtyBox=!0,as(u,!0)&&p.redraw(),Sl(this,"afterUpdate",{redraw:u})}colorizeItem(o,u){var O;let p=o.color,{area:x,group:v,label:S,line:A,symbol:I}=o.legendItem||{};if((o instanceof _s||o instanceof ee)&&(o.color=((O=o.options)==null?void 0:O.legendSymbolColor)||p),v==null||v[u?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:N={}}=this,z=N.color,{fillColor:j,fillOpacity:q,lineColor:K,marker:se}=o.options,re=te=>(!u&&(te.fill&&(te.fill=z),te.stroke&&(te.stroke=z)),te);S==null||S.css(Ai(u?this.itemStyle:N)),A==null||A.attr(re({stroke:K||o.color})),I&&I.attr(re(se&&I.isMarker?o.pointAttribs():{fill:o.color})),x==null||x.attr(re({fill:j||o.color,"fill-opacity":j?1:q??.75}))}o.color=p,Sl(this,"afterColorizeItem",{item:o,visible:u})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(o){let{group:u,x:p=0,y:x=0}=o.legendItem||{},v=this.options,S=v.symbolPadding,A=!v.rtl,I=o.checkbox;if(u!=null&&u.element){let O={translateX:A?p:this.legendWidth-p-2*S-4,translateY:x};u[ap(u.translateY)?"animate":"attr"](O,void 0,()=>{Sl(this,"afterPositionItem",{item:o})})}I&&(I.x=p,I.y=x)}destroyItem(o){let u=o.checkbox,p=o.legendItem||{};for(let x of["group","label","line","symbol"])p[x]&&(p[x]=p[x].destroy());u&&Ca(u),o.legendItem=void 0}destroy(){for(let o of this.getAllItems())this.destroyItem(o);for(let o of["clipRect","up","down","pager","nav","box","title","group"])this[o]&&(this[o]=this[o].destroy());this.display=null}positionCheckboxes(){var v;let o,u=(v=this.group)==null?void 0:v.alignAttr,p=this.clipHeight||this.legendHeight,x=this.titleHeight;u&&(o=u.translateY,this.allItems.forEach(function(S){let A,I=S.checkbox;I&&(A=o+x+I.y+(this.scrollOffset||0)+3,x_(I,{left:u.translateX+S.checkboxOffset+I.x-20+"px",top:A+"px",display:this.proximate||A>o-6&&A<o+p-6?"":"none"}))},this))}renderTitle(){let o=this.options,u=this.padding,p=o.title,x,v=0;p.text&&(this.title||(this.title=this.chart.renderer.label(p.text,u-3,u-4,void 0,void 0,void 0,o.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(p.style),this.title.add(this.group)),p.width||this.title.css({width:this.maxLegendWidth+"px"}),v=(x=this.title.getBBox()).height,this.offsetWidth=x.width,this.contentGroup.attr({translateY:v})),this.titleHeight=v}setText(o){let u=this.options;o.legendItem.label.attr({text:u.labelFormat?Xx(u.labelFormat,o,this.chart):u.labelFormatter.call(o)})}renderItem(o){var pt;let u=o.legendItem=o.legendItem||{},p=this.chart,x=p.renderer,v=this.options,S=v.layout==="horizontal",A=this.symbolWidth,I=v.symbolPadding||0,O=this.itemStyle,N=this.itemHiddenStyle,z=S?as(v.itemDistance,20):0,j=!v.rtl,q=!o.series,K=!q&&o.series.drawLegendSymbol?o.series:o,se=K.options,re=!!this.createCheckboxForItem&&se&&se.showCheckbox,te=v.useHTML,ce=o.options.className,fe=u.label,Xe=A+I+z+20*!!re;!fe&&(u.group=x.g("legend-item").addClass("highcharts-"+K.type+"-series highcharts-color-"+o.colorIndex+(ce?" "+ce:"")+(q?" highcharts-series-"+o.index:"")).attr({zIndex:1}).add(this.scrollGroup),u.label=fe=x.text("",j?A+I:-I,this.baseline||0,te),p.styledMode||fe.css(Ai(o.visible?O:N)),fe.attr({align:j?"left":"right",zIndex:2}).add(u.group),!this.baseline&&(this.fontMetrics=x.fontMetrics(fe),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,fe.attr("y",this.baseline),this.symbolHeight=as(v.symbolHeight,this.fontMetrics.f),v.squareSymbol&&(this.symbolWidth=as(v.symbolWidth,Math.max(this.symbolHeight,16)),Xe=this.symbolWidth+I+z+20*!!re,j&&fe.attr("x",this.symbolWidth+I))),K.drawLegendSymbol(this,o),this.setItemEvents&&this.setItemEvents(o,fe,te)),re&&!o.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(o),this.colorizeItem(o,o.visible),(p.styledMode||!O.width)&&fe.css({width:(v.itemWidth||this.widthOption||p.spacingBox.width)-Xe+"px"}),this.setText(o);let Ue=fe.getBBox(),$e=((pt=this.fontMetrics)==null?void 0:pt.h)||0;o.itemWidth=o.checkboxOffset=v.itemWidth||u.labelWidth||Ue.width+Xe,this.maxItemWidth=Math.max(this.maxItemWidth,o.itemWidth),this.totalItemWidth+=o.itemWidth,this.itemHeight=o.itemHeight=Math.round(u.labelHeight||(Ue.height>1.5*$e?Ue.height:$e))}layoutItem(o){let u=this.options,p=this.padding,x=u.layout==="horizontal",v=o.itemHeight,S=this.itemMarginBottom,A=this.itemMarginTop,I=x?as(u.itemDistance,20):0,O=this.maxLegendWidth,N=u.alignColumns&&this.totalItemWidth>O?this.maxItemWidth:o.itemWidth,z=o.legendItem||{};x&&this.itemX-p+N>O&&(this.itemX=p,this.lastLineHeight&&(this.itemY+=A+this.lastLineHeight+S),this.lastLineHeight=0),this.lastItemY=A+this.itemY+S,this.lastLineHeight=Math.max(v,this.lastLineHeight),z.x=this.itemX,z.y=this.itemY,x?this.itemX+=N:(this.itemY+=A+v+S,this.lastLineHeight=v),this.offsetWidth=this.widthOption||Math.max((x?this.itemX-p-(o.checkbox?0:I):N)+p,this.offsetWidth)}getAllItems(){let o=[];return this.chart.series.forEach(function(u){var x;let p=u==null?void 0:u.options;u&&as(p.showInLegend,!ap(p.linkedTo)&&void 0,!0)&&(o=o.concat(((x=u.legendItem)==null?void 0:x.labels)||(p.legendType==="point"?u.data:u)))}),Sl(this,"afterGetAllItems",{allItems:o}),o}getAlignment(){let o=this.options;return this.proximate?o.align.charAt(0)+"tv":o.floating?"":o.align.charAt(0)+o.verticalAlign.charAt(0)+o.layout.charAt(0)}adjustMargins(o,u){let p=this.chart,x=this.options,v=this.getAlignment();v&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(S,A){S.test(v)&&!ap(o[A])&&(p[pc[A]]=Math.max(p[pc[A]],p.legend[(A+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][A]*x[A%2?"x":"y"]+as(x.margin,12)+u[A]+(p.titleOffset[A]||0)))})}proximatePositions(){let o,u=this.chart,p=[],x=this.options.align==="left";for(let v of(this.allItems.forEach(function(S){let A,I,O=x,N,z;S.yAxis&&(S.xAxis.options.reversed&&(O=!O),S.points&&(A=Yx(O?S.points:S.points.slice(0).reverse(),function(j){return An(j.plotY)})),I=this.itemMarginTop+S.legendItem.label.getBBox().height+this.itemMarginBottom,z=S.yAxis.top-u.plotTop,N=S.visible?(A?A.plotY:S.yAxis.height)+(z-.3*I):z+S.yAxis.height,p.push({target:N,size:I,item:S}))},this),qx(p,u.plotHeight)))o=v.item.legendItem||{},An(v.pos)&&(o.y=u.plotTop-u.spacing[0]+v.pos)}render(){let o=this.chart,u=o.renderer,p=this.options,x=this.padding,v=this.getAllItems(),S,A,I,O=this.group,N,z=this.box;this.itemX=x,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=no(p.width,o.spacingBox.width-x),N=o.spacingBox.width-2*x-p.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(N/=2),this.maxLegendWidth=this.widthOption||N,O||(this.group=O=u.g("legend").addClass(p.className||"").attr({zIndex:7}).add(),this.contentGroup=u.g().attr({zIndex:1}).add(O),this.scrollGroup=u.g().add(this.contentGroup)),this.renderTitle(),v_(v,(j,q)=>{var K,se;return(((K=j.options)==null?void 0:K.legendIndex)||0)-(((se=q.options)==null?void 0:se.legendIndex)||0)}),p.reversed&&v.reverse(),this.allItems=v,this.display=S=!!v.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,v.forEach(this.renderItem,this),v.forEach(this.layoutItem,this),A=(this.widthOption||this.offsetWidth)+x,I=this.lastItemY+this.lastLineHeight+this.titleHeight,I=this.handleOverflow(I)+x,z||(this.box=z=u.rect().addClass("highcharts-legend-box").attr({r:p.borderRadius}).add(O)),o.styledMode||z.attr({stroke:p.borderColor,"stroke-width":p.borderWidth||0,fill:p.backgroundColor||"none"}).shadow(p.shadow),A>0&&I>0&&z[z.placed?"animate":"attr"](z.crisp.call({},{x:0,y:0,width:A,height:I},z.strokeWidth())),O[S?"show":"hide"](),o.styledMode&&O.getStyle("display")==="none"&&(A=I=0),this.legendWidth=A,this.legendHeight=I,S&&this.align(),this.proximate||this.positionItems(),Sl(this,"afterRender")}align(o=this.chart.spacingBox){let u=this.chart,p=this.options,x=o.y;/(lth|ct|rth)/.test(this.getAlignment())&&u.titleOffset[0]>0?x+=u.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&u.titleOffset[2]>0&&(x-=u.titleOffset[2]),x!==o.y&&(o=Ai(o,{y:x})),u.hasRendered||(this.group.placed=!1),this.group.align(Ai(p,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":p.verticalAlign}),!0,o)}handleOverflow(o){let u=this,p=this.chart,x=p.renderer,v=this.options,S=v.y,A=v.verticalAlign==="top",I=this.padding,O=v.maxHeight,N=v.navigation,z=as(N.animation,!0),j=N.arrowSize||12,q=this.pages,K=this.allItems,se=function(tt){typeof tt=="number"?pt.attr({height:tt}):pt&&(u.clipRect=pt.destroy(),u.contentGroup.clip()),u.contentGroup.div&&(u.contentGroup.div.style.clip=tt?"rect("+I+"px,9999px,"+(I+tt)+"px,0)":"auto")},re=function(tt){return u[tt]=x.circle(0,0,1.3*j).translate(j/2,j/2).add($e),p.styledMode||u[tt].attr("fill","rgba(0,0,0,0.0001)"),u[tt]},te,ce,fe,Xe,Ue=p.spacingBox.height+(A?-S:S)-I,$e=this.nav,pt=this.clipRect;return v.layout!=="horizontal"||v.verticalAlign==="middle"||v.floating||(Ue/=2),O&&(Ue=Math.min(Ue,O)),q.length=0,o&&Ue>0&&o>Ue&&N.enabled!==!1?(this.clipHeight=te=Math.max(Ue-20-this.titleHeight-I,0),this.currentPage=as(this.currentPage,1),this.fullHeight=o,K.forEach((tt,mt)=>{let Bt=(fe=tt.legendItem||{}).y||0,Yt=Math.round(fe.label.getBBox().height),ei=q.length;(!ei||Bt-q[ei-1]>te&&(ce||Bt)!==q[ei-1])&&(q.push(ce||Bt),ei++),fe.pageIx=ei-1,ce&&Xe&&(Xe.pageIx=ei-1),mt===K.length-1&&Bt+Yt-q[ei-1]>te&&Bt>q[ei-1]&&(q.push(Bt),fe.pageIx=ei),Bt!==ce&&(ce=Bt),Xe=fe}),pt||(pt=u.clipRect=x.clipRect(0,I-2,9999,0),u.contentGroup.clip(pt)),se(te),$e||(this.nav=$e=x.g().attr({zIndex:1}).add(this.group),this.up=x.symbol("triangle",0,0,j,j).add($e),re("upTracker").on("click",function(){u.scroll(-1,z)}),this.pager=x.text("",15,10).addClass("highcharts-legend-navigation"),!p.styledMode&&N.style&&this.pager.css(N.style),this.pager.add($e),this.down=x.symbol("triangle-down",0,0,j,j).add($e),re("downTracker").on("click",function(){u.scroll(1,z)})),u.scroll(0),o=Ue):$e&&(se(),this.nav=$e.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),o}scroll(o,u){let p=this.chart,x=this.pages,v=x.length,S=this.clipHeight,A=this.options.navigation,I=this.pager,O=this.padding,N=this.currentPage+o;N>v&&(N=v),N>0&&(u!==void 0&&Sa(u,p),this.nav.attr({translateX:O,translateY:S+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(z){z.attr({class:N===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),I.attr({text:N+"/"+v}),[this.down,this.downTracker].forEach(function(z){z.attr({x:18+this.pager.getBBox().width,class:N===v?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),p.styledMode||(this.up.attr({fill:N===1?A.inactiveColor:A.activeColor}),this.upTracker.css({cursor:N===1?"default":"pointer"}),this.down.attr({fill:N===v?A.inactiveColor:A.activeColor}),this.downTracker.css({cursor:N===v?"default":"pointer"})),this.scrollOffset=-x[N-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=N,this.positionCheckboxes(),b_(()=>{Sl(this,"afterScroll",{currentPage:N})},Tl(as(u,p.renderer.globalAnimation,!0)).duration))}setItemEvents(o,u,p){let x=this,v=o.legendItem||{},S=x.chart.renderer.boxWrapper,A=o instanceof ee,I=o instanceof _s,O="highcharts-legend-"+(A?"point":"series")+"-active",N=x.chart.styledMode,z=p?[u,v.symbol]:[v.group],j=q=>{x.allItems.forEach(K=>{o!==K&&[K].concat(K.linkedSeries||[]).forEach(se=>{se.setState(q,!A)})})};for(let q of z)q&&q.on("mouseover",function(){o.visible&&j("inactive"),o.setState("hover"),o.visible&&S.addClass(O),N||u.css(x.options.itemHoverStyle)}).on("mouseout",function(){x.chart.styledMode||u.css(Ai(o.visible?x.itemStyle:x.itemHiddenStyle)),j(""),S.removeClass(O),o.setState()}).on("click",function(K){let se=function(){o.setVisible&&o.setVisible(),j(o.visible?"inactive":"")};S.removeClass(O),Sl(x,"itemClick",{browserEvent:K,legendItem:o},se),A?o.firePointEvent("legendItemClick",{browserEvent:K}):I&&Sl(o,"legendItemClick",{browserEvent:K})})}createCheckboxForItem(o){o.checkbox=Zx("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:o.selected,defaultChecked:o.selected},this.options.itemCheckboxStyle,this.chart.container),op(o.checkbox,"click",function(u){let p=u.target;Sl(o.series||o,"checkboxClick",{checked:p.checked,item:o},function(){o.select()})})}}(function(R){R.compose=function(o){lp(fc,"Core.Legend")&&op(o,"beforeMargins",function(){this.legend=new R(this,this.options.legend)})}})(Co||(Co={}));let cp=Co,{animate:Cl,animObject:Fd,setAnimation:Al}=En,{defaultOptions:Nd}=Le,{numberFormat:hp}=ds,{registerEventOptions:zm}=Yc,{charts:mc,doc:Ud,marginNames:up,svg:w_,win:fu}=Ie,{seriesTypes:gc}=kr,{addEvent:Aa,attr:dp,createElement:fp,css:Ws,defined:Ko,diffObjects:so,discardElement:Vd,erase:zs,error:oo,extend:Za,find:pn,fireEvent:Tr,getAlignFactor:jd,getStyle:Ao,isArray:Kx,isNumber:pu,isObject:T_,isString:$d,merge:Bs,objectEach:pp,pick:ys,pInt:E_,relativeLength:Bm,removeEvent:S_,splat:mp,syncTimeout:C_,uniqueKey:A_}=xe;class Jo{static chart(o,u,p){return new Jo(o,u,p)}constructor(o,u,p){this.sharedClips={};let x=[...arguments];($d(o)||o.nodeName)&&(this.renderTo=x.shift()),this.init(x[0],x[1])}setZoomOptions(){let o=this.options.chart,u=o.zooming;this.zooming={...u,type:ys(o.zoomType,u.type),key:ys(o.zoomKey,u.key),pinchType:ys(o.pinchType,u.pinchType),singleTouch:ys(o.zoomBySingleTouch,u.singleTouch,!1),resetButton:Bs(u.resetButton,o.resetZoomButton)}}init(o,u){Tr(this,"init",{args:arguments},function(){var S;let p=Bs(Nd,o),x=p.chart,v=this.renderTo||x.renderTo;this.userOptions=Za({},o),(this.renderTo=$d(v)?Ud.getElementById(v):v)||oo(13,!0,this),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=u,this.isResizing=0,this.options=p,this.axes=[],this.series=[],this.locale=p.lang.locale??((S=this.renderTo.closest("[lang]"))==null?void 0:S.lang),this.time=new hs(Za(p.time||{},{locale:this.locale}),p.lang),p.time=this.time.options,this.numberFormatter=(x.numberFormatter||hp).bind(this),this.styledMode=x.styledMode,this.hasCartesianSeries=x.showAxes,this.index=mc.length,mc.push(this),Ie.chartCount++,zm(this,x),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),Tr(this,"afterInit"),this.firstRender()})}initSeries(o){let u=this.options.chart,p=o.type||u.type,x=gc[p];x||oo(17,!0,this,{missingModuleFor:p});let v=new x;return typeof v.init=="function"&&v.init(this,o),v}setSortedData(){this.getSeriesOrderByLinks().forEach(function(o){o.points||o.data||!o.enabledDataSorting||o.setData(o.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(o,u){return o.linkedSeries.length||u.linkedSeries.length?u.linkedSeries.length-o.linkedSeries.length:0})}orderItems(o,u=0){let p=this[o],x=this.options[o]=mp(this.options[o]).slice(),v=this.userOptions[o]=this.userOptions[o]?mp(this.userOptions[o]).slice():[];if(this.hasRendered&&(x.splice(u),v.splice(u)),p)for(let S=u,A=p.length;S<A;++S){let I=p[S];I&&(I.index=S,I instanceof _s&&(I.name=I.getName()),I.options.isInternal||(x[S]=I.options,v[S]=I.userOptions))}}getClipBox(o,u){var N,z;let p=this.inverted,{xAxis:x,yAxis:v}=o||{},{x:S,y:A,width:I,height:O}=Bs(this.clipBox);return o&&(x&&x.len!==this.plotSizeX&&(I=x.len),v&&v.len!==this.plotSizeY&&(O=v.len),p&&!o.invertible&&([I,O]=[O,I])),u&&(S+=((N=p?v:x)==null?void 0:N.pos)??this.plotLeft,A+=((z=p?x:v)==null?void 0:z.pos)??this.plotTop),{x:S,y:A,width:I,height:O}}isInsidePlot(o,u,p={}){var re;let{inverted:x,plotBox:v,plotLeft:S,plotTop:A,scrollablePlotBox:I}=this,{scrollLeft:O=0,scrollTop:N=0}=p.visiblePlotOnly&&((re=this.scrollablePlotArea)==null?void 0:re.scrollingContainer)||{},z=p.series,j=p.visiblePlotOnly&&I||v,q=p.inverted?u:o,K=p.inverted?o:u,se={x:q,y:K,isInsidePlot:!0,options:p};if(!p.ignoreX){let te=z&&(x&&!this.polar?z.yAxis:z.xAxis)||{pos:S,len:1/0},ce=p.paneCoordinates?te.pos+q:S+q;ce>=Math.max(O+S,te.pos)&&ce<=Math.min(O+S+j.width,te.pos+te.len)||(se.isInsidePlot=!1)}if(!p.ignoreY&&se.isInsidePlot){let te=!x&&p.axis&&!p.axis.isXAxis&&p.axis||z&&(x?z.xAxis:z.yAxis)||{pos:A,len:1/0},ce=p.paneCoordinates?te.pos+K:A+K;ce>=Math.max(N+A,te.pos)&&ce<=Math.min(N+A+j.height,te.pos+te.len)||(se.isInsidePlot=!1)}return Tr(this,"afterIsInsidePlot",se),se.isInsidePlot}redraw(o){Tr(this,"beforeRedraw");let u=this.hasCartesianSeries?this.axes:this.colorAxis||[],p=this.series,x=this.pointer,v=this.legend,S=this.userOptions.legend,A=this.renderer,I=A.isHidden(),O=[],N,z,j,q=this.isDirtyBox,K=this.isDirtyLegend,se;for(A.rootFontSize=A.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),Al(!!this.hasRendered&&o,this),I&&this.temporaryDisplay(),this.layOutTitles(!1),j=p.length;j--;)if(((se=p[j]).options.stacking||se.options.centerInCategory)&&(z=!0,se.isDirty)){N=!0;break}if(N)for(j=p.length;j--;)(se=p[j]).options.stacking&&(se.isDirty=!0);p.forEach(function(re){re.isDirty&&(re.options.legendType==="point"?(typeof re.updateTotals=="function"&&re.updateTotals(),K=!0):S&&(S.labelFormatter||S.labelFormat)&&(K=!0)),re.isDirtyData&&Tr(re,"updatedData")}),K&&v&&v.options.enabled&&(v.render(),this.isDirtyLegend=!1),z&&this.getStacks(),u.forEach(function(re){re.updateNames(),re.setScale()}),this.getMargins(),u.forEach(function(re){re.isDirty&&(q=!0)}),u.forEach(function(re){let te=re.min+","+re.max;re.extKey!==te&&(re.extKey=te,O.push(function(){Tr(re,"afterSetExtremes",Za(re.eventArgs,re.getExtremes())),delete re.eventArgs})),(q||z)&&re.redraw()}),q&&this.drawChartBox(),Tr(this,"predraw"),p.forEach(function(re){(q||re.isDirty)&&re.visible&&re.redraw(),re.isDirtyData=!1}),x&&x.reset(!0),A.draw(),Tr(this,"redraw"),Tr(this,"render"),I&&this.temporaryDisplay(!0),O.forEach(function(re){re.call()})}get(o){let u=this.series;function p(v){return v.id===o||v.options&&v.options.id===o}let x=pn(this.axes,p)||pn(this.series,p);for(let v=0;!x&&v<u.length;v++)x=pn(u[v].points||[],p);return x}createAxes(){let o=this.userOptions;for(let u of(Tr(this,"createAxes"),["xAxis","yAxis"]))for(let p of o[u]=mp(o[u]||{}))new Wa(this,p,u);Tr(this,"afterCreateAxes")}getSelectedPoints(){return this.series.reduce((o,u)=>(u.getPointsCollection().forEach(p=>{ys(p.selectedStaging,p.selected)&&o.push(p)}),o),[])}getSelectedSeries(){return this.series.filter(o=>o.selected)}setTitle(o,u,p){this.applyDescription("title",o),this.applyDescription("subtitle",u),this.applyDescription("caption",void 0),this.layOutTitles(p)}applyDescription(o,u){var S;let p=this,x=this.options[o]=Bs(this.options[o],u),v=this[o];v&&u&&(this[o]=v=v.destroy()),x&&!v&&((v=this.renderer.text(x.text,0,0,x.useHTML).attr({align:x.align,class:"highcharts-"+o,zIndex:x.zIndex||4}).css({textOverflow:"ellipsis",whiteSpace:"nowrap"}).add()).update=function(A,I){p.applyDescription(o,A),p.layOutTitles(I)},this.styledMode||v.css(Za(o==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},x.style)),v.textPxLength=v.getBBox().width,v.css({whiteSpace:(S=x.style)==null?void 0:S.whiteSpace}),this[o]=v)}layOutTitles(o=!0){var A,I,O,N;let u=[0,0,0],{options:p,renderer:x,spacingBox:v}=this;["title","subtitle","caption"].forEach(z=>{var re;let j=this[z],q=this.options[z],K=Bs(v),se=(j==null?void 0:j.textPxLength)||0;if(j&&q){Tr(this,"layOutTitle",{alignTo:K,key:z,textPxLength:se});let te=x.fontMetrics(j),ce=te.b,fe=te.h,Xe=q.verticalAlign||"top",Ue=Xe==="top",$e=Ue&&q.minScale||1,pt=z==="title"?Ue?-3:0:Ue?u[0]+2:0,tt=Math.min(K.width/se,1),mt=Math.max($e,tt),Bt=Bs({y:Xe==="bottom"?ce:pt+ce},{align:z==="title"?tt<$e?"left":"center":(re=this.title)==null?void 0:re.alignValue},q),Yt=(q.width||(tt>$e?this.chartWidth:K.width)/mt)+"px";j.alignValue!==Bt.align&&(j.placed=!1);let ei=Math.round(j.css({width:Yt}).getBBox(q.useHTML).height);if(Bt.height=ei,j.align(Bt,!1,K).attr({align:Bt.align,scaleX:mt,scaleY:mt,"transform-origin":`${K.x+se*mt*jd(Bt.align)} ${fe}`}),!q.floating){let Ft=ei*(ei<1.2*fe?1:mt);Xe==="top"?u[0]=Math.ceil(u[0]+Ft):Xe==="bottom"&&(u[2]=Math.ceil(u[2]+Ft))}}},this),u[0]&&(((A=p.title)==null?void 0:A.verticalAlign)||"top")==="top"&&(u[0]+=((I=p.title)==null?void 0:I.margin)||0),u[2]&&((O=p.caption)==null?void 0:O.verticalAlign)==="bottom"&&(u[2]+=((N=p.caption)==null?void 0:N.margin)||0);let S=!this.titleOffset||this.titleOffset.join(",")!==u.join(",");this.titleOffset=u,Tr(this,"afterLayOutTitles"),!this.isDirtyBox&&S&&(this.isDirtyBox=this.isDirtyLegend=S,this.hasRendered&&o&&this.isDirtyBox&&this.redraw())}getContainerBox(){let o=[].map.call(this.renderTo.children,p=>{if(p!==this.container){let x=p.style.display;return p.style.display="none",[p,x]}}),u={width:Ao(this.renderTo,"width",!0)||0,height:Ao(this.renderTo,"height",!0)||0};return o.filter(Boolean).forEach(([p,x])=>{p.style.display=x}),u}getChartSize(){var S;let o=this.options.chart,u=o.width,p=o.height,x=this.getContainerBox(),v=x.height<=1||!((S=this.renderTo.parentElement)!=null&&S.style.height)&&this.renderTo.style.height==="100%";this.chartWidth=Math.max(0,u||x.width||600),this.chartHeight=Math.max(0,Bm(p,this.chartWidth)||(v?400:x.height)),this.containerBox=x}temporaryDisplay(o){let u=this.renderTo,p;if(o)for(;u!=null&&u.style;)u.hcOrigStyle&&(Ws(u,u.hcOrigStyle),delete u.hcOrigStyle),u.hcOrigDetached&&(Ud.body.removeChild(u),u.hcOrigDetached=!1),u=u.parentNode;else for(;u!=null&&u.style&&(Ud.body.contains(u)||u.parentNode||(u.hcOrigDetached=!0,Ud.body.appendChild(u)),(Ao(u,"display",!1)==="none"||u.hcOricDetached)&&(u.hcOrigStyle={display:u.style.display,height:u.style.height,overflow:u.style.overflow},p={display:"block",overflow:"hidden"},u!==this.renderTo&&(p.height=0),Ws(u,p),u.offsetWidth||u.style.setProperty("display","block","important")),(u=u.parentNode)!==Ud.body););}setClassName(o){this.container.className="highcharts-container "+(o||"")}getContainer(){var j,q;let o,u=this.options,p=u.chart,x="data-highcharts-chart",v=A_(),S=this.renderTo,A=E_(dp(S,x));pu(A)&&mc[A]&&mc[A].hasRendered&&mc[A].destroy(),dp(S,x,this.index),S.innerHTML=Vr.emptyHTML,p.skipClone||S.offsetWidth||this.temporaryDisplay(),this.getChartSize();let I=this.chartHeight,O=this.chartWidth;Ws(S,{overflow:"hidden"}),this.styledMode||(o=Za({position:"relative",overflow:"hidden",width:O+"px",height:I+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},p.style||{}));let N=fp("div",{id:v},o,S);this.container=N,this.getChartSize(),O===this.chartWidth||(O=this.chartWidth,this.styledMode||Ws(N,{width:ys((j=p.style)==null?void 0:j.width,O+"px")})),this.containerBox=this.getContainerBox(),this._cursor=N.style.cursor;let z=p.renderer||!w_?xo.getRendererType(p.renderer):qc;if(this.renderer=new z(N,O,I,void 0,p.forExport,(q=u.exporting)==null?void 0:q.allowHTML,this.styledMode),Al(void 0,this),this.setClassName(p.className),this.styledMode)for(let K in u.defs)this.renderer.definition(u.defs[K]);else this.renderer.setStyle(p.style);this.renderer.chartIndex=this.index,Tr(this,"afterGetContainer")}getMargins(o){var v;let{spacing:u,margin:p,titleOffset:x}=this;this.resetMargins(),x[0]&&!Ko(p[0])&&(this.plotTop=Math.max(this.plotTop,x[0]+u[0])),x[2]&&!Ko(p[2])&&(this.marginBottom=Math.max(this.marginBottom,x[2]+u[2])),(v=this.legend)!=null&&v.display&&this.legend.adjustMargins(p,u),Tr(this,"getMargins"),o||this.getAxisMargins()}getAxisMargins(){let o=this,u=o.axisOffset=[0,0,0,0],p=o.colorAxis,x=o.margin,v=function(S){S.forEach(function(A){A.visible&&A.getOffset()})};o.hasCartesianSeries?v(o.axes):p!=null&&p.length&&v(p),up.forEach(function(S,A){Ko(x[A])||(o[S]+=u[A])}),o.setChartSize()}getOptions(){return so(this.userOptions,Nd)}reflow(o){var v;let u=this,p=u.containerBox,x=u.getContainerBox();(v=u.pointer)==null||delete v.chartPosition,!u.isPrinting&&!u.isResizing&&p&&x.width&&((x.width!==p.width||x.height!==p.height)&&(xe.clearTimeout(u.reflowTimeout),u.reflowTimeout=C_(function(){u.container&&u.setSize(void 0,void 0,!1)},100*!!o)),u.containerBox=x)}setReflow(){let o=this,u=p=>{var x;(x=o.options)!=null&&x.chart.reflow&&o.hasLoaded&&o.reflow(p)};if(typeof ResizeObserver=="function")new ResizeObserver(u).observe(o.renderTo);else{let p=Aa(fu,"resize",u);Aa(this,"destroy",p)}}setSize(o,u,p){let x=this,v=x.renderer;x.isResizing+=1,Al(p,x);let S=v.globalAnimation;x.oldChartHeight=x.chartHeight,x.oldChartWidth=x.chartWidth,o!==void 0&&(x.options.chart.width=o),u!==void 0&&(x.options.chart.height=u),x.getChartSize();let{chartWidth:A,chartHeight:I,scrollablePixelsX:O=0,scrollablePixelsY:N=0}=x;(x.isDirtyBox||A!==x.oldChartWidth||I!==x.oldChartHeight)&&(x.styledMode||(S?Cl:Ws)(x.container,{width:`${A+O}px`,height:`${I+N}px`},S),x.setChartSize(!0),v.setSize(A,I,S),x.axes.forEach(function(z){z.isDirty=!0,z.setScale()}),x.isDirtyLegend=!0,x.isDirtyBox=!0,x.layOutTitles(),x.getMargins(),x.redraw(S),x.oldChartHeight=void 0,Tr(x,"resize"),setTimeout(()=>{x&&Tr(x,"endResize")},Fd(S).duration)),x.isResizing-=1}setChartSize(o){let u,p,x,v,{chartHeight:S,chartWidth:A,inverted:I,spacing:O,renderer:N}=this,z=this.clipOffset,j=Math[I?"floor":"round"];this.plotLeft=u=Math.round(this.plotLeft),this.plotTop=p=Math.round(this.plotTop),this.plotWidth=x=Math.max(0,Math.round(A-u-(this.marginRight??0))),this.plotHeight=v=Math.max(0,Math.round(S-p-(this.marginBottom??0))),this.plotSizeX=I?v:x,this.plotSizeY=I?x:v,this.spacingBox=N.spacingBox={x:O[3],y:O[0],width:A-O[3]-O[1],height:S-O[0]-O[2]},this.plotBox=N.plotBox={x:u,y:p,width:x,height:v},z&&(this.clipBox={x:j(z[3]),y:j(z[0]),width:j(this.plotSizeX-z[1]-z[3]),height:j(this.plotSizeY-z[0]-z[2])}),o||(this.axes.forEach(function(q){q.setAxisSize(),q.setAxisTranslation()}),N.alignElements()),Tr(this,"afterSetChartSize",{skipAxes:o})}resetMargins(){Tr(this,"resetMargins");let o=this,u=o.options.chart,p=u.plotBorderWidth||0,x=Math.round(p)/2;["margin","spacing"].forEach(function(v){let S=u[v],A=T_(S)?S:[S,S,S,S];["Top","Right","Bottom","Left"].forEach(function(I,O){o[v][O]=ys(u[v+I],A[O])})}),up.forEach(function(v,S){o[v]=ys(o.margin[S],o.spacing[S])}),o.axisOffset=[0,0,0,0],o.clipOffset=[x,x,x,x],o.plotBorderWidth=p}drawChartBox(){let o=this.options.chart,u=this.renderer,p=this.chartWidth,x=this.chartHeight,v=this.styledMode,S=this.plotBGImage,A=o.backgroundColor,I=o.plotBackgroundColor,O=o.plotBackgroundImage,N=this.plotLeft,z=this.plotTop,j=this.plotWidth,q=this.plotHeight,K=this.plotBox,se=this.clipRect,re=this.clipBox,te=this.chartBackground,ce=this.plotBackground,fe=this.plotBorder,Xe,Ue,$e,pt="animate";te||(this.chartBackground=te=u.rect().addClass("highcharts-background").add(),pt="attr"),v?Xe=Ue=te.strokeWidth():(Ue=(Xe=o.borderWidth||0)+8*!!o.shadow,$e={fill:A||"none"},(Xe||te["stroke-width"])&&($e.stroke=o.borderColor,$e["stroke-width"]=Xe),te.attr($e).shadow(o.shadow)),te[pt]({x:Ue/2,y:Ue/2,width:p-Ue-Xe%2,height:x-Ue-Xe%2,r:o.borderRadius}),pt="animate",ce||(pt="attr",this.plotBackground=ce=u.rect().addClass("highcharts-plot-background").add()),ce[pt](K),!v&&(ce.attr({fill:I||"none"}).shadow(o.plotShadow),O&&(S?(O!==S.attr("href")&&S.attr("href",O),S.animate(K)):this.plotBGImage=u.image(O,N,z,j,q).add())),se?se.animate({width:re.width,height:re.height}):this.clipRect=u.clipRect(re),pt="animate",fe||(pt="attr",this.plotBorder=fe=u.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),v||fe.attr({stroke:o.plotBorderColor,"stroke-width":o.plotBorderWidth||0,fill:"none"}),fe[pt](fe.crisp(K,-fe.strokeWidth())),this.isDirtyBox=!1,Tr(this,"afterDrawChartBox")}propFromSeries(){let o,u,p,x=this,v=x.options.chart,S=x.options.series;["inverted","angular","polar"].forEach(function(A){for(u=gc[v.type],p=v[A]||u&&u.prototype[A],o=S==null?void 0:S.length;!p&&o--;)(u=gc[S[o].type])&&u.prototype[A]&&(p=!0);x[A]=p})}linkSeries(o){let u=this,p=u.series;p.forEach(function(x){x.linkedSeries.length=0}),p.forEach(function(x){let{linkedTo:v}=x.options;if($d(v)){let S;(S=v===":previous"?u.series[x.index-1]:u.get(v))&&S.linkedParent!==x&&(S.linkedSeries.push(x),x.linkedParent=S,S.enabledDataSorting&&x.setDataSortingOptions(),x.visible=ys(x.options.visible,S.options.visible,x.visible))}}),Tr(this,"afterLinkSeries",{isUpdating:o})}renderSeries(){this.series.forEach(function(o){o.translate(),o.render()})}render(){var N;let o=this.axes,u=this.colorAxis,p=this.renderer,x=this.options.chart.axisLayoutRuns||2,v=z=>{z.forEach(j=>{j.visible&&j.render()})},S=0,A=!0,I,O=0;for(let z of(this.setTitle(),Tr(this,"beforeMargins"),(N=this.getStacks)==null||N.call(this),this.getMargins(!0),this.setChartSize(),o)){let{options:j}=z,{labels:q}=j;if(this.hasCartesianSeries&&z.horiz&&z.visible&&q.enabled&&z.series.length&&z.coll!=="colorAxis"&&!this.polar){S=j.tickLength,z.createGroups();let K=new va(z,0,"",!0),se=K.createLabel("x",q);if(K.destroy(),se&&ys(q.reserveSpace,!pu(j.crossing))&&(S=se.getBBox().height+q.distance+Math.max(j.offset||0,0)),S){se==null||se.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-S,0);(A||I||x>1)&&O<x;){let z=this.plotWidth,j=this.plotHeight;for(let q of o)O===0?q.setScale():(q.horiz&&A||!q.horiz&&I)&&q.setTickInterval(!0);O===0?this.getAxisMargins():this.getMargins(),A=z/this.plotWidth>(O?1:1.1),I=j/this.plotHeight>(O?1:1.05),O++}this.drawChartBox(),this.hasCartesianSeries?v(o):u!=null&&u.length&&v(u),this.seriesGroup||(this.seriesGroup=p.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(o){let u=this,p=Bs(!0,this.options.credits,o);p.enabled&&!this.credits&&(this.credits=this.renderer.text(p.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){p.href&&(fu.location.href=p.href)}).attr({align:p.position.align,zIndex:8}),u.styledMode||this.credits.css(p.style),this.credits.add().align(p.position),this.credits.update=function(x){u.credits=u.credits.destroy(),u.addCredits(x)})}destroy(){var A,I;let o,u=this,p=u.axes,x=u.series,v=u.container,S=v==null?void 0:v.parentNode;for(Tr(u,"destroy"),u.renderer.forExport?zs(mc,u):mc[u.index]=void 0,Ie.chartCount--,u.renderTo.removeAttribute("data-highcharts-chart"),S_(u),o=p.length;o--;)p[o]=p[o].destroy();for((I=(A=this.scroller)==null?void 0:A.destroy)==null||I.call(A),o=x.length;o--;)x[o]=x[o].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(O=>{var N,z;u[O]=(z=(N=u[O])==null?void 0:N.destroy)==null?void 0:z.call(N)}),v&&(v.innerHTML=Vr.emptyHTML,S_(v),S&&Vd(v)),pp(u,function(O,N){delete u[N]})}firstRender(){var x;let o=this,u=o.options;o.getContainer(),o.resetMargins(),o.setChartSize(),o.propFromSeries(),o.createAxes();let p=Kx(u.series)?u.series:[];u.series=[],p.forEach(function(v){o.initSeries(v)}),o.linkSeries(),o.setSortedData(),Tr(o,"beforeRender"),o.render(),(x=o.pointer)==null||x.getChartPosition(),o.renderer.imgCount||o.hasLoaded||o.onload(),o.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(o){o&&this.index!==void 0&&o.apply(this,[this])},this),Tr(this,"load"),Tr(this,"render"),Ko(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:o,title:u}=this;!o||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":((u==null?void 0:u.element.textContent)||"").replace(/</g,"&lt;")}),o.accessibility&&o.accessibility.enabled===!1||oo('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(o,u,p){let x,v=this;return o&&(u=ys(u,!0),Tr(v,"addSeries",{options:o},function(){x=v.initSeries(o),v.isDirtyLegend=!0,v.linkSeries(),x.enabledDataSorting&&x.setData(o.data,!1),Tr(v,"afterAddSeries",{series:x}),u&&v.redraw(p)})),x}addAxis(o,u,p,x){return this.createAxis(u?"xAxis":"yAxis",{axis:o,redraw:p,animation:x})}addColorAxis(o,u,p){return this.createAxis("colorAxis",{axis:o,redraw:u,animation:p})}createAxis(o,u){let p=new Wa(this,u.axis,o);return ys(u.redraw,!0)&&this.redraw(u.animation),p}showLoading(o){let u=this,p=u.options,x=p.loading,v=function(){S&&Ws(S,{left:u.plotLeft+"px",top:u.plotTop+"px",width:u.plotWidth+"px",height:u.plotHeight+"px"})},S=u.loadingDiv,A=u.loadingSpan;S||(u.loadingDiv=S=fp("div",{className:"highcharts-loading highcharts-loading-hidden"},null,u.container)),A||(u.loadingSpan=A=fp("span",{className:"highcharts-loading-inner"},null,S),Aa(u,"redraw",v)),S.className="highcharts-loading",Vr.setElementHTML(A,ys(o,p.lang.loading,"")),u.styledMode||(Ws(S,Za(x.style,{zIndex:10})),Ws(A,x.labelStyle),u.loadingShown||(Ws(S,{opacity:0,display:""}),Cl(S,{opacity:x.style.opacity||.5},{duration:x.showDuration||0}))),u.loadingShown=!0,v()}hideLoading(){let o=this.options,u=this.loadingDiv;u&&(u.className="highcharts-loading highcharts-loading-hidden",this.styledMode||Cl(u,{opacity:0},{duration:o.loading.hideDuration||100,complete:function(){Ws(u,{display:"none"})}})),this.loadingShown=!1}update(o,u,p,x){let v,S,A,I=this,O={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},N=o.isResponsiveOptions,z=[];Tr(I,"update",{options:o}),N||I.setResponsive(!1,!0),o=so(o,I.options),I.userOptions=Bs(I.userOptions,o);let j=o.chart;j&&(Bs(!0,I.options.chart,j),this.setZoomOptions(),"className"in j&&I.setClassName(j.className),("inverted"in j||"polar"in j||"type"in j)&&(I.propFromSeries(),v=!0),"alignTicks"in j&&(v=!0),"events"in j&&zm(this,j),pp(j,function(se,re){I.propsRequireUpdateSeries.indexOf("chart."+re)!==-1&&(S=!0),I.propsRequireDirtyBox.indexOf(re)!==-1&&(I.isDirtyBox=!0),I.propsRequireReflow.indexOf(re)===-1||(I.isDirtyBox=!0,N||(A=!0))}),!I.styledMode&&j.style&&I.renderer.setStyle(I.options.chart.style||{})),!I.styledMode&&o.colors&&(this.options.colors=o.colors),pp(o,function(se,re){I[re]&&typeof I[re].update=="function"?I[re].update(se,!1):typeof I[O[re]]=="function"?I[O[re]](se):re!=="colors"&&I.collectionsWithUpdate.indexOf(re)===-1&&Bs(!0,I.options[re],o[re]),re!=="chart"&&I.propsRequireUpdateSeries.indexOf(re)!==-1&&(S=!0)}),this.collectionsWithUpdate.forEach(function(se){o[se]&&(mp(o[se]).forEach(function(re,te){let ce,fe=Ko(re.id);fe&&(ce=I.get(re.id)),!ce&&I[se]&&(ce=I[se][ys(re.index,te)])&&(fe&&Ko(ce.options.id)||ce.options.isInternal)&&(ce=void 0),ce&&ce.coll===se&&(ce.update(re,!1),p&&(ce.touched=!0)),!ce&&p&&I.collectionsWithInit[se]&&(I.collectionsWithInit[se][0].apply(I,[re].concat(I.collectionsWithInit[se][1]||[]).concat([!1])).touched=!0)}),p&&I[se].forEach(function(re){re.touched||re.options.isInternal?delete re.touched:z.push(re)}))}),z.forEach(function(se){se.chart&&se.remove&&se.remove(!1)}),v&&I.axes.forEach(function(se){se.update({},!1)}),S&&I.getSeriesOrderByLinks().forEach(function(se){se.chart&&se.update({},!1)},this);let q=j==null?void 0:j.width,K=j&&($d(j.height)?Bm(j.height,q||I.chartWidth):j.height);A||pu(q)&&q!==I.chartWidth||pu(K)&&K!==I.chartHeight?I.setSize(q,K,x):ys(u,!0)&&I.redraw(x),Tr(I,"afterUpdate",{options:o,redraw:u,animation:x})}setSubtitle(o,u){this.applyDescription("subtitle",o),this.layOutTitles(u)}setCaption(o,u){this.applyDescription("caption",o),this.layOutTitles(u)}showResetZoom(){let o=this,u=Nd.lang,p=o.zooming.resetButton,x=p.theme,v=p.relativeTo==="chart"||p.relativeTo==="spacingBox"?null:"plotBox";function S(){o.zoomOut()}Tr(this,"beforeShowResetZoom",null,function(){o.resetZoomButton=o.renderer.button(u.resetZoom,null,null,S,x).attr({align:p.position.align,title:u.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(p.position,!1,v)}),Tr(this,"afterShowResetZoom")}zoomOut(){Tr(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(o,u){let p=this,x=typeof u=="object"?u:{enabled:u,type:"x"},v=x.type,S=v&&p[{x:"xAxis",xy:"axes",y:"yAxis"}[v]].filter(I=>I.options.panningEnabled&&!I.options.isInternal),A=p.options.chart;A!=null&&A.panning&&(A.panning=x),Tr(this,"pan",{originalEvent:o},()=>{p.transform({axes:S,event:o,to:{x:o.chartX-(p.mouseDownX||0),y:o.chartY-(p.mouseDownY||0)},trigger:"pan"}),Ws(p.container,{cursor:"move"})})}transform(o){var K;let{axes:u=this.axes,event:p,from:x={},reset:v,selection:S,to:A={},trigger:I}=o,{inverted:O,time:N}=this,z=!1,j,q;for(let se of((K=this.hoverPoints)==null||K.forEach(re=>re.setState()),u)){let{horiz:re,len:te,minPointOffset:ce=0,options:fe,reversed:Xe}=se,Ue=re?"width":"height",$e=re?"x":"y",pt=ys(A[Ue],se.len),tt=ys(x[Ue],se.len),mt=10>Math.abs(pt)?1:pt/tt,Bt=(x[$e]||0)+tt/2-se.pos,Yt=Bt-((A[$e]??se.pos)+pt/2-se.pos)/mt,ei=Xe&&!O||!Xe&&O?-1:1;if(!v&&(Bt<0||Bt>se.len))continue;let Ft=se.toValue(Yt,!0)+(S||se.isOrdinal?0:ce*ei),ci=se.toValue(Yt+te/mt,!0)-(S||se.isOrdinal?0:ce*ei||0),mi=se.allExtremes;if(Ft>ci&&([Ft,ci]=[ci,Ft]),mt===1&&!v&&se.coll==="yAxis"&&!mi){for(let lo of se.series){let Po=lo.getExtremes(lo.getProcessedData(!0).modified.getColumn("y")||[],!0);mi??(mi={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),pu(Po.dataMin)&&pu(Po.dataMax)&&(mi.dataMin=Math.min(Po.dataMin,mi.dataMin),mi.dataMax=Math.max(Po.dataMax,mi.dataMax))}se.allExtremes=mi}let{dataMin:Ni,dataMax:bi,min:Vi,max:gr}=Za(se.getExtremes(),mi||{}),ar=N.parse(fe.min),vr=N.parse(fe.max),Ss=Ni??ar,_r=bi??vr,zr=ci-Ft,Hi=se.categories?0:Math.min(zr,_r-Ss),di=Ss-Hi*(Ko(ar)?0:fe.minPadding),Mn=_r+Hi*(Ko(vr)?0:fe.maxPadding),Br=se.allowZoomOutside||mt===1||I!=="zoom"&&mt>1,Kr=Math.min(ar??di,di,Br?Vi:di),on=Math.max(vr??Mn,Mn,Br?gr:Mn);(!se.isOrdinal||se.options.overscroll||mt!==1||v)&&(Ft<Kr&&(Ft=Kr,mt>=1&&(ci=Ft+zr)),ci>on&&(ci=on,mt>=1&&(Ft=ci-zr)),(v||se.series.length&&(Ft!==Vi||ci!==gr)&&Ft>=Kr&&ci<=on)&&(S?S[se.coll].push({axis:se,min:Ft,max:ci}):(se.isPanning=I!=="zoom",se.isPanning&&(q=!0),se.setExtremes(v?void 0:Ft,v?void 0:ci,!1,!1,{move:Yt,trigger:I,scale:mt}),!v&&(Ft>Kr||ci<on)&&I!=="mousewheel"&&(j=!0)),z=!0),p&&(this[re?"mouseDownX":"mouseDownY"]=p[re?"chartX":"chartY"]))}return z&&(S?Tr(this,"selection",S,()=>{delete o.selection,o.trigger="zoom",this.transform(o)}):(!j||q||this.resetZoomButton?!j&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw(I==="zoom"&&(this.options.chart.animation??this.pointCount<100)))),z}}Za(Jo.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Jo.prototype.addAxis,[!0]],yAxis:[Jo.prototype.addAxis,[!1]],series:[Jo.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});let{stop:Fm}=En,{composed:Nm}=Ie,{addEvent:Ya,createElement:ls,css:Gd,defined:gp,erase:Ka,merge:M_,pushUnique:_c}=xe;function Wd(){let R=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!R&&(this.scrollablePlotArea=R=new Fs(this)),R==null||R.applyFixed()}function Mo(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class Fs{static compose(o,u,p){_c(Nm,this.compose)&&(Ya(o,"afterInit",Mo),Ya(u,"afterSetChartSize",x=>this.afterSetSize(x.target,x)),Ya(u,"render",Wd),Ya(p,"show",Mo))}static afterSetSize(o,u){let p,x,v,{minWidth:S,minHeight:A}=o.options.chart.scrollablePlotArea||{},{clipBox:I,plotBox:O,inverted:N,renderer:z}=o;if(!z.forExport&&(S?(o.scrollablePixelsX=p=Math.max(0,S-o.chartWidth),p&&(o.scrollablePlotBox=M_(o.plotBox),O.width=o.plotWidth+=p,I[N?"height":"width"]+=p,v=!0)):A&&(o.scrollablePixelsY=x=Math.max(0,A-o.chartHeight),gp(x)&&(o.scrollablePlotBox=M_(o.plotBox),O.height=o.plotHeight+=x,I[N?"width":"height"]+=x,v=!1)),gp(v)&&!u.skipAxes))for(let j of o.axes)(j.horiz===v||o.hasParallelCoordinates&&j.coll==="yAxis")&&(j.setAxisSize(),j.setAxisTranslation())}constructor(o){var q;let u,p=o.options.chart,x=xo.getRendererType(),v=p.scrollablePlotArea||{},S=this.moveFixedElements.bind(this),A={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};o.scrollablePixelsX&&(A.overflowX="auto"),o.scrollablePixelsY&&(A.overflowY="auto"),this.chart=o;let I=this.parentDiv=ls("div",{className:"highcharts-scrolling-parent"},{position:"relative"},o.renderTo),O=this.scrollingContainer=ls("div",{className:"highcharts-scrolling"},A,I),N=this.innerContainer=ls("div",{className:"highcharts-inner-container"},void 0,O),z=this.fixedDiv=ls("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(((q=p.style)==null?void 0:q.zIndex)||0)+2,top:0},void 0,!0),j=this.fixedRenderer=new x(z,o.chartWidth,o.chartHeight,p.style);this.mask=j.path().attr({fill:p.backgroundColor||"#fff","fill-opacity":v.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),O.parentNode.insertBefore(z,O),Gd(o.renderTo,{overflow:"visible"}),Ya(o,"afterShowResetZoom",S),Ya(o,"afterApplyDrilldown",S),Ya(o,"afterLayOutTitles",S),Ya(O,"scroll",()=>{let{pointer:K,hoverPoint:se}=o;K&&(delete K.chartPosition,se&&(u=se),K.runPointActions(void 0,u,!0))}),N.appendChild(o.container)}applyFixed(){var Bt;let{chart:o,fixedRenderer:u,isDirty:p,scrollingContainer:x}=this,{axisOffset:v,chartWidth:S,chartHeight:A,container:I,plotHeight:O,plotLeft:N,plotTop:z,plotWidth:j,scrollablePixelsX:q=0,scrollablePixelsY:K=0}=o,{scrollPositionX:se=0,scrollPositionY:re=0}=o.options.chart.scrollablePlotArea||{},te=S+q,ce=A+K;u.setSize(S,A),(p??!0)&&(this.isDirty=!1,this.moveFixedElements()),Fm(o.container),Gd(I,{width:`${te}px`,height:`${ce}px`}),o.renderer.boxWrapper.attr({width:te,height:ce,viewBox:[0,0,te,ce].join(" ")}),(Bt=o.chartBackground)==null||Bt.attr({width:te,height:ce}),Gd(x,{width:`${S}px`,height:`${A}px`}),gp(p)||(x.scrollLeft=q*se,x.scrollTop=K*re);let fe=z-v[0]-1,Xe=N-v[3]-1,Ue=z+O+v[2]+1,$e=N+j+v[1]+1,pt=N+j-q,tt=z+O-K,mt=[["M",0,0]];q?mt=[["M",0,fe],["L",N-1,fe],["L",N-1,Ue],["L",0,Ue],["Z"],["M",pt,fe],["L",S,fe],["L",S,Ue],["L",pt,Ue],["Z"]]:K&&(mt=[["M",Xe,0],["L",Xe,z-1],["L",$e,z-1],["L",$e,0],["Z"],["M",Xe,tt],["L",Xe,A],["L",$e,A],["L",$e,tt],["Z"]]),o.redrawTrigger!=="adjustHeight"&&this.mask.attr({d:mt})}moveFixedElements(){let o,{container:u,inverted:p,scrollablePixelsX:x,scrollablePixelsY:v}=this.chart,S=this.fixedRenderer,A=Fs.fixedSelectors;if(x&&!p?o=".highcharts-yaxis":x&&p||v&&!p?o=".highcharts-xaxis":v&&p&&(o=".highcharts-yaxis"),o&&!(this.chart.hasParallelCoordinates&&o===".highcharts-yaxis"))for(let I of[`${o}:not(.highcharts-radial-axis)`,`${o}-labels:not(.highcharts-radial-axis-labels)`])_c(A,I);else for(let I of[".highcharts-xaxis",".highcharts-yaxis"])for(let O of[`${I}:not(.highcharts-radial-axis)`,`${I}-labels:not(.highcharts-radial-axis-labels)`])Ka(A,O);for(let I of A)[].forEach.call(u.querySelectorAll(I),O=>{(O.namespaceURI===S.SVG_NS?S.box:S.box.parentNode).appendChild(O),O.style.pointerEvents="auto"})}}Fs.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];let{format:Jx}=ds,{series:_p}=kr,{destroyObjectProperties:I_,fireEvent:k_,getAlignFactor:Hd,isNumber:Qo,pick:Ma}=xe,Um=class{constructor(R,o,u,p,x){let v=R.chart.inverted,S=R.reversed;this.axis=R;let A=this.isNegative=!!u!=!!S;this.options=o=o||{},this.x=p,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=x,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:o.align||(v?A?"left":"right":"center"),verticalAlign:o.verticalAlign||(v?"middle":A?"bottom":"top"),y:o.y,x:o.x},this.textAlign=o.textAlign||(v?A?"right":"left":"center")}destroy(){I_(this,this.axis)}render(R){let o=this.axis.chart,u=this.options,p=u.format,x=p?Jx(p,this,o):u.formatter.call(this);if(this.label)this.label.attr({text:x,visibility:"hidden"});else{this.label=o.renderer.label(x,null,void 0,u.shape,void 0,void 0,u.useHTML,!1,"stack-labels");let v={r:u.borderRadius||0,text:x,padding:Ma(u.padding,5),visibility:"hidden"};o.styledMode||(v.fill=u.backgroundColor,v.stroke=u.borderColor,v["stroke-width"]=u.borderWidth,this.label.css(u.style||{})),this.label.attr(v),this.label.added||this.label.add(R)}this.label.labelrank=o.plotSizeY,k_(this,"afterRender")}setOffset(R,o,u,p,x,v){let{alignOptions:S,axis:A,label:I,options:O,textAlign:N}=this,z=A.chart,j=this.getStackBox({xOffset:R,width:o,boxBottom:u,boxTop:p,defaultX:x,xAxis:v}),{verticalAlign:q}=S;if(I&&j){let K=I.getBBox(void 0,0),se=I.padding,re=Ma(O.overflow,"justify")==="justify",te;S.x=O.x||0,S.y=O.y||0;let{x:ce,y:fe}=this.adjustStackPosition({labelBox:K,verticalAlign:q,textAlign:N});j.x-=ce,j.y-=fe,I.align(S,!1,j),(te=z.isInsidePlot(I.alignAttr.x+S.x+ce,I.alignAttr.y+S.y+fe))||(re=!1),re&&_p.prototype.justifyDataLabel.call(A,I,S,I.alignAttr,K,j),I.attr({x:I.alignAttr.x,y:I.alignAttr.y,rotation:O.rotation,rotationOriginX:K.width*Hd(O.textAlign||"center"),rotationOriginY:K.height/2}),Ma(!re&&O.crop,!0)&&(te=Qo(I.x)&&Qo(I.y)&&z.isInsidePlot(I.x-se+(I.width||0),I.y)&&z.isInsidePlot(I.x+se,I.y)),I[te?"show":"hide"]()}k_(this,"afterSetOffset",{xOffset:R,width:o})}adjustStackPosition({labelBox:R,verticalAlign:o,textAlign:u}){return{x:R.width/2+R.width/2*(2*Hd(u)-1),y:R.height/2*2*(1-Hd(o))}}getStackBox(R){let o=this.axis,u=o.chart,{boxTop:p,defaultX:x,xOffset:v,width:S,boxBottom:A}=R,I=o.stacking.usePercentage?100:Ma(p,this.total,0),O=o.toPixels(I),N=R.xAxis||u.xAxis[0],z=Ma(x,N.translate(this.x))+v,j=Math.abs(O-o.toPixels(A||Qo(o.min)&&o.logarithmic&&o.logarithmic.lin2log(o.min)||0)),q=u.inverted,K=this.isNegative;return q?{x:(K?O:O-j)-u.plotLeft,y:N.height-z-S+N.top-u.plotTop,width:j,height:S}:{x:z+N.transB-u.plotLeft,y:(K?O-j:O)-u.plotTop,width:S,height:j}}},{getDeferredAnimation:P_}=En,{series:{prototype:Qx}}=kr,{addEvent:qd,correctFloat:lh,defined:ch,destroyObjectProperties:mu,fireEvent:Xd,isNumber:gu,objectEach:yc,pick:hh}=xe;function Vm(){let R=this.inverted;this.axes.forEach(o=>{var u;(u=o.stacking)!=null&&u.stacks&&o.hasVisibleSeries&&(o.stacking.oldStacks=o.stacking.stacks)}),this.series.forEach(o=>{var p;let u=((p=o.xAxis)==null?void 0:p.options)||{};o.options.stacking&&o.reserveSpace()&&(o.stackKey=[o.type,hh(o.options.stack,""),R?u.top:u.left,R?u.height:u.width].join(","))})}function L_(){var o;let R=this.stacking;if(R){let u=R.stacks;yc(u,(p,x)=>{mu(p),delete u[x]}),(o=R.stackTotalGroup)==null||o.destroy()}}function _u(){this.stacking||(this.stacking=new Zd(this))}function D_(R,o,u,p){return!ch(R)||R.x!==o||p&&R.stackKey!==p?R={x:o,index:0,key:p,stackKey:p}:R.index++,R.key=[u,o,R.index].join(","),R}function jm(){let R,o=this,u=o.yAxis,p=o.stackKey||"",x=u.stacking.stacks,v=o.getColumn("x",!0),S=o.options.stacking,A=o[S+"Stacker"];A&&[p,"-"+p].forEach(I=>{var q;let O=v.length,N,z,j;for(;O--;)N=v[O],R=o.getStackIndicator(R,N,o.index,I),z=(q=x[I])==null?void 0:q[N],(j=z==null?void 0:z.points[R.key||""])&&A.call(o,j,z,O)})}function O_(R,o,u){let p=o.total?100/o.total:0;R[0]=lh(R[0]*p),R[1]=lh(R[1]*p),this.stackedYData[u]=R[1]}function ev(R){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&this.chart.series.length>1?Qx.setStackedPoints.call(this,R,"group"):R.stacking.resetStacks())}function tv(R,o){var tt,mt;let u,p,x,v,S,A,I,O=o||this.options.stacking;if(!O||!this.reserveSpace()||({group:"xAxis"}[O]||"yAxis")!==R.coll)return;let N=this.getColumn("x",!0),z=this.getColumn(this.pointValKey||"y",!0),j=[],q=z.length,K=this.options,se=K.threshold||0,re=K.startFromThreshold?se:0,te=K.stack,ce=o?`${this.type},${O}`:this.stackKey||"",fe="-"+ce,Xe=this.negStacks,Ue=R.stacking,$e=Ue.stacks,pt=Ue.oldStacks;for(Ue.stacksTouched+=1,I=0;I<q;I++){let Bt=N[I]||0,Yt=z[I],ei=gu(Yt)&&Yt||0;A=(u=this.getStackIndicator(u,Bt,this.index)).key||"",$e[S=(p=Xe&&ei<(re?0:se))?fe:ce]||($e[S]={}),$e[S][Bt]||((tt=pt[S])!=null&&tt[Bt]?($e[S][Bt]=pt[S][Bt],$e[S][Bt].total=null):$e[S][Bt]=new Um(R,R.options.stackLabels,!!p,Bt,te)),x=$e[S][Bt],Yt!==null?(x.points[A]=x.points[this.index]=[hh(x.cumulative,re)],ch(x.cumulative)||(x.base=A),x.touched=Ue.stacksTouched,u.index>0&&this.singleStacks===!1&&(x.points[A][0]=x.points[this.index+","+Bt+",0"][0])):(delete x.points[A],delete x.points[this.index]);let Ft=x.total||0;O==="percent"?(v=p?ce:fe,Ft=Xe&&((mt=$e[v])!=null&&mt[Bt])?(v=$e[v][Bt]).total=Math.max(v.total||0,Ft)+Math.abs(ei):lh(Ft+Math.abs(ei))):O==="group"?gu(Yt)&&Ft++:Ft=lh(Ft+ei),O==="group"?x.cumulative=(Ft||1)-1:x.cumulative=lh(hh(x.cumulative,re)+ei),x.total=Ft,Yt!==null&&(x.points[A].push(x.cumulative),j[I]=x.cumulative,x.hasValidPoints=!0)}O==="percent"&&(Ue.usePercentage=!0),O!=="group"&&(this.stackedYData=j),Ue.oldStacks={}}class Zd{constructor(o){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=o}buildStacks(){let o,u,p=this.axis,x=p.series,v=p.coll==="xAxis",S=p.options.reversedStacks,A=x.length;for(this.resetStacks(),this.usePercentage=!1,u=A;u--;)o=x[S?u:A-u-1],v&&o.setGroupedPoints(p),o.setStackedPoints(p);if(!v)for(u=0;u<A;u++)x[u].modifyStacks();Xd(p,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,yc(this.stacks,o=>{yc(o,u=>{u.cumulative=u.total})}))}resetStacks(){yc(this.stacks,o=>{yc(o,(u,p)=>{gu(u.touched)&&u.touched<this.stacksTouched?(u.destroy(),delete o[p]):(u.total=null,u.cumulative=null)})})}renderStackTotals(){var A;let o=this.axis,u=o.chart,p=u.renderer,x=this.stacks,v=P_(u,((A=o.options.stackLabels)==null?void 0:A.animation)||!1),S=this.stackTotalGroup=this.stackTotalGroup||p.g("stack-labels").attr({zIndex:6,opacity:0}).add();S.translate(u.plotLeft,u.plotTop),yc(x,I=>{yc(I,O=>{O.render(S)})}),S.animate({opacity:1},v)}}(Me||(Me={})).compose=function(R,o,u){let p=o.prototype,x=u.prototype;p.getStacks||(qd(R,"init",_u),qd(R,"destroy",L_),p.getStacks=Vm,x.getStackIndicator=D_,x.modifyStacks=jm,x.percentStacker=O_,x.setGroupedPoints=ev,x.setStackedPoints=tv)};let R_=Me,{defined:xc,merge:Rr,isObject:$m}=xe;class Ia extends _s{drawGraph(){let o=this.options,u=(this.gappedPath||this.getGraphPath).call(this),p=this.chart.styledMode;[this,...this.zones].forEach((x,v)=>{let S,A=x.graph,I=A?"animate":"attr",O=x.dashStyle||o.dashStyle;A?(A.endX=this.preventGraphAnimation?null:u.xMap,A.animate({d:u})):u.length&&(x.graph=A=this.chart.renderer.path(u).addClass("highcharts-graph"+(v?` highcharts-zone-graph-${v-1} `:" ")+(v&&x.className||"")).attr({zIndex:1}).add(this.group)),A&&!p&&(S={stroke:!v&&o.lineColor||x.color||this.color||"#cccccc","stroke-width":o.lineWidth||0,fill:this.fillGraph&&this.color||"none"},O?S.dashstyle=O:o.linecap!=="square"&&(S["stroke-linecap"]=S["stroke-linejoin"]="round"),A[I](S).shadow(o.shadow&&Rr({filterUnits:"userSpaceOnUse"},$m(o.shadow)?o.shadow:{}))),A&&(A.startX=u.xMap,A.isArea=u.isArea)})}getGraphPath(o,u,p){let x=this,v=x.options,S=[],A=[],I,O=v.step,N=(o=o||x.points).reversed;return N&&o.reverse(),(O={right:1,center:2}[O]||O&&3)&&N&&(O=4-O),(o=this.getValidPoints(o,!1,v.nullInteraction||!(v.connectNulls&&!u&&!p))).forEach(function(z,j){let q,K=z.plotX,se=z.plotY,re=o[j-1],te=z.isNull||typeof se!="number";(z.leftCliff||re!=null&&re.rightCliff)&&!p&&(I=!0),te&&!xc(u)&&j>0?I=!v.connectNulls:te&&!u?I=!0:(j===0||I?q=[["M",z.plotX,z.plotY]]:x.getPointSpline?q=[x.getPointSpline(o,z,j)]:O?(q=O===1?[["L",re.plotX,se]]:O===2?[["L",(re.plotX+K)/2,re.plotY],["L",(re.plotX+K)/2,se]]:[["L",K,re.plotY]]).push(["L",K,se]):q=[["L",K,se]],A.push(z.x),O&&(A.push(z.x),O===2&&A.push(z.x)),S.push.apply(S,q),I=!1)}),S.xMap=A,x.graphPath=S,S}}Ia.defaultOptions=Rr(_s.defaultOptions,{legendSymbol:"lineMarker"}),kr.registerSeriesType("line",Ia);let{seriesTypes:{line:ea}}=kr,{extend:ka,merge:Io,objectEach:xs,pick:Yd}=xe;class ko extends ea{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:o,options:u}=this;[this,...this.zones].forEach((p,x)=>{let v={},S=p.fillColor||u.fillColor,A=p.area,I=A?"animate":"attr";A?(A.endX=this.preventGraphAnimation?null:o.xMap,A.animate({d:o})):(v.zIndex=0,(A=p.area=this.chart.renderer.path(o).addClass("highcharts-area"+(x?` highcharts-zone-area-${x-1} `:" ")+(x&&p.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(v.fill=S||p.color||this.color,v["fill-opacity"]=S?1:u.fillOpacity??.75,A.css({pointerEvents:this.stickyTracking?"none":"auto"})),A[I](v),A.startX=o.xMap,A.shiftUnit=u.step?2:1})}getGraphPath(o){let u,p,x,v=ea.prototype.getGraphPath,S=this.options,A=S.stacking,I=this.yAxis,O=[],N=[],z=this.index,j=I.stacking.stacks[this.stackKey],q=S.threshold,K=Math.round(I.getThreshold(S.threshold)),se=Yd(S.connectNulls,A==="percent"),re=function($e,pt,tt){let mt=o[$e],Bt=A&&j[mt.x].points[z],Yt=mt[tt+"Null"]||0,ei=mt[tt+"Cliff"]||0,Ft,ci,mi=!0;ei||Yt?(Ft=(Yt?Bt[0]:Bt[1])+ei,ci=Bt[0]+ei,mi=!!Yt):!A&&o[pt]&&o[pt].isNull&&(Ft=ci=q),Ft!==void 0&&(N.push({plotX:u,plotY:Ft===null?K:I.getThreshold(Ft),isNull:mi,isCliff:!0}),O.push({plotX:u,plotY:ci===null?K:I.getThreshold(ci),doCurve:!1}))};o=o||this.points,A&&(o=this.getStackPoints(o));for(let $e=0,pt=o.length;$e<pt;++$e)A||(o[$e].leftCliff=o[$e].rightCliff=o[$e].leftNull=o[$e].rightNull=void 0),p=o[$e].isNull,u=Yd(o[$e].rectPlotX,o[$e].plotX),x=A?Yd(o[$e].yBottom,K):K,p&&!se||(se||re($e,$e-1,"left"),p&&!A&&se||(N.push(o[$e]),O.push({x:$e,plotX:u,plotY:x})),se||re($e,$e+1,"right"));let te=v.call(this,N,!0,!0);O.reversed=!0;let ce=v.call(this,O,!0,!0),fe=ce[0];fe&&fe[0]==="M"&&(ce[0]=["L",fe[1],fe[2]]);let Xe=te.concat(ce);Xe.length&&Xe.push(["Z"]);let Ue=v.call(this,N,!1,se);return this.chart.series.length>1&&A&&N.some($e=>$e.isCliff)&&(Xe.hasStackedCliffs=Ue.hasStackedCliffs=!0),Xe.xMap=te.xMap,this.areaPath=Xe,Ue}getStackPoints(o){let u=this,p=[],x=[],v=this.xAxis,S=this.yAxis,A=S.stacking.stacks[this.stackKey],I={},O=S.series,N=O.length,z=S.options.reversedStacks?1:-1,j=O.indexOf(u);if(o=o||this.points,this.options.stacking){for(let K=0;K<o.length;K++)o[K].leftNull=o[K].rightNull=void 0,I[o[K].x]=o[K];xs(A,function(K,se){K.total!==null&&x.push(se)}),x.sort(function(K,se){return K-se});let q=O.map(K=>K.visible);x.forEach(function(K,se){let re=0,te,ce;if(I[K]&&!I[K].isNull)p.push(I[K]),[-1,1].forEach(function(fe){let Xe=fe===1?"rightNull":"leftNull",Ue=A[x[se+fe]],$e=0;if(Ue){let pt=j;for(;pt>=0&&pt<N;){let tt=O[pt].index;!(te=Ue.points[tt])&&(tt===u.index?I[K][Xe]=!0:q[pt]&&(ce=A[K].points[tt])&&($e-=ce[1]-ce[0])),pt+=z}}I[K][fe===1?"rightCliff":"leftCliff"]=$e});else{let fe=j;for(;fe>=0&&fe<N;){let Xe=O[fe].index;if(te=A[K].points[Xe]){re=te[1];break}fe+=z}re=Yd(re,0),re=S.translate(re,0,1,0,1),p.push({isNull:!0,plotX:v.translate(K,0,0,0,1),x:K,plotY:re,yBottom:re})}})}return p}}ko.defaultOptions=Io(ea.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),ka(ko.prototype,{singleStacks:!1}),kr.registerSeriesType("area",ko);let{line:Gm}=kr.seriesTypes,{merge:yu,pick:xu}=xe;class yp extends Gm{getPointSpline(o,u,p){let x,v,S,A,I=u.plotX||0,O=u.plotY||0,N=o[p-1],z=o[p+1];function j(K){return K&&!K.isNull&&K.doCurve!==!1&&!u.isCliff}if(j(N)&&j(z)){let K=N.plotX||0,se=N.plotY||0,re=z.plotX||0,te=z.plotY||0,ce=0;x=(1.5*I+K)/2.5,v=(1.5*O+se)/2.5,S=(1.5*I+re)/2.5,A=(1.5*O+te)/2.5,S!==x&&(ce=(A-v)*(S-I)/(S-x)+O-A),v+=ce,A+=ce,v>se&&v>O?(v=Math.max(se,O),A=2*O-v):v<se&&v<O&&(v=Math.min(se,O),A=2*O-v),A>te&&A>O?(A=Math.max(te,O),v=2*O-A):A<te&&A<O&&(A=Math.min(te,O),v=2*O-A),u.rightContX=S,u.rightContY=A,u.controlPoints={low:[x,v],high:[S,A]}}let q=["C",xu(N.rightContX,N.plotX,0),xu(N.rightContY,N.plotY,0),xu(x,I,0),xu(v,O,0),I,O];return N.rightContX=N.rightContY=void 0,q}}yp.defaultOptions=yu(Gm.defaultOptions),kr.registerSeriesType("spline",yp);let xp=yp,{area:iv,area:{prototype:Kd}}=kr.seriesTypes,{extend:z_,merge:rv}=xe;class Pa extends xp{}Pa.defaultOptions=rv(xp.defaultOptions,iv.defaultOptions),z_(Pa.prototype,{getGraphPath:Kd.getGraphPath,getStackPoints:Kd.getStackPoints,drawGraph:Kd.drawGraph}),kr.registerSeriesType("areaspline",Pa);let{animObject:uh}=En,{parse:vp}=st,{noop:bp}=Ie,{clamp:vu,crisp:Jd,defined:B_,extend:Wm,fireEvent:F_,isArray:wp,isNumber:Tp,merge:Qd,pick:bu,objectEach:N_}=xe;class Ja extends _s{animate(o){let u,p,x=this,v=this.yAxis,S=v.pos,A=v.reversed,I=x.options,{clipOffset:O,inverted:N}=this.chart,z={},j=N?"translateX":"translateY";o&&O?(z.scaleY=.001,p=vu(v.toPixels(I.threshold||0),S,S+v.len),N?z.translateX=(p+=A?-Math.floor(O[0]):Math.ceil(O[2]))-v.len:z.translateY=p+=A?Math.ceil(O[0]):-Math.floor(O[2]),x.clipBox&&x.setClip(),x.group.attr(z)):(u=Number(x.group.attr(j)),x.group.animate({scaleY:1},Wm(uh(x.options.animation),{step:function(q,K){x.group&&(z[j]=u+K.pos*(S-u),x.group.attr(z))}})))}init(o,u){super.init.apply(this,arguments);let p=this;(o=p.chart).hasRendered&&o.series.forEach(function(x){x.type===p.type&&(x.isDirty=!0)})}getColumnMetrics(){var se,re;let o=this,u=o.options,p=o.xAxis,x=o.yAxis,v=p.options.reversedStacks,S=p.reversed&&!v||!p.reversed&&v,A={},I,O=0;u.grouping===!1?O=1:o.chart.series.forEach(function(te){let ce,fe=te.yAxis,Xe=te.options;te.type===o.type&&te.reserveSpace()&&x.len===fe.len&&x.pos===fe.pos&&(Xe.stacking&&Xe.stacking!=="group"?(A[I=te.stackKey]===void 0&&(A[I]=O++),ce=A[I]):Xe.grouping!==!1&&(ce=O++),te.columnIndex=ce)});let N=Math.min(Math.abs(p.transA)*(!((se=p.brokenAxis)!=null&&se.hasBreaks)&&((re=p.ordinal)==null?void 0:re.slope)||u.pointRange||p.closestPointRange||p.tickInterval||1),p.len),z=N*u.groupPadding,j=(N-2*z)/(O||1),q=Math.min(u.maxPointWidth||p.len,bu(u.pointWidth,j*(1-2*u.pointPadding))),K=(o.columnIndex||0)+ +!!S;return o.columnMetrics={width:q,offset:(j-q)/2+(z+K*j-N/2)*(S?-1:1),paddedWidth:j,columnCount:O},o.columnMetrics}crispCol(o,u,p,x){let v=this.borderWidth,S=this.chart.inverted;return x=Jd(u+x,v,S)-(u=Jd(u,v,S)),this.options.crisp&&(p=Jd(o+p,v)-(o=Jd(o,v))),{x:o,y:u,width:p,height:x}}adjustForMissingColumns(o,u,p,x){var v;if(!p.isNull&&x.columnCount>1){let S=this.xAxis.series.filter(N=>N.visible).map(N=>N.index),A=0,I=0;N_((v=this.xAxis.stacking)==null?void 0:v.stacks,N=>{var K;let z=typeof p.x=="number"?(K=N[p.x.toString()])==null?void 0:K.points:void 0,j=z==null?void 0:z[this.index],q={};if(z&&wp(j)){let se=this.index,re=Object.keys(z).filter(te=>!te.match(",")&&z[te]&&z[te].length>1).map(parseFloat).filter(te=>S.indexOf(te)!==-1).filter(te=>{let ce=this.chart.series[te].options,fe=ce.stacking&&ce.stack;if(B_(fe)){if(Tp(q[fe]))return se===te&&(se=q[fe]),!1;q[fe]=te}return!0}).sort((te,ce)=>ce-te);A=re.indexOf(se),I=re.length}}),A=this.xAxis.reversed?I-1-A:A;let O=(I-1)*x.paddedWidth+u;o=(p.plotX||0)+O/2-u-A*x.paddedWidth}return o}translate(){let o=this,u=o.chart,p=o.options,x=o.dense=o.closestPointRange*o.xAxis.transA<2,v=o.borderWidth=bu(p.borderWidth,+!x),S=o.xAxis,A=o.yAxis,I=p.threshold,O=bu(p.minPointLength,5),N=o.getColumnMetrics(),z=N.width,j=o.pointXOffset=N.offset,q=o.dataMin,K=o.dataMax,se=o.translatedThreshold=A.getThreshold(I),re=o.barW=Math.max(z,1+2*v);p.pointPadding&&p.crisp&&(re=Math.ceil(re)),_s.prototype.translate.apply(o),o.points.forEach(function(te){let ce=bu(te.yBottom,se),fe=999+Math.abs(ce),Xe=te.plotX||0,Ue=vu(te.plotY,-fe,A.len+fe),$e,pt=Math.min(Ue,ce),tt=Math.max(Ue,ce)-pt,mt=z,Bt=Xe+j,Yt=re;O&&Math.abs(tt)<O&&(tt=O,$e=!A.reversed&&!te.negative||A.reversed&&te.negative,Tp(I)&&Tp(K)&&te.y===I&&K<=I&&(A.min||0)<I&&(q!==K||(A.max||0)<=I)&&($e=!$e,te.negative=!te.negative),pt=Math.abs(pt-se)>O?ce-O:se-($e?O:0)),B_(te.options.pointWidth)&&(Bt-=Math.round(((mt=Yt=Math.ceil(te.options.pointWidth))-z)/2)),p.centerInCategory&&(Bt=o.adjustForMissingColumns(Bt,mt,te,N)),te.barX=Bt,te.pointWidth=mt,te.tooltipPos=u.inverted?[vu(A.len+A.pos-u.plotLeft-Ue,A.pos-u.plotLeft,A.len+A.pos-u.plotLeft),S.len+S.pos-u.plotTop-Bt-Yt/2,tt]:[S.left-u.plotLeft+Bt+Yt/2,vu(Ue+A.pos-u.plotTop,A.pos-u.plotTop,A.len+A.pos-u.plotTop),tt],te.shapeType=o.pointClass.prototype.shapeType||"roundedRect",te.shapeArgs=o.crispCol(Bt,pt,Yt,te.isNull?0:tt)}),F_(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(o,u){let p=this.options,x=this.pointAttrToOptions||{},v=x.stroke||"borderColor",S=x["stroke-width"]||"borderWidth",A,I,O,N=o&&o.color||this.color,z=o&&o[v]||p[v]||N,j=o&&o.options.dashStyle||p.dashStyle,q=o&&o[S]||p[S]||this[S]||0,K=o!=null&&o.isNull&&p.nullInteraction?0:(o==null?void 0:o.opacity)??p.opacity??1;o&&this.zones.length&&(I=o.getZone(),N=o.options.color||I&&(I.color||o.nonZonedColor)||this.color,I&&(z=I.borderColor||z,j=I.dashStyle||j,q=I.borderWidth||q)),u&&o&&(O=(A=Qd(p.states[u],o.options.states&&o.options.states[u]||{})).brightness,N=A.color||O!==void 0&&vp(N).brighten(A.brightness).get()||N,z=A[v]||z,q=A[S]||q,j=A.dashStyle||j,K=bu(A.opacity,K));let se={fill:N,stroke:z,"stroke-width":q,opacity:K};return j&&(se.dashstyle=j),se}drawPoints(o=this.points){let u,p=this,x=this.chart,v=p.options,S=v.nullInteraction,A=x.renderer,I=v.animationLimit||250;o.forEach(function(O){let N=O.plotY,z=O.graphic,j=!!z,q=z&&x.pointCount<I?"animate":"attr";Tp(N)&&(O.y!==null||S)?(u=O.shapeArgs,z&&O.hasNewShapeType()&&(z=z.destroy()),p.enabledDataSorting&&(O.startXPos=p.xAxis.reversed?-(u&&u.width||0):p.xAxis.width),!z&&(O.graphic=z=A[O.shapeType](u).add(O.group||p.group),z&&p.enabledDataSorting&&x.hasRendered&&x.pointCount<I&&(z.attr({x:O.startXPos}),j=!0,q="animate")),z&&j&&z[q](Qd(u)),x.styledMode||z[q](p.pointAttribs(O,O.selected&&"select")).shadow(O.allowShadow!==!1&&v.shadow),z&&(z.addClass(O.getClassName(),!0),z.attr({visibility:O.visible?"inherit":"hidden"}))):z&&(O.graphic=z.destroy())})}drawTracker(o=this.points){let u,p=this,x=p.chart,v=x.pointer,S=function(A){v==null||v.normalize(A);let I=v==null?void 0:v.getPointFromEvent(A);v&&I&&p.options.enableMouseTracking&&(x.isInsidePlot(A.chartX-x.plotLeft,A.chartY-x.plotTop,{visiblePlotOnly:!0})||v!=null&&v.inClass(A.target,"highcharts-data-label"))&&(v.isDirectTouch=!0,I.onMouseOver(A))};o.forEach(function(A){u=wp(A.dataLabels)?A.dataLabels:A.dataLabel?[A.dataLabel]:[],A.graphic&&(A.graphic.element.point=A),u.forEach(function(I){(I.div||I.element).point=A})}),p._hasTracking||(p.trackerGroups.forEach(function(A){p[A]&&(p[A].addClass("highcharts-tracker").on("mouseover",S).on("mouseout",function(I){v==null||v.onTrackerMouseOut(I)}).on("touchstart",S),!x.styledMode&&p.options.cursor&&p[A].css({cursor:p.options.cursor}))}),p._hasTracking=!0),F_(this,"afterDrawTracker")}remove(){let o=this,u=o.chart;u.hasRendered&&u.series.forEach(function(p){p.type===o.type&&(p.isDirty=!0)}),_s.prototype.remove.apply(o,arguments)}}Ja.defaultOptions=Qd(_s.defaultOptions,{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}),Wm(Ja.prototype,{directTouch:!0,getSymbol:bp,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),kr.registerSeriesType("column",Ja);let ef=Ja,{getDeferredAnimation:nv}=En,{format:wu}=ds,{defined:Qa,extend:Hm,fireEvent:Ep,getAlignFactor:U_,isArray:vc,isString:Tu,merge:tf,objectEach:V_,pick:rf,pInt:sv,splat:qm}=xe;(function(R){function o(){return I(this).some(N=>N==null?void 0:N.enabled)}function u(N,z,j,q,K){var Bt;let{chart:se,enabledDataSorting:re}=this,te=this.isCartesian&&se.inverted,ce=N.plotX,fe=N.plotY,Xe=j.rotation||0,Ue=Qa(ce)&&Qa(fe)&&se.isInsidePlot(ce,Math.round(fe),{inverted:te,paneCoordinates:!0,series:this}),$e=Xe===0&&rf(j.overflow,re?"none":"justify")==="justify",pt=this.visible&&N.visible!==!1&&Qa(ce)&&(N.series.forceDL||re&&!$e||Ue||rf(j.inside,!!this.options.stacking)&&q&&se.isInsidePlot(ce,te?q.x+1:q.y+q.height-1,{inverted:te,paneCoordinates:!0,series:this})),tt=N.pos();if(pt&&tt){var mt;let Yt=z.getBBox(),ei=z.getBBox(void 0,0);if(q=Hm({x:tt[0],y:Math.round(tt[1]),width:0,height:0},q||{}),j.alignTo==="plotEdges"&&this.isCartesian&&(q[te?"x":"y"]=0,q[te?"width":"height"]=((Bt=this.yAxis)==null?void 0:Bt.len)||0),Hm(j,{width:Yt.width,height:Yt.height}),mt=q,re&&this.xAxis&&!$e&&this.setDataLabelStartPos(N,z,K,Ue,mt),z.align(tf(j,{width:ei.width,height:ei.height}),!1,q,!1),z.alignAttr.x+=U_(j.align)*(ei.width-Yt.width),z.alignAttr.y+=U_(j.verticalAlign)*(ei.height-Yt.height),z[z.placed?"animate":"attr"]({"text-align":z.alignAttr["text-align"]||"center",x:z.alignAttr.x+(Yt.width-ei.width)/2,y:z.alignAttr.y+(Yt.height-ei.height)/2,rotationOriginX:(z.width||0)/2,rotationOriginY:(z.height||0)/2}),$e&&q.height>=0)this.justifyDataLabel(z,j,z.alignAttr,Yt,q,K);else if(rf(j.crop,!0)){let{x:Ft,y:ci}=z.alignAttr;pt=se.isInsidePlot(Ft,ci,{paneCoordinates:!0,series:this})&&se.isInsidePlot(Ft+Yt.width-1,ci+Yt.height-1,{paneCoordinates:!0,series:this})}j.shape&&!Xe&&z[K?"attr":"animate"]({anchorX:tt[0],anchorY:tt[1]})}K&&re&&(z.placed=!1),pt||re&&!$e?(z.show(),z.placed=!0):(z.hide(),z.placed=!1)}function p(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function x(N){let z=this.hasRendered||0,j=this.initDataLabelsGroup().attr({opacity:+z});return!z&&j&&(this.visible&&j.show(),this.options.animation?j.animate({opacity:1},N):j.attr({opacity:1})),j}function v(N){var pt;let z;N=N||this.points;let j=this,q=j.chart,K=j.options,se=q.renderer,{backgroundColor:re,plotBackgroundColor:te}=q.options.chart,ce=se.getContrast(Tu(te)&&te||Tu(re)&&re||"#000000"),fe=I(j),{animation:Xe,defer:Ue}=fe[0],$e=Ue?nv(q,Xe,j):{defer:0,duration:0};Ep(this,"drawDataLabels"),(pt=j.hasDataLabels)!=null&&pt.call(j)&&(z=this.initDataLabels($e),N.forEach(tt=>{var ei,Ft,ci;let mt=tt.dataLabels||[],Bt=tt.color||j.color;qm(A(fe,tt.dlOptions||((ei=tt.options)==null?void 0:ei.dataLabels))).forEach((mi,Ni)=>{var Kr;let bi=mi.enabled&&(tt.visible||tt.dataLabelOnHidden)&&(!tt.isNull||tt.dataLabelOnNull)&&function(on,lo){let Po=lo.filter;if(Po){let ta=Po.operator,Hs=on[Po.property],Hn=Po.value;return ta===">"&&Hs>Hn||ta==="<"&&Hs<Hn||ta===">="&&Hs>=Hn||ta==="<="&&Hs<=Hn||ta==="=="&&Hs==Hn||ta==="==="&&Hs===Hn||ta==="!="&&Hs!=Hn||ta==="!=="&&Hs!==Hn||!1}return!0}(tt,mi),{backgroundColor:Vi,borderColor:gr,distance:ar,style:vr={}}=mi,Ss,_r,zr,Hi={},di=mt[Ni],Mn=!di,Br;bi&&(_r=Qa(Ss=rf(mi[tt.formatPrefix+"Format"],mi.format))?wu(Ss,tt,q):(mi[tt.formatPrefix+"Formatter"]||mi.formatter).call(tt,mi),zr=mi.rotation,!q.styledMode&&(vr.color=rf(mi.color,vr.color,Tu(j.color)?j.color:void 0,"#000000"),vr.color==="contrast"?(Vi!=="none"&&(Br=Vi),tt.contrastColor=se.getContrast(Br!=="auto"&&Tu(Br)&&Br||(Tu(Bt)?Bt:"")),vr.color=Br||!Qa(ar)&&mi.inside||0>sv(ar||0)||K.stacking?tt.contrastColor:ce):delete tt.contrastColor,K.cursor&&(vr.cursor=K.cursor)),Hi={r:mi.borderRadius||0,rotation:zr,padding:mi.padding,zIndex:1},q.styledMode||(Hi.fill=Vi==="auto"?tt.color:Vi,Hi.stroke=gr==="auto"?tt.color:gr,Hi["stroke-width"]=mi.borderWidth),V_(Hi,(on,lo)=>{on===void 0&&delete Hi[lo]})),!di||bi&&Qa(_r)&&!!(di.div||(Kr=di.text)!=null&&Kr.foreignObject)==!!mi.useHTML&&(di.rotation&&mi.rotation||di.rotation===mi.rotation)||(di=void 0,Mn=!0),bi&&Qa(_r)&&(di?Hi.text=_r:(di=se.label(_r,0,0,mi.shape,void 0,void 0,mi.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+tt.colorIndex+" "+(mi.className||"")+(mi.useHTML?" highcharts-tracker":"")),di&&(di.options=mi,di.attr(Hi),q.styledMode?vr.width&&di.css({width:vr.width,textOverflow:vr.textOverflow,whiteSpace:vr.whiteSpace}):di.css(vr).shadow(mi.shadow),Ep(di,"beforeAddingDataLabel",{labelOptions:mi,point:tt}),di.added||di.add(z),j.alignDataLabel(tt,di,mi,void 0,Mn),di.isActive=!0,mt[Ni]&&mt[Ni]!==di&&mt[Ni].destroy(),mt[Ni]=di))});let Yt=mt.length;for(;Yt--;)(Ft=mt[Yt])!=null&&Ft.isActive?mt[Yt].isActive=!1:((ci=mt[Yt])==null||ci.destroy(),mt.splice(Yt,1));tt.dataLabel=mt[0],tt.dataLabels=mt})),Ep(this,"afterDrawDataLabels")}function S(N,z,j,q,K,se){let re=this.chart,te=z.align,ce=z.verticalAlign,fe=N.box?0:N.padding||0,Xe=re.inverted?this.yAxis:this.xAxis,Ue=Xe?Xe.left-re.plotLeft:0,$e=re.inverted?this.xAxis:this.yAxis,pt=$e?$e.top-re.plotTop:0,{x:tt=0,y:mt=0}=z,Bt,Yt;return(Bt=(j.x||0)+fe+Ue)<0&&(te==="right"&&tt>=0?(z.align="left",z.inside=!0):tt-=Bt,Yt=!0),(Bt=(j.x||0)+q.width-fe+Ue)>re.plotWidth&&(te==="left"&&tt<=0?(z.align="right",z.inside=!0):tt+=re.plotWidth-Bt,Yt=!0),(Bt=j.y+fe+pt)<0&&(ce==="bottom"&&mt>=0?(z.verticalAlign="top",z.inside=!0):mt-=Bt,Yt=!0),(Bt=(j.y||0)+q.height-fe+pt)>re.plotHeight&&(ce==="top"&&mt<=0?(z.verticalAlign="bottom",z.inside=!0):mt+=re.plotHeight-Bt,Yt=!0),Yt&&(z.x=tt,z.y=mt,N.placed=!se,N.align(z,void 0,K)),Yt}function A(N,z){let j=[],q;if(vc(N)&&!vc(z))j=N.map(function(K){return tf(K,z)});else if(vc(z)&&!vc(N))j=z.map(function(K){return tf(N,K)});else if(vc(N)||vc(z)){if(vc(N)&&vc(z))for(q=Math.max(N.length,z.length);q--;)j[q]=tf(N[q],z[q])}else j=tf(N,z);return j}function I(N){var j,q;let z=N.chart.options.plotOptions;return qm(A(A((j=z==null?void 0:z.series)==null?void 0:j.dataLabels,(q=z==null?void 0:z[N.type])==null?void 0:q.dataLabels),N.options.dataLabels))}function O(N,z,j,q,K){let se=this.chart,re=se.inverted,te=this.xAxis,ce=te.reversed,fe=((re?z.height:z.width)||0)/2,Xe=N.pointWidth,Ue=Xe?Xe/2:0;z.startXPos=re?K.x:ce?-fe-Ue:te.width-fe+Ue,z.startYPos=re?ce?this.yAxis.height-fe+Ue:-fe-Ue:K.y,q?z.visibility==="hidden"&&(z.show(),z.attr({opacity:0}).animate({opacity:1})):z.attr({opacity:1}).animate({opacity:0},void 0,z.hide),se.hasRendered&&(j&&z.attr({x:z.startXPos,y:z.startYPos}),z.placed=!0)}R.compose=function(N){let z=N.prototype;z.initDataLabels||(z.initDataLabels=x,z.initDataLabelsGroup=p,z.alignDataLabel=u,z.drawDataLabels=v,z.justifyDataLabel=S,z.mergeArrays=A,z.setDataLabelStartPos=O,z.hasDataLabels=o)}})(Ye||(Ye={}));let nf=Ye,{composed:j_}=Ie,{series:Sp}=kr,{merge:Ml,pushUnique:ao}=xe;(function(R){function o(u,p,x,v,S){var se,re;let{chart:A,options:I}=this,O=A.inverted,N=((se=this.xAxis)==null?void 0:se.len)||A.plotSizeX||0,z=((re=this.yAxis)==null?void 0:re.len)||A.plotSizeY||0,j=u.dlBox||u.shapeArgs,q=u.below??(u.plotY||0)>(this.translatedThreshold??z),K=x.inside??!!I.stacking;if(j){if(v=Ml(j),x.overflow!=="allow"||x.crop!==!1||I.clip!==!1){v.y<0&&(v.height+=v.y,v.y=0);let te=v.y+v.height-z;te>0&&te<v.height-1&&(v.height-=te)}O&&(v={x:z-v.y-v.height,y:N-v.x-v.width,width:v.height,height:v.width}),K||(O?(v.x+=q?0:v.width,v.width=0):(v.y+=q?v.height:0,v.height=0))}x.align??(x.align=!O||K?"center":q?"right":"left"),x.verticalAlign??(x.verticalAlign=O||K?"middle":q?"top":"bottom"),Sp.prototype.alignDataLabel.call(this,u,p,x,v,S),x.inside&&u.contrastColor&&p.css({color:u.contrastColor})}R.compose=function(u){nf.compose(Sp),ao(j_,"ColumnDataLabel")&&(u.prototype.alignDataLabel=o)}})(Ze||(Ze={}));let ov=Ze,{extend:Xm,merge:av}=xe;class Zm extends ef{}Zm.defaultOptions=av(ef.defaultOptions,{}),Xm(Zm.prototype,{inverted:!0}),kr.registerSeriesType("bar",Zm);let{column:lv,line:Cp}=kr.seriesTypes,{addEvent:Ap,extend:$_,merge:dh}=xe;class bc extends Cp{applyJitter(){let o=this,u=this.options.jitter,p=this.points.length;u&&this.points.forEach(function(x,v){["x","y"].forEach(function(S,A){if(u[S]&&!x.isNull){let I=`plot${S.toUpperCase()}`,O=o[`${S}Axis`],N=u[S]*O.transA;if(O&&!O.logarithmic){let z=Math.max(0,(x[I]||0)-N),j=Math.min(O.len,(x[I]||0)+N);x[I]=z+(j-z)*function(q){let K=1e4*Math.sin(q);return K-Math.floor(K)}(v+A*p),S==="x"&&(x.clientX=x.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}bc.defaultOptions=dh(Cp.defaultOptions,{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}"></span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),$_(bc.prototype,{drawTracker:lv.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),Ap(bc,"afterTranslate",function(){this.applyJitter()}),kr.registerSeriesType("scatter",bc);let{deg2rad:G_}=Ie,{fireEvent:cv,isNumber:Ym,pick:Mp,relativeLength:hv}=xe;(function(R){R.getCenter=function(){let o=this.options,u=this.chart,p=2*(o.slicedOffset||0),x=u.plotWidth-2*p,v=u.plotHeight-2*p,S=o.center,A=Math.min(x,v),I=o.thickness,O,N=o.size,z=o.innerSize||0,j,q;typeof N=="string"&&(N=parseFloat(N)),typeof z=="string"&&(z=parseFloat(z));let K=[Mp(S==null?void 0:S[0],"50%"),Mp(S==null?void 0:S[1],"50%"),Mp(N&&N<0?void 0:o.size,"100%"),Mp(z&&z<0?void 0:o.innerSize||0,"0%")];for(!u.angular||this instanceof _s||(K[3]=0),j=0;j<4;++j)q=K[j],O=j<2||j===2&&/%$/.test(q),K[j]=hv(q,[x,v,A,K[2]][j])+(O?p:0);return K[3]>K[2]&&(K[3]=K[2]),Ym(I)&&2*I<K[2]&&I>0&&(K[3]=K[2]-2*I),cv(this,"afterGetCenter",{positions:K}),K},R.getStartAndEndRadians=function(o,u){let p=Ym(o)?o:0,x=Ym(u)&&u>p&&u-p<360?u:p+360;return{start:G_*(p+-90),end:G_*(x+-90)}}})(Fe||(Fe={}));let W_=Fe,{setAnimation:uv}=En,{addEvent:Ip,defined:dv,extend:Eu,isNumber:fv,pick:Nn,relativeLength:kp}=xe;class Km extends ee{getConnectorPath(o){let u=o.dataLabelPosition,p=o.options||{},x=p.connectorShape,v=this.connectorShapes[x]||x;return u&&v.call(this,{...u.computed,alignment:u.alignment},u.connectorPosition,p)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(o){let u=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(u.x,u.y,u.r+o,u.r+o,{innerR:u.r-1,start:u.start,end:u.end,borderRadius:u.borderRadius})}constructor(o,u,p){super(o,u,p),this.half=0,this.name??(this.name=o.chart.options.lang.pieSliceName);let x=v=>{this.slice(v.type==="select")};Ip(this,"select",x),Ip(this,"unselect",x)}isValid(){return fv(this.y)&&this.y>=0}setVisible(o,u=!0){o!==this.visible&&this.update({visible:o??!this.visible},u,void 0,!1)}slice(o,u,p){let x=this.series;uv(p,x.chart),u=Nn(u,!0),this.sliced=this.options.sliced=o=dv(o)?o:!this.sliced,x.options.data[x.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}Eu(Km.prototype,{connectorShapes:{fixedOffset:function(R,o,u){let p=o.breakAt,x=o.touchingSliceAt,v=u.softConnector?["C",R.x+(R.alignment==="left"?-5:5),R.y,2*p.x-x.x,2*p.y-x.y,p.x,p.y]:["L",p.x,p.y];return[["M",R.x,R.y],v,["L",x.x,x.y]]},straight:function(R,o){let u=o.touchingSliceAt;return[["M",R.x,R.y],["L",u.x,u.y]]},crookedLine:function(R,o,u){let{angle:p=this.angle||0,breakAt:x,touchingSliceAt:v}=o,{series:S}=this,[A,I,O]=S.center,N=O/2,{plotLeft:z,plotWidth:j}=S.chart,q=R.alignment==="left",{x:K,y:se}=R,re=x.x;if(u.crookDistance){let ce=kp(u.crookDistance,1);re=q?A+N+(j+z-A-N)*(1-ce):z+(A-N)*ce}else re=A+(I-se)*Math.tan(p-Math.PI/2);let te=[["M",K,se]];return(q?re<=K&&re>=x.x:re>=K&&re<=x.x)&&te.push(["L",re,se]),te.push(["L",x.x,x.y],["L",v.x,v.y]),te}}});let{getStartAndEndRadians:Pp}=W_,{noop:sf}=Ie,{clamp:of,extend:H_,fireEvent:Jm,merge:fh,pick:Qm}=xe;class af extends _s{animate(o){let u=this,p=u.points,x=u.startAngleRad;o||p.forEach(function(v){let S=v.graphic,A=v.shapeArgs;S&&A&&(S.attr({r:Qm(v.startR,u.center&&u.center[3]/2),start:x,end:x}),S.animate({r:A.r,start:A.start,end:A.end},u.options.animation))})}drawEmpty(){let o,u,p=this.startAngleRad,x=this.endAngleRad,v=this.options;this.total===0&&this.center?(o=this.center[0],u=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(o,u,this.center[1]/2,0,p,x).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:$h.arc(o,u,this.center[2]/2,0,{start:p,end:x,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":v.borderWidth,fill:v.fillColor||"none",stroke:v.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let o=this.chart.renderer;this.points.forEach(function(u){u.graphic&&u.hasNewShapeType()&&(u.graphic=u.graphic.destroy()),u.graphic||(u.graphic=o[u.shapeType](u.shapeArgs).add(u.series.group),u.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(o,u,p,x){let v=this.center,S=this.radii?this.radii[p.index]||0:v[2]/2,A=x.dataLabelPosition,I=(A==null?void 0:A.distance)||0,O=Math.asin(of((o-v[1])/(S+I),-1,1));return v[0]+Math.cos(O)*(S+I)*(u?-1:1)+(I>0?(u?-1:1)*(x.padding||0):0)}hasData(){return!!this.dataTable.rowCount}redrawPoints(){let o,u,p,x,v=this,S=v.chart;this.drawEmpty(),v.group&&!S.styledMode&&v.group.shadow(v.options.shadow),v.points.forEach(function(A){let I={};u=A.graphic,!A.isNull&&u?(x=A.shapeArgs,o=A.getTranslate(),S.styledMode||(p=v.pointAttribs(A,A.selected&&"select")),A.delayedRendering?(u.setRadialReference(v.center).attr(x).attr(o),S.styledMode||u.attr(p).attr({"stroke-linejoin":"round"}),A.delayedRendering=!1):(u.setRadialReference(v.center),S.styledMode||fh(!0,I,p),fh(!0,I,x,o),u.animate(I)),u.attr({visibility:A.visible?"inherit":"hidden"}),u.addClass(A.getClassName(),!0)):u&&(A.graphic=u.destroy())})}sortByAngle(o,u){o.sort(function(p,x){return p.angle!==void 0&&(x.angle-p.angle)*u})}translate(o){Jm(this,"translate"),this.generatePoints();let u=this.options,p=u.slicedOffset,x=Pp(u.startAngle,u.endAngle),v=this.startAngleRad=x.start,S=(this.endAngleRad=x.end)-v,A=this.points,I=u.ignoreHiddenPoint,O=A.length,N,z,j,q,K,se,re,te=0;for(o||(this.center=o=this.getCenter()),se=0;se<O;se++){re=A[se],N=v+te*S,re.isValid()&&(!I||re.visible)&&(te+=re.percentage/100),z=v+te*S;let ce={x:o[0],y:o[1],r:o[2]/2,innerR:o[3]/2,start:Math.round(1e3*N)/1e3,end:Math.round(1e3*z)/1e3};re.shapeType="arc",re.shapeArgs=ce,(j=(z+N)/2)>1.5*Math.PI?j-=2*Math.PI:j<-Math.PI/2&&(j+=2*Math.PI),re.slicedTranslation={translateX:Math.round(Math.cos(j)*p),translateY:Math.round(Math.sin(j)*p)},q=Math.cos(j)*o[2]/2,K=Math.sin(j)*o[2]/2,re.tooltipPos=[o[0]+.7*q,o[1]+.7*K],re.half=+(j<-Math.PI/2||j>Math.PI/2),re.angle=j}Jm(this,"afterTranslate")}updateTotals(){let o=this.points,u=o.length,p=this.options.ignoreHiddenPoint,x,v,S=0;for(x=0;x<u;x++)(v=o[x]).isValid()&&(!p||v.visible)&&(S+=v.y);for(x=0,this.total=S;x<u;x++)(v=o[x]).percentage=S>0&&(v.visible||!p)?v.y/S*100:0,v.total=S}}af.defaultOptions=fh(_s.defaultOptions,{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.isNull?void 0:this.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}),H_(af.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:ef.prototype.drawTracker,getCenter:W_.getCenter,getSymbol:sf,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:ef.prototype.pointAttribs,pointClass:Km,requireSorting:!1,searchPoint:sf,trackerGroups:["group","dataLabelsGroup"]}),kr.registerSeriesType("pie",af);let{composed:eg,noop:pv}=Ie,{distribute:q_}=Na,{series:Su}=kr,{arrayMax:mv,clamp:Lp,defined:X_,pick:tg,pushUnique:ig,relativeLength:lf}=xe;(function(R){let o={radialDistributionY:function(S,A){var I;return(((I=A.dataLabelPosition)==null?void 0:I.top)||0)+S.distributeBox.pos},radialDistributionX:function(S,A,I,O,N){let z=N.dataLabelPosition;return S.getX(I<((z==null?void 0:z.top)||0)+2||I>((z==null?void 0:z.bottom)||0)-2?O:I,A.half,A,N)},justify:function(S,A,I,O){var N;return O[0]+(S.half?-1:1)*(I+(((N=A.dataLabelPosition)==null?void 0:N.distance)||0))},alignToPlotEdges:function(S,A,I,O){let N=S.getBBox().width;return A?N+O:I-N-O},alignToConnectors:function(S,A,I,O){let N=0,z;return S.forEach(function(j){(z=j.dataLabel.getBBox().width)>N&&(N=z)}),A?N+O:I-N-O}};function u(S,A){let I=Math.PI/2,{start:O=0,end:N=0}=S.shapeArgs||{},z=S.angle||0;A>0&&O<I&&N>I&&z>I/2&&z<1.5*I&&(z=z<=I?Math.max(I/2,(O+I)/2):Math.min(1.5*I,(I+N)/2));let{center:j,options:q}=this,K=j[2]/2,se=Math.cos(z),re=Math.sin(z),te=j[0]+se*K,ce=j[1]+re*K,fe=Math.min((q.slicedOffset||0)+(q.borderWidth||0),A/5);return{natural:{x:te+se*A,y:ce+re*A},computed:{},alignment:A<0?"center":S.half?"right":"left",connectorPosition:{angle:z,breakAt:{x:te+se*fe,y:ce+re*fe},touchingSliceAt:{x:te,y:ce}},distance:A}}function p(){var pt;let S=this,A=S.points,I=S.chart,O=I.plotWidth,N=I.plotHeight,z=I.plotLeft,j=Math.round(I.chartWidth/3),q=S.center,K=q[2]/2,se=q[1],re=[[],[]],te=[0,0,0,0],ce=S.dataLabelPositioners,fe,Xe,Ue,$e=0;S.visible&&((pt=S.hasDataLabels)!=null&&pt.call(S))&&(A.forEach(tt=>{(tt.dataLabels||[]).forEach(mt=>{mt.shortened&&(mt.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),mt.shortened=!1)})}),Su.prototype.drawDataLabels.apply(S),A.forEach(tt=>{(tt.dataLabels||[]).forEach((mt,Bt)=>{var ci;let Yt=q[2]/2,ei=mt.options,Ft=lf((ei==null?void 0:ei.distance)||0,Yt);Bt===0&&re[tt.half].push(tt),!X_((ci=ei==null?void 0:ei.style)==null?void 0:ci.width)&&mt.getBBox().width>j&&(mt.css({width:Math.round(.7*j)+"px"}),mt.shortened=!0),mt.dataLabelPosition=this.getDataLabelPosition(tt,Ft),$e=Math.max($e,Ft)})}),re.forEach((tt,mt)=>{let Bt=tt.length,Yt=[],ei,Ft,ci=0,mi;Bt&&(S.sortByAngle(tt,mt-.5),$e>0&&(ei=Math.max(0,se-K-$e),Ft=Math.min(se+K+$e,I.plotHeight),tt.forEach(Ni=>{(Ni.dataLabels||[]).forEach(bi=>{var gr;let Vi=bi.dataLabelPosition;Vi&&Vi.distance>0&&(Vi.top=Math.max(0,se-K-Vi.distance),Vi.bottom=Math.min(se+K+Vi.distance,I.plotHeight),ci=bi.getBBox().height||21,bi.lineHeight=I.renderer.fontMetrics(bi.text||bi).h+2*bi.padding,Ni.distributeBox={target:(((gr=bi.dataLabelPosition)==null?void 0:gr.natural.y)||0)-Vi.top+bi.lineHeight/2,size:ci,rank:Ni.y},Yt.push(Ni.distributeBox))})}),q_(Yt,mi=Ft+ci-ei,mi/5)),tt.forEach(Ni=>{(Ni.dataLabels||[]).forEach(bi=>{let Vi=bi.options||{},gr=Ni.distributeBox,ar=bi.dataLabelPosition,vr=(ar==null?void 0:ar.natural.y)||0,Ss=Vi.connectorPadding||0,_r=bi.lineHeight||21,zr=(_r-bi.getBBox().height)/2,Hi=0,di=vr,Mn="inherit";if(ar){if(Yt&&X_(gr)&&ar.distance>0&&(gr.pos===void 0?Mn="hidden":(Ue=gr.size,di=ce.radialDistributionY(Ni,bi))),Vi.justify)Hi=ce.justify(Ni,bi,K,q);else switch(Vi.alignTo){case"connectors":Hi=ce.alignToConnectors(tt,mt,O,z);break;case"plotEdges":Hi=ce.alignToPlotEdges(bi,mt,O,z);break;default:Hi=ce.radialDistributionX(S,Ni,di-zr,vr,bi)}if(ar.attribs={visibility:Mn,align:ar.alignment},ar.posAttribs={x:Hi+(Vi.x||0)+({left:Ss,right:-Ss}[ar.alignment]||0),y:di+(Vi.y||0)-_r/2},ar.computed.x=Hi,ar.computed.y=di-zr,tg(Vi.crop,!0)){let Br;Hi-(Xe=bi.getBBox().width)<Ss&&mt===1?(Br=Math.round(Xe-Hi+Ss),te[3]=Math.max(Br,te[3])):Hi+Xe>O-Ss&&mt===0&&(Br=Math.round(Hi+Xe-O+Ss),te[1]=Math.max(Br,te[1])),di-Ue/2<0?te[0]=Math.max(Math.round(-di+Ue/2),te[0]):di+Ue/2>N&&(te[2]=Math.max(Math.round(di+Ue/2-N),te[2])),ar.sideOverflow=Br}}})}))}),(mv(te)===0||this.verifyDataLabelOverflow(te))&&(this.placeDataLabels(),this.points.forEach(tt=>{(tt.dataLabels||[]).forEach(mt=>{var Ft;let{connectorColor:Bt,connectorWidth:Yt=1}=mt.options||{},ei=mt.dataLabelPosition;if(Yt){let ci;fe=mt.connector,ei&&ei.distance>0?(ci=!fe,fe||(mt.connector=fe=I.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+tt.colorIndex+(tt.className?" "+tt.className:"")).add(S.dataLabelsGroup)),I.styledMode||fe.attr({"stroke-width":Yt,stroke:Bt||tt.color||"#666666"}),fe[ci?"attr":"animate"]({d:tt.getConnectorPath(mt)}),fe.attr({visibility:(Ft=ei.attribs)==null?void 0:Ft.visibility})):fe&&(mt.connector=fe.destroy())}})})))}function x(){this.points.forEach(S=>{(S.dataLabels||[]).forEach(A=>{var O,N;let I=A.dataLabelPosition;I?(I.sideOverflow&&(A.css({width:Math.max(A.getBBox().width-I.sideOverflow,0)+"px",textOverflow:((N=(O=A.options)==null?void 0:O.style)==null?void 0:N.textOverflow)||"ellipsis"}),A.shortened=!0),A.attr(I.attribs),A[A.moved?"animate":"attr"](I.posAttribs),A.moved=!0):A&&A.attr({y:-9999})}),delete S.distributeBox},this)}function v(S){let A=this.center,I=this.options,O=I.center,N=I.minSize||80,z=N,j=I.size!==null;return!j&&(O[0]!==null?z=Math.max(A[2]-Math.max(S[1],S[3]),N):(z=Math.max(A[2]-S[1]-S[3],N),A[0]+=(S[3]-S[1])/2),O[1]!==null?z=Lp(z,N,A[2]-Math.max(S[0],S[2])):(z=Lp(z,N,A[2]-S[0]-S[2]),A[1]+=(S[0]-S[2])/2),z<A[2]?(A[2]=z,A[3]=Math.min(I.thickness?Math.max(0,z-2*I.thickness):Math.max(0,lf(I.innerSize||0,z)),z),this.translate(A),this.drawDataLabels&&this.drawDataLabels()):j=!0),j}R.compose=function(S){if(nf.compose(Su),ig(eg,"PieDataLabel")){let A=S.prototype;A.dataLabelPositioners=o,A.alignDataLabel=pv,A.drawDataLabels=p,A.getDataLabelPosition=u,A.placeDataLabels=x,A.verifyDataLabelOverflow=v}}})(ae||(ae={}));let gv=ae;(function(R){R.getCenterOfPoints=function(o){let u=o.reduce((p,x)=>(p.x+=x.x,p.y+=x.y,p),{x:0,y:0});return{x:u.x/o.length,y:u.y/o.length}},R.getDistanceBetweenPoints=function(o,u){return Math.sqrt(Math.pow(u.x-o.x,2)+Math.pow(u.y-o.y,2))},R.getAngleBetweenPoints=function(o,u){return Math.atan2(u.x-o.x,u.y-o.y)},R.pointInPolygon=function({x:o,y:u},p){let x=p.length,v,S,A=!1;for(v=0,S=x-1;v<x;S=v++){let[I,O]=p[v],[N,z]=p[S];O>u!=z>u&&o<(N-I)*(u-O)/(z-O)+I&&(A=!A)}return A}})(ge||(ge={}));let{pointInPolygon:_v}=ge,{addEvent:yv,getAlignFactor:xv,fireEvent:Z_,objectEach:Y_,pick:Dp}=xe;function vv(R){let o=R.length,u=(N,z)=>!(z.x>=N.x+N.width||z.x+z.width<=N.x||z.y>=N.y+N.height||z.y+z.height<=N.y),p=(N,z)=>{for(let j of N)if(_v({x:j[0],y:j[1]},z))return!0;return!1},x,v,S,A,I,O=!1;for(let N=0;N<o;N++)(x=R[N])&&(x.oldOpacity=x.opacity,x.newOpacity=1,x.absoluteBox=function(z){var j,q;if(z&&(!z.alignAttr||z.placed)){let K=z.box?0:z.padding||0,se=z.alignAttr||{x:z.attr("x"),y:z.attr("y")},{height:re,polygon:te,width:ce}=z.getBBox(),fe=xv(z.alignValue)*ce;return z.width=ce,z.height=re,{x:se.x+(((j=z.parentGroup)==null?void 0:j.translateX)||0)+K-fe,y:se.y+(((q=z.parentGroup)==null?void 0:q.translateY)||0)+K,width:ce-2*K,height:re-2*K,polygon:te}}}(x));R.sort((N,z)=>(z.labelrank||0)-(N.labelrank||0));for(let N=0;N<o;++N){A=(v=R[N])&&v.absoluteBox;let z=A==null?void 0:A.polygon;for(let j=N+1;j<o;++j){I=(S=R[j])&&S.absoluteBox;let q=!1;if(A&&I&&v!==S&&v.newOpacity!==0&&S.newOpacity!==0&&v.visibility!=="hidden"&&S.visibility!=="hidden"){let K=I.polygon;if(z&&K&&z!==K?p(z,K)&&(q=!0):u(A,I)&&(q=!0),q){let se=v.labelrank<S.labelrank?v:S,re=se.text;se.newOpacity=0,re!=null&&re.element.querySelector("textPath")&&re.hide()}}}}for(let N of R)rg(N,this)&&(O=!0);O&&Z_(this,"afterHideAllOverlappingLabels")}function rg(R,o){let u,p=!1;return R&&(u=R.newOpacity,R.oldOpacity!==u&&(R.hasClass("highcharts-data-label")?(R[u?"removeClass":"addClass"]("highcharts-data-label-hidden"),p=!0,R[R.isOld?"animate":"attr"]({opacity:u},void 0,function(){o.styledMode||R.css({pointerEvents:u?"auto":"none"})}),Z_(o,"afterHideOverlappingLabel")):R.attr({opacity:u})),R.isOld=!0),p}function Cu(){var u;let R=this,o=[];for(let p of R.labelCollectors||[])o=o.concat(p());for(let p of R.yAxis||[])p.stacking&&p.options.stackLabels&&!p.options.stackLabels.allowOverlap&&Y_(p.stacking.stacks,x=>{Y_(x,v=>{v.label&&o.push(v.label)})});for(let p of R.series||[])if(p.visible&&((u=p.hasDataLabels)!=null&&u.call(p))){let x=v=>{for(let S of v)S.visible&&(S.dataLabels||[]).forEach(A=>{var O;let I=A.options||{};A.labelrank=Dp(I.labelrank,S.labelrank,(O=S.shapeArgs)==null?void 0:O.height),I.allowOverlap??Number(I.distance)>0?(A.oldOpacity=A.opacity,A.newOpacity=1,rg(A,R)):o.push(A)})};x(p.nodes||[]),x(p.points)}this.hideOverlappingLabels(o)}let K_={compose:function(R){let o=R.prototype;o.hideOverlappingLabels||(o.hideOverlappingLabels=vv,yv(R,"render",Cu))}},{defaultOptions:bv}=Le,{noop:J_}=Ie,{addEvent:ng,extend:Q_,isObject:ey,merge:wv,relativeLength:sg}=xe,og={radius:0,scope:"stack",where:void 0},cf=J_,hf=J_;function Tv(R,o,u,p,x={}){let v=cf(R,o,u,p,x),{innerR:S=0,r:A=u,start:I=0,end:O=0}=x;if(x.open||!x.borderRadius)return v;let N=O-I,z=Math.sin(N/2),j=Math.max(Math.min(sg(x.borderRadius||0,A-S),(A-S)/2,A*z/(1+z)),0),q=Math.min(j,N/Math.PI*2*S),K=v.length-1;for(;K--;)(function(se,re,te){let ce,fe,Xe,Ue=se[re],$e=se[re+1];if($e[0]==="Z"&&($e=se[0]),(Ue[0]==="M"||Ue[0]==="L")&&$e[0]==="A"?(ce=Ue,fe=$e,Xe=!0):Ue[0]==="A"&&($e[0]==="M"||$e[0]==="L")&&(ce=$e,fe=Ue),ce&&fe&&fe.params){let pt=fe[1],tt=fe[5],mt=fe.params,{start:Bt,end:Yt,cx:ei,cy:Ft}=mt,ci=tt?pt-te:pt+te,mi=ci?Math.asin(te/ci):0,Ni=tt?mi:-mi,bi=Math.cos(mi)*ci;Xe?(mt.start=Bt+Ni,ce[1]=ei+bi*Math.cos(Bt),ce[2]=Ft+bi*Math.sin(Bt),se.splice(re+1,0,["A",te,te,0,0,1,ei+pt*Math.cos(mt.start),Ft+pt*Math.sin(mt.start)])):(mt.end=Yt-Ni,fe[6]=ei+pt*Math.cos(mt.end),fe[7]=Ft+pt*Math.sin(mt.end),se.splice(re+1,0,["A",te,te,0,0,1,ei+bi*Math.cos(Yt),Ft+bi*Math.sin(Yt)])),fe[4]=Math.abs(mt.end-mt.start)<Math.PI?0:1}})(v,K,K>1?q:j);return v}function Ev(){var R,o;if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:u,yAxis:p}=this,x=u.stacking==="percent",v=(o=(R=bv.plotOptions)==null?void 0:R[this.type])==null?void 0:o.borderRadius,S=ph(u.borderRadius,ey(v)?v:{}),A=p.options.reversed;for(let I of this.points){let{shapeArgs:O}=I;if(I.shapeType==="roundedRect"&&O){let{width:N=0,height:z=0,y:j=0}=O,q=j,K=z;if(S.scope==="stack"&&I.stackTotal){let ce=p.translate(x?100:I.stackTotal,!1,!0,!1,!0),fe=p.translate(u.threshold||0,!1,!0,!1,!0),Xe=this.crispCol(0,Math.min(ce,fe),0,Math.abs(ce-fe));q=Xe.y,K=Xe.height}let se=(I.negative?-1:1)*(A?-1:1)==-1,re=S.where;!re&&this.is("waterfall")&&Math.abs((I.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(re="all"),re||(re="end");let te=Math.min(sg(S.radius,N),N/2,re==="all"?z/2:1/0)||0;re==="end"&&(se&&(q-=te),K+=te),Q_(O,{brBoxHeight:K,brBoxY:q,r:te})}}}}function ph(R,o){return ey(R)||(R={radius:R||0}),wv(og,o,R)}function uf(){let R=ph(this.options.borderRadius);for(let o of this.points){let u=o.shapeArgs;u&&(u.borderRadius=sg(R.radius,(u.r||0)-(u.innerR||0)))}}function ty(R,o,u,p,x={}){let v=hf(R,o,u,p,x),{r:S=0,brBoxHeight:A=p,brBoxY:I=o}=x,O=o-I,N=I+A-(o+p),z=O-S>-.1?0:S,j=N-S>-.1?0:S,q=Math.max(z&&O,0),K=Math.max(j&&N,0),se=[R+z,o],re=[R+u-z,o],te=[R+u,o+z],ce=[R+u,o+p-j],fe=[R+u-j,o+p],Xe=[R+j,o+p],Ue=[R,o+p-j],$e=[R,o+z],pt=(tt,mt)=>Math.sqrt(Math.pow(tt,2)-Math.pow(mt,2));if(q){let tt=pt(z,z-q);se[0]-=tt,re[0]+=tt,te[1]=$e[1]=o+z-q}if(p<z-q){let tt=pt(z,z-q-p);te[0]=ce[0]=R+u-z+tt,fe[0]=Math.min(te[0],fe[0]),Xe[0]=Math.max(ce[0],Xe[0]),Ue[0]=$e[0]=R+z-tt,te[1]=$e[1]=o+p}if(K){let tt=pt(j,j-K);fe[0]+=tt,Xe[0]-=tt,ce[1]=Ue[1]=o+p-j+K}if(p<j-K){let tt=pt(j,j-K-p);te[0]=ce[0]=R+u-j+tt,re[0]=Math.min(te[0],re[0]),se[0]=Math.max(ce[0],se[0]),Ue[0]=$e[0]=R+j-tt,ce[1]=Ue[1]=o}return v.length=0,v.push(["M",...se],["L",...re],["A",z,z,0,0,1,...te],["L",...ce],["A",j,j,0,0,1,...fe],["L",...Xe],["A",j,j,0,0,1,...Ue],["L",...$e],["A",z,z,0,0,1,...se],["Z"]),v}let{diffObjects:df,extend:iy,find:Sv,merge:ry,pick:ff,uniqueKey:ny}=xe;(function(R){function o(p,x){let v=p.condition;(v.callback||function(){return this.chartWidth<=ff(v.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=ff(v.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=ff(v.minWidth,0)&&this.chartHeight>=ff(v.minHeight,0)}).call(this)&&x.push(p._id)}function u(p,x){let v=this.options.responsive,S=this.currentResponsive,A=[],I;!x&&v&&v.rules&&v.rules.forEach(z=>{z._id===void 0&&(z._id=ny()),this.matchResponsiveRule(z,A)},this);let O=ry(...A.map(z=>Sv((v==null?void 0:v.rules)||[],j=>j._id===z)).map(z=>z==null?void 0:z.chartOptions));O.isResponsiveOptions=!0,A=A.toString()||void 0;let N=S==null?void 0:S.ruleIds;A===N||(S&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(S.undoOptions,p,!0),this.updatingResponsive=!1),A?((I=df(O,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:A,mergedOptions:O,undoOptions:I},this.updatingResponsive||this.update(O,p,!0)):this.currentResponsive=void 0)}R.compose=function(p){let x=p.prototype;return x.matchResponsiveRule||iy(x,{matchResponsiveRule:o,setResponsive:u}),p}})(Oe||(Oe={}));let sy=Oe;Ie.AST=Vr,Ie.Axis=Wa,Ie.Chart=Jo,Ie.Color=st,Ie.DataLabel=nf,Ie.DataTableCore=Wi,Ie.Fx=Ri,Ie.HTMLElement=ml,Ie.Legend=cp,Ie.LegendSymbol=Dr,Ie.OverlappingDataLabels=Ie.OverlappingDataLabels||K_,Ie.PlotLineOrBand=sh,Ie.Point=ee,Ie.Pointer=Ht,Ie.RendererRegistry=xo,Ie.Series=_s,Ie.SeriesRegistry=kr,Ie.StackItem=Um,Ie.SVGElement=es,Ie.SVGRenderer=qc,Ie.Templating=ds,Ie.Tick=va,Ie.Time=hs,Ie.Tooltip=cu,Ie.animate=En.animate,Ie.animObject=En.animObject,Ie.chart=Jo.chart,Ie.color=st.parse,Ie.dateFormat=ds.dateFormat,Ie.defaultOptions=Le.defaultOptions,Ie.distribute=Na.distribute,Ie.format=ds.format,Ie.getDeferredAnimation=En.getDeferredAnimation,Ie.getOptions=Le.getOptions,Ie.numberFormat=ds.numberFormat,Ie.seriesType=kr.seriesType,Ie.setAnimation=En.setAnimation,Ie.setOptions=Le.setOptions,Ie.stop=En.stop,Ie.time=Le.defaultTime,Ie.timers=Ri.timers,{compose:function(R,o,u){let p=R.types.pie;if(!o.symbolCustomAttribs.includes("borderRadius")){let x=u.prototype.symbols;ng(R,"afterColumnTranslate",Ev,{order:9}),ng(p,"afterTranslate",uf),o.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),cf=x.arc,hf=x.roundedRect,x.arc=Tv,x.roundedRect=ty}},optionsToObject:ph}.compose(Ie.Series,Ie.SVGElement,Ie.SVGRenderer),ov.compose(Ie.Series.types.column),nf.compose(Ie.Series),Td.compose(Ie.Axis),ml.compose(Ie.SVGRenderer),cp.compose(Ie.Chart),nh.compose(Ie.Axis),K_.compose(Ie.Chart),gv.compose(Ie.Series.types.pie),sh.compose(Ie.Chart,Ie.Axis),Ht.compose(Ie.Chart),sy.compose(Ie.Chart),Fs.compose(Ie.Axis,Ie.Chart,Ie.Series),R_.compose(Ie.Axis,Ie.Chart,Ie.Series),cu.compose(Ie.Pointer),xe.extend(Ie,xe);let oy=Ie;return rt.default})())}(w0)),w0.exports}const DN=X3(LL);(function(t,l){(function(d,_){t.exports=_(LN(),DN)})(self,(d,_)=>(()=>{var T={879:s=>{s.exports=d},744:s=>{s.exports=_}},C={};function P(s){var $=C[s];if($!==void 0)return $.exports;var Z=C[s]={exports:{}};return T[s](Z,Z.exports,P),Z.exports}P.n=s=>{var $=s&&s.__esModule?()=>s.default:()=>s;return P.d($,{a:$}),$},P.d=(s,$)=>{for(var Z in $)P.o($,Z)&&!P.o(s,Z)&&Object.defineProperty(s,Z,{enumerable:!0,get:$[Z]})},P.o=(s,$)=>Object.prototype.hasOwnProperty.call(s,$),P.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var V={};return(()=>{P.r(V),P.d(V,{Chart:()=>Me,default:()=>Ye});var s=P(879),$=P.n(s),Z=function Ze(Fe,ae){var ge=$().isArray(Fe)?[]:{};function Oe(ze,rt){!$().isObject(ze,!ae)||$().isClass(ze)||$().isDOMElement(ze)?ge[rt]=ze:ge[rt]=Ze(ze,ae)}return $().isArray(Fe)?Fe.forEach(function(ze,rt){return Oe(ze,rt)}):$().objectEach(Fe,Oe),ge},J=P(744);function ne(Ze){return function(Fe){if(Array.isArray(Fe))return ue(Fe)}(Ze)||function(Fe){if(typeof Symbol<"u"&&Fe[Symbol.iterator]!=null||Fe["@@iterator"]!=null)return Array.from(Fe)}(Ze)||function(Fe,ae){if(Fe){if(typeof Fe=="string")return ue(Fe,ae);var ge=Object.prototype.toString.call(Fe).slice(8,-1);if(ge==="Object"&&Fe.constructor&&(ge=Fe.constructor.name),ge==="Map"||ge==="Set")return Array.from(Fe);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return ue(Fe,ae)}}(Ze)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ue(Ze,Fe){(Fe==null||Fe>Ze.length)&&(Fe=Ze.length);for(var ae=0,ge=new Array(Fe);ae<Fe;ae++)ge[ae]=Ze[ae];return ge}const we=function(Ze){var Fe=this;return{render:function(){return(0,J.h)("div",{ref:"chart"})},beforeUnmount:function(){var ae;return Fe==null||(ae=Fe.chart)===null||ae===void 0?void 0:ae.destroy()},props:{constructorType:{type:String,default:"chart"},options:{type:Object,required:!0},callback:Function,updateArgs:{type:Array,default:function(){return[!0,!0]}},highcharts:{type:Object},deepCopyOnUpdate:{type:Boolean,default:!0}},watch:{options:{handler:function(ae){var ge;(ge=this.chart).update.apply(ge,[Z(ae,this.deepCopyOnUpdate)].concat(ne(this.updateArgs)))},deep:!0}},mounted:function(){var ae=this.highcharts||Ze;ae[this.constructorType]?this.options?this.chart=ae[this.constructorType](this.$refs.chart,Z(this.options,!0),this.callback?this.callback:null):console.error('The "options" parameter was not passed.'):console.error("'".concat(this.constructorType,"' constructor-type is incorrect. Sometimes this error is caused by the fact, that the corresponding module wasn't imported."))}}};var Me=we($());function Ye(Ze){var Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ze.component(Fe.tagName||"highcharts",we(Fe.highcharts||$()))}})(),V})())})(YA);var ON=YA.exports;const RN=HA(ON),zN="Soil Values Geoportal",BN={home:"Home",map:"Map",mne:"M&E Dashboard",catalog:"Catalog",about:"About"},FN=" 2025 Soil Values Project | Funded by DGIS",NN={title:"Tools",tools:{landcover:{name:"Biophysical Monitoring",description:"Monitors key environmental variables including land cover, vegetation indices (NDVI, EVI), topography, and water availability. It offers a holistic view of the landscapes biophysical condition for better planning and resource management."},crop:{name:"Crop Monitoring",description:"This tool provides spatial insights into crop distribution, health, and seasonal performance using remote sensing data. It supports early detection of crop stress, tracking of growth stages, and estimation of yields to inform timely agricultural interventions."},degradation:{name:"Degradation Monitoring",description:"Tracks land degradation over time by analysing vegetation cover, erosion risk, and human impact. It helps identify hotspots of land degradation, supporting targeted land restoration and sustainable land management efforts."},drought:{name:"Drought Monitoring",description:"Detects and visualizes drought events using climatic and remote sensing indicators like rainfall anomalies, vegetation stress, and soil moisture. It supports early warning systems and helps stakeholders prepare and respond to climate risks."},fertility:{name:"Fertility Monitoring",description:"Assesses soil fertility dynamics through indicators such as organic carbon content, nutrient availability, and land use practices. The tool guides stakeholders in making data-informed decisions for improved soil health and productivity."},risk:{name:"Risk Monitoring",description:"Identify environmental risks by monitoring exposure to climate extremes, soil degradation, and water scarcity to prioritize resilience interventions."}}},UN={title:"Map Legend",labels:{water:"Water",forest:"Forest",cropland:"Cropland",grassland:"Grassland",shrubland:"Shrubland",wetland:"Wetland",bareland:"Bareland",urban:"Urban",boundary:"Boundary Outline"}},VN={title:"Soil Values Geoportal",intro1:"Welcome to the Soil Values Geoportal, your gateway to dynamic, data-driven insights for landscape restoration and sustainable land management.",intro2:"Explore real-time maps and analytics on land cover, soil health, crops, and climate to inform impactful decisions across our intervention areas.",launch:"Launch"},jN={hero:{title:"Soil Values",subtitle:"Catalyzing Farm Productivity  Burkina Faso, Mali, Niger, Nigeria  Active"},description:{program:"Soil Values",intro:"is a 10-year program (20242034) financed by the Netherlands Directorate-General for International Cooperation (DGIS), aimed at sustainable soil fertility management across Burkina Faso, Mali, Northern Nigeria, and Niger.",impact:"The program targets 2 million hectares and 1.5 million farmersespecially womenfostering resilient, productive farming systems.",approach:"The strategy centers on Integrated Soil Fertility Management (ISFM) and participatory landscape planning to foster scalable, sustainable solutions."},outcomes:{title:"Expected Outcomes",item1:"1.5 million smallholder farmers, including 800,000 women, reduce the yield gap and build resilience to climate shocks.",item2:"40+ river basins and landscapes2 million hectaresare managed sustainably with equitable water use.",item3:"Soil fertility becomes a priority in agricultural programs, national policies, and civil society efforts.",item4:"Neighboring countries (Ghana and Cte dIvoire) engage in dialogue on fertilizer trade and food security."},partners:{title:"Implementing Partners",description1:"Soil Values is implemented by IFDC in collaboration with SNV and Wageningen University and Research (WUR), alongside knowledge partners such as AGRA, ICRAF, IITA, ISRIC, and IWMI.",note:"Supported by DGIS under Dutch development policy."},updates:{title:"Recent Updates"}},$N={title:"Data Catalogue",description:`The Data Catalogue page centralizes access to diverse datasets managed within the geoportal. It provides structured metadata descriptions, facilitating efficient search, discovery, and utilization of spatial and non-spatial data resources.

Users will explore detailed descriptions of datasets, preview data formats, and access download links or APIs for integration into analytical workflows. The page will promote data transparency, interoperability, and accessibility, supporting evidence-based decision-making and collaborative research initiatives across multiple stakeholders.`},GN={title:"MEL Dashboard",description:`The MEL page serves as the central space for tracking project activities, progress, and performance across the Soil Values program. This page will feature an embedded interactive MEL dashboard developed by the IFDC M&E team, offering real-time insights into key indicators, outcomes, and learning milestones.

Users will visualize monitoring data geographically and thematically, supporting evidence-based decision-making and adaptive project management. The integration of this dashboard into the geoportal allows for a seamless link between spatial data and performance monitoring frameworks, promoting transparency, accountability, and learning across stakeholders.`},WN={title:"Biophysical Monitoring",description:"Monitors key environmental variables including land cover, vegetation indices (NDVI, EVI), topography, and water availability. It offers a holistic view of the landscapes biophysical condition for better planning and resource management.",mapLayers:"Map Layers",evi:"Cumulative EVI",health:"Biophysical Health (20102023)",baseline:"Land Cover  Baseline Period (20032008)",evaluation:"Land Cover  Evaluation Period (20102023)"},HN={title:"Soil Fertility Monitoring",description:"Assesses soil fertility dynamics through indicators such as organic carbon content, nutrient availability, and land use practices. The tool guides stakeholders in making data-informed decisions for improved soil health and productivity.",baseline:"Baseline",current:"Current",changes:{positive:"+ Improved",neutral:"No Change"},indicators:{organicMatter:"Organic Matter",nutrientLevels:"Nutrient Levels",erosionRisk:"Erosion Risk",waterRetention:"Water Retention"}},qN={title:"Map Controls",toggle:"Controls",country:"Country",watershed:"Intervention Watershed",commune:"Local Municipalities (Commune)",select:"Select...",reset:"Reset"},XN={title:zN,nav:BN,footer:FN,toolbox:NN,legend:UN,home:VN,about:jN,catalog:$N,monitoring:GN,biophysical:WN,fertility:HN,mapControls:qN},ZN="Goportail Soil Values",YN={home:"Accueil",map:"Carte",mne:"Suivi & valuation",catalog:"Catalogue",about:" Propos"},KN=" 2025 Projet Soil Values | Financ par DGIS",JN={title:"Outils",tools:{landcover:{name:"Suivi Biophysique",description:"Surveille les variables environnementales cls telles que la couverture terrestre, les indices de vgtation (NDVI, EVI), la topographie et la disponibilit en eau. Fournit une vue d'ensemble des conditions biophysiques du paysage pour une meilleure planification."},crop:{name:"Suivi des Cultures",description:"Fournit des informations spatiales sur la rpartition, la sant et les performances saisonnires des cultures  laide de donnes de tldtection. Aide  dtecter prcocement le stress des cultures et  estimer les rendements."},degradation:{name:"Suivi de la Dgradation",description:"Suit la dgradation des terres dans le temps via la couverture vgtale, les risques drosion et les impacts humains. Identifie les zones  restaurer et soutient la gestion durable des terres."},drought:{name:"Suivi de la Scheresse",description:"Dtecte et visualise les pisodes de scheresse  l'aide d'indicateurs climatiques et de tldtection. Appuie les systmes d'alerte prcoce pour mieux anticiper les risques climatiques."},fertility:{name:"Suivi de la Fertilit",description:"value la dynamique de la fertilit des sols par des indicateurs comme le carbone organique, les nutriments disponibles et les pratiques dutilisation des terres. Aide  prendre des dcisions claires pour amliorer la productivit."},risk:{name:"Suivi des Risques",description:"Identifie les risques environnementaux en suivant les extrmes climatiques, la dgradation des sols et la raret de l'eau pour orienter les interventions de rsilience."}}},QN={title:"Lgende de la carte",labels:{water:"Eau",forest:"Fort",cropland:"Terres cultives",grassland:"Prairies",shrubland:"Arbustes",wetland:"Zone humide",bareland:"Sol nu",urban:"Zone urbaine",boundary:"Limite"}},e5={title:"Goportail Soil Values",intro1:"Bienvenue sur le Goportail Soil Values, votre passerelle vers des donnes dynamiques pour la restauration des paysages et la gestion durable des terres.",intro2:"Explorez des cartes et des analyses en temps rel sur la couverture terrestre, la sant des sols, les cultures et le climat pour guider vos dcisions.",launch:"Lancer"},t5={hero:{title:"Soil Values",subtitle:"Stimuler la productivit agricole  Burkina Faso, Mali, Niger, Nigria  Actif"},description:{program:"Soil Values",intro:"est un programme de 10 ans (20242034) financ par la Direction gnrale de la coopration internationale des Pays-Bas (DGIS), visant  une gestion durable de la fertilit des sols au Burkina Faso, Mali, Nord du Nigria et Niger.",impact:"Le programme cible 2 millions d'hectares et 1,5 million d'agriculteurs, notamment des femmes, pour renforcer des systmes agricoles rsilients et productifs.",approach:"La stratgie repose sur la Gestion Intgre de la Fertilit des Sols (GIFS) et une planification participative des paysages pour encourager des solutions durables et volutives."},outcomes:{title:"Rsultats Attendus",item1:"1,5 million de petits exploitants agricoles, dont 800 000 femmes, rduisent le dficit de rendement et renforcent leur rsilience face aux chocs climatiques.",item2:"Plus de 40 bassins versants et paysages  2 millions dhectares  sont grs durablement avec une utilisation quitable de leau.",item3:"La fertilit des sols devient une priorit dans les programmes agricoles, les politiques nationales et les actions de la socit civile.",item4:"Les pays voisins (Ghana et Cte dIvoire) dialoguent sur le commerce des engrais et la scurit alimentaire."},partners:{title:"Partenaires de mise en uvre",description1:"Soil Values est mis en uvre par l'IFDC en collaboration avec SNV et lUniversit de Wageningen (WUR), avec des partenaires de connaissance comme AGRA, ICRAF, IITA, ISRIC et IWMI.",note:"Soutenu par la DGIS dans le cadre de la politique de dveloppement nerlandaise."},updates:{title:"Dernires actualits"}},i5={title:"Catalogue de donnes",description:`La page Catalogue de donnes centralise laccs  divers jeux de donnes grs dans le portail gospatial. Elle fournit des descriptions de mtadonnes structures, facilitant la recherche, la dcouverte et lutilisation efficace des ressources de donnes spatiales et non spatiales.

Les utilisateurs peuvent consulter des descriptions dtailles des jeux de donnes, prvisualiser les formats, et accder  des liens de tlchargement ou des API pour les intgrer dans leurs flux de travail analytiques. Cette page favorise la transparence, linteroprabilit et laccessibilit des donnes, soutenant la prise de dcisions fondes sur les donnes et la recherche collaborative entre parties prenantes.`},r5={title:"Tableau de bord MEL",description:`La page MEL constitue lespace central pour suivre les activits du projet, les progrs et les performances dans le cadre du programme Soil Values. Cette page prsentera un tableau de bord MEL interactif dvelopp par lquipe S&E de lIFDC, offrant des informations en temps rel sur les indicateurs cls, les rsultats et les tapes dapprentissage.

Les utilisateurs pourront visualiser les donnes de suivi de manire gographique et thmatique, soutenant la prise de dcision fonde sur des donnes probantes et une gestion adaptative du projet. Lintgration de ce tableau de bord dans le portail gospatial permet un lien fluide entre les donnes spatiales et les cadres de suivi des performances, favorisant la transparence, la redevabilit et lapprentissage entre les parties prenantes.`},n5={title:"Suivi biophysique",description:"Surveille les principales variables environnementales telles que la couverture terrestre, les indices de vgtation (NDVI, EVI), la topographie et la disponibilit en eau. Il offre une vue holistique de l'tat biophysique du paysage pour une meilleure planification et gestion des ressources.",mapLayers:"Couches cartographiques",evi:"EVI cumulatif",health:"Sant biophysique (20102023)",baseline:"Couverture terrestre  Priode de rfrence (20032008)",evaluation:"Couverture terrestre  Priode d'valuation (20102023)"},s5={title:"Suivi de la fertilit des sols",description:"value la dynamique de la fertilit des sols via des indicateurs tels que la teneur en carbone organique, la disponibilit des nutriments et les pratiques d'utilisation des terres. Cet outil aide les parties prenantes  prendre des dcisions claires pour amliorer la sant et la productivit des sols.",baseline:"Rfrence",current:"Actuel",changes:{positive:"+ Amlioration",neutral:"Aucun changement"},indicators:{organicMatter:"Matire organique",nutrientLevels:"Niveaux de nutriments",erosionRisk:"Risque d'rosion",waterRetention:"Rtention d'eau"}},o5={title:"Contrles de la carte",toggle:"Contrles",country:"Pays",watershed:"Bassin dintervention",commune:"Municipalits locales (Commune)",select:"Slectionner...",reset:"Rinitialiser"},a5={title:ZN,nav:YN,footer:KN,toolbox:JN,legend:QN,home:e5,about:t5,catalog:i5,monitoring:r5,biophysical:n5,fertility:s5,mapControls:o5},l5=OR({legacy:!1,globalInjection:!0,locale:"en",fallbackLocale:"en",messages:{en:XN,fr:a5}});var c5=Object.defineProperty,oE=Object.getOwnPropertySymbols,h5=Object.prototype.hasOwnProperty,u5=Object.prototype.propertyIsEnumerable,aE=(t,l,d)=>l in t?c5(t,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[l]=d,KA=(t,l)=>{for(var d in l||(l={}))h5.call(l,d)&&aE(t,d,l[d]);if(oE)for(var d of oE(l))u5.call(l,d)&&aE(t,d,l[d]);return t},Gx=t=>typeof t=="function",Wx=t=>typeof t=="string",JA=t=>Wx(t)&&t.trim().length>0,d5=t=>typeof t=="number",Cf=t=>typeof t>"u",n_=t=>typeof t=="object"&&t!==null,f5=t=>Dc(t,"tag")&&JA(t.tag),QA=t=>window.TouchEvent&&t instanceof TouchEvent,eM=t=>Dc(t,"component")&&tM(t.component),p5=t=>Gx(t)||n_(t),tM=t=>!Cf(t)&&(Wx(t)||p5(t)||eM(t)),lE=t=>n_(t)&&["height","width","right","left","top","bottom"].every(l=>d5(t[l])),Dc=(t,l)=>(n_(t)||Gx(t))&&l in t,m5=(t=>()=>t++)(0);function T0(t){return QA(t)?t.targetTouches[0].clientX:t.clientX}function cE(t){return QA(t)?t.targetTouches[0].clientY:t.clientY}var g5=t=>{Cf(t.remove)?t.parentNode&&t.parentNode.removeChild(t):t.remove()},g_=t=>eM(t)?g_(t.component):f5(t)?On({render(){return t}}):typeof t=="string"?t:Ir(ns(t)),_5=t=>{if(typeof t=="string")return t;const l=Dc(t,"props")&&n_(t.props)?t.props:{},d=Dc(t,"listeners")&&n_(t.listeners)?t.listeners:{};return{component:g_(t),props:l,listeners:d}},y5=()=>typeof window<"u",Qb=class{constructor(){this.allHandlers={}}getHandlers(t){return this.allHandlers[t]||[]}on(t,l){const d=this.getHandlers(t);d.push(l),this.allHandlers[t]=d}off(t,l){const d=this.getHandlers(t);d.splice(d.indexOf(l)>>>0,1)}emit(t,l){this.getHandlers(t).forEach(_=>_(l))}},x5=t=>["on","off","emit"].every(l=>Dc(t,l)&&Gx(t[l])),Oa;(function(t){t.SUCCESS="success",t.ERROR="error",t.WARNING="warning",t.INFO="info",t.DEFAULT="default"})(Oa||(Oa={}));var cx;(function(t){t.TOP_LEFT="top-left",t.TOP_CENTER="top-center",t.TOP_RIGHT="top-right",t.BOTTOM_LEFT="bottom-left",t.BOTTOM_CENTER="bottom-center",t.BOTTOM_RIGHT="bottom-right"})(cx||(cx={}));var Ra;(function(t){t.ADD="add",t.DISMISS="dismiss",t.UPDATE="update",t.CLEAR="clear",t.UPDATE_DEFAULTS="update_defaults"})(Ra||(Ra={}));var Bl="Vue-Toastification",Dl={type:{type:String,default:Oa.DEFAULT},classNames:{type:[String,Array],default:()=>[]},trueBoolean:{type:Boolean,default:!0}},iM={type:Dl.type,customIcon:{type:[String,Boolean,Object,Function],default:!0}},Gy={component:{type:[String,Object,Function,Boolean],default:"button"},classNames:Dl.classNames,showOnHover:{type:Boolean,default:!1},ariaLabel:{type:String,default:"close"}},hb={timeout:{type:[Number,Boolean],default:5e3},hideProgressBar:{type:Boolean,default:!1},isRunning:{type:Boolean,default:!1}},rM={transition:{type:[Object,String],default:`${Bl}__bounce`}},v5={position:{type:String,default:cx.TOP_RIGHT},draggable:Dl.trueBoolean,draggablePercent:{type:Number,default:.6},pauseOnFocusLoss:Dl.trueBoolean,pauseOnHover:Dl.trueBoolean,closeOnClick:Dl.trueBoolean,timeout:hb.timeout,hideProgressBar:hb.hideProgressBar,toastClassName:Dl.classNames,bodyClassName:Dl.classNames,icon:iM.customIcon,closeButton:Gy.component,closeButtonClassName:Gy.classNames,showCloseButtonOnHover:Gy.showOnHover,accessibility:{type:Object,default:()=>({toastRole:"alert",closeButtonLabel:"close"})},rtl:{type:Boolean,default:!1},eventBus:{type:Object,required:!1,default:()=>new Qb}},b5={id:{type:[String,Number],required:!0,default:0},type:Dl.type,content:{type:[String,Object,Function],required:!0,default:""},onClick:{type:Function,default:void 0},onClose:{type:Function,default:void 0}},w5={container:{type:[Object,Function],default:()=>document.body},newestOnTop:Dl.trueBoolean,maxToasts:{type:Number,default:20},transition:rM.transition,toastDefaults:Object,filterBeforeCreate:{type:Function,default:t=>t},filterToasts:{type:Function,default:t=>t},containerClassName:Dl.classNames,onMounted:Function,shareAppContext:[Boolean,Object]},Ih={CORE_TOAST:v5,TOAST:b5,CONTAINER:w5,PROGRESS_BAR:hb,ICON:iM,TRANSITION:rM,CLOSE_BUTTON:Gy},nM=On({name:"VtProgressBar",props:Ih.PROGRESS_BAR,data(){return{hasClass:!0}},computed:{style(){return{animationDuration:`${this.timeout}ms`,animationPlayState:this.isRunning?"running":"paused",opacity:this.hideProgressBar?0:1}},cpClass(){return this.hasClass?`${Bl}__progress-bar`:""}},watch:{timeout(){this.hasClass=!1,this.$nextTick(()=>this.hasClass=!0)}},mounted(){this.$el.addEventListener("animationend",this.animationEnded)},beforeUnmount(){this.$el.removeEventListener("animationend",this.animationEnded)},methods:{animationEnded(){this.$emit("close-toast")}}});function T5(t,l){return gi(),ki("div",{style:Rc(t.style),class:Us(t.cpClass)},null,6)}nM.render=T5;var E5=nM,sM=On({name:"VtCloseButton",props:Ih.CLOSE_BUTTON,computed:{buttonComponent(){return this.component!==!1?g_(this.component):"button"},classes(){const t=[`${Bl}__close-button`];return this.showOnHover&&t.push("show-on-hover"),t.concat(this.classNames)}}}),S5=Vs("  ");function C5(t,l){return gi(),Fo(Ax(t.buttonComponent),u_({"aria-label":t.ariaLabel,class:t.classes},t.$attrs),{default:Ns(()=>[S5]),_:1},16,["aria-label","class"])}sM.render=C5;var A5=sM,oM={},M5={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"check-circle",class:"svg-inline--fa fa-check-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},I5=ot("path",{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},null,-1),k5=[I5];function P5(t,l){return gi(),ki("svg",M5,k5)}oM.render=P5;var L5=oM,aM={},D5={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",class:"svg-inline--fa fa-info-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O5=ot("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},null,-1),R5=[O5];function z5(t,l){return gi(),ki("svg",D5,R5)}aM.render=z5;var hE=aM,lM={},B5={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-circle",class:"svg-inline--fa fa-exclamation-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},F5=ot("path",{fill:"currentColor",d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),N5=[F5];function U5(t,l){return gi(),ki("svg",B5,N5)}lM.render=U5;var V5=lM,cM={},j5={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-triangle",class:"svg-inline--fa fa-exclamation-triangle fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},$5=ot("path",{fill:"currentColor",d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),G5=[$5];function W5(t,l){return gi(),ki("svg",j5,G5)}cM.render=W5;var H5=cM,hM=On({name:"VtIcon",props:Ih.ICON,computed:{customIconChildren(){return Dc(this.customIcon,"iconChildren")?this.trimValue(this.customIcon.iconChildren):""},customIconClass(){return Wx(this.customIcon)?this.trimValue(this.customIcon):Dc(this.customIcon,"iconClass")?this.trimValue(this.customIcon.iconClass):""},customIconTag(){return Dc(this.customIcon,"iconTag")?this.trimValue(this.customIcon.iconTag,"i"):"i"},hasCustomIcon(){return this.customIconClass.length>0},component(){return this.hasCustomIcon?this.customIconTag:tM(this.customIcon)?g_(this.customIcon):this.iconTypeComponent},iconTypeComponent(){return{[Oa.DEFAULT]:hE,[Oa.INFO]:hE,[Oa.SUCCESS]:L5,[Oa.ERROR]:H5,[Oa.WARNING]:V5}[this.type]},iconClasses(){const t=[`${Bl}__icon`];return this.hasCustomIcon?t.concat(this.customIconClass):t}},methods:{trimValue(t,l=""){return JA(t)?t.trim():l}}});function q5(t,l){return gi(),Fo(Ax(t.component),{class:Us(t.iconClasses)},{default:Ns(()=>[Vs(pi(t.customIconChildren),1)]),_:1},8,["class"])}hM.render=q5;var X5=hM,uM=On({name:"VtToast",components:{ProgressBar:E5,CloseButton:A5,Icon:X5},inheritAttrs:!1,props:Object.assign({},Ih.CORE_TOAST,Ih.TOAST),data(){return{isRunning:!0,disableTransitions:!1,beingDragged:!1,dragStart:0,dragPos:{x:0,y:0},dragRect:{}}},computed:{classes(){const t=[`${Bl}__toast`,`${Bl}__toast--${this.type}`,`${this.position}`].concat(this.toastClassName);return this.disableTransitions&&t.push("disable-transition"),this.rtl&&t.push(`${Bl}__toast--rtl`),t},bodyClasses(){return[`${Bl}__toast-${Wx(this.content)?"body":"component-body"}`].concat(this.bodyClassName)},draggableStyle(){return this.dragStart===this.dragPos.x?{}:this.beingDragged?{transform:`translateX(${this.dragDelta}px)`,opacity:1-Math.abs(this.dragDelta/this.removalDistance)}:{transition:"transform 0.2s, opacity 0.2s",transform:"translateX(0)",opacity:1}},dragDelta(){return this.beingDragged?this.dragPos.x-this.dragStart:0},removalDistance(){return lE(this.dragRect)?(this.dragRect.right-this.dragRect.left)*this.draggablePercent:0}},mounted(){this.draggable&&this.draggableSetup(),this.pauseOnFocusLoss&&this.focusSetup()},beforeUnmount(){this.draggable&&this.draggableCleanup(),this.pauseOnFocusLoss&&this.focusCleanup()},methods:{hasProp:Dc,getVueComponentFromObj:g_,closeToast(){this.eventBus.emit(Ra.DISMISS,this.id)},clickHandler(){this.onClick&&this.onClick(this.closeToast),this.closeOnClick&&(!this.beingDragged||this.dragStart===this.dragPos.x)&&this.closeToast()},timeoutHandler(){this.closeToast()},hoverPause(){this.pauseOnHover&&(this.isRunning=!1)},hoverPlay(){this.pauseOnHover&&(this.isRunning=!0)},focusPause(){this.isRunning=!1},focusPlay(){this.isRunning=!0},focusSetup(){addEventListener("blur",this.focusPause),addEventListener("focus",this.focusPlay)},focusCleanup(){removeEventListener("blur",this.focusPause),removeEventListener("focus",this.focusPlay)},draggableSetup(){const t=this.$el;t.addEventListener("touchstart",this.onDragStart,{passive:!0}),t.addEventListener("mousedown",this.onDragStart),addEventListener("touchmove",this.onDragMove,{passive:!1}),addEventListener("mousemove",this.onDragMove),addEventListener("touchend",this.onDragEnd),addEventListener("mouseup",this.onDragEnd)},draggableCleanup(){const t=this.$el;t.removeEventListener("touchstart",this.onDragStart),t.removeEventListener("mousedown",this.onDragStart),removeEventListener("touchmove",this.onDragMove),removeEventListener("mousemove",this.onDragMove),removeEventListener("touchend",this.onDragEnd),removeEventListener("mouseup",this.onDragEnd)},onDragStart(t){this.beingDragged=!0,this.dragPos={x:T0(t),y:cE(t)},this.dragStart=T0(t),this.dragRect=this.$el.getBoundingClientRect()},onDragMove(t){this.beingDragged&&(t.preventDefault(),this.isRunning&&(this.isRunning=!1),this.dragPos={x:T0(t),y:cE(t)})},onDragEnd(){this.beingDragged&&(Math.abs(this.dragDelta)>=this.removalDistance?(this.disableTransitions=!0,this.$nextTick(()=>this.closeToast())):setTimeout(()=>{this.beingDragged=!1,lE(this.dragRect)&&this.pauseOnHover&&this.dragRect.bottom>=this.dragPos.y&&this.dragPos.y>=this.dragRect.top&&this.dragRect.left<=this.dragPos.x&&this.dragPos.x<=this.dragRect.right?this.isRunning=!1:this.isRunning=!0}))}}}),Z5=["role"];function Y5(t,l){const d=Ah("Icon"),_=Ah("CloseButton"),T=Ah("ProgressBar");return gi(),ki("div",{class:Us(t.classes),style:Rc(t.draggableStyle),onClick:l[0]||(l[0]=(...C)=>t.clickHandler&&t.clickHandler(...C)),onMouseenter:l[1]||(l[1]=(...C)=>t.hoverPause&&t.hoverPause(...C)),onMouseleave:l[2]||(l[2]=(...C)=>t.hoverPlay&&t.hoverPlay(...C))},[t.icon?(gi(),Fo(d,{key:0,"custom-icon":t.icon,type:t.type},null,8,["custom-icon","type"])):wn("v-if",!0),ot("div",{role:t.accessibility.toastRole||"alert",class:Us(t.bodyClasses)},[typeof t.content=="string"?(gi(),ki(jr,{key:0},[Vs(pi(t.content),1)],2112)):(gi(),Fo(Ax(t.getVueComponentFromObj(t.content)),u_({key:1,"toast-id":t.id},t.hasProp(t.content,"props")?t.content.props:{},aS(t.hasProp(t.content,"listeners")?t.content.listeners:{}),{onCloseToast:t.closeToast}),null,16,["toast-id","onCloseToast"]))],10,Z5),t.closeButton?(gi(),Fo(_,{key:1,component:t.closeButton,"class-names":t.closeButtonClassName,"show-on-hover":t.showCloseButtonOnHover,"aria-label":t.accessibility.closeButtonLabel,onClick:Yg(t.closeToast,["stop"])},null,8,["component","class-names","show-on-hover","aria-label","onClick"])):wn("v-if",!0),t.timeout?(gi(),Fo(T,{key:2,"is-running":t.isRunning,"hide-progress-bar":t.hideProgressBar,timeout:t.timeout,onCloseToast:t.timeoutHandler},null,8,["is-running","hide-progress-bar","timeout","onCloseToast"])):wn("v-if",!0)],38)}uM.render=Y5;var K5=uM,dM=On({name:"VtTransition",props:Ih.TRANSITION,emits:["leave"],methods:{hasProp:Dc,leave(t){t instanceof HTMLElement&&(t.style.left=t.offsetLeft+"px",t.style.top=t.offsetTop+"px",t.style.width=getComputedStyle(t).width,t.style.position="absolute")}}});function J5(t,l){return gi(),Fo(rC,{tag:"div","enter-active-class":t.transition.enter?t.transition.enter:`${t.transition}-enter-active`,"move-class":t.transition.move?t.transition.move:`${t.transition}-move`,"leave-active-class":t.transition.leave?t.transition.leave:`${t.transition}-leave-active`,onLeave:t.leave},{default:Ns(()=>[oS(t.$slots,"default")]),_:3},8,["enter-active-class","move-class","leave-active-class","onLeave"])}dM.render=J5;var Q5=dM,fM=On({name:"VueToastification",devtools:{hide:!0},components:{Toast:K5,VtTransition:Q5},props:Object.assign({},Ih.CORE_TOAST,Ih.CONTAINER,Ih.TRANSITION),data(){return{count:0,positions:Object.values(cx),toasts:{},defaults:{}}},computed:{toastArray(){return Object.values(this.toasts)},filteredToasts(){return this.defaults.filterToasts(this.toastArray)}},beforeMount(){const t=this.eventBus;t.on(Ra.ADD,this.addToast),t.on(Ra.CLEAR,this.clearToasts),t.on(Ra.DISMISS,this.dismissToast),t.on(Ra.UPDATE,this.updateToast),t.on(Ra.UPDATE_DEFAULTS,this.updateDefaults),this.defaults=this.$props},mounted(){this.setup(this.container)},methods:{async setup(t){Gx(t)&&(t=await t()),g5(this.$el),t.appendChild(this.$el)},setToast(t){Cf(t.id)||(this.toasts[t.id]=t)},addToast(t){t.content=_5(t.content);const l=Object.assign({},this.defaults,t.type&&this.defaults.toastDefaults&&this.defaults.toastDefaults[t.type],t),d=this.defaults.filterBeforeCreate(l,this.toastArray);d&&this.setToast(d)},dismissToast(t){const l=this.toasts[t];!Cf(l)&&!Cf(l.onClose)&&l.onClose(),delete this.toasts[t]},clearToasts(){Object.keys(this.toasts).forEach(t=>{this.dismissToast(t)})},getPositionToasts(t){const l=this.filteredToasts.filter(d=>d.position===t).slice(0,this.defaults.maxToasts);return this.defaults.newestOnTop?l.reverse():l},updateDefaults(t){Cf(t.container)||this.setup(t.container),this.defaults=Object.assign({},this.defaults,t)},updateToast({id:t,options:l,create:d}){this.toasts[t]?(l.timeout&&l.timeout===this.toasts[t].timeout&&l.timeout++,this.setToast(Object.assign({},this.toasts[t],l))):d&&this.addToast(Object.assign({},{id:t},l))},getClasses(t){return[`${Bl}__container`,t].concat(this.defaults.containerClassName)}}});function e4(t,l){const d=Ah("Toast"),_=Ah("VtTransition");return gi(),ki("div",null,[(gi(!0),ki(jr,null,za(t.positions,T=>(gi(),ki("div",{key:T},[fr(_,{transition:t.defaults.transition,class:Us(t.getClasses(T))},{default:Ns(()=>[(gi(!0),ki(jr,null,za(t.getPositionToasts(T),C=>(gi(),Fo(d,u_({key:C.id},C),null,16))),128))]),_:2},1032,["transition","class"])]))),128))])}fM.render=e4;var t4=fM,uE=(t={},l=!0)=>{const d=t.eventBus=t.eventBus||new Qb;l&&zf(()=>{const C=Kg(t4,KA({},t)),P=C.mount(document.createElement("div")),V=t.onMounted;if(Cf(V)||V(P,C),t.shareAppContext){const s=t.shareAppContext;s===!0?console.warn(`[${Bl}] App to share context with was not provided.`):(C._context.components=s._context.components,C._context.directives=s._context.directives,C._context.mixins=s._context.mixins,C._context.provides=s._context.provides,C.config.globalProperties=s.config.globalProperties)}});const _=(C,P)=>{const V=Object.assign({},{id:m5(),type:Oa.DEFAULT},P,{content:C});return d.emit(Ra.ADD,V),V.id};_.clear=()=>d.emit(Ra.CLEAR,void 0),_.updateDefaults=C=>{d.emit(Ra.UPDATE_DEFAULTS,C)},_.dismiss=C=>{d.emit(Ra.DISMISS,C)};function T(C,{content:P,options:V},s=!1){const $=Object.assign({},V,{content:P});d.emit(Ra.UPDATE,{id:C,options:$,create:s})}return _.update=T,_.success=(C,P)=>_(C,Object.assign({},P,{type:Oa.SUCCESS})),_.info=(C,P)=>_(C,Object.assign({},P,{type:Oa.INFO})),_.error=(C,P)=>_(C,Object.assign({},P,{type:Oa.ERROR})),_.warning=(C,P)=>_(C,Object.assign({},P,{type:Oa.WARNING})),_},i4=()=>{const t=()=>console.warn(`[${Bl}] This plugin does not support SSR!`);return new Proxy(t,{get(){return t}})};function r4(t){return y5()?x5(t)?uE({eventBus:t},!1):uE(t,!0):i4()}var n4=Symbol("VueToastification"),s4=new Qb,o4=(t,l)=>{(l==null?void 0:l.shareAppContext)===!0&&(l.shareAppContext=t);const d=r4(KA({eventBus:s4},l));t.provide(n4,d)},a4=o4;const xm=Kg(V3),l4=WR();xm.use(l4);xm.use(ZA);xm.use(l5);xm.use(RN);const c4={position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnHover:!0,draggable:!0,hideProgressBar:!1};xm.use(a4,c4);xm.mount("#app");
