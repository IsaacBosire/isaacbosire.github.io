var bO=Object.defineProperty;var wO=(e,t,n)=>t in e?bO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Fi=(e,t,n)=>wO(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))l(h);new MutationObserver(h=>{for(const d of h)if(d.type==="childList")for(const g of d.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function n(h){const d={};return h.integrity&&(d.integrity=h.integrity),h.referrerPolicy&&(d.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?d.credentials="include":h.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(h){if(h.ep)return;h.ep=!0;const d=n(h);fetch(h.href,d)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function gv(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Hn={},tg=[],El=()=>{},TO=()=>!1,zy=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Zw=e=>e.startsWith("onUpdate:"),Ls=Object.assign,Yw=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},EO=Object.prototype.hasOwnProperty,cs=(e,t)=>EO.call(e,t),Ri=Array.isArray,ig=e=>xg(e)==="[object Map]",Lp=e=>xg(e)==="[object Set]",hS=e=>xg(e)==="[object Date]",SO=e=>xg(e)==="[object RegExp]",on=e=>typeof e=="function",Vs=e=>typeof e=="string",cc=e=>typeof e=="symbol",Ms=e=>e!==null&&typeof e=="object",Kw=e=>(Ms(e)||on(e))&&on(e.then)&&on(e.catch),BA=Object.prototype.toString,xg=e=>BA.call(e),MO=e=>xg(e).slice(8,-1),_v=e=>xg(e)==="[object Object]",Jw=e=>Vs(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ng=gv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),yv=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},CO=/-(\w)/g,oo=yv(e=>e.replace(CO,(t,n)=>n?n.toUpperCase():"")),AO=/\B([A-Z])/g,Ma=yv(e=>e.replace(AO,"-$1").toLowerCase()),By=yv(e=>e.charAt(0).toUpperCase()+e.slice(1)),Z_=yv(e=>e?`on${By(e)}`:""),Qo=(e,t)=>!Object.is(e,t),sg=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},FA=(e,t,n,l=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:l,value:n})},j0=e=>{const t=parseFloat(e);return isNaN(t)?e:t},$0=e=>{const t=Vs(e)?Number(e):NaN;return isNaN(t)?e:t};let uS;const xv=()=>uS||(uS=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),kO="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",IO=gv(kO);function uc(e){if(Ri(e)){const t={};for(let n=0;n<e.length;n++){const l=e[n],h=Vs(l)?OO(l):uc(l);if(h)for(const d in h)t[d]=h[d]}return t}else if(Vs(e)||Ms(e))return e}const PO=/;(?![^(]*\))/g,LO=/:([^]+)/,DO=/\/\*[^]*?\*\//g;function OO(e){const t={};return e.replace(DO,"").split(PO).forEach(n=>{if(n){const l=n.split(LO);l.length>1&&(t[l[0].trim()]=l[1].trim())}}),t}function Jr(e){let t="";if(Vs(e))t=e;else if(Ri(e))for(let n=0;n<e.length;n++){const l=Jr(e[n]);l&&(t+=l+" ")}else if(Ms(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function RO(e){if(!e)return null;let{class:t,style:n}=e;return t&&!Vs(t)&&(e.class=Jr(t)),n&&(e.style=uc(n)),e}const zO="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",BO=gv(zO);function NA(e){return!!e||e===""}function FO(e,t){if(e.length!==t.length)return!1;let n=!0;for(let l=0;n&&l<e.length;l++)n=Pd(e[l],t[l]);return n}function Pd(e,t){if(e===t)return!0;let n=hS(e),l=hS(t);if(n||l)return n&&l?e.getTime()===t.getTime():!1;if(n=cc(e),l=cc(t),n||l)return e===t;if(n=Ri(e),l=Ri(t),n||l)return n&&l?FO(e,t):!1;if(n=Ms(e),l=Ms(t),n||l){if(!n||!l)return!1;const h=Object.keys(e).length,d=Object.keys(t).length;if(h!==d)return!1;for(const g in e){const b=e.hasOwnProperty(g),r=t.hasOwnProperty(g);if(b&&!r||!b&&r||!Pd(e[g],t[g]))return!1}}return String(e)===String(t)}function vv(e,t){return e.findIndex(n=>Pd(n,t))}const UA=e=>!!(e&&e.__v_isRef===!0),Ht=e=>Vs(e)?e:e==null?"":Ri(e)||Ms(e)&&(e.toString===BA||!on(e.toString))?UA(e)?Ht(e.value):JSON.stringify(e,VA,2):String(e),VA=(e,t)=>UA(t)?VA(e,t.value):ig(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[l,h],d)=>(n[d1(l,d)+" =>"]=h,n),{})}:Lp(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>d1(n))}:cc(t)?d1(t):Ms(t)&&!Ri(t)&&!_v(t)?String(t):t,d1=(e,t="")=>{var n;return cc(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Jo;class Qw{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Jo,!t&&Jo&&(this.index=(Jo.scopes||(Jo.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Jo;try{return Jo=this,t()}finally{Jo=n}}}on(){Jo=this}off(){Jo=this.parent}stop(t){if(this._active){this._active=!1;let n,l;for(n=0,l=this.effects.length;n<l;n++)this.effects[n].stop();for(this.effects.length=0,n=0,l=this.cleanups.length;n<l;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,l=this.scopes.length;n<l;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const h=this.parent.scopes.pop();h&&h!==this&&(this.parent.scopes[this.index]=h,h.index=this.index)}this.parent=void 0}}}function bv(e){return new Qw(e)}function eT(){return Jo}function jA(e,t=!1){Jo&&Jo.cleanups.push(e)}let Ns;const f1=new WeakSet;class hy{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Jo&&Jo.active&&Jo.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,f1.has(this)&&(f1.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||WA(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,dS(this),GA(this);const t=Ns,n=ac;Ns=this,ac=!0;try{return this.fn()}finally{HA(this),Ns=t,ac=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)nT(t);this.deps=this.depsTail=void 0,dS(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?f1.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){K1(this)&&this.run()}get dirty(){return K1(this)}}let $A=0,Y_,K_;function WA(e,t=!1){if(e.flags|=8,t){e.next=K_,K_=e;return}e.next=Y_,Y_=e}function tT(){$A++}function iT(){if(--$A>0)return;if(K_){let t=K_;for(K_=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Y_;){let t=Y_;for(Y_=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(l){e||(e=l)}t=n}}if(e)throw e}function GA(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function HA(e){let t,n=e.depsTail,l=n;for(;l;){const h=l.prevDep;l.version===-1?(l===n&&(n=h),nT(l),NO(l)):t=l,l.dep.activeLink=l.prevActiveLink,l.prevActiveLink=void 0,l=h}e.deps=t,e.depsTail=n}function K1(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(qA(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function qA(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===uy))return;e.globalVersion=uy;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!K1(e)){e.flags&=-3;return}const n=Ns,l=ac;Ns=e,ac=!0;try{GA(e);const h=e.fn(e._value);(t.version===0||Qo(h,e._value))&&(e._value=h,t.version++)}catch(h){throw t.version++,h}finally{Ns=n,ac=l,HA(e),e.flags&=-3}}function nT(e,t=!1){const{dep:n,prevSub:l,nextSub:h}=e;if(l&&(l.nextSub=h,e.prevSub=void 0),h&&(h.prevSub=l,e.nextSub=void 0),n.subs===e&&(n.subs=l,!l&&n.computed)){n.computed.flags&=-5;for(let d=n.computed.deps;d;d=d.nextDep)nT(d,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function NO(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}function UO(e,t){e.effect instanceof hy&&(e=e.effect.fn);const n=new hy(e);t&&Ls(n,t);try{n.run()}catch(h){throw n.stop(),h}const l=n.run.bind(n);return l.effect=n,l}function VO(e){e.effect.stop()}let ac=!0;const XA=[];function zd(){XA.push(ac),ac=!1}function Bd(){const e=XA.pop();ac=e===void 0?!0:e}function dS(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=Ns;Ns=void 0;try{t()}finally{Ns=n}}}let uy=0;class jO{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class wv{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ns||!ac||Ns===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ns)n=this.activeLink=new jO(Ns,this),Ns.deps?(n.prevDep=Ns.depsTail,Ns.depsTail.nextDep=n,Ns.depsTail=n):Ns.deps=Ns.depsTail=n,ZA(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const l=n.nextDep;l.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=l),n.prevDep=Ns.depsTail,n.nextDep=void 0,Ns.depsTail.nextDep=n,Ns.depsTail=n,Ns.deps===n&&(Ns.deps=l)}return n}trigger(t){this.version++,uy++,this.notify(t)}notify(t){tT();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{iT()}}}function ZA(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let l=t.deps;l;l=l.nextDep)ZA(l)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const W0=new WeakMap,bp=Symbol(""),J1=Symbol(""),dy=Symbol("");function Co(e,t,n){if(ac&&Ns){let l=W0.get(e);l||W0.set(e,l=new Map);let h=l.get(n);h||(l.set(n,h=new wv),h.map=l,h.key=n),h.track()}}function eu(e,t,n,l,h,d){const g=W0.get(e);if(!g){uy++;return}const b=r=>{r&&r.trigger()};if(tT(),t==="clear")g.forEach(b);else{const r=Ri(e),C=r&&Jw(n);if(r&&n==="length"){const O=Number(l);g.forEach((U,$)=>{($==="length"||$===dy||!cc($)&&$>=O)&&b(U)})}else switch((n!==void 0||g.has(void 0))&&b(g.get(n)),C&&b(g.get(dy)),t){case"add":r?C&&b(g.get("length")):(b(g.get(bp)),ig(e)&&b(g.get(J1)));break;case"delete":r||(b(g.get(bp)),ig(e)&&b(g.get(J1)));break;case"set":ig(e)&&b(g.get(bp));break}}iT()}function $O(e,t){const n=W0.get(e);return n&&n.get(t)}function jm(e){const t=Sn(e);return t===e?t:(Co(t,"iterate",dy),tl(e)?t:t.map(Ao))}function Tv(e){return Co(e=Sn(e),"iterate",dy),e}const WO={__proto__:null,[Symbol.iterator](){return p1(this,Symbol.iterator,Ao)},concat(...e){return jm(this).concat(...e.map(t=>Ri(t)?jm(t):t))},entries(){return p1(this,"entries",e=>(e[1]=Ao(e[1]),e))},every(e,t){return Gh(this,"every",e,t,void 0,arguments)},filter(e,t){return Gh(this,"filter",e,t,n=>n.map(Ao),arguments)},find(e,t){return Gh(this,"find",e,t,Ao,arguments)},findIndex(e,t){return Gh(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Gh(this,"findLast",e,t,Ao,arguments)},findLastIndex(e,t){return Gh(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Gh(this,"forEach",e,t,void 0,arguments)},includes(...e){return m1(this,"includes",e)},indexOf(...e){return m1(this,"indexOf",e)},join(e){return jm(this).join(e)},lastIndexOf(...e){return m1(this,"lastIndexOf",e)},map(e,t){return Gh(this,"map",e,t,void 0,arguments)},pop(){return P_(this,"pop")},push(...e){return P_(this,"push",e)},reduce(e,...t){return fS(this,"reduce",e,t)},reduceRight(e,...t){return fS(this,"reduceRight",e,t)},shift(){return P_(this,"shift")},some(e,t){return Gh(this,"some",e,t,void 0,arguments)},splice(...e){return P_(this,"splice",e)},toReversed(){return jm(this).toReversed()},toSorted(e){return jm(this).toSorted(e)},toSpliced(...e){return jm(this).toSpliced(...e)},unshift(...e){return P_(this,"unshift",e)},values(){return p1(this,"values",Ao)}};function p1(e,t,n){const l=Tv(e),h=l[t]();return l!==e&&!tl(e)&&(h._next=h.next,h.next=()=>{const d=h._next();return d.value&&(d.value=n(d.value)),d}),h}const GO=Array.prototype;function Gh(e,t,n,l,h,d){const g=Tv(e),b=g!==e&&!tl(e),r=g[t];if(r!==GO[t]){const U=r.apply(e,d);return b?Ao(U):U}let C=n;g!==e&&(b?C=function(U,$){return n.call(this,Ao(U),$,e)}:n.length>2&&(C=function(U,$){return n.call(this,U,$,e)}));const O=r.call(g,C,l);return b&&h?h(O):O}function fS(e,t,n,l){const h=Tv(e);let d=n;return h!==e&&(tl(e)?n.length>3&&(d=function(g,b,r){return n.call(this,g,b,r,e)}):d=function(g,b,r){return n.call(this,g,Ao(b),r,e)}),h[t](d,...l)}function m1(e,t,n){const l=Sn(e);Co(l,"iterate",dy);const h=l[t](...n);return(h===-1||h===!1)&&bg(n[0])?(n[0]=Sn(n[0]),l[t](...n)):h}function P_(e,t,n=[]){zd(),tT();const l=Sn(e)[t].apply(e,n);return iT(),Bd(),l}const HO=gv("__proto__,__v_isRef,__isVue"),YA=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(cc));function qO(e){cc(e)||(e=String(e));const t=Sn(this);return Co(t,"has",e),t.hasOwnProperty(e)}class KA{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,l){if(n==="__v_skip")return t.__v_skip;const h=this._isReadonly,d=this._isShallow;if(n==="__v_isReactive")return!h;if(n==="__v_isReadonly")return h;if(n==="__v_isShallow")return d;if(n==="__v_raw")return l===(h?d?nk:ik:d?tk:ek).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(l)?t:void 0;const g=Ri(t);if(!h){let r;if(g&&(r=WO[n]))return r;if(n==="hasOwnProperty")return qO}const b=Reflect.get(t,n,Zs(t)?t:l);return(cc(n)?YA.has(n):HO(n))||(h||Co(t,"get",n),d)?b:Zs(b)?g&&Jw(n)?b:b.value:Ms(b)?h?rT(b):vg(b):b}}class JA extends KA{constructor(t=!1){super(!1,t)}set(t,n,l,h){let d=t[n];if(!this._isShallow){const r=Ld(d);if(!tl(l)&&!Ld(l)&&(d=Sn(d),l=Sn(l)),!Ri(t)&&Zs(d)&&!Zs(l))return r?!1:(d.value=l,!0)}const g=Ri(t)&&Jw(n)?Number(n)<t.length:cs(t,n),b=Reflect.set(t,n,l,Zs(t)?t:h);return t===Sn(h)&&(g?Qo(l,d)&&eu(t,"set",n,l):eu(t,"add",n,l)),b}deleteProperty(t,n){const l=cs(t,n);t[n];const h=Reflect.deleteProperty(t,n);return h&&l&&eu(t,"delete",n,void 0),h}has(t,n){const l=Reflect.has(t,n);return(!cc(n)||!YA.has(n))&&Co(t,"has",n),l}ownKeys(t){return Co(t,"iterate",Ri(t)?"length":bp),Reflect.ownKeys(t)}}class QA extends KA{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const XO=new JA,ZO=new QA,YO=new JA(!0),KO=new QA(!0),Q1=e=>e,Qx=e=>Reflect.getPrototypeOf(e);function JO(e,t,n){return function(...l){const h=this.__v_raw,d=Sn(h),g=ig(d),b=e==="entries"||e===Symbol.iterator&&g,r=e==="keys"&&g,C=h[e](...l),O=n?Q1:t?ew:Ao;return!t&&Co(d,"iterate",r?J1:bp),{next(){const{value:U,done:$}=C.next();return $?{value:U,done:$}:{value:b?[O(U[0]),O(U[1])]:O(U),done:$}},[Symbol.iterator](){return this}}}}function e0(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function QO(e,t){const n={get(h){const d=this.__v_raw,g=Sn(d),b=Sn(h);e||(Qo(h,b)&&Co(g,"get",h),Co(g,"get",b));const{has:r}=Qx(g),C=t?Q1:e?ew:Ao;if(r.call(g,h))return C(d.get(h));if(r.call(g,b))return C(d.get(b));d!==g&&d.get(h)},get size(){const h=this.__v_raw;return!e&&Co(Sn(h),"iterate",bp),Reflect.get(h,"size",h)},has(h){const d=this.__v_raw,g=Sn(d),b=Sn(h);return e||(Qo(h,b)&&Co(g,"has",h),Co(g,"has",b)),h===b?d.has(h):d.has(h)||d.has(b)},forEach(h,d){const g=this,b=g.__v_raw,r=Sn(b),C=t?Q1:e?ew:Ao;return!e&&Co(r,"iterate",bp),b.forEach((O,U)=>h.call(d,C(O),C(U),g))}};return Ls(n,e?{add:e0("add"),set:e0("set"),delete:e0("delete"),clear:e0("clear")}:{add(h){!t&&!tl(h)&&!Ld(h)&&(h=Sn(h));const d=Sn(this);return Qx(d).has.call(d,h)||(d.add(h),eu(d,"add",h,h)),this},set(h,d){!t&&!tl(d)&&!Ld(d)&&(d=Sn(d));const g=Sn(this),{has:b,get:r}=Qx(g);let C=b.call(g,h);C||(h=Sn(h),C=b.call(g,h));const O=r.call(g,h);return g.set(h,d),C?Qo(d,O)&&eu(g,"set",h,d):eu(g,"add",h,d),this},delete(h){const d=Sn(this),{has:g,get:b}=Qx(d);let r=g.call(d,h);r||(h=Sn(h),r=g.call(d,h)),b&&b.call(d,h);const C=d.delete(h);return r&&eu(d,"delete",h,void 0),C},clear(){const h=Sn(this),d=h.size!==0,g=h.clear();return d&&eu(h,"clear",void 0,void 0),g}}),["keys","values","entries",Symbol.iterator].forEach(h=>{n[h]=JO(h,e,t)}),n}function Ev(e,t){const n=QO(e,t);return(l,h,d)=>h==="__v_isReactive"?!e:h==="__v_isReadonly"?e:h==="__v_raw"?l:Reflect.get(cs(n,h)&&h in l?n:l,h,d)}const eR={get:Ev(!1,!1)},tR={get:Ev(!1,!0)},iR={get:Ev(!0,!1)},nR={get:Ev(!0,!0)},ek=new WeakMap,tk=new WeakMap,ik=new WeakMap,nk=new WeakMap;function sR(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function rR(e){return e.__v_skip||!Object.isExtensible(e)?0:sR(MO(e))}function vg(e){return Ld(e)?e:Sv(e,!1,XO,eR,ek)}function sT(e){return Sv(e,!1,YO,tR,tk)}function rT(e){return Sv(e,!0,ZO,iR,ik)}function oR(e){return Sv(e,!0,KO,nR,nk)}function Sv(e,t,n,l,h){if(!Ms(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const d=h.get(e);if(d)return d;const g=rR(e);if(g===0)return e;const b=new Proxy(e,g===2?l:n);return h.set(e,b),b}function lc(e){return Ld(e)?lc(e.__v_raw):!!(e&&e.__v_isReactive)}function Ld(e){return!!(e&&e.__v_isReadonly)}function tl(e){return!!(e&&e.__v_isShallow)}function bg(e){return e?!!e.__v_raw:!1}function Sn(e){const t=e&&e.__v_raw;return t?Sn(t):e}function Mv(e){return!cs(e,"__v_skip")&&Object.isExtensible(e)&&FA(e,"__v_skip",!0),e}const Ao=e=>Ms(e)?vg(e):e,ew=e=>Ms(e)?rT(e):e;function Zs(e){return e?e.__v_isRef===!0:!1}function Vi(e){return sk(e,!1)}function Dp(e){return sk(e,!0)}function sk(e,t){return Zs(e)?e:new aR(e,t)}class aR{constructor(t,n){this.dep=new wv,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Sn(t),this._value=n?t:Ao(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,l=this.__v_isShallow||tl(t)||Ld(t);t=l?t:Sn(t),Qo(t,n)&&(this._rawValue=t,this._value=l?t:Ao(t),this.dep.trigger())}}function lR(e){e.dep&&e.dep.trigger()}function hs(e){return Zs(e)?e.value:e}function cR(e){return on(e)?e():hs(e)}const hR={get:(e,t,n)=>t==="__v_raw"?e:hs(Reflect.get(e,t,n)),set:(e,t,n,l)=>{const h=e[t];return Zs(h)&&!Zs(n)?(h.value=n,!0):Reflect.set(e,t,n,l)}};function oT(e){return lc(e)?e:new Proxy(e,hR)}class uR{constructor(t){this.__v_isRef=!0,this._value=void 0;const n=this.dep=new wv,{get:l,set:h}=t(n.track.bind(n),n.trigger.bind(n));this._get=l,this._set=h}get value(){return this._value=this._get()}set value(t){this._set(t)}}function rk(e){return new uR(e)}function ok(e){const t=Ri(e)?new Array(e.length):{};for(const n in e)t[n]=lk(e,n);return t}class dR{constructor(t,n,l){this._object=t,this._key=n,this._defaultValue=l,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return $O(Sn(this._object),this._key)}}class fR{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function ak(e,t,n){return Zs(e)?e:on(e)?new fR(e):Ms(e)&&arguments.length>1?lk(e,t,n):Vi(e)}function lk(e,t,n){const l=e[t];return Zs(l)?l:new dR(e,t,n)}class pR{constructor(t,n,l){this.fn=t,this.setter=n,this._value=void 0,this.dep=new wv(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=uy-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=l}notify(){if(this.flags|=16,!(this.flags&8)&&Ns!==this)return WA(this,!0),!0}get value(){const t=this.dep.track();return qA(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function mR(e,t,n=!1){let l,h;return on(e)?l=e:(l=e.get,h=e.set),new pR(l,h,n)}const gR={GET:"get",HAS:"has",ITERATE:"iterate"},_R={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},t0={},G0=new WeakMap;let vd;function yR(){return vd}function ck(e,t=!1,n=vd){if(n){let l=G0.get(n);l||G0.set(n,l=[]),l.push(e)}}function xR(e,t,n=Hn){const{immediate:l,deep:h,once:d,scheduler:g,augmentJob:b,call:r}=n,C=he=>h?he:tl(he)||h===!1||h===0?tu(he,1):tu(he);let O,U,$,q,ee=!1,ie=!1;if(Zs(e)?(U=()=>e.value,ee=tl(e)):lc(e)?(U=()=>C(e),ee=!0):Ri(e)?(ie=!0,ee=e.some(he=>lc(he)||tl(he)),U=()=>e.map(he=>{if(Zs(he))return he.value;if(lc(he))return C(he);if(on(he))return r?r(he,2):he()})):on(e)?t?U=r?()=>r(e,2):e:U=()=>{if($){zd();try{$()}finally{Bd()}}const he=vd;vd=O;try{return r?r(e,3,[q]):e(q)}finally{vd=he}}:U=El,t&&h){const he=U,fe=h===!0?1/0:h;U=()=>tu(he(),fe)}const de=eT(),ye=()=>{O.stop(),de&&de.active&&Yw(de.effects,O)};if(d&&t){const he=t;t=(...fe)=>{he(...fe),ye()}}let be=ie?new Array(e.length).fill(t0):t0;const se=he=>{if(!(!(O.flags&1)||!O.dirty&&!he))if(t){const fe=O.run();if(h||ee||(ie?fe.some((Me,ze)=>Qo(Me,be[ze])):Qo(fe,be))){$&&$();const Me=vd;vd=O;try{const ze=[fe,be===t0?void 0:ie&&be[0]===t0?[]:be,q];r?r(t,3,ze):t(...ze),be=fe}finally{vd=Me}}}else O.run()};return b&&b(se),O=new hy(U),O.scheduler=g?()=>g(se,!1):se,q=he=>ck(he,!1,O),$=O.onStop=()=>{const he=G0.get(O);if(he){if(r)r(he,4);else for(const fe of he)fe();G0.delete(O)}},t?l?se(!0):be=O.run():g?g(se.bind(null,!0),!0):O.run(),ye.pause=O.pause.bind(O),ye.resume=O.resume.bind(O),ye.stop=ye,ye}function tu(e,t=1/0,n){if(t<=0||!Ms(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,Zs(e))tu(e.value,t,n);else if(Ri(e))for(let l=0;l<e.length;l++)tu(e[l],t,n);else if(Lp(e)||ig(e))e.forEach(l=>{tu(l,t,n)});else if(_v(e)){for(const l in e)tu(e[l],t,n);for(const l of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,l)&&tu(e[l],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const hk=[];function vR(e){hk.push(e)}function bR(){hk.pop()}function wR(e,t){}const TR={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},ER={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function wg(e,t,n,l){try{return l?e(...l):e()}catch(h){Op(h,t,n)}}function Ml(e,t,n,l){if(on(e)){const h=wg(e,t,n,l);return h&&Kw(h)&&h.catch(d=>{Op(d,t,n)}),h}if(Ri(e)){const h=[];for(let d=0;d<e.length;d++)h.push(Ml(e[d],t,n,l));return h}}function Op(e,t,n,l=!0){const h=t?t.vnode:null,{errorHandler:d,throwUnhandledErrorInProduction:g}=t&&t.appContext.config||Hn;if(t){let b=t.parent;const r=t.proxy,C=`https://vuejs.org/error-reference/#runtime-${n}`;for(;b;){const O=b.ec;if(O){for(let U=0;U<O.length;U++)if(O[U](e,r,C)===!1)return}b=b.parent}if(d){zd(),wg(d,null,10,[e,r,C]),Bd();return}}SR(e,n,h,l,g)}function SR(e,t,n,l=!0,h=!1){if(h)throw e;console.error(e)}const ea=[];let th=-1;const rg=[];let bd=null,Xm=0;const uk=Promise.resolve();let H0=null;function Fd(e){const t=H0||uk;return e?t.then(this?e.bind(this):e):t}function MR(e){let t=th+1,n=ea.length;for(;t<n;){const l=t+n>>>1,h=ea[l],d=py(h);d<e||d===e&&h.flags&2?t=l+1:n=l}return t}function aT(e){if(!(e.flags&1)){const t=py(e),n=ea[ea.length-1];!n||!(e.flags&2)&&t>=py(n)?ea.push(e):ea.splice(MR(t),0,e),e.flags|=1,dk()}}function dk(){H0||(H0=uk.then(fk))}function fy(e){Ri(e)?rg.push(...e):bd&&e.id===-1?bd.splice(Xm+1,0,e):e.flags&1||(rg.push(e),e.flags|=1),dk()}function pS(e,t,n=th+1){for(;n<ea.length;n++){const l=ea[n];if(l&&l.flags&2){if(e&&l.id!==e.uid)continue;ea.splice(n,1),n--,l.flags&4&&(l.flags&=-2),l(),l.flags&4||(l.flags&=-2)}}}function q0(e){if(rg.length){const t=[...new Set(rg)].sort((n,l)=>py(n)-py(l));if(rg.length=0,bd){bd.push(...t);return}for(bd=t,Xm=0;Xm<bd.length;Xm++){const n=bd[Xm];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}bd=null,Xm=0}}const py=e=>e.id==null?e.flags&2?-1:1/0:e.id;function fk(e){try{for(th=0;th<ea.length;th++){const t=ea[th];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),wg(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;th<ea.length;th++){const t=ea[th];t&&(t.flags&=-2)}th=-1,ea.length=0,q0(),H0=null,(ea.length||rg.length)&&fk()}}let Zm,i0=[];function pk(e,t){var n,l;Zm=e,Zm?(Zm.enabled=!0,i0.forEach(({event:h,args:d})=>Zm.emit(h,...d)),i0=[]):typeof window<"u"&&window.HTMLElement&&!((l=(n=window.navigator)==null?void 0:n.userAgent)!=null&&l.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(d=>{pk(d,t)}),setTimeout(()=>{Zm||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,i0=[])},3e3)):i0=[]}let Ur=null,Cv=null;function my(e){const t=Ur;return Ur=e,Cv=e&&e.type.__scopeId||null,t}function CR(e){Cv=e}function AR(){Cv=null}const kR=e=>Kr;function Kr(e,t=Ur,n){if(!t||e._n)return e;const l=(...h)=>{l._d&&lw(-1);const d=my(t);let g;try{g=e(...h)}finally{my(d),l._d&&lw(1)}return g};return l._n=!0,l._c=!0,l._d=!0,l}function Mo(e,t){if(Ur===null)return e;const n=Vy(Ur),l=e.dirs||(e.dirs=[]);for(let h=0;h<t.length;h++){let[d,g,b,r=Hn]=t[h];d&&(on(d)&&(d={mounted:d,updated:d}),d.deep&&tu(g),l.push({dir:d,instance:n,value:g,oldValue:void 0,arg:b,modifiers:r}))}return e}function nh(e,t,n,l){const h=e.dirs,d=t&&t.dirs;for(let g=0;g<h.length;g++){const b=h[g];d&&(b.oldValue=d[g].value);let r=b.dir[l];r&&(zd(),Ml(r,n,8,[e.el,b,e,t]),Bd())}}const mk=Symbol("_vte"),gk=e=>e.__isTeleport,J_=e=>e&&(e.disabled||e.disabled===""),mS=e=>e&&(e.defer||e.defer===""),gS=e=>typeof SVGElement<"u"&&e instanceof SVGElement,_S=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,tw=(e,t)=>{const n=e&&e.to;return Vs(n)?t?t(n):null:n},_k={name:"Teleport",__isTeleport:!0,process(e,t,n,l,h,d,g,b,r,C){const{mc:O,pc:U,pbc:$,o:{insert:q,querySelector:ee,createText:ie,createComment:de}}=C,ye=J_(t.props);let{shapeFlag:be,children:se,dynamicChildren:he}=t;if(e==null){const fe=t.el=ie(""),Me=t.anchor=ie("");q(fe,n,l),q(Me,n,l);const ze=(Ue,Ne)=>{be&16&&(h&&h.isCE&&(h.ce._teleportTarget=Ue),O(se,Ue,Ne,h,d,g,b,r))},ve=()=>{const Ue=t.target=tw(t.props,ee),Ne=yk(Ue,t,ie,q);Ue&&(g!=="svg"&&gS(Ue)?g="svg":g!=="mathml"&&_S(Ue)&&(g="mathml"),ye||(ze(Ue,Ne),C0(t,!1)))};ye&&(ze(n,Me),C0(t,!0)),mS(t.props)?Fr(()=>{ve(),t.el.__isMounted=!0},d):ve()}else{if(mS(t.props)&&!e.el.__isMounted){Fr(()=>{_k.process(e,t,n,l,h,d,g,b,r,C),delete e.el.__isMounted},d);return}t.el=e.el,t.targetStart=e.targetStart;const fe=t.anchor=e.anchor,Me=t.target=e.target,ze=t.targetAnchor=e.targetAnchor,ve=J_(e.props),Ue=ve?n:Me,Ne=ve?fe:ze;if(g==="svg"||gS(Me)?g="svg":(g==="mathml"||_S(Me))&&(g="mathml"),he?($(e.dynamicChildren,he,Ue,h,d,g,b),xT(e,t,!0)):r||U(e,t,Ue,Ne,h,d,g,b,!1),ye)ve?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):n0(t,n,fe,C,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const it=t.target=tw(t.props,ee);it&&n0(t,it,null,C,0)}else ve&&n0(t,Me,ze,C,1);C0(t,ye)}},remove(e,t,n,{um:l,o:{remove:h}},d){const{shapeFlag:g,children:b,anchor:r,targetStart:C,targetAnchor:O,target:U,props:$}=e;if(U&&(h(C),h(O)),d&&h(r),g&16){const q=d||!J_($);for(let ee=0;ee<b.length;ee++){const ie=b[ee];l(ie,t,n,q,!!ie.dynamicChildren)}}},move:n0,hydrate:IR};function n0(e,t,n,{o:{insert:l},m:h},d=2){d===0&&l(e.targetAnchor,t,n);const{el:g,anchor:b,shapeFlag:r,children:C,props:O}=e,U=d===2;if(U&&l(g,t,n),(!U||J_(O))&&r&16)for(let $=0;$<C.length;$++)h(C[$],t,n,2);U&&l(b,t,n)}function IR(e,t,n,l,h,d,{o:{nextSibling:g,parentNode:b,querySelector:r,insert:C,createText:O}},U){const $=t.target=tw(t.props,r);if($){const q=J_(t.props),ee=$._lpa||$.firstChild;if(t.shapeFlag&16)if(q)t.anchor=U(g(e),t,b(e),n,l,h,d),t.targetStart=ee,t.targetAnchor=ee&&g(ee);else{t.anchor=g(e);let ie=ee;for(;ie;){if(ie&&ie.nodeType===8){if(ie.data==="teleport start anchor")t.targetStart=ie;else if(ie.data==="teleport anchor"){t.targetAnchor=ie,$._lpa=t.targetAnchor&&g(t.targetAnchor);break}}ie=g(ie)}t.targetAnchor||yk($,t,O,C),U(ee&&g(ee),t,$,n,l,h,d)}C0(t,q)}return t.anchor&&g(t.anchor)}const PR=_k;function C0(e,t){const n=e.ctx;if(n&&n.ut){let l,h;for(t?(l=e.el,h=e.anchor):(l=e.targetStart,h=e.targetAnchor);l&&l!==h;)l.nodeType===1&&l.setAttribute("data-v-owner",n.uid),l=l.nextSibling;n.ut()}}function yk(e,t,n,l){const h=t.targetStart=n(""),d=t.targetAnchor=n("");return h[mk]=d,e&&(l(h,e),l(d,e)),d}const wd=Symbol("_leaveCb"),s0=Symbol("_enterCb");function lT(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return nl(()=>{e.isMounted=!0}),Tg(()=>{e.isUnmounting=!0}),e}const vl=[Function,Array],cT={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:vl,onEnter:vl,onAfterEnter:vl,onEnterCancelled:vl,onBeforeLeave:vl,onLeave:vl,onAfterLeave:vl,onLeaveCancelled:vl,onBeforeAppear:vl,onAppear:vl,onAfterAppear:vl,onAppearCancelled:vl},xk=e=>{const t=e.subTree;return t.component?xk(t.component):t},LR={name:"BaseTransition",props:cT,setup(e,{slots:t}){const n=lo(),l=lT();return()=>{const h=t.default&&Av(t.default(),!0);if(!h||!h.length)return;const d=vk(h),g=Sn(e),{mode:b}=g;if(l.isLeaving)return g1(d);const r=yS(d);if(!r)return g1(d);let C=cg(r,g,l,n,U=>C=U);r.type!==Lr&&lu(r,C);let O=n.subTree&&yS(n.subTree);if(O&&O.type!==Lr&&!nc(r,O)&&xk(n).type!==Lr){let U=cg(O,g,l,n);if(lu(O,U),b==="out-in"&&r.type!==Lr)return l.isLeaving=!0,U.afterLeave=()=>{l.isLeaving=!1,n.job.flags&8||n.update(),delete U.afterLeave,O=void 0},g1(d);b==="in-out"&&r.type!==Lr?U.delayLeave=($,q,ee)=>{const ie=wk(l,O);ie[String(O.key)]=O,$[wd]=()=>{q(),$[wd]=void 0,delete C.delayedLeave,O=void 0},C.delayedLeave=()=>{ee(),delete C.delayedLeave,O=void 0}}:O=void 0}else O&&(O=void 0);return d}}};function vk(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==Lr){t=n;break}}return t}const bk=LR;function wk(e,t){const{leavingVNodes:n}=e;let l=n.get(t.type);return l||(l=Object.create(null),n.set(t.type,l)),l}function cg(e,t,n,l,h){const{appear:d,mode:g,persisted:b=!1,onBeforeEnter:r,onEnter:C,onAfterEnter:O,onEnterCancelled:U,onBeforeLeave:$,onLeave:q,onAfterLeave:ee,onLeaveCancelled:ie,onBeforeAppear:de,onAppear:ye,onAfterAppear:be,onAppearCancelled:se}=t,he=String(e.key),fe=wk(n,e),Me=(Ue,Ne)=>{Ue&&Ml(Ue,l,9,Ne)},ze=(Ue,Ne)=>{const it=Ne[1];Me(Ue,Ne),Ri(Ue)?Ue.every(Qe=>Qe.length<=1)&&it():Ue.length<=1&&it()},ve={mode:g,persisted:b,beforeEnter(Ue){let Ne=r;if(!n.isMounted)if(d)Ne=de||r;else return;Ue[wd]&&Ue[wd](!0);const it=fe[he];it&&nc(e,it)&&it.el[wd]&&it.el[wd](),Me(Ne,[Ue])},enter(Ue){let Ne=C,it=O,Qe=U;if(!n.isMounted)if(d)Ne=ye||C,it=be||O,Qe=se||U;else return;let Xe=!1;const Tt=Ue[s0]=Rt=>{Xe||(Xe=!0,Rt?Me(Qe,[Ue]):Me(it,[Ue]),ve.delayedLeave&&ve.delayedLeave(),Ue[s0]=void 0)};Ne?ze(Ne,[Ue,Tt]):Tt()},leave(Ue,Ne){const it=String(e.key);if(Ue[s0]&&Ue[s0](!0),n.isUnmounting)return Ne();Me($,[Ue]);let Qe=!1;const Xe=Ue[wd]=Tt=>{Qe||(Qe=!0,Ne(),Tt?Me(ie,[Ue]):Me(ee,[Ue]),Ue[wd]=void 0,fe[it]===e&&delete fe[it])};fe[it]=e,q?ze(q,[Ue,Xe]):Xe()},clone(Ue){const Ne=cg(Ue,t,n,l,h);return h&&h(Ne),Ne}};return ve}function g1(e){if(Fy(e))return e=ch(e),e.children=null,e}function yS(e){if(!Fy(e))return gk(e.type)&&e.children?vk(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&on(n.default))return n.default()}}function lu(e,t){e.shapeFlag&6&&e.component?(e.transition=t,lu(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Av(e,t=!1,n){let l=[],h=0;for(let d=0;d<e.length;d++){let g=e[d];const b=n==null?g.key:String(n)+String(g.key!=null?g.key:d);g.type===Dn?(g.patchFlag&128&&h++,l=l.concat(Av(g.children,t,b))):(t||g.type!==Lr)&&l.push(b!=null?ch(g,{key:b}):g)}if(h>1)for(let d=0;d<l.length;d++)l[d].patchFlag=-2;return l}/*! #__NO_SIDE_EFFECTS__ */function gs(e,t){return on(e)?Ls({name:e.name},t,{setup:e}):e}function DR(){const e=lo();return e?(e.appContext.config.idPrefix||"v")+"-"+e.ids[0]+e.ids[1]++:""}function hT(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function OR(e){const t=lo(),n=Dp(null);if(t){const h=t.refs===Hn?t.refs={}:t.refs;Object.defineProperty(h,e,{enumerable:!0,get:()=>n.value,set:d=>n.value=d})}return n}function gy(e,t,n,l,h=!1){if(Ri(e)){e.forEach((ee,ie)=>gy(ee,t&&(Ri(t)?t[ie]:t),n,l,h));return}if(Ad(l)&&!h){l.shapeFlag&512&&l.type.__asyncResolved&&l.component.subTree.component&&gy(e,t,n,l.component.subTree);return}const d=l.shapeFlag&4?Vy(l.component):l.el,g=h?null:d,{i:b,r}=e,C=t&&t.r,O=b.refs===Hn?b.refs={}:b.refs,U=b.setupState,$=Sn(U),q=U===Hn?()=>!1:ee=>cs($,ee);if(C!=null&&C!==r&&(Vs(C)?(O[C]=null,q(C)&&(U[C]=null)):Zs(C)&&(C.value=null)),on(r))wg(r,b,12,[g,O]);else{const ee=Vs(r),ie=Zs(r);if(ee||ie){const de=()=>{if(e.f){const ye=ee?q(r)?U[r]:O[r]:r.value;h?Ri(ye)&&Yw(ye,d):Ri(ye)?ye.includes(d)||ye.push(d):ee?(O[r]=[d],q(r)&&(U[r]=O[r])):(r.value=[d],e.k&&(O[e.k]=r.value))}else ee?(O[r]=g,q(r)&&(U[r]=g)):ie&&(r.value=g,e.k&&(O[e.k]=g))};g?(de.id=-1,Fr(de,n)):de()}}}let xS=!1;const $m=()=>{xS||(console.error("Hydration completed but contains mismatches."),xS=!0)},RR=e=>e.namespaceURI.includes("svg")&&e.tagName!=="foreignObject",zR=e=>e.namespaceURI.includes("MathML"),r0=e=>{if(e.nodeType===1){if(RR(e))return"svg";if(zR(e))return"mathml"}},Qm=e=>e.nodeType===8;function BR(e){const{mt:t,p:n,o:{patchProp:l,createText:h,nextSibling:d,parentNode:g,remove:b,insert:r,createComment:C}}=e,O=(se,he)=>{if(!he.hasChildNodes()){n(null,se,he),q0(),he._vnode=se;return}U(he.firstChild,se,null,null,null),q0(),he._vnode=se},U=(se,he,fe,Me,ze,ve=!1)=>{ve=ve||!!he.dynamicChildren;const Ue=Qm(se)&&se.data==="[",Ne=()=>ie(se,he,fe,Me,ze,Ue),{type:it,ref:Qe,shapeFlag:Xe,patchFlag:Tt}=he;let Rt=se.nodeType;he.el=se,Tt===-2&&(ve=!1,he.dynamicChildren=null);let St=null;switch(it){case ou:Rt!==3?he.children===""?(r(he.el=h(""),g(se),se),St=se):St=Ne():(se.data!==he.children&&($m(),se.data=he.children),St=d(se));break;case Lr:be(se)?(St=d(se),ye(he.el=se.content.firstChild,se,fe)):Rt!==8||Ue?St=Ne():St=d(se);break;case Tp:if(Ue&&(se=d(se),Rt=se.nodeType),Rt===1||Rt===3){St=se;const Pt=!he.children.length;for(let oi=0;oi<he.staticCount;oi++)Pt&&(he.children+=St.nodeType===1?St.outerHTML:St.data),oi===he.staticCount-1&&(he.anchor=St),St=d(St);return Ue?d(St):St}else Ne();break;case Dn:Ue?St=ee(se,he,fe,Me,ze,ve):St=Ne();break;default:if(Xe&1)(Rt!==1||he.type.toLowerCase()!==se.tagName.toLowerCase())&&!be(se)?St=Ne():St=$(se,he,fe,Me,ze,ve);else if(Xe&6){he.slotScopeIds=ze;const Pt=g(se);if(Ue?St=de(se):Qm(se)&&se.data==="teleport start"?St=de(se,se.data,"teleport end"):St=d(se),t(he,Pt,null,fe,Me,r0(Pt),ve),Ad(he)&&!he.type.__asyncResolved){let oi;Ue?(oi=gn(Dn),oi.anchor=St?St.previousSibling:Pt.lastChild):oi=se.nodeType===3?fr(""):gn("div"),oi.el=se,he.component.subTree=oi}}else Xe&64?Rt!==8?St=Ne():St=he.type.hydrate(se,he,fe,Me,ze,ve,e,q):Xe&128&&(St=he.type.hydrate(se,he,fe,Me,r0(g(se)),ze,ve,e,U))}return Qe!=null&&gy(Qe,null,Me,he),St},$=(se,he,fe,Me,ze,ve)=>{ve=ve||!!he.dynamicChildren;const{type:Ue,props:Ne,patchFlag:it,shapeFlag:Qe,dirs:Xe,transition:Tt}=he,Rt=Ue==="input"||Ue==="option";if(Rt||it!==-1){Xe&&nh(he,null,fe,"created");let St=!1;if(be(se)){St=Xk(null,Tt)&&fe&&fe.vnode.props&&fe.vnode.props.appear;const oi=se.content.firstChild;St&&Tt.beforeEnter(oi),ye(oi,se,fe),he.el=se=oi}if(Qe&16&&!(Ne&&(Ne.innerHTML||Ne.textContent))){let oi=q(se.firstChild,he,se,fe,Me,ze,ve);for(;oi;){o0(se,1)||$m();const ci=oi;oi=oi.nextSibling,b(ci)}}else if(Qe&8){let oi=he.children;oi[0]===`
`&&(se.tagName==="PRE"||se.tagName==="TEXTAREA")&&(oi=oi.slice(1)),se.textContent!==oi&&(o0(se,0)||$m(),se.textContent=he.children)}if(Ne){if(Rt||!ve||it&48){const oi=se.tagName.includes("-");for(const ci in Ne)(Rt&&(ci.endsWith("value")||ci==="indeterminate")||zy(ci)&&!ng(ci)||ci[0]==="."||oi)&&l(se,ci,null,Ne[ci],void 0,fe)}else if(Ne.onClick)l(se,"onClick",null,Ne.onClick,void 0,fe);else if(it&4&&lc(Ne.style))for(const oi in Ne.style)Ne.style[oi]}let Pt;(Pt=Ne&&Ne.onVnodeBeforeMount)&&Ea(Pt,fe,he),Xe&&nh(he,null,fe,"beforeMount"),((Pt=Ne&&Ne.onVnodeMounted)||Xe||St)&&nI(()=>{Pt&&Ea(Pt,fe,he),St&&Tt.enter(se),Xe&&nh(he,null,fe,"mounted")},Me)}return se.nextSibling},q=(se,he,fe,Me,ze,ve,Ue)=>{Ue=Ue||!!he.dynamicChildren;const Ne=he.children,it=Ne.length;for(let Qe=0;Qe<it;Qe++){const Xe=Ue?Ne[Qe]:Ne[Qe]=Sa(Ne[Qe]),Tt=Xe.type===ou;se?(Tt&&!Ue&&Qe+1<it&&Sa(Ne[Qe+1]).type===ou&&(r(h(se.data.slice(Xe.children.length)),fe,d(se)),se.data=Xe.children),se=U(se,Xe,Me,ze,ve,Ue)):Tt&&!Xe.children?r(Xe.el=h(""),fe):(o0(fe,1)||$m(),n(null,Xe,fe,null,Me,ze,r0(fe),ve))}return se},ee=(se,he,fe,Me,ze,ve)=>{const{slotScopeIds:Ue}=he;Ue&&(ze=ze?ze.concat(Ue):Ue);const Ne=g(se),it=q(d(se),he,Ne,fe,Me,ze,ve);return it&&Qm(it)&&it.data==="]"?d(he.anchor=it):($m(),r(he.anchor=C("]"),Ne,it),it)},ie=(se,he,fe,Me,ze,ve)=>{if(o0(se.parentElement,1)||$m(),he.el=null,ve){const it=de(se);for(;;){const Qe=d(se);if(Qe&&Qe!==it)b(Qe);else break}}const Ue=d(se),Ne=g(se);return b(se),n(null,he,Ne,Ue,fe,Me,r0(Ne),ze),fe&&(fe.vnode.el=he.el,Dv(fe,he.el)),Ue},de=(se,he="[",fe="]")=>{let Me=0;for(;se;)if(se=d(se),se&&Qm(se)&&(se.data===he&&Me++,se.data===fe)){if(Me===0)return d(se);Me--}return se},ye=(se,he,fe)=>{const Me=he.parentNode;Me&&Me.replaceChild(se,he);let ze=fe;for(;ze;)ze.vnode.el===he&&(ze.vnode.el=ze.subTree.el=se),ze=ze.parent},be=se=>se.nodeType===1&&se.tagName==="TEMPLATE";return[O,U]}const vS="data-allow-mismatch",FR={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function o0(e,t){if(t===0||t===1)for(;e&&!e.hasAttribute(vS);)e=e.parentElement;const n=e&&e.getAttribute(vS);if(n==null)return!1;if(n==="")return!0;{const l=n.split(",");return t===0&&l.includes("children")?!0:n.split(",").includes(FR[t])}}const NR=xv().requestIdleCallback||(e=>setTimeout(e,1)),UR=xv().cancelIdleCallback||(e=>clearTimeout(e)),VR=(e=1e4)=>t=>{const n=NR(t,{timeout:e});return()=>UR(n)};function jR(e){const{top:t,left:n,bottom:l,right:h}=e.getBoundingClientRect(),{innerHeight:d,innerWidth:g}=window;return(t>0&&t<d||l>0&&l<d)&&(n>0&&n<g||h>0&&h<g)}const $R=e=>(t,n)=>{const l=new IntersectionObserver(h=>{for(const d of h)if(d.isIntersecting){l.disconnect(),t();break}},e);return n(h=>{if(h instanceof Element){if(jR(h))return t(),l.disconnect(),!1;l.observe(h)}}),()=>l.disconnect()},WR=e=>t=>{if(e){const n=matchMedia(e);if(n.matches)t();else return n.addEventListener("change",t,{once:!0}),()=>n.removeEventListener("change",t)}},GR=(e=[])=>(t,n)=>{Vs(e)&&(e=[e]);let l=!1;const h=g=>{l||(l=!0,d(),t(),g.target.dispatchEvent(new g.constructor(g.type,g)))},d=()=>{n(g=>{for(const b of e)g.removeEventListener(b,h)})};return n(g=>{for(const b of e)g.addEventListener(b,h,{once:!0})}),d};function HR(e,t){if(Qm(e)&&e.data==="["){let n=1,l=e.nextSibling;for(;l;){if(l.nodeType===1){if(t(l)===!1)break}else if(Qm(l))if(l.data==="]"){if(--n===0)break}else l.data==="["&&n++;l=l.nextSibling}}else t(e)}const Ad=e=>!!e.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function qR(e){on(e)&&(e={loader:e});const{loader:t,loadingComponent:n,errorComponent:l,delay:h=200,hydrate:d,timeout:g,suspensible:b=!0,onError:r}=e;let C=null,O,U=0;const $=()=>(U++,C=null,q()),q=()=>{let ee;return C||(ee=C=t().catch(ie=>{if(ie=ie instanceof Error?ie:new Error(String(ie)),r)return new Promise((de,ye)=>{r(ie,()=>de($()),()=>ye(ie),U+1)});throw ie}).then(ie=>ee!==C&&C?C:(ie&&(ie.__esModule||ie[Symbol.toStringTag]==="Module")&&(ie=ie.default),O=ie,ie)))};return gs({name:"AsyncComponentWrapper",__asyncLoader:q,__asyncHydrate(ee,ie,de){const ye=d?()=>{const be=d(de,se=>HR(ee,se));be&&(ie.bum||(ie.bum=[])).push(be)}:de;O?ye():q().then(()=>!ie.isUnmounted&&ye())},get __asyncResolved(){return O},setup(){const ee=Nr;if(hT(ee),O)return()=>_1(O,ee);const ie=se=>{C=null,Op(se,ee,13,!l)};if(b&&ee.suspense||hg)return q().then(se=>()=>_1(se,ee)).catch(se=>(ie(se),()=>l?gn(l,{error:se}):null));const de=Vi(!1),ye=Vi(),be=Vi(!!h);return h&&setTimeout(()=>{be.value=!1},h),g!=null&&setTimeout(()=>{if(!de.value&&!ye.value){const se=new Error(`Async component timed out after ${g}ms.`);ie(se),ye.value=se}},g),q().then(()=>{de.value=!0,ee.parent&&Fy(ee.parent.vnode)&&ee.parent.update()}).catch(se=>{ie(se),ye.value=se}),()=>{if(de.value&&O)return _1(O,ee);if(ye.value&&l)return gn(l,{error:ye.value});if(n&&!be.value)return gn(n)}}})}function _1(e,t){const{ref:n,props:l,children:h,ce:d}=t.vnode,g=gn(e,l,h);return g.ref=n,g.ce=d,delete t.vnode.ce,g}const Fy=e=>e.type.__isKeepAlive,XR={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=lo(),l=n.ctx;if(!l.renderer)return()=>{const be=t.default&&t.default();return be&&be.length===1?be[0]:be};const h=new Map,d=new Set;let g=null;const b=n.suspense,{renderer:{p:r,m:C,um:O,o:{createElement:U}}}=l,$=U("div");l.activate=(be,se,he,fe,Me)=>{const ze=be.component;C(be,se,he,0,b),r(ze.vnode,be,se,he,ze,b,fe,be.slotScopeIds,Me),Fr(()=>{ze.isDeactivated=!1,ze.a&&sg(ze.a);const ve=be.props&&be.props.onVnodeMounted;ve&&Ea(ve,ze.parent,be)},b)},l.deactivate=be=>{const se=be.component;Z0(se.m),Z0(se.a),C(be,$,null,1,b),Fr(()=>{se.da&&sg(se.da);const he=be.props&&be.props.onVnodeUnmounted;he&&Ea(he,se.parent,be),se.isDeactivated=!0},b)};function q(be){y1(be),O(be,n,b,!0)}function ee(be){h.forEach((se,he)=>{const fe=fw(se.type);fe&&!be(fe)&&ie(he)})}function ie(be){const se=h.get(be);se&&(!g||!nc(se,g))?q(se):g&&y1(g),h.delete(be),d.delete(be)}eo(()=>[e.include,e.exclude],([be,se])=>{be&&ee(he=>j_(be,he)),se&&ee(he=>!j_(se,he))},{flush:"post",deep:!0});let de=null;const ye=()=>{de!=null&&(Y0(n.subTree.type)?Fr(()=>{h.set(de,a0(n.subTree))},n.subTree.suspense):h.set(de,a0(n.subTree)))};return nl(ye),Iv(ye),Tg(()=>{h.forEach(be=>{const{subTree:se,suspense:he}=n,fe=a0(se);if(be.type===fe.type&&be.key===fe.key){y1(fe);const Me=fe.component.da;Me&&Fr(Me,he);return}q(be)})}),()=>{if(de=null,!t.default)return g=null;const be=t.default(),se=be[0];if(be.length>1)return g=null,be;if(!cu(se)||!(se.shapeFlag&4)&&!(se.shapeFlag&128))return g=null,se;let he=a0(se);if(he.type===Lr)return g=null,he;const fe=he.type,Me=fw(Ad(he)?he.type.__asyncResolved||{}:fe),{include:ze,exclude:ve,max:Ue}=e;if(ze&&(!Me||!j_(ze,Me))||ve&&Me&&j_(ve,Me))return he.shapeFlag&=-257,g=he,se;const Ne=he.key==null?fe:he.key,it=h.get(Ne);return he.el&&(he=ch(he),se.shapeFlag&128&&(se.ssContent=he)),de=Ne,it?(he.el=it.el,he.component=it.component,he.transition&&lu(he,he.transition),he.shapeFlag|=512,d.delete(Ne),d.add(Ne)):(d.add(Ne),Ue&&d.size>parseInt(Ue,10)&&ie(d.values().next().value)),he.shapeFlag|=256,g=he,Y0(se.type)?se:he}}},ZR=XR;function j_(e,t){return Ri(e)?e.some(n=>j_(n,t)):Vs(e)?e.split(",").includes(t):SO(e)?(e.lastIndex=0,e.test(t)):!1}function Tk(e,t){Sk(e,"a",t)}function Ek(e,t){Sk(e,"da",t)}function Sk(e,t,n=Nr){const l=e.__wdc||(e.__wdc=()=>{let h=n;for(;h;){if(h.isDeactivated)return;h=h.parent}return e()});if(kv(t,l,n),n){let h=n.parent;for(;h&&h.parent;)Fy(h.parent.vnode)&&YR(l,t,n,h),h=h.parent}}function YR(e,t,n,l){const h=kv(t,e,l,!0);Eg(()=>{Yw(l[t],h)},n)}function y1(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function a0(e){return e.shapeFlag&128?e.ssContent:e}function kv(e,t,n=Nr,l=!1){if(n){const h=n[e]||(n[e]=[]),d=t.__weh||(t.__weh=(...g)=>{zd();const b=Ap(n),r=Ml(t,n,e,g);return b(),Bd(),r});return l?h.unshift(d):h.push(d),d}}const uu=e=>(t,n=Nr)=>{(!hg||e==="sp")&&kv(e,(...l)=>t(...l),n)},uT=uu("bm"),nl=uu("m"),dT=uu("bu"),Iv=uu("u"),Tg=uu("bum"),Eg=uu("um"),Mk=uu("sp"),Ck=uu("rtg"),Ak=uu("rtc");function kk(e,t=Nr){kv("ec",e,t)}const fT="components",KR="directives";function rh(e,t){return pT(fT,e,!0,t)||e}const Ik=Symbol.for("v-ndc");function Pv(e){return Vs(e)?pT(fT,e,!1)||e:e||Ik}function JR(e){return pT(KR,e)}function pT(e,t,n=!0,l=!1){const h=Ur||Nr;if(h){const d=h.type;if(e===fT){const b=fw(d,!1);if(b&&(b===t||b===oo(t)||b===By(oo(t))))return d}const g=bS(h[e]||d[e],t)||bS(h.appContext[e],t);return!g&&l?d:g}}function bS(e,t){return e&&(e[t]||e[oo(t)]||e[By(oo(t))])}function ta(e,t,n,l){let h;const d=n&&n[l],g=Ri(e);if(g||Vs(e)){const b=g&&lc(e);let r=!1;b&&(r=!tl(e),e=Tv(e)),h=new Array(e.length);for(let C=0,O=e.length;C<O;C++)h[C]=t(r?Ao(e[C]):e[C],C,void 0,d&&d[C])}else if(typeof e=="number"){h=new Array(e);for(let b=0;b<e;b++)h[b]=t(b+1,b,void 0,d&&d[b])}else if(Ms(e))if(e[Symbol.iterator])h=Array.from(e,(b,r)=>t(b,r,void 0,d&&d[r]));else{const b=Object.keys(e);h=new Array(b.length);for(let r=0,C=b.length;r<C;r++){const O=b[r];h[r]=t(e[O],O,r,d&&d[r])}}else h=[];return n&&(n[l]=h),h}function QR(e,t){for(let n=0;n<t.length;n++){const l=t[n];if(Ri(l))for(let h=0;h<l.length;h++)e[l[h].name]=l[h].fn;else l&&(e[l.name]=l.key?(...h)=>{const d=l.fn(...h);return d&&(d.key=l.key),d}:l.fn)}return e}function Pk(e,t,n={},l,h){if(Ur.ce||Ur.parent&&Ad(Ur.parent)&&Ur.parent.ce)return t!=="default"&&(n.name=t),ui(),Qr(Dn,null,[gn("slot",n,l&&l())],64);let d=e[t];d&&d._c&&(d._d=!1),ui();const g=d&&mT(d(n)),b=n.key||g&&g.key,r=Qr(Dn,{key:(b&&!cc(b)?b:`_${t}`)+(!g&&l?"_fb":"")},g||(l?l():[]),g&&e._===1?64:-2);return!h&&r.scopeId&&(r.slotScopeIds=[r.scopeId+"-s"]),d&&d._c&&(d._d=!0),r}function mT(e){return e.some(t=>cu(t)?!(t.type===Lr||t.type===Dn&&!mT(t.children)):!0)?e:null}function Lk(e,t){const n={};for(const l in e)n[t&&/[A-Z]/.test(l)?`on:${l}`:Z_(l)]=e[l];return n}const iw=e=>e?cI(e)?Vy(e):iw(e.parent):null,Q_=Ls(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>iw(e.parent),$root:e=>iw(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>gT(e),$forceUpdate:e=>e.f||(e.f=()=>{aT(e.update)}),$nextTick:e=>e.n||(e.n=Fd.bind(e.proxy)),$watch:e=>Iz.bind(e)}),x1=(e,t)=>e!==Hn&&!e.__isScriptSetup&&cs(e,t),nw={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:l,data:h,props:d,accessCache:g,type:b,appContext:r}=e;let C;if(t[0]!=="$"){const q=g[t];if(q!==void 0)switch(q){case 1:return l[t];case 2:return h[t];case 4:return n[t];case 3:return d[t]}else{if(x1(l,t))return g[t]=1,l[t];if(h!==Hn&&cs(h,t))return g[t]=2,h[t];if((C=e.propsOptions[0])&&cs(C,t))return g[t]=3,d[t];if(n!==Hn&&cs(n,t))return g[t]=4,n[t];sw&&(g[t]=0)}}const O=Q_[t];let U,$;if(O)return t==="$attrs"&&Co(e.attrs,"get",""),O(e);if((U=b.__cssModules)&&(U=U[t]))return U;if(n!==Hn&&cs(n,t))return g[t]=4,n[t];if($=r.config.globalProperties,cs($,t))return $[t]},set({_:e},t,n){const{data:l,setupState:h,ctx:d}=e;return x1(h,t)?(h[t]=n,!0):l!==Hn&&cs(l,t)?(l[t]=n,!0):cs(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(d[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:l,appContext:h,propsOptions:d}},g){let b;return!!n[g]||e!==Hn&&cs(e,g)||x1(t,g)||(b=d[0])&&cs(b,g)||cs(l,g)||cs(Q_,g)||cs(h.config.globalProperties,g)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:cs(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}},ez=Ls({},nw,{get(e,t){if(t!==Symbol.unscopables)return nw.get(e,t,e)},has(e,t){return t[0]!=="_"&&!IO(t)}});function tz(){return null}function iz(){return null}function nz(e){}function sz(e){}function rz(){return null}function oz(){}function az(e,t){return null}function lz(){return Dk().slots}function cz(){return Dk().attrs}function Dk(){const e=lo();return e.setupContext||(e.setupContext=dI(e))}function _y(e){return Ri(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}function hz(e,t){const n=_y(e);for(const l in t){if(l.startsWith("__skip"))continue;let h=n[l];h?Ri(h)||on(h)?h=n[l]={type:h,default:t[l]}:h.default=t[l]:h===null&&(h=n[l]={default:t[l]}),h&&t[`__skip_${l}`]&&(h.skipFactory=!0)}return n}function uz(e,t){return!e||!t?e||t:Ri(e)&&Ri(t)?e.concat(t):Ls({},_y(e),_y(t))}function dz(e,t){const n={};for(const l in e)t.includes(l)||Object.defineProperty(n,l,{enumerable:!0,get:()=>e[l]});return n}function fz(e){const t=lo();let n=e();return hw(),Kw(n)&&(n=n.catch(l=>{throw Ap(t),l})),[n,()=>Ap(t)]}let sw=!0;function pz(e){const t=gT(e),n=e.proxy,l=e.ctx;sw=!1,t.beforeCreate&&wS(t.beforeCreate,e,"bc");const{data:h,computed:d,methods:g,watch:b,provide:r,inject:C,created:O,beforeMount:U,mounted:$,beforeUpdate:q,updated:ee,activated:ie,deactivated:de,beforeDestroy:ye,beforeUnmount:be,destroyed:se,unmounted:he,render:fe,renderTracked:Me,renderTriggered:ze,errorCaptured:ve,serverPrefetch:Ue,expose:Ne,inheritAttrs:it,components:Qe,directives:Xe,filters:Tt}=t;if(C&&mz(C,l,null),g)for(const Pt in g){const oi=g[Pt];on(oi)&&(l[Pt]=oi.bind(n))}if(h){const Pt=h.call(n,n);Ms(Pt)&&(e.data=vg(Pt))}if(sw=!0,d)for(const Pt in d){const oi=d[Pt],ci=on(oi)?oi.bind(n,n):on(oi.get)?oi.get.bind(n,n):El,pn=!on(oi)&&on(oi.set)?oi.set.bind(n):El,Ni=Fn({get:ci,set:pn});Object.defineProperty(l,Pt,{enumerable:!0,configurable:!0,get:()=>Ni.value,set:ji=>Ni.value=ji})}if(b)for(const Pt in b)Ok(b[Pt],l,n,Pt);if(r){const Pt=on(r)?r.call(n):r;Reflect.ownKeys(Pt).forEach(oi=>{ey(oi,Pt[oi])})}O&&wS(O,e,"c");function St(Pt,oi){Ri(oi)?oi.forEach(ci=>Pt(ci.bind(n))):oi&&Pt(oi.bind(n))}if(St(uT,U),St(nl,$),St(dT,q),St(Iv,ee),St(Tk,ie),St(Ek,de),St(kk,ve),St(Ak,Me),St(Ck,ze),St(Tg,be),St(Eg,he),St(Mk,Ue),Ri(Ne))if(Ne.length){const Pt=e.exposed||(e.exposed={});Ne.forEach(oi=>{Object.defineProperty(Pt,oi,{get:()=>n[oi],set:ci=>n[oi]=ci})})}else e.exposed||(e.exposed={});fe&&e.render===El&&(e.render=fe),it!=null&&(e.inheritAttrs=it),Qe&&(e.components=Qe),Xe&&(e.directives=Xe),Ue&&hT(e)}function mz(e,t,n=El){Ri(e)&&(e=rw(e));for(const l in e){const h=e[l];let d;Ms(h)?"default"in h?d=ia(h.from||l,h.default,!0):d=ia(h.from||l):d=ia(h),Zs(d)?Object.defineProperty(t,l,{enumerable:!0,configurable:!0,get:()=>d.value,set:g=>d.value=g}):t[l]=d}}function wS(e,t,n){Ml(Ri(e)?e.map(l=>l.bind(t.proxy)):e.bind(t.proxy),t,n)}function Ok(e,t,n,l){let h=l.includes(".")?Qk(n,l):()=>n[l];if(Vs(e)){const d=t[e];on(d)&&eo(h,d)}else if(on(e))eo(h,e.bind(n));else if(Ms(e))if(Ri(e))e.forEach(d=>Ok(d,t,n,l));else{const d=on(e.handler)?e.handler.bind(n):t[e.handler];on(d)&&eo(h,d,e)}}function gT(e){const t=e.type,{mixins:n,extends:l}=t,{mixins:h,optionsCache:d,config:{optionMergeStrategies:g}}=e.appContext,b=d.get(t);let r;return b?r=b:!h.length&&!n&&!l?r=t:(r={},h.length&&h.forEach(C=>X0(r,C,g,!0)),X0(r,t,g)),Ms(t)&&d.set(t,r),r}function X0(e,t,n,l=!1){const{mixins:h,extends:d}=t;d&&X0(e,d,n,!0),h&&h.forEach(g=>X0(e,g,n,!0));for(const g in t)if(!(l&&g==="expose")){const b=gz[g]||n&&n[g];e[g]=b?b(e[g],t[g]):t[g]}return e}const gz={data:TS,props:ES,emits:ES,methods:$_,computed:$_,beforeCreate:Yo,created:Yo,beforeMount:Yo,mounted:Yo,beforeUpdate:Yo,updated:Yo,beforeDestroy:Yo,beforeUnmount:Yo,destroyed:Yo,unmounted:Yo,activated:Yo,deactivated:Yo,errorCaptured:Yo,serverPrefetch:Yo,components:$_,directives:$_,watch:yz,provide:TS,inject:_z};function TS(e,t){return t?e?function(){return Ls(on(e)?e.call(this,this):e,on(t)?t.call(this,this):t)}:t:e}function _z(e,t){return $_(rw(e),rw(t))}function rw(e){if(Ri(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Yo(e,t){return e?[...new Set([].concat(e,t))]:t}function $_(e,t){return e?Ls(Object.create(null),e,t):t}function ES(e,t){return e?Ri(e)&&Ri(t)?[...new Set([...e,...t])]:Ls(Object.create(null),_y(e),_y(t??{})):t}function yz(e,t){if(!e)return t;if(!t)return e;const n=Ls(Object.create(null),e);for(const l in t)n[l]=Yo(e[l],t[l]);return n}function Rk(){return{app:null,config:{isNativeTag:TO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let xz=0;function vz(e,t){return function(l,h=null){on(l)||(l=Ls({},l)),h!=null&&!Ms(h)&&(h=null);const d=Rk(),g=new WeakSet,b=[];let r=!1;const C=d.app={_uid:xz++,_component:l,_props:h,_container:null,_context:d,_instance:null,version:bT,get config(){return d.config},set config(O){},use(O,...U){return g.has(O)||(O&&on(O.install)?(g.add(O),O.install(C,...U)):on(O)&&(g.add(O),O(C,...U))),C},mixin(O){return d.mixins.includes(O)||d.mixins.push(O),C},component(O,U){return U?(d.components[O]=U,C):d.components[O]},directive(O,U){return U?(d.directives[O]=U,C):d.directives[O]},mount(O,U,$){if(!r){const q=C._ceVNode||gn(l,h);return q.appContext=d,$===!0?$="svg":$===!1&&($=void 0),U&&t?t(q,O):e(q,O,$),r=!0,C._container=O,O.__vue_app__=C,Vy(q.component)}},onUnmount(O){b.push(O)},unmount(){r&&(Ml(b,C._instance,16),e(null,C._container),delete C._container.__vue_app__)},provide(O,U){return d.provides[O]=U,C},runWithContext(O){const U=wp;wp=C;try{return O()}finally{wp=U}}};return C}}let wp=null;function ey(e,t){if(Nr){let n=Nr.provides;const l=Nr.parent&&Nr.parent.provides;l===n&&(n=Nr.provides=Object.create(l)),n[e]=t}}function ia(e,t,n=!1){const l=Nr||Ur;if(l||wp){const h=wp?wp._context.provides:l?l.parent==null?l.vnode.appContext&&l.vnode.appContext.provides:l.parent.provides:void 0;if(h&&e in h)return h[e];if(arguments.length>1)return n&&on(t)?t.call(l&&l.proxy):t}}function _T(){return!!(Nr||Ur||wp)}const zk={},Bk=()=>Object.create(zk),Fk=e=>Object.getPrototypeOf(e)===zk;function bz(e,t,n,l=!1){const h={},d=Bk();e.propsDefaults=Object.create(null),Nk(e,t,h,d);for(const g in e.propsOptions[0])g in h||(h[g]=void 0);n?e.props=l?h:sT(h):e.type.props?e.props=h:e.props=d,e.attrs=d}function wz(e,t,n,l){const{props:h,attrs:d,vnode:{patchFlag:g}}=e,b=Sn(h),[r]=e.propsOptions;let C=!1;if((l||g>0)&&!(g&16)){if(g&8){const O=e.vnode.dynamicProps;for(let U=0;U<O.length;U++){let $=O[U];if(Lv(e.emitsOptions,$))continue;const q=t[$];if(r)if(cs(d,$))q!==d[$]&&(d[$]=q,C=!0);else{const ee=oo($);h[ee]=ow(r,b,ee,q,e,!1)}else q!==d[$]&&(d[$]=q,C=!0)}}}else{Nk(e,t,h,d)&&(C=!0);let O;for(const U in b)(!t||!cs(t,U)&&((O=Ma(U))===U||!cs(t,O)))&&(r?n&&(n[U]!==void 0||n[O]!==void 0)&&(h[U]=ow(r,b,U,void 0,e,!0)):delete h[U]);if(d!==b)for(const U in d)(!t||!cs(t,U))&&(delete d[U],C=!0)}C&&eu(e.attrs,"set","")}function Nk(e,t,n,l){const[h,d]=e.propsOptions;let g=!1,b;if(t)for(let r in t){if(ng(r))continue;const C=t[r];let O;h&&cs(h,O=oo(r))?!d||!d.includes(O)?n[O]=C:(b||(b={}))[O]=C:Lv(e.emitsOptions,r)||(!(r in l)||C!==l[r])&&(l[r]=C,g=!0)}if(d){const r=Sn(n),C=b||Hn;for(let O=0;O<d.length;O++){const U=d[O];n[U]=ow(h,r,U,C[U],e,!cs(C,U))}}return g}function ow(e,t,n,l,h,d){const g=e[n];if(g!=null){const b=cs(g,"default");if(b&&l===void 0){const r=g.default;if(g.type!==Function&&!g.skipFactory&&on(r)){const{propsDefaults:C}=h;if(n in C)l=C[n];else{const O=Ap(h);l=C[n]=r.call(null,t),O()}}else l=r;h.ce&&h.ce._setProp(n,l)}g[0]&&(d&&!b?l=!1:g[1]&&(l===""||l===Ma(n))&&(l=!0))}return l}const Tz=new WeakMap;function Uk(e,t,n=!1){const l=n?Tz:t.propsCache,h=l.get(e);if(h)return h;const d=e.props,g={},b=[];let r=!1;if(!on(e)){const O=U=>{r=!0;const[$,q]=Uk(U,t,!0);Ls(g,$),q&&b.push(...q)};!n&&t.mixins.length&&t.mixins.forEach(O),e.extends&&O(e.extends),e.mixins&&e.mixins.forEach(O)}if(!d&&!r)return Ms(e)&&l.set(e,tg),tg;if(Ri(d))for(let O=0;O<d.length;O++){const U=oo(d[O]);SS(U)&&(g[U]=Hn)}else if(d)for(const O in d){const U=oo(O);if(SS(U)){const $=d[O],q=g[U]=Ri($)||on($)?{type:$}:Ls({},$),ee=q.type;let ie=!1,de=!0;if(Ri(ee))for(let ye=0;ye<ee.length;++ye){const be=ee[ye],se=on(be)&&be.name;if(se==="Boolean"){ie=!0;break}else se==="String"&&(de=!1)}else ie=on(ee)&&ee.name==="Boolean";q[0]=ie,q[1]=de,(ie||cs(q,"default"))&&b.push(U)}}const C=[g,b];return Ms(e)&&l.set(e,C),C}function SS(e){return e[0]!=="$"&&!ng(e)}const Vk=e=>e[0]==="_"||e==="$stable",yT=e=>Ri(e)?e.map(Sa):[Sa(e)],Ez=(e,t,n)=>{if(t._n)return t;const l=Kr((...h)=>yT(t(...h)),n);return l._c=!1,l},jk=(e,t,n)=>{const l=e._ctx;for(const h in e){if(Vk(h))continue;const d=e[h];if(on(d))t[h]=Ez(h,d,l);else if(d!=null){const g=yT(d);t[h]=()=>g}}},$k=(e,t)=>{const n=yT(t);e.slots.default=()=>n},Wk=(e,t,n)=>{for(const l in t)(n||l!=="_")&&(e[l]=t[l])},Sz=(e,t,n)=>{const l=e.slots=Bk();if(e.vnode.shapeFlag&32){const h=t._;h?(Wk(l,t,n),n&&FA(l,"_",h,!0)):jk(t,l)}else t&&$k(e,t)},Mz=(e,t,n)=>{const{vnode:l,slots:h}=e;let d=!0,g=Hn;if(l.shapeFlag&32){const b=t._;b?n&&b===1?d=!1:Wk(h,t,n):(d=!t.$stable,jk(t,h)),g=t}else t&&($k(e,t),g={default:1});if(d)for(const b in h)!Vk(b)&&g[b]==null&&delete h[b]},Fr=nI;function Gk(e){return qk(e)}function Hk(e){return qk(e,BR)}function qk(e,t){const n=xv();n.__VUE__=!0;const{insert:l,remove:h,patchProp:d,createElement:g,createText:b,createComment:r,setText:C,setElementText:O,parentNode:U,nextSibling:$,setScopeId:q=El,insertStaticContent:ee}=e,ie=(Ee,Ce,ct,Bt=null,Dt=null,ei=null,di=void 0,Ie=null,Oe=!!Ce.dynamicChildren)=>{if(Ee===Ce)return;Ee&&!nc(Ee,Ce)&&(Bt=nt(Ee),ji(Ee,Dt,ei,!0),Ee=null),Ce.patchFlag===-2&&(Oe=!1,Ce.dynamicChildren=null);const{type:rt,ref:Zt,shapeFlag:Yt}=Ce;switch(rt){case ou:de(Ee,Ce,ct,Bt);break;case Lr:ye(Ee,Ce,ct,Bt);break;case Tp:Ee==null&&be(Ce,ct,Bt,di);break;case Dn:Qe(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe);break;default:Yt&1?fe(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe):Yt&6?Xe(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe):(Yt&64||Yt&128)&&rt.process(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe,jt)}Zt!=null&&Dt&&gy(Zt,Ee&&Ee.ref,ei,Ce||Ee,!Ce)},de=(Ee,Ce,ct,Bt)=>{if(Ee==null)l(Ce.el=b(Ce.children),ct,Bt);else{const Dt=Ce.el=Ee.el;Ce.children!==Ee.children&&C(Dt,Ce.children)}},ye=(Ee,Ce,ct,Bt)=>{Ee==null?l(Ce.el=r(Ce.children||""),ct,Bt):Ce.el=Ee.el},be=(Ee,Ce,ct,Bt)=>{[Ee.el,Ee.anchor]=ee(Ee.children,Ce,ct,Bt,Ee.el,Ee.anchor)},se=({el:Ee,anchor:Ce},ct,Bt)=>{let Dt;for(;Ee&&Ee!==Ce;)Dt=$(Ee),l(Ee,ct,Bt),Ee=Dt;l(Ce,ct,Bt)},he=({el:Ee,anchor:Ce})=>{let ct;for(;Ee&&Ee!==Ce;)ct=$(Ee),h(Ee),Ee=ct;h(Ce)},fe=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe)=>{Ce.type==="svg"?di="svg":Ce.type==="math"&&(di="mathml"),Ee==null?Me(Ce,ct,Bt,Dt,ei,di,Ie,Oe):Ue(Ee,Ce,Dt,ei,di,Ie,Oe)},Me=(Ee,Ce,ct,Bt,Dt,ei,di,Ie)=>{let Oe,rt;const{props:Zt,shapeFlag:Yt,transition:ti,dirs:mt}=Ee;if(Oe=Ee.el=g(Ee.type,ei,Zt&&Zt.is,Zt),Yt&8?O(Oe,Ee.children):Yt&16&&ve(Ee.children,Oe,null,Bt,Dt,v1(Ee,ei),di,Ie),mt&&nh(Ee,null,Bt,"created"),ze(Oe,Ee,Ee.scopeId,di,Bt),Zt){for(const Ii in Zt)Ii!=="value"&&!ng(Ii)&&d(Oe,Ii,null,Zt[Ii],ei,Bt);"value"in Zt&&d(Oe,"value",null,Zt.value,ei),(rt=Zt.onVnodeBeforeMount)&&Ea(rt,Bt,Ee)}mt&&nh(Ee,null,Bt,"beforeMount");const zt=Xk(Dt,ti);zt&&ti.beforeEnter(Oe),l(Oe,Ce,ct),((rt=Zt&&Zt.onVnodeMounted)||zt||mt)&&Fr(()=>{rt&&Ea(rt,Bt,Ee),zt&&ti.enter(Oe),mt&&nh(Ee,null,Bt,"mounted")},Dt)},ze=(Ee,Ce,ct,Bt,Dt)=>{if(ct&&q(Ee,ct),Bt)for(let ei=0;ei<Bt.length;ei++)q(Ee,Bt[ei]);if(Dt){let ei=Dt.subTree;if(Ce===ei||Y0(ei.type)&&(ei.ssContent===Ce||ei.ssFallback===Ce)){const di=Dt.vnode;ze(Ee,di,di.scopeId,di.slotScopeIds,Dt.parent)}}},ve=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe=0)=>{for(let rt=Oe;rt<Ee.length;rt++){const Zt=Ee[rt]=Ie?Td(Ee[rt]):Sa(Ee[rt]);ie(null,Zt,Ce,ct,Bt,Dt,ei,di,Ie)}},Ue=(Ee,Ce,ct,Bt,Dt,ei,di)=>{const Ie=Ce.el=Ee.el;let{patchFlag:Oe,dynamicChildren:rt,dirs:Zt}=Ce;Oe|=Ee.patchFlag&16;const Yt=Ee.props||Hn,ti=Ce.props||Hn;let mt;if(ct&&lp(ct,!1),(mt=ti.onVnodeBeforeUpdate)&&Ea(mt,ct,Ce,Ee),Zt&&nh(Ce,Ee,ct,"beforeUpdate"),ct&&lp(ct,!0),(Yt.innerHTML&&ti.innerHTML==null||Yt.textContent&&ti.textContent==null)&&O(Ie,""),rt?Ne(Ee.dynamicChildren,rt,Ie,ct,Bt,v1(Ce,Dt),ei):di||oi(Ee,Ce,Ie,null,ct,Bt,v1(Ce,Dt),ei,!1),Oe>0){if(Oe&16)it(Ie,Yt,ti,ct,Dt);else if(Oe&2&&Yt.class!==ti.class&&d(Ie,"class",null,ti.class,Dt),Oe&4&&d(Ie,"style",Yt.style,ti.style,Dt),Oe&8){const zt=Ce.dynamicProps;for(let Ii=0;Ii<zt.length;Ii++){const Oi=zt[Ii],Kn=Yt[Oi],qn=ti[Oi];(qn!==Kn||Oi==="value")&&d(Ie,Oi,Kn,qn,Dt,ct)}}Oe&1&&Ee.children!==Ce.children&&O(Ie,Ce.children)}else!di&&rt==null&&it(Ie,Yt,ti,ct,Dt);((mt=ti.onVnodeUpdated)||Zt)&&Fr(()=>{mt&&Ea(mt,ct,Ce,Ee),Zt&&nh(Ce,Ee,ct,"updated")},Bt)},Ne=(Ee,Ce,ct,Bt,Dt,ei,di)=>{for(let Ie=0;Ie<Ce.length;Ie++){const Oe=Ee[Ie],rt=Ce[Ie],Zt=Oe.el&&(Oe.type===Dn||!nc(Oe,rt)||Oe.shapeFlag&70)?U(Oe.el):ct;ie(Oe,rt,Zt,null,Bt,Dt,ei,di,!0)}},it=(Ee,Ce,ct,Bt,Dt)=>{if(Ce!==ct){if(Ce!==Hn)for(const ei in Ce)!ng(ei)&&!(ei in ct)&&d(Ee,ei,Ce[ei],null,Dt,Bt);for(const ei in ct){if(ng(ei))continue;const di=ct[ei],Ie=Ce[ei];di!==Ie&&ei!=="value"&&d(Ee,ei,Ie,di,Dt,Bt)}"value"in ct&&d(Ee,"value",Ce.value,ct.value,Dt)}},Qe=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe)=>{const rt=Ce.el=Ee?Ee.el:b(""),Zt=Ce.anchor=Ee?Ee.anchor:b("");let{patchFlag:Yt,dynamicChildren:ti,slotScopeIds:mt}=Ce;mt&&(Ie=Ie?Ie.concat(mt):mt),Ee==null?(l(rt,ct,Bt),l(Zt,ct,Bt),ve(Ce.children||[],ct,Zt,Dt,ei,di,Ie,Oe)):Yt>0&&Yt&64&&ti&&Ee.dynamicChildren?(Ne(Ee.dynamicChildren,ti,ct,Dt,ei,di,Ie),(Ce.key!=null||Dt&&Ce===Dt.subTree)&&xT(Ee,Ce,!0)):oi(Ee,Ce,ct,Zt,Dt,ei,di,Ie,Oe)},Xe=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe)=>{Ce.slotScopeIds=Ie,Ee==null?Ce.shapeFlag&512?Dt.ctx.activate(Ce,ct,Bt,di,Oe):Tt(Ce,ct,Bt,Dt,ei,di,Oe):Rt(Ee,Ce,Oe)},Tt=(Ee,Ce,ct,Bt,Dt,ei,di)=>{const Ie=Ee.component=lI(Ee,Bt,Dt);if(Fy(Ee)&&(Ie.ctx.renderer=jt),hI(Ie,!1,di),Ie.asyncDep){if(Dt&&Dt.registerDep(Ie,St,di),!Ee.el){const Oe=Ie.subTree=gn(Lr);ye(null,Oe,Ce,ct)}}else St(Ie,Ee,Ce,ct,Dt,ei,di)},Rt=(Ee,Ce,ct)=>{const Bt=Ce.component=Ee.component;if(zz(Ee,Ce,ct))if(Bt.asyncDep&&!Bt.asyncResolved){Pt(Bt,Ce,ct);return}else Bt.next=Ce,Bt.update();else Ce.el=Ee.el,Bt.vnode=Ce},St=(Ee,Ce,ct,Bt,Dt,ei,di)=>{const Ie=()=>{if(Ee.isMounted){let{next:Yt,bu:ti,u:mt,parent:zt,vnode:Ii}=Ee;{const un=Zk(Ee);if(un){Yt&&(Yt.el=Ii.el,Pt(Ee,Yt,di)),un.asyncDep.then(()=>{Ee.isUnmounted||Ie()});return}}let Oi=Yt,Kn;lp(Ee,!1),Yt?(Yt.el=Ii.el,Pt(Ee,Yt,di)):Yt=Ii,ti&&sg(ti),(Kn=Yt.props&&Yt.props.onVnodeBeforeUpdate)&&Ea(Kn,zt,Yt,Ii),lp(Ee,!0);const qn=A0(Ee),_s=Ee.subTree;Ee.subTree=qn,ie(_s,qn,U(_s.el),nt(_s),Ee,Dt,ei),Yt.el=qn.el,Oi===null&&Dv(Ee,qn.el),mt&&Fr(mt,Dt),(Kn=Yt.props&&Yt.props.onVnodeUpdated)&&Fr(()=>Ea(Kn,zt,Yt,Ii),Dt)}else{let Yt;const{el:ti,props:mt}=Ce,{bm:zt,m:Ii,parent:Oi,root:Kn,type:qn}=Ee,_s=Ad(Ce);if(lp(Ee,!1),zt&&sg(zt),!_s&&(Yt=mt&&mt.onVnodeBeforeMount)&&Ea(Yt,Oi,Ce),lp(Ee,!0),ti&&ai){const un=()=>{Ee.subTree=A0(Ee),ai(ti,Ee.subTree,Ee,Dt,null)};_s&&qn.__asyncHydrate?qn.__asyncHydrate(ti,Ee,un):un()}else{Kn.ce&&Kn.ce._injectChildStyle(qn);const un=Ee.subTree=A0(Ee);ie(null,un,ct,Bt,Ee,Dt,ei),Ce.el=un.el}if(Ii&&Fr(Ii,Dt),!_s&&(Yt=mt&&mt.onVnodeMounted)){const un=Ce;Fr(()=>Ea(Yt,Oi,un),Dt)}(Ce.shapeFlag&256||Oi&&Ad(Oi.vnode)&&Oi.vnode.shapeFlag&256)&&Ee.a&&Fr(Ee.a,Dt),Ee.isMounted=!0,Ce=ct=Bt=null}};Ee.scope.on();const Oe=Ee.effect=new hy(Ie);Ee.scope.off();const rt=Ee.update=Oe.run.bind(Oe),Zt=Ee.job=Oe.runIfDirty.bind(Oe);Zt.i=Ee,Zt.id=Ee.uid,Oe.scheduler=()=>aT(Zt),lp(Ee,!0),rt()},Pt=(Ee,Ce,ct)=>{Ce.component=Ee;const Bt=Ee.vnode.props;Ee.vnode=Ce,Ee.next=null,wz(Ee,Ce.props,Bt,ct),Mz(Ee,Ce.children,ct),zd(),pS(Ee),Bd()},oi=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe=!1)=>{const rt=Ee&&Ee.children,Zt=Ee?Ee.shapeFlag:0,Yt=Ce.children,{patchFlag:ti,shapeFlag:mt}=Ce;if(ti>0){if(ti&128){pn(rt,Yt,ct,Bt,Dt,ei,di,Ie,Oe);return}else if(ti&256){ci(rt,Yt,ct,Bt,Dt,ei,di,Ie,Oe);return}}mt&8?(Zt&16&&wn(rt,Dt,ei),Yt!==rt&&O(ct,Yt)):Zt&16?mt&16?pn(rt,Yt,ct,Bt,Dt,ei,di,Ie,Oe):wn(rt,Dt,ei,!0):(Zt&8&&O(ct,""),mt&16&&ve(Yt,ct,Bt,Dt,ei,di,Ie,Oe))},ci=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe)=>{Ee=Ee||tg,Ce=Ce||tg;const rt=Ee.length,Zt=Ce.length,Yt=Math.min(rt,Zt);let ti;for(ti=0;ti<Yt;ti++){const mt=Ce[ti]=Oe?Td(Ce[ti]):Sa(Ce[ti]);ie(Ee[ti],mt,ct,null,Dt,ei,di,Ie,Oe)}rt>Zt?wn(Ee,Dt,ei,!0,!1,Yt):ve(Ce,ct,Bt,Dt,ei,di,Ie,Oe,Yt)},pn=(Ee,Ce,ct,Bt,Dt,ei,di,Ie,Oe)=>{let rt=0;const Zt=Ce.length;let Yt=Ee.length-1,ti=Zt-1;for(;rt<=Yt&&rt<=ti;){const mt=Ee[rt],zt=Ce[rt]=Oe?Td(Ce[rt]):Sa(Ce[rt]);if(nc(mt,zt))ie(mt,zt,ct,null,Dt,ei,di,Ie,Oe);else break;rt++}for(;rt<=Yt&&rt<=ti;){const mt=Ee[Yt],zt=Ce[ti]=Oe?Td(Ce[ti]):Sa(Ce[ti]);if(nc(mt,zt))ie(mt,zt,ct,null,Dt,ei,di,Ie,Oe);else break;Yt--,ti--}if(rt>Yt){if(rt<=ti){const mt=ti+1,zt=mt<Zt?Ce[mt].el:Bt;for(;rt<=ti;)ie(null,Ce[rt]=Oe?Td(Ce[rt]):Sa(Ce[rt]),ct,zt,Dt,ei,di,Ie,Oe),rt++}}else if(rt>ti)for(;rt<=Yt;)ji(Ee[rt],Dt,ei,!0),rt++;else{const mt=rt,zt=rt,Ii=new Map;for(rt=zt;rt<=ti;rt++){const js=Ce[rt]=Oe?Td(Ce[rt]):Sa(Ce[rt]);js.key!=null&&Ii.set(js.key,rt)}let Oi,Kn=0;const qn=ti-zt+1;let _s=!1,un=0;const vr=new Array(qn);for(rt=0;rt<qn;rt++)vr[rt]=0;for(rt=mt;rt<=Yt;rt++){const js=Ee[rt];if(Kn>=qn){ji(js,Dt,ei,!0);continue}let or;if(js.key!=null)or=Ii.get(js.key);else for(Oi=zt;Oi<=ti;Oi++)if(vr[Oi-zt]===0&&nc(js,Ce[Oi])){or=Oi;break}or===void 0?ji(js,Dt,ei,!0):(vr[or-zt]=rt+1,or>=un?un=or:_s=!0,ie(js,Ce[or],ct,null,Dt,ei,di,Ie,Oe),Kn++)}const Oo=_s?Cz(vr):tg;for(Oi=Oo.length-1,rt=qn-1;rt>=0;rt--){const js=zt+rt,or=Ce[js],pr=js+1<Zt?Ce[js+1].el:Bt;vr[rt]===0?ie(null,or,ct,pr,Dt,ei,di,Ie,Oe):_s&&(Oi<0||rt!==Oo[Oi]?Ni(or,ct,pr,2):Oi--)}}},Ni=(Ee,Ce,ct,Bt,Dt=null)=>{const{el:ei,type:di,transition:Ie,children:Oe,shapeFlag:rt}=Ee;if(rt&6){Ni(Ee.component.subTree,Ce,ct,Bt);return}if(rt&128){Ee.suspense.move(Ce,ct,Bt);return}if(rt&64){di.move(Ee,Ce,ct,jt);return}if(di===Dn){l(ei,Ce,ct);for(let Yt=0;Yt<Oe.length;Yt++)Ni(Oe[Yt],Ce,ct,Bt);l(Ee.anchor,Ce,ct);return}if(di===Tp){se(Ee,Ce,ct);return}if(Bt!==2&&rt&1&&Ie)if(Bt===0)Ie.beforeEnter(ei),l(ei,Ce,ct),Fr(()=>Ie.enter(ei),Dt);else{const{leave:Yt,delayLeave:ti,afterLeave:mt}=Ie,zt=()=>l(ei,Ce,ct),Ii=()=>{Yt(ei,()=>{zt(),mt&&mt()})};ti?ti(ei,zt,Ii):Ii()}else l(ei,Ce,ct)},ji=(Ee,Ce,ct,Bt=!1,Dt=!1)=>{const{type:ei,props:di,ref:Ie,children:Oe,dynamicChildren:rt,shapeFlag:Zt,patchFlag:Yt,dirs:ti,cacheIndex:mt}=Ee;if(Yt===-2&&(Dt=!1),Ie!=null&&gy(Ie,null,ct,Ee,!0),mt!=null&&(Ce.renderCache[mt]=void 0),Zt&256){Ce.ctx.deactivate(Ee);return}const zt=Zt&1&&ti,Ii=!Ad(Ee);let Oi;if(Ii&&(Oi=di&&di.onVnodeBeforeUnmount)&&Ea(Oi,Ce,Ee),Zt&6)Zn(Ee.component,ct,Bt);else{if(Zt&128){Ee.suspense.unmount(ct,Bt);return}zt&&nh(Ee,null,Ce,"beforeUnmount"),Zt&64?Ee.type.remove(Ee,Ce,ct,jt,Bt):rt&&!rt.hasOnce&&(ei!==Dn||Yt>0&&Yt&64)?wn(rt,Ce,ct,!1,!0):(ei===Dn&&Yt&384||!Dt&&Zt&16)&&wn(Oe,Ce,ct),Bt&&An(Ee)}(Ii&&(Oi=di&&di.onVnodeUnmounted)||zt)&&Fr(()=>{Oi&&Ea(Oi,Ce,Ee),zt&&nh(Ee,null,Ce,"unmounted")},ct)},An=Ee=>{const{type:Ce,el:ct,anchor:Bt,transition:Dt}=Ee;if(Ce===Dn){Hi(ct,Bt);return}if(Ce===Tp){he(Ee);return}const ei=()=>{h(ct),Dt&&!Dt.persisted&&Dt.afterLeave&&Dt.afterLeave()};if(Ee.shapeFlag&1&&Dt&&!Dt.persisted){const{leave:di,delayLeave:Ie}=Dt,Oe=()=>di(ct,ei);Ie?Ie(Ee.el,ei,Oe):Oe()}else ei()},Hi=(Ee,Ce)=>{let ct;for(;Ee!==Ce;)ct=$(Ee),h(Ee),Ee=ct;h(Ce)},Zn=(Ee,Ce,ct)=>{const{bum:Bt,scope:Dt,job:ei,subTree:di,um:Ie,m:Oe,a:rt}=Ee;Z0(Oe),Z0(rt),Bt&&sg(Bt),Dt.stop(),ei&&(ei.flags|=8,ji(di,Ee,Ce,ct)),Ie&&Fr(Ie,Ce),Fr(()=>{Ee.isUnmounted=!0},Ce),Ce&&Ce.pendingBranch&&!Ce.isUnmounted&&Ee.asyncDep&&!Ee.asyncResolved&&Ee.suspenseId===Ce.pendingId&&(Ce.deps--,Ce.deps===0&&Ce.resolve())},wn=(Ee,Ce,ct,Bt=!1,Dt=!1,ei=0)=>{for(let di=ei;di<Ee.length;di++)ji(Ee[di],Ce,ct,Bt,Dt)},nt=Ee=>{if(Ee.shapeFlag&6)return nt(Ee.component.subTree);if(Ee.shapeFlag&128)return Ee.suspense.next();const Ce=$(Ee.anchor||Ee.el),ct=Ce&&Ce[mk];return ct?$(ct):Ce};let Mt=!1;const xt=(Ee,Ce,ct)=>{Ee==null?Ce._vnode&&ji(Ce._vnode,null,null,!0):ie(Ce._vnode||null,Ee,Ce,null,null,null,ct),Ce._vnode=Ee,Mt||(Mt=!0,pS(),q0(),Mt=!1)},jt={p:ie,um:ji,m:Ni,r:An,mt:Tt,mc:ve,pc:oi,pbc:Ne,n:nt,o:e};let ki,ai;return t&&([ki,ai]=t(jt)),{render:xt,hydrate:ki,createApp:vz(xt,ki)}}function v1({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function lp({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Xk(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function xT(e,t,n=!1){const l=e.children,h=t.children;if(Ri(l)&&Ri(h))for(let d=0;d<l.length;d++){const g=l[d];let b=h[d];b.shapeFlag&1&&!b.dynamicChildren&&((b.patchFlag<=0||b.patchFlag===32)&&(b=h[d]=Td(h[d]),b.el=g.el),!n&&b.patchFlag!==-2&&xT(g,b)),b.type===ou&&(b.el=g.el)}}function Cz(e){const t=e.slice(),n=[0];let l,h,d,g,b;const r=e.length;for(l=0;l<r;l++){const C=e[l];if(C!==0){if(h=n[n.length-1],e[h]<C){t[l]=h,n.push(l);continue}for(d=0,g=n.length-1;d<g;)b=d+g>>1,e[n[b]]<C?d=b+1:g=b;C<e[n[d]]&&(d>0&&(t[l]=n[d-1]),n[d]=l)}}for(d=n.length,g=n[d-1];d-- >0;)n[d]=g,g=t[g];return n}function Zk(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Zk(t)}function Z0(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Yk=Symbol.for("v-scx"),Kk=()=>ia(Yk);function Az(e,t){return Ny(e,null,t)}function kz(e,t){return Ny(e,null,{flush:"post"})}function Jk(e,t){return Ny(e,null,{flush:"sync"})}function eo(e,t,n){return Ny(e,t,n)}function Ny(e,t,n=Hn){const{immediate:l,deep:h,flush:d,once:g}=n,b=Ls({},n),r=t&&l||!t&&d!=="post";let C;if(hg){if(d==="sync"){const q=Kk();C=q.__watcherHandles||(q.__watcherHandles=[])}else if(!r){const q=()=>{};return q.stop=El,q.resume=El,q.pause=El,q}}const O=Nr;b.call=(q,ee,ie)=>Ml(q,O,ee,ie);let U=!1;d==="post"?b.scheduler=q=>{Fr(q,O&&O.suspense)}:d!=="sync"&&(U=!0,b.scheduler=(q,ee)=>{ee?q():aT(q)}),b.augmentJob=q=>{t&&(q.flags|=4),U&&(q.flags|=2,O&&(q.id=O.uid,q.i=O))};const $=xR(e,t,b);return hg&&(C?C.push($):r&&$()),$}function Iz(e,t,n){const l=this.proxy,h=Vs(e)?e.includes(".")?Qk(l,e):()=>l[e]:e.bind(l,l);let d;on(t)?d=t:(d=t.handler,n=t);const g=Ap(this),b=Ny(h,d.bind(l),n);return g(),b}function Qk(e,t){const n=t.split(".");return()=>{let l=e;for(let h=0;h<n.length&&l;h++)l=l[n[h]];return l}}function Pz(e,t,n=Hn){const l=lo(),h=oo(t),d=Ma(t),g=eI(e,h),b=rk((r,C)=>{let O,U=Hn,$;return Jk(()=>{const q=e[h];Qo(O,q)&&(O=q,C())}),{get(){return r(),n.get?n.get(O):O},set(q){const ee=n.set?n.set(q):q;if(!Qo(ee,O)&&!(U!==Hn&&Qo(q,U)))return;const ie=l.vnode.props;ie&&(t in ie||h in ie||d in ie)&&(`onUpdate:${t}`in ie||`onUpdate:${h}`in ie||`onUpdate:${d}`in ie)||(O=q,C()),l.emit(`update:${t}`,ee),Qo(q,ee)&&Qo(q,U)&&!Qo(ee,$)&&C(),U=q,$=ee}}});return b[Symbol.iterator]=()=>{let r=0;return{next(){return r<2?{value:r++?g||Hn:b,done:!1}:{done:!0}}}},b}const eI=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${oo(t)}Modifiers`]||e[`${Ma(t)}Modifiers`];function Lz(e,t,...n){if(e.isUnmounted)return;const l=e.vnode.props||Hn;let h=n;const d=t.startsWith("update:"),g=d&&eI(l,t.slice(7));g&&(g.trim&&(h=n.map(O=>Vs(O)?O.trim():O)),g.number&&(h=n.map(j0)));let b,r=l[b=Z_(t)]||l[b=Z_(oo(t))];!r&&d&&(r=l[b=Z_(Ma(t))]),r&&Ml(r,e,6,h);const C=l[b+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[b])return;e.emitted[b]=!0,Ml(C,e,6,h)}}function tI(e,t,n=!1){const l=t.emitsCache,h=l.get(e);if(h!==void 0)return h;const d=e.emits;let g={},b=!1;if(!on(e)){const r=C=>{const O=tI(C,t,!0);O&&(b=!0,Ls(g,O))};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}return!d&&!b?(Ms(e)&&l.set(e,null),null):(Ri(d)?d.forEach(r=>g[r]=null):Ls(g,d),Ms(e)&&l.set(e,g),g)}function Lv(e,t){return!e||!zy(t)?!1:(t=t.slice(2).replace(/Once$/,""),cs(e,t[0].toLowerCase()+t.slice(1))||cs(e,Ma(t))||cs(e,t))}function A0(e){const{type:t,vnode:n,proxy:l,withProxy:h,propsOptions:[d],slots:g,attrs:b,emit:r,render:C,renderCache:O,props:U,data:$,setupState:q,ctx:ee,inheritAttrs:ie}=e,de=my(e);let ye,be;try{if(n.shapeFlag&4){const he=h||l,fe=he;ye=Sa(C.call(fe,he,O,U,q,$,ee)),be=b}else{const he=t;ye=Sa(he.length>1?he(U,{attrs:b,slots:g,emit:r}):he(U,null)),be=t.props?b:Oz(b)}}catch(he){ty.length=0,Op(he,e,1),ye=gn(Lr)}let se=ye;if(be&&ie!==!1){const he=Object.keys(be),{shapeFlag:fe}=se;he.length&&fe&7&&(d&&he.some(Zw)&&(be=Rz(be,d)),se=ch(se,be,!1,!0))}return n.dirs&&(se=ch(se,null,!1,!0),se.dirs=se.dirs?se.dirs.concat(n.dirs):n.dirs),n.transition&&lu(se,n.transition),ye=se,my(de),ye}function Dz(e,t=!0){let n;for(let l=0;l<e.length;l++){const h=e[l];if(cu(h)){if(h.type!==Lr||h.children==="v-if"){if(n)return;n=h}}else return}return n}const Oz=e=>{let t;for(const n in e)(n==="class"||n==="style"||zy(n))&&((t||(t={}))[n]=e[n]);return t},Rz=(e,t)=>{const n={};for(const l in e)(!Zw(l)||!(l.slice(9)in t))&&(n[l]=e[l]);return n};function zz(e,t,n){const{props:l,children:h,component:d}=e,{props:g,children:b,patchFlag:r}=t,C=d.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&r>=0){if(r&1024)return!0;if(r&16)return l?MS(l,g,C):!!g;if(r&8){const O=t.dynamicProps;for(let U=0;U<O.length;U++){const $=O[U];if(g[$]!==l[$]&&!Lv(C,$))return!0}}}else return(h||b)&&(!b||!b.$stable)?!0:l===g?!1:l?g?MS(l,g,C):!0:!!g;return!1}function MS(e,t,n){const l=Object.keys(t);if(l.length!==Object.keys(e).length)return!0;for(let h=0;h<l.length;h++){const d=l[h];if(t[d]!==e[d]&&!Lv(n,d))return!0}return!1}function Dv({vnode:e,parent:t},n){for(;t;){const l=t.subTree;if(l.suspense&&l.suspense.activeBranch===e&&(l.el=e.el),l===e)(e=t.vnode).el=n,t=t.parent;else break}}const Y0=e=>e.__isSuspense;let aw=0;const Bz={name:"Suspense",__isSuspense:!0,process(e,t,n,l,h,d,g,b,r,C){if(e==null)Nz(t,n,l,h,d,g,b,r,C);else{if(d&&d.deps>0&&!e.suspense.isInFallback){t.suspense=e.suspense,t.suspense.vnode=t,t.el=e.el;return}Uz(e,t,n,l,h,g,b,r,C)}},hydrate:Vz,normalize:jz},Fz=Bz;function yy(e,t){const n=e.props&&e.props[t];on(n)&&n()}function Nz(e,t,n,l,h,d,g,b,r){const{p:C,o:{createElement:O}}=r,U=O("div"),$=e.suspense=iI(e,h,l,t,U,n,d,g,b,r);C(null,$.pendingBranch=e.ssContent,U,null,l,$,d,g),$.deps>0?(yy(e,"onPending"),yy(e,"onFallback"),C(null,e.ssFallback,t,n,l,null,d,g),og($,e.ssFallback)):$.resolve(!1,!0)}function Uz(e,t,n,l,h,d,g,b,{p:r,um:C,o:{createElement:O}}){const U=t.suspense=e.suspense;U.vnode=t,t.el=e.el;const $=t.ssContent,q=t.ssFallback,{activeBranch:ee,pendingBranch:ie,isInFallback:de,isHydrating:ye}=U;if(ie)U.pendingBranch=$,nc($,ie)?(r(ie,$,U.hiddenContainer,null,h,U,d,g,b),U.deps<=0?U.resolve():de&&(ye||(r(ee,q,n,l,h,null,d,g,b),og(U,q)))):(U.pendingId=aw++,ye?(U.isHydrating=!1,U.activeBranch=ie):C(ie,h,U),U.deps=0,U.effects.length=0,U.hiddenContainer=O("div"),de?(r(null,$,U.hiddenContainer,null,h,U,d,g,b),U.deps<=0?U.resolve():(r(ee,q,n,l,h,null,d,g,b),og(U,q))):ee&&nc($,ee)?(r(ee,$,n,l,h,U,d,g,b),U.resolve(!0)):(r(null,$,U.hiddenContainer,null,h,U,d,g,b),U.deps<=0&&U.resolve()));else if(ee&&nc($,ee))r(ee,$,n,l,h,U,d,g,b),og(U,$);else if(yy(t,"onPending"),U.pendingBranch=$,$.shapeFlag&512?U.pendingId=$.component.suspenseId:U.pendingId=aw++,r(null,$,U.hiddenContainer,null,h,U,d,g,b),U.deps<=0)U.resolve();else{const{timeout:be,pendingId:se}=U;be>0?setTimeout(()=>{U.pendingId===se&&U.fallback(q)},be):be===0&&U.fallback(q)}}function iI(e,t,n,l,h,d,g,b,r,C,O=!1){const{p:U,m:$,um:q,n:ee,o:{parentNode:ie,remove:de}}=C;let ye;const be=$z(e);be&&t&&t.pendingBranch&&(ye=t.pendingId,t.deps++);const se=e.props?$0(e.props.timeout):void 0,he=d,fe={vnode:e,parent:t,parentComponent:n,namespace:g,container:l,hiddenContainer:h,deps:0,pendingId:aw++,timeout:typeof se=="number"?se:-1,activeBranch:null,pendingBranch:null,isInFallback:!O,isHydrating:O,isUnmounted:!1,effects:[],resolve(Me=!1,ze=!1){const{vnode:ve,activeBranch:Ue,pendingBranch:Ne,pendingId:it,effects:Qe,parentComponent:Xe,container:Tt}=fe;let Rt=!1;fe.isHydrating?fe.isHydrating=!1:Me||(Rt=Ue&&Ne.transition&&Ne.transition.mode==="out-in",Rt&&(Ue.transition.afterLeave=()=>{it===fe.pendingId&&($(Ne,Tt,d===he?ee(Ue):d,0),fy(Qe))}),Ue&&(ie(Ue.el)===Tt&&(d=ee(Ue)),q(Ue,Xe,fe,!0)),Rt||$(Ne,Tt,d,0)),og(fe,Ne),fe.pendingBranch=null,fe.isInFallback=!1;let St=fe.parent,Pt=!1;for(;St;){if(St.pendingBranch){St.effects.push(...Qe),Pt=!0;break}St=St.parent}!Pt&&!Rt&&fy(Qe),fe.effects=[],be&&t&&t.pendingBranch&&ye===t.pendingId&&(t.deps--,t.deps===0&&!ze&&t.resolve()),yy(ve,"onResolve")},fallback(Me){if(!fe.pendingBranch)return;const{vnode:ze,activeBranch:ve,parentComponent:Ue,container:Ne,namespace:it}=fe;yy(ze,"onFallback");const Qe=ee(ve),Xe=()=>{fe.isInFallback&&(U(null,Me,Ne,Qe,Ue,null,it,b,r),og(fe,Me))},Tt=Me.transition&&Me.transition.mode==="out-in";Tt&&(ve.transition.afterLeave=Xe),fe.isInFallback=!0,q(ve,Ue,null,!0),Tt||Xe()},move(Me,ze,ve){fe.activeBranch&&$(fe.activeBranch,Me,ze,ve),fe.container=Me},next(){return fe.activeBranch&&ee(fe.activeBranch)},registerDep(Me,ze,ve){const Ue=!!fe.pendingBranch;Ue&&fe.deps++;const Ne=Me.vnode.el;Me.asyncDep.catch(it=>{Op(it,Me,0)}).then(it=>{if(Me.isUnmounted||fe.isUnmounted||fe.pendingId!==Me.suspenseId)return;Me.asyncResolved=!0;const{vnode:Qe}=Me;uw(Me,it,!1),Ne&&(Qe.el=Ne);const Xe=!Ne&&Me.subTree.el;ze(Me,Qe,ie(Ne||Me.subTree.el),Ne?null:ee(Me.subTree),fe,g,ve),Xe&&de(Xe),Dv(Me,Qe.el),Ue&&--fe.deps===0&&fe.resolve()})},unmount(Me,ze){fe.isUnmounted=!0,fe.activeBranch&&q(fe.activeBranch,n,Me,ze),fe.pendingBranch&&q(fe.pendingBranch,n,Me,ze)}};return fe}function Vz(e,t,n,l,h,d,g,b,r){const C=t.suspense=iI(t,l,n,e.parentNode,document.createElement("div"),null,h,d,g,b,!0),O=r(e,C.pendingBranch=t.ssContent,n,C,d,g);return C.deps===0&&C.resolve(!1,!0),O}function jz(e){const{shapeFlag:t,children:n}=e,l=t&32;e.ssContent=CS(l?n.default:n),e.ssFallback=l?CS(n.fallback):gn(Lr)}function CS(e){let t;if(on(e)){const n=Cp&&e._c;n&&(e._d=!1,ui()),e=e(),n&&(e._d=!0,t=Io,sI())}return Ri(e)&&(e=Dz(e)),e=Sa(e),t&&!e.dynamicChildren&&(e.dynamicChildren=t.filter(n=>n!==e)),e}function nI(e,t){t&&t.pendingBranch?Ri(e)?t.effects.push(...e):t.effects.push(e):fy(e)}function og(e,t){e.activeBranch=t;const{vnode:n,parentComponent:l}=e;let h=t.el;for(;!h&&t.component;)t=t.component.subTree,h=t.el;n.el=h,l&&l.subTree===n&&(l.vnode.el=h,Dv(l,h))}function $z(e){const t=e.props&&e.props.suspensible;return t!=null&&t!==!1}const Dn=Symbol.for("v-fgt"),ou=Symbol.for("v-txt"),Lr=Symbol.for("v-cmt"),Tp=Symbol.for("v-stc"),ty=[];let Io=null;function ui(e=!1){ty.push(Io=e?null:[])}function sI(){ty.pop(),Io=ty[ty.length-1]||null}let Cp=1;function lw(e,t=!1){Cp+=e,e<0&&Io&&t&&(Io.hasOnce=!0)}function rI(e){return e.dynamicChildren=Cp>0?Io||tg:null,sI(),Cp>0&&Io&&Io.push(e),e}function Ei(e,t,n,l,h,d){return rI(tt(e,t,n,l,h,d,!0))}function Qr(e,t,n,l,h){return rI(gn(e,t,n,l,h,!0))}function cu(e){return e?e.__v_isVNode===!0:!1}function nc(e,t){return e.type===t.type&&e.key===t.key}function Wz(e){}const oI=({key:e})=>e??null,k0=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Vs(e)||Zs(e)||on(e)?{i:Ur,r:e,k:t,f:!!n}:e:null);function tt(e,t=null,n=null,l=0,h=null,d=e===Dn?0:1,g=!1,b=!1){const r={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&oI(t),ref:t&&k0(t),scopeId:Cv,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:l,dynamicProps:h,dynamicChildren:null,appContext:null,ctx:Ur};return b?(vT(r,n),d&128&&e.normalize(r)):n&&(r.shapeFlag|=Vs(n)?8:16),Cp>0&&!g&&Io&&(r.patchFlag>0||d&6)&&r.patchFlag!==32&&Io.push(r),r}const gn=Gz;function Gz(e,t=null,n=null,l=0,h=null,d=!1){if((!e||e===Ik)&&(e=Lr),cu(e)){const b=ch(e,t,!0);return n&&vT(b,n),Cp>0&&!d&&Io&&(b.shapeFlag&6?Io[Io.indexOf(e)]=b:Io.push(b)),b.patchFlag=-2,b}if(Jz(e)&&(e=e.__vccOpts),t){t=aI(t);let{class:b,style:r}=t;b&&!Vs(b)&&(t.class=Jr(b)),Ms(r)&&(bg(r)&&!Ri(r)&&(r=Ls({},r)),t.style=uc(r))}const g=Vs(e)?1:Y0(e)?128:gk(e)?64:Ms(e)?4:on(e)?2:0;return tt(e,t,n,l,h,g,d,!0)}function aI(e){return e?bg(e)||Fk(e)?Ls({},e):e:null}function ch(e,t,n=!1,l=!1){const{props:h,ref:d,patchFlag:g,children:b,transition:r}=e,C=t?Uy(h||{},t):h,O={__v_isVNode:!0,__v_skip:!0,type:e.type,props:C,key:C&&oI(C),ref:t&&t.ref?n&&d?Ri(d)?d.concat(k0(t)):[d,k0(t)]:k0(t):d,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:b,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Dn?g===-1?16:g|16:g,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:r,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ch(e.ssContent),ssFallback:e.ssFallback&&ch(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return r&&l&&lu(O,r.clone(O)),O}function fr(e=" ",t=0){return gn(ou,null,e,t)}function K0(e,t){const n=gn(Tp,null,e);return n.staticCount=t,n}function xs(e="",t=!1){return t?(ui(),Qr(Lr,null,e)):gn(Lr,null,e)}function Sa(e){return e==null||typeof e=="boolean"?gn(Lr):Ri(e)?gn(Dn,null,e.slice()):cu(e)?Td(e):gn(ou,null,String(e))}function Td(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ch(e)}function vT(e,t){let n=0;const{shapeFlag:l}=e;if(t==null)t=null;else if(Ri(t))n=16;else if(typeof t=="object")if(l&65){const h=t.default;h&&(h._c&&(h._d=!1),vT(e,h()),h._c&&(h._d=!0));return}else{n=32;const h=t._;!h&&!Fk(t)?t._ctx=Ur:h===3&&Ur&&(Ur.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else on(t)?(t={default:t,_ctx:Ur},n=32):(t=String(t),l&64?(n=16,t=[fr(t)]):n=8);e.children=t,e.shapeFlag|=n}function Uy(...e){const t={};for(let n=0;n<e.length;n++){const l=e[n];for(const h in l)if(h==="class")t.class!==l.class&&(t.class=Jr([t.class,l.class]));else if(h==="style")t.style=uc([t.style,l.style]);else if(zy(h)){const d=t[h],g=l[h];g&&d!==g&&!(Ri(d)&&d.includes(g))&&(t[h]=d?[].concat(d,g):g)}else h!==""&&(t[h]=l[h])}return t}function Ea(e,t,n,l=null){Ml(e,t,7,[n,l])}const Hz=Rk();let qz=0;function lI(e,t,n){const l=e.type,h=(t?t.appContext:e.appContext)||Hz,d={uid:qz++,vnode:e,type:l,parent:t,appContext:h,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Qw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(h.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Uk(l,h),emitsOptions:tI(l,h),emit:null,emitted:null,propsDefaults:Hn,inheritAttrs:l.inheritAttrs,ctx:Hn,data:Hn,props:Hn,attrs:Hn,slots:Hn,refs:Hn,setupState:Hn,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=t?t.root:d,d.emit=Lz.bind(null,d),e.ce&&e.ce(d),d}let Nr=null;const lo=()=>Nr||Ur;let J0,cw;{const e=xv(),t=(n,l)=>{let h;return(h=e[n])||(h=e[n]=[]),h.push(l),d=>{h.length>1?h.forEach(g=>g(d)):h[0](d)}};J0=t("__VUE_INSTANCE_SETTERS__",n=>Nr=n),cw=t("__VUE_SSR_SETTERS__",n=>hg=n)}const Ap=e=>{const t=Nr;return J0(e),e.scope.on(),()=>{e.scope.off(),J0(t)}},hw=()=>{Nr&&Nr.scope.off(),J0(null)};function cI(e){return e.vnode.shapeFlag&4}let hg=!1;function hI(e,t=!1,n=!1){t&&cw(t);const{props:l,children:h}=e.vnode,d=cI(e);bz(e,l,d,t),Sz(e,h,n);const g=d?Xz(e,t):void 0;return t&&cw(!1),g}function Xz(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,nw);const{setup:l}=n;if(l){zd();const h=e.setupContext=l.length>1?dI(e):null,d=Ap(e),g=wg(l,e,0,[e.props,h]),b=Kw(g);if(Bd(),d(),(b||e.sp)&&!Ad(e)&&hT(e),b){if(g.then(hw,hw),t)return g.then(r=>{uw(e,r,t)}).catch(r=>{Op(r,e,0)});e.asyncDep=g}else uw(e,g,t)}else uI(e,t)}function uw(e,t,n){on(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ms(t)&&(e.setupState=oT(t)),uI(e,n)}let Q0,dw;function Zz(e){Q0=e,dw=t=>{t.render._rc&&(t.withProxy=new Proxy(t.ctx,ez))}}const Yz=()=>!Q0;function uI(e,t,n){const l=e.type;if(!e.render){if(!t&&Q0&&!l.render){const h=l.template||gT(e).template;if(h){const{isCustomElement:d,compilerOptions:g}=e.appContext.config,{delimiters:b,compilerOptions:r}=l,C=Ls(Ls({isCustomElement:d,delimiters:b},g),r);l.render=Q0(h,C)}}e.render=l.render||El,dw&&dw(e)}{const h=Ap(e);zd();try{pz(e)}finally{Bd(),h()}}}const Kz={get(e,t){return Co(e,"get",""),e[t]}};function dI(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,Kz),slots:e.slots,emit:e.emit,expose:t}}function Vy(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(oT(Mv(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Q_)return Q_[n](e)},has(t,n){return n in t||n in Q_}})):e.proxy}function fw(e,t=!0){return on(e)?e.displayName||e.name:e.name||t&&e.__name}function Jz(e){return on(e)&&"__vccOpts"in e}const Fn=(e,t)=>mR(e,t,hg);function hu(e,t,n){const l=arguments.length;return l===2?Ms(t)&&!Ri(t)?cu(t)?gn(e,null,[t]):gn(e,t):gn(e,null,t):(l>3?n=Array.prototype.slice.call(arguments,2):l===3&&cu(n)&&(n=[n]),gn(e,t,n))}function Qz(){}function e3(e,t,n,l){const h=n[l];if(h&&fI(h,e))return h;const d=t();return d.memo=e.slice(),d.cacheIndex=l,n[l]=d}function fI(e,t){const n=e.memo;if(n.length!=t.length)return!1;for(let l=0;l<n.length;l++)if(Qo(n[l],t[l]))return!1;return Cp>0&&Io&&Io.push(e),!0}const bT="3.5.13",t3=El,i3=ER,n3=Zm,s3=pk,r3={createComponentInstance:lI,setupComponent:hI,renderComponentRoot:A0,setCurrentRenderingInstance:my,isVNode:cu,normalizeVNode:Sa,getComponentPublicInstance:Vy,ensureValidVNode:mT,pushWarningContext:vR,popWarningContext:bR},o3=r3,a3=null,l3=null,c3=null;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let pw;const AS=typeof window<"u"&&window.trustedTypes;if(AS)try{pw=AS.createPolicy("vue",{createHTML:e=>e})}catch{}const pI=pw?e=>pw.createHTML(e):e=>e,h3="http://www.w3.org/2000/svg",u3="http://www.w3.org/1998/Math/MathML",Jh=typeof document<"u"?document:null,kS=Jh&&Jh.createElement("template"),d3={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,l)=>{const h=t==="svg"?Jh.createElementNS(h3,e):t==="mathml"?Jh.createElementNS(u3,e):n?Jh.createElement(e,{is:n}):Jh.createElement(e);return e==="select"&&l&&l.multiple!=null&&h.setAttribute("multiple",l.multiple),h},createText:e=>Jh.createTextNode(e),createComment:e=>Jh.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Jh.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,l,h,d){const g=n?n.previousSibling:t.lastChild;if(h&&(h===d||h.nextSibling))for(;t.insertBefore(h.cloneNode(!0),n),!(h===d||!(h=h.nextSibling)););else{kS.innerHTML=pI(l==="svg"?`<svg>${e}</svg>`:l==="mathml"?`<math>${e}</math>`:e);const b=kS.content;if(l==="svg"||l==="mathml"){const r=b.firstChild;for(;r.firstChild;)b.appendChild(r.firstChild);b.removeChild(r)}t.insertBefore(b,n)}return[g?g.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},pd="transition",L_="animation",ug=Symbol("_vtc"),mI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},gI=Ls({},cT,mI),f3=e=>(e.displayName="Transition",e.props=gI,e),_I=f3((e,{slots:t})=>hu(bk,yI(e),t)),cp=(e,t=[])=>{Ri(e)?e.forEach(n=>n(...t)):e&&e(...t)},IS=e=>e?Ri(e)?e.some(t=>t.length>1):e.length>1:!1;function yI(e){const t={};for(const Qe in e)Qe in mI||(t[Qe]=e[Qe]);if(e.css===!1)return t;const{name:n="v",type:l,duration:h,enterFromClass:d=`${n}-enter-from`,enterActiveClass:g=`${n}-enter-active`,enterToClass:b=`${n}-enter-to`,appearFromClass:r=d,appearActiveClass:C=g,appearToClass:O=b,leaveFromClass:U=`${n}-leave-from`,leaveActiveClass:$=`${n}-leave-active`,leaveToClass:q=`${n}-leave-to`}=e,ee=p3(h),ie=ee&&ee[0],de=ee&&ee[1],{onBeforeEnter:ye,onEnter:be,onEnterCancelled:se,onLeave:he,onLeaveCancelled:fe,onBeforeAppear:Me=ye,onAppear:ze=be,onAppearCancelled:ve=se}=t,Ue=(Qe,Xe,Tt,Rt)=>{Qe._enterCancelled=Rt,yd(Qe,Xe?O:b),yd(Qe,Xe?C:g),Tt&&Tt()},Ne=(Qe,Xe)=>{Qe._isLeaving=!1,yd(Qe,U),yd(Qe,q),yd(Qe,$),Xe&&Xe()},it=Qe=>(Xe,Tt)=>{const Rt=Qe?ze:be,St=()=>Ue(Xe,Qe,Tt);cp(Rt,[Xe,St]),PS(()=>{yd(Xe,Qe?r:d),Qc(Xe,Qe?O:b),IS(Rt)||LS(Xe,l,ie,St)})};return Ls(t,{onBeforeEnter(Qe){cp(ye,[Qe]),Qc(Qe,d),Qc(Qe,g)},onBeforeAppear(Qe){cp(Me,[Qe]),Qc(Qe,r),Qc(Qe,C)},onEnter:it(!1),onAppear:it(!0),onLeave(Qe,Xe){Qe._isLeaving=!0;const Tt=()=>Ne(Qe,Xe);Qc(Qe,U),Qe._enterCancelled?(Qc(Qe,$),mw()):(mw(),Qc(Qe,$)),PS(()=>{Qe._isLeaving&&(yd(Qe,U),Qc(Qe,q),IS(he)||LS(Qe,l,de,Tt))}),cp(he,[Qe,Tt])},onEnterCancelled(Qe){Ue(Qe,!1,void 0,!0),cp(se,[Qe])},onAppearCancelled(Qe){Ue(Qe,!0,void 0,!0),cp(ve,[Qe])},onLeaveCancelled(Qe){Ne(Qe),cp(fe,[Qe])}})}function p3(e){if(e==null)return null;if(Ms(e))return[b1(e.enter),b1(e.leave)];{const t=b1(e);return[t,t]}}function b1(e){return $0(e)}function Qc(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[ug]||(e[ug]=new Set)).add(t)}function yd(e,t){t.split(/\s+/).forEach(l=>l&&e.classList.remove(l));const n=e[ug];n&&(n.delete(t),n.size||(e[ug]=void 0))}function PS(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let m3=0;function LS(e,t,n,l){const h=e._endId=++m3,d=()=>{h===e._endId&&l()};if(n!=null)return setTimeout(d,n);const{type:g,timeout:b,propCount:r}=xI(e,t);if(!g)return l();const C=g+"end";let O=0;const U=()=>{e.removeEventListener(C,$),d()},$=q=>{q.target===e&&++O>=r&&U()};setTimeout(()=>{O<r&&U()},b+1),e.addEventListener(C,$)}function xI(e,t){const n=window.getComputedStyle(e),l=ee=>(n[ee]||"").split(", "),h=l(`${pd}Delay`),d=l(`${pd}Duration`),g=DS(h,d),b=l(`${L_}Delay`),r=l(`${L_}Duration`),C=DS(b,r);let O=null,U=0,$=0;t===pd?g>0&&(O=pd,U=g,$=d.length):t===L_?C>0&&(O=L_,U=C,$=r.length):(U=Math.max(g,C),O=U>0?g>C?pd:L_:null,$=O?O===pd?d.length:r.length:0);const q=O===pd&&/\b(transform|all)(,|$)/.test(l(`${pd}Property`).toString());return{type:O,timeout:U,propCount:$,hasTransform:q}}function DS(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,l)=>OS(n)+OS(e[l])))}function OS(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function mw(){return document.body.offsetHeight}function g3(e,t,n){const l=e[ug];l&&(t=(t?[t,...l]:[...l]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const ev=Symbol("_vod"),vI=Symbol("_vsh"),bI={beforeMount(e,{value:t},{transition:n}){e[ev]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):D_(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:l}){!t!=!n&&(l?t?(l.beforeEnter(e),D_(e,!0),l.enter(e)):l.leave(e,()=>{D_(e,!1)}):D_(e,t))},beforeUnmount(e,{value:t}){D_(e,t)}};function D_(e,t){e.style.display=t?e[ev]:"none",e[vI]=!t}function _3(){bI.getSSRProps=({value:e})=>{if(!e)return{style:{display:"none"}}}}const wI=Symbol("");function y3(e){const t=lo();if(!t)return;const n=t.ut=(h=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(d=>tv(d,h))},l=()=>{const h=e(t.proxy);t.ce?tv(t.ce,h):gw(t.subTree,h),n(h)};dT(()=>{fy(l)}),nl(()=>{eo(l,El,{flush:"post"});const h=new MutationObserver(l);h.observe(t.subTree.el.parentNode,{childList:!0}),Eg(()=>h.disconnect())})}function gw(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{gw(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)tv(e.el,t);else if(e.type===Dn)e.children.forEach(n=>gw(n,t));else if(e.type===Tp){let{el:n,anchor:l}=e;for(;n&&(tv(n,t),n!==l);)n=n.nextSibling}}function tv(e,t){if(e.nodeType===1){const n=e.style;let l="";for(const h in t)n.setProperty(`--${h}`,t[h]),l+=`--${h}: ${t[h]};`;n[wI]=l}}const x3=/(^|;)\s*display\s*:/;function v3(e,t,n){const l=e.style,h=Vs(n);let d=!1;if(n&&!h){if(t)if(Vs(t))for(const g of t.split(";")){const b=g.slice(0,g.indexOf(":")).trim();n[b]==null&&I0(l,b,"")}else for(const g in t)n[g]==null&&I0(l,g,"");for(const g in n)g==="display"&&(d=!0),I0(l,g,n[g])}else if(h){if(t!==n){const g=l[wI];g&&(n+=";"+g),l.cssText=n,d=x3.test(n)}}else t&&e.removeAttribute("style");ev in e&&(e[ev]=d?l.display:"",e[vI]&&(l.display="none"))}const RS=/\s*!important$/;function I0(e,t,n){if(Ri(n))n.forEach(l=>I0(e,t,l));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const l=b3(e,t);RS.test(n)?e.setProperty(Ma(l),n.replace(RS,""),"important"):e[l]=n}}const zS=["Webkit","Moz","ms"],w1={};function b3(e,t){const n=w1[t];if(n)return n;let l=oo(t);if(l!=="filter"&&l in e)return w1[t]=l;l=By(l);for(let h=0;h<zS.length;h++){const d=zS[h]+l;if(d in e)return w1[t]=d}return t}const BS="http://www.w3.org/1999/xlink";function FS(e,t,n,l,h,d=BO(t)){l&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(BS,t.slice(6,t.length)):e.setAttributeNS(BS,t,n):n==null||d&&!NA(n)?e.removeAttribute(t):e.setAttribute(t,d?"":cc(n)?String(n):n)}function NS(e,t,n,l,h){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?pI(n):n);return}const d=e.tagName;if(t==="value"&&d!=="PROGRESS"&&!d.includes("-")){const b=d==="OPTION"?e.getAttribute("value")||"":e.value,r=n==null?e.type==="checkbox"?"on":"":String(n);(b!==r||!("_value"in e))&&(e.value=r),n==null&&e.removeAttribute(t),e._value=n;return}let g=!1;if(n===""||n==null){const b=typeof e[t];b==="boolean"?n=NA(n):n==null&&b==="string"?(n="",g=!0):b==="number"&&(n=0,g=!0)}try{e[t]=n}catch{}g&&e.removeAttribute(h||t)}function iu(e,t,n,l){e.addEventListener(t,n,l)}function w3(e,t,n,l){e.removeEventListener(t,n,l)}const US=Symbol("_vei");function T3(e,t,n,l,h=null){const d=e[US]||(e[US]={}),g=d[t];if(l&&g)g.value=l;else{const[b,r]=E3(t);if(l){const C=d[t]=C3(l,h);iu(e,b,C,r)}else g&&(w3(e,b,g,r),d[t]=void 0)}}const VS=/(?:Once|Passive|Capture)$/;function E3(e){let t;if(VS.test(e)){t={};let l;for(;l=e.match(VS);)e=e.slice(0,e.length-l[0].length),t[l[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ma(e.slice(2)),t]}let T1=0;const S3=Promise.resolve(),M3=()=>T1||(S3.then(()=>T1=0),T1=Date.now());function C3(e,t){const n=l=>{if(!l._vts)l._vts=Date.now();else if(l._vts<=n.attached)return;Ml(A3(l,n.value),t,5,[l])};return n.value=e,n.attached=M3(),n}function A3(e,t){if(Ri(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(l=>h=>!h._stopped&&l&&l(h))}else return t}const jS=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,k3=(e,t,n,l,h,d)=>{const g=h==="svg";t==="class"?g3(e,l,g):t==="style"?v3(e,n,l):zy(t)?Zw(t)||T3(e,t,n,l,d):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):I3(e,t,l,g))?(NS(e,t,l),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&FS(e,t,l,g,d,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Vs(l))?NS(e,oo(t),l,d,t):(t==="true-value"?e._trueValue=l:t==="false-value"&&(e._falseValue=l),FS(e,t,l,g))};function I3(e,t,n,l){if(l)return!!(t==="innerHTML"||t==="textContent"||t in e&&jS(t)&&on(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const h=e.tagName;if(h==="IMG"||h==="VIDEO"||h==="CANVAS"||h==="SOURCE")return!1}return jS(t)&&Vs(n)?!1:t in e}const $S={};/*! #__NO_SIDE_EFFECTS__ */function TI(e,t,n){const l=gs(e,t);_v(l)&&Ls(l,t);class h extends Ov{constructor(g){super(l,g,n)}}return h.def=l,h}/*! #__NO_SIDE_EFFECTS__ */const P3=(e,t)=>TI(e,t,OI),L3=typeof HTMLElement<"u"?HTMLElement:class{};class Ov extends L3{constructor(t,n={},l=vy){super(),this._def=t,this._props=n,this._createApp=l,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&l!==vy?this._root=this.shadowRoot:t.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof Ov){this._parent=t;break}this._instance||(this._resolved?(this._setParent(),this._update()):t&&t._pendingResolve?this._pendingResolve=t._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(t=this._parent){t&&(this._instance.parent=t._instance,this._instance.provides=t._instance.provides)}disconnectedCallback(){this._connected=!1,Fd(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let l=0;l<this.attributes.length;l++)this._setAttr(this.attributes[l].name);this._ob=new MutationObserver(l=>{for(const h of l)this._setAttr(h.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(l,h=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:d,styles:g}=l;let b;if(d&&!Ri(d))for(const r in d){const C=d[r];(C===Number||C&&C.type===Number)&&(r in this._props&&(this._props[r]=$0(this._props[r])),(b||(b=Object.create(null)))[oo(r)]=!0)}this._numberProps=b,h&&this._resolveProps(l),this.shadowRoot&&this._applyStyles(g),this._mount(l)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(l=>t(this._def=l,!0)):t(this._def)}_mount(t){this._app=this._createApp(t),t.configureApp&&t.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const l in n)cs(this,l)||Object.defineProperty(this,l,{get:()=>hs(n[l])})}_resolveProps(t){const{props:n}=t,l=Ri(n)?n:Object.keys(n||{});for(const h of Object.keys(this))h[0]!=="_"&&l.includes(h)&&this._setProp(h,this[h]);for(const h of l.map(oo))Object.defineProperty(this,h,{get(){return this._getProp(h)},set(d){this._setProp(h,d,!0,!0)}})}_setAttr(t){if(t.startsWith("data-v-"))return;const n=this.hasAttribute(t);let l=n?this.getAttribute(t):$S;const h=oo(t);n&&this._numberProps&&this._numberProps[h]&&(l=$0(l)),this._setProp(h,l,!1,!0)}_getProp(t){return this._props[t]}_setProp(t,n,l=!0,h=!1){if(n!==this._props[t]&&(n===$S?delete this._props[t]:(this._props[t]=n,t==="key"&&this._app&&(this._app._ceVNode.key=n)),h&&this._instance&&this._update(),l)){const d=this._ob;d&&d.disconnect(),n===!0?this.setAttribute(Ma(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Ma(t),n+""):n||this.removeAttribute(Ma(t)),d&&d.observe(this,{attributes:!0})}}_update(){DI(this._createVNode(),this._root)}_createVNode(){const t={};this.shadowRoot||(t.onVnodeMounted=t.onVnodeUpdated=this._renderSlots.bind(this));const n=gn(this._def,Ls(t,this._props));return this._instance||(n.ce=l=>{this._instance=l,l.ce=this,l.isCE=!0;const h=(d,g)=>{this.dispatchEvent(new CustomEvent(d,_v(g[0])?Ls({detail:g},g[0]):{detail:g}))};l.emit=(d,...g)=>{h(d,g),Ma(d)!==d&&h(Ma(d),g)},this._setParent()}),n}_applyStyles(t,n){if(!t)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const l=this._nonce;for(let h=t.length-1;h>=0;h--){const d=document.createElement("style");l&&d.setAttribute("nonce",l),d.textContent=t[h],this.shadowRoot.prepend(d)}}_parseSlots(){const t=this._slots={};let n;for(;n=this.firstChild;){const l=n.nodeType===1&&n.getAttribute("slot")||"default";(t[l]||(t[l]=[])).push(n),this.removeChild(n)}}_renderSlots(){const t=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let l=0;l<t.length;l++){const h=t[l],d=h.getAttribute("name")||"default",g=this._slots[d],b=h.parentNode;if(g)for(const r of g){if(n&&r.nodeType===1){const C=n+"-s",O=document.createTreeWalker(r,1);r.setAttribute(C,"");let U;for(;U=O.nextNode();)U.setAttribute(C,"")}b.insertBefore(r,h)}else for(;h.firstChild;)b.insertBefore(h.firstChild,h);b.removeChild(h)}}_injectChildStyle(t){this._applyStyles(t.styles,t)}_removeChildStyle(t){}}function EI(e){const t=lo(),n=t&&t.ce;return n||null}function D3(){const e=EI();return e&&e.shadowRoot}function O3(e="$style"){{const t=lo();if(!t)return Hn;const n=t.type.__cssModules;if(!n)return Hn;const l=n[e];return l||Hn}}const SI=new WeakMap,MI=new WeakMap,iv=Symbol("_moveCb"),WS=Symbol("_enterCb"),R3=e=>(delete e.props.mode,e),z3=R3({name:"TransitionGroup",props:Ls({},gI,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=lo(),l=lT();let h,d;return Iv(()=>{if(!h.length)return;const g=e.moveClass||`${e.name||"v"}-move`;if(!U3(h[0].el,n.vnode.el,g))return;h.forEach(B3),h.forEach(F3);const b=h.filter(N3);mw(),b.forEach(r=>{const C=r.el,O=C.style;Qc(C,g),O.transform=O.webkitTransform=O.transitionDuration="";const U=C[iv]=$=>{$&&$.target!==C||(!$||/transform$/.test($.propertyName))&&(C.removeEventListener("transitionend",U),C[iv]=null,yd(C,g))};C.addEventListener("transitionend",U)})}),()=>{const g=Sn(e),b=yI(g);let r=g.tag||Dn;if(h=[],d)for(let C=0;C<d.length;C++){const O=d[C];O.el&&O.el instanceof Element&&(h.push(O),lu(O,cg(O,b,l,n)),SI.set(O,O.el.getBoundingClientRect()))}d=t.default?Av(t.default()):[];for(let C=0;C<d.length;C++){const O=d[C];O.key!=null&&lu(O,cg(O,b,l,n))}return gn(r,null,d)}}}),CI=z3;function B3(e){const t=e.el;t[iv]&&t[iv](),t[WS]&&t[WS]()}function F3(e){MI.set(e,e.el.getBoundingClientRect())}function N3(e){const t=SI.get(e),n=MI.get(e),l=t.left-n.left,h=t.top-n.top;if(l||h){const d=e.el.style;return d.transform=d.webkitTransform=`translate(${l}px,${h}px)`,d.transitionDuration="0s",e}}function U3(e,t,n){const l=e.cloneNode(),h=e[ug];h&&h.forEach(b=>{b.split(/\s+/).forEach(r=>r&&l.classList.remove(r))}),n.split(/\s+/).forEach(b=>b&&l.classList.add(b)),l.style.display="none";const d=t.nodeType===1?t:t.parentNode;d.appendChild(l);const{hasTransform:g}=xI(l);return d.removeChild(l),g}const Dd=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Ri(t)?n=>sg(t,n):t};function V3(e){e.target.composing=!0}function GS(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Sl=Symbol("_assign"),tc={created(e,{modifiers:{lazy:t,trim:n,number:l}},h){e[Sl]=Dd(h);const d=l||h.props&&h.props.type==="number";iu(e,t?"change":"input",g=>{if(g.target.composing)return;let b=e.value;n&&(b=b.trim()),d&&(b=j0(b)),e[Sl](b)}),n&&iu(e,"change",()=>{e.value=e.value.trim()}),t||(iu(e,"compositionstart",V3),iu(e,"compositionend",GS),iu(e,"change",GS))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:l,trim:h,number:d}},g){if(e[Sl]=Dd(g),e.composing)return;const b=(d||e.type==="number")&&!/^0\d/.test(e.value)?j0(e.value):e.value,r=t??"";b!==r&&(document.activeElement===e&&e.type!=="range"&&(l&&t===n||h&&e.value.trim()===r)||(e.value=r))}},Rv={deep:!0,created(e,t,n){e[Sl]=Dd(n),iu(e,"change",()=>{const l=e._modelValue,h=dg(e),d=e.checked,g=e[Sl];if(Ri(l)){const b=vv(l,h),r=b!==-1;if(d&&!r)g(l.concat(h));else if(!d&&r){const C=[...l];C.splice(b,1),g(C)}}else if(Lp(l)){const b=new Set(l);d?b.add(h):b.delete(h),g(b)}else g(AI(e,d))})},mounted:HS,beforeUpdate(e,t,n){e[Sl]=Dd(n),HS(e,t,n)}};function HS(e,{value:t,oldValue:n},l){e._modelValue=t;let h;if(Ri(t))h=vv(t,l.props.value)>-1;else if(Lp(t))h=t.has(l.props.value);else{if(t===n)return;h=Pd(t,AI(e,!0))}e.checked!==h&&(e.checked=h)}const wT={created(e,{value:t},n){e.checked=Pd(t,n.props.value),e[Sl]=Dd(n),iu(e,"change",()=>{e[Sl](dg(e))})},beforeUpdate(e,{value:t,oldValue:n},l){e[Sl]=Dd(l),t!==n&&(e.checked=Pd(t,l.props.value))}},kd={deep:!0,created(e,{value:t,modifiers:{number:n}},l){const h=Lp(t);iu(e,"change",()=>{const d=Array.prototype.filter.call(e.options,g=>g.selected).map(g=>n?j0(dg(g)):dg(g));e[Sl](e.multiple?h?new Set(d):d:d[0]),e._assigning=!0,Fd(()=>{e._assigning=!1})}),e[Sl]=Dd(l)},mounted(e,{value:t}){qS(e,t)},beforeUpdate(e,t,n){e[Sl]=Dd(n)},updated(e,{value:t}){e._assigning||qS(e,t)}};function qS(e,t){const n=e.multiple,l=Ri(t);if(!(n&&!l&&!Lp(t))){for(let h=0,d=e.options.length;h<d;h++){const g=e.options[h],b=dg(g);if(n)if(l){const r=typeof b;r==="string"||r==="number"?g.selected=t.some(C=>String(C)===String(b)):g.selected=vv(t,b)>-1}else g.selected=t.has(b);else if(Pd(dg(g),t)){e.selectedIndex!==h&&(e.selectedIndex=h);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function dg(e){return"_value"in e?e._value:e.value}function AI(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const TT={created(e,t,n){l0(e,t,n,null,"created")},mounted(e,t,n){l0(e,t,n,null,"mounted")},beforeUpdate(e,t,n,l){l0(e,t,n,l,"beforeUpdate")},updated(e,t,n,l){l0(e,t,n,l,"updated")}};function kI(e,t){switch(e){case"SELECT":return kd;case"TEXTAREA":return tc;default:switch(t){case"checkbox":return Rv;case"radio":return wT;default:return tc}}}function l0(e,t,n,l,h){const g=kI(e.tagName,n.props&&n.props.type)[h];g&&g(e,t,n,l)}function j3(){tc.getSSRProps=({value:e})=>({value:e}),wT.getSSRProps=({value:e},t)=>{if(t.props&&Pd(t.props.value,e))return{checked:!0}},Rv.getSSRProps=({value:e},t)=>{if(Ri(e)){if(t.props&&vv(e,t.props.value)>-1)return{checked:!0}}else if(Lp(e)){if(t.props&&e.has(t.props.value))return{checked:!0}}else if(e)return{checked:!0}},TT.getSSRProps=(e,t)=>{if(typeof t.type!="string")return;const n=kI(t.type.toUpperCase(),t.props&&t.props.type);if(n.getSSRProps)return n.getSSRProps(e,t)}}const $3=["ctrl","shift","alt","meta"],W3={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>$3.some(n=>e[`${n}Key`]&&!t.includes(n))},xy=(e,t)=>{const n=e._withMods||(e._withMods={}),l=t.join(".");return n[l]||(n[l]=(h,...d)=>{for(let g=0;g<t.length;g++){const b=W3[t[g]];if(b&&b(h,t))return}return e(h,...d)})},G3={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},H3=(e,t)=>{const n=e._withKeys||(e._withKeys={}),l=t.join(".");return n[l]||(n[l]=h=>{if(!("key"in h))return;const d=Ma(h.key);if(t.some(g=>g===d||G3[g]===d))return e(h)})},II=Ls({patchProp:k3},d3);let iy,XS=!1;function PI(){return iy||(iy=Gk(II))}function LI(){return iy=XS?iy:Hk(II),XS=!0,iy}const DI=(...e)=>{PI().render(...e)},q3=(...e)=>{LI().hydrate(...e)},vy=(...e)=>{const t=PI().createApp(...e),{mount:n}=t;return t.mount=l=>{const h=zI(l);if(!h)return;const d=t._component;!on(d)&&!d.render&&!d.template&&(d.template=h.innerHTML),h.nodeType===1&&(h.textContent="");const g=n(h,!1,RI(h));return h instanceof Element&&(h.removeAttribute("v-cloak"),h.setAttribute("data-v-app","")),g},t},OI=(...e)=>{const t=LI().createApp(...e),{mount:n}=t;return t.mount=l=>{const h=zI(l);if(h)return n(h,!0,RI(h))},t};function RI(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function zI(e){return Vs(e)?document.querySelector(e):e}let ZS=!1;const X3=()=>{ZS||(ZS=!0,j3(),_3())};/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Z3=()=>{},Y3=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:bk,BaseTransitionPropsValidators:cT,Comment:Lr,DeprecationTypes:c3,EffectScope:Qw,ErrorCodes:TR,ErrorTypeStrings:i3,Fragment:Dn,KeepAlive:ZR,ReactiveEffect:hy,Static:Tp,Suspense:Fz,Teleport:PR,Text:ou,TrackOpTypes:gR,Transition:_I,TransitionGroup:CI,TriggerOpTypes:_R,VueElement:Ov,assertNumber:wR,callWithAsyncErrorHandling:Ml,callWithErrorHandling:wg,camelize:oo,capitalize:By,cloneVNode:ch,compatUtils:l3,compile:Z3,computed:Fn,createApp:vy,createBlock:Qr,createCommentVNode:xs,createElementBlock:Ei,createElementVNode:tt,createHydrationRenderer:Hk,createPropsRestProxy:dz,createRenderer:Gk,createSSRApp:OI,createSlots:QR,createStaticVNode:K0,createTextVNode:fr,createVNode:gn,customRef:rk,defineAsyncComponent:qR,defineComponent:gs,defineCustomElement:TI,defineEmits:iz,defineExpose:nz,defineModel:oz,defineOptions:sz,defineProps:tz,defineSSRCustomElement:P3,defineSlots:rz,devtools:n3,effect:UO,effectScope:bv,getCurrentInstance:lo,getCurrentScope:eT,getCurrentWatcher:yR,getTransitionRawChildren:Av,guardReactiveProps:aI,h:hu,handleError:Op,hasInjectionContext:_T,hydrate:q3,hydrateOnIdle:VR,hydrateOnInteraction:GR,hydrateOnMediaQuery:WR,hydrateOnVisible:$R,initCustomFormatter:Qz,initDirectivesForSSR:X3,inject:ia,isMemoSame:fI,isProxy:bg,isReactive:lc,isReadonly:Ld,isRef:Zs,isRuntimeOnly:Yz,isShallow:tl,isVNode:cu,markRaw:Mv,mergeDefaults:hz,mergeModels:uz,mergeProps:Uy,nextTick:Fd,normalizeClass:Jr,normalizeProps:RO,normalizeStyle:uc,onActivated:Tk,onBeforeMount:uT,onBeforeUnmount:Tg,onBeforeUpdate:dT,onDeactivated:Ek,onErrorCaptured:kk,onMounted:nl,onRenderTracked:Ak,onRenderTriggered:Ck,onScopeDispose:jA,onServerPrefetch:Mk,onUnmounted:Eg,onUpdated:Iv,onWatcherCleanup:ck,openBlock:ui,popScopeId:AR,provide:ey,proxyRefs:oT,pushScopeId:CR,queuePostFlushCb:fy,reactive:vg,readonly:rT,ref:Vi,registerRuntimeCompiler:Zz,render:DI,renderList:ta,renderSlot:Pk,resolveComponent:rh,resolveDirective:JR,resolveDynamicComponent:Pv,resolveFilter:a3,resolveTransitionHooks:cg,setBlockTracking:lw,setDevtoolsHook:s3,setTransitionHooks:lu,shallowReactive:sT,shallowReadonly:oR,shallowRef:Dp,ssrContextKey:Yk,ssrUtils:o3,stop:VO,toDisplayString:Ht,toHandlerKey:Z_,toHandlers:Lk,toRaw:Sn,toRef:ak,toRefs:ok,toValue:cR,transformVNodeArgs:Wz,triggerRef:lR,unref:hs,useAttrs:cz,useCssModule:O3,useCssVars:y3,useHost:EI,useId:DR,useModel:Pz,useSSRContext:Kk,useShadowRoot:D3,useSlots:lz,useTemplateRef:OR,useTransitionState:lT,vModelCheckbox:Rv,vModelDynamic:TT,vModelRadio:wT,vModelSelect:kd,vModelText:tc,vShow:bI,version:bT,warn:t3,watch:eo,watchEffect:Az,watchPostEffect:kz,watchSyncEffect:Jk,withAsyncContext:fz,withCtx:Kr,withDefaults:az,withDirectives:Mo,withKeys:H3,withMemo:e3,withModifiers:xy,withScopeId:kR},Symbol.toStringTag,{value:"Module"})),ET="/projects/soil_values/assets/DGIS_logo-BMUz1Rxj.webp",BI="/projects/soil_values/assets/logo-CicDM-h9.png";/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Ym=typeof document<"u";function FI(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function K3(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&FI(e.default)}const ps=Object.assign;function E1(e,t){const n={};for(const l in t){const h=t[l];n[l]=hc(h)?h.map(e):e(h)}return n}const ny=()=>{},hc=Array.isArray,NI=/#/g,J3=/&/g,Q3=/\//g,eB=/=/g,tB=/\?/g,UI=/\+/g,iB=/%5B/g,nB=/%5D/g,VI=/%5E/g,sB=/%60/g,jI=/%7B/g,rB=/%7C/g,$I=/%7D/g,oB=/%20/g;function ST(e){return encodeURI(""+e).replace(rB,"|").replace(iB,"[").replace(nB,"]")}function aB(e){return ST(e).replace(jI,"{").replace($I,"}").replace(VI,"^")}function _w(e){return ST(e).replace(UI,"%2B").replace(oB,"+").replace(NI,"%23").replace(J3,"%26").replace(sB,"`").replace(jI,"{").replace($I,"}").replace(VI,"^")}function lB(e){return _w(e).replace(eB,"%3D")}function cB(e){return ST(e).replace(NI,"%23").replace(tB,"%3F")}function hB(e){return e==null?"":cB(e).replace(Q3,"%2F")}function by(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const uB=/\/$/,dB=e=>e.replace(uB,"");function S1(e,t,n="/"){let l,h={},d="",g="";const b=t.indexOf("#");let r=t.indexOf("?");return b<r&&b>=0&&(r=-1),r>-1&&(l=t.slice(0,r),d=t.slice(r+1,b>-1?b:t.length),h=e(d)),b>-1&&(l=l||t.slice(0,b),g=t.slice(b,t.length)),l=gB(l??t,n),{fullPath:l+(d&&"?")+d+g,path:l,query:h,hash:by(g)}}function fB(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function YS(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function pB(e,t,n){const l=t.matched.length-1,h=n.matched.length-1;return l>-1&&l===h&&fg(t.matched[l],n.matched[h])&&WI(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function fg(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function WI(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!mB(e[n],t[n]))return!1;return!0}function mB(e,t){return hc(e)?KS(e,t):hc(t)?KS(t,e):e===t}function KS(e,t){return hc(t)?e.length===t.length&&e.every((n,l)=>n===t[l]):e.length===1&&e[0]===t}function gB(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),l=e.split("/"),h=l[l.length-1];(h===".."||h===".")&&l.push("");let d=n.length-1,g,b;for(g=0;g<l.length;g++)if(b=l[g],b!==".")if(b==="..")d>1&&d--;else break;return n.slice(0,d).join("/")+"/"+l.slice(g).join("/")}const md={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var wy;(function(e){e.pop="pop",e.push="push"})(wy||(wy={}));var sy;(function(e){e.back="back",e.forward="forward",e.unknown=""})(sy||(sy={}));function _B(e){if(!e)if(Ym){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),dB(e)}const yB=/^[^#]+#/;function xB(e,t){return e.replace(yB,"#")+t}function vB(e,t){const n=document.documentElement.getBoundingClientRect(),l=e.getBoundingClientRect();return{behavior:t.behavior,left:l.left-n.left-(t.left||0),top:l.top-n.top-(t.top||0)}}const zv=()=>({left:window.scrollX,top:window.scrollY});function bB(e){let t;if("el"in e){const n=e.el,l=typeof n=="string"&&n.startsWith("#"),h=typeof n=="string"?l?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!h)return;t=vB(h,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function JS(e,t){return(history.state?history.state.position-t:-1)+e}const yw=new Map;function wB(e,t){yw.set(e,t)}function TB(e){const t=yw.get(e);return yw.delete(e),t}let EB=()=>location.protocol+"//"+location.host;function GI(e,t){const{pathname:n,search:l,hash:h}=t,d=e.indexOf("#");if(d>-1){let b=h.includes(e.slice(d))?e.slice(d).length:1,r=h.slice(b);return r[0]!=="/"&&(r="/"+r),YS(r,"")}return YS(n,e)+l+h}function SB(e,t,n,l){let h=[],d=[],g=null;const b=({state:$})=>{const q=GI(e,location),ee=n.value,ie=t.value;let de=0;if($){if(n.value=q,t.value=$,g&&g===ee){g=null;return}de=ie?$.position-ie.position:0}else l(q);h.forEach(ye=>{ye(n.value,ee,{delta:de,type:wy.pop,direction:de?de>0?sy.forward:sy.back:sy.unknown})})};function r(){g=n.value}function C($){h.push($);const q=()=>{const ee=h.indexOf($);ee>-1&&h.splice(ee,1)};return d.push(q),q}function O(){const{history:$}=window;$.state&&$.replaceState(ps({},$.state,{scroll:zv()}),"")}function U(){for(const $ of d)$();d=[],window.removeEventListener("popstate",b),window.removeEventListener("beforeunload",O)}return window.addEventListener("popstate",b),window.addEventListener("beforeunload",O,{passive:!0}),{pauseListeners:r,listen:C,destroy:U}}function QS(e,t,n,l=!1,h=!1){return{back:e,current:t,forward:n,replaced:l,position:window.history.length,scroll:h?zv():null}}function MB(e){const{history:t,location:n}=window,l={value:GI(e,n)},h={value:t.state};h.value||d(l.value,{back:null,current:l.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function d(r,C,O){const U=e.indexOf("#"),$=U>-1?(n.host&&document.querySelector("base")?e:e.slice(U))+r:EB()+e+r;try{t[O?"replaceState":"pushState"](C,"",$),h.value=C}catch(q){console.error(q),n[O?"replace":"assign"]($)}}function g(r,C){const O=ps({},t.state,QS(h.value.back,r,h.value.forward,!0),C,{position:h.value.position});d(r,O,!0),l.value=r}function b(r,C){const O=ps({},h.value,t.state,{forward:r,scroll:zv()});d(O.current,O,!0);const U=ps({},QS(l.value,r,null),{position:O.position+1},C);d(r,U,!1),l.value=r}return{location:l,state:h,push:b,replace:g}}function CB(e){e=_B(e);const t=MB(e),n=SB(e,t.state,t.location,t.replace);function l(d,g=!0){g||n.pauseListeners(),history.go(d)}const h=ps({location:"",base:e,go:l,createHref:xB.bind(null,e)},t,n);return Object.defineProperty(h,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(h,"state",{enumerable:!0,get:()=>t.state.value}),h}function AB(e){return typeof e=="string"||e&&typeof e=="object"}function HI(e){return typeof e=="string"||typeof e=="symbol"}const qI=Symbol("");var eM;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(eM||(eM={}));function pg(e,t){return ps(new Error,{type:e,[qI]:!0},t)}function Hh(e,t){return e instanceof Error&&qI in e&&(t==null||!!(e.type&t))}const tM="[^/]+?",kB={sensitive:!1,strict:!1,start:!0,end:!0},IB=/[.+*?^${}()[\]/\\]/g;function PB(e,t){const n=ps({},kB,t),l=[];let h=n.start?"^":"";const d=[];for(const C of e){const O=C.length?[]:[90];n.strict&&!C.length&&(h+="/");for(let U=0;U<C.length;U++){const $=C[U];let q=40+(n.sensitive?.25:0);if($.type===0)U||(h+="/"),h+=$.value.replace(IB,"\\$&"),q+=40;else if($.type===1){const{value:ee,repeatable:ie,optional:de,regexp:ye}=$;d.push({name:ee,repeatable:ie,optional:de});const be=ye||tM;if(be!==tM){q+=10;try{new RegExp(`(${be})`)}catch(he){throw new Error(`Invalid custom RegExp for param "${ee}" (${be}): `+he.message)}}let se=ie?`((?:${be})(?:/(?:${be}))*)`:`(${be})`;U||(se=de&&C.length<2?`(?:/${se})`:"/"+se),de&&(se+="?"),h+=se,q+=20,de&&(q+=-8),ie&&(q+=-20),be===".*"&&(q+=-50)}O.push(q)}l.push(O)}if(n.strict&&n.end){const C=l.length-1;l[C][l[C].length-1]+=.7000000000000001}n.strict||(h+="/?"),n.end?h+="$":n.strict&&!h.endsWith("/")&&(h+="(?:/|$)");const g=new RegExp(h,n.sensitive?"":"i");function b(C){const O=C.match(g),U={};if(!O)return null;for(let $=1;$<O.length;$++){const q=O[$]||"",ee=d[$-1];U[ee.name]=q&&ee.repeatable?q.split("/"):q}return U}function r(C){let O="",U=!1;for(const $ of e){(!U||!O.endsWith("/"))&&(O+="/"),U=!1;for(const q of $)if(q.type===0)O+=q.value;else if(q.type===1){const{value:ee,repeatable:ie,optional:de}=q,ye=ee in C?C[ee]:"";if(hc(ye)&&!ie)throw new Error(`Provided param "${ee}" is an array but it is not repeatable (* or + modifiers)`);const be=hc(ye)?ye.join("/"):ye;if(!be)if(de)$.length<2&&(O.endsWith("/")?O=O.slice(0,-1):U=!0);else throw new Error(`Missing required param "${ee}"`);O+=be}}return O||"/"}return{re:g,score:l,keys:d,parse:b,stringify:r}}function LB(e,t){let n=0;for(;n<e.length&&n<t.length;){const l=t[n]-e[n];if(l)return l;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function XI(e,t){let n=0;const l=e.score,h=t.score;for(;n<l.length&&n<h.length;){const d=LB(l[n],h[n]);if(d)return d;n++}if(Math.abs(h.length-l.length)===1){if(iM(l))return 1;if(iM(h))return-1}return h.length-l.length}function iM(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const DB={type:0,value:""},OB=/[a-zA-Z0-9_]/;function RB(e){if(!e)return[[]];if(e==="/")return[[DB]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(q){throw new Error(`ERR (${n})/"${C}": ${q}`)}let n=0,l=n;const h=[];let d;function g(){d&&h.push(d),d=[]}let b=0,r,C="",O="";function U(){C&&(n===0?d.push({type:0,value:C}):n===1||n===2||n===3?(d.length>1&&(r==="*"||r==="+")&&t(`A repeatable param (${C}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:C,regexp:O,repeatable:r==="*"||r==="+",optional:r==="*"||r==="?"})):t("Invalid state to consume buffer"),C="")}function $(){C+=r}for(;b<e.length;){if(r=e[b++],r==="\\"&&n!==2){l=n,n=4;continue}switch(n){case 0:r==="/"?(C&&U(),g()):r===":"?(U(),n=1):$();break;case 4:$(),n=l;break;case 1:r==="("?n=2:OB.test(r)?$():(U(),n=0,r!=="*"&&r!=="?"&&r!=="+"&&b--);break;case 2:r===")"?O[O.length-1]=="\\"?O=O.slice(0,-1)+r:n=3:O+=r;break;case 3:U(),n=0,r!=="*"&&r!=="?"&&r!=="+"&&b--,O="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${C}"`),U(),g(),h}function zB(e,t,n){const l=PB(RB(e.path),n),h=ps(l,{record:e,parent:t,children:[],alias:[]});return t&&!h.record.aliasOf==!t.record.aliasOf&&t.children.push(h),h}function BB(e,t){const n=[],l=new Map;t=oM({strict:!1,end:!0,sensitive:!1},t);function h(U){return l.get(U)}function d(U,$,q){const ee=!q,ie=sM(U);ie.aliasOf=q&&q.record;const de=oM(t,U),ye=[ie];if("alias"in U){const he=typeof U.alias=="string"?[U.alias]:U.alias;for(const fe of he)ye.push(sM(ps({},ie,{components:q?q.record.components:ie.components,path:fe,aliasOf:q?q.record:ie})))}let be,se;for(const he of ye){const{path:fe}=he;if($&&fe[0]!=="/"){const Me=$.record.path,ze=Me[Me.length-1]==="/"?"":"/";he.path=$.record.path+(fe&&ze+fe)}if(be=zB(he,$,de),q?q.alias.push(be):(se=se||be,se!==be&&se.alias.push(be),ee&&U.name&&!rM(be)&&g(U.name)),ZI(be)&&r(be),ie.children){const Me=ie.children;for(let ze=0;ze<Me.length;ze++)d(Me[ze],be,q&&q.children[ze])}q=q||be}return se?()=>{g(se)}:ny}function g(U){if(HI(U)){const $=l.get(U);$&&(l.delete(U),n.splice(n.indexOf($),1),$.children.forEach(g),$.alias.forEach(g))}else{const $=n.indexOf(U);$>-1&&(n.splice($,1),U.record.name&&l.delete(U.record.name),U.children.forEach(g),U.alias.forEach(g))}}function b(){return n}function r(U){const $=UB(U,n);n.splice($,0,U),U.record.name&&!rM(U)&&l.set(U.record.name,U)}function C(U,$){let q,ee={},ie,de;if("name"in U&&U.name){if(q=l.get(U.name),!q)throw pg(1,{location:U});de=q.record.name,ee=ps(nM($.params,q.keys.filter(se=>!se.optional).concat(q.parent?q.parent.keys.filter(se=>se.optional):[]).map(se=>se.name)),U.params&&nM(U.params,q.keys.map(se=>se.name))),ie=q.stringify(ee)}else if(U.path!=null)ie=U.path,q=n.find(se=>se.re.test(ie)),q&&(ee=q.parse(ie),de=q.record.name);else{if(q=$.name?l.get($.name):n.find(se=>se.re.test($.path)),!q)throw pg(1,{location:U,currentLocation:$});de=q.record.name,ee=ps({},$.params,U.params),ie=q.stringify(ee)}const ye=[];let be=q;for(;be;)ye.unshift(be.record),be=be.parent;return{name:de,path:ie,params:ee,matched:ye,meta:NB(ye)}}e.forEach(U=>d(U));function O(){n.length=0,l.clear()}return{addRoute:d,resolve:C,removeRoute:g,clearRoutes:O,getRoutes:b,getRecordMatcher:h}}function nM(e,t){const n={};for(const l of t)l in e&&(n[l]=e[l]);return n}function sM(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:FB(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function FB(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const l in e.components)t[l]=typeof n=="object"?n[l]:n;return t}function rM(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function NB(e){return e.reduce((t,n)=>ps(t,n.meta),{})}function oM(e,t){const n={};for(const l in e)n[l]=l in t?t[l]:e[l];return n}function UB(e,t){let n=0,l=t.length;for(;n!==l;){const d=n+l>>1;XI(e,t[d])<0?l=d:n=d+1}const h=VB(e);return h&&(l=t.lastIndexOf(h,l-1)),l}function VB(e){let t=e;for(;t=t.parent;)if(ZI(t)&&XI(e,t)===0)return t}function ZI({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function jB(e){const t={};if(e===""||e==="?")return t;const l=(e[0]==="?"?e.slice(1):e).split("&");for(let h=0;h<l.length;++h){const d=l[h].replace(UI," "),g=d.indexOf("="),b=by(g<0?d:d.slice(0,g)),r=g<0?null:by(d.slice(g+1));if(b in t){let C=t[b];hc(C)||(C=t[b]=[C]),C.push(r)}else t[b]=r}return t}function aM(e){let t="";for(let n in e){const l=e[n];if(n=lB(n),l==null){l!==void 0&&(t+=(t.length?"&":"")+n);continue}(hc(l)?l.map(d=>d&&_w(d)):[l&&_w(l)]).forEach(d=>{d!==void 0&&(t+=(t.length?"&":"")+n,d!=null&&(t+="="+d))})}return t}function $B(e){const t={};for(const n in e){const l=e[n];l!==void 0&&(t[n]=hc(l)?l.map(h=>h==null?null:""+h):l==null?l:""+l)}return t}const WB=Symbol(""),lM=Symbol(""),Bv=Symbol(""),MT=Symbol(""),xw=Symbol("");function O_(){let e=[];function t(l){return e.push(l),()=>{const h=e.indexOf(l);h>-1&&e.splice(h,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function Ed(e,t,n,l,h,d=g=>g()){const g=l&&(l.enterCallbacks[h]=l.enterCallbacks[h]||[]);return()=>new Promise((b,r)=>{const C=$=>{$===!1?r(pg(4,{from:n,to:t})):$ instanceof Error?r($):AB($)?r(pg(2,{from:t,to:$})):(g&&l.enterCallbacks[h]===g&&typeof $=="function"&&g.push($),b())},O=d(()=>e.call(l&&l.instances[h],t,n,C));let U=Promise.resolve(O);e.length<3&&(U=U.then(C)),U.catch($=>r($))})}function M1(e,t,n,l,h=d=>d()){const d=[];for(const g of e)for(const b in g.components){let r=g.components[b];if(!(t!=="beforeRouteEnter"&&!g.instances[b]))if(FI(r)){const O=(r.__vccOpts||r)[t];O&&d.push(Ed(O,n,l,g,b,h))}else{let C=r();d.push(()=>C.then(O=>{if(!O)throw new Error(`Couldn't resolve component "${b}" at "${g.path}"`);const U=K3(O)?O.default:O;g.mods[b]=O,g.components[b]=U;const q=(U.__vccOpts||U)[t];return q&&Ed(q,n,l,g,b,h)()}))}}return d}function cM(e){const t=ia(Bv),n=ia(MT),l=Fn(()=>{const r=hs(e.to);return t.resolve(r)}),h=Fn(()=>{const{matched:r}=l.value,{length:C}=r,O=r[C-1],U=n.matched;if(!O||!U.length)return-1;const $=U.findIndex(fg.bind(null,O));if($>-1)return $;const q=hM(r[C-2]);return C>1&&hM(O)===q&&U[U.length-1].path!==q?U.findIndex(fg.bind(null,r[C-2])):$}),d=Fn(()=>h.value>-1&&ZB(n.params,l.value.params)),g=Fn(()=>h.value>-1&&h.value===n.matched.length-1&&WI(n.params,l.value.params));function b(r={}){if(XB(r)){const C=t[hs(e.replace)?"replace":"push"](hs(e.to)).catch(ny);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>C),C}return Promise.resolve()}return{route:l,href:Fn(()=>l.value.href),isActive:d,isExactActive:g,navigate:b}}function GB(e){return e.length===1?e[0]:e}const HB=gs({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:cM,setup(e,{slots:t}){const n=vg(cM(e)),{options:l}=ia(Bv),h=Fn(()=>({[uM(e.activeClass,l.linkActiveClass,"router-link-active")]:n.isActive,[uM(e.exactActiveClass,l.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const d=t.default&&GB(t.default(n));return e.custom?d:hu("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:h.value},d)}}}),qB=HB;function XB(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function ZB(e,t){for(const n in t){const l=t[n],h=e[n];if(typeof l=="string"){if(l!==h)return!1}else if(!hc(h)||h.length!==l.length||l.some((d,g)=>d!==h[g]))return!1}return!0}function hM(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const uM=(e,t,n)=>e??t??n,YB=gs({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const l=ia(xw),h=Fn(()=>e.route||l.value),d=ia(lM,0),g=Fn(()=>{let C=hs(d);const{matched:O}=h.value;let U;for(;(U=O[C])&&!U.components;)C++;return C}),b=Fn(()=>h.value.matched[g.value]);ey(lM,Fn(()=>g.value+1)),ey(WB,b),ey(xw,h);const r=Vi();return eo(()=>[r.value,b.value,e.name],([C,O,U],[$,q,ee])=>{O&&(O.instances[U]=C,q&&q!==O&&C&&C===$&&(O.leaveGuards.size||(O.leaveGuards=q.leaveGuards),O.updateGuards.size||(O.updateGuards=q.updateGuards))),C&&O&&(!q||!fg(O,q)||!$)&&(O.enterCallbacks[U]||[]).forEach(ie=>ie(C))},{flush:"post"}),()=>{const C=h.value,O=e.name,U=b.value,$=U&&U.components[O];if(!$)return dM(n.default,{Component:$,route:C});const q=U.props[O],ee=q?q===!0?C.params:typeof q=="function"?q(C):q:null,de=hu($,ps({},ee,t,{onVnodeUnmounted:ye=>{ye.component.isUnmounted&&(U.instances[O]=null)},ref:r}));return dM(n.default,{Component:de,route:C})||de}}});function dM(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const KB=YB;function JB(e){const t=BB(e.routes,e),n=e.parseQuery||jB,l=e.stringifyQuery||aM,h=e.history,d=O_(),g=O_(),b=O_(),r=Dp(md);let C=md;Ym&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const O=E1.bind(null,nt=>""+nt),U=E1.bind(null,hB),$=E1.bind(null,by);function q(nt,Mt){let xt,jt;return HI(nt)?(xt=t.getRecordMatcher(nt),jt=Mt):jt=nt,t.addRoute(jt,xt)}function ee(nt){const Mt=t.getRecordMatcher(nt);Mt&&t.removeRoute(Mt)}function ie(){return t.getRoutes().map(nt=>nt.record)}function de(nt){return!!t.getRecordMatcher(nt)}function ye(nt,Mt){if(Mt=ps({},Mt||r.value),typeof nt=="string"){const Ce=S1(n,nt,Mt.path),ct=t.resolve({path:Ce.path},Mt),Bt=h.createHref(Ce.fullPath);return ps(Ce,ct,{params:$(ct.params),hash:by(Ce.hash),redirectedFrom:void 0,href:Bt})}let xt;if(nt.path!=null)xt=ps({},nt,{path:S1(n,nt.path,Mt.path).path});else{const Ce=ps({},nt.params);for(const ct in Ce)Ce[ct]==null&&delete Ce[ct];xt=ps({},nt,{params:U(Ce)}),Mt.params=U(Mt.params)}const jt=t.resolve(xt,Mt),ki=nt.hash||"";jt.params=O($(jt.params));const ai=fB(l,ps({},nt,{hash:aB(ki),path:jt.path})),Ee=h.createHref(ai);return ps({fullPath:ai,hash:ki,query:l===aM?$B(nt.query):nt.query||{}},jt,{redirectedFrom:void 0,href:Ee})}function be(nt){return typeof nt=="string"?S1(n,nt,r.value.path):ps({},nt)}function se(nt,Mt){if(C!==nt)return pg(8,{from:Mt,to:nt})}function he(nt){return ze(nt)}function fe(nt){return he(ps(be(nt),{replace:!0}))}function Me(nt){const Mt=nt.matched[nt.matched.length-1];if(Mt&&Mt.redirect){const{redirect:xt}=Mt;let jt=typeof xt=="function"?xt(nt):xt;return typeof jt=="string"&&(jt=jt.includes("?")||jt.includes("#")?jt=be(jt):{path:jt},jt.params={}),ps({query:nt.query,hash:nt.hash,params:jt.path!=null?{}:nt.params},jt)}}function ze(nt,Mt){const xt=C=ye(nt),jt=r.value,ki=nt.state,ai=nt.force,Ee=nt.replace===!0,Ce=Me(xt);if(Ce)return ze(ps(be(Ce),{state:typeof Ce=="object"?ps({},ki,Ce.state):ki,force:ai,replace:Ee}),Mt||xt);const ct=xt;ct.redirectedFrom=Mt;let Bt;return!ai&&pB(l,jt,xt)&&(Bt=pg(16,{to:ct,from:jt}),Ni(jt,jt,!0,!1)),(Bt?Promise.resolve(Bt):Ne(ct,jt)).catch(Dt=>Hh(Dt)?Hh(Dt,2)?Dt:pn(Dt):oi(Dt,ct,jt)).then(Dt=>{if(Dt){if(Hh(Dt,2))return ze(ps({replace:Ee},be(Dt.to),{state:typeof Dt.to=="object"?ps({},ki,Dt.to.state):ki,force:ai}),Mt||ct)}else Dt=Qe(ct,jt,!0,Ee,ki);return it(ct,jt,Dt),Dt})}function ve(nt,Mt){const xt=se(nt,Mt);return xt?Promise.reject(xt):Promise.resolve()}function Ue(nt){const Mt=Hi.values().next().value;return Mt&&typeof Mt.runWithContext=="function"?Mt.runWithContext(nt):nt()}function Ne(nt,Mt){let xt;const[jt,ki,ai]=QB(nt,Mt);xt=M1(jt.reverse(),"beforeRouteLeave",nt,Mt);for(const Ce of jt)Ce.leaveGuards.forEach(ct=>{xt.push(Ed(ct,nt,Mt))});const Ee=ve.bind(null,nt,Mt);return xt.push(Ee),wn(xt).then(()=>{xt=[];for(const Ce of d.list())xt.push(Ed(Ce,nt,Mt));return xt.push(Ee),wn(xt)}).then(()=>{xt=M1(ki,"beforeRouteUpdate",nt,Mt);for(const Ce of ki)Ce.updateGuards.forEach(ct=>{xt.push(Ed(ct,nt,Mt))});return xt.push(Ee),wn(xt)}).then(()=>{xt=[];for(const Ce of ai)if(Ce.beforeEnter)if(hc(Ce.beforeEnter))for(const ct of Ce.beforeEnter)xt.push(Ed(ct,nt,Mt));else xt.push(Ed(Ce.beforeEnter,nt,Mt));return xt.push(Ee),wn(xt)}).then(()=>(nt.matched.forEach(Ce=>Ce.enterCallbacks={}),xt=M1(ai,"beforeRouteEnter",nt,Mt,Ue),xt.push(Ee),wn(xt))).then(()=>{xt=[];for(const Ce of g.list())xt.push(Ed(Ce,nt,Mt));return xt.push(Ee),wn(xt)}).catch(Ce=>Hh(Ce,8)?Ce:Promise.reject(Ce))}function it(nt,Mt,xt){b.list().forEach(jt=>Ue(()=>jt(nt,Mt,xt)))}function Qe(nt,Mt,xt,jt,ki){const ai=se(nt,Mt);if(ai)return ai;const Ee=Mt===md,Ce=Ym?history.state:{};xt&&(jt||Ee?h.replace(nt.fullPath,ps({scroll:Ee&&Ce&&Ce.scroll},ki)):h.push(nt.fullPath,ki)),r.value=nt,Ni(nt,Mt,xt,Ee),pn()}let Xe;function Tt(){Xe||(Xe=h.listen((nt,Mt,xt)=>{if(!Zn.listening)return;const jt=ye(nt),ki=Me(jt);if(ki){ze(ps(ki,{replace:!0,force:!0}),jt).catch(ny);return}C=jt;const ai=r.value;Ym&&wB(JS(ai.fullPath,xt.delta),zv()),Ne(jt,ai).catch(Ee=>Hh(Ee,12)?Ee:Hh(Ee,2)?(ze(ps(be(Ee.to),{force:!0}),jt).then(Ce=>{Hh(Ce,20)&&!xt.delta&&xt.type===wy.pop&&h.go(-1,!1)}).catch(ny),Promise.reject()):(xt.delta&&h.go(-xt.delta,!1),oi(Ee,jt,ai))).then(Ee=>{Ee=Ee||Qe(jt,ai,!1),Ee&&(xt.delta&&!Hh(Ee,8)?h.go(-xt.delta,!1):xt.type===wy.pop&&Hh(Ee,20)&&h.go(-1,!1)),it(jt,ai,Ee)}).catch(ny)}))}let Rt=O_(),St=O_(),Pt;function oi(nt,Mt,xt){pn(nt);const jt=St.list();return jt.length?jt.forEach(ki=>ki(nt,Mt,xt)):console.error(nt),Promise.reject(nt)}function ci(){return Pt&&r.value!==md?Promise.resolve():new Promise((nt,Mt)=>{Rt.add([nt,Mt])})}function pn(nt){return Pt||(Pt=!nt,Tt(),Rt.list().forEach(([Mt,xt])=>nt?xt(nt):Mt()),Rt.reset()),nt}function Ni(nt,Mt,xt,jt){const{scrollBehavior:ki}=e;if(!Ym||!ki)return Promise.resolve();const ai=!xt&&TB(JS(nt.fullPath,0))||(jt||!xt)&&history.state&&history.state.scroll||null;return Fd().then(()=>ki(nt,Mt,ai)).then(Ee=>Ee&&bB(Ee)).catch(Ee=>oi(Ee,nt,Mt))}const ji=nt=>h.go(nt);let An;const Hi=new Set,Zn={currentRoute:r,listening:!0,addRoute:q,removeRoute:ee,clearRoutes:t.clearRoutes,hasRoute:de,getRoutes:ie,resolve:ye,options:e,push:he,replace:fe,go:ji,back:()=>ji(-1),forward:()=>ji(1),beforeEach:d.add,beforeResolve:g.add,afterEach:b.add,onError:St.add,isReady:ci,install(nt){const Mt=this;nt.component("RouterLink",qB),nt.component("RouterView",KB),nt.config.globalProperties.$router=Mt,Object.defineProperty(nt.config.globalProperties,"$route",{enumerable:!0,get:()=>hs(r)}),Ym&&!An&&r.value===md&&(An=!0,he(h.location).catch(ki=>{}));const xt={};for(const ki in md)Object.defineProperty(xt,ki,{get:()=>r.value[ki],enumerable:!0});nt.provide(Bv,Mt),nt.provide(MT,sT(xt)),nt.provide(xw,r);const jt=nt.unmount;Hi.add(nt),nt.unmount=function(){Hi.delete(nt),Hi.size<1&&(C=md,Xe&&Xe(),Xe=null,r.value=md,An=!1,Pt=!1),jt()}}};function wn(nt){return nt.reduce((Mt,xt)=>Mt.then(()=>Ue(xt)),Promise.resolve())}return Zn}function QB(e,t){const n=[],l=[],h=[],d=Math.max(t.matched.length,e.matched.length);for(let g=0;g<d;g++){const b=t.matched[g];b&&(e.matched.find(C=>fg(C,b))?l.push(b):n.push(b));const r=e.matched[g];r&&(t.matched.find(C=>fg(C,r))||h.push(r))}return[n,l,h]}function YI(){return ia(Bv)}function KI(e){return ia(MT)}/*!
  * shared v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function eF(e,t){typeof console<"u"&&(console.warn("[intlify] "+e),t&&console.warn(t.stack))}const nv=typeof window<"u",Nd=(e,t=!1)=>t?Symbol.for(e):Symbol(e),tF=(e,t,n)=>iF({l:e,k:t,s:n}),iF=e=>JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),yr=e=>typeof e=="number"&&isFinite(e),nF=e=>QI(e)==="[object Date]",Od=e=>QI(e)==="[object RegExp]",Fv=e=>fn(e)&&Object.keys(e).length===0,ao=Object.assign,sF=Object.create,Ss=(e=null)=>sF(e);let fM;const nu=()=>fM||(fM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:Ss());function pM(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2F;").replace(/=/g,"&#x3D;")}function mM(e){return e.replace(/&(?![a-zA-Z0-9#]{2,6};)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function rF(e){return e=e.replace(/(\w+)\s*=\s*"([^"]*)"/g,(l,h,d)=>`${h}="${mM(d)}"`),e=e.replace(/(\w+)\s*=\s*'([^']*)'/g,(l,h,d)=>`${h}='${mM(d)}'`),/\s*on\w+\s*=\s*["']?[^"'>]+["']?/gi.test(e)&&(e=e.replace(/(\s+)(on)(\w+\s*=)/gi,"$1&#111;n$3")),[/(\s+(?:href|src|action|formaction)\s*=\s*["']?)\s*javascript:/gi,/(style\s*=\s*["'][^"']*url\s*\(\s*)javascript:/gi].forEach(l=>{e=e.replace(l,"$1javascript&#58;")}),e}const oF=Object.prototype.hasOwnProperty;function sc(e,t){return oF.call(e,t)}const Xs=Array.isArray,Us=e=>typeof e=="function",Mi=e=>typeof e=="string",Ln=e=>typeof e=="boolean",ts=e=>e!==null&&typeof e=="object",aF=e=>ts(e)&&Us(e.then)&&Us(e.catch),JI=Object.prototype.toString,QI=e=>JI.call(e),fn=e=>{if(!ts(e))return!1;const t=Object.getPrototypeOf(e);return t===null||t.constructor===Object},lF=e=>e==null?"":Xs(e)||fn(e)&&e.toString===JI?JSON.stringify(e,null,2):String(e);function cF(e,t=""){return e.reduce((n,l,h)=>h===0?n+l:n+t+l,"")}function Nv(e){let t=e;return()=>++t}const c0=e=>!ts(e)||Xs(e);function P0(e,t){if(c0(e)||c0(t))throw new Error("Invalid value");const n=[{src:e,des:t}];for(;n.length;){const{src:l,des:h}=n.pop();Object.keys(l).forEach(d=>{d!=="__proto__"&&(ts(l[d])&&!ts(h[d])&&(h[d]=Array.isArray(l[d])?[]:Ss()),c0(h[d])||c0(l[d])?h[d]=l[d]:n.push({src:l[d],des:h[d]}))})}}/*!
  * message-compiler v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function hF(e,t,n){return{line:e,column:t,offset:n}}function sv(e,t,n){return{start:e,end:t}}const uF=/\{([0-9a-zA-Z]+)\}/g;function eP(e,...t){return t.length===1&&dF(t[0])&&(t=t[0]),(!t||!t.hasOwnProperty)&&(t={}),e.replace(uF,(n,l)=>t.hasOwnProperty(l)?t[l]:"")}const tP=Object.assign,gM=e=>typeof e=="string",dF=e=>e!==null&&typeof e=="object";function iP(e,t=""){return e.reduce((n,l,h)=>h===0?n+l:n+t+l,"")}const CT={USE_MODULO_SYNTAX:1,__EXTEND_POINT__:2},fF={[CT.USE_MODULO_SYNTAX]:"Use modulo before '{{0}}'."};function pF(e,t,...n){const l=eP(fF[e],...n||[]),h={message:String(l),code:e};return t&&(h.location=t),h}const ln={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,UNHANDLED_CODEGEN_NODE_TYPE:15,UNHANDLED_MINIFIER_NODE_TYPE:16,__EXTEND_POINT__:17},mF={[ln.EXPECTED_TOKEN]:"Expected token: '{0}'",[ln.INVALID_TOKEN_IN_PLACEHOLDER]:"Invalid token in placeholder: '{0}'",[ln.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER]:"Unterminated single quote in placeholder",[ln.UNKNOWN_ESCAPE_SEQUENCE]:"Unknown escape sequence: \\{0}",[ln.INVALID_UNICODE_ESCAPE_SEQUENCE]:"Invalid unicode escape sequence: {0}",[ln.UNBALANCED_CLOSING_BRACE]:"Unbalanced closing brace",[ln.UNTERMINATED_CLOSING_BRACE]:"Unterminated closing brace",[ln.EMPTY_PLACEHOLDER]:"Empty placeholder",[ln.NOT_ALLOW_NEST_PLACEHOLDER]:"Not allowed nest placeholder",[ln.INVALID_LINKED_FORMAT]:"Invalid linked format",[ln.MUST_HAVE_MESSAGES_IN_PLURAL]:"Plural must have messages",[ln.UNEXPECTED_EMPTY_LINKED_MODIFIER]:"Unexpected empty linked modifier",[ln.UNEXPECTED_EMPTY_LINKED_KEY]:"Unexpected empty linked key",[ln.UNEXPECTED_LEXICAL_ANALYSIS]:"Unexpected lexical analysis in token: '{0}'",[ln.UNHANDLED_CODEGEN_NODE_TYPE]:"unhandled codegen node type: '{0}'",[ln.UNHANDLED_MINIFIER_NODE_TYPE]:"unhandled mimifier node type: '{0}'"};function Sg(e,t,n={}){const{domain:l,messages:h,args:d}=n,g=eP((h||mF)[e]||"",...d||[]),b=new SyntaxError(String(g));return b.code=e,t&&(b.location=t),b.domain=l,b}function gF(e){throw e}const qh=" ",_F="\r",Ko=`
`,yF="\u2028",xF="\u2029";function vF(e){const t=e;let n=0,l=1,h=1,d=0;const g=ze=>t[ze]===_F&&t[ze+1]===Ko,b=ze=>t[ze]===Ko,r=ze=>t[ze]===xF,C=ze=>t[ze]===yF,O=ze=>g(ze)||b(ze)||r(ze)||C(ze),U=()=>n,$=()=>l,q=()=>h,ee=()=>d,ie=ze=>g(ze)||r(ze)||C(ze)?Ko:t[ze],de=()=>ie(n),ye=()=>ie(n+d);function be(){return d=0,O(n)&&(l++,h=0),g(n)&&n++,n++,h++,t[n]}function se(){return g(n+d)&&d++,d++,t[n+d]}function he(){n=0,l=1,h=1,d=0}function fe(ze=0){d=ze}function Me(){const ze=n+d;for(;ze!==n;)be();d=0}return{index:U,line:$,column:q,peekOffset:ee,charAt:ie,currentChar:de,currentPeek:ye,next:be,peek:se,reset:he,resetPeek:fe,skipToPeek:Me}}const gd=void 0,bF=".",_M="'",wF="tokenizer";function TF(e,t={}){const n=t.location!==!1,l=vF(e),h=()=>l.index(),d=()=>hF(l.line(),l.column(),l.index()),g=d(),b=h(),r={currentType:14,offset:b,startLoc:g,endLoc:g,lastType:14,lastOffset:b,lastStartLoc:g,lastEndLoc:g,braceNest:0,inLinked:!1,text:""},C=()=>r,{onError:O}=t;function U(Ie,Oe,rt,...Zt){const Yt=C();if(Oe.column+=rt,Oe.offset+=rt,O){const ti=n?sv(Yt.startLoc,Oe):null,mt=Sg(Ie,ti,{domain:wF,args:Zt});O(mt)}}function $(Ie,Oe,rt){Ie.endLoc=d(),Ie.currentType=Oe;const Zt={type:Oe};return n&&(Zt.loc=sv(Ie.startLoc,Ie.endLoc)),rt!=null&&(Zt.value=rt),Zt}const q=Ie=>$(Ie,14);function ee(Ie,Oe){return Ie.currentChar()===Oe?(Ie.next(),Oe):(U(ln.EXPECTED_TOKEN,d(),0,Oe),"")}function ie(Ie){let Oe="";for(;Ie.currentPeek()===qh||Ie.currentPeek()===Ko;)Oe+=Ie.currentPeek(),Ie.peek();return Oe}function de(Ie){const Oe=ie(Ie);return Ie.skipToPeek(),Oe}function ye(Ie){if(Ie===gd)return!1;const Oe=Ie.charCodeAt(0);return Oe>=97&&Oe<=122||Oe>=65&&Oe<=90||Oe===95}function be(Ie){if(Ie===gd)return!1;const Oe=Ie.charCodeAt(0);return Oe>=48&&Oe<=57}function se(Ie,Oe){const{currentType:rt}=Oe;if(rt!==2)return!1;ie(Ie);const Zt=ye(Ie.currentPeek());return Ie.resetPeek(),Zt}function he(Ie,Oe){const{currentType:rt}=Oe;if(rt!==2)return!1;ie(Ie);const Zt=Ie.currentPeek()==="-"?Ie.peek():Ie.currentPeek(),Yt=be(Zt);return Ie.resetPeek(),Yt}function fe(Ie,Oe){const{currentType:rt}=Oe;if(rt!==2)return!1;ie(Ie);const Zt=Ie.currentPeek()===_M;return Ie.resetPeek(),Zt}function Me(Ie,Oe){const{currentType:rt}=Oe;if(rt!==8)return!1;ie(Ie);const Zt=Ie.currentPeek()===".";return Ie.resetPeek(),Zt}function ze(Ie,Oe){const{currentType:rt}=Oe;if(rt!==9)return!1;ie(Ie);const Zt=ye(Ie.currentPeek());return Ie.resetPeek(),Zt}function ve(Ie,Oe){const{currentType:rt}=Oe;if(!(rt===8||rt===12))return!1;ie(Ie);const Zt=Ie.currentPeek()===":";return Ie.resetPeek(),Zt}function Ue(Ie,Oe){const{currentType:rt}=Oe;if(rt!==10)return!1;const Zt=()=>{const ti=Ie.currentPeek();return ti==="{"?ye(Ie.peek()):ti==="@"||ti==="%"||ti==="|"||ti===":"||ti==="."||ti===qh||!ti?!1:ti===Ko?(Ie.peek(),Zt()):Qe(Ie,!1)},Yt=Zt();return Ie.resetPeek(),Yt}function Ne(Ie){ie(Ie);const Oe=Ie.currentPeek()==="|";return Ie.resetPeek(),Oe}function it(Ie){const Oe=ie(Ie),rt=Ie.currentPeek()==="%"&&Ie.peek()==="{";return Ie.resetPeek(),{isModulo:rt,hasSpace:Oe.length>0}}function Qe(Ie,Oe=!0){const rt=(Yt=!1,ti="",mt=!1)=>{const zt=Ie.currentPeek();return zt==="{"?ti==="%"?!1:Yt:zt==="@"||!zt?ti==="%"?!0:Yt:zt==="%"?(Ie.peek(),rt(Yt,"%",!0)):zt==="|"?ti==="%"||mt?!0:!(ti===qh||ti===Ko):zt===qh?(Ie.peek(),rt(!0,qh,mt)):zt===Ko?(Ie.peek(),rt(!0,Ko,mt)):!0},Zt=rt();return Oe&&Ie.resetPeek(),Zt}function Xe(Ie,Oe){const rt=Ie.currentChar();return rt===gd?gd:Oe(rt)?(Ie.next(),rt):null}function Tt(Ie){const Oe=Ie.charCodeAt(0);return Oe>=97&&Oe<=122||Oe>=65&&Oe<=90||Oe>=48&&Oe<=57||Oe===95||Oe===36}function Rt(Ie){return Xe(Ie,Tt)}function St(Ie){const Oe=Ie.charCodeAt(0);return Oe>=97&&Oe<=122||Oe>=65&&Oe<=90||Oe>=48&&Oe<=57||Oe===95||Oe===36||Oe===45}function Pt(Ie){return Xe(Ie,St)}function oi(Ie){const Oe=Ie.charCodeAt(0);return Oe>=48&&Oe<=57}function ci(Ie){return Xe(Ie,oi)}function pn(Ie){const Oe=Ie.charCodeAt(0);return Oe>=48&&Oe<=57||Oe>=65&&Oe<=70||Oe>=97&&Oe<=102}function Ni(Ie){return Xe(Ie,pn)}function ji(Ie){let Oe="",rt="";for(;Oe=ci(Ie);)rt+=Oe;return rt}function An(Ie){de(Ie);const Oe=Ie.currentChar();return Oe!=="%"&&U(ln.EXPECTED_TOKEN,d(),0,Oe),Ie.next(),"%"}function Hi(Ie){let Oe="";for(;;){const rt=Ie.currentChar();if(rt==="{"||rt==="}"||rt==="@"||rt==="|"||!rt)break;if(rt==="%")if(Qe(Ie))Oe+=rt,Ie.next();else break;else if(rt===qh||rt===Ko)if(Qe(Ie))Oe+=rt,Ie.next();else{if(Ne(Ie))break;Oe+=rt,Ie.next()}else Oe+=rt,Ie.next()}return Oe}function Zn(Ie){de(Ie);let Oe="",rt="";for(;Oe=Pt(Ie);)rt+=Oe;return Ie.currentChar()===gd&&U(ln.UNTERMINATED_CLOSING_BRACE,d(),0),rt}function wn(Ie){de(Ie);let Oe="";return Ie.currentChar()==="-"?(Ie.next(),Oe+=`-${ji(Ie)}`):Oe+=ji(Ie),Ie.currentChar()===gd&&U(ln.UNTERMINATED_CLOSING_BRACE,d(),0),Oe}function nt(Ie){return Ie!==_M&&Ie!==Ko}function Mt(Ie){de(Ie),ee(Ie,"'");let Oe="",rt="";for(;Oe=Xe(Ie,nt);)Oe==="\\"?rt+=xt(Ie):rt+=Oe;const Zt=Ie.currentChar();return Zt===Ko||Zt===gd?(U(ln.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,d(),0),Zt===Ko&&(Ie.next(),ee(Ie,"'")),rt):(ee(Ie,"'"),rt)}function xt(Ie){const Oe=Ie.currentChar();switch(Oe){case"\\":case"'":return Ie.next(),`\\${Oe}`;case"u":return jt(Ie,Oe,4);case"U":return jt(Ie,Oe,6);default:return U(ln.UNKNOWN_ESCAPE_SEQUENCE,d(),0,Oe),""}}function jt(Ie,Oe,rt){ee(Ie,Oe);let Zt="";for(let Yt=0;Yt<rt;Yt++){const ti=Ni(Ie);if(!ti){U(ln.INVALID_UNICODE_ESCAPE_SEQUENCE,d(),0,`\\${Oe}${Zt}${Ie.currentChar()}`);break}Zt+=ti}return`\\${Oe}${Zt}`}function ki(Ie){return Ie!=="{"&&Ie!=="}"&&Ie!==qh&&Ie!==Ko}function ai(Ie){de(Ie);let Oe="",rt="";for(;Oe=Xe(Ie,ki);)rt+=Oe;return rt}function Ee(Ie){let Oe="",rt="";for(;Oe=Rt(Ie);)rt+=Oe;return rt}function Ce(Ie){const Oe=rt=>{const Zt=Ie.currentChar();return Zt==="{"||Zt==="%"||Zt==="@"||Zt==="|"||Zt==="("||Zt===")"||!Zt||Zt===qh?rt:(rt+=Zt,Ie.next(),Oe(rt))};return Oe("")}function ct(Ie){de(Ie);const Oe=ee(Ie,"|");return de(Ie),Oe}function Bt(Ie,Oe){let rt=null;switch(Ie.currentChar()){case"{":return Oe.braceNest>=1&&U(ln.NOT_ALLOW_NEST_PLACEHOLDER,d(),0),Ie.next(),rt=$(Oe,2,"{"),de(Ie),Oe.braceNest++,rt;case"}":return Oe.braceNest>0&&Oe.currentType===2&&U(ln.EMPTY_PLACEHOLDER,d(),0),Ie.next(),rt=$(Oe,3,"}"),Oe.braceNest--,Oe.braceNest>0&&de(Ie),Oe.inLinked&&Oe.braceNest===0&&(Oe.inLinked=!1),rt;case"@":return Oe.braceNest>0&&U(ln.UNTERMINATED_CLOSING_BRACE,d(),0),rt=Dt(Ie,Oe)||q(Oe),Oe.braceNest=0,rt;default:{let Yt=!0,ti=!0,mt=!0;if(Ne(Ie))return Oe.braceNest>0&&U(ln.UNTERMINATED_CLOSING_BRACE,d(),0),rt=$(Oe,1,ct(Ie)),Oe.braceNest=0,Oe.inLinked=!1,rt;if(Oe.braceNest>0&&(Oe.currentType===5||Oe.currentType===6||Oe.currentType===7))return U(ln.UNTERMINATED_CLOSING_BRACE,d(),0),Oe.braceNest=0,ei(Ie,Oe);if(Yt=se(Ie,Oe))return rt=$(Oe,5,Zn(Ie)),de(Ie),rt;if(ti=he(Ie,Oe))return rt=$(Oe,6,wn(Ie)),de(Ie),rt;if(mt=fe(Ie,Oe))return rt=$(Oe,7,Mt(Ie)),de(Ie),rt;if(!Yt&&!ti&&!mt)return rt=$(Oe,13,ai(Ie)),U(ln.INVALID_TOKEN_IN_PLACEHOLDER,d(),0,rt.value),de(Ie),rt;break}}return rt}function Dt(Ie,Oe){const{currentType:rt}=Oe;let Zt=null;const Yt=Ie.currentChar();switch((rt===8||rt===9||rt===12||rt===10)&&(Yt===Ko||Yt===qh)&&U(ln.INVALID_LINKED_FORMAT,d(),0),Yt){case"@":return Ie.next(),Zt=$(Oe,8,"@"),Oe.inLinked=!0,Zt;case".":return de(Ie),Ie.next(),$(Oe,9,".");case":":return de(Ie),Ie.next(),$(Oe,10,":");default:return Ne(Ie)?(Zt=$(Oe,1,ct(Ie)),Oe.braceNest=0,Oe.inLinked=!1,Zt):Me(Ie,Oe)||ve(Ie,Oe)?(de(Ie),Dt(Ie,Oe)):ze(Ie,Oe)?(de(Ie),$(Oe,12,Ee(Ie))):Ue(Ie,Oe)?(de(Ie),Yt==="{"?Bt(Ie,Oe)||Zt:$(Oe,11,Ce(Ie))):(rt===8&&U(ln.INVALID_LINKED_FORMAT,d(),0),Oe.braceNest=0,Oe.inLinked=!1,ei(Ie,Oe))}}function ei(Ie,Oe){let rt={type:14};if(Oe.braceNest>0)return Bt(Ie,Oe)||q(Oe);if(Oe.inLinked)return Dt(Ie,Oe)||q(Oe);switch(Ie.currentChar()){case"{":return Bt(Ie,Oe)||q(Oe);case"}":return U(ln.UNBALANCED_CLOSING_BRACE,d(),0),Ie.next(),$(Oe,3,"}");case"@":return Dt(Ie,Oe)||q(Oe);default:{if(Ne(Ie))return rt=$(Oe,1,ct(Ie)),Oe.braceNest=0,Oe.inLinked=!1,rt;const{isModulo:Yt,hasSpace:ti}=it(Ie);if(Yt)return ti?$(Oe,0,Hi(Ie)):$(Oe,4,An(Ie));if(Qe(Ie))return $(Oe,0,Hi(Ie));break}}return rt}function di(){const{currentType:Ie,offset:Oe,startLoc:rt,endLoc:Zt}=r;return r.lastType=Ie,r.lastOffset=Oe,r.lastStartLoc=rt,r.lastEndLoc=Zt,r.offset=h(),r.startLoc=d(),l.currentChar()===gd?$(r,14):ei(l,r)}return{nextToken:di,currentOffset:h,currentPosition:d,context:C}}const EF="parser",SF=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function MF(e,t,n){switch(e){case"\\\\":return"\\";case"\\'":return"'";default:{const l=parseInt(t||n,16);return l<=55295||l>=57344?String.fromCodePoint(l):""}}}function CF(e={}){const t=e.location!==!1,{onError:n,onWarn:l}=e;function h(se,he,fe,Me,...ze){const ve=se.currentPosition();if(ve.offset+=Me,ve.column+=Me,n){const Ue=t?sv(fe,ve):null,Ne=Sg(he,Ue,{domain:EF,args:ze});n(Ne)}}function d(se,he,fe,Me,...ze){const ve=se.currentPosition();if(ve.offset+=Me,ve.column+=Me,l){const Ue=t?sv(fe,ve):null;l(pF(he,Ue,ze))}}function g(se,he,fe){const Me={type:se};return t&&(Me.start=he,Me.end=he,Me.loc={start:fe,end:fe}),Me}function b(se,he,fe,Me){t&&(se.end=he,se.loc&&(se.loc.end=fe))}function r(se,he){const fe=se.context(),Me=g(3,fe.offset,fe.startLoc);return Me.value=he,b(Me,se.currentOffset(),se.currentPosition()),Me}function C(se,he){const fe=se.context(),{lastOffset:Me,lastStartLoc:ze}=fe,ve=g(5,Me,ze);return ve.index=parseInt(he,10),se.nextToken(),b(ve,se.currentOffset(),se.currentPosition()),ve}function O(se,he,fe){const Me=se.context(),{lastOffset:ze,lastStartLoc:ve}=Me,Ue=g(4,ze,ve);return Ue.key=he,fe===!0&&(Ue.modulo=!0),se.nextToken(),b(Ue,se.currentOffset(),se.currentPosition()),Ue}function U(se,he){const fe=se.context(),{lastOffset:Me,lastStartLoc:ze}=fe,ve=g(9,Me,ze);return ve.value=he.replace(SF,MF),se.nextToken(),b(ve,se.currentOffset(),se.currentPosition()),ve}function $(se){const he=se.nextToken(),fe=se.context(),{lastOffset:Me,lastStartLoc:ze}=fe,ve=g(8,Me,ze);return he.type!==12?(h(se,ln.UNEXPECTED_EMPTY_LINKED_MODIFIER,fe.lastStartLoc,0),ve.value="",b(ve,Me,ze),{nextConsumeToken:he,node:ve}):(he.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,fe.lastStartLoc,0,Ql(he)),ve.value=he.value||"",b(ve,se.currentOffset(),se.currentPosition()),{node:ve})}function q(se,he){const fe=se.context(),Me=g(7,fe.offset,fe.startLoc);return Me.value=he,b(Me,se.currentOffset(),se.currentPosition()),Me}function ee(se){const he=se.context(),fe=g(6,he.offset,he.startLoc);let Me=se.nextToken();if(Me.type===9){const ze=$(se);fe.modifier=ze.node,Me=ze.nextConsumeToken||se.nextToken()}switch(Me.type!==10&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Me)),Me=se.nextToken(),Me.type===2&&(Me=se.nextToken()),Me.type){case 11:Me.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Me)),fe.key=q(se,Me.value||"");break;case 5:Me.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Me)),fe.key=O(se,Me.value||"");break;case 6:Me.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Me)),fe.key=C(se,Me.value||"");break;case 7:Me.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Me)),fe.key=U(se,Me.value||"");break;default:{h(se,ln.UNEXPECTED_EMPTY_LINKED_KEY,he.lastStartLoc,0);const ze=se.context(),ve=g(7,ze.offset,ze.startLoc);return ve.value="",b(ve,ze.offset,ze.startLoc),fe.key=ve,b(fe,ze.offset,ze.startLoc),{nextConsumeToken:Me,node:fe}}}return b(fe,se.currentOffset(),se.currentPosition()),{node:fe}}function ie(se){const he=se.context(),fe=he.currentType===1?se.currentOffset():he.offset,Me=he.currentType===1?he.endLoc:he.startLoc,ze=g(2,fe,Me);ze.items=[];let ve=null,Ue=null;do{const Qe=ve||se.nextToken();switch(ve=null,Qe.type){case 0:Qe.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Qe)),ze.items.push(r(se,Qe.value||""));break;case 6:Qe.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Qe)),ze.items.push(C(se,Qe.value||""));break;case 4:Ue=!0;break;case 5:Qe.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Qe)),ze.items.push(O(se,Qe.value||"",!!Ue)),Ue&&(d(se,CT.USE_MODULO_SYNTAX,he.lastStartLoc,0,Ql(Qe)),Ue=null);break;case 7:Qe.value==null&&h(se,ln.UNEXPECTED_LEXICAL_ANALYSIS,he.lastStartLoc,0,Ql(Qe)),ze.items.push(U(se,Qe.value||""));break;case 8:{const Xe=ee(se);ze.items.push(Xe.node),ve=Xe.nextConsumeToken||null;break}}}while(he.currentType!==14&&he.currentType!==1);const Ne=he.currentType===1?he.lastOffset:se.currentOffset(),it=he.currentType===1?he.lastEndLoc:se.currentPosition();return b(ze,Ne,it),ze}function de(se,he,fe,Me){const ze=se.context();let ve=Me.items.length===0;const Ue=g(1,he,fe);Ue.cases=[],Ue.cases.push(Me);do{const Ne=ie(se);ve||(ve=Ne.items.length===0),Ue.cases.push(Ne)}while(ze.currentType!==14);return ve&&h(se,ln.MUST_HAVE_MESSAGES_IN_PLURAL,fe,0),b(Ue,se.currentOffset(),se.currentPosition()),Ue}function ye(se){const he=se.context(),{offset:fe,startLoc:Me}=he,ze=ie(se);return he.currentType===14?ze:de(se,fe,Me,ze)}function be(se){const he=TF(se,tP({},e)),fe=he.context(),Me=g(0,fe.offset,fe.startLoc);return t&&Me.loc&&(Me.loc.source=se),Me.body=ye(he),e.onCacheKey&&(Me.cacheKey=e.onCacheKey(se)),fe.currentType!==14&&h(he,ln.UNEXPECTED_LEXICAL_ANALYSIS,fe.lastStartLoc,0,se[fe.offset]||""),b(Me,he.currentOffset(),he.currentPosition()),Me}return{parse:be}}function Ql(e){if(e.type===14)return"EOF";const t=(e.value||"").replace(/\r?\n/gu,"\\n");return t.length>10?t.slice(0,9)+"":t}function AF(e,t={}){const n={ast:e,helpers:new Set};return{context:()=>n,helper:d=>(n.helpers.add(d),d)}}function yM(e,t){for(let n=0;n<e.length;n++)AT(e[n],t)}function AT(e,t){switch(e.type){case 1:yM(e.cases,t),t.helper("plural");break;case 2:yM(e.items,t);break;case 6:{AT(e.key,t),t.helper("linked"),t.helper("type");break}case 5:t.helper("interpolate"),t.helper("list");break;case 4:t.helper("interpolate"),t.helper("named");break}}function kF(e,t={}){const n=AF(e);n.helper("normalize"),e.body&&AT(e.body,n);const l=n.context();e.helpers=Array.from(l.helpers)}function IF(e){const t=e.body;return t.type===2?xM(t):t.cases.forEach(n=>xM(n)),e}function xM(e){if(e.items.length===1){const t=e.items[0];(t.type===3||t.type===9)&&(e.static=t.value,delete t.value)}else{const t=[];for(let n=0;n<e.items.length;n++){const l=e.items[n];if(!(l.type===3||l.type===9)||l.value==null)break;t.push(l.value)}if(t.length===e.items.length){e.static=iP(t);for(let n=0;n<e.items.length;n++){const l=e.items[n];(l.type===3||l.type===9)&&delete l.value}}}}const PF="minifier";function Km(e){switch(e.t=e.type,e.type){case 0:{const t=e;Km(t.body),t.b=t.body,delete t.body;break}case 1:{const t=e,n=t.cases;for(let l=0;l<n.length;l++)Km(n[l]);t.c=n,delete t.cases;break}case 2:{const t=e,n=t.items;for(let l=0;l<n.length;l++)Km(n[l]);t.i=n,delete t.items,t.static&&(t.s=t.static,delete t.static);break}case 3:case 9:case 8:case 7:{const t=e;t.value&&(t.v=t.value,delete t.value);break}case 6:{const t=e;Km(t.key),t.k=t.key,delete t.key,t.modifier&&(Km(t.modifier),t.m=t.modifier,delete t.modifier);break}case 5:{const t=e;t.i=t.index,delete t.index;break}case 4:{const t=e;t.k=t.key,delete t.key;break}default:throw Sg(ln.UNHANDLED_MINIFIER_NODE_TYPE,null,{domain:PF,args:[e.type]})}delete e.type}const LF="parser";function DF(e,t){const{filename:n,breakLineCode:l,needIndent:h}=t,d=t.location!==!1,g={filename:n,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:l,needIndent:h,indentLevel:0};d&&e.loc&&(g.source=e.loc.source);const b=()=>g;function r(ie,de){g.code+=ie}function C(ie,de=!0){const ye=de?l:"";r(h?ye+"  ".repeat(ie):ye)}function O(ie=!0){const de=++g.indentLevel;ie&&C(de)}function U(ie=!0){const de=--g.indentLevel;ie&&C(de)}function $(){C(g.indentLevel)}return{context:b,push:r,indent:O,deindent:U,newline:$,helper:ie=>`_${ie}`,needIndent:()=>g.needIndent}}function OF(e,t){const{helper:n}=e;e.push(`${n("linked")}(`),mg(e,t.key),t.modifier?(e.push(", "),mg(e,t.modifier),e.push(", _type")):e.push(", undefined, _type"),e.push(")")}function RF(e,t){const{helper:n,needIndent:l}=e;e.push(`${n("normalize")}([`),e.indent(l());const h=t.items.length;for(let d=0;d<h&&(mg(e,t.items[d]),d!==h-1);d++)e.push(", ");e.deindent(l()),e.push("])")}function zF(e,t){const{helper:n,needIndent:l}=e;if(t.cases.length>1){e.push(`${n("plural")}([`),e.indent(l());const h=t.cases.length;for(let d=0;d<h&&(mg(e,t.cases[d]),d!==h-1);d++)e.push(", ");e.deindent(l()),e.push("])")}}function BF(e,t){t.body?mg(e,t.body):e.push("null")}function mg(e,t){const{helper:n}=e;switch(t.type){case 0:BF(e,t);break;case 1:zF(e,t);break;case 2:RF(e,t);break;case 6:OF(e,t);break;case 8:e.push(JSON.stringify(t.value),t);break;case 7:e.push(JSON.stringify(t.value),t);break;case 5:e.push(`${n("interpolate")}(${n("list")}(${t.index}))`,t);break;case 4:e.push(`${n("interpolate")}(${n("named")}(${JSON.stringify(t.key)}))`,t);break;case 9:e.push(JSON.stringify(t.value),t);break;case 3:e.push(JSON.stringify(t.value),t);break;default:throw Sg(ln.UNHANDLED_CODEGEN_NODE_TYPE,null,{domain:LF,args:[t.type]})}}const FF=(e,t={})=>{const n=gM(t.mode)?t.mode:"normal",l=gM(t.filename)?t.filename:"message.intl";t.sourceMap;const h=t.breakLineCode!=null?t.breakLineCode:n==="arrow"?";":`
`,d=t.needIndent?t.needIndent:n!=="arrow",g=e.helpers||[],b=DF(e,{filename:l,breakLineCode:h,needIndent:d});b.push(n==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),b.indent(d),g.length>0&&(b.push(`const { ${iP(g.map(O=>`${O}: _${O}`),", ")} } = ctx`),b.newline()),b.push("return "),mg(b,e),b.deindent(d),b.push("}"),delete e.helpers;const{code:r,map:C}=b.context();return{ast:e,code:r,map:C?C.toJSON():void 0}};function NF(e,t={}){const n=tP({},t),l=!!n.jit,h=!!n.minify,d=n.optimize==null?!0:n.optimize,b=CF(n).parse(e);return l?(d&&IF(b),h&&Km(b),{ast:b,code:""}):(kF(b,n),FF(b,n))}/*!
  * core-base v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function UF(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(nu().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(nu().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(nu().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}function oh(e){return ts(e)&&kT(e)===0&&(sc(e,"b")||sc(e,"body"))}const nP=["b","body"];function VF(e){return Ud(e,nP)}const sP=["c","cases"];function jF(e){return Ud(e,sP,[])}const rP=["s","static"];function $F(e){return Ud(e,rP)}const oP=["i","items"];function WF(e){return Ud(e,oP,[])}const aP=["t","type"];function kT(e){return Ud(e,aP)}const lP=["v","value"];function h0(e,t){const n=Ud(e,lP);if(n!=null)return n;throw Ty(t)}const cP=["m","modifier"];function GF(e){return Ud(e,cP)}const hP=["k","key"];function HF(e){const t=Ud(e,hP);if(t)return t;throw Ty(6)}function Ud(e,t,n){for(let l=0;l<t.length;l++){const h=t[l];if(sc(e,h)&&e[h]!=null)return e[h]}return n}const uP=[...nP,...sP,...rP,...oP,...hP,...cP,...lP,...aP];function Ty(e){return new Error(`unhandled node type: ${e}`)}const Vd=[];Vd[0]={w:[0],i:[3,0],"[":[4],o:[7]};Vd[1]={w:[1],".":[2],"[":[4],o:[7]};Vd[2]={w:[2],i:[3,0],0:[3,0]};Vd[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};Vd[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};Vd[5]={"'":[4,0],o:8,l:[5,0]};Vd[6]={'"':[4,0],o:8,l:[6,0]};const qF=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function XF(e){return qF.test(e)}function ZF(e){const t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===n&&(t===34||t===39)?e.slice(1,-1):e}function YF(e){if(e==null)return"o";switch(e.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return e;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function KF(e){const t=e.trim();return e.charAt(0)==="0"&&isNaN(parseInt(e))?!1:XF(t)?ZF(t):"*"+t}function JF(e){const t=[];let n=-1,l=0,h=0,d,g,b,r,C,O,U;const $=[];$[0]=()=>{g===void 0?g=b:g+=b},$[1]=()=>{g!==void 0&&(t.push(g),g=void 0)},$[2]=()=>{$[0](),h++},$[3]=()=>{if(h>0)h--,l=4,$[0]();else{if(h=0,g===void 0||(g=KF(g),g===!1))return!1;$[1]()}};function q(){const ee=e[n+1];if(l===5&&ee==="'"||l===6&&ee==='"')return n++,b="\\"+ee,$[0](),!0}for(;l!==null;)if(n++,d=e[n],!(d==="\\"&&q())){if(r=YF(d),U=Vd[l],C=U[r]||U.l||8,C===8||(l=C[0],C[1]!==void 0&&(O=$[C[1]],O&&(b=d,O()===!1))))return;if(l===7)return t}}const vM=new Map;function QF(e,t){return ts(e)?e[t]:null}function eN(e,t){if(!ts(e))return null;let n=vM.get(t);if(n||(n=JF(t),n&&vM.set(t,n)),!n)return null;const l=n.length;let h=e,d=0;for(;d<l;){const g=n[d];if(uP.includes(g)&&oh(h))return null;const b=h[g];if(b===void 0||Us(h))return null;h=b,d++}return h}const tN=e=>e,iN=e=>"",nN="text",sN=e=>e.length===0?"":cF(e),rN=lF;function bM(e,t){return e=Math.abs(e),t===2?e?e>1?1:0:1:e?Math.min(e,2):0}function oN(e){const t=yr(e.pluralIndex)?e.pluralIndex:-1;return e.named&&(yr(e.named.count)||yr(e.named.n))?yr(e.named.count)?e.named.count:yr(e.named.n)?e.named.n:t:t}function aN(e,t){t.count||(t.count=e),t.n||(t.n=e)}function lN(e={}){const t=e.locale,n=oN(e),l=ts(e.pluralRules)&&Mi(t)&&Us(e.pluralRules[t])?e.pluralRules[t]:bM,h=ts(e.pluralRules)&&Mi(t)&&Us(e.pluralRules[t])?bM:void 0,d=ye=>ye[l(n,ye.length,h)],g=e.list||[],b=ye=>g[ye],r=e.named||Ss();yr(e.pluralIndex)&&aN(n,r);const C=ye=>r[ye];function O(ye){const be=Us(e.messages)?e.messages(ye):ts(e.messages)?e.messages[ye]:!1;return be||(e.parent?e.parent.message(ye):iN)}const U=ye=>e.modifiers?e.modifiers[ye]:tN,$=fn(e.processor)&&Us(e.processor.normalize)?e.processor.normalize:sN,q=fn(e.processor)&&Us(e.processor.interpolate)?e.processor.interpolate:rN,ee=fn(e.processor)&&Mi(e.processor.type)?e.processor.type:nN,de={list:b,named:C,plural:d,linked:(ye,...be)=>{const[se,he]=be;let fe="text",Me="";be.length===1?ts(se)?(Me=se.modifier||Me,fe=se.type||fe):Mi(se)&&(Me=se||Me):be.length===2&&(Mi(se)&&(Me=se||Me),Mi(he)&&(fe=he||fe));const ze=O(ye)(de),ve=fe==="vnode"&&Xs(ze)&&Me?ze[0]:ze;return Me?U(Me)(ve,fe):ve},message:O,type:ee,interpolate:q,normalize:$,values:ao(Ss(),g,r)};return de}let Ey=null;function cN(e){Ey=e}function hN(e,t,n){Ey&&Ey.emit("i18n:init",{timestamp:Date.now(),i18n:e,version:t,meta:n})}const uN=dN("function:translate");function dN(e){return t=>Ey&&Ey.emit(e,t)}const fN=CT.__EXTEND_POINT__,hp=Nv(fN),pN={FALLBACK_TO_TRANSLATE:hp(),CANNOT_FORMAT_NUMBER:hp(),FALLBACK_TO_NUMBER_FORMAT:hp(),CANNOT_FORMAT_DATE:hp(),FALLBACK_TO_DATE_FORMAT:hp(),EXPERIMENTAL_CUSTOM_MESSAGE_COMPILER:hp(),__EXTEND_POINT__:hp()},dP=ln.__EXTEND_POINT__,up=Nv(dP),rc={INVALID_ARGUMENT:dP,INVALID_DATE_ARGUMENT:up(),INVALID_ISO_DATE_ARGUMENT:up(),NOT_SUPPORT_NON_STRING_MESSAGE:up(),NOT_SUPPORT_LOCALE_PROMISE_VALUE:up(),NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:up(),NOT_SUPPORT_LOCALE_TYPE:up(),__EXTEND_POINT__:up()};function sh(e){return Sg(e,null,void 0)}function IT(e,t){return t.locale!=null?wM(t.locale):wM(e.locale)}let C1;function wM(e){if(Mi(e))return e;if(Us(e)){if(e.resolvedOnce&&C1!=null)return C1;if(e.constructor.name==="Function"){const t=e();if(aF(t))throw sh(rc.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return C1=t}else throw sh(rc.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw sh(rc.NOT_SUPPORT_LOCALE_TYPE)}function mN(e,t,n){return[...new Set([n,...Xs(t)?t:ts(t)?Object.keys(t):Mi(t)?[t]:[n]])]}function fP(e,t,n){const l=Mi(n)?n:gg,h=e;h.__localeChainCache||(h.__localeChainCache=new Map);let d=h.__localeChainCache.get(l);if(!d){d=[];let g=[n];for(;Xs(g);)g=TM(d,g,t);const b=Xs(t)||!fn(t)?t:t.default?t.default:null;g=Mi(b)?[b]:b,Xs(g)&&TM(d,g,!1),h.__localeChainCache.set(l,d)}return d}function TM(e,t,n){let l=!0;for(let h=0;h<t.length&&Ln(l);h++){const d=t[h];Mi(d)&&(l=gN(e,t[h],n))}return l}function gN(e,t,n){let l;const h=t.split("-");do{const d=h.join("-");l=_N(e,d,n),h.splice(-1,1)}while(h.length&&l===!0);return l}function _N(e,t,n){let l=!1;if(!e.includes(t)&&(l=!0,t)){l=t[t.length-1]!=="!";const h=t.replace(/!/g,"");e.push(h),(Xs(n)||fn(n))&&n[h]&&(l=n[h])}return l}const yN="9.14.5",Uv=-1,gg="en-US",EM="",SM=e=>`${e.charAt(0).toLocaleUpperCase()}${e.substr(1)}`;function xN(){return{upper:(e,t)=>t==="text"&&Mi(e)?e.toUpperCase():t==="vnode"&&ts(e)&&"__v_isVNode"in e?e.children.toUpperCase():e,lower:(e,t)=>t==="text"&&Mi(e)?e.toLowerCase():t==="vnode"&&ts(e)&&"__v_isVNode"in e?e.children.toLowerCase():e,capitalize:(e,t)=>t==="text"&&Mi(e)?SM(e):t==="vnode"&&ts(e)&&"__v_isVNode"in e?SM(e.children):e}}let pP;function MM(e){pP=e}let mP;function vN(e){mP=e}let gP;function bN(e){gP=e}let _P=null;const wN=e=>{_P=e},TN=()=>_P;let yP=null;const CM=e=>{yP=e},EN=()=>yP;let AM=0;function SN(e={}){const t=Us(e.onWarn)?e.onWarn:eF,n=Mi(e.version)?e.version:yN,l=Mi(e.locale)||Us(e.locale)?e.locale:gg,h=Us(l)?gg:l,d=Xs(e.fallbackLocale)||fn(e.fallbackLocale)||Mi(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:h,g=fn(e.messages)?e.messages:A1(h),b=fn(e.datetimeFormats)?e.datetimeFormats:A1(h),r=fn(e.numberFormats)?e.numberFormats:A1(h),C=ao(Ss(),e.modifiers,xN()),O=e.pluralRules||Ss(),U=Us(e.missing)?e.missing:null,$=Ln(e.missingWarn)||Od(e.missingWarn)?e.missingWarn:!0,q=Ln(e.fallbackWarn)||Od(e.fallbackWarn)?e.fallbackWarn:!0,ee=!!e.fallbackFormat,ie=!!e.unresolving,de=Us(e.postTranslation)?e.postTranslation:null,ye=fn(e.processor)?e.processor:null,be=Ln(e.warnHtmlMessage)?e.warnHtmlMessage:!0,se=!!e.escapeParameter,he=Us(e.messageCompiler)?e.messageCompiler:pP,fe=Us(e.messageResolver)?e.messageResolver:mP||QF,Me=Us(e.localeFallbacker)?e.localeFallbacker:gP||mN,ze=ts(e.fallbackContext)?e.fallbackContext:void 0,ve=e,Ue=ts(ve.__datetimeFormatters)?ve.__datetimeFormatters:new Map,Ne=ts(ve.__numberFormatters)?ve.__numberFormatters:new Map,it=ts(ve.__meta)?ve.__meta:{};AM++;const Qe={version:n,cid:AM,locale:l,fallbackLocale:d,messages:g,modifiers:C,pluralRules:O,missing:U,missingWarn:$,fallbackWarn:q,fallbackFormat:ee,unresolving:ie,postTranslation:de,processor:ye,warnHtmlMessage:be,escapeParameter:se,messageCompiler:he,messageResolver:fe,localeFallbacker:Me,fallbackContext:ze,onWarn:t,__meta:it};return Qe.datetimeFormats=b,Qe.numberFormats=r,Qe.__datetimeFormatters=Ue,Qe.__numberFormatters=Ne,__INTLIFY_PROD_DEVTOOLS__&&hN(Qe,n,it),Qe}const A1=e=>({[e]:Ss()});function PT(e,t,n,l,h){const{missing:d,onWarn:g}=e;if(d!==null){const b=d(e,n,t,h);return Mi(b)?b:t}else return t}function R_(e,t,n){const l=e;l.__localeChainCache=new Map,e.localeFallbacker(e,n,t)}function MN(e,t){return e===t?!1:e.split("-")[0]===t.split("-")[0]}function CN(e,t){const n=t.indexOf(e);if(n===-1)return!1;for(let l=n+1;l<t.length;l++)if(MN(e,t[l]))return!0;return!1}function k1(e){return n=>AN(n,e)}function AN(e,t){const n=VF(t);if(n==null)throw Ty(0);if(kT(n)===1){const d=jF(n);return e.plural(d.reduce((g,b)=>[...g,kM(e,b)],[]))}else return kM(e,n)}function kM(e,t){const n=$F(t);if(n!=null)return e.type==="text"?n:e.normalize([n]);{const l=WF(t).reduce((h,d)=>[...h,vw(e,d)],[]);return e.normalize(l)}}function vw(e,t){const n=kT(t);switch(n){case 3:return h0(t,n);case 9:return h0(t,n);case 4:{const l=t;if(sc(l,"k")&&l.k)return e.interpolate(e.named(l.k));if(sc(l,"key")&&l.key)return e.interpolate(e.named(l.key));throw Ty(n)}case 5:{const l=t;if(sc(l,"i")&&yr(l.i))return e.interpolate(e.list(l.i));if(sc(l,"index")&&yr(l.index))return e.interpolate(e.list(l.index));throw Ty(n)}case 6:{const l=t,h=GF(l),d=HF(l);return e.linked(vw(e,d),h?vw(e,h):void 0,e.type)}case 7:return h0(t,n);case 8:return h0(t,n);default:throw new Error(`unhandled node on format message part: ${n}`)}}const xP=e=>e;let eg=Ss();function vP(e,t={}){let n=!1;const l=t.onError||gF;return t.onError=h=>{n=!0,l(h)},{...NF(e,t),detectError:n}}const kN=(e,t)=>{if(!Mi(e))throw sh(rc.NOT_SUPPORT_NON_STRING_MESSAGE);{Ln(t.warnHtmlMessage)&&t.warnHtmlMessage;const l=(t.onCacheKey||xP)(e),h=eg[l];if(h)return h;const{code:d,detectError:g}=vP(e,t),b=new Function(`return ${d}`)();return g?b:eg[l]=b}};function IN(e,t){if(__INTLIFY_JIT_COMPILATION__&&!__INTLIFY_DROP_MESSAGE_COMPILER__&&Mi(e)){Ln(t.warnHtmlMessage)&&t.warnHtmlMessage;const l=(t.onCacheKey||xP)(e),h=eg[l];if(h)return h;const{ast:d,detectError:g}=vP(e,{...t,location:!1,jit:!0}),b=k1(d);return g?b:eg[l]=b}else{const n=e.cacheKey;if(n){const l=eg[n];return l||(eg[n]=k1(e))}else return k1(e)}}const IM=()=>"",wl=e=>Us(e);function PM(e,...t){const{fallbackFormat:n,postTranslation:l,unresolving:h,messageCompiler:d,fallbackLocale:g,messages:b}=e,[r,C]=bw(...t),O=Ln(C.missingWarn)?C.missingWarn:e.missingWarn,U=Ln(C.fallbackWarn)?C.fallbackWarn:e.fallbackWarn,$=Ln(C.escapeParameter)?C.escapeParameter:e.escapeParameter,q=!!C.resolvedMessage,ee=Mi(C.default)||Ln(C.default)?Ln(C.default)?d?r:()=>r:C.default:n?d?r:()=>r:"",ie=n||ee!=="",de=IT(e,C);$&&PN(C);let[ye,be,se]=q?[r,de,b[de]||Ss()]:bP(e,r,de,g,U,O),he=ye,fe=r;if(!q&&!(Mi(he)||oh(he)||wl(he))&&ie&&(he=ee,fe=he),!q&&(!(Mi(he)||oh(he)||wl(he))||!Mi(be)))return h?Uv:r;let Me=!1;const ze=()=>{Me=!0},ve=wl(he)?he:wP(e,r,be,he,fe,ze);if(Me)return he;const Ue=ON(e,be,se,C),Ne=lN(Ue),it=LN(e,ve,Ne);let Qe=l?l(it,r):it;if($&&Mi(Qe)&&(Qe=rF(Qe)),__INTLIFY_PROD_DEVTOOLS__){const Xe={timestamp:Date.now(),key:Mi(r)?r:wl(he)?he.key:"",locale:be||(wl(he)?he.locale:""),format:Mi(he)?he:wl(he)?he.source:"",message:Qe};Xe.meta=ao({},e.__meta,TN()||{}),uN(Xe)}return Qe}function PN(e){Xs(e.list)?e.list=e.list.map(t=>Mi(t)?pM(t):t):ts(e.named)&&Object.keys(e.named).forEach(t=>{Mi(e.named[t])&&(e.named[t]=pM(e.named[t]))})}function bP(e,t,n,l,h,d){const{messages:g,onWarn:b,messageResolver:r,localeFallbacker:C}=e,O=C(e,l,n);let U=Ss(),$,q=null;const ee="translate";for(let ie=0;ie<O.length&&($=O[ie],U=g[$]||Ss(),(q=r(U,t))===null&&(q=U[t]),!(Mi(q)||oh(q)||wl(q)));ie++)if(!CN($,O)){const de=PT(e,t,$,d,ee);de!==t&&(q=de)}return[q,$,U]}function wP(e,t,n,l,h,d){const{messageCompiler:g,warnHtmlMessage:b}=e;if(wl(l)){const C=l;return C.locale=C.locale||n,C.key=C.key||t,C}if(g==null){const C=()=>l;return C.locale=n,C.key=t,C}const r=g(l,DN(e,n,h,l,b,d));return r.locale=n,r.key=t,r.source=l,r}function LN(e,t,n){return t(n)}function bw(...e){const[t,n,l]=e,h=Ss();if(!Mi(t)&&!yr(t)&&!wl(t)&&!oh(t))throw sh(rc.INVALID_ARGUMENT);const d=yr(t)?String(t):(wl(t),t);return yr(n)?h.plural=n:Mi(n)?h.default=n:fn(n)&&!Fv(n)?h.named=n:Xs(n)&&(h.list=n),yr(l)?h.plural=l:Mi(l)?h.default=l:fn(l)&&ao(h,l),[d,h]}function DN(e,t,n,l,h,d){return{locale:t,key:n,warnHtmlMessage:h,onError:g=>{throw d&&d(g),g},onCacheKey:g=>tF(t,n,g)}}function ON(e,t,n,l){const{modifiers:h,pluralRules:d,messageResolver:g,fallbackLocale:b,fallbackWarn:r,missingWarn:C,fallbackContext:O}=e,$={locale:t,modifiers:h,pluralRules:d,messages:q=>{let ee=g(n,q);if(ee==null&&O){const[,,ie]=bP(O,q,t,b,r,C);ee=g(ie,q)}if(Mi(ee)||oh(ee)){let ie=!1;const ye=wP(e,q,t,ee,q,()=>{ie=!0});return ie?IM:ye}else return wl(ee)?ee:IM}};return e.processor&&($.processor=e.processor),l.list&&($.list=l.list),l.named&&($.named=l.named),yr(l.plural)&&($.pluralIndex=l.plural),$}function LM(e,...t){const{datetimeFormats:n,unresolving:l,fallbackLocale:h,onWarn:d,localeFallbacker:g}=e,{__datetimeFormatters:b}=e,[r,C,O,U]=ww(...t),$=Ln(O.missingWarn)?O.missingWarn:e.missingWarn;Ln(O.fallbackWarn)?O.fallbackWarn:e.fallbackWarn;const q=!!O.part,ee=IT(e,O),ie=g(e,h,ee);if(!Mi(r)||r==="")return new Intl.DateTimeFormat(ee,U).format(C);let de={},ye,be=null;const se="datetime format";for(let Me=0;Me<ie.length&&(ye=ie[Me],de=n[ye]||{},be=de[r],!fn(be));Me++)PT(e,r,ye,$,se);if(!fn(be)||!Mi(ye))return l?Uv:r;let he=`${ye}__${r}`;Fv(U)||(he=`${he}__${JSON.stringify(U)}`);let fe=b.get(he);return fe||(fe=new Intl.DateTimeFormat(ye,ao({},be,U)),b.set(he,fe)),q?fe.formatToParts(C):fe.format(C)}const TP=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function ww(...e){const[t,n,l,h]=e,d=Ss();let g=Ss(),b;if(Mi(t)){const r=t.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!r)throw sh(rc.INVALID_ISO_DATE_ARGUMENT);const C=r[3]?r[3].trim().startsWith("T")?`${r[1].trim()}${r[3].trim()}`:`${r[1].trim()}T${r[3].trim()}`:r[1].trim();b=new Date(C);try{b.toISOString()}catch{throw sh(rc.INVALID_ISO_DATE_ARGUMENT)}}else if(nF(t)){if(isNaN(t.getTime()))throw sh(rc.INVALID_DATE_ARGUMENT);b=t}else if(yr(t))b=t;else throw sh(rc.INVALID_ARGUMENT);return Mi(n)?d.key=n:fn(n)&&Object.keys(n).forEach(r=>{TP.includes(r)?g[r]=n[r]:d[r]=n[r]}),Mi(l)?d.locale=l:fn(l)&&(g=l),fn(h)&&(g=h),[d.key||"",b,d,g]}function DM(e,t,n){const l=e;for(const h in n){const d=`${t}__${h}`;l.__datetimeFormatters.has(d)&&l.__datetimeFormatters.delete(d)}}function OM(e,...t){const{numberFormats:n,unresolving:l,fallbackLocale:h,onWarn:d,localeFallbacker:g}=e,{__numberFormatters:b}=e,[r,C,O,U]=Tw(...t),$=Ln(O.missingWarn)?O.missingWarn:e.missingWarn;Ln(O.fallbackWarn)?O.fallbackWarn:e.fallbackWarn;const q=!!O.part,ee=IT(e,O),ie=g(e,h,ee);if(!Mi(r)||r==="")return new Intl.NumberFormat(ee,U).format(C);let de={},ye,be=null;const se="number format";for(let Me=0;Me<ie.length&&(ye=ie[Me],de=n[ye]||{},be=de[r],!fn(be));Me++)PT(e,r,ye,$,se);if(!fn(be)||!Mi(ye))return l?Uv:r;let he=`${ye}__${r}`;Fv(U)||(he=`${he}__${JSON.stringify(U)}`);let fe=b.get(he);return fe||(fe=new Intl.NumberFormat(ye,ao({},be,U)),b.set(he,fe)),q?fe.formatToParts(C):fe.format(C)}const EP=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function Tw(...e){const[t,n,l,h]=e,d=Ss();let g=Ss();if(!yr(t))throw sh(rc.INVALID_ARGUMENT);const b=t;return Mi(n)?d.key=n:fn(n)&&Object.keys(n).forEach(r=>{EP.includes(r)?g[r]=n[r]:d[r]=n[r]}),Mi(l)?d.locale=l:fn(l)&&(g=l),fn(h)&&(g=h),[d.key||"",b,d,g]}function RM(e,t,n){const l=e;for(const h in n){const d=`${t}__${h}`;l.__numberFormatters.has(d)&&l.__numberFormatters.delete(d)}}UF();/*!
  * vue-i18n v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */const RN="9.14.5";function zN(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&(nu().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&(nu().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(nu().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(nu().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(nu().__INTLIFY_PROD_DEVTOOLS__=!1)}const BN=pN.__EXTEND_POINT__,Xh=Nv(BN);Xh(),Xh(),Xh(),Xh(),Xh(),Xh(),Xh(),Xh(),Xh();const SP=rc.__EXTEND_POINT__,wa=Nv(SP),jr={UNEXPECTED_RETURN_TYPE:SP,INVALID_ARGUMENT:wa(),MUST_BE_CALL_SETUP_TOP:wa(),NOT_INSTALLED:wa(),NOT_AVAILABLE_IN_LEGACY_MODE:wa(),REQUIRED_VALUE:wa(),INVALID_VALUE:wa(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:wa(),NOT_INSTALLED_WITH_PROVIDE:wa(),UNEXPECTED_ERROR:wa(),NOT_COMPATIBLE_LEGACY_VUE_I18N:wa(),BRIDGE_SUPPORT_VUE_2_ONLY:wa(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:wa(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:wa(),__EXTEND_POINT__:wa()};function to(e,...t){return Sg(e,null,void 0)}const Ew=Nd("__translateVNode"),Sw=Nd("__datetimeParts"),Mw=Nd("__numberParts"),MP=Nd("__setPluralRules"),CP=Nd("__injectWithOption"),Cw=Nd("__dispose");function Sy(e){if(!ts(e)||oh(e))return e;for(const t in e)if(sc(e,t))if(!t.includes("."))ts(e[t])&&Sy(e[t]);else{const n=t.split("."),l=n.length-1;let h=e,d=!1;for(let g=0;g<l;g++){if(n[g]==="__proto__")throw new Error(`unsafe key: ${n[g]}`);if(n[g]in h||(h[n[g]]=Ss()),!ts(h[n[g]])){d=!0;break}h=h[n[g]]}if(d||(oh(h)?uP.includes(n[l])||delete e[t]:(h[n[l]]=e[t],delete e[t])),!oh(h)){const g=h[n[l]];ts(g)&&Sy(g)}}return e}function Vv(e,t){const{messages:n,__i18n:l,messageResolver:h,flatJson:d}=t,g=fn(n)?n:Xs(l)?Ss():{[e]:Ss()};if(Xs(l)&&l.forEach(b=>{if("locale"in b&&"resource"in b){const{locale:r,resource:C}=b;r?(g[r]=g[r]||Ss(),P0(C,g[r])):P0(C,g)}else Mi(b)&&P0(JSON.parse(b),g)}),h==null&&d)for(const b in g)sc(g,b)&&Sy(g[b]);return g}function AP(e){return e.type}function kP(e,t,n){let l=ts(t.messages)?t.messages:Ss();"__i18nGlobal"in n&&(l=Vv(e.locale.value,{messages:l,__i18n:n.__i18nGlobal}));const h=Object.keys(l);h.length&&h.forEach(d=>{e.mergeLocaleMessage(d,l[d])});{if(ts(t.datetimeFormats)){const d=Object.keys(t.datetimeFormats);d.length&&d.forEach(g=>{e.mergeDateTimeFormat(g,t.datetimeFormats[g])})}if(ts(t.numberFormats)){const d=Object.keys(t.numberFormats);d.length&&d.forEach(g=>{e.mergeNumberFormat(g,t.numberFormats[g])})}}}function zM(e){return gn(ou,null,e,0)}const BM="__INTLIFY_META__",FM=()=>[],FN=()=>!1;let NM=0;function UM(e){return(t,n,l,h)=>e(n,l,lo()||void 0,h)}const NN=()=>{const e=lo();let t=null;return e&&(t=AP(e)[BM])?{[BM]:t}:null};function LT(e={},t){const{__root:n,__injectWithOption:l}=e,h=n===void 0,d=e.flatJson,g=nv?Vi:Dp,b=!!e.translateExistCompatible;let r=Ln(e.inheritLocale)?e.inheritLocale:!0;const C=g(n&&r?n.locale.value:Mi(e.locale)?e.locale:gg),O=g(n&&r?n.fallbackLocale.value:Mi(e.fallbackLocale)||Xs(e.fallbackLocale)||fn(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:C.value),U=g(Vv(C.value,e)),$=g(fn(e.datetimeFormats)?e.datetimeFormats:{[C.value]:{}}),q=g(fn(e.numberFormats)?e.numberFormats:{[C.value]:{}});let ee=n?n.missingWarn:Ln(e.missingWarn)||Od(e.missingWarn)?e.missingWarn:!0,ie=n?n.fallbackWarn:Ln(e.fallbackWarn)||Od(e.fallbackWarn)?e.fallbackWarn:!0,de=n?n.fallbackRoot:Ln(e.fallbackRoot)?e.fallbackRoot:!0,ye=!!e.fallbackFormat,be=Us(e.missing)?e.missing:null,se=Us(e.missing)?UM(e.missing):null,he=Us(e.postTranslation)?e.postTranslation:null,fe=n?n.warnHtmlMessage:Ln(e.warnHtmlMessage)?e.warnHtmlMessage:!0,Me=!!e.escapeParameter;const ze=n?n.modifiers:fn(e.modifiers)?e.modifiers:{};let ve=e.pluralRules||n&&n.pluralRules,Ue;Ue=(()=>{h&&CM(null);const mt={version:RN,locale:C.value,fallbackLocale:O.value,messages:U.value,modifiers:ze,pluralRules:ve,missing:se===null?void 0:se,missingWarn:ee,fallbackWarn:ie,fallbackFormat:ye,unresolving:!0,postTranslation:he===null?void 0:he,warnHtmlMessage:fe,escapeParameter:Me,messageResolver:e.messageResolver,messageCompiler:e.messageCompiler,__meta:{framework:"vue"}};mt.datetimeFormats=$.value,mt.numberFormats=q.value,mt.__datetimeFormatters=fn(Ue)?Ue.__datetimeFormatters:void 0,mt.__numberFormatters=fn(Ue)?Ue.__numberFormatters:void 0;const zt=SN(mt);return h&&CM(zt),zt})(),R_(Ue,C.value,O.value);function it(){return[C.value,O.value,U.value,$.value,q.value]}const Qe=Fn({get:()=>C.value,set:mt=>{C.value=mt,Ue.locale=C.value}}),Xe=Fn({get:()=>O.value,set:mt=>{O.value=mt,Ue.fallbackLocale=O.value,R_(Ue,C.value,mt)}}),Tt=Fn(()=>U.value),Rt=Fn(()=>$.value),St=Fn(()=>q.value);function Pt(){return Us(he)?he:null}function oi(mt){he=mt,Ue.postTranslation=mt}function ci(){return be}function pn(mt){mt!==null&&(se=UM(mt)),be=mt,Ue.missing=se}const Ni=(mt,zt,Ii,Oi,Kn,qn)=>{it();let _s;try{__INTLIFY_PROD_DEVTOOLS__,h||(Ue.fallbackContext=n?EN():void 0),_s=mt(Ue)}finally{__INTLIFY_PROD_DEVTOOLS__,h||(Ue.fallbackContext=void 0)}if(Ii!=="translate exists"&&yr(_s)&&_s===Uv||Ii==="translate exists"&&!_s){const[un,vr]=zt();return n&&de?Oi(n):Kn(un)}else{if(qn(_s))return _s;throw to(jr.UNEXPECTED_RETURN_TYPE)}};function ji(...mt){return Ni(zt=>Reflect.apply(PM,null,[zt,...mt]),()=>bw(...mt),"translate",zt=>Reflect.apply(zt.t,zt,[...mt]),zt=>zt,zt=>Mi(zt))}function An(...mt){const[zt,Ii,Oi]=mt;if(Oi&&!ts(Oi))throw to(jr.INVALID_ARGUMENT);return ji(zt,Ii,ao({resolvedMessage:!0},Oi||{}))}function Hi(...mt){return Ni(zt=>Reflect.apply(LM,null,[zt,...mt]),()=>ww(...mt),"datetime format",zt=>Reflect.apply(zt.d,zt,[...mt]),()=>EM,zt=>Mi(zt))}function Zn(...mt){return Ni(zt=>Reflect.apply(OM,null,[zt,...mt]),()=>Tw(...mt),"number format",zt=>Reflect.apply(zt.n,zt,[...mt]),()=>EM,zt=>Mi(zt))}function wn(mt){return mt.map(zt=>Mi(zt)||yr(zt)||Ln(zt)?zM(String(zt)):zt)}const Mt={normalize:wn,interpolate:mt=>mt,type:"vnode"};function xt(...mt){return Ni(zt=>{let Ii;const Oi=zt;try{Oi.processor=Mt,Ii=Reflect.apply(PM,null,[Oi,...mt])}finally{Oi.processor=null}return Ii},()=>bw(...mt),"translate",zt=>zt[Ew](...mt),zt=>[zM(zt)],zt=>Xs(zt))}function jt(...mt){return Ni(zt=>Reflect.apply(OM,null,[zt,...mt]),()=>Tw(...mt),"number format",zt=>zt[Mw](...mt),FM,zt=>Mi(zt)||Xs(zt))}function ki(...mt){return Ni(zt=>Reflect.apply(LM,null,[zt,...mt]),()=>ww(...mt),"datetime format",zt=>zt[Sw](...mt),FM,zt=>Mi(zt)||Xs(zt))}function ai(mt){ve=mt,Ue.pluralRules=ve}function Ee(mt,zt){return Ni(()=>{if(!mt)return!1;const Ii=Mi(zt)?zt:C.value,Oi=Bt(Ii),Kn=Ue.messageResolver(Oi,mt);return b?Kn!=null:oh(Kn)||wl(Kn)||Mi(Kn)},()=>[mt],"translate exists",Ii=>Reflect.apply(Ii.te,Ii,[mt,zt]),FN,Ii=>Ln(Ii))}function Ce(mt){let zt=null;const Ii=fP(Ue,O.value,C.value);for(let Oi=0;Oi<Ii.length;Oi++){const Kn=U.value[Ii[Oi]]||{},qn=Ue.messageResolver(Kn,mt);if(qn!=null){zt=qn;break}}return zt}function ct(mt){const zt=Ce(mt);return zt??(n?n.tm(mt)||{}:{})}function Bt(mt){return U.value[mt]||{}}function Dt(mt,zt){if(d){const Ii={[mt]:zt};for(const Oi in Ii)sc(Ii,Oi)&&Sy(Ii[Oi]);zt=Ii[mt]}U.value[mt]=zt,Ue.messages=U.value}function ei(mt,zt){U.value[mt]=U.value[mt]||{};const Ii={[mt]:zt};if(d)for(const Oi in Ii)sc(Ii,Oi)&&Sy(Ii[Oi]);zt=Ii[mt],P0(zt,U.value[mt]),Ue.messages=U.value}function di(mt){return $.value[mt]||{}}function Ie(mt,zt){$.value[mt]=zt,Ue.datetimeFormats=$.value,DM(Ue,mt,zt)}function Oe(mt,zt){$.value[mt]=ao($.value[mt]||{},zt),Ue.datetimeFormats=$.value,DM(Ue,mt,zt)}function rt(mt){return q.value[mt]||{}}function Zt(mt,zt){q.value[mt]=zt,Ue.numberFormats=q.value,RM(Ue,mt,zt)}function Yt(mt,zt){q.value[mt]=ao(q.value[mt]||{},zt),Ue.numberFormats=q.value,RM(Ue,mt,zt)}NM++,n&&nv&&(eo(n.locale,mt=>{r&&(C.value=mt,Ue.locale=mt,R_(Ue,C.value,O.value))}),eo(n.fallbackLocale,mt=>{r&&(O.value=mt,Ue.fallbackLocale=mt,R_(Ue,C.value,O.value))}));const ti={id:NM,locale:Qe,fallbackLocale:Xe,get inheritLocale(){return r},set inheritLocale(mt){r=mt,mt&&n&&(C.value=n.locale.value,O.value=n.fallbackLocale.value,R_(Ue,C.value,O.value))},get availableLocales(){return Object.keys(U.value).sort()},messages:Tt,get modifiers(){return ze},get pluralRules(){return ve||{}},get isGlobal(){return h},get missingWarn(){return ee},set missingWarn(mt){ee=mt,Ue.missingWarn=ee},get fallbackWarn(){return ie},set fallbackWarn(mt){ie=mt,Ue.fallbackWarn=ie},get fallbackRoot(){return de},set fallbackRoot(mt){de=mt},get fallbackFormat(){return ye},set fallbackFormat(mt){ye=mt,Ue.fallbackFormat=ye},get warnHtmlMessage(){return fe},set warnHtmlMessage(mt){fe=mt,Ue.warnHtmlMessage=mt},get escapeParameter(){return Me},set escapeParameter(mt){Me=mt,Ue.escapeParameter=mt},t:ji,getLocaleMessage:Bt,setLocaleMessage:Dt,mergeLocaleMessage:ei,getPostTranslationHandler:Pt,setPostTranslationHandler:oi,getMissingHandler:ci,setMissingHandler:pn,[MP]:ai};return ti.datetimeFormats=Rt,ti.numberFormats=St,ti.rt=An,ti.te=Ee,ti.tm=ct,ti.d=Hi,ti.n=Zn,ti.getDateTimeFormat=di,ti.setDateTimeFormat=Ie,ti.mergeDateTimeFormat=Oe,ti.getNumberFormat=rt,ti.setNumberFormat=Zt,ti.mergeNumberFormat=Yt,ti[CP]=l,ti[Ew]=xt,ti[Sw]=ki,ti[Mw]=jt,ti}function UN(e){const t=Mi(e.locale)?e.locale:gg,n=Mi(e.fallbackLocale)||Xs(e.fallbackLocale)||fn(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:t,l=Us(e.missing)?e.missing:void 0,h=Ln(e.silentTranslationWarn)||Od(e.silentTranslationWarn)?!e.silentTranslationWarn:!0,d=Ln(e.silentFallbackWarn)||Od(e.silentFallbackWarn)?!e.silentFallbackWarn:!0,g=Ln(e.fallbackRoot)?e.fallbackRoot:!0,b=!!e.formatFallbackMessages,r=fn(e.modifiers)?e.modifiers:{},C=e.pluralizationRules,O=Us(e.postTranslation)?e.postTranslation:void 0,U=Mi(e.warnHtmlInMessage)?e.warnHtmlInMessage!=="off":!0,$=!!e.escapeParameterHtml,q=Ln(e.sync)?e.sync:!0;let ee=e.messages;if(fn(e.sharedMessages)){const Me=e.sharedMessages;ee=Object.keys(Me).reduce((ve,Ue)=>{const Ne=ve[Ue]||(ve[Ue]={});return ao(Ne,Me[Ue]),ve},ee||{})}const{__i18n:ie,__root:de,__injectWithOption:ye}=e,be=e.datetimeFormats,se=e.numberFormats,he=e.flatJson,fe=e.translateExistCompatible;return{locale:t,fallbackLocale:n,messages:ee,flatJson:he,datetimeFormats:be,numberFormats:se,missing:l,missingWarn:h,fallbackWarn:d,fallbackRoot:g,fallbackFormat:b,modifiers:r,pluralRules:C,postTranslation:O,warnHtmlMessage:U,escapeParameter:$,messageResolver:e.messageResolver,inheritLocale:q,translateExistCompatible:fe,__i18n:ie,__root:de,__injectWithOption:ye}}function Aw(e={},t){{const n=LT(UN(e)),{__extender:l}=e,h={id:n.id,get locale(){return n.locale.value},set locale(d){n.locale.value=d},get fallbackLocale(){return n.fallbackLocale.value},set fallbackLocale(d){n.fallbackLocale.value=d},get messages(){return n.messages.value},get datetimeFormats(){return n.datetimeFormats.value},get numberFormats(){return n.numberFormats.value},get availableLocales(){return n.availableLocales},get formatter(){return{interpolate(){return[]}}},set formatter(d){},get missing(){return n.getMissingHandler()},set missing(d){n.setMissingHandler(d)},get silentTranslationWarn(){return Ln(n.missingWarn)?!n.missingWarn:n.missingWarn},set silentTranslationWarn(d){n.missingWarn=Ln(d)?!d:d},get silentFallbackWarn(){return Ln(n.fallbackWarn)?!n.fallbackWarn:n.fallbackWarn},set silentFallbackWarn(d){n.fallbackWarn=Ln(d)?!d:d},get modifiers(){return n.modifiers},get formatFallbackMessages(){return n.fallbackFormat},set formatFallbackMessages(d){n.fallbackFormat=d},get postTranslation(){return n.getPostTranslationHandler()},set postTranslation(d){n.setPostTranslationHandler(d)},get sync(){return n.inheritLocale},set sync(d){n.inheritLocale=d},get warnHtmlInMessage(){return n.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(d){n.warnHtmlMessage=d!=="off"},get escapeParameterHtml(){return n.escapeParameter},set escapeParameterHtml(d){n.escapeParameter=d},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(d){},get pluralizationRules(){return n.pluralRules||{}},__composer:n,t(...d){const[g,b,r]=d,C={};let O=null,U=null;if(!Mi(g))throw to(jr.INVALID_ARGUMENT);const $=g;return Mi(b)?C.locale=b:Xs(b)?O=b:fn(b)&&(U=b),Xs(r)?O=r:fn(r)&&(U=r),Reflect.apply(n.t,n,[$,O||U||{},C])},rt(...d){return Reflect.apply(n.rt,n,[...d])},tc(...d){const[g,b,r]=d,C={plural:1};let O=null,U=null;if(!Mi(g))throw to(jr.INVALID_ARGUMENT);const $=g;return Mi(b)?C.locale=b:yr(b)?C.plural=b:Xs(b)?O=b:fn(b)&&(U=b),Mi(r)?C.locale=r:Xs(r)?O=r:fn(r)&&(U=r),Reflect.apply(n.t,n,[$,O||U||{},C])},te(d,g){return n.te(d,g)},tm(d){return n.tm(d)},getLocaleMessage(d){return n.getLocaleMessage(d)},setLocaleMessage(d,g){n.setLocaleMessage(d,g)},mergeLocaleMessage(d,g){n.mergeLocaleMessage(d,g)},d(...d){return Reflect.apply(n.d,n,[...d])},getDateTimeFormat(d){return n.getDateTimeFormat(d)},setDateTimeFormat(d,g){n.setDateTimeFormat(d,g)},mergeDateTimeFormat(d,g){n.mergeDateTimeFormat(d,g)},n(...d){return Reflect.apply(n.n,n,[...d])},getNumberFormat(d){return n.getNumberFormat(d)},setNumberFormat(d,g){n.setNumberFormat(d,g)},mergeNumberFormat(d,g){n.mergeNumberFormat(d,g)},getChoiceIndex(d,g){return-1}};return h.__extender=l,h}}const DT={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:e=>e==="parent"||e==="global",default:"parent"},i18n:{type:Object}};function VN({slots:e},t){return t.length===1&&t[0]==="default"?(e.default?e.default():[]).reduce((l,h)=>[...l,...h.type===Dn?h.children:[h]],[]):t.reduce((n,l)=>{const h=e[l];return h&&(n[l]=h()),n},Ss())}function IP(e){return Dn}const jN=gs({name:"i18n-t",props:ao({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:e=>yr(e)||!isNaN(e)}},DT),setup(e,t){const{slots:n,attrs:l}=t,h=e.i18n||Rp({useScope:e.scope,__useComponent:!0});return()=>{const d=Object.keys(n).filter(U=>U!=="_"),g=Ss();e.locale&&(g.locale=e.locale),e.plural!==void 0&&(g.plural=Mi(e.plural)?+e.plural:e.plural);const b=VN(t,d),r=h[Ew](e.keypath,b,g),C=ao(Ss(),l),O=Mi(e.tag)||ts(e.tag)?e.tag:IP();return hu(O,C,r)}}}),VM=jN;function $N(e){return Xs(e)&&!Mi(e[0])}function PP(e,t,n,l){const{slots:h,attrs:d}=t;return()=>{const g={part:!0};let b=Ss();e.locale&&(g.locale=e.locale),Mi(e.format)?g.key=e.format:ts(e.format)&&(Mi(e.format.key)&&(g.key=e.format.key),b=Object.keys(e.format).reduce(($,q)=>n.includes(q)?ao(Ss(),$,{[q]:e.format[q]}):$,Ss()));const r=l(e.value,g,b);let C=[g.key];Xs(r)?C=r.map(($,q)=>{const ee=h[$.type],ie=ee?ee({[$.type]:$.value,index:q,parts:r}):[$.value];return $N(ie)&&(ie[0].key=`${$.type}-${q}`),ie}):Mi(r)&&(C=[r]);const O=ao(Ss(),d),U=Mi(e.tag)||ts(e.tag)?e.tag:IP();return hu(U,O,C)}}const WN=gs({name:"i18n-n",props:ao({value:{type:Number,required:!0},format:{type:[String,Object]}},DT),setup(e,t){const n=e.i18n||Rp({useScope:e.scope,__useComponent:!0});return PP(e,t,EP,(...l)=>n[Mw](...l))}}),jM=WN,GN=gs({name:"i18n-d",props:ao({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},DT),setup(e,t){const n=e.i18n||Rp({useScope:e.scope,__useComponent:!0});return PP(e,t,TP,(...l)=>n[Sw](...l))}}),$M=GN;function HN(e,t){const n=e;if(e.mode==="composition")return n.__getInstance(t)||e.global;{const l=n.__getInstance(t);return l!=null?l.__composer:e.global.__composer}}function qN(e){const t=g=>{const{instance:b,modifiers:r,value:C}=g;if(!b||!b.$)throw to(jr.UNEXPECTED_ERROR);const O=HN(e,b.$),U=WM(C);return[Reflect.apply(O.t,O,[...GM(U)]),O]};return{created:(g,b)=>{const[r,C]=t(b);nv&&e.global===C&&(g.__i18nWatcher=eo(C.locale,()=>{b.instance&&b.instance.$forceUpdate()})),g.__composer=C,g.textContent=r},unmounted:g=>{nv&&g.__i18nWatcher&&(g.__i18nWatcher(),g.__i18nWatcher=void 0,delete g.__i18nWatcher),g.__composer&&(g.__composer=void 0,delete g.__composer)},beforeUpdate:(g,{value:b})=>{if(g.__composer){const r=g.__composer,C=WM(b);g.textContent=Reflect.apply(r.t,r,[...GM(C)])}},getSSRProps:g=>{const[b]=t(g);return{textContent:b}}}}function WM(e){if(Mi(e))return{path:e};if(fn(e)){if(!("path"in e))throw to(jr.REQUIRED_VALUE,"path");return e}else throw to(jr.INVALID_VALUE)}function GM(e){const{path:t,locale:n,args:l,choice:h,plural:d}=e,g={},b=l||{};return Mi(n)&&(g.locale=n),yr(h)&&(g.plural=h),yr(d)&&(g.plural=d),[t,b,g]}function XN(e,t,...n){const l=fn(n[0])?n[0]:{},h=!!l.useI18nComponentName;(Ln(l.globalInstall)?l.globalInstall:!0)&&([h?"i18n":VM.name,"I18nT"].forEach(g=>e.component(g,VM)),[jM.name,"I18nN"].forEach(g=>e.component(g,jM)),[$M.name,"I18nD"].forEach(g=>e.component(g,$M))),e.directive("t",qN(t))}function ZN(e,t,n){return{beforeCreate(){const l=lo();if(!l)throw to(jr.UNEXPECTED_ERROR);const h=this.$options;if(h.i18n){const d=h.i18n;if(h.__i18n&&(d.__i18n=h.__i18n),d.__root=t,this===this.$root)this.$i18n=HM(e,d);else{d.__injectWithOption=!0,d.__extender=n.__vueI18nExtend,this.$i18n=Aw(d);const g=this.$i18n;g.__extender&&(g.__disposer=g.__extender(this.$i18n))}}else if(h.__i18n)if(this===this.$root)this.$i18n=HM(e,h);else{this.$i18n=Aw({__i18n:h.__i18n,__injectWithOption:!0,__extender:n.__vueI18nExtend,__root:t});const d=this.$i18n;d.__extender&&(d.__disposer=d.__extender(this.$i18n))}else this.$i18n=e;h.__i18nGlobal&&kP(t,h,h),this.$t=(...d)=>this.$i18n.t(...d),this.$rt=(...d)=>this.$i18n.rt(...d),this.$tc=(...d)=>this.$i18n.tc(...d),this.$te=(d,g)=>this.$i18n.te(d,g),this.$d=(...d)=>this.$i18n.d(...d),this.$n=(...d)=>this.$i18n.n(...d),this.$tm=d=>this.$i18n.tm(d),n.__setInstance(l,this.$i18n)},mounted(){},unmounted(){const l=lo();if(!l)throw to(jr.UNEXPECTED_ERROR);const h=this.$i18n;delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,h.__disposer&&(h.__disposer(),delete h.__disposer,delete h.__extender),n.__deleteInstance(l),delete this.$i18n}}}function HM(e,t){e.locale=t.locale||e.locale,e.fallbackLocale=t.fallbackLocale||e.fallbackLocale,e.missing=t.missing||e.missing,e.silentTranslationWarn=t.silentTranslationWarn||e.silentFallbackWarn,e.silentFallbackWarn=t.silentFallbackWarn||e.silentFallbackWarn,e.formatFallbackMessages=t.formatFallbackMessages||e.formatFallbackMessages,e.postTranslation=t.postTranslation||e.postTranslation,e.warnHtmlInMessage=t.warnHtmlInMessage||e.warnHtmlInMessage,e.escapeParameterHtml=t.escapeParameterHtml||e.escapeParameterHtml,e.sync=t.sync||e.sync,e.__composer[MP](t.pluralizationRules||e.pluralizationRules);const n=Vv(e.locale,{messages:t.messages,__i18n:t.__i18n});return Object.keys(n).forEach(l=>e.mergeLocaleMessage(l,n[l])),t.datetimeFormats&&Object.keys(t.datetimeFormats).forEach(l=>e.mergeDateTimeFormat(l,t.datetimeFormats[l])),t.numberFormats&&Object.keys(t.numberFormats).forEach(l=>e.mergeNumberFormat(l,t.numberFormats[l])),e}const YN=Nd("global-vue-i18n");function KN(e={},t){const n=__VUE_I18N_LEGACY_API__&&Ln(e.legacy)?e.legacy:__VUE_I18N_LEGACY_API__,l=Ln(e.globalInjection)?e.globalInjection:!0,h=__VUE_I18N_LEGACY_API__&&n?!!e.allowComposition:!0,d=new Map,[g,b]=JN(e,n),r=Nd("");function C($){return d.get($)||null}function O($,q){d.set($,q)}function U($){d.delete($)}{const $={get mode(){return __VUE_I18N_LEGACY_API__&&n?"legacy":"composition"},get allowComposition(){return h},async install(q,...ee){if(q.__VUE_I18N_SYMBOL__=r,q.provide(q.__VUE_I18N_SYMBOL__,$),fn(ee[0])){const ye=ee[0];$.__composerExtend=ye.__composerExtend,$.__vueI18nExtend=ye.__vueI18nExtend}let ie=null;!n&&l&&(ie=a5(q,$.global)),__VUE_I18N_FULL_INSTALL__&&XN(q,$,...ee),__VUE_I18N_LEGACY_API__&&n&&q.mixin(ZN(b,b.__composer,$));const de=q.unmount;q.unmount=()=>{ie&&ie(),$.dispose(),de()}},get global(){return b},dispose(){g.stop()},__instances:d,__getInstance:C,__setInstance:O,__deleteInstance:U};return $}}function Rp(e={}){const t=lo();if(t==null)throw to(jr.MUST_BE_CALL_SETUP_TOP);if(!t.isCE&&t.appContext.app!=null&&!t.appContext.app.__VUE_I18N_SYMBOL__)throw to(jr.NOT_INSTALLED);const n=QN(t),l=t5(n),h=AP(t),d=e5(e,h);if(__VUE_I18N_LEGACY_API__&&n.mode==="legacy"&&!e.__useComponent){if(!n.allowComposition)throw to(jr.NOT_AVAILABLE_IN_LEGACY_MODE);return r5(t,d,l,e)}if(d==="global")return kP(l,e,h),l;if(d==="parent"){let r=i5(n,t,e.__useComponent);return r==null&&(r=l),r}const g=n;let b=g.__getInstance(t);if(b==null){const r=ao({},e);"__i18n"in h&&(r.__i18n=h.__i18n),l&&(r.__root=l),b=LT(r),g.__composerExtend&&(b[Cw]=g.__composerExtend(b)),s5(g,t,b),g.__setInstance(t,b)}return b}function JN(e,t,n){const l=bv();{const h=__VUE_I18N_LEGACY_API__&&t?l.run(()=>Aw(e)):l.run(()=>LT(e));if(h==null)throw to(jr.UNEXPECTED_ERROR);return[l,h]}}function QN(e){{const t=ia(e.isCE?YN:e.appContext.app.__VUE_I18N_SYMBOL__);if(!t)throw to(e.isCE?jr.NOT_INSTALLED_WITH_PROVIDE:jr.UNEXPECTED_ERROR);return t}}function e5(e,t){return Fv(e)?"__i18n"in t?"local":"global":e.useScope?e.useScope:"local"}function t5(e){return e.mode==="composition"?e.global:e.global.__composer}function i5(e,t,n=!1){let l=null;const h=t.root;let d=n5(t,n);for(;d!=null;){const g=e;if(e.mode==="composition")l=g.__getInstance(d);else if(__VUE_I18N_LEGACY_API__){const b=g.__getInstance(d);b!=null&&(l=b.__composer,n&&l&&!l[CP]&&(l=null))}if(l!=null||h===d)break;d=d.parent}return l}function n5(e,t=!1){return e==null?null:t&&e.vnode.ctx||e.parent}function s5(e,t,n){nl(()=>{},t),Eg(()=>{const l=n;e.__deleteInstance(t);const h=l[Cw];h&&(h(),delete l[Cw])},t)}function r5(e,t,n,l={}){const h=t==="local",d=Dp(null);if(h&&e.proxy&&!(e.proxy.$options.i18n||e.proxy.$options.__i18n))throw to(jr.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION);const g=Ln(l.inheritLocale)?l.inheritLocale:!Mi(l.locale),b=Vi(!h||g?n.locale.value:Mi(l.locale)?l.locale:gg),r=Vi(!h||g?n.fallbackLocale.value:Mi(l.fallbackLocale)||Xs(l.fallbackLocale)||fn(l.fallbackLocale)||l.fallbackLocale===!1?l.fallbackLocale:b.value),C=Vi(Vv(b.value,l)),O=Vi(fn(l.datetimeFormats)?l.datetimeFormats:{[b.value]:{}}),U=Vi(fn(l.numberFormats)?l.numberFormats:{[b.value]:{}}),$=h?n.missingWarn:Ln(l.missingWarn)||Od(l.missingWarn)?l.missingWarn:!0,q=h?n.fallbackWarn:Ln(l.fallbackWarn)||Od(l.fallbackWarn)?l.fallbackWarn:!0,ee=h?n.fallbackRoot:Ln(l.fallbackRoot)?l.fallbackRoot:!0,ie=!!l.fallbackFormat,de=Us(l.missing)?l.missing:null,ye=Us(l.postTranslation)?l.postTranslation:null,be=h?n.warnHtmlMessage:Ln(l.warnHtmlMessage)?l.warnHtmlMessage:!0,se=!!l.escapeParameter,he=h?n.modifiers:fn(l.modifiers)?l.modifiers:{},fe=l.pluralRules||h&&n.pluralRules;function Me(){return[b.value,r.value,C.value,O.value,U.value]}const ze=Fn({get:()=>d.value?d.value.locale.value:b.value,set:Ce=>{d.value&&(d.value.locale.value=Ce),b.value=Ce}}),ve=Fn({get:()=>d.value?d.value.fallbackLocale.value:r.value,set:Ce=>{d.value&&(d.value.fallbackLocale.value=Ce),r.value=Ce}}),Ue=Fn(()=>d.value?d.value.messages.value:C.value),Ne=Fn(()=>O.value),it=Fn(()=>U.value);function Qe(){return d.value?d.value.getPostTranslationHandler():ye}function Xe(Ce){d.value&&d.value.setPostTranslationHandler(Ce)}function Tt(){return d.value?d.value.getMissingHandler():de}function Rt(Ce){d.value&&d.value.setMissingHandler(Ce)}function St(Ce){return Me(),Ce()}function Pt(...Ce){return d.value?St(()=>Reflect.apply(d.value.t,null,[...Ce])):St(()=>"")}function oi(...Ce){return d.value?Reflect.apply(d.value.rt,null,[...Ce]):""}function ci(...Ce){return d.value?St(()=>Reflect.apply(d.value.d,null,[...Ce])):St(()=>"")}function pn(...Ce){return d.value?St(()=>Reflect.apply(d.value.n,null,[...Ce])):St(()=>"")}function Ni(Ce){return d.value?d.value.tm(Ce):{}}function ji(Ce,ct){return d.value?d.value.te(Ce,ct):!1}function An(Ce){return d.value?d.value.getLocaleMessage(Ce):{}}function Hi(Ce,ct){d.value&&(d.value.setLocaleMessage(Ce,ct),C.value[Ce]=ct)}function Zn(Ce,ct){d.value&&d.value.mergeLocaleMessage(Ce,ct)}function wn(Ce){return d.value?d.value.getDateTimeFormat(Ce):{}}function nt(Ce,ct){d.value&&(d.value.setDateTimeFormat(Ce,ct),O.value[Ce]=ct)}function Mt(Ce,ct){d.value&&d.value.mergeDateTimeFormat(Ce,ct)}function xt(Ce){return d.value?d.value.getNumberFormat(Ce):{}}function jt(Ce,ct){d.value&&(d.value.setNumberFormat(Ce,ct),U.value[Ce]=ct)}function ki(Ce,ct){d.value&&d.value.mergeNumberFormat(Ce,ct)}const ai={get id(){return d.value?d.value.id:-1},locale:ze,fallbackLocale:ve,messages:Ue,datetimeFormats:Ne,numberFormats:it,get inheritLocale(){return d.value?d.value.inheritLocale:g},set inheritLocale(Ce){d.value&&(d.value.inheritLocale=Ce)},get availableLocales(){return d.value?d.value.availableLocales:Object.keys(C.value)},get modifiers(){return d.value?d.value.modifiers:he},get pluralRules(){return d.value?d.value.pluralRules:fe},get isGlobal(){return d.value?d.value.isGlobal:!1},get missingWarn(){return d.value?d.value.missingWarn:$},set missingWarn(Ce){d.value&&(d.value.missingWarn=Ce)},get fallbackWarn(){return d.value?d.value.fallbackWarn:q},set fallbackWarn(Ce){d.value&&(d.value.missingWarn=Ce)},get fallbackRoot(){return d.value?d.value.fallbackRoot:ee},set fallbackRoot(Ce){d.value&&(d.value.fallbackRoot=Ce)},get fallbackFormat(){return d.value?d.value.fallbackFormat:ie},set fallbackFormat(Ce){d.value&&(d.value.fallbackFormat=Ce)},get warnHtmlMessage(){return d.value?d.value.warnHtmlMessage:be},set warnHtmlMessage(Ce){d.value&&(d.value.warnHtmlMessage=Ce)},get escapeParameter(){return d.value?d.value.escapeParameter:se},set escapeParameter(Ce){d.value&&(d.value.escapeParameter=Ce)},t:Pt,getPostTranslationHandler:Qe,setPostTranslationHandler:Xe,getMissingHandler:Tt,setMissingHandler:Rt,rt:oi,d:ci,n:pn,tm:Ni,te:ji,getLocaleMessage:An,setLocaleMessage:Hi,mergeLocaleMessage:Zn,getDateTimeFormat:wn,setDateTimeFormat:nt,mergeDateTimeFormat:Mt,getNumberFormat:xt,setNumberFormat:jt,mergeNumberFormat:ki};function Ee(Ce){Ce.locale.value=b.value,Ce.fallbackLocale.value=r.value,Object.keys(C.value).forEach(ct=>{Ce.mergeLocaleMessage(ct,C.value[ct])}),Object.keys(O.value).forEach(ct=>{Ce.mergeDateTimeFormat(ct,O.value[ct])}),Object.keys(U.value).forEach(ct=>{Ce.mergeNumberFormat(ct,U.value[ct])}),Ce.escapeParameter=se,Ce.fallbackFormat=ie,Ce.fallbackRoot=ee,Ce.fallbackWarn=q,Ce.missingWarn=$,Ce.warnHtmlMessage=be}return uT(()=>{if(e.proxy==null||e.proxy.$i18n==null)throw to(jr.NOT_AVAILABLE_COMPOSITION_IN_LEGACY);const Ce=d.value=e.proxy.$i18n.__composer;t==="global"?(b.value=Ce.locale.value,r.value=Ce.fallbackLocale.value,C.value=Ce.messages.value,O.value=Ce.datetimeFormats.value,U.value=Ce.numberFormats.value):h&&Ee(Ce)}),ai}const o5=["locale","fallbackLocale","availableLocales"],qM=["t","rt","d","n","tm","te"];function a5(e,t){const n=Object.create(null);return o5.forEach(h=>{const d=Object.getOwnPropertyDescriptor(t,h);if(!d)throw to(jr.UNEXPECTED_ERROR);const g=Zs(d.value)?{get(){return d.value.value},set(b){d.value.value=b}}:{get(){return d.get&&d.get()}};Object.defineProperty(n,h,g)}),e.config.globalProperties.$i18n=n,qM.forEach(h=>{const d=Object.getOwnPropertyDescriptor(t,h);if(!d||!d.value)throw to(jr.UNEXPECTED_ERROR);Object.defineProperty(e.config.globalProperties,`$${h}`,d)}),()=>{delete e.config.globalProperties.$i18n,qM.forEach(h=>{delete e.config.globalProperties[`$${h}`]})}}zN();__INTLIFY_JIT_COMPILATION__?MM(IN):MM(kN);vN(eN);bN(fP);if(__INTLIFY_PROD_DEVTOOLS__){const e=nu();e.__INTLIFY__=!0,cN(e.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}/*!
 * pinia v3.0.2
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let OT;const jv=e=>OT=e,l5=()=>_T()&&ia(RT)||OT,RT=Symbol();function kw(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var ry;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(ry||(ry={}));function c5(){const e=bv(!0),t=e.run(()=>Vi({}));let n=[],l=[];const h=Mv({install(d){jv(h),h._a=d,d.provide(RT,h),d.config.globalProperties.$pinia=h,l.forEach(g=>n.push(g)),l=[]},use(d){return this._a?n.push(d):l.push(d),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return h}const LP=()=>{};function XM(e,t,n,l=LP){e.push(t);const h=()=>{const d=e.indexOf(t);d>-1&&(e.splice(d,1),l())};return!n&&eT()&&jA(h),h}function Wm(e,...t){e.slice().forEach(n=>{n(...t)})}const h5=e=>e(),ZM=Symbol(),I1=Symbol();function Iw(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,l)=>e.set(l,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const l=t[n],h=e[n];kw(h)&&kw(l)&&e.hasOwnProperty(n)&&!Zs(l)&&!lc(l)?e[n]=Iw(h,l):e[n]=l}return e}const u5=Symbol();function d5(e){return!kw(e)||!Object.prototype.hasOwnProperty.call(e,u5)}const{assign:xd}=Object;function f5(e){return!!(Zs(e)&&e.effect)}function p5(e,t,n,l){const{state:h,actions:d,getters:g}=t,b=n.state.value[e];let r;function C(){b||(n.state.value[e]=h?h():{});const O=ok(n.state.value[e]);return xd(O,d,Object.keys(g||{}).reduce((U,$)=>(U[$]=Mv(Fn(()=>{jv(n);const q=n._s.get(e);return g[$].call(q,q)})),U),{}))}return r=DP(e,C,t,n,l,!0),r}function DP(e,t,n={},l,h,d){let g;const b=xd({actions:{}},n),r={deep:!0};let C,O,U=[],$=[],q;const ee=l.state.value[e];!d&&!ee&&(l.state.value[e]={}),Vi({});let ie;function de(ve){let Ue;C=O=!1,typeof ve=="function"?(ve(l.state.value[e]),Ue={type:ry.patchFunction,storeId:e,events:q}):(Iw(l.state.value[e],ve),Ue={type:ry.patchObject,payload:ve,storeId:e,events:q});const Ne=ie=Symbol();Fd().then(()=>{ie===Ne&&(C=!0)}),O=!0,Wm(U,Ue,l.state.value[e])}const ye=d?function(){const{state:Ue}=n,Ne=Ue?Ue():{};this.$patch(it=>{xd(it,Ne)})}:LP;function be(){g.stop(),U=[],$=[],l._s.delete(e)}const se=(ve,Ue="")=>{if(ZM in ve)return ve[I1]=Ue,ve;const Ne=function(){jv(l);const it=Array.from(arguments),Qe=[],Xe=[];function Tt(Pt){Qe.push(Pt)}function Rt(Pt){Xe.push(Pt)}Wm($,{args:it,name:Ne[I1],store:fe,after:Tt,onError:Rt});let St;try{St=ve.apply(this&&this.$id===e?this:fe,it)}catch(Pt){throw Wm(Xe,Pt),Pt}return St instanceof Promise?St.then(Pt=>(Wm(Qe,Pt),Pt)).catch(Pt=>(Wm(Xe,Pt),Promise.reject(Pt))):(Wm(Qe,St),St)};return Ne[ZM]=!0,Ne[I1]=Ue,Ne},he={_p:l,$id:e,$onAction:XM.bind(null,$),$patch:de,$reset:ye,$subscribe(ve,Ue={}){const Ne=XM(U,ve,Ue.detached,()=>it()),it=g.run(()=>eo(()=>l.state.value[e],Qe=>{(Ue.flush==="sync"?O:C)&&ve({storeId:e,type:ry.direct,events:q},Qe)},xd({},r,Ue)));return Ne},$dispose:be},fe=vg(he);l._s.set(e,fe);const ze=(l._a&&l._a.runWithContext||h5)(()=>l._e.run(()=>(g=bv()).run(()=>t({action:se}))));for(const ve in ze){const Ue=ze[ve];if(Zs(Ue)&&!f5(Ue)||lc(Ue))d||(ee&&d5(Ue)&&(Zs(Ue)?Ue.value=ee[ve]:Iw(Ue,ee[ve])),l.state.value[e][ve]=Ue);else if(typeof Ue=="function"){const Ne=se(Ue,ve);ze[ve]=Ne,b.actions[ve]=Ue}}return xd(fe,ze),xd(Sn(fe),ze),Object.defineProperty(fe,"$state",{get:()=>l.state.value[e],set:ve=>{de(Ue=>{xd(Ue,ve)})}}),l._p.forEach(ve=>{xd(fe,g.run(()=>ve({store:fe,app:l._a,pinia:l,options:b})))}),ee&&d&&n.hydrate&&n.hydrate(fe.$state,ee),C=!0,O=!0,fe}/*! #__NO_SIDE_EFFECTS__ */function zT(e,t,n){let l;const h=typeof t=="function";l=h?n:t;function d(g,b){const r=_T();return g=g||(r?ia(RT,null):null),g&&jv(g),g=OT,g._s.has(e)||(h?DP(e,t,l,g):p5(e,l,g)),g._s.get(e)}return d.$id=e,d}function m5(e){const t=Sn(e),n={};for(const l in t){const h=t[l];h.effect?n[l]=Fn({get:()=>e[l],set(d){e[l]=d}}):(Zs(h)||lc(h))&&(n[l]=ak(e,l))}return n}function OP(e,t){return function(){return e.apply(t,arguments)}}const{toString:g5}=Object.prototype,{getPrototypeOf:BT}=Object,$v=(e=>t=>{const n=g5.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),dc=e=>(e=e.toLowerCase(),t=>$v(t)===e),Wv=e=>t=>typeof t===e,{isArray:Mg}=Array,My=Wv("undefined");function _5(e){return e!==null&&!My(e)&&e.constructor!==null&&!My(e.constructor)&&il(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const RP=dc("ArrayBuffer");function y5(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&RP(e.buffer),t}const x5=Wv("string"),il=Wv("function"),zP=Wv("number"),Gv=e=>e!==null&&typeof e=="object",v5=e=>e===!0||e===!1,L0=e=>{if($v(e)!=="object")return!1;const t=BT(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},b5=dc("Date"),w5=dc("File"),T5=dc("Blob"),E5=dc("FileList"),S5=e=>Gv(e)&&il(e.pipe),M5=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||il(e.append)&&((t=$v(e))==="formdata"||t==="object"&&il(e.toString)&&e.toString()==="[object FormData]"))},C5=dc("URLSearchParams"),[A5,k5,I5,P5]=["ReadableStream","Request","Response","Headers"].map(dc),L5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jy(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let l,h;if(typeof e!="object"&&(e=[e]),Mg(e))for(l=0,h=e.length;l<h;l++)t.call(null,e[l],l,e);else{const d=n?Object.getOwnPropertyNames(e):Object.keys(e),g=d.length;let b;for(l=0;l<g;l++)b=d[l],t.call(null,e[b],b,e)}}function BP(e,t){t=t.toLowerCase();const n=Object.keys(e);let l=n.length,h;for(;l-- >0;)if(h=n[l],t===h.toLowerCase())return h;return null}const yp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,FP=e=>!My(e)&&e!==yp;function Pw(){const{caseless:e}=FP(this)&&this||{},t={},n=(l,h)=>{const d=e&&BP(t,h)||h;L0(t[d])&&L0(l)?t[d]=Pw(t[d],l):L0(l)?t[d]=Pw({},l):Mg(l)?t[d]=l.slice():t[d]=l};for(let l=0,h=arguments.length;l<h;l++)arguments[l]&&jy(arguments[l],n);return t}const D5=(e,t,n,{allOwnKeys:l}={})=>(jy(t,(h,d)=>{n&&il(h)?e[d]=OP(h,n):e[d]=h},{allOwnKeys:l}),e),O5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),R5=(e,t,n,l)=>{e.prototype=Object.create(t.prototype,l),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},z5=(e,t,n,l)=>{let h,d,g;const b={};if(t=t||{},e==null)return t;do{for(h=Object.getOwnPropertyNames(e),d=h.length;d-- >0;)g=h[d],(!l||l(g,e,t))&&!b[g]&&(t[g]=e[g],b[g]=!0);e=n!==!1&&BT(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},B5=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const l=e.indexOf(t,n);return l!==-1&&l===n},F5=e=>{if(!e)return null;if(Mg(e))return e;let t=e.length;if(!zP(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},N5=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&BT(Uint8Array)),U5=(e,t)=>{const l=(e&&e[Symbol.iterator]).call(e);let h;for(;(h=l.next())&&!h.done;){const d=h.value;t.call(e,d[0],d[1])}},V5=(e,t)=>{let n;const l=[];for(;(n=e.exec(t))!==null;)l.push(n);return l},j5=dc("HTMLFormElement"),$5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,l,h){return l.toUpperCase()+h}),YM=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),W5=dc("RegExp"),NP=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),l={};jy(n,(h,d)=>{let g;(g=t(h,d,e))!==!1&&(l[d]=g||h)}),Object.defineProperties(e,l)},G5=e=>{NP(e,(t,n)=>{if(il(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const l=e[n];if(il(l)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},H5=(e,t)=>{const n={},l=h=>{h.forEach(d=>{n[d]=!0})};return Mg(e)?l(e):l(String(e).split(t)),n},q5=()=>{},X5=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Z5(e){return!!(e&&il(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Y5=e=>{const t=new Array(10),n=(l,h)=>{if(Gv(l)){if(t.indexOf(l)>=0)return;if(!("toJSON"in l)){t[h]=l;const d=Mg(l)?[]:{};return jy(l,(g,b)=>{const r=n(g,h+1);!My(r)&&(d[b]=r)}),t[h]=void 0,d}}return l};return n(e,0)},K5=dc("AsyncFunction"),J5=e=>e&&(Gv(e)||il(e))&&il(e.then)&&il(e.catch),UP=((e,t)=>e?setImmediate:t?((n,l)=>(yp.addEventListener("message",({source:h,data:d})=>{h===yp&&d===n&&l.length&&l.shift()()},!1),h=>{l.push(h),yp.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",il(yp.postMessage)),Q5=typeof queueMicrotask<"u"?queueMicrotask.bind(yp):typeof process<"u"&&process.nextTick||UP,Ft={isArray:Mg,isArrayBuffer:RP,isBuffer:_5,isFormData:M5,isArrayBufferView:y5,isString:x5,isNumber:zP,isBoolean:v5,isObject:Gv,isPlainObject:L0,isReadableStream:A5,isRequest:k5,isResponse:I5,isHeaders:P5,isUndefined:My,isDate:b5,isFile:w5,isBlob:T5,isRegExp:W5,isFunction:il,isStream:S5,isURLSearchParams:C5,isTypedArray:N5,isFileList:E5,forEach:jy,merge:Pw,extend:D5,trim:L5,stripBOM:O5,inherits:R5,toFlatObject:z5,kindOf:$v,kindOfTest:dc,endsWith:B5,toArray:F5,forEachEntry:U5,matchAll:V5,isHTMLForm:j5,hasOwnProperty:YM,hasOwnProp:YM,reduceDescriptors:NP,freezeMethods:G5,toObjectSet:H5,toCamelCase:$5,noop:q5,toFiniteNumber:X5,findKey:BP,global:yp,isContextDefined:FP,isSpecCompliantForm:Z5,toJSONObject:Y5,isAsyncFn:K5,isThenable:J5,setImmediate:UP,asap:Q5};function bn(e,t,n,l,h){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),l&&(this.request=l),h&&(this.response=h,this.status=h.status?h.status:null)}Ft.inherits(bn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ft.toJSONObject(this.config),code:this.code,status:this.status}}});const VP=bn.prototype,jP={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{jP[e]={value:e}});Object.defineProperties(bn,jP);Object.defineProperty(VP,"isAxiosError",{value:!0});bn.from=(e,t,n,l,h,d)=>{const g=Object.create(VP);return Ft.toFlatObject(e,g,function(r){return r!==Error.prototype},b=>b!=="isAxiosError"),bn.call(g,e.message,t,n,l,h),g.cause=e,g.name=e.name,d&&Object.assign(g,d),g};const e4=null;function Lw(e){return Ft.isPlainObject(e)||Ft.isArray(e)}function $P(e){return Ft.endsWith(e,"[]")?e.slice(0,-2):e}function KM(e,t,n){return e?e.concat(t).map(function(h,d){return h=$P(h),!n&&d?"["+h+"]":h}).join(n?".":""):t}function t4(e){return Ft.isArray(e)&&!e.some(Lw)}const i4=Ft.toFlatObject(Ft,{},null,function(t){return/^is[A-Z]/.test(t)});function Hv(e,t,n){if(!Ft.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Ft.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(ie,de){return!Ft.isUndefined(de[ie])});const l=n.metaTokens,h=n.visitor||O,d=n.dots,g=n.indexes,r=(n.Blob||typeof Blob<"u"&&Blob)&&Ft.isSpecCompliantForm(t);if(!Ft.isFunction(h))throw new TypeError("visitor must be a function");function C(ee){if(ee===null)return"";if(Ft.isDate(ee))return ee.toISOString();if(!r&&Ft.isBlob(ee))throw new bn("Blob is not supported. Use a Buffer instead.");return Ft.isArrayBuffer(ee)||Ft.isTypedArray(ee)?r&&typeof Blob=="function"?new Blob([ee]):Buffer.from(ee):ee}function O(ee,ie,de){let ye=ee;if(ee&&!de&&typeof ee=="object"){if(Ft.endsWith(ie,"{}"))ie=l?ie:ie.slice(0,-2),ee=JSON.stringify(ee);else if(Ft.isArray(ee)&&t4(ee)||(Ft.isFileList(ee)||Ft.endsWith(ie,"[]"))&&(ye=Ft.toArray(ee)))return ie=$P(ie),ye.forEach(function(se,he){!(Ft.isUndefined(se)||se===null)&&t.append(g===!0?KM([ie],he,d):g===null?ie:ie+"[]",C(se))}),!1}return Lw(ee)?!0:(t.append(KM(de,ie,d),C(ee)),!1)}const U=[],$=Object.assign(i4,{defaultVisitor:O,convertValue:C,isVisitable:Lw});function q(ee,ie){if(!Ft.isUndefined(ee)){if(U.indexOf(ee)!==-1)throw Error("Circular reference detected in "+ie.join("."));U.push(ee),Ft.forEach(ee,function(ye,be){(!(Ft.isUndefined(ye)||ye===null)&&h.call(t,ye,Ft.isString(be)?be.trim():be,ie,$))===!0&&q(ye,ie?ie.concat(be):[be])}),U.pop()}}if(!Ft.isObject(e))throw new TypeError("data must be an object");return q(e),t}function JM(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(l){return t[l]})}function FT(e,t){this._pairs=[],e&&Hv(e,this,t)}const WP=FT.prototype;WP.append=function(t,n){this._pairs.push([t,n])};WP.toString=function(t){const n=t?function(l){return t.call(this,l,JM)}:JM;return this._pairs.map(function(h){return n(h[0])+"="+n(h[1])},"").join("&")};function n4(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function GP(e,t,n){if(!t)return e;const l=n&&n.encode||n4;Ft.isFunction(n)&&(n={serialize:n});const h=n&&n.serialize;let d;if(h?d=h(t,n):d=Ft.isURLSearchParams(t)?t.toString():new FT(t,n).toString(l),d){const g=e.indexOf("#");g!==-1&&(e=e.slice(0,g)),e+=(e.indexOf("?")===-1?"?":"&")+d}return e}class QM{constructor(){this.handlers=[]}use(t,n,l){return this.handlers.push({fulfilled:t,rejected:n,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ft.forEach(this.handlers,function(l){l!==null&&t(l)})}}const HP={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},s4=typeof URLSearchParams<"u"?URLSearchParams:FT,r4=typeof FormData<"u"?FormData:null,o4=typeof Blob<"u"?Blob:null,a4={isBrowser:!0,classes:{URLSearchParams:s4,FormData:r4,Blob:o4},protocols:["http","https","file","blob","url","data"]},NT=typeof window<"u"&&typeof document<"u",Dw=typeof navigator=="object"&&navigator||void 0,l4=NT&&(!Dw||["ReactNative","NativeScript","NS"].indexOf(Dw.product)<0),c4=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",h4=NT&&window.location.href||"http://localhost",u4=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:NT,hasStandardBrowserEnv:l4,hasStandardBrowserWebWorkerEnv:c4,navigator:Dw,origin:h4},Symbol.toStringTag,{value:"Module"})),ko={...u4,...a4};function d4(e,t){return Hv(e,new ko.classes.URLSearchParams,Object.assign({visitor:function(n,l,h,d){return ko.isNode&&Ft.isBuffer(n)?(this.append(l,n.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)}},t))}function f4(e){return Ft.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function p4(e){const t={},n=Object.keys(e);let l;const h=n.length;let d;for(l=0;l<h;l++)d=n[l],t[d]=e[d];return t}function qP(e){function t(n,l,h,d){let g=n[d++];if(g==="__proto__")return!0;const b=Number.isFinite(+g),r=d>=n.length;return g=!g&&Ft.isArray(h)?h.length:g,r?(Ft.hasOwnProp(h,g)?h[g]=[h[g],l]:h[g]=l,!b):((!h[g]||!Ft.isObject(h[g]))&&(h[g]=[]),t(n,l,h[g],d)&&Ft.isArray(h[g])&&(h[g]=p4(h[g])),!b)}if(Ft.isFormData(e)&&Ft.isFunction(e.entries)){const n={};return Ft.forEachEntry(e,(l,h)=>{t(f4(l),h,n,0)}),n}return null}function m4(e,t,n){if(Ft.isString(e))try{return(t||JSON.parse)(e),Ft.trim(e)}catch(l){if(l.name!=="SyntaxError")throw l}return(n||JSON.stringify)(e)}const $y={transitional:HP,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const l=n.getContentType()||"",h=l.indexOf("application/json")>-1,d=Ft.isObject(t);if(d&&Ft.isHTMLForm(t)&&(t=new FormData(t)),Ft.isFormData(t))return h?JSON.stringify(qP(t)):t;if(Ft.isArrayBuffer(t)||Ft.isBuffer(t)||Ft.isStream(t)||Ft.isFile(t)||Ft.isBlob(t)||Ft.isReadableStream(t))return t;if(Ft.isArrayBufferView(t))return t.buffer;if(Ft.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let b;if(d){if(l.indexOf("application/x-www-form-urlencoded")>-1)return d4(t,this.formSerializer).toString();if((b=Ft.isFileList(t))||l.indexOf("multipart/form-data")>-1){const r=this.env&&this.env.FormData;return Hv(b?{"files[]":t}:t,r&&new r,this.formSerializer)}}return d||h?(n.setContentType("application/json",!1),m4(t)):t}],transformResponse:[function(t){const n=this.transitional||$y.transitional,l=n&&n.forcedJSONParsing,h=this.responseType==="json";if(Ft.isResponse(t)||Ft.isReadableStream(t))return t;if(t&&Ft.isString(t)&&(l&&!this.responseType||h)){const g=!(n&&n.silentJSONParsing)&&h;try{return JSON.parse(t)}catch(b){if(g)throw b.name==="SyntaxError"?bn.from(b,bn.ERR_BAD_RESPONSE,this,null,this.response):b}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ko.classes.FormData,Blob:ko.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ft.forEach(["delete","get","head","post","put","patch"],e=>{$y.headers[e]={}});const g4=Ft.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_4=e=>{const t={};let n,l,h;return e&&e.split(`
`).forEach(function(g){h=g.indexOf(":"),n=g.substring(0,h).trim().toLowerCase(),l=g.substring(h+1).trim(),!(!n||t[n]&&g4[n])&&(n==="set-cookie"?t[n]?t[n].push(l):t[n]=[l]:t[n]=t[n]?t[n]+", "+l:l)}),t},eC=Symbol("internals");function z_(e){return e&&String(e).trim().toLowerCase()}function D0(e){return e===!1||e==null?e:Ft.isArray(e)?e.map(D0):String(e)}function y4(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=n.exec(e);)t[l[1]]=l[2];return t}const x4=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function P1(e,t,n,l,h){if(Ft.isFunction(l))return l.call(this,t,n);if(h&&(t=n),!!Ft.isString(t)){if(Ft.isString(l))return t.indexOf(l)!==-1;if(Ft.isRegExp(l))return l.test(t)}}function v4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,l)=>n.toUpperCase()+l)}function b4(e,t){const n=Ft.toCamelCase(" "+t);["get","set","has"].forEach(l=>{Object.defineProperty(e,l+n,{value:function(h,d,g){return this[l].call(this,t,h,d,g)},configurable:!0})})}let Aa=class{constructor(t){t&&this.set(t)}set(t,n,l){const h=this;function d(b,r,C){const O=z_(r);if(!O)throw new Error("header name must be a non-empty string");const U=Ft.findKey(h,O);(!U||h[U]===void 0||C===!0||C===void 0&&h[U]!==!1)&&(h[U||r]=D0(b))}const g=(b,r)=>Ft.forEach(b,(C,O)=>d(C,O,r));if(Ft.isPlainObject(t)||t instanceof this.constructor)g(t,n);else if(Ft.isString(t)&&(t=t.trim())&&!x4(t))g(_4(t),n);else if(Ft.isHeaders(t))for(const[b,r]of t.entries())d(r,b,l);else t!=null&&d(n,t,l);return this}get(t,n){if(t=z_(t),t){const l=Ft.findKey(this,t);if(l){const h=this[l];if(!n)return h;if(n===!0)return y4(h);if(Ft.isFunction(n))return n.call(this,h,l);if(Ft.isRegExp(n))return n.exec(h);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=z_(t),t){const l=Ft.findKey(this,t);return!!(l&&this[l]!==void 0&&(!n||P1(this,this[l],l,n)))}return!1}delete(t,n){const l=this;let h=!1;function d(g){if(g=z_(g),g){const b=Ft.findKey(l,g);b&&(!n||P1(l,l[b],b,n))&&(delete l[b],h=!0)}}return Ft.isArray(t)?t.forEach(d):d(t),h}clear(t){const n=Object.keys(this);let l=n.length,h=!1;for(;l--;){const d=n[l];(!t||P1(this,this[d],d,t,!0))&&(delete this[d],h=!0)}return h}normalize(t){const n=this,l={};return Ft.forEach(this,(h,d)=>{const g=Ft.findKey(l,d);if(g){n[g]=D0(h),delete n[d];return}const b=t?v4(d):String(d).trim();b!==d&&delete n[d],n[b]=D0(h),l[b]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Ft.forEach(this,(l,h)=>{l!=null&&l!==!1&&(n[h]=t&&Ft.isArray(l)?l.join(", "):l)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const l=new this(t);return n.forEach(h=>l.set(h)),l}static accessor(t){const l=(this[eC]=this[eC]={accessors:{}}).accessors,h=this.prototype;function d(g){const b=z_(g);l[b]||(b4(h,g),l[b]=!0)}return Ft.isArray(t)?t.forEach(d):d(t),this}};Aa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ft.reduceDescriptors(Aa.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(l){this[n]=l}}});Ft.freezeMethods(Aa);function L1(e,t){const n=this||$y,l=t||n,h=Aa.from(l.headers);let d=l.data;return Ft.forEach(e,function(b){d=b.call(n,d,h.normalize(),t?t.status:void 0)}),h.normalize(),d}function XP(e){return!!(e&&e.__CANCEL__)}function Cg(e,t,n){bn.call(this,e??"canceled",bn.ERR_CANCELED,t,n),this.name="CanceledError"}Ft.inherits(Cg,bn,{__CANCEL__:!0});function ZP(e,t,n){const l=n.config.validateStatus;!n.status||!l||l(n.status)?e(n):t(new bn("Request failed with status code "+n.status,[bn.ERR_BAD_REQUEST,bn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function w4(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function T4(e,t){e=e||10;const n=new Array(e),l=new Array(e);let h=0,d=0,g;return t=t!==void 0?t:1e3,function(r){const C=Date.now(),O=l[d];g||(g=C),n[h]=r,l[h]=C;let U=d,$=0;for(;U!==h;)$+=n[U++],U=U%e;if(h=(h+1)%e,h===d&&(d=(d+1)%e),C-g<t)return;const q=O&&C-O;return q?Math.round($*1e3/q):void 0}}function E4(e,t){let n=0,l=1e3/t,h,d;const g=(C,O=Date.now())=>{n=O,h=null,d&&(clearTimeout(d),d=null),e.apply(null,C)};return[(...C)=>{const O=Date.now(),U=O-n;U>=l?g(C,O):(h=C,d||(d=setTimeout(()=>{d=null,g(h)},l-U)))},()=>h&&g(h)]}const rv=(e,t,n=3)=>{let l=0;const h=T4(50,250);return E4(d=>{const g=d.loaded,b=d.lengthComputable?d.total:void 0,r=g-l,C=h(r),O=g<=b;l=g;const U={loaded:g,total:b,progress:b?g/b:void 0,bytes:r,rate:C||void 0,estimated:C&&b&&O?(b-g)/C:void 0,event:d,lengthComputable:b!=null,[t?"download":"upload"]:!0};e(U)},n)},tC=(e,t)=>{const n=e!=null;return[l=>t[0]({lengthComputable:n,total:e,loaded:l}),t[1]]},iC=e=>(...t)=>Ft.asap(()=>e(...t)),S4=ko.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ko.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ko.origin),ko.navigator&&/(msie|trident)/i.test(ko.navigator.userAgent)):()=>!0,M4=ko.hasStandardBrowserEnv?{write(e,t,n,l,h,d){const g=[e+"="+encodeURIComponent(t)];Ft.isNumber(n)&&g.push("expires="+new Date(n).toGMTString()),Ft.isString(l)&&g.push("path="+l),Ft.isString(h)&&g.push("domain="+h),d===!0&&g.push("secure"),document.cookie=g.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function C4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function A4(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function YP(e,t,n){let l=!C4(t);return e&&(l||n==!1)?A4(e,t):t}const nC=e=>e instanceof Aa?{...e}:e;function kp(e,t){t=t||{};const n={};function l(C,O,U,$){return Ft.isPlainObject(C)&&Ft.isPlainObject(O)?Ft.merge.call({caseless:$},C,O):Ft.isPlainObject(O)?Ft.merge({},O):Ft.isArray(O)?O.slice():O}function h(C,O,U,$){if(Ft.isUndefined(O)){if(!Ft.isUndefined(C))return l(void 0,C,U,$)}else return l(C,O,U,$)}function d(C,O){if(!Ft.isUndefined(O))return l(void 0,O)}function g(C,O){if(Ft.isUndefined(O)){if(!Ft.isUndefined(C))return l(void 0,C)}else return l(void 0,O)}function b(C,O,U){if(U in t)return l(C,O);if(U in e)return l(void 0,C)}const r={url:d,method:d,data:d,baseURL:g,transformRequest:g,transformResponse:g,paramsSerializer:g,timeout:g,timeoutMessage:g,withCredentials:g,withXSRFToken:g,adapter:g,responseType:g,xsrfCookieName:g,xsrfHeaderName:g,onUploadProgress:g,onDownloadProgress:g,decompress:g,maxContentLength:g,maxBodyLength:g,beforeRedirect:g,transport:g,httpAgent:g,httpsAgent:g,cancelToken:g,socketPath:g,responseEncoding:g,validateStatus:b,headers:(C,O,U)=>h(nC(C),nC(O),U,!0)};return Ft.forEach(Object.keys(Object.assign({},e,t)),function(O){const U=r[O]||h,$=U(e[O],t[O],O);Ft.isUndefined($)&&U!==b||(n[O]=$)}),n}const KP=e=>{const t=kp({},e);let{data:n,withXSRFToken:l,xsrfHeaderName:h,xsrfCookieName:d,headers:g,auth:b}=t;t.headers=g=Aa.from(g),t.url=GP(YP(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),b&&g.set("Authorization","Basic "+btoa((b.username||"")+":"+(b.password?unescape(encodeURIComponent(b.password)):"")));let r;if(Ft.isFormData(n)){if(ko.hasStandardBrowserEnv||ko.hasStandardBrowserWebWorkerEnv)g.setContentType(void 0);else if((r=g.getContentType())!==!1){const[C,...O]=r?r.split(";").map(U=>U.trim()).filter(Boolean):[];g.setContentType([C||"multipart/form-data",...O].join("; "))}}if(ko.hasStandardBrowserEnv&&(l&&Ft.isFunction(l)&&(l=l(t)),l||l!==!1&&S4(t.url))){const C=h&&d&&M4.read(d);C&&g.set(h,C)}return t},k4=typeof XMLHttpRequest<"u",I4=k4&&function(e){return new Promise(function(n,l){const h=KP(e);let d=h.data;const g=Aa.from(h.headers).normalize();let{responseType:b,onUploadProgress:r,onDownloadProgress:C}=h,O,U,$,q,ee;function ie(){q&&q(),ee&&ee(),h.cancelToken&&h.cancelToken.unsubscribe(O),h.signal&&h.signal.removeEventListener("abort",O)}let de=new XMLHttpRequest;de.open(h.method.toUpperCase(),h.url,!0),de.timeout=h.timeout;function ye(){if(!de)return;const se=Aa.from("getAllResponseHeaders"in de&&de.getAllResponseHeaders()),fe={data:!b||b==="text"||b==="json"?de.responseText:de.response,status:de.status,statusText:de.statusText,headers:se,config:e,request:de};ZP(function(ze){n(ze),ie()},function(ze){l(ze),ie()},fe),de=null}"onloadend"in de?de.onloadend=ye:de.onreadystatechange=function(){!de||de.readyState!==4||de.status===0&&!(de.responseURL&&de.responseURL.indexOf("file:")===0)||setTimeout(ye)},de.onabort=function(){de&&(l(new bn("Request aborted",bn.ECONNABORTED,e,de)),de=null)},de.onerror=function(){l(new bn("Network Error",bn.ERR_NETWORK,e,de)),de=null},de.ontimeout=function(){let he=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded";const fe=h.transitional||HP;h.timeoutErrorMessage&&(he=h.timeoutErrorMessage),l(new bn(he,fe.clarifyTimeoutError?bn.ETIMEDOUT:bn.ECONNABORTED,e,de)),de=null},d===void 0&&g.setContentType(null),"setRequestHeader"in de&&Ft.forEach(g.toJSON(),function(he,fe){de.setRequestHeader(fe,he)}),Ft.isUndefined(h.withCredentials)||(de.withCredentials=!!h.withCredentials),b&&b!=="json"&&(de.responseType=h.responseType),C&&([$,ee]=rv(C,!0),de.addEventListener("progress",$)),r&&de.upload&&([U,q]=rv(r),de.upload.addEventListener("progress",U),de.upload.addEventListener("loadend",q)),(h.cancelToken||h.signal)&&(O=se=>{de&&(l(!se||se.type?new Cg(null,e,de):se),de.abort(),de=null)},h.cancelToken&&h.cancelToken.subscribe(O),h.signal&&(h.signal.aborted?O():h.signal.addEventListener("abort",O)));const be=w4(h.url);if(be&&ko.protocols.indexOf(be)===-1){l(new bn("Unsupported protocol "+be+":",bn.ERR_BAD_REQUEST,e));return}de.send(d||null)})},P4=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let l=new AbortController,h;const d=function(C){if(!h){h=!0,b();const O=C instanceof Error?C:this.reason;l.abort(O instanceof bn?O:new Cg(O instanceof Error?O.message:O))}};let g=t&&setTimeout(()=>{g=null,d(new bn(`timeout ${t} of ms exceeded`,bn.ETIMEDOUT))},t);const b=()=>{e&&(g&&clearTimeout(g),g=null,e.forEach(C=>{C.unsubscribe?C.unsubscribe(d):C.removeEventListener("abort",d)}),e=null)};e.forEach(C=>C.addEventListener("abort",d));const{signal:r}=l;return r.unsubscribe=()=>Ft.asap(b),r}},L4=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let l=0,h;for(;l<n;)h=l+t,yield e.slice(l,h),l=h},D4=async function*(e,t){for await(const n of O4(e))yield*L4(n,t)},O4=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:l}=await t.read();if(n)break;yield l}}finally{await t.cancel()}},sC=(e,t,n,l)=>{const h=D4(e,t);let d=0,g,b=r=>{g||(g=!0,l&&l(r))};return new ReadableStream({async pull(r){try{const{done:C,value:O}=await h.next();if(C){b(),r.close();return}let U=O.byteLength;if(n){let $=d+=U;n($)}r.enqueue(new Uint8Array(O))}catch(C){throw b(C),C}},cancel(r){return b(r),h.return()}},{highWaterMark:2})},qv=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",JP=qv&&typeof ReadableStream=="function",R4=qv&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),QP=(e,...t)=>{try{return!!e(...t)}catch{return!1}},z4=JP&&QP(()=>{let e=!1;const t=new Request(ko.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),rC=64*1024,Ow=JP&&QP(()=>Ft.isReadableStream(new Response("").body)),ov={stream:Ow&&(e=>e.body)};qv&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!ov[t]&&(ov[t]=Ft.isFunction(e[t])?n=>n[t]():(n,l)=>{throw new bn(`Response type '${t}' is not supported`,bn.ERR_NOT_SUPPORT,l)})})})(new Response);const B4=async e=>{if(e==null)return 0;if(Ft.isBlob(e))return e.size;if(Ft.isSpecCompliantForm(e))return(await new Request(ko.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ft.isArrayBufferView(e)||Ft.isArrayBuffer(e))return e.byteLength;if(Ft.isURLSearchParams(e)&&(e=e+""),Ft.isString(e))return(await R4(e)).byteLength},F4=async(e,t)=>{const n=Ft.toFiniteNumber(e.getContentLength());return n??B4(t)},N4=qv&&(async e=>{let{url:t,method:n,data:l,signal:h,cancelToken:d,timeout:g,onDownloadProgress:b,onUploadProgress:r,responseType:C,headers:O,withCredentials:U="same-origin",fetchOptions:$}=KP(e);C=C?(C+"").toLowerCase():"text";let q=P4([h,d&&d.toAbortSignal()],g),ee;const ie=q&&q.unsubscribe&&(()=>{q.unsubscribe()});let de;try{if(r&&z4&&n!=="get"&&n!=="head"&&(de=await F4(O,l))!==0){let fe=new Request(t,{method:"POST",body:l,duplex:"half"}),Me;if(Ft.isFormData(l)&&(Me=fe.headers.get("content-type"))&&O.setContentType(Me),fe.body){const[ze,ve]=tC(de,rv(iC(r)));l=sC(fe.body,rC,ze,ve)}}Ft.isString(U)||(U=U?"include":"omit");const ye="credentials"in Request.prototype;ee=new Request(t,{...$,signal:q,method:n.toUpperCase(),headers:O.normalize().toJSON(),body:l,duplex:"half",credentials:ye?U:void 0});let be=await fetch(ee);const se=Ow&&(C==="stream"||C==="response");if(Ow&&(b||se&&ie)){const fe={};["status","statusText","headers"].forEach(Ue=>{fe[Ue]=be[Ue]});const Me=Ft.toFiniteNumber(be.headers.get("content-length")),[ze,ve]=b&&tC(Me,rv(iC(b),!0))||[];be=new Response(sC(be.body,rC,ze,()=>{ve&&ve(),ie&&ie()}),fe)}C=C||"text";let he=await ov[Ft.findKey(ov,C)||"text"](be,e);return!se&&ie&&ie(),await new Promise((fe,Me)=>{ZP(fe,Me,{data:he,headers:Aa.from(be.headers),status:be.status,statusText:be.statusText,config:e,request:ee})})}catch(ye){throw ie&&ie(),ye&&ye.name==="TypeError"&&/fetch/i.test(ye.message)?Object.assign(new bn("Network Error",bn.ERR_NETWORK,e,ee),{cause:ye.cause||ye}):bn.from(ye,ye&&ye.code,e,ee)}}),Rw={http:e4,xhr:I4,fetch:N4};Ft.forEach(Rw,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const oC=e=>`- ${e}`,U4=e=>Ft.isFunction(e)||e===null||e===!1,eL={getAdapter:e=>{e=Ft.isArray(e)?e:[e];const{length:t}=e;let n,l;const h={};for(let d=0;d<t;d++){n=e[d];let g;if(l=n,!U4(n)&&(l=Rw[(g=String(n)).toLowerCase()],l===void 0))throw new bn(`Unknown adapter '${g}'`);if(l)break;h[g||"#"+d]=l}if(!l){const d=Object.entries(h).map(([b,r])=>`adapter ${b} `+(r===!1?"is not supported by the environment":"is not available in the build"));let g=t?d.length>1?`since :
`+d.map(oC).join(`
`):" "+oC(d[0]):"as no adapter specified";throw new bn("There is no suitable adapter to dispatch the request "+g,"ERR_NOT_SUPPORT")}return l},adapters:Rw};function D1(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Cg(null,e)}function aC(e){return D1(e),e.headers=Aa.from(e.headers),e.data=L1.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),eL.getAdapter(e.adapter||$y.adapter)(e).then(function(l){return D1(e),l.data=L1.call(e,e.transformResponse,l),l.headers=Aa.from(l.headers),l},function(l){return XP(l)||(D1(e),l&&l.response&&(l.response.data=L1.call(e,e.transformResponse,l.response),l.response.headers=Aa.from(l.response.headers))),Promise.reject(l)})}const tL="1.8.4",Xv={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Xv[e]=function(l){return typeof l===e||"a"+(t<1?"n ":" ")+e}});const lC={};Xv.transitional=function(t,n,l){function h(d,g){return"[Axios v"+tL+"] Transitional option '"+d+"'"+g+(l?". "+l:"")}return(d,g,b)=>{if(t===!1)throw new bn(h(g," has been removed"+(n?" in "+n:"")),bn.ERR_DEPRECATED);return n&&!lC[g]&&(lC[g]=!0,console.warn(h(g," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(d,g,b):!0}};Xv.spelling=function(t){return(n,l)=>(console.warn(`${l} is likely a misspelling of ${t}`),!0)};function V4(e,t,n){if(typeof e!="object")throw new bn("options must be an object",bn.ERR_BAD_OPTION_VALUE);const l=Object.keys(e);let h=l.length;for(;h-- >0;){const d=l[h],g=t[d];if(g){const b=e[d],r=b===void 0||g(b,d,e);if(r!==!0)throw new bn("option "+d+" must be "+r,bn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new bn("Unknown option "+d,bn.ERR_BAD_OPTION)}}const O0={assertOptions:V4,validators:Xv},Kc=O0.validators;let Ep=class{constructor(t){this.defaults=t,this.interceptors={request:new QM,response:new QM}}async request(t,n){try{return await this._request(t,n)}catch(l){if(l instanceof Error){let h={};Error.captureStackTrace?Error.captureStackTrace(h):h=new Error;const d=h.stack?h.stack.replace(/^.+\n/,""):"";try{l.stack?d&&!String(l.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+d):l.stack=d}catch{}}throw l}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=kp(this.defaults,n);const{transitional:l,paramsSerializer:h,headers:d}=n;l!==void 0&&O0.assertOptions(l,{silentJSONParsing:Kc.transitional(Kc.boolean),forcedJSONParsing:Kc.transitional(Kc.boolean),clarifyTimeoutError:Kc.transitional(Kc.boolean)},!1),h!=null&&(Ft.isFunction(h)?n.paramsSerializer={serialize:h}:O0.assertOptions(h,{encode:Kc.function,serialize:Kc.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),O0.assertOptions(n,{baseUrl:Kc.spelling("baseURL"),withXsrfToken:Kc.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let g=d&&Ft.merge(d.common,d[n.method]);d&&Ft.forEach(["delete","get","head","post","put","patch","common"],ee=>{delete d[ee]}),n.headers=Aa.concat(g,d);const b=[];let r=!0;this.interceptors.request.forEach(function(ie){typeof ie.runWhen=="function"&&ie.runWhen(n)===!1||(r=r&&ie.synchronous,b.unshift(ie.fulfilled,ie.rejected))});const C=[];this.interceptors.response.forEach(function(ie){C.push(ie.fulfilled,ie.rejected)});let O,U=0,$;if(!r){const ee=[aC.bind(this),void 0];for(ee.unshift.apply(ee,b),ee.push.apply(ee,C),$=ee.length,O=Promise.resolve(n);U<$;)O=O.then(ee[U++],ee[U++]);return O}$=b.length;let q=n;for(U=0;U<$;){const ee=b[U++],ie=b[U++];try{q=ee(q)}catch(de){ie.call(this,de);break}}try{O=aC.call(this,q)}catch(ee){return Promise.reject(ee)}for(U=0,$=C.length;U<$;)O=O.then(C[U++],C[U++]);return O}getUri(t){t=kp(this.defaults,t);const n=YP(t.baseURL,t.url,t.allowAbsoluteUrls);return GP(n,t.params,t.paramsSerializer)}};Ft.forEach(["delete","get","head","options"],function(t){Ep.prototype[t]=function(n,l){return this.request(kp(l||{},{method:t,url:n,data:(l||{}).data}))}});Ft.forEach(["post","put","patch"],function(t){function n(l){return function(d,g,b){return this.request(kp(b||{},{method:t,headers:l?{"Content-Type":"multipart/form-data"}:{},url:d,data:g}))}}Ep.prototype[t]=n(),Ep.prototype[t+"Form"]=n(!0)});let j4=class iL{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(d){n=d});const l=this;this.promise.then(h=>{if(!l._listeners)return;let d=l._listeners.length;for(;d-- >0;)l._listeners[d](h);l._listeners=null}),this.promise.then=h=>{let d;const g=new Promise(b=>{l.subscribe(b),d=b}).then(h);return g.cancel=function(){l.unsubscribe(d)},g},t(function(d,g,b){l.reason||(l.reason=new Cg(d,g,b),n(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=l=>{t.abort(l)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new iL(function(h){t=h}),cancel:t}}};function $4(e){return function(n){return e.apply(null,n)}}function W4(e){return Ft.isObject(e)&&e.isAxiosError===!0}const zw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zw).forEach(([e,t])=>{zw[t]=e});function nL(e){const t=new Ep(e),n=OP(Ep.prototype.request,t);return Ft.extend(n,Ep.prototype,t,{allOwnKeys:!0}),Ft.extend(n,t,null,{allOwnKeys:!0}),n.create=function(h){return nL(kp(e,h))},n}const bs=nL($y);bs.Axios=Ep;bs.CanceledError=Cg;bs.CancelToken=j4;bs.isCancel=XP;bs.VERSION=tL;bs.toFormData=Hv;bs.AxiosError=bn;bs.Cancel=bs.CanceledError;bs.all=function(t){return Promise.all(t)};bs.spread=$4;bs.isAxiosError=W4;bs.mergeConfig=kp;bs.AxiosHeaders=Aa;bs.formToJSON=e=>qP(Ft.isHTMLForm(e)?new FormData(e):e);bs.getAdapter=eL.getAdapter;bs.HttpStatusCode=zw;bs.default=bs;const{Axios:gX,AxiosError:_X,CanceledError:yX,isCancel:xX,CancelToken:vX,VERSION:bX,all:wX,Cancel:TX,isAxiosError:EX,spread:SX,toFormData:MX,AxiosHeaders:CX,HttpStatusCode:AX,formToJSON:kX,getAdapter:IX,mergeConfig:PX}=bs,Wy=zT("user",{state:()=>({token:localStorage.getItem("token"),role:localStorage.getItem("role"),email:localStorage.getItem("email")}),actions:{setToken(e,t,n){this.token=e,this.role=t,this.email=n,localStorage.setItem("token",e),localStorage.setItem("role",t),localStorage.setItem("email",n),bs.defaults.headers.common.Authorization=`Bearer ${e}`},async login(e,t){try{const n=await bs.post("http://127.0.0.1:8000/api/v1/auth/login",{email:e,password:t});return this.setToken(n.data.access_token,n.data.role,n.data.email),!0}catch(n){return console.error("Login failed:",n),!1}},logout(){this.token=null,this.role=null,this.email=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("email"),delete bs.defaults.headers.common.Authorization}}}),G4={class:"app-shell"},H4={class:"app-header",role:"banner"},q4={class:"header-grid"},X4={class:"right-col"},Z4={class:"meta"},Y4=["title"],K4={class:"primary-nav","aria-label":"Primary"},J4={class:"page"},Q4={key:0,class:"app-footer"},eU=gs({__name:"AppLayout",setup(e){const{locale:t}=Rp(),n=Wy(),l=YI(),h=KI(),d=Fn({get:()=>t.value,set:q=>t.value=q}),g=()=>{localStorage.setItem("lang",d.value),document.documentElement.setAttribute("lang",d.value)};nl(()=>{const q=localStorage.getItem("lang");q&&(d.value=q),g()});const b=Fn(()=>!!n.token),r=Fn(()=>n.role==="admin"),C=Fn(()=>n.email||""),O=()=>{n.logout(),l.push("/login")},U=Fn(()=>{var q;return((q=h.meta)==null?void 0:q.hideFooter)===!0}),$=Fn(()=>b.value?["admin","partner","analyst"].includes(n.role||""):!1);return(q,ee)=>{const ie=rh("router-link"),de=rh("router-view");return ui(),Ei("div",G4,[tt("header",H4,[tt("div",q4,[gn(ie,{to:"/",class:"brand","aria-label":"Home"},{default:Kr(()=>ee[1]||(ee[1]=[tt("div",{class:"brand-logos"},[tt("img",{src:ET,alt:"Ministry of Foreign Affairs of the Netherlands",class:"logo-dgis"}),tt("img",{src:BI,alt:"Soil Values",class:"logo-sv"})],-1),tt("h1",{class:"brand-title"},"Soil Values Geoportal",-1)])),_:1}),tt("div",X4,[tt("div",Z4,[ee[5]||(ee[5]=tt("label",{class:"sr-only",for:"lang"},"Language",-1)),Mo(tt("select",{id:"lang","onUpdate:modelValue":ee[0]||(ee[0]=ye=>d.value=ye),onChange:g,class:"lang"},ee[2]||(ee[2]=[tt("option",{value:"en"},"EN",-1),tt("option",{value:"fr"},"FR",-1),tt("option",{value:"nl"},"NL",-1)]),544),[[kd,d.value]]),b.value?(ui(),Ei(Dn,{key:0},[tt("span",{class:"email",title:C.value},Ht(C.value),9,Y4),r.value?(ui(),Qr(ie,{key:0,to:"/admin-panel",class:"btn btn-ghost"},{default:Kr(()=>ee[3]||(ee[3]=[fr("Admin")])),_:1})):xs("",!0),tt("button",{class:"btn",onClick:O},"Logout")],64)):(ui(),Qr(ie,{key:1,to:"/login",class:"btn"},{default:Kr(()=>ee[4]||(ee[4]=[fr("Login")])),_:1}))]),tt("nav",K4,[gn(ie,{class:"primary-nav__link",to:"/"},{default:Kr(()=>ee[6]||(ee[6]=[fr("Home")])),_:1}),gn(ie,{class:"primary-nav__link",to:"/map"},{default:Kr(()=>ee[7]||(ee[7]=[fr("Map")])),_:1}),$.value?(ui(),Qr(ie,{key:0,class:"primary-nav__link",to:"/me-dashboard"},{default:Kr(()=>ee[8]||(ee[8]=[fr("MEL")])),_:1})):xs("",!0),gn(ie,{class:"primary-nav__link",to:"/catalog"},{default:Kr(()=>ee[9]||(ee[9]=[fr("Catalog")])),_:1}),gn(ie,{class:"primary-nav__link",to:"/about"},{default:Kr(()=>ee[10]||(ee[10]=[fr("About")])),_:1})])])])]),tt("main",J4,[gn(de)]),U.value?xs("",!0):(ui(),Ei("footer",Q4,ee[11]||(ee[11]=[tt("div",{class:"app-footer__inner"}," 2025 Soil Values Geoportal. All rights reserved.",-1)])))])}}}),ka=(e,t)=>{const n=e.__vccOpts||e;for(const[l,h]of t)n[l]=h;return n},tU=ka(eU,[["__scopeId","data-v-11a8608d"]]),iU=gs({__name:"App",setup(e){return(t,n)=>{const l=rh("router-view");return ui(),Qr(tU,null,{default:Kr(()=>[gn(l)]),_:1})}}}),sL="/projects/soil_values/assets/ifdc_logo-C0Phf9Dr.png",rL="/projects/soil_values/assets/WUR_logo-Ds7IIsIR.png",oL="/projects/soil_values/assets/SNV_logo_2-LRpPKBkz.png",aL="/projects/soil_values/assets/AGRA_logo-BuD40XdR.webp",lL="/projects/soil_values/assets/IITA_logo-DW09z6CA.png",cL="/projects/soil_values/assets/IWMI_logo-B-LuUFd5.jpg",hL="/projects/soil_values/assets/ISRIC_logo-Cx1mKsJo.webp",uL="/projects/soil_values/assets/CIFOR-ICRAF-logo-CA2wt9fE.webp",nU={class:"home-root"},sU={class:"landing-content"},rU={class:"fade-slide"},oU={class:"landing-text fade-slide",style:{"animation-delay":".3s"}},aU=gs({__name:"HomeView",setup(e){return(t,n)=>{const l=rh("router-link");return ui(),Ei("main",nU,[n[2]||(n[2]=tt("div",{class:"bg-cover"},null,-1)),tt("section",sU,[n[0]||(n[0]=K0('<div class="top-logos fade-slide" data-v-acb3c24e><a href="https://www.government.nl/ministries/ministry-of-foreign-affairs" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+ET+'" alt="DGIS Logo" class="logo donor-logo" loading="lazy" data-v-acb3c24e></a><a href="https://ifdc.org/soil-values" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+BI+'" alt="Soil Values Logo" class="logo main-logo" loading="lazy" data-v-acb3c24e></a></div>',1)),tt("h1",rU,Ht(t.$t("home.title")),1),tt("div",oU,[tt("p",null,Ht(t.$t("home.intro1")),1),tt("p",null,Ht(t.$t("home.intro2")),1)]),n[1]||(n[1]=K0('<div class="logos-grid" data-v-acb3c24e><div class="logo-row fade-slide" style="animation-delay:.6s;" data-v-acb3c24e><a href="https://ifdc.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+sL+'" alt="IFDC" loading="lazy" data-v-acb3c24e></a><a href="https://wur.nl" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+rL+'" alt="WUR" loading="lazy" data-v-acb3c24e></a><a href="https://snv.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+oL+'" alt="SNV" loading="lazy" data-v-acb3c24e></a></div><div class="logo-row fade-slide" style="animation-delay:.9s;" data-v-acb3c24e><a href="https://agra.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+aL+'" alt="AGRA" loading="lazy" data-v-acb3c24e></a><a href="https://www.iita.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+lL+'" alt="IITA" loading="lazy" data-v-acb3c24e></a><a href="https://www.iwmi.cgiar.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+cL+'" alt="IWMI" class="logo-iwmi" loading="lazy" data-v-acb3c24e></a><a href="https://www.isric.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+hL+'" alt="ISRIC" loading="lazy" data-v-acb3c24e></a><a href="https://www.cifor-icraf.org" target="_blank" rel="noopener" data-v-acb3c24e><img src="'+uL+'" alt="CIFOR-ICRAF" loading="lazy" data-v-acb3c24e></a></div></div>',1)),gn(l,{to:"/dashboard",class:"launch-btn fade-slide",style:{"animation-delay":"1.2s"}},{default:Kr(()=>[fr(Ht(t.$t("home.launch")),1)]),_:1})])])}}}),lU=ka(aU,[["__scopeId","data-v-acb3c24e"]]);var dL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function cU(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function l(){return this instanceof l?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(l){var h=Object.getOwnPropertyDescriptor(e,l);Object.defineProperty(n,l,h.get?h:{enumerable:!0,get:function(){return e[l]}})}),n}var pL={exports:{}};(function(e,t){var n={};(function(l,h){e.exports=h()})(dL,function(){var l,h,d;function g(r,C){if(!l)l=C;else if(!h)h=C;else{var O="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",U={};l(U),d=C(U),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}}g(["exports"],function(r){var C=typeof self<"u"?self:{},O="2.15.0";let U;const $={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(U==null){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{U=n.API_URL_REGEX!=null?new RegExp(n.API_URL_REGEX):s}catch{U=s}}return U},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!$.API_URL)return null;try{const s=new URL($.API_URL);return s.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":s.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},q={supported:!1,testSupport:function(s){!de&&ie&&(ye?be(s):ee=s)}};let ee,ie,de=!1,ye=!1;function be(s){const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,ie),s.isContextLost())return;q.supported=!0}catch{}s.deleteTexture(i),de=!0}C.document&&(ie=C.document.createElement("img"),ie.onload=function(){ee&&be(ee),ee=null,ye=!0},ie.onerror=function(){de=!0,ee=null},ie.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const se="01";function he(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var fe=Me;function Me(s,i,o,u){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=i,this.p2x=o,this.p2y=u}Me.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,i){if(i===void 0&&(i=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,u=0;u<8;u++){var p=this.sampleCurveX(o)-s;if(Math.abs(p)<i)return o;var x=this.sampleCurveDerivativeX(o);if(Math.abs(x)<1e-6)break;o-=p/x}var w=0,M=1;for(o=s,u=0;u<20&&(p=this.sampleCurveX(o),!(Math.abs(p-s)<i));u++)s>p?w=o:M=o,o=.5*(M-w)+w;return o},solve:function(s,i){return this.sampleCurveY(this.solveCurveX(s,i))}};var ze=he(fe),ve=Ue;function Ue(s,i){this.x=s,this.y=i}Ue.prototype={clone:function(){return new Ue(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,i){return this.clone()._rotateAround(s,i)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var i=s.x-this.x,o=s.y-this.y;return i*i+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult:function(s){var i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var i=Math.cos(s),o=Math.sin(s),u=o*this.x+i*this.y;return this.x=i*this.x-o*this.y,this.y=u,this},_rotateAround:function(s,i){var o=Math.cos(s),u=Math.sin(s),p=i.y+u*(this.x-i.x)+o*(this.y-i.y);return this.x=i.x+o*(this.x-i.x)-u*(this.y-i.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ue.convert=function(s){return s instanceof Ue?s:Array.isArray(s)?new Ue(s[0],s[1]):s};var Ne=he(ve);const it=Math.PI/180,Qe=180/Math.PI;function Xe(s){return s*it}function Tt(s){return s*Qe}const Rt=[[0,0],[1,0],[1,1],[0,1]];function St(s){if(s<=0)return 0;if(s>=1)return 1;const i=s*s,o=i*s;return 4*(s<.5?o:3*(s-i)+o-.75)}function Pt(s,i,o,u){const p=new ze(s,i,o,u);return function(x){return p.solve(x)}}const oi=Pt(.25,.1,.25,1);function ci(s,i,o){return Math.min(o,Math.max(i,s))}function pn(s,i,o){return(o=ci((o-s)/(i-s),0,1))*o*(3-2*o)}function Ni(s,i,o){const u=o-i,p=((s-i)%u+u)%u+i;return p===i?o:p}function ji(s,i,o){if(!s.length)return o(null,[]);let u=s.length;const p=new Array(s.length);let x=null;s.forEach((w,M)=>{i(w,(P,D)=>{P&&(x=P),p[M]=D,--u==0&&o(x,p)})})}function An(s){const i=[];for(const o in s)i.push(s[o]);return i}function Hi(s,...i){for(const o of i)for(const u in o)s[u]=o[u];return s}let Zn=1;function wn(){return Zn++}function nt(){return function s(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function Mt(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function xt(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function jt(s,i){s.forEach(o=>{i[o]&&(i[o]=i[o].bind(i))})}function ki(s,i){return s.indexOf(i,s.length-i.length)!==-1}function ai(s,i,o){const u={};for(const p in s)u[p]=i.call(this,s[p],p,s);return u}function Ee(s,i,o){const u={};for(const p in s)i.call(o||this,s[p],p,s)&&(u[p]=s[p]);return u}function Ce(s){return Array.isArray(s)?s.map(Ce):typeof s=="object"&&s?ai(s,Ce):s}const ct={};function Bt(s){ct[s]||(typeof console<"u"&&console.warn(s),ct[s]=!0)}function Dt(s,i,o){return(o.y-s.y)*(i.x-s.x)>(i.y-s.y)*(o.x-s.x)}function ei(s){let i=0;for(let o,u,p=0,x=s.length,w=x-1;p<x;w=p++)o=s[p],u=s[w],i+=(u.x-o.x)*(o.y+u.y);return i}function di(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ie(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,p,x)=>{const w=p||x;return i[u]=!w||w.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i}let Oe=null;function rt(s){if(Oe==null){const i=s.navigator?s.navigator.userAgent:null;Oe=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Oe}function Zt(s){try{const i=C[s];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function Yt(s,i){return[s[4*i],s[4*i+1],s[4*i+2],s[4*i+3]]}const ti="mapbox-tiles";let mt=500,zt=50,Ii,Oi;function Kn(){try{return C.caches}catch{}}function qn(){Kn()&&!Ii&&(Ii=C.caches.open(ti))}function _s(s){const i=s.indexOf("?");if(i<0)return s;const o=function(p){const x=p.indexOf("?");return x>0?p.slice(x+1).split("&"):[]}(s),u=o.filter(p=>{const x=p.split("=");return x[0]==="language"||x[0]==="worldview"});return u.length?`${s.slice(0,i)}?${u.join("&")}`:s.slice(0,i)}let un=1/0;const vr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(vr);class Oo extends Error{constructor(i,o,u){o===401&&ft(u)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=o,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const js=di()?()=>self.worker&&self.worker.referrer:()=>(C.location.protocol==="blob:"?C.parent:C).location.href,or=function(s,i){if(!(/^file:/.test(o=s.url)||/^file:/.test(js())&&!/^\w+:/.test(o))){if(C.fetch&&C.Request&&C.AbortController&&C.Request.prototype.hasOwnProperty("signal"))return function(u,p){const x=new C.AbortController,w=new C.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:js(),referrerPolicy:u.referrerPolicy,signal:x.signal});let M=!1,P=!1;const D=(V=w.url).indexOf("sku=")>0&&ft(V);var V;u.type==="json"&&w.headers.set("Accept","application/json");const G=(J,Q,ae)=>{if(P)return;if(J&&J.message!=="SecurityError"&&Bt(J.toString()),Q&&ae)return X(Q);const _e=Date.now();C.fetch(w).then(Pe=>{if(Pe.ok){const je=D?Pe.clone():null;return X(Pe,je,_e)}return p(new Oo(Pe.statusText,Pe.status,u.url))}).catch(Pe=>{Pe.name!=="AbortError"&&p(new Error(`${Pe.message} ${u.url}`))})},X=(J,Q,ae)=>{(u.type==="arrayBuffer"?J.arrayBuffer():u.type==="json"?J.json():J.text()).then(_e=>{P||(Q&&ae&&function(Pe,je,Le){if(qn(),!Ii)return;const Ve={status:je.status,statusText:je.statusText,headers:new C.Headers};je.headers.forEach((bt,gt)=>Ve.headers.set(gt,bt));const He=Ie(je.headers.get("Cache-Control")||"");if(He["no-store"])return;He["max-age"]&&Ve.headers.set("Expires",new Date(Le+1e3*He["max-age"]).toUTCString());const $e=Ve.headers.get("Expires");$e&&(new Date($e).getTime()-Le<42e4||function(bt,gt){if(Oi===void 0)try{new Response(new ReadableStream),Oi=!0}catch{Oi=!1}Oi?gt(bt.body):bt.blob().then(gt)}(je,bt=>{const gt=new C.Response(bt,Ve);qn(),Ii&&Ii.then(It=>It.put(_s(Pe.url),gt)).catch(It=>Bt(It.message))}))}(w,Q,ae),M=!0,p(null,_e,J.headers.get("Cache-Control"),J.headers.get("Expires")))}).catch(_e=>{P||p(new Error(_e.message))})};return D?function(J,Q){if(qn(),!Ii)return Q(null);const ae=_s(J.url);Ii.then(_e=>{_e.match(ae).then(Pe=>{const je=function(Le){if(!Le)return!1;const Ve=new Date(Le.headers.get("Expires")||0),He=Ie(Le.headers.get("Cache-Control")||"");return Ve>Date.now()&&!He["no-cache"]}(Pe);_e.delete(ae),je&&_e.put(ae,Pe.clone()),Q(null,Pe,je)}).catch(Q)}).catch(Q)}(w,G):G(null,null),{cancel:()=>{P=!0,M||x.abort()}}}(s,i);if(di()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,i,void 0,!0)}var o;return function(u,p){const x=new C.XMLHttpRequest;x.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const w in u.headers)x.setRequestHeader(w,u.headers[w]);return u.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=u.credentials==="include",x.onerror=()=>{p(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let w=x.response;if(u.type==="json")try{w=JSON.parse(x.response)}catch(M){return p(M)}p(null,w,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else p(new Oo(x.statusText,x.status,u.url))},x.send(u.body),{cancel:()=>x.abort()}}(s,i)},pr=function(s,i){return or(Hi(s,{type:"arrayBuffer"}),i)};function fc(s){const i=C.document.createElement("a");return i.href=s,i.protocol===C.document.location.protocol&&i.host===C.document.location.host}const Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ue,pe;ue=[],pe=0;const Be=function(s,i){if(q.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),pe>=$.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:s,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return ue.push(x),x}pe++;let o=!1;const u=()=>{if(!o)for(o=!0,pe--;ue.length&&pe<$.MAX_PARALLEL_IMAGE_REQUESTS;){const x=ue.shift(),{requestParameters:w,callback:M,cancelled:P}=x;P||(x.cancel=Be(w,M).cancel)}},p=pr(s,(x,w,M,P)=>{u(),x?i(x):w&&(C.createImageBitmap?function(D,V){const G=new C.Blob([new Uint8Array(D)],{type:"image/png"});C.createImageBitmap(G).then(X=>{V(null,X)}).catch(X=>{V(new Error(`Could not load image because of ${X.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(D,V)=>i(D,V,M,P)):function(D,V){const G=new C.Image,X=C.URL;G.onload=()=>{V(null,G),X.revokeObjectURL(G.src),G.onload=null,C.requestAnimationFrame(()=>{G.src=Fe})},G.onerror=()=>V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const J=new C.Blob([new Uint8Array(D)],{type:"image/png"});G.src=D.byteLength?X.createObjectURL(J):Fe}(w,(D,V)=>i(D,V,M,P)))});return{cancel:()=>{p.cancel(),u()}}},qe="NO_ACCESS_TOKEN";function Je(s){return s.indexOf("mapbox:")===0}function ft(s){return $.API_URL_REGEX.test(s)}function ut(s){return $.API_CDN_URL_REGEX.test(s)}function st(s){return $.API_STYLE_REGEX.test(s)&&!ht(s)}function ht(s){return $.API_SPRITE_REGEX.test(s)}const ni=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function hi(s){const i=s.match(ni);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Kt(s){const i=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${i}`}const qi="mapbox.eventData";function zi(s){if(!s)return null;const i=s.split(".");if(!i||i.length!==3)return null;try{return JSON.parse(decodeURIComponent(C.atob(i[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Xi{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const o=zi($.ACCESS_TOKEN);let u="";return u=o&&o.u?C.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(p,x)=>String.fromCharCode(+("0x"+x)))):$.ACCESS_TOKEN||"",i?`${qi}.${i}:${u}`:`${qi}:${u}`}fetchEventData(){const i=Zt("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(i)try{const p=C.localStorage.getItem(o);p&&(this.eventData=JSON.parse(p));const x=C.localStorage.getItem(u);x&&(this.anonId=x)}catch{Bt("Unable to read from LocalStorage")}}saveEventData(){const i=Zt("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(i)try{C.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&C.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{Bt("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,o,u,p){if(!$.EVENTS_URL)return;const x=hi($.EVENTS_URL);x.params.push(`access_token=${p||$.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(i).toISOString()},M=o?Hi(w,o):w,P={url:Kt(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};this.pendingRequest=function(D,V){return or(Hi(D,{method:"POST"}),V)}(P,D=>{this.pendingRequest=null,u(D),this.saveEventData(),this.processRequests(p)})}queueRequest(i,o){this.queue.push(i),this.processRequests(o)}}const cn=new class extends Xi{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,i){$.EVENTS_URL&&$.ACCESS_TOKEN&&Array.isArray(s)&&s.some(o=>Je(o)||ft(o))&&this.queueRequest(Date.now(),i)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=zi($.ACCESS_TOKEN),o=i?i.u:$.ACCESS_TOKEN;let u=o!==this.eventData.tokenU;xt(this.anonId)||(this.anonId=nt(),u=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),w=new Date(p),M=(p-this.eventData.lastSuccess)/864e5;u=u||M>=1||M<-1||x.getDate()!==w.getDate()}else u=!0;u?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:se,"enabled.telemetry":!1,userId:this.anonId},x=>{x||(this.eventData.lastSuccess=p,this.eventData.tokenU=o)},s):this.processRequests()}},mn=cn.postTurnstileEvent.bind(cn),ys=new class extends Xi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,i,o,u){this.skuToken=i,this.errorCb=u,$.EVENTS_URL&&(o||$.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},o):this.errorCb(new Error(qe)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:o}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),xt(this.anonId)||(this.anonId=nt()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:se,skuToken:this.skuToken,userId:this.anonId},u=>{u?this.errorCb(u):i&&(this.success[i]=!0)},s))}},Cs=ys.postMapLoadEvent.bind(ys),mr=new class extends Xi{constructor(){super("gljs.performance")}postPerformanceEvent(s,i){$.EVENTS_URL&&(s||$.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},s)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,performanceData:o}=this.queue.shift(),u=function(p){const x=C.performance.getEntriesByType("resource"),w=C.performance.getEntriesByType("mark"),M=function(X){const J={};if(X){for(const Q in X)if(Q!=="other")for(const ae of X[Q]){const _e=`${Q}ResolveRangeMin`,Pe=`${Q}ResolveRangeMax`,je=`${Q}RequestCount`,Le=`${Q}RequestCachedCount`;J[_e]=Math.min(J[_e]||1/0,ae.startTime),J[Pe]=Math.max(J[Pe]||-1/0,ae.responseEnd);const Ve=He=>{J[He]===void 0&&(J[He]=0),++J[He]};ae.transferSize!==void 0&&ae.transferSize===0&&Ve(Le),Ve(je)}}return J}(function(X,J){const Q={};if(X)for(const ae of X){const _e=J(ae);Q[_e]===void 0&&(Q[_e]=[]),Q[_e].push(ae)}return Q}(x,Fp)),P=C.devicePixelRatio,D=C.navigator.connection||C.navigator.mozConnection||C.navigator.webkitConnection,V={counters:[],metadata:[],attributes:[]},G=(X,J,Q)=>{Q!=null&&X.push({name:J,value:Q.toString()})};for(const X in M)G(V.counters,X,M[X]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(G(V.counters,"interactionRangeMin",p.interactionRange[0]),G(V.counters,"interactionRangeMax",p.interactionRange[1])),w)for(const X of Object.keys(Ds)){const J=Ds[X],Q=w.find(ae=>ae.name===J);Q&&G(V.counters,J,Q.startTime)}return G(V.counters,"visibilityHidden",p.visibilityHidden),G(V.attributes,"style",function(X){if(X)for(const J of X){const Q=J.name.split("?")[0];if(st(Q)){const ae=Q.split("/").slice(-2);if(ae.length===2)return`mapbox://styles/${ae[0]}/${ae[1]}`}}}(x)),G(V.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),G(V.attributes,"fogEnabled",p.fogEnabled?"true":"false"),G(V.attributes,"projection",p.projection),G(V.attributes,"zoom",p.zoom),G(V.metadata,"devicePixelRatio",P),G(V.metadata,"connectionEffectiveType",D?D.effectiveType:void 0),G(V.metadata,"navigatorUserAgent",C.navigator.userAgent),G(V.metadata,"screenWidth",C.screen.width),G(V.metadata,"screenHeight",C.screen.height),G(V.metadata,"windowWidth",C.innerWidth),G(V.metadata,"windowHeight",C.innerHeight),G(V.metadata,"mapWidth",p.width/P),G(V.metadata,"mapHeight",p.height/P),G(V.metadata,"webglRenderer",p.renderer),G(V.metadata,"webglVendor",p.vendor),G(V.metadata,"sdkVersion",O),G(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(o);for(const p of u.metadata);for(const p of u.counters);for(const p of u.attributes);this.postEvent(i,u,()=>{},s)}},Ys=mr.postPerformanceEvent.bind(mr),na=new class extends Xi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,i,o,u){if(!$.API_URL||!$.SESSION_PATH)return;const p=hi($.API_URL+$.SESSION_PATH);p.params.push(`sku=${i||""}`),p.params.push(`access_token=${u||$.ACCESS_TOKEN||""}`);const x={url:Kt(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(w,M){return or(Hi(w,{method:"GET"}),M)}(x,w=>{this.pendingRequest=null,o(w),this.saveEventData(),this.processRequests(u)})}getSessionAPI(s,i,o,u){this.skuToken=i,this.errorCb=u,$.SESSION_PATH&&$.API_URL&&(o||$.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},o):this.errorCb(new Error(qe)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:o}=this.queue.shift();i&&this.success[i]||this.getSession(o,this.skuToken,u=>{u?this.errorCb(u):i&&(this.success[i]=!0)},s)}},Ks=na.getSessionAPI.bind(na),br=new Set,Ds={create:"create",load:"load",fullLoad:"fullLoad"},Bp={mark(s){C.performance.mark(s)},measure(s,i,o){C.performance.measure(s,i,o)}};function Fp(s){const i=s.name.split("?")[0];return ut(i)&&i.includes("mapbox-gl.js")?"javascript":ut(i)&&i.includes("mapbox-gl.css")?"css":function(o){return $.API_FONTS_REGEX.test(o)}(i)?"fontRange":ht(i)?"sprite":st(i)?"style":function(o){return $.API_TILEJSON_REGEX.test(o)}(i)?"tilejson":"other"}const kn=C.performance;function jd(s){const i=s?s.url.toString():void 0;return kn.getEntriesByName(i)}let hh,fu,pu,Ro;const sa={now:()=>pu!==void 0?pu:C.performance.now(),setNow(s){pu=s},restoreNow(){pu=void 0},frame(s){const i=C.requestAnimationFrame(s);return{cancel:()=>C.cancelAnimationFrame(i)}},getImageData(s,i=0){const{width:o,height:u}=s;Ro||(Ro=C.document.createElement("canvas"));const p=Ro.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(o>Ro.width||u>Ro.height)&&(Ro.width=o,Ro.height=u),p.clearRect(-i,-i,o+2*i,u+2*i),p.drawImage(s,0,0,o,u),p.getImageData(-i,-i,o+2*i,u+2*i)},resolveURL:s=>(hh||(hh=C.document.createElement("a")),hh.href=s,hh.href),get devicePixelRatio(){return C.devicePixelRatio},get prefersReducedMotion(){return!!C.matchMedia&&(fu==null&&(fu=C.matchMedia("(prefers-reduced-motion: reduce)")),fu.matches)}};function $d(s,i,o){o[s]&&o[s].indexOf(i)!==-1||(o[s]=o[s]||[],o[s].push(i))}function uh(s,i,o){if(o&&o[s]){const u=o[s].indexOf(i);u!==-1&&o[s].splice(u,1)}}class ra{constructor(i,o={}){Hi(this,o),this.type=i}}class Ia extends ra{constructor(i,o={}){super("error",Hi({error:i},o))}}class Yn{on(i,o){return this._listeners=this._listeners||{},$d(i,o,this._listeners),this}off(i,o){return uh(i,o,this._listeners),uh(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},$d(i,o,this._oneTimeListeners),this):new Promise(u=>this.once(i,u))}fire(i,o){typeof i=="string"&&(i=new ra(i,o||{}));const u=i.type;if(this.listens(u)){i.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const M of p)M.call(this,i);const x=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const M of x)uh(u,M,this._oneTimeListeners),M.call(this,i);const w=this._eventedParent;w&&(Hi(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(i))}else i instanceof Ia&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var Ct=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function oa(s,...i){for(const o of i)for(const u in o)s[u]=o[u];return s}function $s(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ar(s){if(Array.isArray(s))return s.map(ar);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const o in s)i[o]=ar(s[o]);return i}return $s(s)}class Np extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}var aa=Np;class mu{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[u,p]of o)this.bindings[u]=p}concat(i){return new mu(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var Up=mu;const pc={kind:"null"},mi={kind:"number"},dn={kind:"string"},tn={kind:"boolean"},$r={kind:"color"},co={kind:"object"},nn={kind:"value"},Wr={kind:"collator"},wr={kind:"formatted"},zo={kind:"resolvedImage"};function ho(s,i){return{kind:"array",itemType:s,N:i}}function us(s){if(s.kind==="array"){const i=us(s.itemType);return typeof s.N=="number"?`array<${i}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${i}>`}return s.kind}const Vp=[pc,mi,dn,tn,$r,wr,co,ho(nn),zo];function Bo(s,i){if(i.kind==="error")return null;if(s.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Bo(s.itemType,i.itemType))&&(typeof s.N!="number"||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if(s.kind==="value"){for(const o of Vp)if(!Bo(o,i))return null}}return`Expected ${us(s)} but found ${us(i)} instead.`}function sl(s,i){return i.some(o=>o.kind===s.kind)}function dh(s,i){return i.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}var Wd,Gd={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function mc(s){return(s=Math.round(s))<0?0:s>255?255:s}function la(s){return mc(s[s.length-1]==="%"?parseFloat(s)/100*255:parseInt(s))}function gu(s){return(i=s[s.length-1]==="%"?parseFloat(s)/100:parseFloat(s))<0?0:i>1?1:i;var i}function Pa(s,i,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?s+(i-s)*o*6:2*o<1?i:3*o<2?s+(i-s)*(2/3-o)*6:s}try{Wd={}.parseCSSColor=function(s){var i,o=s.replace(/ /g,"").toLowerCase();if(o in Gd)return Gd[o].slice();if(o[0]==="#")return o.length===4?(i=parseInt(o.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:o.length===7&&(i=parseInt(o.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var u=o.indexOf("("),p=o.indexOf(")");if(u!==-1&&p+1===o.length){var x=o.substr(0,u),w=o.substr(u+1,p-(u+1)).split(","),M=1;switch(x){case"rgba":if(w.length!==4)return null;M=gu(w.pop());case"rgb":return w.length!==3?null:[la(w[0]),la(w[1]),la(w[2]),M];case"hsla":if(w.length!==4)return null;M=gu(w.pop());case"hsl":if(w.length!==3)return null;var P=(parseFloat(w[0])%360+360)%360/360,D=gu(w[1]),V=gu(w[2]),G=V<=.5?V*(D+1):V+D-V*D,X=2*V-G;return[mc(255*Pa(X,G,P+1/3)),mc(255*Pa(X,G,P)),mc(255*Pa(X,G,P-1/3)),M];default:return null}}return null}}catch{}class Gr{constructor(i,o,u,p=1){this.r=i,this.g=o,this.b=u,this.a=p}static parse(i){if(!i)return;if(i instanceof Gr)return i;if(typeof i!="string")return;const o=Wd(i);return o?new Gr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[i,o,u,p]=this.toArray();return`rgba(${Math.round(i)},${Math.round(o)},${Math.round(u)},${p})`}toArray(){const{r:i,g:o,b:u,a:p}=this;return p===0?[0,0,0,0]:[255*i/p,255*o/p,255*u/p,p]}toArray01(){const{r:i,g:o,b:u,a:p}=this;return p===0?[0,0,0,0]:[i/p,o/p,u/p,p]}toArray01PremultipliedAlpha(){const{r:i,g:o,b:u,a:p}=this;return[i,o,u,p]}}Gr.black=new Gr(0,0,0,1),Gr.white=new Gr(1,1,1,1),Gr.transparent=new Gr(0,0,0,0),Gr.red=new Gr(1,0,0,1),Gr.blue=new Gr(0,0,1,1);var Os=Gr;class Hd{constructor(i,o,u){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class fh{constructor(i,o,u,p,x){this.text=i.normalize?i.normalize():i,this.image=o,this.scale=u,this.fontStack=p,this.textColor=x}}class Hr{constructor(i){this.sections=i}static fromString(i){return new Hr([new fh(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Hr?i:Hr.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const o of this.sections){if(o.image){i.push(["image",o.image.name]);continue}i.push(o.text);const u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toArray())),i.push(u)}return i}}class Or{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Or({name:i,available:!1}):null}serialize(){return["image",this.name]}}function qd(s,i,o,u){return typeof s=="number"&&s>=0&&s<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[s,i,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[s,i,o,u]:[s,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function qr(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Os||s instanceof Hd||s instanceof Hr||s instanceof Or)return!0;if(Array.isArray(s)){for(const i of s)if(!qr(i))return!1;return!0}if(typeof s=="object"){for(const i in s)if(!qr(s[i]))return!1;return!0}return!1}function As(s){if(s===null)return pc;if(typeof s=="string")return dn;if(typeof s=="boolean")return tn;if(typeof s=="number")return mi;if(s instanceof Os)return $r;if(s instanceof Hd)return Wr;if(s instanceof Hr)return wr;if(s instanceof Or)return zo;if(Array.isArray(s)){const i=s.length;let o;for(const u of s){const p=As(u);if(o){if(o===p)continue;o=nn;break}o=p}return ho(o||nn,i)}return co}function La(s){const i=typeof s;return s===null?"":i==="string"||i==="number"||i==="boolean"?String(s):s instanceof Os||s instanceof Hr||s instanceof Or?s.toString():JSON.stringify(s)}class ph{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!qr(i[1]))return o.error("invalid value");const u=i[1];let p=As(u);const x=o.expectedType;return p.kind!=="array"||p.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(p=x),new ph(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Os?["rgba"].concat(this.value.toArray()):this.value instanceof Hr?this.value.serialize():this.value}}var Da=ph,lr=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const _u={string:dn,number:mi,boolean:tn,object:co};class Xd{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let u,p=1;const x=i[0];if(x==="array"){let M,P;if(i.length>2){const D=i[1];if(typeof D!="string"||!(D in _u)||D==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);M=_u[D],p++}else M=nn;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);P=i[2],p++}u=ho(M,P)}else u=_u[x];const w=[];for(;p<i.length;p++){const M=o.parse(i[p],p,nn);if(!M)return null;w.push(M)}return new Xd(u,w)}evaluate(i){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(i);if(!Bo(this.type,As(u)))return u;if(o===this.args.length-1)throw new lr(`Expected value to be of type ${us(this.type)}, but found ${us(As(u))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,o=[i.kind];if(i.kind==="array"){const u=i.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);const p=i.N;(typeof p=="number"||this.args.length>1)&&o.push(p)}}return o.concat(this.args.map(u=>u.serialize()))}}var Oa=Xd;class Ra{constructor(i){this.type=wr,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const u=i[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const p=[];let x=!1;for(let w=1;w<=i.length-1;++w){const M=i[w];if(x&&typeof M=="object"&&!Array.isArray(M)){x=!1;let P=null;if(M["font-scale"]&&(P=o.parse(M["font-scale"],1,mi),!P))return null;let D=null;if(M["text-font"]&&(D=o.parse(M["text-font"],1,ho(dn)),!D))return null;let V=null;if(M["text-color"]&&(V=o.parse(M["text-color"],1,$r),!V))return null;const G=p[p.length-1];G.scale=P,G.font=D,G.textColor=V}else{const P=o.parse(i[w],1,nn);if(!P)return null;const D=P.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,p.push({content:P,scale:null,font:null,textColor:null})}}return new Ra(p)}evaluate(i){return new Hr(this.sections.map(o=>{const u=o.content.evaluate(i);return As(u)===zo?new fh("",u,null,null,null):new fh(La(u),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const o of this.sections){i.push(o.content.serialize());const u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),i.push(u)}return i}}class gc{constructor(i){this.type=zo,this.input=i}static parse(i,o){if(i.length!==2)return o.error("Expected two arguments.");const u=o.parse(i[1],1,dn);return u?new gc(u):o.error("No image name provided.")}evaluate(i){const o=this.input.evaluate(i),u=Or.fromString(o);return u&&i.availableImages&&(u.available=i.availableImages.indexOf(o)>-1),u}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const _c={"to-boolean":tn,"to-color":$r,"to-number":mi,"to-string":dn};class Fo{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const u=i[0];if((u==="to-boolean"||u==="to-string")&&i.length!==2)return o.error("Expected one argument.");const p=_c[u],x=[];for(let w=1;w<i.length;w++){const M=o.parse(i[w],w,nn);if(!M)return null;x.push(M)}return new Fo(p,x)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let o,u;for(const p of this.args){if(o=p.evaluate(i),u=null,o instanceof Os)return o;if(typeof o=="string"){const x=i.parseColor(o);if(x)return x}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:qd(o[0],o[1],o[2],o[3]),!u))return new Os(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new lr(u||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(i),o===null)return 0;const p=Number(o);if(!isNaN(p))return p}throw new lr(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Hr.fromString(La(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Or.fromString(La(this.args[0].evaluate(i))):La(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ra([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new gc(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(o=>{i.push(o.serialize())}),i}}var za=Fo;const ca=["Unknown","Point","LineString","Polygon"];var Zd=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ca[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:o,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*i-s[0])+this.featureDistanceData.bearing[1]*(u*i-s[1])}return 0}parseColor(s){let i=this._parseColorCache[s];return i||(i=this._parseColorCache[s]=Os.parse(s)),i}};class Al{constructor(i,o,u,p){this.name=i,this.type=o,this._evaluate=u,this.args=p}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,o){const u=i[0],p=Al.definitions[u];if(!p)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(p)?p[0]:p.type,w=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,M=w.filter(([D])=>!Array.isArray(D)||D.length===i.length-1);let P=null;for(const[D,V]of M){P=new Kd(o.registry,o.path,null,o.scope);const G=[];let X=!1;for(let J=1;J<i.length;J++){const Q=i[J],ae=Array.isArray(D)?D[J-1]:D.type,_e=P.parse(Q,1+G.length,ae);if(!_e){X=!0;break}G.push(_e)}if(!X)if(Array.isArray(D)&&D.length!==G.length)P.error(`Expected ${D.length} arguments, but found ${G.length} instead.`);else{for(let J=0;J<G.length;J++){const Q=Array.isArray(D)?D[J]:D.type,ae=G[J];P.concat(J+1).checkSubtype(Q,ae.type)}if(P.errors.length===0)return new Al(u,x,V,G)}}if(M.length===1)o.errors.push(...P.errors);else{const D=(M.length?M:w).map(([G])=>{return X=G,Array.isArray(X)?`(${X.map(us).join(", ")})`:`(${us(X.type)}...)`;var X}).join(" | "),V=[];for(let G=1;G<i.length;G++){const X=o.parse(i[G],1+V.length);if(!X)return null;V.push(us(X.type))}o.error(`Expected arguments of type ${D}, but found (${V.join(", ")}) instead.`)}return null}static register(i,o){Al.definitions=o;for(const u in o)i[u]=Al}}var ha=Al;class ks{constructor(i,o,u){this.type=Wr,this.locale=u,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const u=i[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const p=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,tn);if(!p)return null;const x=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,tn);if(!x)return null;let w=null;return u.locale&&(w=o.parse(u.locale,1,dn),!w)?null:new ks(p,x,w)}evaluate(i){return new Hd(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const cr=8192;function mh(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function yc(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function xc(s,i){const o=(180+s[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,i.z);return[Math.round(o*p*cr),Math.round(u*p*cr)]}function vc(s,i,o){const u=s[0]-i[0],p=s[1]-i[1],x=s[0]-o[0],w=s[1]-o[1];return u*w-x*p==0&&u*x<=0&&p*w<=0}function yu(s,i){let o=!1;for(let w=0,M=i.length;w<M;w++){const P=i[w];for(let D=0,V=P.length;D<V-1;D++){if(vc(s,P[D],P[D+1]))return!1;(p=P[D])[1]>(u=s)[1]!=(x=P[D+1])[1]>u[1]&&u[0]<(x[0]-p[0])*(u[1]-p[1])/(x[1]-p[1])+p[0]&&(o=!o)}}var u,p,x;return o}function bc(s,i){for(let o=0;o<i.length;o++)if(yu(s,i[o]))return!0;return!1}function xu(s,i,o,u){const p=u[0]-o[0],x=u[1]-o[1],w=(s[0]-o[0])*x-p*(s[1]-o[1]),M=(i[0]-o[0])*x-p*(i[1]-o[1]);return w>0&&M<0||w<0&&M>0}function uo(s,i,o){for(const D of o)for(let V=0;V<D.length-1;++V)if((M=[(w=D[V+1])[0]-(x=D[V])[0],w[1]-x[1]])[0]*(P=[(p=i)[0]-(u=s)[0],p[1]-u[1]])[1]-M[1]*P[0]!=0&&xu(u,p,x,w)&&xu(x,w,u,p))return!0;var u,p,x,w,M,P;return!1}function Cn(s,i){for(let o=0;o<s.length;++o)if(!yu(s[o],i))return!1;for(let o=0;o<s.length-1;++o)if(uo(s[o],s[o+1],i))return!1;return!0}function Ig(s,i){for(let o=0;o<i.length;o++)if(Cn(s,i[o]))return!0;return!1}function kl(s,i,o){const u=[];for(let p=0;p<s.length;p++){const x=[];for(let w=0;w<s[p].length;w++){const M=xc(s[p][w],o);mh(i,M),x.push(M)}u.push(x)}return u}function Yd(s,i,o){const u=[];for(let p=0;p<s.length;p++){const x=kl(s[p],i,o);u.push(x)}return u}function vu(s,i,o,u){if(s[0]<o[0]||s[0]>o[2]){const p=.5*u;let x=s[0]-o[0]>p?-u:o[0]-s[0]>p?u:0;x===0&&(x=s[0]-o[2]>p?-u:o[2]-s[0]>p?u:0),s[0]+=x}mh(i,s)}function bu(s,i,o,u){const p=Math.pow(2,u.z)*cr,x=[u.x*cr,u.y*cr],w=[];if(!s)return w;for(const M of s)for(const P of M){const D=[P.x+x[0],P.y+x[1]];vu(D,i,o,p),w.push(D)}return w}function wu(s,i,o,u){const p=Math.pow(2,u.z)*cr,x=[u.x*cr,u.y*cr],w=[];if(!s)return w;for(const P of s){const D=[];for(const V of P){const G=[V.x+x[0],V.y+x[1]];mh(i,G),D.push(G)}w.push(D)}if(i[2]-i[0]<=p/2){(M=i)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const P of w)for(const D of P)vu(D,i,o,p)}var M;return w}class rl{constructor(i,o){this.type=tn,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(qr(i[1])){const u=i[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){const x=u.features[p].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new rl(u,u.features[p].geometry)}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new rl(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new rl(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,u){const p=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=o.canonicalID();if(!w)return!1;if(u.type==="Polygon"){const M=kl(u.coordinates,x,w),P=bu(o.geometry(),p,x,w);if(!yc(p,x))return!1;for(const D of P)if(!yu(D,M))return!1}if(u.type==="MultiPolygon"){const M=Yd(u.coordinates,x,w),P=bu(o.geometry(),p,x,w);if(!yc(p,x))return!1;for(const D of P)if(!bc(D,M))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,u){const p=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=o.canonicalID();if(!w)return!1;if(u.type==="Polygon"){const M=kl(u.coordinates,x,w),P=wu(o.geometry(),p,x,w);if(!yc(p,x))return!1;for(const D of P)if(!Cn(D,M))return!1}if(u.type==="MultiPolygon"){const M=Yd(u.coordinates,x,w),P=wu(o.geometry(),p,x,w);if(!yc(p,x))return!1;for(const D of P)if(!Ig(D,M))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Tu=rl;function Il(s){if(s instanceof ha&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Tu)return!1;let i=!0;return s.eachChild(o=>{i&&!Il(o)&&(i=!1)}),i}function No(s){if(s instanceof ha&&s.name==="feature-state")return!1;let i=!0;return s.eachChild(o=>{i&&!No(o)&&(i=!1)}),i}function Pl(s,i){if(s instanceof ha&&i.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(u=>{o&&!Pl(u,i)&&(o=!1)}),o}class Eu{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=i[1];return o.scope.has(u)?new Eu(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var jp=Eu;class gh{constructor(i,o=[],u,p=new Up,x=[]){this.registry=i,this.path=o,this.key=o.map(w=>`[${w}]`).join(""),this.scope=p,this.errors=x,this.expectedType=u}parse(i,o,u,p,x={}){return o?this.concat(o,u,p)._parse(i,x):this._parse(i,x)}_parse(i,o){function u(p,x,w){return w==="assert"?new Oa(x,[p]):w==="coerce"?new za(x,[p]):p}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=i[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[p];if(x){let w=x.parse(i,this);if(!w)return null;if(this.expectedType){const M=this.expectedType,P=w.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||P.kind!=="value")if(M.kind!=="color"&&M.kind!=="formatted"&&M.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(M,P))return null}else w=u(w,M,o.typeAnnotation||"coerce");else w=u(w,M,o.typeAnnotation||"assert")}if(!(w instanceof Da)&&w.type.kind!=="resolvedImage"&&_h(w)){const M=new Zd;try{w=new Da(w.type,w.evaluate(M))}catch(P){return this.error(P.message),null}}return w}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,u){const p=typeof i=="number"?this.path.concat(i):this.path,x=u?this.scope.concat(u):this.scope;return new gh(this.registry,p,o||null,x,this.errors)}error(i,...o){const u=`${this.key}${o.map(p=>`[${p}]`).join("")}`;this.errors.push(new aa(u,i))}checkSubtype(i,o){const u=Bo(i,o);return u&&this.error(u),u}}var Kd=gh;function _h(s){if(s instanceof jp)return _h(s.boundExpression);if(s instanceof ha&&s.name==="error"||s instanceof ks||s instanceof Tu)return!1;const i=s instanceof za||s instanceof Oa;let o=!0;return s.eachChild(u=>{o=i?o&&_h(u):o&&u instanceof Da}),!!o&&Il(s)&&Pl(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Su(s,i){const o=s.length-1;let u,p,x=0,w=o,M=0;for(;x<=w;)if(M=Math.floor((x+w)/2),u=s[M],p=s[M+1],u<=i){if(M===o||i<p)return M;x=M+1}else{if(!(u>i))throw new lr("Input is not a number.");w=M-1}return 0}class Mu{constructor(i,o,u){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[p,x]of u)this.labels.push(p),this.outputs.push(x)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(i[1],1,mi);if(!u)return null;const p=[];let x=null;o.expectedType&&o.expectedType.kind!=="value"&&(x=o.expectedType);for(let w=1;w<i.length;w+=2){const M=w===1?-1/0:i[w],P=i[w+1],D=w,V=w+1;if(typeof M!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(p.length&&p[p.length-1][0]>=M)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const G=o.parse(P,V,x);if(!G)return null;x=x||G.type,p.push([M,G])}return new Mu(x,u,p)}evaluate(i){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(i);const p=this.input.evaluate(i);if(p<=o[0])return u[0].evaluate(i);const x=o.length;return p>=o[x-1]?u[x-1].evaluate(i):u[Su(o,p)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&i.push(this.labels[o]),i.push(this.outputs[o].serialize());return i}}var Jd=Mu;function _n(s,i,o){return s*(1-o)+i*o}var ua=Object.freeze({__proto__:null,array:function(s,i,o){return s.map((u,p)=>_n(u,i[p],o))},color:function(s,i,o){return new Os(_n(s.r,i.r,o),_n(s.g,i.g,o),_n(s.b,i.b,o),_n(s.a,i.a,o))},number:_n});const Qd=.95047,Cu=1.08883,$p=4/29,Ll=6/29,ef=3*Ll*Ll,tf=Ll*Ll*Ll,nf=Math.PI/180,Au=180/Math.PI;function wc(s){return s>tf?Math.pow(s,1/3):s/ef+$p}function sf(s){return s>Ll?s*s*s:ef*(s-$p)}function ku(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Dl(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function ol(s){const i=Dl(s.r),o=Dl(s.g),u=Dl(s.b),p=wc((.4124564*i+.3575761*o+.1804375*u)/Qd),x=wc((.2126729*i+.7151522*o+.072175*u)/1);return{l:116*x-16,a:500*(p-x),b:200*(x-wc((.0193339*i+.119192*o+.9503041*u)/Cu)),alpha:s.a}}function Wp(s){let i=(s.l+16)/116,o=isNaN(s.a)?i:i+s.a/500,u=isNaN(s.b)?i:i-s.b/200;return i=1*sf(i),o=Qd*sf(o),u=Cu*sf(u),new Os(ku(3.2404542*o-1.5371385*i-.4985314*u),ku(-.969266*o+1.8760108*i+.041556*u),ku(.0556434*o-.2040259*i+1.0572252*u),s.alpha)}function Ol(s,i,o){const u=i-s;return s+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const yh={forward:ol,reverse:Wp,interpolate:function(s,i,o){return{l:_n(s.l,i.l,o),a:_n(s.a,i.a,o),b:_n(s.b,i.b,o),alpha:_n(s.alpha,i.alpha,o)}}},Uo={forward:function(s){const{l:i,a:o,b:u}=ol(s),p=Math.atan2(u,o)*Au;return{h:p<0?p+360:p,c:Math.sqrt(o*o+u*u),l:i,alpha:s.a}},reverse:function(s){const i=s.h*nf,o=s.c;return Wp({l:s.l,a:Math.cos(i)*o,b:Math.sin(i)*o,alpha:s.alpha})},interpolate:function(s,i,o){return{h:Ol(s.h,i.h,o),c:_n(s.c,i.c,o),l:_n(s.l,i.l,o),alpha:_n(s.alpha,i.alpha,o)}}};var Rl=Object.freeze({__proto__:null,hcl:Uo,lab:yh});class xh{constructor(i,o,u,p,x){this.type=i,this.operator=o,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[w,M]of x)this.labels.push(w),this.outputs.push(M)}static interpolationFactor(i,o,u,p){let x=0;if(i.name==="exponential")x=vh(o,i.base,u,p);else if(i.name==="linear")x=vh(o,1,u,p);else if(i.name==="cubic-bezier"){const w=i.controlPoints;x=new ze(w[0],w[1],w[2],w[3]).solve(vh(o,1,u,p))}return x}static parse(i,o){let[u,p,x,...w]=i;if(!Array.isArray(p)||p.length===0)return o.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const D=p[1];if(typeof D!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:D}}else{if(p[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const D=p.slice(1);if(D.length!==4||D.some(V=>typeof V!="number"||V<0||V>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:D}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(x=o.parse(x,2,mi),!x)return null;const M=[];let P=null;u==="interpolate-hcl"||u==="interpolate-lab"?P=$r:o.expectedType&&o.expectedType.kind!=="value"&&(P=o.expectedType);for(let D=0;D<w.length;D+=2){const V=w[D],G=w[D+1],X=D+3,J=D+4;if(typeof V!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(M.length&&M[M.length-1][0]>=V)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const Q=o.parse(G,J,P);if(!Q)return null;P=P||Q.type,M.push([V,Q])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new xh(P,u,p,x,M):o.error(`Type ${us(P)} is not interpolatable.`)}evaluate(i){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(i);const p=this.input.evaluate(i);if(p<=o[0])return u[0].evaluate(i);const x=o.length;if(p>=o[x-1])return u[x-1].evaluate(i);const w=Su(o,p),M=xh.interpolationFactor(this.interpolation,p,o[w],o[w+1]),P=u[w].evaluate(i),D=u[w+1].evaluate(i);return this.operator==="interpolate"?ua[this.type.kind.toLowerCase()](P,D,M):this.operator==="interpolate-hcl"?Uo.reverse(Uo.interpolate(Uo.forward(P),Uo.forward(D),M)):yh.reverse(yh.interpolate(yh.forward(P),yh.forward(D),M))}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,i,this.input.serialize()];for(let u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o}}function vh(s,i,o,u){const p=u-o,x=s-o;return p===0?0:i===1?x/p:(Math.pow(i,x)-1)/(Math.pow(i,p)-1)}var fo=xh;class Iu{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expectected at least one argument.");let u=null;const p=o.expectedType;p&&p.kind!=="value"&&(u=p);const x=[];for(const M of i.slice(1)){const P=o.parse(M,1+x.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,x.push(P)}const w=p&&x.some(M=>Bo(p,M.type));return new Iu(w?nn:u,x)}evaluate(i){let o,u=null,p=0;for(const x of this.args){if(p++,u=x.evaluate(i),u&&u instanceof Or&&!u.available&&(o||(o=u),u=null,p===this.args.length))return o;if(u!==null)break}return u}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(o=>{i.push(o.serialize())}),i}}var rf=Iu;class Pu{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const u=[];for(let x=1;x<i.length-1;x+=2){const w=i[x];if(typeof w!="string")return o.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return o.error("Variable names must contain only alphanumeric characters or '_'.",x);const M=o.parse(i[x+1],x+1);if(!M)return null;u.push([w,M])}const p=o.parse(i[i.length-1],i.length-1,o.expectedType,u);return p?new Pu(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[o,u]of this.bindings)i.push(o,u.serialize());return i.push(this.result.serialize()),i}}var bh=Pu;class of{constructor(i,o,u){this.type=i,this.index=o,this.input=u}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,mi),p=o.parse(i[2],2,ho(o.expectedType||nn));return u&&p?new of(p.type.itemType,u,p):null}evaluate(i){const o=this.index.evaluate(i),u=this.input.evaluate(i);if(o<0)throw new lr(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new lr(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new lr(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Pg=of;class af{constructor(i,o){this.type=tn,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,nn),p=o.parse(i[2],2,nn);return u&&p?sl(u.type,[tn,dn,mi,pc,nn])?new af(u,p):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${us(u.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(u==null)return!1;if(!dh(o,["boolean","string","number","null"]))throw new lr(`Expected first argument to be of type boolean, string, number or null, but found ${us(As(o))} instead.`);if(!dh(u,["string","array"]))throw new lr(`Expected second argument to be of type array or string, but found ${us(As(u))} instead.`);return u.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Vo=af;class wh{constructor(i,o,u){this.type=mi,this.needle=i,this.haystack=o,this.fromIndex=u}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,nn),p=o.parse(i[2],2,nn);if(!u||!p)return null;if(!sl(u.type,[tn,dn,mi,pc,nn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${us(u.type)} instead`);if(i.length===4){const x=o.parse(i[3],3,mi);return x?new wh(u,p,x):null}return new wh(u,p)}evaluate(i){const o=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(!dh(o,["boolean","string","number","null"]))throw new lr(`Expected first argument to be of type boolean, string, number or null, but found ${us(As(o))} instead.`);if(!dh(u,["string","array"]))throw new lr(`Expected second argument to be of type array or string, but found ${us(As(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(i);return u.indexOf(o,p)}return u.indexOf(o)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var lf=wh;class cf{constructor(i,o,u,p,x,w){this.inputType=i,this.type=o,this.input=u,this.cases=p,this.outputs=x,this.otherwise=w}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let u,p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const x={},w=[];for(let D=2;D<i.length-1;D+=2){let V=i[D];const G=i[D+1];Array.isArray(V)||(V=[V]);const X=o.concat(D);if(V.length===0)return X.error("Expected at least one branch label.");for(const Q of V){if(typeof Q!="number"&&typeof Q!="string")return X.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return X.error("Numeric branch labels must be integer values.");if(u){if(X.checkSubtype(u,As(Q)))return null}else u=As(Q);if(x[String(Q)]!==void 0)return X.error("Branch labels must be unique.");x[String(Q)]=w.length}const J=o.parse(G,D,p);if(!J)return null;p=p||J.type,w.push(J)}const M=o.parse(i[1],1,nn);if(!M)return null;const P=o.parse(i[i.length-1],i.length-1,p);return P?M.type.kind!=="value"&&o.concat(1).checkSubtype(u,M.type)?null:new cf(u,p,M,x,w,P):null}evaluate(i){const o=this.input.evaluate(i);return(As(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),u=[],p={};for(const w of o){const M=p[this.cases[w]];M===void 0?(p[this.cases[w]]=u.length,u.push([this.cases[w],[w]])):u[M][1].push(w)}const x=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,M]of u)i.push(M.length===1?x(M[0]):M.map(x)),i.push(this.outputs[w].serialize());return i.push(this.otherwise.serialize()),i}}var Lg=cf;class Tc{constructor(i,o,u){this.type=i,this.branches=o,this.otherwise=u}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const p=[];for(let w=1;w<i.length-1;w+=2){const M=o.parse(i[w],w,tn);if(!M)return null;const P=o.parse(i[w+1],w+1,u);if(!P)return null;p.push([M,P]),u=u||P.type}const x=o.parse(i[i.length-1],i.length-1,u);return x?new Tc(u,p,x):null}evaluate(i){for(const[o,u]of this.branches)if(o.evaluate(i))return u.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,u]of this.branches)i(o),i(u);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(o=>{i.push(o.serialize())}),i}}var Gp=Tc;class Th{constructor(i,o,u,p){this.type=i,this.input=o,this.beginIndex=u,this.endIndex=p}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,nn),p=o.parse(i[2],2,mi);if(!u||!p)return null;if(!sl(u.type,[ho(nn),dn,nn]))return o.error(`Expected first argument to be of type array or string, but found ${us(u.type)} instead`);if(i.length===4){const x=o.parse(i[3],3,mi);return x?new Th(u.type,u,p,x):null}return new Th(u.type,u,p)}evaluate(i){const o=this.input.evaluate(i),u=this.beginIndex.evaluate(i);if(!dh(o,["string","array"]))throw new lr(`Expected first argument to be of type array or string, but found ${us(As(o))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(i);return o.slice(u,p)}return o.slice(u)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var hf=Th;function Lu(s,i){return s==="=="||s==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function zl(s,i,o,u){return u.compare(i,o)===0}function po(s,i,o){const u=s!=="=="&&s!=="!=";return class mL{constructor(x,w,M){this.type=tn,this.lhs=x,this.rhs=w,this.collator=M,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const M=x[0];let P=w.parse(x[1],1,nn);if(!P)return null;if(!Lu(M,P.type))return w.concat(1).error(`"${M}" comparisons are not supported for type '${us(P.type)}'.`);let D=w.parse(x[2],2,nn);if(!D)return null;if(!Lu(M,D.type))return w.concat(2).error(`"${M}" comparisons are not supported for type '${us(D.type)}'.`);if(P.type.kind!==D.type.kind&&P.type.kind!=="value"&&D.type.kind!=="value")return w.error(`Cannot compare types '${us(P.type)}' and '${us(D.type)}'.`);u&&(P.type.kind==="value"&&D.type.kind!=="value"?P=new Oa(D.type,[P]):P.type.kind!=="value"&&D.type.kind==="value"&&(D=new Oa(P.type,[D])));let V=null;if(x.length===4){if(P.type.kind!=="string"&&D.type.kind!=="string"&&P.type.kind!=="value"&&D.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(V=w.parse(x[3],3,Wr),!V)return null}return new mL(P,D,V)}evaluate(x){const w=this.lhs.evaluate(x),M=this.rhs.evaluate(x);if(u&&this.hasUntypedArgument){const P=As(w),D=As(M);if(P.kind!==D.kind||P.kind!=="string"&&P.kind!=="number")throw new lr(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${P.kind}, ${D.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=As(w),D=As(M);if(P.kind!=="string"||D.kind!=="string")return i(x,w,M)}return this.collator?o(x,w,M,this.collator.evaluate(x)):i(x,w,M)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[s];return this.eachChild(w=>{x.push(w.serialize())}),x}}}const Dg=po("==",function(s,i,o){return i===o},zl),Og=po("!=",function(s,i,o){return i!==o},function(s,i,o,u){return!zl(0,i,o,u)}),Rg=po("<",function(s,i,o){return i<o},function(s,i,o,u){return u.compare(i,o)<0}),zg=po(">",function(s,i,o){return i>o},function(s,i,o,u){return u.compare(i,o)>0}),Bg=po("<=",function(s,i,o){return i<=o},function(s,i,o,u){return u.compare(i,o)<=0}),Eh=po(">=",function(s,i,o){return i>=o},function(s,i,o,u){return u.compare(i,o)>=0});class Ec{constructor(i,o,u,p,x,w){this.type=dn,this.number=i,this.locale=o,this.currency=u,this.unit=p,this.minFractionDigits=x,this.maxFractionDigits=w}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const u=o.parse(i[1],1,mi);if(!u)return null;const p=i[2];if(typeof p!="object"||Array.isArray(p))return o.error("NumberFormat options argument must be an object.");let x=null;if(p.locale&&(x=o.parse(p.locale,1,dn),!x))return null;let w=null;if(p.currency&&(w=o.parse(p.currency,1,dn),!w))return null;let M=null;if(p.unit&&(M=o.parse(p.unit,1,dn),!M))return null;let P=null;if(p["min-fraction-digits"]&&(P=o.parse(p["min-fraction-digits"],1,mi),!P))return null;let D=null;return p["max-fraction-digits"]&&(D=o.parse(p["max-fraction-digits"],1,mi),!D)?null:new Ec(u,x,w,M,P,D)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Sc{constructor(i){this.type=mi,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const u=o.parse(i[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${us(u.type)} instead.`):new Sc(u):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string"||Array.isArray(o))return o.length;throw new lr(`Expected value to be of type string or array, but found ${us(As(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(o=>{i.push(o.serialize())}),i}}const Sh={"==":Dg,"!=":Og,">":zg,"<":Rg,">=":Eh,"<=":Bg,array:Oa,at:Pg,boolean:Oa,case:Gp,coalesce:rf,collator:ks,format:Ra,image:gc,in:Vo,"index-of":lf,interpolate:fo,"interpolate-hcl":fo,"interpolate-lab":fo,length:Sc,let:bh,literal:Da,match:Lg,number:Oa,"number-format":Ec,object:Oa,slice:hf,step:Jd,string:Oa,"to-boolean":za,"to-color":za,"to-number":za,"to-string":za,var:jp,within:Tu};function Du(s,[i,o,u,p]){i=i.evaluate(s),o=o.evaluate(s),u=u.evaluate(s);const x=p?p.evaluate(s):1,w=qd(i,o,u,x);if(w)throw new lr(w);return new Os(i/255*x,o/255*x,u/255*x,x)}function Ba(s,i){return s in i}function Mh(s,i){const o=i[s];return o===void 0?null:o}function Tr(s){return{type:s}}ha.register(Sh,{error:[{kind:"error"},[dn],(s,[i])=>{throw new lr(i.evaluate(s))}],typeof:[dn,[nn],(s,[i])=>us(As(i.evaluate(s)))],"to-rgba":[ho(mi,4),[$r],(s,[i])=>i.evaluate(s).toArray()],rgb:[$r,[mi,mi,mi],Du],rgba:[$r,[mi,mi,mi,mi],Du],has:{type:tn,overloads:[[[dn],(s,[i])=>Ba(i.evaluate(s),s.properties())],[[dn,co],(s,[i,o])=>Ba(i.evaluate(s),o.evaluate(s))]]},get:{type:nn,overloads:[[[dn],(s,[i])=>Mh(i.evaluate(s),s.properties())],[[dn,co],(s,[i,o])=>Mh(i.evaluate(s),o.evaluate(s))]]},"feature-state":[nn,[dn],(s,[i])=>Mh(i.evaluate(s),s.featureState||{})],properties:[co,[],s=>s.properties()],"geometry-type":[dn,[],s=>s.geometryType()],id:[nn,[],s=>s.id()],zoom:[mi,[],s=>s.globals.zoom],pitch:[mi,[],s=>s.globals.pitch||0],"distance-from-center":[mi,[],s=>s.distanceFromCenter()],"heatmap-density":[mi,[],s=>s.globals.heatmapDensity||0],"line-progress":[mi,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[mi,[],s=>s.globals.skyRadialProgress||0],accumulated:[nn,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[mi,Tr(mi),(s,i)=>{let o=0;for(const u of i)o+=u.evaluate(s);return o}],"*":[mi,Tr(mi),(s,i)=>{let o=1;for(const u of i)o*=u.evaluate(s);return o}],"-":{type:mi,overloads:[[[mi,mi],(s,[i,o])=>i.evaluate(s)-o.evaluate(s)],[[mi],(s,[i])=>-i.evaluate(s)]]},"/":[mi,[mi,mi],(s,[i,o])=>i.evaluate(s)/o.evaluate(s)],"%":[mi,[mi,mi],(s,[i,o])=>i.evaluate(s)%o.evaluate(s)],ln2:[mi,[],()=>Math.LN2],pi:[mi,[],()=>Math.PI],e:[mi,[],()=>Math.E],"^":[mi,[mi,mi],(s,[i,o])=>Math.pow(i.evaluate(s),o.evaluate(s))],sqrt:[mi,[mi],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[mi,[mi],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[mi,[mi],(s,[i])=>Math.log(i.evaluate(s))],log2:[mi,[mi],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[mi,[mi],(s,[i])=>Math.sin(i.evaluate(s))],cos:[mi,[mi],(s,[i])=>Math.cos(i.evaluate(s))],tan:[mi,[mi],(s,[i])=>Math.tan(i.evaluate(s))],asin:[mi,[mi],(s,[i])=>Math.asin(i.evaluate(s))],acos:[mi,[mi],(s,[i])=>Math.acos(i.evaluate(s))],atan:[mi,[mi],(s,[i])=>Math.atan(i.evaluate(s))],min:[mi,Tr(mi),(s,i)=>Math.min(...i.map(o=>o.evaluate(s)))],max:[mi,Tr(mi),(s,i)=>Math.max(...i.map(o=>o.evaluate(s)))],abs:[mi,[mi],(s,[i])=>Math.abs(i.evaluate(s))],round:[mi,[mi],(s,[i])=>{const o=i.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[mi,[mi],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[mi,[mi],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[tn,[dn,nn],(s,[i,o])=>s.properties()[i.value]===o.value],"filter-id-==":[tn,[nn],(s,[i])=>s.id()===i.value],"filter-type-==":[tn,[dn],(s,[i])=>s.geometryType()===i.value],"filter-<":[tn,[dn,nn],(s,[i,o])=>{const u=s.properties()[i.value],p=o.value;return typeof u==typeof p&&u<p}],"filter-id-<":[tn,[nn],(s,[i])=>{const o=s.id(),u=i.value;return typeof o==typeof u&&o<u}],"filter->":[tn,[dn,nn],(s,[i,o])=>{const u=s.properties()[i.value],p=o.value;return typeof u==typeof p&&u>p}],"filter-id->":[tn,[nn],(s,[i])=>{const o=s.id(),u=i.value;return typeof o==typeof u&&o>u}],"filter-<=":[tn,[dn,nn],(s,[i,o])=>{const u=s.properties()[i.value],p=o.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[tn,[nn],(s,[i])=>{const o=s.id(),u=i.value;return typeof o==typeof u&&o<=u}],"filter->=":[tn,[dn,nn],(s,[i,o])=>{const u=s.properties()[i.value],p=o.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[tn,[nn],(s,[i])=>{const o=s.id(),u=i.value;return typeof o==typeof u&&o>=u}],"filter-has":[tn,[nn],(s,[i])=>i.value in s.properties()],"filter-has-id":[tn,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[tn,[ho(dn)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[tn,[ho(nn)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[tn,[dn,ho(nn)],(s,[i,o])=>o.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[tn,[dn,ho(nn)],(s,[i,o])=>function(u,p,x,w){for(;x<=w;){const M=x+w>>1;if(p[M]===u)return!0;p[M]>u?w=M-1:x=M+1}return!1}(s.properties()[i.value],o.value,0,o.value.length-1)],all:{type:tn,overloads:[[[tn,tn],(s,[i,o])=>i.evaluate(s)&&o.evaluate(s)],[Tr(tn),(s,i)=>{for(const o of i)if(!o.evaluate(s))return!1;return!0}]]},any:{type:tn,overloads:[[[tn,tn],(s,[i,o])=>i.evaluate(s)||o.evaluate(s)],[Tr(tn),(s,i)=>{for(const o of i)if(o.evaluate(s))return!0;return!1}]]},"!":[tn,[tn],(s,[i])=>!i.evaluate(s)],"is-supported-script":[tn,[dn],(s,[i])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(i.evaluate(s))}],upcase:[dn,[dn],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[dn,[dn],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[dn,Tr(nn),(s,i)=>i.map(o=>La(o.evaluate(s))).join("")],"resolved-locale":[dn,[Wr],(s,[i])=>i.evaluate(s).resolvedLocale()]});var Ch=Sh;function Ah(s){return{result:"success",value:s}}function Bl(s){return{result:"error",value:s}}function Mc(s){return s["property-type"]==="data-driven"}function io(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Fa(s){return!!s.expression&&s.expression.interpolated}function Tn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Cc(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Hp(s){return s}function Ac(s,i){const o=i.type==="color",u=s.stops&&typeof s.stops[0][0]=="object",p=u||!(u||s.property!==void 0),x=s.type||(Fa(i)?"exponential":"interval");if(o&&((s=oa({},s)).stops&&(s.stops=s.stops.map(D=>[D[0],Os.parse(D[1])])),s.default=Os.parse(s.default?s.default:i.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!Rl[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let w,M,P;if(x==="exponential")w=Na;else if(x==="interval")w=kh;else if(x==="categorical"){w=qp,M=Object.create(null);for(const D of s.stops)M[D[0]]=D[1];P=typeof s.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);w=Ou}if(u){const D={},V=[];for(let J=0;J<s.stops.length;J++){const Q=s.stops[J],ae=Q[0].zoom;D[ae]===void 0&&(D[ae]={zoom:ae,type:s.type,property:s.property,default:s.default,stops:[]},V.push(ae)),D[ae].stops.push([Q[0].value,Q[1]])}const G=[];for(const J of V)G.push([D[J].zoom,Ac(D[J],i)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:fo.interpolationFactor.bind(void 0,X),zoomStops:G.map(J=>J[0]),evaluate:({zoom:J},Q)=>Na({stops:G,base:s.base},i,J).evaluate(J,Q)}}if(p){const D=x==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:fo.interpolationFactor.bind(void 0,D),zoomStops:s.stops.map(V=>V[0]),evaluate:({zoom:V})=>w(s,i,V,M,P)}}return{kind:"source",evaluate(D,V){const G=V&&V.properties?V.properties[s.property]:void 0;return G===void 0?kc(s.default,i.default):w(s,i,G,M,P)}}}function kc(s,i,o){return s!==void 0?s:i!==void 0?i:o!==void 0?o:void 0}function qp(s,i,o,u,p){return kc(typeof o===p?u[o]:void 0,s.default,i.default)}function kh(s,i,o){if(Tn(o)!=="number")return kc(s.default,i.default);const u=s.stops.length;if(u===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[u-1][0])return s.stops[u-1][1];const p=Su(s.stops.map(x=>x[0]),o);return s.stops[p][1]}function Na(s,i,o){const u=s.base!==void 0?s.base:1;if(Tn(o)!=="number")return kc(s.default,i.default);const p=s.stops.length;if(p===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[p-1][0])return s.stops[p-1][1];const x=Su(s.stops.map(V=>V[0]),o),w=function(V,G,X,J){const Q=J-X,ae=V-X;return Q===0?0:G===1?ae/Q:(Math.pow(G,ae)-1)/(Math.pow(G,Q)-1)}(o,u,s.stops[x][0],s.stops[x+1][0]),M=s.stops[x][1],P=s.stops[x+1][1];let D=ua[i.type]||Hp;if(s.colorSpace&&s.colorSpace!=="rgb"){const V=Rl[s.colorSpace];D=(G,X)=>V.reverse(V.interpolate(V.forward(G),V.forward(X),w))}return typeof M.evaluate=="function"?{evaluate(...V){const G=M.evaluate.apply(void 0,V),X=P.evaluate.apply(void 0,V);if(G!==void 0&&X!==void 0)return D(G,X,w)}}:D(M,P,w)}function Ou(s,i,o){return i.type==="color"?o=Os.parse(o):i.type==="formatted"?o=Hr.fromString(o.toString()):i.type==="resolvedImage"?o=Or.fromString(o.toString()):Tn(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0),kc(o,s.default,i.default)}class Er{constructor(i,o){this.expression=i,this._warningHistory={},this._evaluator=new Zd,this._defaultValue=o?function(u){return u.type==="color"&&(Cc(u.default)||Array.isArray(u.default))?new Os(0,0,0,0):u.type==="color"?Os.parse(u.default)||null:u.default===void 0?null:u.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(i,o,u,p,x,w,M,P){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(i,o,u,p,x,w,M,P){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=P||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new lr(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}}}function On(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Ch}function Ic(s,i){const o=new Kd(Ch,[],i?function(p){const x={color:$r,string:dn,number:mi,enum:dn,boolean:tn,formatted:wr,resolvedImage:zo};return p.type==="array"?ho(x[p.value]||nn,p.length):x[p.type]}(i):void 0),u=o.parse(s,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Ah(new Er(u,i)):Bl(o.errors)}class Ru{constructor(i,o){this.kind=i,this._styleExpression=o,this.isStateDependent=i!=="constant"&&!No(o.expression)}evaluateWithoutErrorHandling(i,o,u,p,x,w){return this._styleExpression.evaluateWithoutErrorHandling(i,o,u,p,x,w)}evaluate(i,o,u,p,x,w){return this._styleExpression.evaluate(i,o,u,p,x,w)}}class Fl{constructor(i,o,u,p){this.kind=i,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!No(o.expression),this.interpolationType=p}evaluateWithoutErrorHandling(i,o,u,p,x,w){return this._styleExpression.evaluateWithoutErrorHandling(i,o,u,p,x,w)}evaluate(i,o,u,p,x,w){return this._styleExpression.evaluate(i,o,u,p,x,w)}interpolationFactor(i,o,u){return this.interpolationType?fo.interpolationFactor(this.interpolationType,i,o,u):0}}function al(s,i){if((s=Ic(s,i)).result==="error")return s;const o=s.value.expression,u=Il(o);if(!u&&!Mc(i))return Bl([new aa("","data expressions not supported")]);const p=Pl(o,["zoom","pitch","distance-from-center"]);if(!p&&!io(i))return Bl([new aa("","zoom expressions not supported")]);const x=Ih(o);return x||p?x instanceof aa?Bl([x]):x instanceof fo&&!Fa(i)?Bl([new aa("",'"interpolate" expressions cannot be used with this property')]):Ah(x?new Fl(u?"camera":"composite",s.value,x.labels,x instanceof fo?x.interpolation:void 0):new Ru(u?"constant":"source",s.value)):Bl([new aa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class is{constructor(i,o){this._parameters=i,this._specification=o,oa(this,Ac(this._parameters,this._specification))}static deserialize(i){return new is(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Ih(s){let i=null;if(s instanceof bh)i=Ih(s.result);else if(s instanceof rf){for(const o of s.args)if(i=Ih(o),i)break}else(s instanceof Jd||s instanceof fo)&&s.input instanceof ha&&s.input.name==="zoom"&&(i=s);return i instanceof aa||s.eachChild(o=>{const u=Ih(o);u instanceof aa?i=u:!i&&u?i=new aa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&u&&i!==u&&(i=new aa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}class yi{constructor(i,o,u,p){this.message=(i?`${i}: `:"")+u,p&&(this.identifier=p),o!=null&&o.__line__&&(this.line=o.__line__)}}function mo(s){const i=s.key,o=s.value,u=s.valueSpec||{},p=s.objectElementValidators||{},x=s.style,w=s.styleSpec;let M=[];const P=Tn(o);if(P!=="object")return[new yi(i,o,`object expected, ${P} found`)];for(const D in o){const V=D.split(".")[0];let G;p[V]?G=p[V]:u[V]?G=Sr:p["*"]?G=p["*"]:u["*"]&&(G=Sr),G?M=M.concat(G({key:(i&&`${i}.`)+D,value:o[D],valueSpec:u[V]||u["*"],style:x,styleSpec:w,object:o,objectKey:D},o)):M.push(new yi(i,o[D],`unknown property "${D}"`))}for(const D in u)p[D]||u[D].required&&u[D].default===void 0&&o[D]===void 0&&M.push(new yi(i,o,`missing required property "${D}"`));return M}function Ui(s){const i=s.value,o=s.valueSpec,u=s.style,p=s.styleSpec,x=s.key,w=s.arrayElementValidator||Sr;if(Tn(i)!=="array")return[new yi(x,i,`array expected, ${Tn(i)} found`)];if(o.length&&i.length!==o.length)return[new yi(x,i,`array length ${o.length} expected, length ${i.length} found`)];if(o["min-length"]&&i.length<o["min-length"])return[new yi(x,i,`array length at least ${o["min-length"]} expected, length ${i.length} found`)];let M={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};p.$version<7&&(M.function=o.function),Tn(o.value)==="object"&&(M=o.value);let P=[];for(let D=0;D<i.length;D++)P=P.concat(w({array:i,arrayIndex:D,value:i[D],valueSpec:M,style:u,styleSpec:p,key:`${x}[${D}]`}));return P}function Pc(s){const i=s.key,o=s.value,u=s.valueSpec;let p=Tn(o);if(p==="number"&&o!=o&&(p="NaN"),p!=="number")return[new yi(i,o,`number expected, ${p} found`)];if("minimum"in u){let x=u.minimum;if(Tn(u.minimum)==="array"&&(x=u.minimum[s.arrayIndex]),o<x)return[new yi(i,o,`${o} is less than the minimum value ${x}`)]}if("maximum"in u){let x=u.maximum;if(Tn(u.maximum)==="array"&&(x=u.maximum[s.arrayIndex]),o>x)return[new yi(i,o,`${o} is greater than the maximum value ${x}`)]}return[]}function ll(s){const i=s.valueSpec,o=$s(s.value.type);let u,p,x,w={};const M=o!=="categorical"&&s.value.property===void 0,P=!M,D=Tn(s.value.stops)==="array"&&Tn(s.value.stops[0])==="array"&&Tn(s.value.stops[0][0])==="object",V=mo({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(J){if(o==="identity")return[new yi(J.key,J.value,'identity function may not have a "stops" property')];let Q=[];const ae=J.value;return Q=Q.concat(Ui({key:J.key,value:ae,valueSpec:J.valueSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:G})),Tn(ae)==="array"&&ae.length===0&&Q.push(new yi(J.key,ae,"array must have at least one stop")),Q},default:function(J){return Sr({key:J.key,value:J.value,valueSpec:i,style:J.style,styleSpec:J.styleSpec})}}});return o==="identity"&&M&&V.push(new yi(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||V.push(new yi(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!Fa(s.valueSpec)&&V.push(new yi(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(P&&!Mc(s.valueSpec)?V.push(new yi(s.key,s.value,"property functions not supported")):M&&!io(s.valueSpec)&&V.push(new yi(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!D||s.value.property!==void 0||V.push(new yi(s.key,s.value,'"property" property is required')),V;function G(J){let Q=[];const ae=J.value,_e=J.key;if(Tn(ae)!=="array")return[new yi(_e,ae,`array expected, ${Tn(ae)} found`)];if(ae.length!==2)return[new yi(_e,ae,`array length 2 expected, length ${ae.length} found`)];if(D){if(Tn(ae[0])!=="object")return[new yi(_e,ae,`object expected, ${Tn(ae[0])} found`)];if(ae[0].zoom===void 0)return[new yi(_e,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new yi(_e,ae,"object stop key must have value")];const Pe=$s(ae[0].zoom);if(typeof Pe!="number")return[new yi(_e,ae[0].zoom,"stop zoom values must be numbers")];if(x&&x>Pe)return[new yi(_e,ae[0].zoom,"stop zoom values must appear in ascending order")];Pe!==x&&(x=Pe,p=void 0,w={}),Q=Q.concat(mo({key:`${_e}[0]`,value:ae[0],valueSpec:{zoom:{}},style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:Pc,value:X}}))}else Q=Q.concat(X({key:`${_e}[0]`,value:ae[0],style:J.style,styleSpec:J.styleSpec},ae));return On(ar(ae[1]))?Q.concat([new yi(`${_e}[1]`,ae[1],"expressions are not allowed in function stops.")]):Q.concat(Sr({key:`${_e}[1]`,value:ae[1],valueSpec:i,style:J.style,styleSpec:J.styleSpec}))}function X(J,Q){const ae=Tn(J.value),_e=$s(J.value),Pe=J.value!==null?J.value:Q;if(u){if(ae!==u)return[new yi(J.key,Pe,`${ae} stop domain type must match previous stop domain type ${u}`)]}else u=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean"&&typeof _e!="number"&&typeof _e!="string"&&typeof _e!="boolean")return[new yi(J.key,Pe,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&o!=="categorical"){let je=`number expected, ${ae} found`;return Mc(i)&&o===void 0&&(je+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new yi(J.key,Pe,je)]}return o!=="categorical"||ae!=="number"||typeof _e=="number"&&isFinite(_e)&&Math.floor(_e)===_e?o!=="categorical"&&ae==="number"&&typeof _e=="number"&&typeof p=="number"&&p!==void 0&&_e<p?[new yi(J.key,Pe,"stop domain values must appear in ascending order")]:(p=_e,o==="categorical"&&_e in w?[new yi(J.key,Pe,"stop domain values must be unique")]:(w[_e]=!0,[])):[new yi(J.key,Pe,`integer expected, found ${String(_e)}`)]}}function hr(s){const i=(s.expressionContext==="property"?al:Ic)(ar(s.value),s.valueSpec);if(i.result==="error")return i.value.map(u=>new yi(`${s.key}${u.key}`,s.value,u.message));const o=i.value.expression||i.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new yi(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!No(o))return[new yi(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter")return cl(o,s);if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Pl(o,["zoom","feature-state"]))return[new yi(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Il(o))return[new yi(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cl(s,i){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const p of i.valueSpec.expression.parameters)o.delete(p);if(o.size===0)return[];const u=[];return s instanceof ha&&o.has(s.name)?[new yi(i.key,i.value,`["${s.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(s.eachChild(p=>{u.push(...cl(p,i))}),u)}function an(s){const i=s.key,o=s.value,u=s.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf($s(o))===-1&&p.push(new yi(i,o,`expected one of [${u.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(u.values).indexOf($s(o))===-1&&p.push(new yi(i,o,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(o)} found`)),p}function Lc(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!Lc(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function zu(s,i="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Lc(s)||(s=Dc(s));const o=s;let u=!0;try{u=function(D){if(!Nl(D))return D;let V=ar(D);return Bu(V),V=Xp(V),V}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(o,null,2)}
        `)}const p=Ct[`filter_${i}`],x=Ic(u,p);let w=null;if(x.result==="error")throw new Error(x.value.map(D=>`${D.key}: ${D.message}`).join(", "));w=(D,V,G)=>x.value.evaluate(D,V,{},G);let M=null,P=null;if(u!==o){const D=Ic(o,p);if(D.result==="error")throw new Error(D.value.map(V=>`${V.key}: ${V.message}`).join(", "));M=(V,G,X,J,Q)=>D.value.evaluate(V,G,{},X,void 0,void 0,J,Q),P=!Il(D.value.expression)}return{filter:w,dynamicFilter:M||void 0,needGeometry:Zp(u),needFeature:!!P}}function Xp(s){if(!Array.isArray(s))return s;const i=function(o){if(hl.has(o[0])){for(let u=1;u<o.length;u++)if(Nl(o[u]))return!0}return o}(s);return i===!0?i:i.map(o=>Xp(o))}function Bu(s){let i=!1;const o=[];if(s[0]==="case"){for(let u=1;u<s.length-1;u+=2)i=i||Nl(s[u]),o.push(s[u+1]);o.push(s[s.length-1])}else if(s[0]==="match"){i=i||Nl(s[1]);for(let u=2;u<s.length-1;u+=2)o.push(s[u+1]);o.push(s[s.length-1])}else if(s[0]==="step"){i=i||Nl(s[1]);for(let u=1;u<s.length-1;u+=2)o.push(s[u+1])}i&&(s.length=0,s.push("any",...o));for(let u=1;u<s.length;u++)Bu(s[u])}function Nl(s){if(!Array.isArray(s))return!1;if((i=s[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let o=1;o<s.length;o++)if(Nl(s[o]))return!0;return!1}const hl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Fg(s,i){return s<i?-1:s>i?1:0}function Zp(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let i=1;i<s.length;i++)if(Zp(s[i]))return!0;return!1}function Dc(s){if(!s)return!0;const i=s[0];return s.length<=1?i!=="any":i==="=="?Oc(s[1],s[2],"=="):i==="!="?Nu(Oc(s[1],s[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Oc(s[1],s[2],i):i==="any"?(o=s.slice(1),["any"].concat(o.map(Dc))):i==="all"?["all"].concat(s.slice(1).map(Dc)):i==="none"?["all"].concat(s.slice(1).map(Dc).map(Nu)):i==="in"?uf(s[1],s.slice(2)):i==="!in"?Nu(uf(s[1],s.slice(2))):i==="has"?Fu(s[1]):i==="!has"?Nu(Fu(s[1])):i!=="within"||s;var o}function Oc(s,i,o){switch(s){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,s,i]}}function uf(s,i){if(i.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",s,["literal",i.sort(Fg)]]:["filter-in-small",s,["literal",i]]}}function Fu(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Nu(s){return["!",s]}function Ph(s){return Lc(ar(s.value))?hr(oa({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):Lh(s)}function Lh(s){const i=s.value,o=s.key;if(Tn(i)!=="array")return[new yi(o,i,`array expected, ${Tn(i)} found`)];const u=s.styleSpec;let p,x=[];if(i.length<1)return[new yi(o,i,"filter array must have at least 1 element")];switch(x=x.concat(an({key:`${o}[0]`,value:i[0],valueSpec:u.filter_operator,style:s.style,styleSpec:s.styleSpec})),$s(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&$s(i[1])==="$type"&&x.push(new yi(o,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&x.push(new yi(o,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(p=Tn(i[1]),p!=="string"&&x.push(new yi(`${o}[1]`,i[1],`string expected, ${p} found`)));for(let w=2;w<i.length;w++)p=Tn(i[w]),$s(i[1])==="$type"?x=x.concat(an({key:`${o}[${w}]`,value:i[w],valueSpec:u.geometry_type,style:s.style,styleSpec:s.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&x.push(new yi(`${o}[${w}]`,i[w],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let w=1;w<i.length;w++)x=x.concat(Lh({key:`${o}[${w}]`,value:i[w],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=Tn(i[1]),i.length!==2?x.push(new yi(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):p!=="string"&&x.push(new yi(`${o}[1]`,i[1],`string expected, ${p} found`));break;case"within":p=Tn(i[1]),i.length!==2?x.push(new yi(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):p!=="object"&&x.push(new yi(`${o}[1]`,i[1],`object expected, ${p} found`))}return x}function df(s,i){const o=s.key,u=s.style,p=s.styleSpec,x=s.value,w=s.objectKey,M=p[`${i}_${s.layerType}`];if(!M)return[];const P=w.match(/^(.*)-transition$/);if(i==="paint"&&P&&M[P[1]]&&M[P[1]].transition)return Sr({key:o,value:x,valueSpec:p.transition,style:u,styleSpec:p});const D=s.valueSpec||M[w];if(!D)return[new yi(o,x,`unknown property "${w}"`)];let V;if(Tn(x)==="string"&&Mc(D)&&!D.tokens&&(V=/^{([^}]+)}$/.exec(x))){const X=`\`{ "type": "identity", "property": ${V?JSON.stringify(V[1]):'"_"'} }\``;return[new yi(o,x,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${X}.`)]}const G=[];return s.layerType==="symbol"&&(w==="text-field"&&u&&!u.glyphs&&G.push(new yi(o,x,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Cc(ar(x))&&$s(x.type)==="identity"&&G.push(new yi(o,x,'"text-font" does not support identity functions'))),G.concat(Sr({key:s.key,value:x,valueSpec:D,style:u,styleSpec:p,expressionContext:"property",propertyType:i,propertyKey:w}))}function Yp(s){return df(s,"paint")}function Uu(s){return df(s,"layout")}function Kp(s){let i=[];const o=s.value,u=s.key,p=s.style,x=s.styleSpec;o.type||o.ref||i.push(new yi(u,o,'either "type" or "ref" is required'));let w=$s(o.type);const M=$s(o.ref);if(o.id){const P=$s(o.id);for(let D=0;D<s.arrayIndex;D++){const V=p.layers[D];$s(V.id)===P&&i.push(new yi(u,o.id,`duplicate layer id "${o.id}", previously used at line ${V.id.__line__}`))}}if("ref"in o){let P;["type","source","source-layer","filter","layout"].forEach(D=>{D in o&&i.push(new yi(u,o[D],`"${D}" is prohibited for ref layers`))}),p.layers.forEach(D=>{$s(D.id)===M&&(P=D)}),P?P.ref?i.push(new yi(u,o.ref,"ref cannot reference another ref layer")):w=$s(P.type):typeof M=="string"&&i.push(new yi(u,o.ref,`ref layer "${M}" not found`))}else if(w!=="background"&&w!=="sky")if(o.source){const P=p.sources&&p.sources[o.source],D=P&&$s(P.type);P?D==="vector"&&w==="raster"?i.push(new yi(u,o.source,`layer "${o.id}" requires a raster source`)):D==="raster"&&w!=="raster"?i.push(new yi(u,o.source,`layer "${o.id}" requires a vector source`)):D!=="vector"||o["source-layer"]?D==="raster-dem"&&w!=="hillshade"?i.push(new yi(u,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||D==="geojson"&&P.lineMetrics||i.push(new yi(u,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new yi(u,o,`layer "${o.id}" must specify a "source-layer"`)):i.push(new yi(u,o.source,`source "${o.source}" not found`))}else i.push(new yi(u,o,'missing required property "source"'));return i=i.concat(mo({key:u,value:o,valueSpec:x.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Sr({key:`${u}.type`,value:o.type,valueSpec:x.layer.type,style:s.style,styleSpec:s.styleSpec,object:o,objectKey:"type"}),filter:P=>Ph(oa({layerType:w},P)),layout:P=>mo({layer:o,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":D=>Uu(oa({layerType:w},D))}}),paint:P=>mo({layer:o,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":D=>Yp(oa({layerType:w},D))}})}})),i}function ul(s){const i=s.value,o=s.key,u=Tn(i);return u!=="string"?[new yi(o,i,`string expected, ${u} found`)]:[]}const ff={promoteId:function({key:s,value:i}){if(Tn(i)==="string")return ul({key:s,value:i});{const o=[];for(const u in i)o.push(...ul({key:`${s}.${u}`,value:i[u]}));return o}}};function pf(s){const i=s.value,o=s.key,u=s.styleSpec,p=s.style;if(!i.type)return[new yi(o,i,'"type" is required')];const x=$s(i.type);let w;switch(x){case"vector":case"raster":case"raster-dem":return w=mo({key:o,value:i,valueSpec:u[`source_${x.replace("-","_")}`],style:s.style,styleSpec:u,objectElementValidators:ff}),w;case"geojson":if(w=mo({key:o,value:i,valueSpec:u.source_geojson,style:p,styleSpec:u,objectElementValidators:ff}),i.cluster)for(const M in i.clusterProperties){const[P,D]=i.clusterProperties[M],V=typeof P=="string"?[P,["accumulated"],["get",M]]:P;w.push(...hr({key:`${o}.${M}.map`,value:D,expressionContext:"cluster-map"})),w.push(...hr({key:`${o}.${M}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return w;case"video":return mo({key:o,value:i,valueSpec:u.source_video,style:p,styleSpec:u});case"image":return mo({key:o,value:i,valueSpec:u.source_image,style:p,styleSpec:u});case"canvas":return[new yi(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return an({key:`${o}.type`,value:i.type,valueSpec:{values:da(u)}})}}function da(s){return s.source.reduce((i,o)=>{const u=s[o];return u.type.type==="enum"&&(i=i.concat(Object.keys(u.type.values))),i},[])}function Jp(s){const i=s.value,o=s.styleSpec,u=o.light,p=s.style;let x=[];const w=Tn(i);if(i===void 0)return x;if(w!=="object")return x=x.concat([new yi("light",i,`object expected, ${w} found`)]),x;for(const M in i){const P=M.match(/^(.*)-transition$/);x=x.concat(P&&u[P[1]]&&u[P[1]].transition?Sr({key:M,value:i[M],valueSpec:o.transition,style:p,styleSpec:o}):u[M]?Sr({key:M,value:i[M],valueSpec:u[M],style:p,styleSpec:o}):[new yi(M,i[M],`unknown property "${M}"`)])}return x}function mf(s){const i=s.value,o=s.key,u=s.style,p=s.styleSpec,x=p.terrain;let w=[];const M=Tn(i);if(i===void 0)return w;if(M!=="object")return w=w.concat([new yi("terrain",i,`object expected, ${M} found`)]),w;for(const P in i){const D=P.match(/^(.*)-transition$/);w=w.concat(D&&x[D[1]]&&x[D[1]].transition?Sr({key:P,value:i[P],valueSpec:p.transition,style:u,styleSpec:p}):x[P]?Sr({key:P,value:i[P],valueSpec:x[P],style:u,styleSpec:p}):[new yi(P,i[P],`unknown property "${P}"`)])}if(i.source){const P=u.sources&&u.sources[i.source],D=P&&$s(P.type);P?D!=="raster-dem"&&w.push(new yi(o,i.source,`terrain cannot be used with a source of type ${String(D)}, it only be used with a "raster-dem" source type`)):w.push(new yi(o,i.source,`source "${i.source}" not found`))}else w.push(new yi(o,i,'terrain is missing required property "source"'));return w}function Qp(s){const i=s.value,o=s.style,u=s.styleSpec,p=u.fog;let x=[];const w=Tn(i);if(i===void 0)return x;if(w!=="object")return x=x.concat([new yi("fog",i,`object expected, ${w} found`)]),x;for(const M in i){const P=M.match(/^(.*)-transition$/);x=x.concat(P&&p[P[1]]&&p[P[1]].transition?Sr({key:M,value:i[M],valueSpec:u.transition,style:o,styleSpec:u}):p[M]?Sr({key:M,value:i[M],valueSpec:p[M],style:o,styleSpec:u}):[new yi(M,i[M],`unknown property "${M}"`)])}return x}const gf={"*":()=>[],array:Ui,boolean:function(s){const i=s.value,o=s.key,u=Tn(i);return u!=="boolean"?[new yi(o,i,`boolean expected, ${u} found`)]:[]},number:Pc,color:function(s){const i=s.key,o=s.value,u=Tn(o);return u!=="string"?[new yi(i,o,`color expected, ${u} found`)]:Wd(o)===null?[new yi(i,o,`color expected, "${o}" found`)]:[]},enum:an,filter:Ph,function:ll,layer:Kp,object:mo,source:pf,light:Jp,terrain:mf,fog:Qp,string:ul,formatted:function(s){return ul(s).length===0?[]:hr(s)},resolvedImage:function(s){return ul(s).length===0?[]:hr(s)},projection:function(s){const i=s.value,o=s.styleSpec,u=o.projection,p=s.style;let x=[];const w=Tn(i);if(w==="object")for(const M in i)x=x.concat(Sr({key:M,value:i[M],valueSpec:u[M],style:p,styleSpec:o}));else w!=="string"&&(x=x.concat([new yi("projection",i,`object or string expected, ${w} found`)]));return x}};function Sr(s){const i=s.value,o=s.valueSpec,u=s.styleSpec;return o.expression&&Cc($s(i))?ll(s):o.expression&&On(ar(i))?hr(s):o.type&&gf[o.type]?gf[o.type](s):mo(oa({},s,{valueSpec:o.type?u[o.type]:o}))}function Ng(s){const i=s.value,o=s.key,u=ul(s);return u.length||(i.indexOf("{fontstack}")===-1&&u.push(new yi(o,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&u.push(new yi(o,i,'"glyphs" url must include a "{range}" token'))),u}function Dh(s,i=Ct){return go(Sr({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,objectElementValidators:{glyphs:Ng,"*":()=>[]}}))}const Ug=s=>go(Yp(s)),em=s=>go(Uu(s));function go(s){return s.slice().sort((i,o)=>i.line&&o.line?i.line-o.line:0)}function tm(s,i){let o=!1;if(i&&i.length)for(const u of i)s.fire(new Ia(new Error(u.message))),o=!0;return o}var im=fa,jo=3;function fa(s,i,o){var u=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var p=new Int32Array(this.arrayBuffer);s=p[0],this.d=(i=p[1])+2*(o=p[2]);for(var x=0;x<this.d*this.d;x++){var w=p[jo+x],M=p[jo+x+1];u.push(w===M?null:p.subarray(w,M))}var P=p[jo+u.length+1];this.keys=p.subarray(p[jo+u.length],P),this.bboxes=p.subarray(P),this.insert=this._insertReadonly}else{this.d=i+2*o;for(var D=0;D<this.d*this.d;D++)u.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=s,this.padding=o,this.scale=i/s,this.uid=0;var V=o/i*s;this.min=-V,this.max=s+V}fa.prototype.insert=function(s,i,o,u,p){this._forEachCell(i,o,u,p,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(p)},fa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fa.prototype._insertCell=function(s,i,o,u,p,x){this.cells[p].push(x)},fa.prototype.query=function(s,i,o,u,p){var x=this.min,w=this.max;if(s<=x&&i<=x&&w<=o&&w<=u&&!p)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(s,i,o,u,this._queryCell,M,{},p),M},fa.prototype._queryCell=function(s,i,o,u,p,x,w,M){var P=this.cells[p];if(P!==null)for(var D=this.keys,V=this.bboxes,G=0;G<P.length;G++){var X=P[G];if(w[X]===void 0){var J=4*X;(M?M(V[J+0],V[J+1],V[J+2],V[J+3]):s<=V[J+2]&&i<=V[J+3]&&o>=V[J+0]&&u>=V[J+1])?(w[X]=!0,x.push(D[X])):w[X]=!1}}},fa.prototype._forEachCell=function(s,i,o,u,p,x,w,M){for(var P=this._convertToCellCoord(s),D=this._convertToCellCoord(i),V=this._convertToCellCoord(o),G=this._convertToCellCoord(u),X=P;X<=V;X++)for(var J=D;J<=G;J++){var Q=this.d*J+X;if((!M||M(this._convertFromCellCoord(X),this._convertFromCellCoord(J),this._convertFromCellCoord(X+1),this._convertFromCellCoord(J+1)))&&p.call(this,s,i,o,u,Q,x,w,M))return}},fa.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},fa.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},fa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,i=jo+this.cells.length+1+1,o=0,u=0;u<this.cells.length;u++)o+=this.cells[u].length;var p=new Int32Array(i+o+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var x=i,w=0;w<s.length;w++){var M=s[w];p[jo+w]=x,p.set(M,x),x+=M.length}return p[jo+s.length]=x,p.set(this.keys,x),p[jo+s.length+1]=x+=this.keys.length,p.set(this.bboxes,x),x+=this.bboxes.length,p.buffer};var Ul=he(im);const Ua={};function bi(s,i,o={}){Object.defineProperty(s,"_classRegistryKey",{value:i,writeable:!1}),Ua[i]={klass:s,omit:o.omit||[]}}bi(Object,"Object"),Ul.serialize=function(s,i){const o=s.toArrayBuffer();return i&&i.push(o),{buffer:o}},Ul.deserialize=function(s){return new Ul(s.buffer)},Object.defineProperty(Ul,"name",{value:"Grid"}),bi(Ul,"Grid"),bi(Os,"Color"),bi(Error,"Error"),bi(Oo,"AJAXError"),bi(Or,"ResolvedImage"),bi(is,"StylePropertyFunction"),bi(Er,"StyleExpression",{omit:["_evaluator"]}),bi(Fl,"ZoomDependentExpression"),bi(Ru,"ZoomConstantExpression"),bi(ha,"CompoundExpression",{omit:["_evaluate"]});for(const s in Ch)Ua[Ch[s]._classRegistryKey]||bi(Ch[s],`Expression${s}`);function _f(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function yf(s){return C.ImageBitmap&&s instanceof C.ImageBitmap}function Vl(s,i){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(_f(s)||yf(s))return i&&i.push(s),s;if(ArrayBuffer.isView(s)){const o=s;return i&&i.push(o.buffer),o}if(s instanceof C.ImageData)return i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const o=[];for(const u of s)o.push(Vl(u,i));return o}if(typeof s=="object"){const o=s.constructor,u=o._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const p=o.serialize?o.serialize(s,i):{};if(!o.serialize){for(const x in s)s.hasOwnProperty(x)&&(Ua[u].omit.indexOf(x)>=0||(p[x]=Vl(s[x],i)));s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof s)}function dl(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||_f(s)||yf(s)||ArrayBuffer.isView(s)||s instanceof C.ImageData)return s;if(Array.isArray(s))return s.map(dl);if(typeof s=="object"){const i=s.$name||"Object",{klass:o}=Ua[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(s);const u=Object.create(o.prototype);for(const p of Object.keys(s))p!=="$name"&&(u[p]=dl(s[p]));return u}throw new Error("can't deserialize object of type "+typeof s)}const pi={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function xf(s){for(const i of s)if(vf(i.charCodeAt(0)))return!0;return!1}function Vg(s){for(const i of s)if(!Vu(i.charCodeAt(0)))return!1;return!0}function Vu(s){return!(pi.Arabic(s)||pi["Arabic Supplement"](s)||pi["Arabic Extended-A"](s)||pi["Arabic Presentation Forms-A"](s)||pi["Arabic Presentation Forms-B"](s))}function vf(s){return!(s!==746&&s!==747&&(s<4352||!(pi["Bopomofo Extended"](s)||pi.Bopomofo(s)||pi["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||pi["CJK Compatibility Ideographs"](s)||pi["CJK Compatibility"](s)||pi["CJK Radicals Supplement"](s)||pi["CJK Strokes"](s)||!(!pi["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||pi["CJK Unified Ideographs Extension A"](s)||pi["CJK Unified Ideographs"](s)||pi["Enclosed CJK Letters and Months"](s)||pi["Hangul Compatibility Jamo"](s)||pi["Hangul Jamo Extended-A"](s)||pi["Hangul Jamo Extended-B"](s)||pi["Hangul Jamo"](s)||pi["Hangul Syllables"](s)||pi.Hiragana(s)||pi["Ideographic Description Characters"](s)||pi.Kanbun(s)||pi["Kangxi Radicals"](s)||pi["Katakana Phonetic Extensions"](s)||pi.Katakana(s)&&s!==12540||!(!pi["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!pi["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||pi["Unified Canadian Aboriginal Syllabics"](s)||pi["Unified Canadian Aboriginal Syllabics Extended"](s)||pi["Vertical Forms"](s)||pi["Yijing Hexagram Symbols"](s)||pi["Yi Syllables"](s)||pi["Yi Radicals"](s))))}function jl(s){return!(vf(s)||function(i){return!!(pi["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||pi["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||pi["Letterlike Symbols"](i)||pi["Number Forms"](i)||pi["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||pi["Control Pictures"](i)&&i!==9251||pi["Optical Character Recognition"](i)||pi["Enclosed Alphanumerics"](i)||pi["Geometric Shapes"](i)||pi["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||pi["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||pi["CJK Symbols and Punctuation"](i)||pi.Katakana(i)||pi["Private Use Area"](i)||pi["CJK Compatibility Forms"](i)||pi["Small Form Variants"](i)||pi["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(s))}function nm(s){return s>=1424&&s<=2303||pi["Arabic Presentation Forms-A"](s)||pi["Arabic Presentation Forms-B"](s)}function bf(s,i){return!(!i&&nm(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||pi.Khmer(s))}function jg(s){for(const i of s)if(nm(i.charCodeAt(0)))return!0;return!1}const Oh="deferred",ju="loading",wf="loaded";let Rc=null,_="unavailable",a=null;const f=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(_="error"),Rc&&Rc(s)};function v(){S.fire(new ra("pluginStateChange",{pluginStatus:_,pluginURL:a}))}const S=new Yn,A=function(){return _},R=function(){if(_!==Oh||!a)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_=ju,v(),a&&pr({url:a},s=>{s?f(s):(_=wf,v())})},z={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_===wf||z.applyArabicShaping!=null,isLoading:()=>_===ju,setState(s){_=s.pluginStatus,a=s.pluginURL},isParsed:()=>z.applyArabicShaping!=null&&z.processBidirectionalText!=null&&z.processStyledBidirectionalText!=null,getPluginURL:()=>a};class j{constructor(i,o){this.zoom=i,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(i){return function(o,u){for(const p of o)if(!bf(p.charCodeAt(0),u))return!1;return!0}(i,z.isLoaded())}}class Z{constructor(i,o){this.property=i,this.value=o,this.expression=function(u,p){if(Cc(u))return new is(u,p);if(On(u)){const x=al(u,p);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=u;return typeof u=="string"&&p.type==="color"&&(x=Os.parse(u)),{kind:"constant",evaluate:()=>x}}}(o===void 0?i.specification.default:o,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,o,u){return this.property.possiblyEvaluate(this,i,o,u)}}class Y{constructor(i){this.property=i,this.value=new Z(i,void 0)}transitioned(i,o){return new ge(this.property,this.value,o,Hi({},i.transition,this.transition),i.now)}untransitioned(){return new ge(this.property,this.value,null,{},0)}}class ne{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Ce(this._values[i].value.value)}setValue(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new Y(this._values[i].property)),this._values[i].value=new Z(this._values[i].property,o===null?void 0:Ce(o))}getTransition(i){return Ce(this._values[i].transition)}setTransition(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new Y(this._values[i].property)),this._values[i].transition=Ce(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(i[o]=u);const p=this.getTransition(o);p!==void 0&&(i[`${o}-transition`]=p)}return i}transitioned(i,o){const u=new Te(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(i,o._values[p]);return u}untransitioned(){const i=new Te(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class ge{constructor(i,o,u,p,x){const w=p.delay||0,M=p.duration||0;x=x||0,this.property=i,this.value=o,this.begin=x+w,this.end=this.begin+M,i.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(i,o,u){const p=i.now||0,x=this.value.possiblyEvaluate(i,o,u),w=this.prior;if(w){if(p>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(p<this.begin)return w.possiblyEvaluate(i,o,u);{const M=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(i,o,u),x,St(M))}}return x}}class Te{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,u){const p=new ke(this._properties);for(const x of Object.keys(this._values))p._values[x]=this._values[x].possiblyEvaluate(i,o,u);return p}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Ae{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Ce(this._values[i].value)}setValue(i,o){this._values[i]=new Z(this._values[i].property,o===null?void 0:Ce(o))}serialize(){const i={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(i[o]=u)}return i}possiblyEvaluate(i,o,u){const p=new ke(this._properties);for(const x of Object.keys(this._values))p._values[x]=this._values[x].possiblyEvaluate(i,o,u);return p}}class Se{constructor(i,o,u){this.property=i,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,u,p){return this.property.evaluate(this.value,this.parameters,i,o,u,p)}}class ke{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class re{constructor(i){this.specification=i}possiblyEvaluate(i,o){return i.expression.evaluate(o)}interpolate(i,o,u){const p=ua[this.specification.type];return p?p(i,o,u):i}}class we{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,u,p){return new Se(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},u,p)}:i.expression,o)}interpolate(i,o,u){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new Se(this,{kind:"constant",value:void 0},i.parameters);const p=ua[this.specification.type];return p?new Se(this,{kind:"constant",value:p(i.value.value,o.value.value,u)},i.parameters):i}evaluate(i,o,u,p,x,w){return i.kind==="constant"?i.value:i.evaluate(o,u,p,x,w)}}class De{constructor(i){this.specification=i}possiblyEvaluate(i,o,u,p){return!!i.expression.evaluate(o,null,{},u,p)}interpolate(){return!1}}class Re{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new j(0,{});for(const u in i){const p=i[u];p.specification.overridable&&this.overridableProperties.push(u);const x=this.defaultPropertyValues[u]=new Z(p,void 0),w=this.defaultTransitionablePropertyValues[u]=new Y(p);this.defaultTransitioningPropertyValues[u]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=x.possiblyEvaluate(o)}}}function Ye(s,i){return 256*(s=ci(Math.floor(s),0,255))+ci(Math.floor(i),0,255)}bi(we,"DataDrivenProperty"),bi(re,"DataConstantProperty"),bi(De,"ColorRampProperty");const We={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ke{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class lt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ot(s,i=1){let o=0,u=0;return{members:s.map(p=>{const x=We[p.type].BYTES_PER_ELEMENT,w=o=_t(o,Math.max(i,x)),M=p.components||1;return u=Math.max(u,x),o+=x*M,{name:p.name,type:p.type,components:M,offset:w}}),size:_t(o,Math.max(u,i)),alignment:i}}function _t(s,i){return Math.ceil(s/i)*i}class Wt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const u=this.length;return this.resize(u+1),this.emplace(u,i,o)}emplace(i,o,u){const p=2*i;return this.int16[p+0]=o,this.int16[p+1]=u,i}}Wt.prototype.bytesPerElement=4,bi(Wt,"StructArrayLayout2i4");class pt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,i,o,u)}emplace(i,o,u,p){const x=3*i;return this.int16[x+0]=o,this.int16[x+1]=u,this.int16[x+2]=p,i}}pt.prototype.bytesPerElement=6,bi(pt,"StructArrayLayout3i6");class Lt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,u,p)}emplace(i,o,u,p,x){const w=4*i;return this.int16[w+0]=o,this.int16[w+1]=u,this.int16[w+2]=p,this.int16[w+3]=x,i}}Lt.prototype.bytesPerElement=8,bi(Lt,"StructArrayLayout4i8");class wt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w,M){const P=this.length;return this.resize(P+1),this.emplace(P,i,o,u,p,x,w,M)}emplace(i,o,u,p,x,w,M,P){const D=6*i,V=12*i,G=3*i;return this.int16[D+0]=o,this.int16[D+1]=u,this.uint8[V+4]=p,this.uint8[V+5]=x,this.uint8[V+6]=w,this.uint8[V+7]=M,this.float32[G+2]=P,i}}wt.prototype.bytesPerElement=12,bi(wt,"StructArrayLayout2i4ub1f12");class qt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,u,p)}emplace(i,o,u,p,x){const w=4*i;return this.float32[w+0]=o,this.float32[w+1]=u,this.float32[w+2]=p,this.float32[w+3]=x,i}}qt.prototype.bytesPerElement=16,bi(qt,"StructArrayLayout4f16");class dt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,u,p,x)}emplace(i,o,u,p,x,w){const M=6*i,P=3*i;return this.uint16[M+0]=o,this.uint16[M+1]=u,this.uint16[M+2]=p,this.uint16[M+3]=x,this.float32[P+2]=w,i}}dt.prototype.bytesPerElement=12,bi(dt,"StructArrayLayout4ui1f12");class Ot extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,u,p)}emplace(i,o,u,p,x){const w=4*i;return this.uint16[w+0]=o,this.uint16[w+1]=u,this.uint16[w+2]=p,this.uint16[w+3]=x,i}}Ot.prototype.bytesPerElement=8,bi(Ot,"StructArrayLayout4ui8");class Xt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w){const M=this.length;return this.resize(M+1),this.emplace(M,i,o,u,p,x,w)}emplace(i,o,u,p,x,w,M){const P=6*i;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=p,this.int16[P+3]=x,this.int16[P+4]=w,this.int16[P+5]=M,i}}Xt.prototype.bytesPerElement=12,bi(Xt,"StructArrayLayout6i12");class kt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w,M,P,D,V,G,X){const J=this.length;return this.resize(J+1),this.emplace(J,i,o,u,p,x,w,M,P,D,V,G,X)}emplace(i,o,u,p,x,w,M,P,D,V,G,X,J){const Q=12*i;return this.int16[Q+0]=o,this.int16[Q+1]=u,this.int16[Q+2]=p,this.int16[Q+3]=x,this.uint16[Q+4]=w,this.uint16[Q+5]=M,this.uint16[Q+6]=P,this.uint16[Q+7]=D,this.int16[Q+8]=V,this.int16[Q+9]=G,this.int16[Q+10]=X,this.int16[Q+11]=J,i}}kt.prototype.bytesPerElement=24,bi(kt,"StructArrayLayout4i4ui4i24");class Jt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w){const M=this.length;return this.resize(M+1),this.emplace(M,i,o,u,p,x,w)}emplace(i,o,u,p,x,w,M){const P=10*i,D=5*i;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=p,this.float32[D+2]=x,this.float32[D+3]=w,this.float32[D+4]=M,i}}Jt.prototype.bytesPerElement=20,bi(Jt,"StructArrayLayout3i3f20");class Pi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}Pi.prototype.bytesPerElement=4,bi(Pi,"StructArrayLayout1ul4");class $i extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w,M,P,D,V,G,X,J){const Q=this.length;return this.resize(Q+1),this.emplace(Q,i,o,u,p,x,w,M,P,D,V,G,X,J)}emplace(i,o,u,p,x,w,M,P,D,V,G,X,J,Q){const ae=20*i,_e=10*i;return this.int16[ae+0]=o,this.int16[ae+1]=u,this.int16[ae+2]=p,this.int16[ae+3]=x,this.int16[ae+4]=w,this.float32[_e+3]=M,this.float32[_e+4]=P,this.float32[_e+5]=D,this.float32[_e+6]=V,this.int16[ae+14]=G,this.uint32[_e+8]=X,this.uint16[ae+18]=J,this.uint16[ae+19]=Q,i}}$i.prototype.bytesPerElement=40,bi($i,"StructArrayLayout5i4f1i1ul2ui40");class wi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w,M){const P=this.length;return this.resize(P+1),this.emplace(P,i,o,u,p,x,w,M)}emplace(i,o,u,p,x,w,M,P){const D=8*i;return this.int16[D+0]=o,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+4]=x,this.int16[D+5]=w,this.int16[D+6]=M,this.int16[D+7]=P,i}}wi.prototype.bytesPerElement=16,bi(wi,"StructArrayLayout3i2i2i16");class Li extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,u,p,x)}emplace(i,o,u,p,x,w){const M=4*i,P=8*i;return this.float32[M+0]=o,this.float32[M+1]=u,this.float32[M+2]=p,this.int16[P+6]=x,this.int16[P+7]=w,i}}Li.prototype.bytesPerElement=16,bi(Li,"StructArrayLayout2f1f2i16");class Zi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,u,p)}emplace(i,o,u,p,x){const w=12*i,M=3*i;return this.uint8[w+0]=o,this.uint8[w+1]=u,this.float32[M+1]=p,this.float32[M+2]=x,i}}Zi.prototype.bytesPerElement=12,bi(Zi,"StructArrayLayout2ub2f12");class Yi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,i,o,u)}emplace(i,o,u,p){const x=3*i;return this.float32[x+0]=o,this.float32[x+1]=u,this.float32[x+2]=p,i}}Yi.prototype.bytesPerElement=12,bi(Yi,"StructArrayLayout3f12");class Ci extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,i,o,u)}emplace(i,o,u,p){const x=3*i;return this.uint16[x+0]=o,this.uint16[x+1]=u,this.uint16[x+2]=p,i}}Ci.prototype.bytesPerElement=6,bi(Ci,"StructArrayLayout3ui6");class Rn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e,Pe,je,Le,Ve,He){const $e=this.length;return this.resize($e+1),this.emplace($e,i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e,Pe,je,Le,Ve,He)}emplace(i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e,Pe,je,Le,Ve,He,$e){const bt=30*i,gt=15*i,It=60*i;return this.int16[bt+0]=o,this.int16[bt+1]=u,this.int16[bt+2]=p,this.float32[gt+2]=x,this.float32[gt+3]=w,this.uint16[bt+8]=M,this.uint16[bt+9]=P,this.uint32[gt+5]=D,this.uint32[gt+6]=V,this.uint32[gt+7]=G,this.uint16[bt+16]=X,this.uint16[bt+17]=J,this.uint16[bt+18]=Q,this.float32[gt+10]=ae,this.float32[gt+11]=_e,this.uint8[It+48]=Pe,this.uint8[It+49]=je,this.uint8[It+50]=Le,this.uint32[gt+13]=Ve,this.int16[bt+28]=He,this.uint8[It+58]=$e,i}}Rn.prototype.bytesPerElement=60,bi(Rn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Un extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e,Pe,je,Le,Ve,He,$e,bt,gt,It,Qt,Et,Nt,Ut,Gt){const si=this.length;return this.resize(si+1),this.emplace(si,i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e,Pe,je,Le,Ve,He,$e,bt,gt,It,Qt,Et,Nt,Ut,Gt)}emplace(i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e,Pe,je,Le,Ve,He,$e,bt,gt,It,Qt,Et,Nt,Ut,Gt,si){const At=38*i,fi=19*i;return this.int16[At+0]=o,this.int16[At+1]=u,this.int16[At+2]=p,this.float32[fi+2]=x,this.float32[fi+3]=w,this.int16[At+8]=M,this.int16[At+9]=P,this.int16[At+10]=D,this.int16[At+11]=V,this.int16[At+12]=G,this.int16[At+13]=X,this.uint16[At+14]=J,this.uint16[At+15]=Q,this.uint16[At+16]=ae,this.uint16[At+17]=_e,this.uint16[At+18]=Pe,this.uint16[At+19]=je,this.uint16[At+20]=Le,this.uint16[At+21]=Ve,this.uint16[At+22]=He,this.uint16[At+23]=$e,this.uint16[At+24]=bt,this.uint16[At+25]=gt,this.uint16[At+26]=It,this.uint16[At+27]=Qt,this.uint16[At+28]=Et,this.uint32[fi+15]=Nt,this.float32[fi+16]=Ut,this.float32[fi+17]=Gt,this.float32[fi+18]=si,i}}Un.prototype.bytesPerElement=76,bi(Un,"StructArrayLayout3i2f6i15ui1ul3f76");class Vn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}Vn.prototype.bytesPerElement=4,bi(Vn,"StructArrayLayout1f4");class jn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,x){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,u,p,x)}emplace(i,o,u,p,x,w){const M=5*i;return this.float32[M+0]=o,this.float32[M+1]=u,this.float32[M+2]=p,this.float32[M+3]=x,this.float32[M+4]=w,i}}jn.prototype.bytesPerElement=20,bi(jn,"StructArrayLayout5f20");class Mr extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,u,p)}emplace(i,o,u,p,x){const w=6*i;return this.uint32[3*i+0]=o,this.uint16[w+2]=u,this.uint16[w+3]=p,this.uint16[w+4]=x,i}}Mr.prototype.bytesPerElement=12,bi(Mr,"StructArrayLayout1ul3ui12");class ur extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const u=this.length;return this.resize(u+1),this.emplace(u,i,o)}emplace(i,o,u){const p=2*i;return this.uint16[p+0]=o,this.uint16[p+1]=u,i}}ur.prototype.bytesPerElement=4,bi(ur,"StructArrayLayout2ui4");class _o extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}_o.prototype.bytesPerElement=2,bi(_o,"StructArrayLayout1ui2");class Bn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const u=this.length;return this.resize(u+1),this.emplace(u,i,o)}emplace(i,o,u){const p=2*i;return this.float32[p+0]=o,this.float32[p+1]=u,i}}Bn.prototype.bytesPerElement=8,bi(Bn,"StructArrayLayout2f8");class ns extends Ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ns.prototype.size=40;class Xn extends $i{get(i){return new ns(this,i)}}bi(Xn,"CollisionBoxArray");class yn extends Ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}yn.prototype.size=60;class Ws extends Rn{get(i){return new yn(this,i)}}bi(Ws,"PlacedSymbolArray");class Rr extends Ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Rr.prototype.size=76;class ss extends Un{get(i){return new Rr(this,i)}}bi(ss,"SymbolInstanceArray");class Qs extends Vn{getoffsetX(i){return this.float32[1*i+0]}}bi(Qs,"GlyphOffsetArray");class $u extends Wt{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}bi($u,"SymbolLineVertexArray");class Va extends Ke{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Va.prototype.size=12;class zc extends Mr{get(i){return new Va(this,i)}}bi(zc,"FeatureIndexArray");class pa extends ur{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}bi(pa,"FillExtrusionCentroidArray");const ja=ot([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),$l=ot([{name:"a_dash",components:4,type:"Uint16"}]);var Is={exports:{}},Rh={exports:{}};Rh.exports=function(s,i){var o,u,p,x,w,M,P,D;for(u=s.length-(o=3&s.length),p=i,w=3432918353,M=461845907,D=0;D<u;)P=255&s.charCodeAt(D)|(255&s.charCodeAt(++D))<<8|(255&s.charCodeAt(++D))<<16|(255&s.charCodeAt(++D))<<24,++D,p=27492+(65535&(x=5*(65535&(p=(p^=P=(65535&(P=(P=(65535&P)*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*M+(((P>>>16)*M&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(P=0,o){case 3:P^=(255&s.charCodeAt(D+2))<<16;case 2:P^=(255&s.charCodeAt(D+1))<<8;case 1:p^=P=(65535&(P=(P=(65535&(P^=255&s.charCodeAt(D)))*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*M+(((P>>>16)*M&65535)<<16)&4294967295}return p^=s.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Tf=Rh.exports,$g={exports:{}};$g.exports=function(s,i){for(var o,u=s.length,p=i^u,x=0;u>=4;)o=1540483477*(65535&(o=255&s.charCodeAt(x)|(255&s.charCodeAt(++x))<<8|(255&s.charCodeAt(++x))<<16|(255&s.charCodeAt(++x))<<24))+((1540483477*(o>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),u-=4,++x;switch(u){case 3:p^=(255&s.charCodeAt(x+2))<<16;case 2:p^=(255&s.charCodeAt(x+1))<<8;case 1:p=1540483477*(65535&(p^=255&s.charCodeAt(x)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var Ef=Tf,Wu=$g.exports;Is.exports=Ef,Is.exports.murmur3=Ef,Is.exports.murmur2=Wu;var Wg=he(Is.exports);class Ts{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,o,u,p){this.ids.push(qy(i)),this.positions.push(o,u,p)}getPositions(i){const o=qy(i);let u=0,p=this.ids.length-1;for(;u<p;){const w=u+p>>1;this.ids[w]>=o?p=w:u=w+1}const x=[];for(;this.ids[u]===o;)x.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return x}static serialize(i,o){const u=new Float64Array(i.ids),p=new Uint32Array(i.positions);return sm(u,p,0,u.length-1),o&&o.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(i){const o=new Ts;return o.ids=i.ids,o.positions=i.positions,o.indexed=!0,o}}function qy(s){const i=+s;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Wg(String(s))}function sm(s,i,o,u){for(;o<u;){const p=s[o+u>>1];let x=o-1,w=u+1;for(;;){do x++;while(s[x]<p);do w--;while(s[w]>p);if(x>=w)break;Sf(s,x,w),Sf(i,3*x,3*w),Sf(i,3*x+1,3*w+1),Sf(i,3*x+2,3*w+2)}w-o<u-w?(sm(s,i,o,w),o=w+1):(sm(s,i,w+1,u),u=w)}}function Sf(s,i,o){const u=s[i];s[i]=s[o],s[o]=u}bi(Ts,"FeaturePositionMap");class fl{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,o),this.initialized=!0),!!this.location}}class Js extends fl{constructor(i){super(i),this.current=0}set(i,o,u){this.fetchUniformLocation(i,o)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Xy extends fl{constructor(i){super(i),this.current=[0,0,0,0]}set(i,o,u){this.fetchUniformLocation(i,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Gu extends fl{constructor(i){super(i),this.current=Os.transparent}set(i,o,u){this.fetchUniformLocation(i,o)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Gg=new Float32Array(16),Rs=new Float32Array(9),sb=new Float32Array(4);function rm(s){return[Ye(255*s.r,255*s.g),Ye(255*s.b,255*s.a)]}class no{constructor(i,o,u){this.value=i,this.uniformNames=o.map(p=>`u_${p}`),this.type=u}setUniform(i,o,u,p,x){o.set(i,x,p.constantOr(this.value))}getBinding(i,o){return this.type==="color"?new Gu(i):new Js(i)}}class Cr{constructor(i,o){this.uniformNames=o.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,o,u,p,x){const w=x==="u_pattern"||x==="u_dash"?this.pattern:x==="u_pixel_ratio"?this.pixelRatio:null;w&&o.set(i,x,w)}getBinding(i,o){return o==="u_pattern"||o==="u_dash"?new Xy(i):new Js(i)}}class Wl{constructor(i,o,u,p){this.expression=i,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(x=>({name:`a_${x}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(i,o,u,p,x,w){const M=this.paintVertexArray.length,P=this.expression.evaluate(new j(0),o,{},x,p,w);this.paintVertexArray.resize(i),this._setPaintValue(M,i,P)}updatePaintArray(i,o,u,p,x){const w=this.expression.evaluate({zoom:0},u,p,void 0,x);this._setPaintValue(i,o,w)}_setPaintValue(i,o,u){if(this.type==="color"){const p=rm(u);for(let x=i;x<o;x++)this.paintVertexArray.emplace(x,p[0],p[1])}else{for(let p=i;p<o;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $a{constructor(i,o,u,p,x,w){this.expression=i,this.uniformNames=o.map(M=>`u_${M}_t`),this.type=u,this.useIntegerZoom=p,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=o.map(M=>({name:`a_${M}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(i,o,u,p,x,w){const M=this.expression.evaluate(new j(this.zoom),o,{},x,p,w),P=this.expression.evaluate(new j(this.zoom+1),o,{},x,p,w),D=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(D,i,M,P)}updatePaintArray(i,o,u,p,x){const w=this.expression.evaluate({zoom:this.zoom},u,p,void 0,x),M=this.expression.evaluate({zoom:this.zoom+1},u,p,void 0,x);this._setPaintValue(i,o,w,M)}_setPaintValue(i,o,u,p){if(this.type==="color"){const x=rm(u),w=rm(p);for(let M=i;M<o;M++)this.paintVertexArray.emplace(M,x[0],x[1],w[0],w[1])}else{for(let x=i;x<o;x++)this.paintVertexArray.emplace(x,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o,u,p,x){const w=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,M=ci(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);o.set(i,x,M)}getBinding(i,o){return new Js(i)}}class Gl{constructor(i,o,u,p,x){this.expression=i,this.layerId=x,this.paintVertexAttributes=(u==="array"?$l:ja).members;for(let w=0;w<o.length;++w);this.paintVertexArray=new p}populatePaintArray(i,o,u){const p=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(p,i,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(i,o,u,p,x,w){this._setPaintValues(i,o,u.patterns&&u.patterns[this.layerId],w)}_setPaintValues(i,o,u,p){if(!p||!u)return;const x=p[u];if(!x)return;const{tl:w,br:M,pixelRatio:P}=x;for(let D=i;D<o;D++)this.paintVertexArray.emplace(D,w[0],w[1],M[0],M[1],P)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bc{constructor(i,o,u=()=>!0){this.binders={},this._buffers=[];const p=[];for(const x in i.paint._values){if(!u(x))continue;const w=i.paint.get(x);if(!(w instanceof Se&&Mc(w.property.specification)))continue;const M=ob(x,i.type),P=w.value,D=w.property.specification.type,V=!!w.property.useIntegerZoom,G=x==="line-dasharray"||x.endsWith("pattern"),X=x==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||X)if(P.kind==="source"||X||G){const J=Zy(x,D,"source");this.binders[x]=G?new Gl(P,M,D,J,i.id):new Wl(P,M,D,J),p.push(`/a_${x}`)}else{const J=Zy(x,D,"composite");this.binders[x]=new $a(P,M,D,V,o,J),p.push(`/z_${x}`)}else this.binders[x]=G?new Cr(P.value,M):new no(P.value,M,D),p.push(`/u_${x}`)}this.cacheKey=p.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof Wl||o instanceof $a?o.maxValue:0}populatePaintArrays(i,o,u,p,x,w){for(const M in this.binders){const P=this.binders[M];(P instanceof Wl||P instanceof $a||P instanceof Gl)&&P.populatePaintArray(i,o,u,p,x,w)}}setConstantPatternPositions(i){for(const o in this.binders){const u=this.binders[o];u instanceof Cr&&u.setConstantPatternPositions(i)}}updatePaintArrays(i,o,u,p,x,w){let M=!1;for(const P in i){const D=o.getPositions(P);for(const V of D){const G=u.feature(V.index);for(const X in this.binders){const J=this.binders[X];if((J instanceof Wl||J instanceof $a||J instanceof Gl)&&J.expression.isStateDependent===!0){const Q=p.paint.get(X);J.expression=Q.value,J.updatePaintArray(V.start,V.end,G,i[P],x,w),M=!0}}}}return M}defines(){const i=[];for(const o in this.binders){const u=this.binders[o];(u instanceof no||u instanceof Cr)&&i.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Wl||u instanceof $a||u instanceof Gl)for(let p=0;p<u.paintVertexAttributes.length;p++)i.push(u.paintVertexAttributes[p].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof no||u instanceof Cr||u instanceof $a)for(const p of u.uniformNames)i.push(p)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const o=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof no||p instanceof Cr||p instanceof $a)for(const x of p.uniformNames)o.push({name:x,property:u,binding:p.getBinding(i,x)})}return o}setUniforms(i,o,u,p,x){for(const{name:w,property:M,binding:P}of u)this.binders[M].setUniform(i,P,x,p.get(M),w)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const o=this.binders[i];(o instanceof Wl||o instanceof $a||o instanceof Gl)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(i){for(const o in this.binders){const u=this.binders[o];(u instanceof Wl||u instanceof $a||u instanceof Gl)&&u.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof Wl||o instanceof $a||o instanceof Gl)&&o.destroy()}}}class Fc{constructor(i,o,u=()=>!0){this.programConfigurations={};for(const p of i)this.programConfigurations[p.id]=new Bc(p,o,u);this.needsUpload=!1,this._featureMap=new Ts,this._bufferOffset=0}populatePaintArrays(i,o,u,p,x,w,M){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(i,o,p,x,w,M);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,u,p,x){for(const w of u)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(i,this._featureMap,o,w,p,x)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const rb={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function ob(s,i){return rb[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}const om={"line-pattern":{source:dt,composite:dt},"fill-pattern":{source:dt,composite:dt},"fill-extrusion-pattern":{source:dt,composite:dt},"line-dasharray":{source:Ot,composite:Ot}},ab={color:{source:Bn,composite:qt},number:{source:Vn,composite:Bn}};function Zy(s,i,o){const u=om[s];return u&&u[o]||ab[i][o]}bi(no,"ConstantBinder"),bi(Cr,"PatternConstantBinder"),bi(Wl,"SourceExpressionBinder"),bi(Gl,"PatternCompositeBinder"),bi($a,"CompositeExpressionBinder"),bi(Bc,"ProgramConfiguration",{omit:["_buffers"]}),bi(Fc,"ProgramConfigurationSet");const am="-transition";class Wa extends Yn{constructor(i,o){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&i.type!=="sky"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),o.layout&&(this._unevaluatedLayout=new Ae(o.layout)),o.paint)){this._transitionablePaint=new ne(o.paint);for(const u in i.paint)this.setPaintProperty(u,i.paint[u],{validate:!1});for(const u in i.layout)this.setLayoutProperty(u,i.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ke(o.paint)}}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,o,u={}){o!=null&&this._validate(em,`layers.${this.id}.layout.${i}`,i,o,u)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,o):this.visibility=o)}getPaintProperty(i){return ki(i,am)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o,u={}){if(o!=null&&this._validate(Ug,`layers.${this.id}.paint.${i}`,i,o,u))return!1;if(ki(i,am))return this._transitionablePaint.setTransition(i.slice(0,-11),o||void 0),!1;{const p=this._transitionablePaint._values[i],x=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(i,o),this._handleSpecialPaintPropertyUpdate(i);const M=this._transitionablePaint._values[i].value,P=M.isDataDriven(),D=ki(i,"pattern")||i==="line-dasharray";return P||x||D||this._handleOverridablePaintPropertyUpdate(i,w,M)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,o,u){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Ee(i,(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}_validate(i,o,u,p,x={}){return(!x||x.validate!==!1)&&tm(this,i.call(Dh,{key:o,layerType:this.type,objectKey:u,value:p,styleSpec:Ct,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof Se&&Mc(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=zu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const lb=ot([{name:"a_pos",components:2,type:"Int16"}],4),Hl=ot([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class zs{constructor(i=[]){this.segments=i}prepareSegment(i,o,u,p){let x=this.segments[this.segments.length-1];return i>zs.MAX_VERTEX_ARRAY_LENGTH&&Bt(`Max vertices per segment is ${zs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!x||x.vertexLength+i>zs.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==p)&&(x={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},p!==void 0&&(x.sortKey=p),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,u,p){return new zs([{vertexOffset:i,primitiveOffset:o,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}zs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bi(zs,"SegmentVector");var Ai=8192;class gr{constructor(i,o){i&&(o?this.setSouthWest(i).setNorthEast(o):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof $n?new $n(i.lng,i.lat):$n.convert(i),this}setSouthWest(i){return this._sw=i instanceof $n?new $n(i.lng,i.lat):$n.convert(i),this}extend(i){const o=this._sw,u=this._ne;let p,x;if(i instanceof $n)p=i,x=i;else{if(!(i instanceof gr))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(gr.convert(i)):this.extend($n.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend($n.convert(i)):this;if(p=i._sw,x=i._ne,!p||!x)return this}return o||u?(o.lng=Math.min(p.lng,o.lng),o.lat=Math.min(p.lat,o.lat),u.lng=Math.max(x.lng,u.lng),u.lat=Math.max(x.lat,u.lat)):(this._sw=new $n(p.lng,p.lat),this._ne=new $n(x.lng,x.lat)),this}getCenter(){return new $n((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new $n(this.getWest(),this.getNorth())}getSouthEast(){return new $n(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:o,lat:u}=$n.convert(i);let p=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(i){return!i||i instanceof gr?i:new gr(i)}}var lm=1e-6,yo=typeof Float32Array<"u"?Float32Array:Array;function Yy(){var s=new yo(9);return yo!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Ky(s,i,o){var u=i[0],p=i[1],x=i[2],w=i[3],M=i[4],P=i[5],D=i[6],V=i[7],G=i[8],X=o[0],J=o[1],Q=o[2],ae=o[3],_e=o[4],Pe=o[5],je=o[6],Le=o[7],Ve=o[8];return s[0]=X*u+J*w+Q*D,s[1]=X*p+J*M+Q*V,s[2]=X*x+J*P+Q*G,s[3]=ae*u+_e*w+Pe*D,s[4]=ae*p+_e*M+Pe*V,s[5]=ae*x+_e*P+Pe*G,s[6]=je*u+Le*w+Ve*D,s[7]=je*p+Le*M+Ve*V,s[8]=je*x+Le*P+Ve*G,s}function $o(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function cm(s,i){var o=i[0],u=i[1],p=i[2],x=i[3],w=i[4],M=i[5],P=i[6],D=i[7],V=i[8],G=i[9],X=i[10],J=i[11],Q=i[12],ae=i[13],_e=i[14],Pe=i[15],je=o*M-u*w,Le=o*P-p*w,Ve=o*D-x*w,He=u*P-p*M,$e=u*D-x*M,bt=p*D-x*P,gt=V*ae-G*Q,It=V*_e-X*Q,Qt=V*Pe-J*Q,Et=G*_e-X*ae,Nt=G*Pe-J*ae,Ut=X*Pe-J*_e,Gt=je*Ut-Le*Nt+Ve*Et+He*Qt-$e*It+bt*gt;return Gt?(s[0]=(M*Ut-P*Nt+D*Et)*(Gt=1/Gt),s[1]=(p*Nt-u*Ut-x*Et)*Gt,s[2]=(ae*bt-_e*$e+Pe*He)*Gt,s[3]=(X*$e-G*bt-J*He)*Gt,s[4]=(P*Qt-w*Ut-D*It)*Gt,s[5]=(o*Ut-p*Qt+x*It)*Gt,s[6]=(_e*Ve-Q*bt-Pe*Le)*Gt,s[7]=(V*bt-X*Ve+J*Le)*Gt,s[8]=(w*Nt-M*Qt+D*gt)*Gt,s[9]=(u*Qt-o*Nt-x*gt)*Gt,s[10]=(Q*$e-ae*Ve+Pe*je)*Gt,s[11]=(G*Ve-V*$e-J*je)*Gt,s[12]=(M*It-w*Et-P*gt)*Gt,s[13]=(o*Et-u*It+p*gt)*Gt,s[14]=(ae*Le-Q*He-_e*je)*Gt,s[15]=(V*He-G*Le+X*je)*Gt,s):null}function ql(s,i,o){var u=i[0],p=i[1],x=i[2],w=i[3],M=i[4],P=i[5],D=i[6],V=i[7],G=i[8],X=i[9],J=i[10],Q=i[11],ae=i[12],_e=i[13],Pe=i[14],je=i[15],Le=o[0],Ve=o[1],He=o[2],$e=o[3];return s[0]=Le*u+Ve*M+He*G+$e*ae,s[1]=Le*p+Ve*P+He*X+$e*_e,s[2]=Le*x+Ve*D+He*J+$e*Pe,s[3]=Le*w+Ve*V+He*Q+$e*je,s[4]=(Le=o[4])*u+(Ve=o[5])*M+(He=o[6])*G+($e=o[7])*ae,s[5]=Le*p+Ve*P+He*X+$e*_e,s[6]=Le*x+Ve*D+He*J+$e*Pe,s[7]=Le*w+Ve*V+He*Q+$e*je,s[8]=(Le=o[8])*u+(Ve=o[9])*M+(He=o[10])*G+($e=o[11])*ae,s[9]=Le*p+Ve*P+He*X+$e*_e,s[10]=Le*x+Ve*D+He*J+$e*Pe,s[11]=Le*w+Ve*V+He*Q+$e*je,s[12]=(Le=o[12])*u+(Ve=o[13])*M+(He=o[14])*G+($e=o[15])*ae,s[13]=Le*p+Ve*P+He*X+$e*_e,s[14]=Le*x+Ve*D+He*J+$e*Pe,s[15]=Le*w+Ve*V+He*Q+$e*je,s}function Mf(s,i,o){var u,p,x,w,M,P,D,V,G,X,J,Q,ae=o[0],_e=o[1],Pe=o[2];return i===s?(s[12]=i[0]*ae+i[4]*_e+i[8]*Pe+i[12],s[13]=i[1]*ae+i[5]*_e+i[9]*Pe+i[13],s[14]=i[2]*ae+i[6]*_e+i[10]*Pe+i[14],s[15]=i[3]*ae+i[7]*_e+i[11]*Pe+i[15]):(p=i[1],x=i[2],w=i[3],M=i[4],P=i[5],D=i[6],V=i[7],G=i[8],X=i[9],J=i[10],Q=i[11],s[0]=u=i[0],s[1]=p,s[2]=x,s[3]=w,s[4]=M,s[5]=P,s[6]=D,s[7]=V,s[8]=G,s[9]=X,s[10]=J,s[11]=Q,s[12]=u*ae+M*_e+G*Pe+i[12],s[13]=p*ae+P*_e+X*Pe+i[13],s[14]=x*ae+D*_e+J*Pe+i[14],s[15]=w*ae+V*_e+Q*Pe+i[15]),s}function Xl(s,i,o){var u=o[0],p=o[1],x=o[2];return s[0]=i[0]*u,s[1]=i[1]*u,s[2]=i[2]*u,s[3]=i[3]*u,s[4]=i[4]*p,s[5]=i[5]*p,s[6]=i[6]*p,s[7]=i[7]*p,s[8]=i[8]*x,s[9]=i[9]*x,s[10]=i[10]*x,s[11]=i[11]*x,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s}function Cf(s,i,o){var u=Math.sin(o),p=Math.cos(o),x=i[4],w=i[5],M=i[6],P=i[7],D=i[8],V=i[9],G=i[10],X=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=x*p+D*u,s[5]=w*p+V*u,s[6]=M*p+G*u,s[7]=P*p+X*u,s[8]=D*p-x*u,s[9]=V*p-w*u,s[10]=G*p-M*u,s[11]=X*p-P*u,s}function hm(s,i,o){var u=Math.sin(o),p=Math.cos(o),x=i[0],w=i[1],M=i[2],P=i[3],D=i[8],V=i[9],G=i[10],X=i[11];return i!==s&&(s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=x*p-D*u,s[1]=w*p-V*u,s[2]=M*p-G*u,s[3]=P*p-X*u,s[8]=x*u+D*p,s[9]=w*u+V*p,s[10]=M*u+G*p,s[11]=P*u+X*p,s}function Hg(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Nc(s,i,o){var u,p,x,w=o[0],M=o[1],P=o[2],D=Math.hypot(w,M,P);return D<lm?null:(w*=D=1/D,M*=D,P*=D,u=Math.sin(i),p=Math.cos(i),s[0]=w*w*(x=1-p)+p,s[1]=M*w*x+P*u,s[2]=P*w*x-M*u,s[3]=0,s[4]=w*M*x-P*u,s[5]=M*M*x+p,s[6]=P*M*x+w*u,s[7]=0,s[8]=w*P*x+M*u,s[9]=M*P*x-w*u,s[10]=P*P*x+p,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,i=arguments.length;i--;)s+=arguments[i]*arguments[i];return Math.sqrt(s)});var Af=ql;function um(){var s=new yo(3);return yo!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Jy(s){var i=new yo(3);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i}function Hu(s){return Math.hypot(s[0],s[1],s[2])}function Uc(s,i,o){var u=new yo(3);return u[0]=s,u[1]=i,u[2]=o,u}function Ga(s,i,o){return s[0]=i[0]+o[0],s[1]=i[1]+o[1],s[2]=i[2]+o[2],s}function dm(s,i,o){return s[0]=i[0]-o[0],s[1]=i[1]-o[1],s[2]=i[2]-o[2],s}function fm(s,i,o){return s[0]=i[0]*o[0],s[1]=i[1]*o[1],s[2]=i[2]*o[2],s}function so(s,i,o){return s[0]=Math.min(i[0],o[0]),s[1]=Math.min(i[1],o[1]),s[2]=Math.min(i[2],o[2]),s}function ma(s,i,o){return s[0]=Math.max(i[0],o[0]),s[1]=Math.max(i[1],o[1]),s[2]=Math.max(i[2],o[2]),s}function xo(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s}function kf(s,i,o,u){return s[0]=i[0]+o[0]*u,s[1]=i[1]+o[1]*u,s[2]=i[2]+o[2]*u,s}function Xr(s,i){var o=i[0],u=i[1],p=i[2],x=o*o+u*u+p*p;return x>0&&(x=1/Math.sqrt(x)),s[0]=i[0]*x,s[1]=i[1]*x,s[2]=i[2]*x,s}function vo(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]}function pl(s,i,o){var u=i[0],p=i[1],x=i[2],w=o[0],M=o[1],P=o[2];return s[0]=p*P-x*M,s[1]=x*w-u*P,s[2]=u*M-p*w,s}function Es(s,i,o){var u=i[0],p=i[1],x=i[2],w=o[3]*u+o[7]*p+o[11]*x+o[15];return s[0]=(o[0]*u+o[4]*p+o[8]*x+o[12])/(w=w||1),s[1]=(o[1]*u+o[5]*p+o[9]*x+o[13])/w,s[2]=(o[2]*u+o[6]*p+o[10]*x+o[14])/w,s}function In(s,i,o){var u=o[0],p=o[1],x=o[2],w=i[0],M=i[1],P=i[2],D=p*P-x*M,V=x*w-u*P,G=u*M-p*w,X=p*G-x*V,J=x*D-u*G,Q=u*V-p*D,ae=2*o[3];return V*=ae,G*=ae,J*=2,Q*=2,s[0]=w+(D*=ae)+(X*=2),s[1]=M+V+J,s[2]=P+G+Q,s}var If,Wo=dm,cb=fm,qu=Hu;function Qy(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s[3]=i[3]*o,s}function Pf(s,i){var o=i[0],u=i[1],p=i[2],x=i[3],w=o*o+u*u+p*p+x*x;return w>0&&(w=1/Math.sqrt(w)),s[0]=o*w,s[1]=u*w,s[2]=p*w,s[3]=x*w,s}function Zr(s,i,o){var u=i[0],p=i[1],x=i[2],w=i[3];return s[0]=o[0]*u+o[4]*p+o[8]*x+o[12]*w,s[1]=o[1]*u+o[5]*p+o[9]*x+o[13]*w,s[2]=o[2]*u+o[6]*p+o[10]*x+o[14]*w,s[3]=o[3]*u+o[7]*p+o[11]*x+o[15]*w,s}function pm(){var s=new yo(4);return yo!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ar(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function ex(s,i,o){o*=.5;var u=i[0],p=i[1],x=i[2],w=i[3],M=Math.sin(o),P=Math.cos(o);return s[0]=u*P+w*M,s[1]=p*P+x*M,s[2]=x*P-p*M,s[3]=w*P-u*M,s}function qg(s,i,o){o*=.5;var u=i[0],p=i[1],x=i[2],w=i[3],M=Math.sin(o),P=Math.cos(o);return s[0]=u*P-x*M,s[1]=p*P+w*M,s[2]=x*P+u*M,s[3]=w*P-p*M,s}um(),If=new yo(4),yo!=Float32Array&&(If[0]=0,If[1]=0,If[2]=0,If[3]=0);var tx=Pf;um(),Uc(1,0,0),Uc(0,1,0),pm(),pm(),Yy();const mm=ot([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ix}=mm,nx=ot([{name:"a_pos_3",components:3,type:"Int16"}]);var ga=ot([{name:"a_pos",type:"Int16",components:2}]);class Xg{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,u){const p=vo(o,this.dir);if(Math.abs(p)<1e-6)return!1;const x=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1]+(i[2]-this.pos[2])*o[2])/p;return u[0]=this.pos[0]+this.dir[0]*x,u[1]=this.pos[1]+this.dir[1]*x,u[2]=this.pos[2]+this.dir[2]*x,!0}closestPointOnSphere(i,o,u){if(function(J,Q){var ae=J[0],_e=J[1],Pe=J[2],je=Q[0],Le=Q[1],Ve=Q[2];return Math.abs(ae-je)<=lm*Math.max(1,Math.abs(ae),Math.abs(je))&&Math.abs(_e-Le)<=lm*Math.max(1,Math.abs(_e),Math.abs(Le))&&Math.abs(Pe-Ve)<=lm*Math.max(1,Math.abs(Pe),Math.abs(Ve))}(this.pos,i)||o===0)return u[0]=u[1]=u[2]=0,!1;const[p,x,w]=this.dir,M=this.pos[0]-i[0],P=this.pos[1]-i[1],D=this.pos[2]-i[2],V=p*p+x*x+w*w,G=2*(M*p+P*x+D*w),X=G*G-4*V*(M*M+P*P+D*D-o*o);if(X<0){const J=Math.max(-G/2,0),Q=M+p*J,ae=P+x*J,_e=D+w*J,Pe=Math.hypot(Q,ae,_e);return u[0]=Q*o/Pe,u[1]=ae*o/Pe,u[2]=_e*o/Pe,!1}{const J=(-G-Math.sqrt(X))/(2*V);if(J<0){const Q=Math.hypot(M,P,D);return u[0]=M*o/Q,u[1]=P*o/Q,u[2]=D*o/Q,!1}return u[0]=M+p*J,u[1]=P+x*J,u[2]=D+w*J,!0}}}class Zg{constructor(i,o,u,p,x){this.TL=i,this.TR=o,this.BR=u,this.BL=p,this.horizon=x}static fromInvProjectionMatrix(i,o,u){const p=[-1,1,1],x=[1,1,1],w=[1,-1,1],M=[-1,-1,1],P=Es(p,p,i),D=Es(x,x,i),V=Es(w,w,i),G=Es(M,M,i);return new Zg(P,D,V,G,o/u)}}class ml{constructor(i,o){this.points=i,this.planes=o}static fromInvProjectionMatrix(i,o,u,p){const x=Math.pow(2,u),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const D=Zr([],P,i),V=1/D[3]/o*x;return function(G,X,J){return G[0]=X[0]*J[0],G[1]=X[1]*J[1],G[2]=X[2]*J[2],G[3]=X[3]*J[3],G}(D,D,[V,V,p?1/D[3]:V,V])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const D=Xr([],pl([],Wo([],w[P[0]],w[P[1]]),Wo([],w[P[2]],w[P[1]]))),V=-vo(D,w[P[1]]);return D.concat(V)});return new ml(w,M)}}class _r{static fromPoints(i){const o=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const p of i)so(o,o,p),ma(u,u,p);return new _r(o,u)}static applyTransform(i,o){const u=i.getCorners();for(let p=0;p<u.length;++p)Es(u[p],u[p],o);return _r.fromPoints(u)}constructor(i,o){this.min=i,this.max=o,this.center=xo([],Ga([],this.min,this.max),.5)}quadrant(i){const o=[i%2==0,i<2],u=Jy(this.min),p=Jy(this.max);for(let x=0;x<o.length;x++)u[x]=o[x]?this.min[x]:this.center[x],p[x]=o[x]?this.center[x]:this.max[x];return p[2]=this.max[2],new _r(u,p)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,o=this.max;return[[i[0],i[1],i[2]],[o[0],i[1],i[2]],[o[0],o[1],i[2]],[i[0],o[1],i[2]],[i[0],i[1],o[2]],[o[0],i[1],o[2]],[o[0],o[1],o[2]],[i[0],o[1],o[2]]]}intersects(i){const o=this.getCorners();let u=!0;for(let p=0;p<i.planes.length;p++){const x=i.planes[p];let w=0;for(let M=0;M<o.length;M++)w+=vo(x,o[M])+x[3]>=0;if(w===0)return 0;w!==o.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let x=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let M=0;M<i.points.length;M++){const P=i.points[M][p]-this.min[p];x=Math.min(x,P),w=Math.max(w,P)}if(w<0||x>this.max[p]-this.min[p])return 0}return 1}}const Lf=5,gm=6,gl=Ai/Math.PI/2,sx=16383,Vc=64,Df=[Vc,32,16],Go=-gl,Yr=gl,hb=[new _r([Go,Go,Go],[Yr,Yr,Yr]),new _r([Go,Go,Go],[0,0,Yr]),new _r([0,Go,Go],[Yr,0,Yr]),new _r([Go,0,Go],[0,Yr,Yr]),new _r([0,0,Go],[Yr,Yr,Yr])];function _m(s){return s*gl/Bf}function rx(s,i,o,u=!0){const p=xo([],s._camera.position,s.worldSize),x=[i,o,1,1];Zr(x,x,s.pixelMatrixInverse),Qy(x,x,1/x[3]);const w=Xr([],Wo([],x,p)),M=s.globeMatrix,P=[M[12],M[13],M[14]],D=Wo([],P,p),V=Hu(D),G=Xr([],D),X=s.worldSize/(2*Math.PI),J=vo(G,w),Q=Math.asin(X/V);if(Q<Math.acos(J)){if(!u)return null;const Qt=[],Et=[];xo(Qt,w,V/J),Xr(Et,Wo(Et,Qt,D)),Xr(w,Ga(w,D,xo(w,Et,Math.tan(Q)*V)))}const ae=[];new Xg(p,w).closestPointOnSphere(P,X,ae);const _e=Xr([],Yt(M,0)),Pe=Xr([],Yt(M,1)),je=Xr([],Yt(M,2)),Le=vo(_e,ae),Ve=vo(Pe,ae),He=vo(je,ae),$e=Tt(Math.asin(-Ve/X));let bt=Tt(Math.atan2(Le,He));bt=s.center.lng+function(Qt,Et){const Nt=(Et-Qt+180)%360-180;return Nt<-180?Nt+360:Nt}(s.center.lng,bt);const gt=qa(bt),It=ci(ya($e),0,1);return new Ku(gt,It)}class ox{constructor(i,o,u){this.a=Wo([],i,u),this.b=Wo([],o,u),this.center=u;const p=Xr([],this.a),x=Xr([],this.b);this.angle=Math.acos(vo(p,x))}}function Of(s,i){if(s.angle===0)return null;let o;return o=s.a[i]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[i]/s.a[i]/Math.sin(s.angle)-1/Math.tan(s.angle)),o<0||o>1?null:function(u,p,x,w){const M=Math.sin(x);return u*(Math.sin((1-w)*x)/M)+p*(Math.sin(w*x)/M)}(s.a[i],s.b[i],s.angle,ci(o,0,1))+s.center[i]}function _a(s){if(s.z<=1)return hb[s.z+2*s.y+s.x];const i=zh(Rf(s));return _r.fromPoints(i)}function Ha(s,i,o){return xo(s,s,1-o),kf(s,s,i,o)}function Yg(s,i){const o=Yu(i.zoom);if(o===0)return _a(s);const u=Rf(s),p=zh(u),x=qa(u.getWest())*i.worldSize,w=qa(u.getEast())*i.worldSize,M=ya(u.getNorth())*i.worldSize,P=ya(u.getSouth())*i.worldSize,D=[x,M,0],V=[w,M,0],G=[x,P,0],X=[w,P,0],J=cm([],i.globeMatrix);return Es(D,D,J),Es(V,V,J),Es(G,G,J),Es(X,X,J),p[0]=Ha(p[0],G,o),p[1]=Ha(p[1],X,o),p[2]=Ha(p[2],V,o),p[3]=Ha(p[3],D,o),_r.fromPoints(p)}function ax(s,i,o){for(const u of s)Es(u,u,i),xo(u,u,o)}function ub(s,i,o){const u=i/s.worldSize,p=s.globeMatrix;if(o.z<=1){const gt=_a(o).getCorners();return ax(gt,p,u),_r.fromPoints(gt)}const x=Rf(o),w=zh(x);ax(w,p,u);const M=Number.MAX_VALUE,P=[-M,-M,-M],D=[M,M,M];if(x.contains(s.center)){for(const Qt of w)so(D,D,Qt),ma(P,P,Qt);P[2]=0;const gt=s.point,It=[gt.x*u,gt.y*u,0];return so(D,D,It),ma(P,P,It),new _r(D,P)}const V=[p[12]*u,p[13]*u,p[14]*u],G=x.getCenter(),X=ci(s.center.lat,-85.051129,qo),J=ci(G.lat,-85.051129,qo),Q=qa(s.center.lng),ae=ya(X);let _e=Q-qa(G.lng);const Pe=ae-ya(J);_e>.5?_e-=1:_e<-.5&&(_e+=1);let je=0;Math.abs(_e)>Math.abs(Pe)?je=_e>=0?1:3:(je=Pe>=0?0:2,kf(V,V,[p[4]*u,p[5]*u,p[6]*u],-Math.sin(Xe(Pe>=0?x.getSouth():x.getNorth()))*gl));const Le=w[je],Ve=w[(je+1)%4],He=new ox(Le,Ve,V),$e=[Of(He,0)||Le[0],Of(He,1)||Le[1],Of(He,2)||Le[2]],bt=Yu(s.zoom);if(bt>0){const gt=function({x:Qt,y:Et,z:Nt},Ut,Gt,si,At){const fi=1/(1<<Nt);let Si=Qt*fi,_i=Si+fi,Ji=Et*fi,ri=Ji+fi,Di=0;const Qi=(Si+_i)/2-si;return Qi>.5?Di=-1:Qi<-.5&&(Di=1),Si=((Si+Di)*Ut-(si*=Ut))*Gt+si,_i=((_i+Di)*Ut-si)*Gt+si,Ji=(Ji*Ut-(At*=Ut))*Gt+At,ri=(ri*Ut-At)*Gt+At,[[Si,ri,0],[_i,ri,0],[_i,Ji,0],[Si,Ji,0]]}(o,i,s._pixelsPerMercatorPixel,Q,ae);for(let Qt=0;Qt<w.length;Qt++)Ha(w[Qt],gt[Qt],bt);const It=Ga([],gt[je],gt[(je+1)%4]);xo(It,It,.5),Ha($e,It,bt)}for(const gt of w)so(D,D,gt),ma(P,P,gt);return D[2]=Math.min(Le[2],Ve[2]),so(D,D,$e),ma(P,P,$e),new _r(D,P)}function Rf({x:s,y:i,z:o}){const u=1/(1<<o),p=new $n(Ho(s*u),kr((i+1)*u)),x=new $n(Ho((s+1)*u),kr(i*u));return new gr(p,x)}function zh(s){const i=Xe(s.getNorth()),o=Xe(s.getSouth()),u=Math.cos(i),p=Math.cos(o),x=Math.sin(i),w=Math.sin(o),M=s.getWest(),P=s.getEast();return[Bh(p,w,M),Bh(p,w,P),Bh(u,x,P),Bh(u,x,M)]}function Bh(s,i,o,u=gl){return o=Xe(o),[s*Math.sin(o)*u,-i*u,s*Math.cos(o)*u]}function Xu(s,i,o){return Bh(Math.cos(Xe(s)),Math.sin(Xe(s)),i,o)}function zf(s,i,o,u){const p=1<<o.z,x=(s/Ai+o.x)/p;return Xu(kr((i/Ai+o.y)/p),Ho(x),u)}function Zu({min:s,max:i}){return sx/Math.max(i[0]-s[0],i[1]-s[1],i[2]-s[2])}const jc=new Float64Array(16);function Fh(s){const i=Zu(s),o=Hg(jc,[i,i,i]);return Mf(o,o,((u=[])[0]=-(p=s.min)[0],u[1]=-p[1],u[2]=-p[2],u));var u,p}function Kg(s){const i=(u=s.min,(o=jc)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=u[0],o[13]=u[1],o[14]=u[2],o[15]=1,o);var o,u;const p=1/Zu(s);return Xl(i,i,[p,p,p])}function lx(s,i,o,u,p){const x=function(P){const D=Ai/(2*Math.PI);return P/(2*Math.PI)/D}(o),w=[s,i,-o/(2*Math.PI)],M=$o(new Float64Array(16));return Mf(M,M,w),Xl(M,M,[x,x,x]),Cf(M,M,Xe(-p)),hm(M,M,Xe(-u)),M}function Yu(s){return pn(Lf,gm,s)}function cx(s,i){const o=Xu(i.lat,i.lng),u=function(Q){const ae=Xu(Q._center.lat,Q._center.lng);let _e=pl([],Uc(0,1,0),ae);const Pe=Nc([],-Q.angle,ae);_e=Es(_e,_e,Pe),Nc(Pe,-Q._pitch,_e);const je=Xr([],ae);return xo(je,je,_m(Q.cameraToCenterDistance/Q.pixelsPerMeter)),Es(je,je,Pe),Ga([],ae,je)}(s);return w=(p=dm([],u,o))[0],M=p[1],P=p[2],D=(x=o)[0],V=x[1],G=x[2],J=(X=Math.sqrt(w*w+M*M+P*P)*Math.sqrt(D*D+V*V+G*G))&&vo(p,x)/X,Math.acos(Math.min(Math.max(J,-1),1));var p,x,w,M,P,D,V,G,X,J}function Jg(s,i){return cx(s,i)>Math.PI/2*1.01}const hx=Xe(85),db=Math.cos(hx),fb=Math.sin(hx),Bf=63710088e-1,ux=2*Math.PI*Bf;class $c{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $c(Ni(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,u=this.lat*o,p=i.lat*o,x=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((i.lng-this.lng)*o);return Bf*Math.acos(Math.min(x,1))}toBounds(i=0){const o=360*i/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new gr(new $c(this.lng-u,this.lat-o),new $c(this.lng+u,this.lat+o))}toEcef(i){const o=_m(i);return Xu(this.lat,this.lng,gl+o)}static convert(i){if(i instanceof $c)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new $c(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new $c(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var $n=$c;function Qg(s){return ux*Math.cos(s*Math.PI/180)}function qa(s){return(180+s)/360}function ya(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Xa(s,i){return s/Qg(i)}function Ho(s){return 360*s-180}function kr(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Ff(s,i){return s*Qg(kr(i))}const qo=85.051129;function e_(s){return 1/Math.cos(s*Math.PI/180)}class Ku{constructor(i,o,u=0){this.x=+i,this.y=+o,this.z=+u}static fromLngLat(i,o=0){const u=$n.convert(i);return new Ku(qa(u.lng),ya(u.lat),Xa(o,u.lat))}toLngLat(){return new $n(Ho(this.x),kr(this.y))}toAltitude(){return Ff(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ux*e_(kr(this.y))}}function Ju(s,i,o,u,p,x,w,M,P){const D=(i+u)/2,V=(o+p)/2,G=new Ne(D,V);M(G),function(X,J,Q,ae,_e,Pe){const je=Q-_e,Le=ae-Pe;return Math.abs((ae-J)*je-(Q-X)*Le)/Math.hypot(je,Le)}(G.x,G.y,x.x,x.y,w.x,w.y)>=P?(Ju(s,i,o,D,V,x,G,M,P),Ju(s,D,V,u,p,G,w,M,P)):s.push(w)}function ym(s,i,o){let u=s[0],p=u.x,x=u.y;i(u);const w=[u];for(let M=1;M<s.length;M++){const P=s[M],{x:D,y:V}=P;i(P),Ju(w,p,x,D,V,u,P,i,o),p=D,x=V,u=P}return w}function xm(s,i,o,u){if(u(i,o)){const p=i.add(o)._mult(.5);xm(s,i,p,u),xm(s,p,o,u)}else s.push(o)}function pb(s,i){let o=s[0];const u=[o];for(let p=1;p<s.length;p++){const x=s[p];xm(u,o,x,i),o=x}return u}const Nf=Math.pow(2,14)-1,dx=-Nf-1;function mb(s,i){const o=Math.round(s.x*i),u=Math.round(s.y*i);return s.x=ci(o,dx,Nf),s.y=ci(u,dx,Nf),(o<s.x||o>s.x+1||u<s.y||u>s.y+1)&&Bt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function Za(s,i,o){const u=s.loadGeometry(),p=s.extent,x=Ai/p;if(i&&o&&o.projection.isReprojectedInTileSpace){const w=1<<i.z,{scale:M,x:P,y:D,projection:V}=o,G=X=>{const J=Ho((i.x+X.x/p)/w),Q=kr((i.y+X.y/p)/w),ae=V.project(J,Q);X.x=(ae.x*M-P)*p,X.y=(ae.y*M-D)*p};for(let X=0;X<u.length;X++)if(s.type!==1)u[X]=ym(u[X],G,1);else{const J=[];for(const Q of u[X])Q.x<0||Q.x>=p||Q.y<0||Q.y>=p||(G(Q),J.push(Q));u[X]=J}}for(const w of u)for(const M of w)mb(M,x);return u}function Nh(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?Za(s):[]}}function vm(s,i,o,u,p){s.emplaceBack(2*i+(u+1)/2,2*o+(p+1)/2)}function bm(s,i,o){s.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class Qu{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Wt,this.indexArray=new Ci,this.segments=new zs,this.programConfigurations=new Fc(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,u,p){const x=this.layers[0],w=[];let M=null;x.type==="circle"&&(M=x.layout.get("circle-sort-key"));for(const{feature:D,id:V,index:G,sourceLayerIndex:X}of i){const J=this.layers[0]._featureFilter.needGeometry,Q=Nh(D,J);if(!this.layers[0]._featureFilter.filter(new j(this.zoom),Q,u))continue;const ae=M?M.evaluate(Q,{},u):void 0,_e={id:V,properties:D.properties,type:D.type,sourceLayerIndex:X,index:G,geometry:J?Q.geometry:Za(D,u,p),patterns:{},sortKey:ae};w.push(_e)}M&&w.sort((D,V)=>D.sortKey-V.sortKey);let P=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Xt,P=p.projection);for(const D of w){const{geometry:V,index:G,sourceLayerIndex:X}=D,J=i[G].feature;this.addFeature(D,V,G,o.availableImages,u,P),o.featureIndex.insert(J,V,G,X,this.index)}}update(i,o,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,lb.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Hl.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,o,u,p,x,w){for(const M of o)for(const P of M){const D=P.x,V=P.y;if(D<0||D>=Ai||V<0||V>=Ai)continue;if(w){const J=w.projectTilePoint(D,V,x),Q=w.upVector(x,D,V),ae=this.globeExtVertexArray;bm(ae,J,Q),bm(ae,J,Q),bm(ae,J,Q),bm(ae,J,Q)}const G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),X=G.vertexLength;vm(this.layoutVertexArray,D,V,-1,-1),vm(this.layoutVertexArray,D,V,1,-1),vm(this.layoutVertexArray,D,V,1,1),vm(this.layoutVertexArray,D,V,-1,1),this.indexArray.emplaceBack(X,X+1,X+2),this.indexArray.emplaceBack(X,X+2,X+3),G.vertexLength+=4,G.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,{},p,x)}}function Uf(s,i){for(let o=0;o<s.length;o++)if(_l(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(_l(s,i[o]))return!0;return!!wm(s,i)}function fx(s,i,o){return!!_l(s,i)||!!Vf(i,s,o)}function t_(s,i){if(s.length===1)return mx(i,s[0]);for(let o=0;o<i.length;o++){const u=i[o];for(let p=0;p<u.length;p++)if(_l(s,u[p]))return!0}for(let o=0;o<s.length;o++)if(mx(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(wm(s,i[o]))return!0;return!1}function px(s,i,o){if(s.length>1){if(wm(s,i))return!0;for(let u=0;u<i.length;u++)if(Vf(i[u],s,o))return!0}for(let u=0;u<s.length;u++)if(Vf(s[u],i,o))return!0;return!1}function wm(s,i){if(s.length===0||i.length===0)return!1;for(let o=0;o<s.length-1;o++){const u=s[o],p=s[o+1];for(let x=0;x<i.length-1;x++)if(Tm(u,p,i[x],i[x+1]))return!0}return!1}function Tm(s,i,o,u){return Dt(s,o,u)!==Dt(i,o,u)&&Dt(s,i,o)!==Dt(s,i,u)}function Vf(s,i,o){const u=o*o;if(i.length===1)return s.distSqr(i[0])<u;for(let p=1;p<i.length;p++)if(ed(s,i[p-1],i[p])<u)return!0;return!1}function ed(s,i,o){const u=i.distSqr(o);if(u===0)return s.distSqr(i);const p=((s.x-i.x)*(o.x-i.x)+(s.y-i.y)*(o.y-i.y))/u;return s.distSqr(p<0?i:p>1?o:o.sub(i)._mult(p)._add(i))}function mx(s,i){let o,u,p,x=!1;for(let w=0;w<s.length;w++){o=s[w];for(let M=0,P=o.length-1;M<o.length;P=M++)u=o[M],p=o[P],u.y>i.y!=p.y>i.y&&i.x<(p.x-u.x)*(i.y-u.y)/(p.y-u.y)+u.x&&(x=!x)}return x}function _l(s,i){let o=!1;for(let u=0,p=s.length-1;u<s.length;p=u++){const x=s[u],w=s[p];x.y>i.y!=w.y>i.y&&i.x<(w.x-x.x)*(i.y-x.y)/(w.y-x.y)+x.x&&(o=!o)}return o}function jf(s,i,o,u,p){for(const w of s)if(i<=w.x&&o<=w.y&&u>=w.x&&p>=w.y)return!0;const x=[new Ne(i,o),new Ne(i,p),new Ne(u,p),new Ne(u,o)];if(s.length>2){for(const w of x)if(_l(s,w))return!0}for(let w=0;w<s.length-1;w++)if(gb(s[w],s[w+1],x))return!0;return!1}function gb(s,i,o){const u=o[0],p=o[2];if(s.x<u.x&&i.x<u.x||s.x>p.x&&i.x>p.x||s.y<u.y&&i.y<u.y||s.y>p.y&&i.y>p.y)return!1;const x=Dt(s,i,o[0]);return x!==Dt(s,i,o[1])||x!==Dt(s,i,o[2])||x!==Dt(s,i,o[3])}function td(s,i,o){const u=i.paint.get(s).value;return u.kind==="constant"?u.value:o.programConfigurations.get(i.id).getMaxValue(s)}function yl(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function i_(s,i,o,u,p){if(!i[0]&&!i[1])return s;const x=Ne.convert(i)._mult(p);o==="viewport"&&x._rotate(-u);const w=[];for(let M=0;M<s.length;M++)w.push(s[M].sub(x));return w}function Em(s,i,o,u){const p=Ne.convert(s)._mult(u);return i==="viewport"&&p._rotate(-o),p}bi(Qu,"CircleBucket",{omit:["layers"]});const gx=new Re({"circle-sort-key":new we(Ct.layout_circle["circle-sort-key"])});var Wc={paint:new Re({"circle-radius":new we(Ct.paint_circle["circle-radius"]),"circle-color":new we(Ct.paint_circle["circle-color"]),"circle-blur":new we(Ct.paint_circle["circle-blur"]),"circle-opacity":new we(Ct.paint_circle["circle-opacity"]),"circle-translate":new re(Ct.paint_circle["circle-translate"]),"circle-translate-anchor":new re(Ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new re(Ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new re(Ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new we(Ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new we(Ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new we(Ct.paint_circle["circle-stroke-opacity"])}),layout:gx};function id(s,i,o,u,p,x,w,M,P){if(x&&s.queryGeometry.isAboveHorizon)return!1;x&&(P*=s.pixelToTileUnitsFactor);const D=s.tileID.canonical,V=o.projection.upVectorScale(D,o.center.lat,o.worldSize).metersToTile;for(const G of i)for(const X of G){const J=X.add(M),Q=p&&o.elevation?o.elevation.exaggeration()*p.getElevationAt(J.x,J.y,!0):0,ae=o.projection.projectTilePoint(J.x,J.y,D);if(Q>0){const Le=o.projection.upVector(D,J.x,J.y);ae.x+=Le[0]*V*Q,ae.y+=Le[1]*V*Q,ae.z+=Le[2]*V*Q}const _e=x?J:$f(ae.x,ae.y,ae.z,u),Pe=x?s.tilespaceRays.map(Le=>_b(Le,Q)):s.queryGeometry.screenGeometry,je=Zr([],[ae.x,ae.y,ae.z,1],u);if(!w&&x?P*=je[3]/o.cameraToCenterDistance:w&&!x&&(P*=o.cameraToCenterDistance/je[3]),x){const Le=kr((X.y/Ai+D.y)/(1<<D.z));P/=o.projection.pixelsPerMeter(Le,1)/Xa(1,Le)}if(fx(Pe,_e,P))return!0}return!1}function $f(s,i,o,u){const p=Zr([],[s,i,o,1],u);return new Ne(p[0]/p[3],p[1]/p[3])}const _x=Uc(0,0,0),Wf=Uc(0,0,1);function _b(s,i){const o=um();return _x[2]=i,s.intersectsPlane(_x,Wf,o),new Ne(o[0],o[1])}class n_ extends Qu{}function Gf(s,{width:i,height:o},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==i*o*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(i*o*u);return s.width=i,s.height=o,s.data=p,s}function yx(s,i,o){const{width:u,height:p}=i;u===s.width&&p===s.height||(Sm(s,i,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,u),height:Math.min(s.height,p)},o),s.width=u,s.height=p,s.data=i.data)}function Sm(s,i,o,u,p,x){if(p.width===0||p.height===0)return i;if(p.width>s.width||p.height>s.height||o.x>s.width-p.width||o.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>i.width||p.height>i.height||u.x>i.width-p.width||u.y>i.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const w=s.data,M=i.data;for(let P=0;P<p.height;P++){const D=((o.y+P)*s.width+o.x)*x,V=((u.y+P)*i.width+u.x)*x;for(let G=0;G<p.width*x;G++)M[V+G]=w[D+G]}return i}bi(n_,"HeatmapBucket",{omit:["layers"]});class Zl{constructor(i,o){Gf(this,i,1,o)}resize(i){yx(this,new Zl(i),1)}clone(){return new Zl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,u,p,x){Sm(i,o,u,p,x,1)}}class bo{constructor(i,o){Gf(this,i,4,o)}resize(i){yx(this,new bo(i),4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new bo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,u,p,x){Sm(i,o,u,p,x,4)}}bi(Zl,"AlphaImage"),bi(bo,"RGBAImage");var yb={paint:new Re({"heatmap-radius":new we(Ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new we(Ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new re(Ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new De(Ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new re(Ct.paint_heatmap["heatmap-opacity"])})};function s_(s){const i={},o=s.resolution||256,u=s.clips?s.clips.length:1,p=s.image||new bo({width:o,height:u}),x=(w,M,P)=>{i[s.evaluationKey]=P;const D=s.expression.evaluate(i);p.data[w+M+0]=Math.floor(255*D.r/D.a),p.data[w+M+1]=Math.floor(255*D.g/D.a),p.data[w+M+2]=Math.floor(255*D.b/D.a),p.data[w+M+3]=Math.floor(255*D.a)};if(s.clips)for(let w=0,M=0;w<u;++w,M+=4*o)for(let P=0,D=0;P<o;P++,D+=4){const V=P/(o-1),{start:G,end:X}=s.clips[w];x(M,D,G*(1-V)+X*V)}else for(let w=0,M=0;w<o;w++,M+=4)x(0,M,w/(o-1));return p}var xb={paint:new Re({"hillshade-illumination-direction":new re(Ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new re(Ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new re(Ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new re(Ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new re(Ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new re(Ct.paint_hillshade["hillshade-accent-color"])})};const r_=ot([{name:"a_pos",components:2,type:"Int16"}],4),{members:vb}=r_;var Mm={exports:{}};function Cm(s,i,o){o=o||2;var u,p,x,w,M,P,D,V=i&&i.length,G=V?i[0]*o:s.length,X=xx(s,0,G,o,!0),J=[];if(!X||X.next===X.prev)return J;if(V&&(X=function(ae,_e,Pe,je){var Le,Ve,He,$e=[];for(Le=0,Ve=_e.length;Le<Ve;Le++)(He=xx(ae,_e[Le]*je,Le<Ve-1?_e[Le+1]*je:ae.length,je,!1))===He.next&&(He.steiner=!0),$e.push(Eb(He));for($e.sort(wb),Le=0;Le<$e.length;Le++)Pe=bx($e[Le],Pe);return Pe}(s,i,X,o)),s.length>80*o){u=x=s[0],p=w=s[1];for(var Q=o;Q<G;Q+=o)(M=s[Q])<u&&(u=M),(P=s[Q+1])<p&&(p=P),M>x&&(x=M),P>w&&(w=P);D=(D=Math.max(x-u,w-p))!==0?32767/D:0}return Gc(X,J,o,u,p,D,0),J}function xx(s,i,o,u,p){var x,w;if(p===Xf(s,i,o,u)>0)for(x=i;x<o;x+=u)w=l_(x,s[x],s[x+1],w);else for(x=o-u;x>=i;x-=u)w=l_(x,s[x],s[x+1],w);return w&&Im(w,w.next)&&(Vh(w),w=w.next),w}function Uh(s,i){if(!s)return s;i||(i=s);var o,u=s;do if(o=!1,u.steiner||!Im(u,u.next)&&Gs(u.prev,u,u.next)!==0)u=u.next;else{if(Vh(u),(u=i=u.prev)===u.next)break;o=!0}while(o||u!==i);return i}function Gc(s,i,o,u,p,x,w){if(s){!w&&x&&function(V,G,X,J){var Q=V;do Q.z===0&&(Q.z=km(Q.x,Q.y,G,X,J)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==V);Q.prevZ.nextZ=null,Q.prevZ=null,function(ae){var _e,Pe,je,Le,Ve,He,$e,bt,gt=1;do{for(Pe=ae,ae=null,Ve=null,He=0;Pe;){for(He++,je=Pe,$e=0,_e=0;_e<gt&&($e++,je=je.nextZ);_e++);for(bt=gt;$e>0||bt>0&&je;)$e!==0&&(bt===0||!je||Pe.z<=je.z)?(Le=Pe,Pe=Pe.nextZ,$e--):(Le=je,je=je.nextZ,bt--),Ve?Ve.nextZ=Le:ae=Le,Le.prevZ=Ve,Ve=Le;Pe=je}Ve.nextZ=null,gt*=2}while(He>1)}(Q)}(s,u,p,x);for(var M,P,D=s;s.prev!==s.next;)if(M=s.prev,P=s.next,x?bb(s,u,p,x):vx(s))i.push(M.i/o|0),i.push(s.i/o|0),i.push(P.i/o|0),Vh(s),s=P.next,D=P.next;else if((s=P)===D){w?w===1?Gc(s=o_(Uh(s),i,o),i,o,u,p,x,2):w===2&&Am(s,i,o,u,p,x):Gc(Uh(s),i,o,u,p,x,1);break}}}function vx(s){var i=s.prev,o=s,u=s.next;if(Gs(i,o,u)>=0)return!1;for(var p=i.x,x=o.x,w=u.x,M=i.y,P=o.y,D=u.y,V=p<x?p<w?p:w:x<w?x:w,G=M<P?M<D?M:D:P<D?P:D,X=p>x?p>w?p:w:x>w?x:w,J=M>P?M>D?M:D:P>D?P:D,Q=u.next;Q!==i;){if(Q.x>=V&&Q.x<=X&&Q.y>=G&&Q.y<=J&&nd(p,M,x,P,w,D,Q.x,Q.y)&&Gs(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function bb(s,i,o,u){var p=s.prev,x=s,w=s.next;if(Gs(p,x,w)>=0)return!1;for(var M=p.x,P=x.x,D=w.x,V=p.y,G=x.y,X=w.y,J=M<P?M<D?M:D:P<D?P:D,Q=V<G?V<X?V:X:G<X?G:X,ae=M>P?M>D?M:D:P>D?P:D,_e=V>G?V>X?V:X:G>X?G:X,Pe=km(J,Q,i,o,u),je=km(ae,_e,i,o,u),Le=s.prevZ,Ve=s.nextZ;Le&&Le.z>=Pe&&Ve&&Ve.z<=je;){if(Le.x>=J&&Le.x<=ae&&Le.y>=Q&&Le.y<=_e&&Le!==p&&Le!==w&&nd(M,V,P,G,D,X,Le.x,Le.y)&&Gs(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,Ve.x>=J&&Ve.x<=ae&&Ve.y>=Q&&Ve.y<=_e&&Ve!==p&&Ve!==w&&nd(M,V,P,G,D,X,Ve.x,Ve.y)&&Gs(Ve.prev,Ve,Ve.next)>=0))return!1;Ve=Ve.nextZ}for(;Le&&Le.z>=Pe;){if(Le.x>=J&&Le.x<=ae&&Le.y>=Q&&Le.y<=_e&&Le!==p&&Le!==w&&nd(M,V,P,G,D,X,Le.x,Le.y)&&Gs(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;Ve&&Ve.z<=je;){if(Ve.x>=J&&Ve.x<=ae&&Ve.y>=Q&&Ve.y<=_e&&Ve!==p&&Ve!==w&&nd(M,V,P,G,D,X,Ve.x,Ve.y)&&Gs(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.nextZ}return!0}function o_(s,i,o){var u=s;do{var p=u.prev,x=u.next.next;!Im(p,x)&&a_(p,u,u.next,x)&&qf(p,x)&&qf(x,p)&&(i.push(p.i/o|0),i.push(u.i/o|0),i.push(x.i/o|0),Vh(u),Vh(u.next),u=s=x),u=u.next}while(u!==s);return Uh(u)}function Am(s,i,o,u,p,x){var w=s;do{for(var M=w.next.next;M!==w.prev;){if(w.i!==M.i&&Sb(w,M)){var P=wx(w,M);return w=Uh(w,w.next),P=Uh(P,P.next),Gc(w,i,o,u,p,x,0),void Gc(P,i,o,u,p,x,0)}M=M.next}w=w.next}while(w!==s)}function wb(s,i){return s.x-i.x}function bx(s,i){var o=function(p,x){var w,M=x,P=p.x,D=p.y,V=-1/0;do{if(D<=M.y&&D>=M.next.y&&M.next.y!==M.y){var G=M.x+(D-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(G<=P&&G>V&&(V=G,w=M.x<M.next.x?M:M.next,G===P))return w}M=M.next}while(M!==x);if(!w)return null;var X,J=w,Q=w.x,ae=w.y,_e=1/0;M=w;do P>=M.x&&M.x>=Q&&P!==M.x&&nd(D<ae?P:V,D,Q,ae,D<ae?V:P,D,M.x,M.y)&&(X=Math.abs(D-M.y)/(P-M.x),qf(M,p)&&(X<_e||X===_e&&(M.x>w.x||M.x===w.x&&Tb(w,M)))&&(w=M,_e=X)),M=M.next;while(M!==J);return w}(s,i);if(!o)return i;var u=wx(o,s);return Uh(u,u.next),Uh(o,o.next)}function Tb(s,i){return Gs(s.prev,s,i.prev)<0&&Gs(i.next,s,s.next)<0}function km(s,i,o,u,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-u)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Eb(s){var i=s,o=s;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==s);return o}function nd(s,i,o,u,p,x,w,M){return(p-w)*(i-M)>=(s-w)*(x-M)&&(s-w)*(u-M)>=(o-w)*(i-M)&&(o-w)*(x-M)>=(p-w)*(u-M)}function Sb(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(o,u){var p=o;do{if(p.i!==o.i&&p.next.i!==o.i&&p.i!==u.i&&p.next.i!==u.i&&a_(p,p.next,o,u))return!0;p=p.next}while(p!==o);return!1}(s,i)&&(qf(s,i)&&qf(i,s)&&function(o,u){var p=o,x=!1,w=(o.x+u.x)/2,M=(o.y+u.y)/2;do p.y>M!=p.next.y>M&&p.next.y!==p.y&&w<(p.next.x-p.x)*(M-p.y)/(p.next.y-p.y)+p.x&&(x=!x),p=p.next;while(p!==o);return x}(s,i)&&(Gs(s.prev,s,i.prev)||Gs(s,i.prev,i))||Im(s,i)&&Gs(s.prev,s,s.next)>0&&Gs(i.prev,i,i.next)>0)}function Gs(s,i,o){return(i.y-s.y)*(o.x-i.x)-(i.x-s.x)*(o.y-i.y)}function Im(s,i){return s.x===i.x&&s.y===i.y}function a_(s,i,o,u){var p=Hf(Gs(s,i,o)),x=Hf(Gs(s,i,u)),w=Hf(Gs(o,u,s)),M=Hf(Gs(o,u,i));return p!==x&&w!==M||!(p!==0||!Pm(s,o,i))||!(x!==0||!Pm(s,u,i))||!(w!==0||!Pm(o,s,u))||!(M!==0||!Pm(o,i,u))}function Pm(s,i,o){return i.x<=Math.max(s.x,o.x)&&i.x>=Math.min(s.x,o.x)&&i.y<=Math.max(s.y,o.y)&&i.y>=Math.min(s.y,o.y)}function Hf(s){return s>0?1:s<0?-1:0}function qf(s,i){return Gs(s.prev,s,s.next)<0?Gs(s,i,s.next)>=0&&Gs(s,s.prev,i)>=0:Gs(s,i,s.prev)<0||Gs(s,s.next,i)<0}function wx(s,i){var o=new c_(s.i,s.x,s.y),u=new c_(i.i,i.x,i.y),p=s.next,x=i.prev;return s.next=i,i.prev=s,o.next=p,p.prev=o,u.next=o,o.prev=u,x.next=u,u.prev=x,u}function l_(s,i,o,u){var p=new c_(s,i,o);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Vh(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function c_(s,i,o){this.i=s,this.x=i,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xf(s,i,o,u){for(var p=0,x=i,w=o-u;x<o;x+=u)p+=(s[w]-s[x])*(s[x+1]+s[w+1]),w=x;return p}Mm.exports=Cm,Mm.exports.default=Cm,Cm.deviation=function(s,i,o,u){var p=i&&i.length,x=Math.abs(Xf(s,0,p?i[0]*o:s.length,o));if(p)for(var w=0,M=i.length;w<M;w++)x-=Math.abs(Xf(s,i[w]*o,w<M-1?i[w+1]*o:s.length,o));var P=0;for(w=0;w<u.length;w+=3){var D=u[w]*o,V=u[w+1]*o,G=u[w+2]*o;P+=Math.abs((s[D]-s[G])*(s[V+1]-s[D+1])-(s[D]-s[V])*(s[G+1]-s[D+1]))}return x===0&&P===0?0:Math.abs((P-x)/x)},Cm.flatten=function(s){for(var i=s[0][0].length,o={vertices:[],holes:[],dimensions:i},u=0,p=0;p<s.length;p++){for(var x=0;x<s[p].length;x++)for(var w=0;w<i;w++)o.vertices.push(s[p][x][w]);p>0&&o.holes.push(u+=s[p-1].length)}return o};var h_=he(Mm.exports);function Mb(s,i,o,u,p){Tx(s,i,o,u||s.length-1,p||Cb)}function Tx(s,i,o,u,p){for(;u>o;){if(u-o>600){var x=u-o+1,w=i-o+1,M=Math.log(x),P=.5*Math.exp(2*M/3),D=.5*Math.sqrt(M*P*(x-P)/x)*(w-x/2<0?-1:1);Tx(s,i,Math.max(o,Math.floor(i-w*P/x+D)),Math.min(u,Math.floor(i+(x-w)*P/x+D)),p)}var V=s[i],G=o,X=u;for(sd(s,o,i),p(s[u],V)>0&&sd(s,o,u);G<X;){for(sd(s,G,X),G++,X--;p(s[G],V)<0;)G++;for(;p(s[X],V)>0;)X--}p(s[o],V)===0?sd(s,o,X):sd(s,++X,u),X<=i&&(o=X+1),i<=X&&(u=X-1)}}function sd(s,i,o){var u=s[i];s[i]=s[o],s[o]=u}function Cb(s,i){return s<i?-1:s>i?1:0}function Lm(s,i){const o=s.length;if(o<=1)return[s];const u=[];let p,x;for(let w=0;w<o;w++){const M=ei(s[w]);M!==0&&(s[w].area=Math.abs(M),x===void 0&&(x=M<0),x===M<0?(p&&u.push(p),p=[s[w]]):p.push(s[w]))}if(p&&u.push(p),i>1)for(let w=0;w<u.length;w++)u[w].length<=i||(Mb(u[w],i,1,u[w].length-1,Ex),u[w]=u[w].slice(0,i));return u}function Ex(s,i){return i.area-s.area}function u_(s,i,o){const u=o.patternDependencies;let p=!1;for(const x of i){const w=x.paint.get(`${s}-pattern`);w.isConstant()||(p=!0);const M=w.constantOr(null);M&&(p=!0,u[M]=!0)}return p}function d_(s,i,o,u,p){const x=p.patternDependencies;for(const w of i){const M=w.paint.get(`${s}-pattern`).value;if(M.kind!=="constant"){let P=M.evaluate({zoom:u},o,{},p.availableImages);P=P&&P.name?P.name:P,x[P]=!0,o.patterns[w.id]=P}}return o}class Zf{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wt,this.indexArray=new Ci,this.indexArray2=new ur,this.programConfigurations=new Fc(i.layers,i.zoom),this.segments=new zs,this.segments2=new zs,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=i.projection}populate(i,o,u,p){this.hasPattern=u_("fill",this.layers,o);const x=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:M,id:P,index:D,sourceLayerIndex:V}of i){const G=this.layers[0]._featureFilter.needGeometry,X=Nh(M,G);if(!this.layers[0]._featureFilter.filter(new j(this.zoom),X,u))continue;const J=x?x.evaluate(X,{},u,o.availableImages):void 0,Q={id:P,properties:M.properties,type:M.type,sourceLayerIndex:V,index:D,geometry:G?X.geometry:Za(M,u,p),patterns:{},sortKey:J};w.push(Q)}x&&w.sort((M,P)=>M.sortKey-P.sortKey);for(const M of w){const{geometry:P,index:D,sourceLayerIndex:V}=M;if(this.hasPattern){const G=d_("fill",this.layers,M,this.zoom,o);this.patternFeatures.push(G)}else this.addFeature(M,P,D,u,{},o.availableImages);o.featureIndex.insert(i[D].feature,P,D,V,this.index)}}update(i,o,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,u,p)}addFeatures(i,o,u,p,x){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,o,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,vb),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,u,p,x,w=[]){for(const M of Lm(o,500)){let P=0;for(const Q of M)P+=Q.length;const D=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),V=D.vertexLength,G=[],X=[];for(const Q of M){if(Q.length===0)continue;Q!==M[0]&&X.push(G.length/2);const ae=this.segments2.prepareSegment(Q.length,this.layoutVertexArray,this.indexArray2),_e=ae.vertexLength;this.layoutVertexArray.emplaceBack(Q[0].x,Q[0].y),this.indexArray2.emplaceBack(_e+Q.length-1,_e),G.push(Q[0].x),G.push(Q[0].y);for(let Pe=1;Pe<Q.length;Pe++)this.layoutVertexArray.emplaceBack(Q[Pe].x,Q[Pe].y),this.indexArray2.emplaceBack(_e+Pe-1,_e+Pe),G.push(Q[Pe].x),G.push(Q[Pe].y);ae.vertexLength+=Q.length,ae.primitiveLength+=Q.length}const J=h_(G,X);for(let Q=0;Q<J.length;Q+=3)this.indexArray.emplaceBack(V+J[Q],V+J[Q+1],V+J[Q+2]);D.vertexLength+=P,D.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,x,w,p)}}bi(Zf,"FillBucket",{omit:["layers","patternFeatures"]});const Ab=new Re({"fill-sort-key":new we(Ct.layout_fill["fill-sort-key"])});var kb={paint:new Re({"fill-antialias":new re(Ct.paint_fill["fill-antialias"]),"fill-opacity":new we(Ct.paint_fill["fill-opacity"]),"fill-color":new we(Ct.paint_fill["fill-color"]),"fill-outline-color":new we(Ct.paint_fill["fill-outline-color"]),"fill-translate":new re(Ct.paint_fill["fill-translate"]),"fill-translate-anchor":new re(Ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new we(Ct.paint_fill["fill-pattern"])}),layout:Ab};const Ib=ot([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Pb=ot([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Sx=ot([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Mx}=Ib;var Dm={},Lb=ve,f_=rd;function rd(s,i,o,u,p){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=u,this._values=p,s.readFields(Cx,this,i)}function Cx(s,i,o){s==1?i.id=o.readVarint():s==2?function(u,p){for(var x=u.readVarint()+u.pos;u.pos<x;){var w=p._keys[u.readVarint()],M=p._values[u.readVarint()];p.properties[w]=M}}(o,i):s==3?i.type=o.readVarint():s==4&&(i._geometry=o.pos)}function Db(s){for(var i,o,u=0,p=0,x=s.length,w=x-1;p<x;w=p++)u+=((o=s[w]).x-(i=s[p]).x)*(i.y+o.y);return u}rd.types=["Unknown","Point","LineString","Polygon"],rd.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var i,o=s.readVarint()+s.pos,u=1,p=0,x=0,w=0,M=[];s.pos<o;){if(p<=0){var P=s.readVarint();u=7&P,p=P>>3}if(p--,u===1||u===2)x+=s.readSVarint(),w+=s.readSVarint(),u===1&&(i&&M.push(i),i=[]),i.push(new Lb(x,w));else{if(u!==7)throw new Error("unknown command "+u);i&&i.push(i[0].clone())}}return i&&M.push(i),M},rd.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var i=s.readVarint()+s.pos,o=1,u=0,p=0,x=0,w=1/0,M=-1/0,P=1/0,D=-1/0;s.pos<i;){if(u<=0){var V=s.readVarint();o=7&V,u=V>>3}if(u--,o===1||o===2)(p+=s.readSVarint())<w&&(w=p),p>M&&(M=p),(x+=s.readSVarint())<P&&(P=x),x>D&&(D=x);else if(o!==7)throw new Error("unknown command "+o)}return[w,P,M,D]},rd.prototype.toGeoJSON=function(s,i,o){var u,p,x=this.extent*Math.pow(2,o),w=this.extent*s,M=this.extent*i,P=this.loadGeometry(),D=rd.types[this.type];function V(J){for(var Q=0;Q<J.length;Q++){var ae=J[Q];J[Q]=[360*(ae.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+M)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(u=0;u<P.length;u++)G[u]=P[u][0];V(P=G);break;case 2:for(u=0;u<P.length;u++)V(P[u]);break;case 3:for(P=function(J){var Q=J.length;if(Q<=1)return[J];for(var ae,_e,Pe=[],je=0;je<Q;je++){var Le=Db(J[je]);Le!==0&&(_e===void 0&&(_e=Le<0),_e===Le<0?(ae&&Pe.push(ae),ae=[J[je]]):ae.push(J[je]))}return ae&&Pe.push(ae),Pe}(P),u=0;u<P.length;u++)for(p=0;p<P[u].length;p++)V(P[u][p])}P.length===1?P=P[0]:D="Multi"+D;var X={type:"Feature",geometry:{type:D,coordinates:P},properties:this.properties};return"id"in this&&(X.id=this.id),X};var Ax=f_,p_=kx;function kx(s,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Ix,this,i),this.length=this._features.length}function Ix(s,i,o){s===15?i.version=o.readVarint():s===1?i.name=o.readString():s===5?i.extent=o.readVarint():s===2?i._features.push(o.pos):s===3?i._keys.push(o.readString()):s===4&&i._values.push(function(u){for(var p=null,x=u.readVarint()+u.pos;u.pos<x;){var w=u.readVarint()>>3;p=w===1?u.readString():w===2?u.readFloat():w===3?u.readDouble():w===4?u.readVarint64():w===5?u.readVarint():w===6?u.readSVarint():w===7?u.readBoolean():null}return p}(o))}kx.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var i=this._pbf.readVarint()+this._pbf.pos;return new Ax(this._pbf,i,this.extent,this._keys,this._values)};var Ob=p_;function m_(s,i,o){if(s===3){var u=new Ob(o,o.readVarint()+o.pos);u.length&&(i[u.name]=u)}}var g_=Dm.VectorTile=function(s,i){this.layers=s.readFields(m_,{},i)},Yf=Dm.VectorTileFeature=f_;function Kf(s,i,o,u){const p=[],x=u===0?(w,M,P,D,V,G)=>{w.push(new Ne(G,P+(G-M)/(D-M)*(V-P)))}:(w,M,P,D,V,G)=>{w.push(new Ne(M+(G-P)/(V-P)*(D-M),G))};for(const w of s){const M=[];for(const P of w){if(P.length<=2)continue;const D=[];for(let X=0;X<P.length-1;X++){const J=P[X].x,Q=P[X].y,ae=P[X+1].x,_e=P[X+1].y,Pe=u===0?J:Q,je=u===0?ae:_e;Pe<i?je>i&&x(D,J,Q,ae,_e,i):Pe>o?je<o&&x(D,J,Q,ae,_e,o):D.push(P[X]),je<i&&Pe>=i&&x(D,J,Q,ae,_e,i),je>o&&Pe<=o&&x(D,J,Q,ae,_e,o)}let V=P[P.length-1];const G=u===0?V.x:V.y;G>=i&&G<=o&&D.push(V),D.length&&(V=D[D.length-1],D[0].x===V.x&&D[0].y===V.y||D.push(D[0]),M.push(D))}M.length&&p.push(M)}return p}Dm.VectorTileLayer=p_;const Rb=Yf.types,zb=Math.pow(2,13);function jh(s,i,o,u,p,x,w,M){s.emplaceBack((i<<1)+w,(o<<1)+x,(Math.floor(u*zb)<<1)+p,Math.round(M))}function Jf(s,i,o){s.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class Px{constructor(){this.acc=new Ne(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ne(i.x,i.y),this.max=new Ne(i.x,i.y))}append(i,o){this.currentPolyCount.edges++,this.acc._add(i);const u=this.min,p=this.max;i.x<u.x?u.x=i.x:i.x>p.x&&(p.x=i.x),i.y<u.y?u.y=i.y:i.y>p.y&&(p.y=i.y),((i.x===0||i.x===Ai)&&i.x===o.x)!=((i.y===0||i.y===Ai)&&i.y===o.y)&&this.processBorderOverlap(i,o),o.x<0!=i.x<0&&this.addBorderIntersection(0,_n(o.y,i.y,(0-o.x)/(i.x-o.x))),o.x>Ai!=i.x>Ai&&this.addBorderIntersection(1,_n(o.y,i.y,(Ai-o.x)/(i.x-o.x))),o.y<0!=i.y<0&&this.addBorderIntersection(2,_n(o.x,i.x,(0-o.y)/(i.y-o.y))),o.y>Ai!=i.y>Ai&&this.addBorderIntersection(3,_n(o.x,i.x,(Ai-o.y)/(i.y-o.y)))}addBorderIntersection(i,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[i];o<u[0]&&(u[0]=o),o>u[1]&&(u[1]=o)}processBorderOverlap(i,o){if(i.x===o.x){if(i.y===o.y)return;const u=i.x===0?0:1;this.addBorderIntersection(u,o.y),this.addBorderIntersection(u,i.y)}else{const u=i.y===0?2:3;this.addBorderIntersection(u,o.x),this.addBorderIntersection(u,i.x)}}centroid(){const i=this.polyCount.reduce((o,u)=>o+u.edges,0);return i!==0?this.acc.div(i)._round():new Ne(0,0)}span(){return new Ne(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,o)=>i+ +(o[0]!==Number.MAX_VALUE),0)}}class Qf{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.layoutVertexArray=new Lt,this.centroidVertexArray=new pa,this.indexArray=new Ci,this.programConfigurations=new Fc(i.layers,i.zoom),this.segments=new zs,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=i.enableTerrain}populate(i,o,u,p){this.features=[],this.hasPattern=u_("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(x){const w=Math.exp(Math.PI*(1-x.y/(1<<x.z)*2));return 80150034*w/(w*w+1)/Ai/(1<<x.z)}(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:x,id:w,index:M,sourceLayerIndex:P}of i){const D=this.layers[0]._featureFilter.needGeometry,V=Nh(x,D);if(!this.layers[0]._featureFilter.filter(new j(this.zoom),V,u))continue;const G={id:w,sourceLayerIndex:P,index:M,geometry:D?V.geometry:Za(x,u,p),properties:x.properties,type:x.type,patterns:{}},X=this.layoutVertexArray.length;this.hasPattern?this.features.push(d_("fill-extrusion",this.layers,G,this.zoom,o)):this.addFeature(G,G.geometry,M,u,{},o.availableImages,p),o.featureIndex.insert(x,G.geometry,M,P,this.index,X)}this.sortBorders()}addFeatures(i,o,u,p,x){for(const w of this.features){const{geometry:M}=w;this.addFeature(w,M,w.index,o,u,p,x)}this.sortBorders()}update(i,o,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Mx),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,Sx.members,!0))),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,Pb.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,u,p,x,w,M){const P=[new Ne(0,0),new Ne(Ai,Ai)],D=M.projection,V=D.name==="globe",G=this.enableTerrain&&!V?new Px:null,X=Rb[i.type]==="Polygon";V&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Xt);const J=Lm(o,500);for(let Pe=J.length-1;Pe>=0;Pe--){const je=J[Pe];(je.length===0||(Q=je[0]).every(Le=>Le.x<=0)||Q.every(Le=>Le.x>=Ai)||Q.every(Le=>Le.y<=0)||Q.every(Le=>Le.y>=Ai))&&J.splice(Pe,1)}var Q;let ae;if(V)ae=__(J,P,p);else{ae=[];for(const Pe of J)ae.push({polygon:Pe,bounds:P})}const _e=X?this.edgeRadius:0;for(const{polygon:Pe,bounds:je}of ae){let Le=0,Ve=0;for(const $e of Pe)X&&!$e[0].equals($e[$e.length-1])&&$e.push($e[0]),Ve+=X?$e.length-1:$e.length;const He=this.segments.prepareSegment((X?5:4)*Ve,this.layoutVertexArray,this.indexArray);if(X){const $e=[],bt=[];Le=He.vertexLength;for(const It of Pe){let Qt,Et;It.length&&It!==Pe[0]&&bt.push($e.length/2),Qt=It[1].sub(It[0])._perp()._unit();for(let Nt=1;Nt<It.length;Nt++){const Ut=It[Nt],Gt=It[Nt===It.length-1?1:Nt+1];let{x:si,y:At}=Ut;if(_e){Et=Gt.sub(Ut)._perp()._unit();const fi=Qt.add(Et)._unit(),Si=_e*Math.min(4,1/(Qt.x*fi.x+Qt.y*fi.y));si+=Si*fi.x,At+=Si*fi.y,Qt=Et}jh(this.layoutVertexArray,si,At,0,0,1,1,0),He.vertexLength++,$e.push(Ut.x,Ut.y),V&&Jf(this.layoutVertexExtArray,D.projectTilePoint(si,At,p),D.upVector(p,si,At))}}const gt=h_($e,bt);for(let It=0;It<gt.length;It+=3)this.indexArray.emplaceBack(Le+gt[It],Le+gt[It+2],Le+gt[It+1]),He.primitiveLength++}for(const $e of Pe){G&&$e.length&&G.startRing($e[0]);let bt,gt,It,Qt=$e.length>4&&Ox($e[$e.length-2],$e[0],$e[1]),Et=_e?Bb($e[$e.length-2],$e[0],$e[1],_e):0;gt=$e[1].sub($e[0])._perp()._unit();let Nt=!0;for(let Ut=1,Gt=0;Ut<$e.length;Ut++){let si=$e[Ut-1],At=$e[Ut];const fi=$e[Ut===$e.length-1?1:Ut+1];if(G&&X&&G.currentPolyCount.top++,ep(At,si,je)){_e&&(gt=fi.sub(At)._perp()._unit(),Nt=!Nt);continue}G&&G.append(At,si);const Si=At.sub(si)._perp(),_i=Si.x/(Math.abs(Si.x)+Math.abs(Si.y)),Ji=Si.y>0?1:0,ri=si.dist(At);if(Gt+ri>32768&&(Gt=0),_e){It=fi.sub(At)._perp()._unit();let en=Dx(si,At,fi,Lx(gt,It),_e);isNaN(en)&&(en=0);const Bi=At.sub(si)._unit();si=si.add(Bi.mult(Et))._round(),At=At.add(Bi.mult(-en))._round(),Et=en,gt=It}const Di=He.vertexLength,Qi=$e.length>4&&Ox(si,At,fi);let Pn=Rx(Gt,Qt,Nt);if(jh(this.layoutVertexArray,si.x,si.y,_i,Ji,0,0,Pn),jh(this.layoutVertexArray,si.x,si.y,_i,Ji,0,1,Pn),Gt+=ri,Pn=Rx(Gt,Qi,!Nt),Qt=Qi,jh(this.layoutVertexArray,At.x,At.y,_i,Ji,0,0,Pn),jh(this.layoutVertexArray,At.x,At.y,_i,Ji,0,1,Pn),He.vertexLength+=4,this.indexArray.emplaceBack(Di+0,Di+1,Di+2),this.indexArray.emplaceBack(Di+1,Di+3,Di+2),He.primitiveLength+=2,_e){const en=Le+(Ut===1?$e.length-2:Ut-2),Bi=Ut===1?Le:en+1;if(this.indexArray.emplaceBack(Di+1,en,Di+3),this.indexArray.emplaceBack(en,Bi,Di+3),He.primitiveLength+=2,bt===void 0&&(bt=Di),!ep(fi,$e[Ut],je)){const fs=Ut===$e.length-1?bt:He.vertexLength;this.indexArray.emplaceBack(Di+2,Di+3,fs),this.indexArray.emplaceBack(Di+3,fs+1,fs),this.indexArray.emplaceBack(Di+3,Bi,fs+1),He.primitiveLength+=3}Nt=!Nt}if(V){const en=this.layoutVertexExtArray,Bi=D.projectTilePoint(si.x,si.y,p),fs=D.projectTilePoint(At.x,At.y,p),sn=D.upVector(p,si.x,si.y),rn=D.upVector(p,At.x,At.y);Jf(en,Bi,sn),Jf(en,Bi,sn),Jf(en,fs,rn),Jf(en,fs,rn)}}X&&(Le+=$e.length-1)}}if(G&&G.polyCount.length>0){if(G.borders){G.vertexArrayOffset=this.centroidVertexArray.length;const Pe=G.borders,je=this.featuresOnBorder.push(G)-1;for(let Le=0;Le<4;Le++)Pe[Le][0]!==Number.MAX_VALUE&&this.borders[Le].push(je)}this.encodeCentroid(G.borders?void 0:G.centroid(),G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,x,w,p)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((o,u)=>this.featuresOnBorder[o].borders[i][0]-this.featuresOnBorder[u].borders[i][0])}encodeCentroid(i,o,u=!0){let p,x;if(i)if(i.y!==0){const M=o.span()._mult(this.tileToMeter);p=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(M.x/10)),x=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(M.y/10))}else p=Math.ceil(7*(i.x+450)),x=0;else p=0,x=+u;let w=u?this.centroidVertexArray.length:o.vertexArrayOffset;for(const M of o.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*M.edges+M.top);for(let P=0;P<M.top;P++)this.centroidVertexArray.emplace(w++,p,x);for(let P=0;P<2*M.edges;P++)this.centroidVertexArray.emplace(w++,0,x),this.centroidVertexArray.emplace(w++,p,x)}}}function Lx(s,i){const o=s.add(i)._unit();return s.x*o.x+s.y*o.y}function Bb(s,i,o,u){const p=i.sub(s)._perp()._unit(),x=o.sub(i)._perp()._unit();return Dx(s,i,o,Lx(p,x),u)}function Dx(s,i,o,u,p){const x=Math.sqrt(1-u*u);return Math.min(s.dist(i)/3,i.dist(o)/3,p*x/u)}function ep(s,i,o){return s.x<o[0].x&&i.x<o[0].x||s.x>o[1].x&&i.x>o[1].x||s.y<o[0].y&&i.y<o[0].y||s.y>o[1].y&&i.y>o[1].y}function Ox(s,i,o){if(s.x<0||s.x>=Ai||i.x<0||i.x>=Ai||o.x<0||o.x>=Ai)return!1;const u=o.sub(i),p=u.perp(),x=s.sub(i);return(u.x*x.x+u.y*x.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(x.x*x.x+x.y*x.y))>-.866&&p.x*x.x+p.y*x.y<0}function Rx(s,i,o){const u=i?2|s:-3&s;return o?1|u:-2&u}function zx(){const s=Math.PI/32,i=Math.tan(s),o=Bf;return o*Math.sqrt(1+2*i*i)-o}function __(s,i,o){const u=1<<o.z,p=Ho(o.x/u),x=Ho((o.x+1)/u),w=kr(o.y/u),M=kr((o.y+1)/u);return function(P,D,V,G,X=0,J){const Q=[];if(!P.length||!V||!G)return Q;const ae=($e,bt)=>{for(const gt of $e)Q.push({polygon:gt,bounds:bt})},_e=Math.ceil(Math.log2(V)),Pe=Math.ceil(Math.log2(G)),je=_e-Pe,Le=[];for(let $e=0;$e<Math.abs(je);$e++)Le.push(je>0?0:1);for(let $e=0;$e<Math.min(_e,Pe);$e++)Le.push(0),Le.push(1);let Ve=P;if(Ve=Kf(Ve,D[0].y-X,D[1].y+X,1),Ve=Kf(Ve,D[0].x-X,D[1].x+X,0),!Ve.length)return Q;const He=[];for(Le.length?He.push({polygons:Ve,bounds:D,depth:0}):ae(Ve,D);He.length;){const $e=He.pop(),bt=$e.depth,gt=Le[bt],It=$e.bounds[0],Qt=$e.bounds[1],Et=gt===0?It.x:It.y,Nt=gt===0?Qt.x:Qt.y,Ut=J?J(gt,Et,Nt):.5*(Et+Nt),Gt=Kf($e.polygons,Et-X,Ut+X,gt),si=Kf($e.polygons,Ut-X,Nt+X,gt);if(Gt.length){const At=[It,new Ne(gt===0?Ut:Qt.x,gt===1?Ut:Qt.y)];Le.length>bt+1?He.push({polygons:Gt,bounds:At,depth:bt+1}):ae(Gt,At)}if(si.length){const At=[new Ne(gt===0?Ut:It.x,gt===1?Ut:It.y),Qt];Le.length>bt+1?He.push({polygons:si,bounds:At,depth:bt+1}):ae(si,At)}}return Q}(s,i,Math.ceil((x-p)/11.25),Math.ceil((w-M)/11.25),1,(P,D,V)=>{if(P===0)return .5*(D+V);{const G=kr((o.y+D/Ai)/u);return(ya(.5*(kr((o.y+V/Ai)/u)+G))*u-o.y)*Ai}})}bi(Qf,"FillExtrusionBucket",{omit:["layers","features"]}),bi(Px,"PartMetadata");const F=new Re({"fill-extrusion-edge-radius":new re(Ct["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var c={paint:new Re({"fill-extrusion-opacity":new re(Ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new we(Ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new re(Ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new re(Ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new we(Ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new we(Ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new we(Ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new re(Ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new re(Ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new re(Ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new re(Ct["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:F};function m(s,i,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[s*u-2*Math.PI*6378137/2,i*u-2*Math.PI*6378137/2]}class y{constructor(i,o,u){this.z=i,this.x=o,this.y=u,this.key=k(0,i,i,o,u)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o){const u=function(x,w,M){var P=m(256*x,256*(w=Math.pow(2,M)-w-1),M),D=m(256*(x+1),256*(w+1),M);return P[0]+","+P[1]+","+D[0]+","+D[1]}(this.x,this.y,this.z),p=function(x,w,M){let P,D="";for(let V=x;V>0;V--)P=1<<V-1,D+=(w&P?1:0)+(M&P?2:0);return D}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class T{constructor(i,o){this.wrap=i,this.canonical=o,this.key=k(i,o.z,o.z,o.x,o.y)}}class E{constructor(i,o,u,p,x){this.overscaledZ=i,this.wrap=o,this.canonical=new y(u,+p,+x),this.key=o===0&&i===u?this.canonical.key:k(o,i,u,p,x)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const o=this.canonical.z-i;return i>this.canonical.z?new E(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new E(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o=!0){if(this.overscaledZ===i&&o)return this.key;if(i>this.canonical.z)return k(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-i;return k(this.wrap*+o,i,i,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new E(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new E(o,this.wrap,o,u,p),new E(o,this.wrap,o,u+1,p),new E(o,this.wrap,o,u,p+1),new E(o,this.wrap,o,u+1,p+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new E(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new E(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new T(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function k(s,i,o,u,p){const x=1<<Math.min(o,22);let w=x*(p%x)+u%x;return s&&o<22&&(w+=x*x*((s<0?-2*s-1:2*s)%(1<<2*(22-o)))),16*(32*w+o)+(i-o)}bi(y,"CanonicalTileID"),bi(E,"OverscaledTileID",{omit:["projMatrix"]});class I extends Ne{constructor(i,o,u){super(i,o),this.z=u}}function L(s,i){return s.x*i.x+s.y*i.y}function B(s,i){if(s.length===1){let o=0;const u=i[o++];let p;for(;!p||u.equals(p);)if(p=i[o++],!p)return 1/0;for(;o<i.length;o++){const x=i[o],w=s[0],M=p.sub(u),P=x.sub(u),D=w.sub(u),V=L(M,M),G=L(M,P),X=L(P,P),J=L(D,M),Q=L(D,P),ae=V*X-G*G,_e=(X*J-G*Q)/ae,Pe=(V*Q-G*J)/ae,je=u.z*(1-_e-Pe)+p.z*_e+x.z*Pe;if(isFinite(je))return je}return 1/0}{let o=1/0;for(const u of i)o=Math.min(o,u.z);return o}}function W(s,i,o,u,p,x,w,M){const P=w*p.getElevationAt(s,i,!0,!0),D=x[0]!==0,V=D?x[1]===0?w*(x[0]/7-450):w*function(G,X,J){const Q=Math.floor(X[0]/8),ae=Math.floor(X[1]/8),_e=10*(X[0]-8*Q),Pe=10*(X[1]-8*ae),je=G.getElevationAt(Q,ae,!0,!0),Le=G.getMeterToDEM(J),Ve=Math.floor(.5*(_e*Le-1)),He=Math.floor(.5*(Pe*Le-1)),$e=G.tileCoordToPixel(Q,ae),bt=2*Ve+1,gt=2*He+1,It=function(si,At,fi,Si,_i){return[si.getElevationAtPixel(At,fi,!0),si.getElevationAtPixel(At+_i,fi,!0),si.getElevationAtPixel(At,fi+_i,!0),si.getElevationAtPixel(At+Si,fi+_i,!0)]}(G,$e.x-Ve,$e.y-He,bt,gt),Qt=Math.abs(It[0]-It[1]),Et=Math.abs(It[2]-It[3]),Nt=Math.abs(It[0]-It[2])+Math.abs(It[1]-It[3]),Ut=Math.min(.25,.5*Le*(Qt+Et)/bt),Gt=Math.min(.25,.5*Le*Nt/gt);return je+Math.max(Ut*_e,Gt*Pe)}(p,x,M):P;return{base:P+(o===0)?-1:o,top:D?Math.max(V+u,P+o+2):P+u}}const N=ot([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:H}=N,K=ot([{name:"a_packed",components:4,type:"Float32"}]),{members:te}=K,ce=Yf.types,le=Math.cos(Math.PI/180*37.5);class oe{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new wt,this.layoutVertexArray2=new qt,this.indexArray=new Ci,this.programConfigurations=new Fc(i.layers,i.zoom),this.segments=new zs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,u,p){this.hasPattern=u_("line",this.layers,o);const x=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:V,id:G,index:X,sourceLayerIndex:J}of i){const Q=this.layers[0]._featureFilter.needGeometry,ae=Nh(V,Q);if(!this.layers[0]._featureFilter.filter(new j(this.zoom),ae,u))continue;const _e=x?x.evaluate(ae,{},u):void 0,Pe={id:G,properties:V.properties,type:V.type,sourceLayerIndex:J,index:X,geometry:Q?ae.geometry:Za(V,u,p),patterns:{},sortKey:_e};w.push(Pe)}x&&w.sort((V,G)=>V.sortKey-G.sortKey);const{lineAtlas:M,featureIndex:P}=o,D=this.addConstantDashes(M);for(const V of w){const{geometry:G,index:X,sourceLayerIndex:J}=V;if(D&&this.addFeatureDashes(V,M),this.hasPattern){const Q=d_("line",this.layers,V,this.zoom,o);this.patternFeatures.push(Q)}else this.addFeature(V,G,X,u,M.positions,o.availableImages);P.insert(i[X].feature,G,X,J,this.index)}}addConstantDashes(i){let o=!1;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,x=u.layout.get("line-cap").value;if(p.kind!=="constant"||x.kind!=="constant")o=!0;else{const w=x.value,M=p.value;if(!M)continue;i.addDash(M,w)}}return o}addFeatureDashes(i,o){const u=this.zoom;for(const p of this.layers){const x=p.paint.get("line-dasharray").value,w=p.layout.get("line-cap").value;if(x.kind==="constant"&&w.kind==="constant")continue;let M,P;if(x.kind==="constant"){if(M=x.value,!M)continue}else M=x.evaluate({zoom:u},i);P=w.kind==="constant"?w.value:w.evaluate({zoom:u},i),o.addDash(M,P),i.patterns[p.id]=o.getKey(M,P)}}update(i,o,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,u,p)}addFeatures(i,o,u,p,x){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,o,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,te)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,H),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,u,p,x,w){const M=this.layers[0].layout,P=M.get("line-join").evaluate(i,{}),D=M.get("line-cap").evaluate(i,{}),V=M.get("line-miter-limit"),G=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const X of o)this.addLine(X,i,P,D,V,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,x,w,p)}addLine(i,o,u,p,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Pe=0;Pe<i.length-1;Pe++)this.totalDistance+=i[Pe].dist(i[Pe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=ce[o.type]==="Polygon";let P=i.length;for(;P>=2&&i[P-1].equals(i[P-2]);)P--;let D=0;for(;D<P-1&&i[D].equals(i[D+1]);)D++;if(P<(M?3:2))return;u==="bevel"&&(x=1.05);const V=this.overscaling<=16?15*Ai/(512*this.overscaling):0,G=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let X,J,Q,ae,_e;this.e1=this.e2=-1,M&&(X=i[P-2],_e=i[D].sub(X)._unit()._perp());for(let Pe=D;Pe<P;Pe++){if(Q=Pe===P-1?M?i[D+1]:void 0:i[Pe+1],Q&&i[Pe].equals(Q))continue;_e&&(ae=_e),X&&(J=X),X=i[Pe],_e=Q?Q.sub(X)._unit()._perp():ae,ae=ae||_e;let je=ae.add(_e);je.x===0&&je.y===0||je._unit();const Le=ae.x*_e.x+ae.y*_e.y,Ve=je.x*_e.x+je.y*_e.y,He=Ve!==0?1/Ve:1/0,$e=2*Math.sqrt(2-2*Ve),bt=Ve<le&&J&&Q,gt=ae.x*_e.y-ae.y*_e.x>0;if(bt&&Pe>D){const Et=X.dist(J);if(Et>2*V){const Nt=X.sub(X.sub(J)._mult(V/Et)._round());this.updateDistance(J,Nt),this.addCurrentVertex(Nt,ae,0,0,G),J=Nt}}const It=J&&Q;let Qt=It?u:M?"butt":p;if(It&&Qt==="round"&&(He<w?Qt="miter":He<=2&&(Qt="fakeround")),Qt==="miter"&&He>x&&(Qt="bevel"),Qt==="bevel"&&(He>2&&(Qt="flipbevel"),He<x&&(Qt="miter")),J&&this.updateDistance(J,X),Qt==="miter")je._mult(He),this.addCurrentVertex(X,je,0,0,G);else if(Qt==="flipbevel"){if(He>100)je=_e.mult(-1);else{const Et=He*ae.add(_e).mag()/ae.sub(_e).mag();je._perp()._mult(Et*(gt?-1:1))}this.addCurrentVertex(X,je,0,0,G),this.addCurrentVertex(X,je.mult(-1),0,0,G)}else if(Qt==="bevel"||Qt==="fakeround"){const Et=-Math.sqrt(He*He-1),Nt=gt?Et:0,Ut=gt?0:Et;if(J&&this.addCurrentVertex(X,ae,Nt,Ut,G),Qt==="fakeround"){const Gt=Math.round(180*$e/Math.PI/20);for(let si=1;si<Gt;si++){let At=si/Gt;if(At!==.5){const Si=At-.5;At+=At*Si*(At-1)*((1.0904+Le*(Le*(3.55645-1.43519*Le)-3.2452))*Si*Si+(.848013+Le*(.215638*Le-1.06021)))}const fi=_e.sub(ae)._mult(At)._add(ae)._unit()._mult(gt?-1:1);this.addHalfVertex(X,fi.x,fi.y,!1,gt,0,G)}}Q&&this.addCurrentVertex(X,_e,-Nt,-Ut,G)}else if(Qt==="butt")this.addCurrentVertex(X,je,0,0,G);else if(Qt==="square"){const Et=J?1:-1;J||this.addCurrentVertex(X,je,Et,Et,G),this.addCurrentVertex(X,je,0,0,G),J&&this.addCurrentVertex(X,je,Et,Et,G)}else Qt==="round"&&(J&&(this.addCurrentVertex(X,ae,0,0,G),this.addCurrentVertex(X,ae,1,1,G,!0)),Q&&(this.addCurrentVertex(X,_e,-1,-1,G,!0),this.addCurrentVertex(X,_e,0,0,G)));if(bt&&Pe<P-1){const Et=X.dist(Q);if(Et>2*V){const Nt=X.add(Q.sub(X)._mult(V/Et)._round());this.updateDistance(X,Nt),this.addCurrentVertex(Nt,_e,0,0,G),X=Nt}}}}addCurrentVertex(i,o,u,p,x,w=!1){const M=o.y*p-o.x,P=-o.y-o.x*p;this.addHalfVertex(i,o.x+o.y*u,o.y-o.x*u,w,!1,u,x),this.addHalfVertex(i,M,P,w,!0,-p,x)}addHalfVertex({x:i,y:o},u,p,x,w,M,P){this.layoutVertexArray.emplaceBack((i<<1)+(x?1:0),(o<<1)+(w?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(M===0?0:M<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const D=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),P.primitiveLength++),w?this.e2=D:this.e1=D}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}}bi(oe,"LineBucket",{omit:["layers","patternFeatures"]});const me=new Re({"line-cap":new we(Ct.layout_line["line-cap"]),"line-join":new we(Ct.layout_line["line-join"]),"line-miter-limit":new re(Ct.layout_line["line-miter-limit"]),"line-round-limit":new re(Ct.layout_line["line-round-limit"]),"line-sort-key":new we(Ct.layout_line["line-sort-key"])});var xe={paint:new Re({"line-opacity":new we(Ct.paint_line["line-opacity"]),"line-color":new we(Ct.paint_line["line-color"]),"line-translate":new re(Ct.paint_line["line-translate"]),"line-translate-anchor":new re(Ct.paint_line["line-translate-anchor"]),"line-width":new we(Ct.paint_line["line-width"]),"line-gap-width":new we(Ct.paint_line["line-gap-width"]),"line-offset":new we(Ct.paint_line["line-offset"]),"line-blur":new we(Ct.paint_line["line-blur"]),"line-dasharray":new we(Ct.paint_line["line-dasharray"]),"line-pattern":new we(Ct.paint_line["line-pattern"]),"line-gradient":new De(Ct.paint_line["line-gradient"]),"line-trim-offset":new re(Ct.paint_line["line-trim-offset"])}),layout:me};const et=new class extends we{possiblyEvaluate(s,i){return i=new j(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(s,i)}evaluate(s,i,o,u){return i=Hi({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(s,i,o,u)}}(xe.paint.properties["line-width"].specification);function Ge(s,i){return i>0?i+2*s:s}et.useIntegerZoom=!0;const Ze=ot([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yt=ot([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),at=ot([{name:"a_projected_pos",components:4,type:"Float32"}],4);ot([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const vt=ot([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Vt=ot([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ot([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ii=ot([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),li=ot([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ot([{name:"triangle",components:3,type:"Uint16"}]),ot([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ot([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ot([{type:"Float32",name:"offsetX"}]),ot([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var $t=24;const gi=128;function vi(s,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new j(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=o;let x=0;for(;x<u.length&&u[x]<=s;)x++;x=Math.max(0,x-1);let w=x;for(;w<u.length&&u[w]<s+1;)w++;w=Math.min(u.length-1,w);const M=u[x],P=u[w];return o.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:P,interpolationType:p}:{kind:"camera",minZoom:M,maxZoom:P,minSize:o.evaluate(new j(M)),maxSize:o.evaluate(new j(P)),interpolationType:p}}}function Wi(s,{uSize:i,uSizeT:o},{lowerSize:u,upperSize:p}){return s.kind==="source"?u/gi:s.kind==="composite"?_n(u/gi,p/gi,o):i}function Ti(s,i){let o=0,u=0;if(s.kind==="constant")u=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:p,minZoom:x,maxZoom:w}=s,M=p?ci(fo.interpolationFactor(p,i,x,w),0,1):0;s.kind==="camera"?u=_n(s.minSize,s.maxSize,M):o=M}return{uSizeT:o,uSize:u}}var Gi=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:gi,evaluateSizeForFeature:Wi,evaluateSizeForZoom:Ti,getSizeData:vi});function xn(s,i,o){return s.sections.forEach(u=>{u.text=function(p,x,w){const M=x.layout.get("text-transform").evaluate(w,{});return M==="uppercase"?p=p.toLocaleUpperCase():M==="lowercase"&&(p=p.toLocaleLowerCase()),z.applyArabicShaping&&(p=z.applyArabicShaping(p)),p}(u.text,i,o)}),s}const hn={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function En(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}function zr(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}var vn=xi,Wn=function(s,i,o,u,p){var x,w,M=8*p-u-1,P=(1<<M)-1,D=P>>1,V=-7,G=p-1,X=-1,J=s[i+G];for(G+=X,x=J&(1<<-V)-1,J>>=-V,V+=M;V>0;x=256*x+s[i+G],G+=X,V-=8);for(w=x&(1<<-V)-1,x>>=-V,V+=u;V>0;w=256*w+s[i+G],G+=X,V-=8);if(x===0)x=1-D;else{if(x===P)return w?NaN:1/0*(J?-1:1);w+=Math.pow(2,u),x-=D}return(J?-1:1)*w*Math.pow(2,x-u)},Ki=function(s,i,o,u,p,x){var w,M,P,D=8*x-p-1,V=(1<<D)-1,G=V>>1,X=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,J=0,Q=1,ae=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(M=isNaN(i)?1:0,w=V):(w=Math.floor(Math.log(i)/Math.LN2),i*(P=Math.pow(2,-w))<1&&(w--,P*=2),(i+=w+G>=1?X/P:X*Math.pow(2,1-G))*P>=2&&(w++,P/=2),w+G>=V?(M=0,w=V):w+G>=1?(M=(i*P-1)*Math.pow(2,p),w+=G):(M=i*Math.pow(2,G-1)*Math.pow(2,p),w=0));p>=8;s[o+J]=255&M,J+=Q,M/=256,p-=8);for(w=w<<p|M,D+=p;D>0;s[o+J]=255&w,J+=Q,w/=256,D-=8);s[o+J-Q]|=128*ae};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function xi(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}xi.Varint=0,xi.Fixed64=1,xi.Bytes=2,xi.Fixed32=5;var Bs=4294967296,Gn=1/Bs,rs=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ds(s){return s.type===xi.Bytes?s.readVarint()+s.pos:s.pos+1}function wo(s,i,o){return o?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}function Xo(s,i,o){var u=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));o.realloc(u);for(var p=o.pos-1;p>=s;p--)o.buf[p+u]=o.buf[p]}function xa(s,i){for(var o=0;o<s.length;o++)i.writeVarint(s[o])}function ro(s,i){for(var o=0;o<s.length;o++)i.writeSVarint(s[o])}function er(s,i){for(var o=0;o<s.length;o++)i.writeFloat(s[o])}function tp(s,i){for(var o=0;o<s.length;o++)i.writeDouble(s[o])}function Hc(s,i){for(var o=0;o<s.length;o++)i.writeBoolean(s[o])}function $h(s,i){for(var o=0;o<s.length;o++)i.writeFixed32(s[o])}function ip(s,i){for(var o=0;o<s.length;o++)i.writeSFixed32(s[o])}function Ya(s,i){for(var o=0;o<s.length;o++)i.writeFixed64(s[o])}function od(s,i){for(var o=0;o<s.length;o++)i.writeSFixed64(s[o])}function np(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+16777216*s[i+3]}function Om(s,i,o){s[o]=i,s[o+1]=i>>>8,s[o+2]=i>>>16,s[o+3]=i>>>24}function sE(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+(s[i+3]<<24)}xi.prototype={destroy:function(){this.buf=null},readFields:function(s,i,o){for(o=o||this.length;this.pos<o;){var u=this.readVarint(),p=u>>3,x=this.pos;this.type=7&u,s(p,i,this),this.pos===x&&this.skip(u)}return i},readMessage:function(s,i){return this.readFields(s,i,this.readVarint()+this.pos)},readFixed32:function(){var s=np(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=sE(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=np(this.buf,this.pos)+np(this.buf,this.pos+4)*Bs;return this.pos+=8,s},readSFixed64:function(){var s=np(this.buf,this.pos)+sE(this.buf,this.pos+4)*Bs;return this.pos+=8,s},readFloat:function(){var s=Wn(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Wn(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var i,o,u=this.buf;return i=127&(o=u[this.pos++]),o<128?i:(i|=(127&(o=u[this.pos++]))<<7,o<128?i:(i|=(127&(o=u[this.pos++]))<<14,o<128?i:(i|=(127&(o=u[this.pos++]))<<21,o<128?i:function(p,x,w){var M,P,D=w.buf;if(M=(112&(P=D[w.pos++]))>>4,P<128||(M|=(127&(P=D[w.pos++]))<<3,P<128)||(M|=(127&(P=D[w.pos++]))<<10,P<128)||(M|=(127&(P=D[w.pos++]))<<17,P<128)||(M|=(127&(P=D[w.pos++]))<<24,P<128)||(M|=(1&(P=D[w.pos++]))<<31,P<128))return wo(p,M,x);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(o=u[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,i=this.pos;return this.pos=s,s-i>=12&&rs?function(o,u,p){return rs.decode(o.subarray(u,p))}(this.buf,i,s):function(o,u,p){for(var x="",w=u;w<p;){var M,P,D,V=o[w],G=null,X=V>239?4:V>223?3:V>191?2:1;if(w+X>p)break;X===1?V<128&&(G=V):X===2?(192&(M=o[w+1]))==128&&(G=(31&V)<<6|63&M)<=127&&(G=null):X===3?(P=o[w+2],(192&(M=o[w+1]))==128&&(192&P)==128&&((G=(15&V)<<12|(63&M)<<6|63&P)<=2047||G>=55296&&G<=57343)&&(G=null)):X===4&&(P=o[w+2],D=o[w+3],(192&(M=o[w+1]))==128&&(192&P)==128&&(192&D)==128&&((G=(15&V)<<18|(63&M)<<12|(63&P)<<6|63&D)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,X=1):G>65535&&(G-=65536,x+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),x+=String.fromCharCode(G),w+=X}return x}(this.buf,i,s)},readBytes:function(){var s=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,s);return this.pos=s,i},readPackedVarint:function(s,i){if(this.type!==xi.Bytes)return s.push(this.readVarint(i));var o=ds(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(i));return s},readPackedSVarint:function(s){if(this.type!==xi.Bytes)return s.push(this.readSVarint());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==xi.Bytes)return s.push(this.readBoolean());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==xi.Bytes)return s.push(this.readFloat());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==xi.Bytes)return s.push(this.readDouble());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==xi.Bytes)return s.push(this.readFixed32());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==xi.Bytes)return s.push(this.readSFixed32());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==xi.Bytes)return s.push(this.readFixed64());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==xi.Bytes)return s.push(this.readSFixed64());var i=ds(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed64());return s},skip:function(s){var i=7&s;if(i===xi.Varint)for(;this.buf[this.pos++]>127;);else if(i===xi.Bytes)this.pos=this.readVarint()+this.pos;else if(i===xi.Fixed32)this.pos+=4;else{if(i!==xi.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(s,i){this.writeVarint(s<<3|i)},realloc:function(s){for(var i=this.length||16;i<this.pos+s;)i*=2;if(i!==this.length){var o=new Uint8Array(i);o.set(this.buf),this.buf=o,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Om(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Om(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Om(this.buf,-1&s,this.pos),Om(this.buf,Math.floor(s*Gn),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Om(this.buf,-1&s,this.pos),Om(this.buf,Math.floor(s*Gn),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(i,o){var u,p;if(i>=0?(u=i%4294967296|0,p=i/4294967296|0):(p=~(-i/4294967296),4294967295^(u=~(-i%4294967296))?u=u+1|0:(u=0,p=p+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(x,w,M){M.buf[M.pos++]=127&x|128,x>>>=7,M.buf[M.pos++]=127&x|128,x>>>=7,M.buf[M.pos++]=127&x|128,x>>>=7,M.buf[M.pos++]=127&x|128,M.buf[M.pos]=127&(x>>>=7)}(u,0,o),function(x,w){var M=(7&x)<<4;w.buf[w.pos++]|=M|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(p,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var i=this.pos;this.pos=function(u,p,x){for(var w,M,P=0;P<p.length;P++){if((w=p.charCodeAt(P))>55295&&w<57344){if(!M){w>56319||P+1===p.length?(u[x++]=239,u[x++]=191,u[x++]=189):M=w;continue}if(w<56320){u[x++]=239,u[x++]=191,u[x++]=189,M=w;continue}w=M-55296<<10|w-56320|65536,M=null}else M&&(u[x++]=239,u[x++]=191,u[x++]=189,M=null);w<128?u[x++]=w:(w<2048?u[x++]=w>>6|192:(w<65536?u[x++]=w>>12|224:(u[x++]=w>>18|240,u[x++]=w>>12&63|128),u[x++]=w>>6&63|128),u[x++]=63&w|128)}return x}(this.buf,s,this.pos);var o=this.pos-i;o>=128&&Xo(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),Ki(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Ki(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var i=s.length;this.writeVarint(i),this.realloc(i);for(var o=0;o<i;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,i){this.pos++;var o=this.pos;s(i,this);var u=this.pos-o;u>=128&&Xo(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeMessage:function(s,i,o){this.writeTag(s,xi.Bytes),this.writeRawMessage(i,o)},writePackedVarint:function(s,i){i.length&&this.writeMessage(s,xa,i)},writePackedSVarint:function(s,i){i.length&&this.writeMessage(s,ro,i)},writePackedBoolean:function(s,i){i.length&&this.writeMessage(s,Hc,i)},writePackedFloat:function(s,i){i.length&&this.writeMessage(s,er,i)},writePackedDouble:function(s,i){i.length&&this.writeMessage(s,tp,i)},writePackedFixed32:function(s,i){i.length&&this.writeMessage(s,$h,i)},writePackedSFixed32:function(s,i){i.length&&this.writeMessage(s,ip,i)},writePackedFixed64:function(s,i){i.length&&this.writeMessage(s,Ya,i)},writePackedSFixed64:function(s,i){i.length&&this.writeMessage(s,od,i)},writeBytesField:function(s,i){this.writeTag(s,xi.Bytes),this.writeBytes(i)},writeFixed32Field:function(s,i){this.writeTag(s,xi.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(s,i){this.writeTag(s,xi.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(s,i){this.writeTag(s,xi.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(s,i){this.writeTag(s,xi.Fixed64),this.writeSFixed64(i)},writeVarintField:function(s,i){this.writeTag(s,xi.Varint),this.writeVarint(i)},writeSVarintField:function(s,i){this.writeTag(s,xi.Varint),this.writeSVarint(i)},writeStringField:function(s,i){this.writeTag(s,xi.Bytes),this.writeString(i)},writeFloatField:function(s,i){this.writeTag(s,xi.Fixed32),this.writeFloat(i)},writeDoubleField:function(s,i){this.writeTag(s,xi.Fixed64),this.writeDouble(i)},writeBooleanField:function(s,i){this.writeVarintField(s,!!i)}};var Bx=he(vn);const Fb=3;function ID(s,i,o){i.glyphs=[],s===1&&o.readMessage(PD,i)}function PD(s,i,o){if(s===3){const{id:u,bitmap:p,width:x,height:w,left:M,top:P,advance:D}=o.readMessage(LD,{});i.glyphs.push({id:u,bitmap:new Zl({width:x+2*Fb,height:w+2*Fb},p),metrics:{width:x,height:w,left:M,top:P,advance:D}})}else s===4?i.ascender=o.readSVarint():s===5&&(i.descender=o.readSVarint())}function LD(s,i,o){s===1?i.id=o.readVarint():s===2?i.bitmap=o.readBytes():s===3?i.width=o.readVarint():s===4?i.height=o.readVarint():s===5?i.left=o.readSVarint():s===6?i.top=o.readSVarint():s===7&&(i.advance=o.readVarint())}const DD=Fb;function Nb(s){let i=0,o=0;for(const w of s)i+=w.w*w.h,o=Math.max(o,w.w);s.sort((w,M)=>M.h-w.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let p=0,x=0;for(const w of s)for(let M=u.length-1;M>=0;M--){const P=u[M];if(!(w.w>P.w||w.h>P.h)){if(w.x=P.x,w.y=P.y,x=Math.max(x,w.y+w.h),p=Math.max(p,w.x+w.w),w.w===P.w&&w.h===P.h){const D=u.pop();M<u.length&&(u[M]=D)}else w.h===P.h?(P.x+=w.w,P.w-=w.w):w.w===P.w?(P.y+=w.h,P.h-=w.h):(u.push({x:P.x+w.w,y:P.y,w:P.w-w.w,h:w.h}),P.y+=w.h,P.h-=w.h);break}}return{w:p,h:x,fill:i/(p*x)||0}}const Zo=1;class Ub{constructor(i,{pixelRatio:o,version:u,stretchX:p,stretchY:x,content:w}){this.paddedRect=i,this.pixelRatio=o,this.stretchX=p,this.stretchY=x,this.content=w,this.version=u}get tl(){return[this.paddedRect.x+Zo,this.paddedRect.y+Zo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Zo,this.paddedRect.y+this.paddedRect.h-Zo]}get displaySize(){return[(this.paddedRect.w-2*Zo)/this.pixelRatio,(this.paddedRect.h-2*Zo)/this.pixelRatio]}}class rE{constructor(i,o){const u={},p={};this.haveRenderCallbacks=[];const x=[];this.addImages(i,u,x),this.addImages(o,p,x);const{w,h:M}=Nb(x),P=new bo({width:w||1,height:M||1});for(const D in i){const V=i[D],G=u[D].paddedRect;bo.copy(V.data,P,{x:0,y:0},{x:G.x+Zo,y:G.y+Zo},V.data)}for(const D in o){const V=o[D],G=p[D].paddedRect,X=G.x+Zo,J=G.y+Zo,Q=V.data.width,ae=V.data.height;bo.copy(V.data,P,{x:0,y:0},{x:X,y:J},V.data),bo.copy(V.data,P,{x:0,y:ae-1},{x:X,y:J-1},{width:Q,height:1}),bo.copy(V.data,P,{x:0,y:0},{x:X,y:J+ae},{width:Q,height:1}),bo.copy(V.data,P,{x:Q-1,y:0},{x:X-1,y:J},{width:1,height:ae}),bo.copy(V.data,P,{x:0,y:0},{x:X+Q,y:J},{width:1,height:ae})}this.image=P,this.iconPositions=u,this.patternPositions=p}addImages(i,o,u){for(const p in i){const x=i[p],w={x:0,y:0,w:x.data.width+2*Zo,h:x.data.height+2*Zo};u.push(w),o[p]=new Ub(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(i,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>i.hasImage(u)),i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in i.updatedImages)this.patchUpdatedImage(this.iconPositions[u],i.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],i.getImage(u),o)}patchUpdatedImage(i,o,u){if(!i||!o||i.version===o.version)return;i.version=o.version;const[p,x]=i.tl;u.update(o.data,void 0,{x:p,y:x})}}bi(Ub,"ImagePosition"),bi(rE,"ImageAtlas");const Ka={horizontal:1,vertical:2,horizontalOnly:3},oE=-17;class y_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,o){const u=new y_;return u.scale=i||1,u.fontStack=o,u}static forImage(i){const o=new y_;return o.imageName=i,o}}class Rm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const u=new Rm;for(let p=0;p<i.sections.length;p++){const x=i.sections[p];x.image?u.addImageSection(x):u.addTextSection(x,o)}return u}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(o,u){let p="";for(let x=0;x<o.length;x++){const w=o.charCodeAt(x+1)||null,M=o.charCodeAt(x-1)||null;p+=!u&&(w&&jl(w)&&!hn[o[x+1]]||M&&jl(M)&&!hn[o[x-1]])||!hn[o[x]]?o[x]:hn[o[x]]}return p}(this.text,i)}trim(){let i=0;for(let u=0;u<this.text.length&&Fx[this.text.charCodeAt(u)];u++)i++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=i&&Fx[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const u=new Rm;return u.text=this.text.substring(i,o),u.sectionIndex=this.sectionIndex.slice(i,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}addTextSection(i,o){this.text+=i.text,this.sections.push(y_.forText(i.scale,i.fontStack||o));const u=this.sections.length-1;for(let p=0;p<i.text.length;++p)this.sectionIndex.push(u)}addImageSection(i){const o=i.image?i.image.name:"";if(o.length===0)return void Bt("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(y_.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Bt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Vb(s,i,o,u,p,x,w,M,P,D,V,G,X,J,Q){const ae=Rm.fromFeature(s,p);G===Ka.vertical&&ae.verticalizePunctuation(X);let _e=[];const Pe=function($e,bt,gt,It,Qt,Et){if(!$e)return[];const Nt=[],Ut=function(fi,Si,_i,Ji,ri,Di){let Qi=0;for(let Pn=0;Pn<fi.length();Pn++){const en=fi.getSection(Pn);Qi+=aE(fi.getCharCode(Pn),en,Ji,ri,Si,Di)}return Qi/Math.max(1,Math.ceil(Qi/_i))}($e,bt,gt,It,Qt,Et),Gt=$e.text.indexOf("")>=0;let si=0;for(let fi=0;fi<$e.length();fi++){const Si=$e.getSection(fi),_i=$e.getCharCode(fi);if(Fx[_i]||(si+=aE(_i,Si,It,Qt,bt,Et)),fi<$e.length()-1){const Ji=!((At=_i)<11904||!(pi["Bopomofo Extended"](At)||pi.Bopomofo(At)||pi["CJK Compatibility Forms"](At)||pi["CJK Compatibility Ideographs"](At)||pi["CJK Compatibility"](At)||pi["CJK Radicals Supplement"](At)||pi["CJK Strokes"](At)||pi["CJK Symbols and Punctuation"](At)||pi["CJK Unified Ideographs Extension A"](At)||pi["CJK Unified Ideographs"](At)||pi["Enclosed CJK Letters and Months"](At)||pi["Halfwidth and Fullwidth Forms"](At)||pi.Hiragana(At)||pi["Ideographic Description Characters"](At)||pi["Kangxi Radicals"](At)||pi["Katakana Phonetic Extensions"](At)||pi.Katakana(At)||pi["Vertical Forms"](At)||pi["Yi Radicals"](At)||pi["Yi Syllables"](At)));(OD[_i]||Ji||Si.imageName)&&Nt.push(cE(fi+1,si,Ut,Nt,RD(_i,$e.getCharCode(fi+1),Ji&&Gt),!1))}}var At;return hE(cE($e.length(),si,Ut,Nt,0,!0))}(ae,D,x,i,u,J),{processBidirectionalText:je,processStyledBidirectionalText:Le}=z;if(je&&ae.sections.length===1){const $e=je(ae.toString(),Pe);for(const bt of $e){const gt=new Rm;gt.text=bt,gt.sections=ae.sections;for(let It=0;It<bt.length;It++)gt.sectionIndex.push(0);_e.push(gt)}}else if(Le){const $e=Le(ae.text,ae.sectionIndex,Pe);for(const bt of $e){const gt=new Rm;gt.text=bt[0],gt.sectionIndex=bt[1],gt.sections=ae.sections,_e.push(gt)}}else _e=function($e,bt){const gt=[],It=$e.text;let Qt=0;for(const Et of bt)gt.push($e.substring(Qt,Et)),Qt=Et;return Qt<It.length&&gt.push($e.substring(Qt,It.length)),gt}(ae,Pe);const Ve=[],He={positionedLines:Ve,text:ae.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:G,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function($e,bt,gt,It,Qt,Et,Nt,Ut,Gt,si,At,fi){let Si=0,_i=0,Ji=0;const ri=Ut==="right"?1:Ut==="left"?0:.5;let Di=!1;for(const sn of Qt){const rn=sn.getSections();for(const Jn of rn){if(Jn.imageName)continue;const os=bt[Jn.fontStack];if(os&&(Di=os.ascender!==void 0&&os.descender!==void 0,!Di))break}if(!Di)break}let Qi=0;for(const sn of Qt){sn.trim();const rn=sn.getMaxScale(),Jn=(rn-1)*$t,os={positionedGlyphs:[],lineOffset:0};$e.positionedLines[Qi]=os;const as=os.positionedGlyphs;let Qn=0;if(!sn.length()){_i+=Et,++Qi;continue}let Ps=0,Hs=0;for(let es=0;es<sn.length();es++){const dr=sn.getSection(es),ir=sn.getSectionIndex(es),Fs=sn.getCharCode(es);let zn=dr.scale,nr=null,ls=null,To=null,sr=$t,Br=0;const Ir=!(Gt===Ka.horizontal||!At&&!vf(Fs)||At&&(Fx[Fs]||(Pn=Fs,pi.Arabic(Pn)||pi["Arabic Supplement"](Pn)||pi["Arabic Extended-A"](Pn)||pi["Arabic Presentation Forms-A"](Pn)||pi["Arabic Presentation Forms-B"](Pn))));if(dr.imageName){const Eo=It[dr.imageName];if(!Eo)continue;To=dr.imageName,$e.iconsInText=$e.iconsInText||!0,ls=Eo.paddedRect;const Pr=Eo.displaySize;zn=zn*$t/fi,nr={width:Pr[0],height:Pr[1],left:Zo,top:-3,advance:Ir?Pr[1]:Pr[0],localGlyph:!1},Br=Di?-nr.height*zn:oE+rn*$t-Pr[1]*zn,sr=nr.advance;const Jl=(Ir?Pr[0]:Pr[1])*zn-$t*rn;Jl>0&&Jl>Qn&&(Qn=Jl)}else{const Eo=gt[dr.fontStack];if(!Eo)continue;Eo[Fs]&&(ls=Eo[Fs]);const Pr=bt[dr.fontStack];if(!Pr)continue;const Jl=Pr.glyphs[Fs];if(!Jl)continue;if(nr=Jl.metrics,sr=Fs!==8203?$t:0,Di){const Vm=Pr.ascender!==void 0?Math.abs(Pr.ascender):0,A_=Pr.descender!==void 0?Math.abs(Pr.descender):0,k_=(Vm+A_)*zn;Ps<k_&&(Ps=k_,Hs=(Vm-A_)/2*zn),Br=-Vm*zn}else Br=oE+(rn-zn)*$t}Ir?($e.verticalizable=!0,as.push({glyph:Fs,imageName:To,x:Si,y:_i+Br,vertical:Ir,scale:zn,localGlyph:nr.localGlyph,fontStack:dr.fontStack,sectionIndex:ir,metrics:nr,rect:ls}),Si+=sr*zn+si):(as.push({glyph:Fs,imageName:To,x:Si,y:_i+Br,vertical:Ir,scale:zn,localGlyph:nr.localGlyph,fontStack:dr.fontStack,sectionIndex:ir,metrics:nr,rect:ls}),Si+=nr.advance*zn+si)}as.length!==0&&(Ji=Math.max(Si-si,Ji),Di?uE(as,ri,Qn,Hs,Et*rn/2):uE(as,ri,Qn,0,Et/2)),Si=0;const tr=Et*rn+Qn;os.lineOffset=Math.max(Qn,Jn),_i+=tr,++Qi}var Pn;const en=_i,{horizontalAlign:Bi,verticalAlign:fs}=jb(Nt);(function(sn,rn,Jn,os,as,Qn){const Ps=(rn-Jn)*as,Hs=-Qn*os;for(const tr of sn)for(const es of tr.positionedGlyphs)es.x+=Ps,es.y+=Hs})($e.positionedLines,ri,Bi,fs,Ji,en),$e.top+=-fs*en,$e.bottom=$e.top+en,$e.left+=-Bi*Ji,$e.right=$e.left+Ji,$e.hasBaseline=Di}(He,i,o,u,_e,w,M,P,G,D,X,Q),!function($e){for(const bt of $e)if(bt.positionedGlyphs.length!==0)return!1;return!0}(Ve)&&He}const Fx={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},OD={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function aE(s,i,o,u,p,x){if(i.imageName){const w=u[i.imageName];return w?w.displaySize[0]*i.scale*$t/x+p:0}{const w=o[i.fontStack],M=w&&w.glyphs[s];return M?M.metrics.advance*i.scale+p:0}}function lE(s,i,o,u){const p=Math.pow(s-i,2);return u?s<i?p/2:2*p:p+Math.abs(o)*o}function RD(s,i,o){let u=0;return s===10&&(u-=1e4),o&&(u+=150),s!==40&&s!==65288||(u+=50),i!==41&&i!==65289||(u+=50),u}function cE(s,i,o,u,p,x){let w=null,M=lE(i,o,p,x);for(const P of u){const D=lE(i-P.x,o,p,x)+P.badness;D<=M&&(w=P,M=D)}return{index:s,x:i,priorBreak:w,badness:M}}function hE(s){return s?hE(s.priorBreak).concat(s.index):[]}function jb(s){let i=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function uE(s,i,o,u,p){if(!(i||o||u||p))return;const x=s.length-1,w=s[x],M=(w.x+w.metrics.advance*w.scale)*i;for(let P=0;P<=x;P++)s[P].x-=M,s[P].y+=o+u+p}function zD(s,i,o){const{horizontalAlign:u,verticalAlign:p}=jb(o),x=i[0]-s.displaySize[0]*u,w=i[1]-s.displaySize[1]*p;return{image:s,top:w,bottom:w+s.displaySize[1],left:x,right:x+s.displaySize[0]}}function dE(s,i,o,u,p,x){const w=s.image;let M;if(w.content){const _e=w.content,Pe=w.pixelRatio||1;M=[_e[0]/Pe,_e[1]/Pe,w.displaySize[0]-_e[2]/Pe,w.displaySize[1]-_e[3]/Pe]}const P=i.left*x,D=i.right*x;let V,G,X,J;o==="width"||o==="both"?(J=p[0]+P-u[3],G=p[0]+D+u[1]):(J=p[0]+(P+D-w.displaySize[0])/2,G=J+w.displaySize[0]);const Q=i.top*x,ae=i.bottom*x;return o==="height"||o==="both"?(V=p[1]+Q-u[0],X=p[1]+ae+u[2]):(V=p[1]+(Q+ae-w.displaySize[1])/2,X=V+w.displaySize[1]),{image:w,top:V,right:G,bottom:X,left:J,collisionPadding:M}}class Wh extends Ne{constructor(i,o,u,p,x){super(i,o),this.angle=p,this.z=u,x!==void 0&&(this.segment=x)}clone(){return new Wh(this.x,this.y,this.z,this.angle,this.segment)}}function fE(s,i,o,u,p){if(i.segment===void 0)return!0;let x=i,w=i.segment+1,M=0;for(;M>-o/2;){if(w--,w<0)return!1;M-=s[w].dist(x),x=s[w]}M+=s[w].dist(s[w+1]),w++;const P=[];let D=0;for(;M<o/2;){const V=s[w],G=s[w+1];if(!G)return!1;let X=s[w-1].angleTo(V)-V.angleTo(G);for(X=Math.abs((X+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:M,angleDelta:X}),D+=X;M-P[0].distance>u;)D-=P.shift().angleDelta;if(D>p)return!1;w++,M+=V.dist(G)}return!0}function pE(s){let i=0;for(let o=0;o<s.length-1;o++)i+=s[o].dist(s[o+1]);return i}function mE(s,i,o){return s?.6*i*o:0}function gE(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function BD(s,i,o,u,p,x){const w=mE(o,p,x),M=gE(o,u)*x;let P=0;const D=pE(s)/2;for(let V=0;V<s.length-1;V++){const G=s[V],X=s[V+1],J=G.dist(X);if(P+J>D){const Q=(D-P)/J,ae=_n(G.x,X.x,Q),_e=_n(G.y,X.y,Q),Pe=new Wh(ae,_e,0,X.angleTo(G),V);return!w||fE(s,Pe,M,w,i)?Pe:void 0}P+=J}}function FD(s,i,o,u,p,x,w,M,P){const D=mE(u,x,w),V=gE(u,p),G=V*w,X=s[0].x===0||s[0].x===P||s[0].y===0||s[0].y===P;return i-G<i/4&&(i=G+i/4),_E(s,X?i/2*M%i:(V/2+2*x)*w*M%i,i,D,o,G,X,!1,P)}function _E(s,i,o,u,p,x,w,M,P){const D=x/2,V=pE(s);let G=0,X=i-o,J=[];for(let Q=0;Q<s.length-1;Q++){const ae=s[Q],_e=s[Q+1],Pe=ae.dist(_e),je=_e.angleTo(ae);for(;X+o<G+Pe;){X+=o;const Le=(X-G)/Pe,Ve=_n(ae.x,_e.x,Le),He=_n(ae.y,_e.y,Le);if(Ve>=0&&Ve<P&&He>=0&&He<P&&X-D>=0&&X+D<=V){const $e=new Wh(Ve,He,0,je,Q);$e._round(),u&&!fE(s,$e,x,u,p)||J.push($e)}}G+=Pe}return M||J.length||w||(J=_E(s,G/2,o,u,p,x,w,!0,P)),J}function yE(s,i,o,u,p){const x=[];for(let w=0;w<s.length;w++){const M=s[w];let P;for(let D=0;D<M.length-1;D++){let V=M[D],G=M[D+1];V.x<i&&G.x<i||(V.x<i?V=new Ne(i,V.y+(i-V.x)/(G.x-V.x)*(G.y-V.y))._round():G.x<i&&(G=new Ne(i,V.y+(i-V.x)/(G.x-V.x)*(G.y-V.y))._round()),V.y<o&&G.y<o||(V.y<o?V=new Ne(V.x+(o-V.y)/(G.y-V.y)*(G.x-V.x),o)._round():G.y<o&&(G=new Ne(V.x+(o-V.y)/(G.y-V.y)*(G.x-V.x),o)._round()),V.x>=u&&G.x>=u||(V.x>=u?V=new Ne(u,V.y+(u-V.x)/(G.x-V.x)*(G.y-V.y))._round():G.x>=u&&(G=new Ne(u,V.y+(u-V.x)/(G.x-V.x)*(G.y-V.y))._round()),V.y>=p&&G.y>=p||(V.y>=p?V=new Ne(V.x+(p-V.y)/(G.y-V.y)*(G.x-V.x),p)._round():G.y>=p&&(G=new Ne(V.x+(p-V.y)/(G.y-V.y)*(G.x-V.x),p)._round()),P&&V.equals(P[P.length-1])||(P=[V],x.push(P)),P.push(G)))))}}return x}bi(Wh,"Anchor");const Nx=1e20;function xE(s,i,o,u,p,x,w,M,P){for(let D=i;D<i+u;D++)vE(s,o*x+D,x,p,w,M,P);for(let D=o;D<o+p;D++)vE(s,D*x+i,1,u,w,M,P)}function vE(s,i,o,u,p,x,w){x[0]=0,w[0]=-1e20,w[1]=Nx,p[0]=s[i];for(let M=1,P=0,D=0;M<u;M++){p[M]=s[i+M*o];const V=M*M;do{const G=x[P];D=(p[M]-p[G]+V-G*G)/(M-G)/2}while(D<=w[P]&&--P>-1);P++,x[P]=M,w[P]=D,w[P+1]=Nx}for(let M=0,P=0;M<u;M++){for(;w[P+1]<M;)P++;const D=x[P],V=M-D;s[i+M*o]=p[D]+V*V}}const Yl=2,$b={none:0,ideographs:1,all:2};class zm{constructor(i,o,u){this.requestManager=i,this.localGlyphMode=o,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,o){const u=[];for(const p in i)for(const x of i[p])u.push({stack:p,id:x});ji(u,({stack:p,id:x},w)=>{let M=this.entries[p];M||(M=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=M.glyphs[x];if(P!==void 0)return void w(null,{stack:p,id:x,glyph:P});if(P=this._tinySDF(M,p,x),P)return M.glyphs[x]=P,void w(null,{stack:p,id:x,glyph:P});const D=Math.floor(x/256);if(256*D>65535)return void w(new Error("glyphs > 65535 not supported"));if(M.ranges[D])return void w(null,{stack:p,id:x,glyph:P});let V=M.requests[D];V||(V=M.requests[D]=[],zm.loadGlyphRange(p,D,this.url,this.requestManager,(G,X)=>{if(X){M.ascender=X.ascender,M.descender=X.descender;for(const J in X.glyphs)this._doesCharSupportLocalGlyph(+J)||(M.glyphs[+J]=X.glyphs[+J]);M.ranges[D]=!0}for(const J of V)J(G,X);delete M.requests[D]})),V.push((G,X)=>{G?w(G):X&&w(null,{stack:p,id:x,glyph:X.glyphs[x]||null})})},(p,x)=>{if(p)o(p);else if(x){const w={};for(const{stack:M,id:P,glyph:D}of x)w[M]===void 0&&(w[M]={}),w[M].glyphs===void 0&&(w[M].glyphs={}),w[M].glyphs[P]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},w[M].ascender=this.entries[M].ascender,w[M].descender=this.entries[M].descender;o(null,w)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==$b.none&&(this.localGlyphMode===$b.all?!!this.localFontFamily:!!this.localFontFamily&&(pi["CJK Unified Ideographs"](i)||pi["Hangul Syllables"](i)||pi.Hiragana(i)||pi.Katakana(i)||pi["CJK Symbols and Punctuation"](i)))}_tinySDF(i,o,u){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let x=i.tinySDF;if(!x){let ae="400";/bold/i.test(o)?ae="900":/medium/i.test(o)?ae="500":/light/i.test(o)&&(ae="200"),x=i.tinySDF=new zm.TinySDF({fontFamily:p,fontWeight:ae,fontSize:24*Yl,buffer:3*Yl,radius:8*Yl}),x.fontWeight=ae}if(this.localGlyphs[x.fontWeight][u])return this.localGlyphs[x.fontWeight][u];const w=String.fromCharCode(u),{data:M,width:P,height:D,glyphWidth:V,glyphHeight:G,glyphLeft:X,glyphTop:J,glyphAdvance:Q}=x.draw(w);return this.localGlyphs[x.fontWeight][u]={id:u,bitmap:new Zl({width:P,height:D},M),metrics:{width:V/Yl,height:G/Yl,left:X/Yl,top:J/Yl-27,advance:Q/Yl,localGlyph:!0}}}}zm.loadGlyphRange=function(s,i,o,u,p){const x=256*i,w=x+255,M=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",s).replace("{range}",`${x}-${w}`),vr.Glyphs);pr(M,(P,D)=>{if(P)p(P);else if(D){const V={},G=function(X){return new Bx(X).readFields(ID,{})}(D);for(const X of G.glyphs)V[X.id]=X;p(null,{glyphs:V,ascender:G.ascender,descender:G.descender})}})},zm.TinySDF=class{constructor({fontSize:s=24,buffer:i=3,radius:o=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:x="normal",fontStyle:w="normal"}={}){this.buffer=i,this.cutoff=u,this.radius=o;const M=this.size=s+4*i,P=this._createCanvas(M),D=this.ctx=P.getContext("2d",{willReadFrequently:!0});D.font=`${w} ${x} ${s}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(s){const i=document.createElement("canvas");return i.width=i.height=s,i}draw(s){const{width:i,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:x}=this.ctx.measureText(s),w=Math.ceil(o),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-p))),P=Math.min(this.size-this.buffer,w+Math.ceil(u)),D=M+2*this.buffer,V=P+2*this.buffer,G=Math.max(D*V,0),X=new Uint8ClampedArray(G),J={data:X,width:D,height:V,glyphWidth:M,glyphHeight:P,glyphTop:w,glyphLeft:0,glyphAdvance:i};if(M===0||P===0)return J;const{ctx:Q,buffer:ae,gridInner:_e,gridOuter:Pe}=this;Q.clearRect(ae,ae,M,P),Q.fillText(s,ae,ae+w);const je=Q.getImageData(ae,ae,M,P);Pe.fill(Nx,0,G),_e.fill(0,0,G);for(let Le=0;Le<P;Le++)for(let Ve=0;Ve<M;Ve++){const He=je.data[4*(Le*M+Ve)+3]/255;if(He===0)continue;const $e=(Le+ae)*D+Ve+ae;if(He===1)Pe[$e]=0,_e[$e]=Nx;else{const bt=.5-He;Pe[$e]=bt>0?bt*bt:0,_e[$e]=bt<0?bt*bt:0}}xE(Pe,0,0,D,V,D,this.f,this.v,this.z),xE(_e,ae,ae,M,P,D,this.f,this.v,this.z);for(let Le=0;Le<G;Le++){const Ve=Math.sqrt(Pe[Le])-Math.sqrt(_e[Le]);X[Le]=Math.round(255-255*(Ve/this.radius+this.cutoff))}return J}};const x_=Zo;function bE(s,i,o,u){const p=[],x=s.image,w=x.pixelRatio,M=x.paddedRect.w-2*x_,P=x.paddedRect.h-2*x_,D=s.right-s.left,V=s.bottom-s.top,G=x.stretchX||[[0,M]],X=x.stretchY||[[0,P]],J=(Et,Nt)=>Et+Nt[1]-Nt[0],Q=G.reduce(J,0),ae=X.reduce(J,0),_e=M-Q,Pe=P-ae;let je=0,Le=Q,Ve=0,He=ae,$e=0,bt=_e,gt=0,It=Pe;if(x.content&&u){const Et=x.content;je=Ux(G,0,Et[0]),Ve=Ux(X,0,Et[1]),Le=Ux(G,Et[0],Et[2]),He=Ux(X,Et[1],Et[3]),$e=Et[0]-je,gt=Et[1]-Ve,bt=Et[2]-Et[0]-Le,It=Et[3]-Et[1]-He}const Qt=(Et,Nt,Ut,Gt)=>{const si=Vx(Et.stretch-je,Le,D,s.left),At=jx(Et.fixed-$e,bt,Et.stretch,Q),fi=Vx(Nt.stretch-Ve,He,V,s.top),Si=jx(Nt.fixed-gt,It,Nt.stretch,ae),_i=Vx(Ut.stretch-je,Le,D,s.left),Ji=jx(Ut.fixed-$e,bt,Ut.stretch,Q),ri=Vx(Gt.stretch-Ve,He,V,s.top),Di=jx(Gt.fixed-gt,It,Gt.stretch,ae),Qi=new Ne(si,fi),Pn=new Ne(_i,fi),en=new Ne(_i,ri),Bi=new Ne(si,ri),fs=new Ne(At/w,Si/w),sn=new Ne(Ji/w,Di/w),rn=i*Math.PI/180;if(rn){const as=Math.sin(rn),Qn=Math.cos(rn),Ps=[Qn,-as,as,Qn];Qi._matMult(Ps),Pn._matMult(Ps),Bi._matMult(Ps),en._matMult(Ps)}const Jn=Et.stretch+Et.fixed,os=Nt.stretch+Nt.fixed;return{tl:Qi,tr:Pn,bl:Bi,br:en,tex:{x:x.paddedRect.x+x_+Jn,y:x.paddedRect.y+x_+os,w:Ut.stretch+Ut.fixed-Jn,h:Gt.stretch+Gt.fixed-os},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fs,pixelOffsetBR:sn,minFontScaleX:bt/w/D,minFontScaleY:It/w/V,isSDF:o}};if(u&&(x.stretchX||x.stretchY)){const Et=wE(G,_e,Q),Nt=wE(X,Pe,ae);for(let Ut=0;Ut<Et.length-1;Ut++){const Gt=Et[Ut],si=Et[Ut+1];for(let At=0;At<Nt.length-1;At++)p.push(Qt(Gt,Nt[At],si,Nt[At+1]))}}else p.push(Qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:P+1}));return p}function Ux(s,i,o){let u=0;for(const p of s)u+=Math.max(i,Math.min(o,p[1]))-Math.max(i,Math.min(o,p[0]));return u}function wE(s,i,o){const u=[{fixed:-1,stretch:0}];for(const[p,x]of s){const w=u[u.length-1];u.push({fixed:p-w.stretch,stretch:w.stretch}),u.push({fixed:p-w.stretch,stretch:w.stretch+(x-p)})}return u.push({fixed:i+x_,stretch:o}),u}function Vx(s,i,o,u){return s/i*o+u}function jx(s,i,o,u){return s-i*o/u}function ND(s,i,o,u){const p=i+s.positionedLines[u].lineOffset;return u===0?o+p/2:o+(p+(i+s.positionedLines[u-1].lineOffset))/2}class UD{constructor(i=[],o=VD){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:u}=this,p=o[i];for(;i>0;){const x=i-1>>1,w=o[x];if(u(p,w)>=0)break;o[i]=w,i=x}o[i]=p}_down(i){const{data:o,compare:u}=this,p=this.length>>1,x=o[i];for(;i<p;){let w=1+(i<<1),M=o[w];const P=w+1;if(P<this.length&&u(o[P],M)<0&&(w=P,M=o[P]),u(M,x)>=0)break;o[i]=M,i=w}o[i]=x}}function VD(s,i){return s<i?-1:s>i?1:0}function jD(s,i=1,o=!1){let u=1/0,p=1/0,x=-1/0,w=-1/0;const M=s[0];for(let J=0;J<M.length;J++){const Q=M[J];(!J||Q.x<u)&&(u=Q.x),(!J||Q.y<p)&&(p=Q.y),(!J||Q.x>x)&&(x=Q.x),(!J||Q.y>w)&&(w=Q.y)}const P=Math.min(x-u,w-p);let D=P/2;const V=new UD([],$D);if(P===0)return new Ne(u,p);for(let J=u;J<x;J+=P)for(let Q=p;Q<w;Q+=P)V.push(new Bm(J+D,Q+D,D,s));let G=function(J){let Q=0,ae=0,_e=0;const Pe=J[0];for(let je=0,Le=Pe.length,Ve=Le-1;je<Le;Ve=je++){const He=Pe[je],$e=Pe[Ve],bt=He.x*$e.y-$e.x*He.y;ae+=(He.x+$e.x)*bt,_e+=(He.y+$e.y)*bt,Q+=3*bt}return new Bm(ae/Q,_e/Q,0,J)}(s),X=V.length;for(;V.length;){const J=V.pop();(J.d>G.d||!G.d)&&(G=J,o&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,X)),J.max-G.d<=i||(D=J.h/2,V.push(new Bm(J.p.x-D,J.p.y-D,D,s)),V.push(new Bm(J.p.x+D,J.p.y-D,D,s)),V.push(new Bm(J.p.x-D,J.p.y+D,D,s)),V.push(new Bm(J.p.x+D,J.p.y+D,D,s)),X+=4)}return o&&(console.log(`num probes: ${X}`),console.log(`best distance: ${G.d}`)),G.p}function $D(s,i){return i.max-s.max}class Bm{constructor(i,o,u,p){this.p=new Ne(i,o),this.h=u,this.d=function(x,w){let M=!1,P=1/0;for(let D=0;D<w.length;D++){const V=w[D];for(let G=0,X=V.length,J=X-1;G<X;J=G++){const Q=V[G],ae=V[J];Q.y>x.y!=ae.y>x.y&&x.x<(ae.x-Q.x)*(x.y-Q.y)/(ae.y-Q.y)+Q.x&&(M=!M),P=Math.min(P,ed(x,Q,ae))}}return(M?1:-1)*Math.sqrt(P)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Fm=7,Wb=Number.POSITIVE_INFINITY,WD=Math.sqrt(2);function TE(s,[i,o]){let u=0,p=0;if(o===Wb){i<0&&(i=0);const x=i/WD;switch(s){case"top-right":case"top-left":p=x-Fm;break;case"bottom-right":case"bottom-left":p=-x+Fm;break;case"bottom":p=-i+Fm;break;case"top":p=i-Fm}switch(s){case"top-right":case"bottom-right":u=-x;break;case"top-left":case"bottom-left":u=x;break;case"left":u=i;break;case"right":u=-i}}else{switch(i=Math.abs(i),o=Math.abs(o),s){case"top-right":case"top-left":case"top":p=o-Fm;break;case"bottom-right":case"bottom-left":case"bottom":p=-o+Fm}switch(s){case"top-right":case"bottom-right":case"right":u=-i;break;case"top-left":case"bottom-left":case"left":u=i}}return[u,p]}function GD(s,i,o,u,p,x,w,M,P,D){s.createArrays(),s.tilePixelRatio=Ai/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const V=s.layers[0].layout,G=s.layers[0]._unevaluatedLayout._values,X={};if(s.textSizeData.kind==="composite"){const{minZoom:ae,maxZoom:_e}=s.textSizeData;X.compositeTextSizes=[G["text-size"].possiblyEvaluate(new j(ae),M),G["text-size"].possiblyEvaluate(new j(_e),M)]}if(s.iconSizeData.kind==="composite"){const{minZoom:ae,maxZoom:_e}=s.iconSizeData;X.compositeIconSizes=[G["icon-size"].possiblyEvaluate(new j(ae),M),G["icon-size"].possiblyEvaluate(new j(_e),M)]}X.layoutTextSize=G["text-size"].possiblyEvaluate(new j(P+1),M),X.layoutIconSize=G["icon-size"].possiblyEvaluate(new j(P+1),M),X.textMaxSize=G["text-size"].possiblyEvaluate(new j(18),M);const J=V.get("text-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",Q=V.get("text-size");for(const ae of s.features){const _e=V.get("text-font").evaluate(ae,{},M).join(","),Pe=Q.evaluate(ae,{},M),je=X.layoutTextSize.evaluate(ae,{},M),Le=(X.layoutIconSize.evaluate(ae,{},M),{horizontal:{},vertical:void 0}),Ve=ae.text;let He,$e=[0,0];if(Ve){const It=Ve.toString(),Qt=V.get("text-letter-spacing").evaluate(ae,{},M)*$t,Et=V.get("text-line-height").evaluate(ae,{},M)*$t,Nt=Vg(It)?Qt:0,Ut=V.get("text-anchor").evaluate(ae,{},M),Gt=V.get("text-variable-anchor");if(!Gt){const _i=V.get("text-radial-offset").evaluate(ae,{},M);$e=_i?TE(Ut,[_i*$t,Wb]):V.get("text-offset").evaluate(ae,{},M).map(Ji=>Ji*$t)}let si=J?"center":V.get("text-justify").evaluate(ae,{},M);const At=V.get("symbol-placement")==="point",fi=At?V.get("text-max-width").evaluate(ae,{},M)*$t:1/0,Si=_i=>{s.allowVerticalPlacement&&xf(It)&&(Le.vertical=Vb(Ve,i,o,p,_e,fi,Et,Ut,_i,Nt,$e,Ka.vertical,!0,je,Pe))};if(!J&&Gt){const _i=si==="auto"?Gt.map(ri=>Gb(ri)):[si];let Ji=!1;for(let ri=0;ri<_i.length;ri++){const Di=_i[ri];if(!Le.horizontal[Di])if(Ji)Le.horizontal[Di]=Le.horizontal[0];else{const Qi=Vb(Ve,i,o,p,_e,fi,Et,"center",Di,Nt,$e,Ka.horizontal,!1,je,Pe);Qi&&(Le.horizontal[Di]=Qi,Ji=Qi.positionedLines.length===1)}}Si("left")}else{if(si==="auto"&&(si=Gb(Ut)),At||V.get("text-writing-mode").indexOf("horizontal")>=0||!xf(It)){const _i=Vb(Ve,i,o,p,_e,fi,Et,Ut,si,Nt,$e,Ka.horizontal,!1,je,Pe);_i&&(Le.horizontal[si]=_i)}Si(At?"left":si)}}let bt=!1;if(ae.icon&&ae.icon.name){const It=u[ae.icon.name];It&&(He=zD(p[ae.icon.name],V.get("icon-offset").evaluate(ae,{},M),V.get("icon-anchor").evaluate(ae,{},M)),bt=It.sdf,s.sdfIcons===void 0?s.sdfIcons=It.sdf:s.sdfIcons!==It.sdf&&Bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(It.pixelRatio!==s.pixelRatio||V.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0))}const gt=SE(Le.horizontal)||Le.vertical;s.iconsInText||(s.iconsInText=!!gt&&gt.iconsInText),(gt||He)&&HD(s,ae,Le,He,u,X,je,0,$e,bt,w,M,D)}x&&s.generateCollisionDebugBuffers(P,s.collisionBoxArray)}function Gb(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function HD(s,i,o,u,p,x,w,M,P,D,V,G,X){let J=x.textMaxSize.evaluate(i,{},G);J===void 0&&(J=w);const Q=s.layers[0].layout,ae=Q.get("icon-offset").evaluate(i,{},G),_e=SE(o.horizontal)||o.vertical,Pe=X.name==="globe",je=$t,Le=w/je,Ve=s.tilePixelRatio*J/je,He=(Ut=s.overscaling,s.zoom>18&&Ut>2&&(Ut>>=1),Math.max(Ai/(512*Ut),1)*Q.get("symbol-spacing")),$e=Q.get("text-padding")*s.tilePixelRatio,bt=Q.get("icon-padding")*s.tilePixelRatio,gt=Xe(Q.get("text-max-angle")),It=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",Qt=Q.get("icon-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",Et=Q.get("symbol-placement"),Nt=He/2;var Ut;const Gt=Q.get("icon-text-fit");let si;u&&Gt!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(si=dE(u,o.vertical,Gt,Q.get("icon-text-fit-padding"),ae,Le)),_e&&(u=dE(u,_e,Gt,Q.get("icon-text-fit-padding"),ae,Le)));const At=(fi,Si,_i)=>{if(Si.x<0||Si.x>=Ai||Si.y<0||Si.y>=Ai)return;let Ji=null;if(Pe){const{x:ri,y:Di,z:Qi}=X.projectTilePoint(Si.x,Si.y,_i);Ji={anchor:new Wh(ri,Di,Qi,0,void 0),up:X.upVector(_i,Si.x,Si.y)}}(function(ri,Di,Qi,Pn,en,Bi,fs,sn,rn,Jn,os,as,Qn,Ps,Hs,tr,es,dr,ir,Fs,zn,nr,ls,To,sr){const Br=ri.addToLineVertexArray(Di,Pn);let Ir,Eo,Pr,Jl,Vm,A_,k_,sS=0,rS=0,oS=0,aS=0,o1=-1,a1=-1;const Yc={};let lS=Wg("");const op=Qi?Qi.anchor:Di;let l1=0,c1=0;if(rn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[l1,c1]=rn.layout.get("text-offset").evaluate(zn,{},sr).map(va=>va*$t):(l1=rn.layout.get("text-radial-offset").evaluate(zn,{},sr)*$t,c1=Wb),ri.allowVerticalPlacement&&en.vertical){const va=en.vertical;if(Hs)A_=Hb(va),sn&&(k_=Hb(sn));else{const ba=rn.layout.get("text-rotate").evaluate(zn,{},sr)+90;Pr=$x(Jn,op,Di,os,as,Qn,va,Ps,ba,tr),sn&&(Jl=$x(Jn,op,Di,os,as,Qn,sn,dr,ba))}}if(Bi){const va=rn.layout.get("icon-rotate").evaluate(zn,{},sr),ba=rn.layout.get("icon-text-fit")!=="none",I_=bE(Bi,va,ls,ba),u1=sn?bE(sn,va,ls,ba):void 0;Eo=$x(Jn,op,Di,os,as,Qn,Bi,dr,va),sS=4*I_.length;const cS=ri.iconSizeData;let ap=null;cS.kind==="source"?(ap=[gi*rn.layout.get("icon-size").evaluate(zn,{},sr)],ap[0]>ad&&Bt(`${ri.layerIds[0]}: Value for "icon-size" is >= ${v_}. Reduce your "icon-size".`)):cS.kind==="composite"&&(ap=[gi*nr.compositeIconSizes[0].evaluate(zn,{},sr),gi*nr.compositeIconSizes[1].evaluate(zn,{},sr)],(ap[0]>ad||ap[1]>ad)&&Bt(`${ri.layerIds[0]}: Value for "icon-size" is >= ${v_}. Reduce your "icon-size".`)),ri.addSymbols(ri.icon,I_,ap,Fs,ir,zn,!1,Qi,Di,Br.lineStartIndex,Br.lineLength,-1,To,sr),o1=ri.icon.placedSymbolArray.length-1,u1&&(rS=4*u1.length,ri.addSymbols(ri.icon,u1,ap,Fs,ir,zn,Ka.vertical,Qi,Di,Br.lineStartIndex,Br.lineLength,-1,To,sr),a1=ri.icon.placedSymbolArray.length-1)}for(const va in en.horizontal){const ba=en.horizontal[va];Ir||(lS=Wg(ba.text),Hs?Vm=Hb(ba):Ir=$x(Jn,op,Di,os,as,Qn,ba,Ps,rn.layout.get("text-rotate").evaluate(zn,{},sr),tr));const I_=ba.positionedLines.length===1;if(oS+=EE(ri,Qi,Di,ba,fs,rn,Hs,zn,tr,Br,en.vertical?Ka.horizontal:Ka.horizontalOnly,I_?Object.keys(en.horizontal):[va],Yc,o1,nr,To,sr),I_)break}en.vertical&&(aS+=EE(ri,Qi,Di,en.vertical,fs,rn,Hs,zn,tr,Br,Ka.vertical,["vertical"],Yc,a1,nr,To,sr));let fd=-1;const h1=(va,ba)=>va?Math.max(va,ba):ba;fd=h1(Vm,fd),fd=h1(A_,fd),fd=h1(k_,fd);const vO=fd>-1?1:0;ri.glyphOffsetArray.length>=cd.MAX_GLYPHS&&Bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zn.sortKey!==void 0&&ri.addToSortKeyRanges(ri.symbolInstances.length,zn.sortKey),ri.symbolInstances.emplaceBack(op.x,op.y,op.z,Di.x,Di.y,Yc.right>=0?Yc.right:-1,Yc.center>=0?Yc.center:-1,Yc.left>=0?Yc.left:-1,Yc.vertical>=0?Yc.vertical:-1,o1,a1,lS,Ir!==void 0?Ir:ri.collisionBoxArray.length,Ir!==void 0?Ir+1:ri.collisionBoxArray.length,Pr!==void 0?Pr:ri.collisionBoxArray.length,Pr!==void 0?Pr+1:ri.collisionBoxArray.length,Eo!==void 0?Eo:ri.collisionBoxArray.length,Eo!==void 0?Eo+1:ri.collisionBoxArray.length,Jl||ri.collisionBoxArray.length,Jl?Jl+1:ri.collisionBoxArray.length,os,oS,aS,sS,rS,vO,0,l1,c1,fd)})(s,Si,Ji,fi,o,u,p,si,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,$e,It,P,0,bt,Qt,ae,i,x,D,V,G)};if(Et==="line")for(const fi of yE(i.geometry,0,0,Ai,Ai)){const Si=FD(fi,He,gt,o.vertical||_e,u,je,Ve,s.overscaling,Ai);for(const _i of Si)_e&&qD(s,_e.text,Nt,_i)||At(fi,_i,G)}else if(Et==="line-center"){for(const fi of i.geometry)if(fi.length>1){const Si=BD(fi,gt,o.vertical||_e,u,je,Ve);Si&&At(fi,Si,G)}}else if(i.type==="Polygon")for(const fi of Lm(i.geometry,0)){const Si=jD(fi,16);At(fi[0],new Wh(Si.x,Si.y,0,0,void 0),G)}else if(i.type==="LineString")for(const fi of i.geometry)At(fi,new Wh(fi[0].x,fi[0].y,0,0,void 0),G);else if(i.type==="Point")for(const fi of i.geometry)for(const Si of fi)At([Si],new Wh(Si.x,Si.y,0,0,void 0),G)}const v_=255,ad=v_*gi;function EE(s,i,o,u,p,x,w,M,P,D,V,G,X,J,Q,ae,_e){const Pe=function(Ve,He,$e,bt,gt,It,Qt,Et){const Nt=[];if(He.positionedLines.length===0)return Nt;const Ut=bt.layout.get("text-rotate").evaluate(It,{})*Math.PI/180,Gt=function(_i){const Ji=_i[0],ri=_i[1],Di=Ji*ri;return Di>0?[Ji,-ri]:Di<0?[-Ji,ri]:Ji===0?[ri,Ji]:[ri,-Ji]}($e);let si=Math.abs(He.top-He.bottom);for(const _i of He.positionedLines)si-=_i.lineOffset;const At=He.positionedLines.length,fi=si/At;let Si=He.top-$e[1];for(let _i=0;_i<At;++_i){const Ji=He.positionedLines[_i];Si=ND(He,fi,Si,_i);for(const ri of Ji.positionedGlyphs){if(!ri.rect)continue;const Di=ri.rect||{};let Qi=DD+1,Pn=!0,en=1,Bi=0;if(ri.imageName){const ls=Qt[ri.imageName];if(!ls)continue;if(ls.sdf){Bt("SDF images are not supported in formatted text and will be ignored.");continue}Pn=!1,en=ls.pixelRatio,Qi=Zo/en}const fs=(gt||Et)&&ri.vertical,sn=ri.metrics.advance*ri.scale/2,rn=ri.metrics,Jn=ri.rect;if(Jn===null)continue;Et&&He.verticalizable&&(Bi=ri.imageName?sn-ri.metrics.width*ri.scale/2:0);const os=gt?[ri.x+sn,ri.y]:[0,0];let as=[0,0],Qn=[0,0],Ps=!1;gt||(fs?(Qn=[ri.x+sn+Gt[0],ri.y+Gt[1]-Bi],Ps=!0):as=[ri.x+sn+$e[0],ri.y+$e[1]-Bi]);const Hs=Jn.w*ri.scale/(en*(ri.localGlyph?Yl:1)),tr=Jn.h*ri.scale/(en*(ri.localGlyph?Yl:1));let es,dr,ir,Fs;if(fs){const ls=ri.y-Si,To=new Ne(-sn,sn-ls),sr=-Math.PI/2,Br=new Ne(...Qn);es=new Ne(-sn+as[0],as[1]),es._rotateAround(sr,To)._add(Br),es.x+=-ls+sn,es.y-=(rn.left-Qi)*ri.scale;const Ir=ri.imageName?rn.advance*ri.scale:$t*ri.scale,Eo=String.fromCharCode(ri.glyph);En(Eo)?es.x+=(1-Qi)*ri.scale:zr(Eo)?es.x+=Ir-rn.height*ri.scale+(-Qi-1)*ri.scale:es.x+=ri.imageName||rn.width+2*Qi===Jn.w&&rn.height+2*Qi===Jn.h?(Ir-tr)/2:(Ir-(rn.height+2*Qi)*ri.scale)/2,dr=new Ne(es.x,es.y-Hs),ir=new Ne(es.x+tr,es.y),Fs=new Ne(es.x+tr,es.y-Hs)}else{const ls=(rn.left-Qi)*ri.scale-sn+as[0],To=(-rn.top-Qi)*ri.scale+as[1],sr=ls+Hs,Br=To+tr;es=new Ne(ls,To),dr=new Ne(sr,To),ir=new Ne(ls,Br),Fs=new Ne(sr,Br)}if(Ut){let ls;ls=gt?new Ne(0,0):Ps?new Ne(Gt[0],Gt[1]):new Ne($e[0],$e[1]),es._rotateAround(Ut,ls),dr._rotateAround(Ut,ls),ir._rotateAround(Ut,ls),Fs._rotateAround(Ut,ls)}const zn=new Ne(0,0),nr=new Ne(0,0);Nt.push({tl:es,tr:dr,bl:ir,br:Fs,tex:Di,writingMode:He.writingMode,glyphOffset:os,sectionIndex:ri.sectionIndex,isSDF:Pn,pixelOffsetTL:zn,pixelOffsetBR:nr,minFontScaleX:0,minFontScaleY:0})}}return Nt}(0,u,P,x,w,M,p,s.allowVerticalPlacement),je=s.textSizeData;let Le=null;je.kind==="source"?(Le=[gi*x.layout.get("text-size").evaluate(M,{},_e)],Le[0]>ad&&Bt(`${s.layerIds[0]}: Value for "text-size" is >= ${v_}. Reduce your "text-size".`)):je.kind==="composite"&&(Le=[gi*Q.compositeTextSizes[0].evaluate(M,{},_e),gi*Q.compositeTextSizes[1].evaluate(M,{},_e)],(Le[0]>ad||Le[1]>ad)&&Bt(`${s.layerIds[0]}: Value for "text-size" is >= ${v_}. Reduce your "text-size".`)),s.addSymbols(s.text,Pe,Le,P,w,M,V,i,o,D.lineStartIndex,D.lineLength,J,ae,_e);for(const Ve of G)X[Ve]=s.text.placedSymbolArray.length-1;return 4*Pe.length}function SE(s){for(const i in s)return s[i];return null}function $x(s,i,o,u,p,x,w,M,P,D){let V=w.top,G=w.bottom,X=w.left,J=w.right;const Q=w.collisionPadding;if(Q&&(X-=Q[0],V-=Q[1],J+=Q[2],G+=Q[3]),P){const ae=new Ne(X,V),_e=new Ne(J,V),Pe=new Ne(X,G),je=new Ne(J,G),Le=Xe(P);let Ve=new Ne(0,0);D&&(Ve=new Ne(D[0],D[1])),ae._rotateAround(Le,Ve),_e._rotateAround(Le,Ve),Pe._rotateAround(Le,Ve),je._rotateAround(Le,Ve),X=Math.min(ae.x,_e.x,Pe.x,je.x),J=Math.max(ae.x,_e.x,Pe.x,je.x),V=Math.min(ae.y,_e.y,Pe.y,je.y),G=Math.max(ae.y,_e.y,Pe.y,je.y)}return s.emplaceBack(i.x,i.y,i.z,o.x,o.y,X,V,J,G,M,u,p,x),s.length-1}function Hb(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const i=s.bottom-s.top;return i>0?Math.max(10,i):null}function qD(s,i,o,u){const p=s.compareText;if(i in p){const x=p[i];for(let w=x.length-1;w>=0;w--)if(u.dist(x[w])<o)return!0}else p[i]=[];return p[i].push(u),!1}function ME(s,i){const o=s.fovAboveCenter,u=s.elevation?s.elevation.getMinElevationBelowMSL()*i:0,p=(s._camera.position[2]*s.worldSize-u)/Math.cos(s._pitch),x=Math.sin(o)*p/Math.sin(Math.max(Math.PI/2-s._pitch-o,.01)),w=Math.sin(s._pitch)*x+p;return Math.min(1.01*w,p*(1/s._horizonShift))}function sp(s,i){if(!i.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:i};const o=Math.pow(2,-s.z),u=s.x*o,p=(s.x+1)*o,x=s.y*o,w=(s.y+1)*o,M=Ho(u),P=Ho(p),D=kr(x),V=kr(w),G=i.project(M,D),X=i.project(P,D),J=i.project(P,V),Q=i.project(M,V);let ae=Math.min(G.x,X.x,J.x,Q.x),_e=Math.min(G.y,X.y,J.y,Q.y),Pe=Math.max(G.x,X.x,J.x,Q.x),je=Math.max(G.y,X.y,J.y,Q.y);const Le=o/16;function Ve($e,bt,gt,It,Qt,Et){const Nt=(gt+Qt)/2,Ut=(It+Et)/2,Gt=i.project(Ho(Nt),kr(Ut)),si=Math.max(0,ae-Gt.x,_e-Gt.y,Gt.x-Pe,Gt.y-je);ae=Math.min(ae,Gt.x),Pe=Math.max(Pe,Gt.x),_e=Math.min(_e,Gt.y),je=Math.max(je,Gt.y),si>Le&&(Ve($e,Gt,gt,It,Nt,Ut),Ve(Gt,bt,Nt,Ut,Qt,Et))}Ve(G,X,u,x,p,x),Ve(X,J,p,x,p,w),Ve(J,Q,p,w,u,w),Ve(Q,G,u,w,u,x),ae-=Le,_e-=Le,Pe+=Le,je+=Le;const He=1/Math.max(Pe-ae,je-_e);return{scale:He,x:ae*He,y:_e*He,x2:Pe*He,y2:je*He,projection:i}}const XD=$o(new Float32Array(16));class ld{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,o){return{x:0,y:0,z:0}}unproject(i,o){return new $n(0,0)}projectTilePoint(i,o,u){return{x:i,y:o,z:0}}locationPoint(i,o,u=!0){return i._coordinatePoint(i.locationCoordinate(o),u)}pixelsPerMeter(i,o){return Xa(1,i)*o}pixelSpaceConversion(i,o,u){return 1}farthestPixelDistance(i){return ME(i,i.pixelsPerMeter)}pointCoordinate(i,o,u,p){const x=i.horizonLineFromTop(!1),w=new Ne(o,Math.max(x,u));return i.rayIntersectionCoordinate(i.pointRayIntersection(w,p))}pointCoordinate3D(i,o,u){const p=new Ne(o,u);if(i.elevation)return i.elevation.pointCoordinate(p);{const x=this.pointCoordinate(i,p.x,p.y,0);return[x.x,x.y,x.z]}}isPointAboveHorizon(i,o){if(i.elevation)return!this.pointCoordinate3D(i,o.x,o.y);const u=i.horizonLineFromTop();return o.y<u}createInversionMatrix(i,o){return XD}createTileMatrix(i,o,u){let p,x,w;const M=u.canonical,P=$o(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=sp(M,this);p=1,x=D.x+u.wrap*D.scale,w=D.y,Xl(P,P,[p/D.scale,p/D.scale,i.pixelsPerMeter/o])}else p=o/i.zoomScale(M.z),x=(M.x+Math.pow(2,M.z)*u.wrap)*p,w=M.y*p;return Mf(P,P,[x,w,0]),Xl(P,P,[p/Ai,p/Ai,1]),P}upVector(i,o,u){return[0,0,1]}upVectorScale(i,o,u){return{metersToTile:1}}}class ZD extends ld{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[o,u]=this.parallels=i.parallels||[29.5,45.5],p=Math.sin(Xe(o));this.n=(p+Math.sin(Xe(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(i,o){const{n:u,c:p,r0:x}=this,w=Xe(i-this.center[0]),M=Xe(o),P=Math.sqrt(p-2*u*Math.sin(M))/u;return{x:P*Math.sin(w*u),y:P*Math.cos(w*u)-x,z:0}}unproject(i,o){const{n:u,c:p,r0:x}=this,w=x+o;let M=Math.atan2(i,Math.abs(w))*Math.sign(w);w*u<0&&(M-=Math.PI*Math.sign(i)*Math.sign(w));const P=Xe(this.center[0])*u;M=Ni(M,-Math.PI-P,Math.PI-P);const D=ci(Tt(M/u)+this.center[0],-180,180),V=Math.asin(ci((p-(i*i+w*w)*u*u)/(2*u),-1,1)),G=ci(Tt(V),-85.051129,qo);return new $n(D,G)}}const b_=1.340264,w_=-.081106,T_=893e-6,E_=.003796,Wx=Math.sqrt(3)/2;class YD extends ld{project(i,o){o=o/180*Math.PI,i=i/180*Math.PI;const u=Math.asin(Wx*Math.sin(o)),p=u*u,x=p*p*p;return{x:.5*(i*Math.cos(u)/(Wx*(b_+3*w_*p+x*(7*T_+9*E_*p)))/Math.PI+.5),y:1-.5*(u*(b_+w_*p+x*(T_+E_*p))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,p=u*u,x=p*p*p;for(let V,G,X,J=0;J<12&&(G=u*(b_+w_*p+x*(T_+E_*p))-o,X=b_+3*w_*p+x*(7*T_+9*E_*p),V=G/X,u=ci(u-V,-Math.PI/3,Math.PI/3),p=u*u,x=p*p*p,!(Math.abs(V)<1e-12));++J);const w=Wx*i*(b_+3*w_*p+x*(7*T_+9*E_*p))/Math.cos(u),M=Math.asin(Math.sin(u)/Wx),P=ci(180*w/Math.PI,-180,180),D=ci(180*M/Math.PI,-85.051129,qo);return new $n(P,D)}}class KD extends ld{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){return{x:.5+i/360,y:.5-o/360,z:0}}unproject(i,o){const u=360*(i-.5),p=ci(360*(.5-o),-85.051129,qo);return new $n(u,p)}}const Nm=Math.PI/2;function Gx(s){return Math.tan((Nm+s)/2)}class JD extends ld{constructor(i){super(i),this.center=i.center||[0,30];const[o,u]=this.parallels=i.parallels||[30,30];let p=Xe(o),x=Xe(u);this.southernCenter=p+x<0,this.southernCenter&&(p=-p,x=-x);const w=Math.cos(p),M=Gx(p);this.n=p===x?Math.sin(p):Math.log(w/Math.cos(x))/Math.log(Gx(x)/M),this.f=w*Math.pow(Gx(p),this.n)/this.n}project(i,o){o=Xe(o),this.southernCenter&&(o=-o),i=Xe(i-this.center[0]);const u=1e-6,{n:p,f:x}=this;x>0?o<-Nm+u&&(o=-Nm+u):o>Nm-u&&(o=Nm-u);const w=x/Math.pow(Gx(o),p);let M=w*Math.sin(p*i),P=x-w*Math.cos(p*i);return M=.5*(M/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:M,y:this.southernCenter?P:1-P,z:0}}unproject(i,o){i=(2*i-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:u,f:p}=this,x=p-o,w=Math.sign(x),M=Math.sign(u)*Math.sqrt(i*i+x*x);let P=Math.atan2(i,Math.abs(x))*w;x*u<0&&(P-=Math.PI*Math.sign(i)*w);const D=ci(Tt(P/u)+this.center[0],-180,180),V=ci(Tt(2*Math.atan(Math.pow(p/M,1/u))-Nm),-85.051129,qo);return new $n(D,this.southernCenter?-V:V)}}class CE extends ld{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,o){return{x:qa(i),y:ya(o),z:0}}unproject(i,o){const u=Ho(i),p=kr(o);return new $n(u,p)}}const AE=Xe(qo);class QD extends ld{project(i,o){const u=(o=Xe(o))*o,p=u*u;return{x:.5*((i=Xe(i))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,p=25,x=0,w=u*u;do{w=u*u;const D=w*w;x=(u*(1.007226+w*(.015085+D*(.028874*w-.044475-.005916*D)))-o)/(1.007226+w*(.045255+D*(.259866*w-.311325-.005916*11*D))),u=ci(u-x,-AE,AE)}while(Math.abs(x)>1e-6&&--p>0);w=u*u;const M=ci(Tt(i/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),P=Tt(u);return new $n(M,P)}}const kE=Xe(qo);class eO extends ld{project(i,o){o=Xe(o),i=Xe(i);const u=Math.cos(o),p=2/Math.PI,x=Math.acos(u*Math.cos(i/2)),w=Math.sin(x)/x,M=.5*(i*p+2*u*Math.sin(i/2)/w)||0,P=.5*(o+Math.sin(o)/w)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(i,o){let u=i=(2*i-.5)*Math.PI,p=o=(2*(1-o)-1)*Math.PI,x=25;const w=1e-6;let M=0,P=0;do{const D=Math.cos(p),V=Math.sin(p),G=2*V*D,X=V*V,J=D*D,Q=Math.cos(u/2),ae=Math.sin(u/2),_e=2*Q*ae,Pe=ae*ae,je=1-J*Q*Q,Le=je?1/je:0,Ve=je?Math.acos(D*Q)*Math.sqrt(1/je):0,He=.5*(2*Ve*D*ae+2*u/Math.PI)-i,$e=.5*(Ve*V+p)-o,bt=.5*Le*(J*Pe+Ve*D*Q*X)+1/Math.PI,gt=Le*(_e*G/4-Ve*V*ae),It=.125*Le*(G*ae-Ve*V*J*_e),Qt=.5*Le*(X*Q+Ve*Pe*D)+.5,Et=gt*It-Qt*bt;M=($e*gt-He*Qt)/Et,P=(He*It-$e*bt)/Et,u=ci(u-M,-Math.PI,Math.PI),p=ci(p-P,-kE,kE)}while((Math.abs(M)>w||Math.abs(P)>w)&&--x>0);return new $n(Tt(u),Tt(p))}}class IE extends ld{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Xe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){const{scale:u,cosPhi:p}=this;return{x:Xe(i)*p*u+.5,y:-Math.sin(Xe(o))/p*u+.5,z:0}}unproject(i,o){const{scale:u,cosPhi:p}=this,x=-(o-.5)/u,w=ci(Tt((i-.5)/u)/p,-180,180),M=Math.asin(ci(x*p,-1,1)),P=ci(Tt(M),-85.051129,qo);return new $n(w,P)}}class tO extends CE{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,o,u){const p=zf(i,o,u);return Es(p,p,Fh(_a(u))),{x:p[0],y:p[1],z:p[2]}}locationPoint(i,o){const u=Xu(o.lat,o.lng),p=Xr([],u),x=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(o),i._centerAltitude):i._centerAltitude;kf(u,u,p,Xa(1,0)*Ai*x);const w=$o(new Float64Array(16));return ql(w,i.pixelMatrix,i.globeMatrix),Es(u,u,w),new Ne(u[0],u[1])}pixelsPerMeter(i,o){return Xa(1,0)*o}pixelSpaceConversion(i,o,u){const p=Xa(1,i)*o,x=_n(Xa(1,45)*o,p,u);return this.pixelsPerMeter(i,o)/x}createTileMatrix(i,o,u){const p=Kg(_a(u.canonical));return ql(new Float64Array(16),i.globeMatrix,p)}createInversionMatrix(i,o){const{center:u}=i,p=Fh(_a(o));return hm(p,p,Xe(u.lng)),Cf(p,p,Xe(u.lat)),Xl(p,p,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(i,o,u,p){return rx(i,o,u,!0)||new Ku(0,0)}pointCoordinate3D(i,o,u){const p=this.pointCoordinate(i,o,u,0);return[p.x,p.y,p.z]}isPointAboveHorizon(i,o){return!rx(i,o.x,o.y,!1)}farthestPixelDistance(i){const o=function(p,x){const w=p.cameraToCenterDistance,M=p._centerAltitude*x,P=p._camera,D=p._camera.forward(),V=Ga([],xo([],D,-w),[0,0,M]),G=p.worldSize/(2*Math.PI),X=[0,0,-G],J=p.width/p.height,Q=Math.tan(p.fovAboveCenter),ae=xo([],P.up(),Q),_e=xo([],P.right(),Q*J),Pe=Xr([],Ga([],Ga([],D,ae),_e)),je=[];let Le;if(new Xg(V,Pe).closestPointOnSphere(X,G,je)){const Ve=Ga([],je,X),He=Wo([],Ve,V);Le=Math.cos(p.fovAboveCenter)*Hu(He)}else{const Ve=Wo([],V,X),He=Wo([],X,V);Xr(He,He);const $e=Hu(Ve)-G;Le=Math.sqrt($e*($e+2*G));const bt=Math.acos(Le/(G+$e))-Math.acos(vo(D,He));Le*=Math.cos(bt)}return 1.01*Le}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),u=Yu(i.zoom);if(u>0){const p=ME(i,Xa(1,i.center.lat)*i.worldSize),x=i.worldSize/(2*Math.PI),w=Math.max(i.width,i.height)/i.worldSize*Math.PI;return _n(o,p+x*(1-Math.cos(w)),Math.pow(u,10))}return o}upVector(i,o,u){return zf(o,u,i,1)}upVectorScale(i){return{metersToTile:_m(Zu(_a(i)))}}}function PE(s){const i=s.parallels,o=!!i&&Math.abs(i[0]+i[1])<.01;switch(s.name){case"mercator":return new CE(s);case"equirectangular":return new KD(s);case"naturalEarth":return new QD(s);case"equalEarth":return new YD(s);case"winkelTripel":return new eO(s);case"albers":return o?new IE(s):new ZD(s);case"lambertConformalConic":return o?new IE(s):new JD(s);case"globe":return new tO(s)}throw new Error(`Invalid projection name: ${s.name}`)}const iO=Yf.types,nO=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Hx(s,i,o,u,p,x,w,M,P,D,V,G,X){const J=M?Math.min(ad,Math.round(M[0])):0,Q=M?Math.min(ad,Math.round(M[1])):0;s.emplaceBack(i,o,Math.round(32*u),Math.round(32*p),x,w,(J<<1)+(P?1:0),Q,16*D,16*V,256*G,256*X)}function qx(s,i,o,u,p,x,w){s.emplaceBack(i,o,u,p,x,w)}function Xx(s,i,o,u,p){s.emplaceBack(i,o,u,p),s.emplaceBack(i,o,u,p),s.emplaceBack(i,o,u,p),s.emplaceBack(i,o,u,p)}function sO(s){for(const i of s.sections)if(jg(i.text))return!0;return!1}class qb{constructor(i){this.layoutVertexArray=new kt,this.indexArray=new Ci,this.programConfigurations=i,this.segments=new zs,this.dynamicLayoutVertexArray=new qt,this.opacityVertexArray=new Pi,this.placedSymbolArray=new Ws,this.globeExtVertexArray=new Jt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,o,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ze.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,at.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,nO,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,yt.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}bi(qb,"SymbolBuffers");class Xb{constructor(i,o,u){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new u,this.segments=new zs,this.collisionVertexArray=new Zi,this.collisionVertexArrayExt=new Yi}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,vt.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,Vt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}bi(Xb,"CollisionBuffers");class cd{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(w=>w.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$o([]),this.placementViewportMatrix=$o([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=vi(this.zoom,o["text-size"]),this.iconSizeData=vi(this.zoom,o["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),x=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(w=>Ka[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=i.sourceID,this.projection=i.projection}createArrays(){this.text=new qb(new Fc(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new qb(new Fc(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Qs,this.lineVertexArray=new $u,this.symbolInstances=new ss}calculateGlyphDependencies(i,o,u,p,x){for(let w=0;w<i.length;w++)if(o[i.charCodeAt(w)]=!0,p&&x){const M=hn[i.charAt(w)];M&&(o[M.charCodeAt(0)]=!0)}}populate(i,o,u,p){const x=this.layers[0],w=x.layout,M=this.projection.name==="globe",P=w.get("text-font"),D=w.get("text-field"),V=w.get("icon-image"),G=(D.value.kind!=="constant"||D.value.value instanceof Hr&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),X=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,J=w.get("symbol-sort-key");if(this.features=[],!G&&!X)return;const Q=o.iconDependencies,ae=o.glyphDependencies,_e=o.availableImages,Pe=new j(this.zoom);for(const{feature:je,id:Le,index:Ve,sourceLayerIndex:He}of i){const $e=x._featureFilter.needGeometry,bt=Nh(je,$e);if(!x._featureFilter.filter(Pe,bt,u))continue;if($e||(bt.geometry=Za(je,u,p)),M&&je.type!==1&&u.z<=5){const Et=bt.geometry,Nt=.98078528056,Ut=(Gt,si)=>vo(zf(Gt.x,Gt.y,u,1),zf(si.x,si.y,u,1))<Nt;for(let Gt=0;Gt<Et.length;Gt++)Et[Gt]=pb(Et[Gt],Ut)}let gt,It;if(G){const Et=x.getValueAndResolveTokens("text-field",bt,u,_e),Nt=Hr.factory(Et);sO(Nt)&&(this.hasRTLText=!0),(!this.hasRTLText||A()==="unavailable"||this.hasRTLText&&z.isParsed())&&(gt=xn(Nt,x,bt))}if(X){const Et=x.getValueAndResolveTokens("icon-image",bt,u,_e);It=Et instanceof Or?Et:Or.fromString(Et)}if(!gt&&!It)continue;const Qt=this.sortFeaturesByKey?J.evaluate(bt,{},u):void 0;if(this.features.push({id:Le,text:gt,icon:It,index:Ve,sourceLayerIndex:He,geometry:bt.geometry,properties:je.properties,type:iO[je.type],sortKey:Qt}),It&&(Q[It.name]=!0),gt){const Et=P.evaluate(bt,{},u).join(","),Nt=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ka.vertical)>=0;for(const Ut of gt.sections)if(Ut.image)Q[Ut.image.name]=!0;else{const Gt=xf(gt.toString()),si=Ut.fontStack||Et,At=ae[si]=ae[si]||{};this.calculateGlyphDependencies(Ut.text,At,Nt,this.allowVerticalPlacement,Gt)}}}w.get("symbol-placement")==="line"&&(this.features=function(je){const Le={},Ve={},He=[];let $e=0;function bt(Et){He.push(je[Et]),$e++}function gt(Et,Nt,Ut){const Gt=Ve[Et];return delete Ve[Et],Ve[Nt]=Gt,He[Gt].geometry[0].pop(),He[Gt].geometry[0]=He[Gt].geometry[0].concat(Ut[0]),Gt}function It(Et,Nt,Ut){const Gt=Le[Nt];return delete Le[Nt],Le[Et]=Gt,He[Gt].geometry[0].shift(),He[Gt].geometry[0]=Ut[0].concat(He[Gt].geometry[0]),Gt}function Qt(Et,Nt,Ut){const Gt=Ut?Nt[0][Nt[0].length-1]:Nt[0][0];return`${Et}:${Gt.x}:${Gt.y}`}for(let Et=0;Et<je.length;Et++){const Nt=je[Et],Ut=Nt.geometry,Gt=Nt.text?Nt.text.toString():null;if(!Gt){bt(Et);continue}const si=Qt(Gt,Ut),At=Qt(Gt,Ut,!0);if(si in Ve&&At in Le&&Ve[si]!==Le[At]){const fi=It(si,At,Ut),Si=gt(si,At,He[fi].geometry);delete Le[si],delete Ve[At],Ve[Qt(Gt,He[Si].geometry,!0)]=Si,He[fi].geometry=null}else si in Ve?gt(si,At,Ut):At in Le?It(si,At,Ut):(bt(Et),Le[si]=$e-1,Ve[At]=$e-1)}return He.filter(Et=>Et.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((je,Le)=>je.sortKey-Le.sortKey)}update(i,o,u,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,o,this.layers,u,p),this.icon.programConfigurations.updatePaintArrays(i,o,this.layers,u,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=PE(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const u=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:p,y:x}of o)this.lineVertexArray.emplaceBack(p,x);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(i,o,u,p,x,w,M,P,D,V,G,X,J,Q){const ae=i.indexArray,_e=i.layoutVertexArray,Pe=i.globeExtVertexArray,je=i.segments.prepareSegment(4*o.length,_e,ae,this.canOverlap?w.sortKey:void 0),Le=this.glyphOffsetArray.length,Ve=je.vertexLength,He=this.allowVerticalPlacement&&M===Ka.vertical?Math.PI/2:0,$e=w.text&&w.text.sections;for(let gt=0;gt<o.length;gt++){const{tl:It,tr:Qt,bl:Et,br:Nt,tex:Ut,pixelOffsetTL:Gt,pixelOffsetBR:si,minFontScaleX:At,minFontScaleY:fi,glyphOffset:Si,isSDF:_i,sectionIndex:Ji}=o[gt],ri=je.vertexLength,Di=Si[1];if(Hx(_e,D.x,D.y,It.x,Di+It.y,Ut.x,Ut.y,u,_i,Gt.x,Gt.y,At,fi),Hx(_e,D.x,D.y,Qt.x,Di+Qt.y,Ut.x+Ut.w,Ut.y,u,_i,si.x,Gt.y,At,fi),Hx(_e,D.x,D.y,Et.x,Di+Et.y,Ut.x,Ut.y+Ut.h,u,_i,Gt.x,si.y,At,fi),Hx(_e,D.x,D.y,Nt.x,Di+Nt.y,Ut.x+Ut.w,Ut.y+Ut.h,u,_i,si.x,si.y,At,fi),P){const{x:Qi,y:Pn,z:en}=P.anchor,[Bi,fs,sn]=P.up;qx(Pe,Qi,Pn,en,Bi,fs,sn),qx(Pe,Qi,Pn,en,Bi,fs,sn),qx(Pe,Qi,Pn,en,Bi,fs,sn),qx(Pe,Qi,Pn,en,Bi,fs,sn),Xx(i.dynamicLayoutVertexArray,Qi,Pn,en,He)}else Xx(i.dynamicLayoutVertexArray,D.x,D.y,D.z,He);ae.emplaceBack(ri,ri+1,ri+2),ae.emplaceBack(ri+1,ri+2,ri+3),je.vertexLength+=4,je.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Si[0]),gt!==o.length-1&&Ji===o[gt+1].sectionIndex||i.programConfigurations.populatePaintArrays(_e.length,w,w.index,{},J,Q,$e&&$e[Ji])}const bt=P?P.anchor:D;i.placedSymbolArray.emplaceBack(bt.x,bt.y,bt.z,D.x,D.y,Le,this.glyphOffsetArray.length-Le,Ve,V,G,D.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],M,0,!1,0,X,0)}_commitLayoutVertex(i,o,u,p,x,w,M){i.emplaceBack(o,u,p,x,w,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(i,o,u,p,x,w,M){const P=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),D=P.vertexLength,V=M.tileAnchorX,G=M.tileAnchorY;for(let J=0;J<4;J++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(o,-i.padding,-i.padding),u.collisionVertexArrayExt.emplaceBack(o,i.padding,-i.padding),u.collisionVertexArrayExt.emplaceBack(o,i.padding,i.padding),u.collisionVertexArrayExt.emplaceBack(o,-i.padding,i.padding),this._commitLayoutVertex(u.layoutVertexArray,p,x,w,V,G,new Ne(i.x1,i.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,x,w,V,G,new Ne(i.x2,i.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,x,w,V,G,new Ne(i.x2,i.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,x,w,V,G,new Ne(i.x1,i.y2)),P.vertexLength+=4;const X=u.indexArray;X.emplaceBack(D,D+1),X.emplaceBack(D+1,D+2),X.emplaceBack(D+2,D+3),X.emplaceBack(D+3,D),P.primitiveLength+=4}_addTextDebugCollisionBoxes(i,o,u,p,x,w){for(let M=p;M<x;M++){const P=u.get(M),D=this.getSymbolInstanceTextSize(i,w,o,M);this._addCollisionDebugVertices(P,D,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(i,o,u,p,x,w){for(let M=p;M<x;M++){const P=u.get(M),D=this.getSymbolInstanceIconSize(i,o,w.placedIconSymbolIndex);this._addCollisionDebugVertices(P,D,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,w)}}generateCollisionDebugBuffers(i,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xb(wi,ii.members,ur),this.iconCollisionBox=new Xb(wi,ii.members,ur);const u=Ti(this.iconSizeData,i),p=Ti(this.textSizeData,i);for(let x=0;x<this.symbolInstances.length;x++){const w=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(p,i,o,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(p,i,o,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(u,i,o,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(u,i,o,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(i,o,u,p){const x=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:p),w=Wi(this.textSizeData,i,x)/$t;return this.tilePixelRatio*w}getSymbolInstanceIconSize(i,o,u){const p=this.icon.placedSymbolArray.get(u),x=Wi(this.iconSizeData,i,p);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(i,o,u){i.emplaceBack(o,-u,-u),i.emplaceBack(o,u,-u),i.emplaceBack(o,u,u),i.emplaceBack(o,-u,u)}_updateTextDebugCollisionBoxes(i,o,u,p,x,w){for(let M=p;M<x;M++){const P=u.get(M),D=this.getSymbolInstanceTextSize(i,w,o,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,P.padding)}}_updateIconDebugCollisionBoxes(i,o,u,p,x,w){for(let M=p;M<x;M++){const P=u.get(M),D=this.getSymbolInstanceIconSize(i,o,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,P.padding)}}updateCollisionDebugBuffers(i,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=Ti(this.iconSizeData,i),p=Ti(this.textSizeData,i);for(let x=0;x<this.symbolInstances.length;x++){const w=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(p,i,o,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(p,i,o,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(u,i,o,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(u,i,o,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,o,u,p,x,w,M,P,D){const V={};if(o<u){const{x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve,featureIndex:He}=i.get(o);V.textBox={x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve},V.textFeatureIndex=He}if(p<x){const{x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve,featureIndex:He}=i.get(p);V.verticalTextBox={x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve},V.verticalTextFeatureIndex=He}if(w<M){const{x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve,featureIndex:He}=i.get(w);V.iconBox={x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve},V.iconFeatureIndex=He}if(P<D){const{x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve,featureIndex:He}=i.get(P);V.verticalIconBox={x1:G,y1:X,x2:J,y2:Q,padding:ae,projectedAnchorX:_e,projectedAnchorY:Pe,projectedAnchorZ:je,tileAnchorX:Le,tileAnchorY:Ve},V.verticalIconFeatureIndex=He}return V}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,o){const u=i.placedSymbolArray.get(o),p=u.vertexStartIndex+4*u.numGlyphs;for(let x=u.vertexStartIndex;x<p;x+=4)i.indexArray.emplaceBack(x,x+1,x+2),i.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),u=Math.cos(i),p=[],x=[],w=[];for(let M=0;M<this.symbolInstances.length;++M){w.push(M);const P=this.symbolInstances.get(M);p.push(0|Math.round(o*P.tileAnchorX+u*P.tileAnchorY)),x.push(P.featureIndex)}return w.sort((M,P)=>p[M]-p[P]||x[P]-x[M]),w}addToSortKeyRanges(i,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:x,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:D}=u;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),x>=0&&x!==p&&this.addIndicesForPlacedSymbol(this.text,x),w>=0&&w!==x&&w!==p&&this.addIndicesForPlacedSymbol(this.text,w),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}bi(cd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),cd.MAX_GLYPHS=65535,cd.addDynamicAttributes=Xx;const rO=new Re({"symbol-placement":new re(Ct.layout_symbol["symbol-placement"]),"symbol-spacing":new re(Ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new re(Ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new we(Ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new re(Ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new re(Ct.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new re(Ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new re(Ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new re(Ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new we(Ct.layout_symbol["icon-size"]),"icon-text-fit":new re(Ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new re(Ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new we(Ct.layout_symbol["icon-image"]),"icon-rotate":new we(Ct.layout_symbol["icon-rotate"]),"icon-padding":new re(Ct.layout_symbol["icon-padding"]),"icon-keep-upright":new re(Ct.layout_symbol["icon-keep-upright"]),"icon-offset":new we(Ct.layout_symbol["icon-offset"]),"icon-anchor":new we(Ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new re(Ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new re(Ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new re(Ct.layout_symbol["text-rotation-alignment"]),"text-field":new we(Ct.layout_symbol["text-field"]),"text-font":new we(Ct.layout_symbol["text-font"]),"text-size":new we(Ct.layout_symbol["text-size"]),"text-max-width":new we(Ct.layout_symbol["text-max-width"]),"text-line-height":new we(Ct.layout_symbol["text-line-height"]),"text-letter-spacing":new we(Ct.layout_symbol["text-letter-spacing"]),"text-justify":new we(Ct.layout_symbol["text-justify"]),"text-radial-offset":new we(Ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new re(Ct.layout_symbol["text-variable-anchor"]),"text-anchor":new we(Ct.layout_symbol["text-anchor"]),"text-max-angle":new re(Ct.layout_symbol["text-max-angle"]),"text-writing-mode":new re(Ct.layout_symbol["text-writing-mode"]),"text-rotate":new we(Ct.layout_symbol["text-rotate"]),"text-padding":new re(Ct.layout_symbol["text-padding"]),"text-keep-upright":new re(Ct.layout_symbol["text-keep-upright"]),"text-transform":new we(Ct.layout_symbol["text-transform"]),"text-offset":new we(Ct.layout_symbol["text-offset"]),"text-allow-overlap":new re(Ct.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new re(Ct.layout_symbol["text-ignore-placement"]),"text-optional":new re(Ct.layout_symbol["text-optional"])});var Zb={paint:new Re({"icon-opacity":new we(Ct.paint_symbol["icon-opacity"]),"icon-color":new we(Ct.paint_symbol["icon-color"]),"icon-halo-color":new we(Ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new we(Ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new we(Ct.paint_symbol["icon-halo-blur"]),"icon-translate":new re(Ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new re(Ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new we(Ct.paint_symbol["text-opacity"]),"text-color":new we(Ct.paint_symbol["text-color"],{runtimeType:$r,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new we(Ct.paint_symbol["text-halo-color"]),"text-halo-width":new we(Ct.paint_symbol["text-halo-width"]),"text-halo-blur":new we(Ct.paint_symbol["text-halo-blur"]),"text-translate":new re(Ct.paint_symbol["text-translate"]),"text-translate-anchor":new re(Ct.paint_symbol["text-translate-anchor"])}),layout:rO};class LE{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:pc,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bi(LE,"FormatSectionOverride",{omit:["defaultValue"]});class Zx extends Wa{constructor(i){super(i,Zb)}recalculate(i,o){super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const x of u)p.indexOf(x)<0&&p.push(x);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,o,u,p){const x=this.layout.get(i).evaluate(o,{},u,p),w=this._unevaluatedLayout._values[i];return w.isDataDriven()||On(w.value)||!x?x:function(M,P){return P.replace(/{([^{}]+)}/g,(D,V)=>V in M?String(M[V]):"")}(o.properties,x)}createBucket(i){return new cd(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of Zb.paint.overridableProperties){if(!Zx.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),u=new LE(o),p=new Er(u,o.property.specification);let x=null;x=o.value.kind==="constant"||o.value.kind==="source"?new Ru("source",p):new Fl("composite",p,o.value.zoomStops,o.value._interpolationType),this.paint._values[i]=new Se(o.property,x,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&Zx.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const u=i.get("text-field"),p=Zb.paint.properties[o];let x=!1;const w=M=>{for(const P of M)if(p.overrides&&p.overrides.hasOverride(P))return void(x=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Hr)w(u.value.value.sections);else if(u.value.kind==="source"){const M=D=>{x||(D instanceof Da&&As(D.value)===wr?w(D.value.sections):D instanceof Ra?w(D.sections):D.eachChild(M))},P=u.value;P._styleExpression&&M(P._styleExpression.expression)}return x}getProgramConfiguration(i){return new Bc(this,i)}}var oO={paint:new Re({"background-color":new re(Ct.paint_background["background-color"]),"background-pattern":new re(Ct.paint_background["background-pattern"]),"background-opacity":new re(Ct.paint_background["background-opacity"])})},aO={paint:new Re({"raster-opacity":new re(Ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new re(Ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new re(Ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new re(Ct.paint_raster["raster-brightness-max"]),"raster-saturation":new re(Ct.paint_raster["raster-saturation"]),"raster-contrast":new re(Ct.paint_raster["raster-contrast"]),"raster-resampling":new re(Ct.paint_raster["raster-resampling"]),"raster-fade-duration":new re(Ct.paint_raster["raster-fade-duration"])})};class lO extends Wa{constructor(i){super(i,{}),this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var cO={paint:new Re({"sky-type":new re(Ct.paint_sky["sky-type"]),"sky-atmosphere-sun":new re(Ct.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new re(Ct.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new re(Ct.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new re(Ct.paint_sky["sky-gradient-radius"]),"sky-gradient":new De(Ct.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new re(Ct.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new re(Ct.paint_sky["sky-atmosphere-color"]),"sky-opacity":new re(Ct.paint_sky["sky-opacity"])})};function Yb(s,i,o){const u=[0,0,1],p=Ar([]);return qg(p,p,o?-Xe(s)+Math.PI:Xe(s)),ex(p,p,-Xe(i)),In(u,u,p),Xr(u,u)}const hO={circle:class extends Wa{constructor(s){super(s,Wc)}createBucket(s){return new Qu(s)}queryRadius(s){const i=s;return td("circle-radius",this,i)+td("circle-stroke-width",this,i)+yl(this.paint.get("circle-translate"))}queryIntersectsFeature(s,i,o,u,p,x,w,M){const P=Em(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,s.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o);return id(s,u,x,w,M,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,D)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new Bc(this,s)}},heatmap:class extends Wa{createBucket(s){return new n_(s)}constructor(s){super(s,yb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=s_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return td("heatmap-radius",this,s)}queryIntersectsFeature(s,i,o,u,p,x,w,M){const P=this.paint.get("heatmap-radius").evaluate(i,o);return id(s,u,x,w,M,!0,!0,new Ne(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new Bc(this,s)}},hillshade:class extends Wa{constructor(s){super(s,xb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Wa{constructor(s){super(s,kb)}getProgramIds(){const s=this.paint.get("fill-pattern"),i=s&&s.constantOr(1),o=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(s){return new Bc(this,s)}recalculate(s,i){super.recalculate(s,i);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Zf(s)}queryRadius(){return yl(this.paint.get("fill-translate"))}queryIntersectsFeature(s,i,o,u,p,x){return!s.queryGeometry.isAboveHorizon&&t_(i_(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,s.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Wa{constructor(s){super(s,c)}createBucket(s){return new Qf(s)}queryRadius(){return yl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new Bc(this,s)}queryIntersectsFeature(s,i,o,u,p,x,w,M,P){const D=Em(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,s.pixelToTileUnitsFactor),V=this.paint.get("fill-extrusion-height").evaluate(i,o),G=this.paint.get("fill-extrusion-base").evaluate(i,o),X=[0,0],J=M&&x.elevation,Q=x.elevation?x.elevation.exaggeration():1,ae=s.tile.getBucket(this);if(J&&ae instanceof Qf){const Ve=ae.centroidVertexArray,He=P+1;He<Ve.length&&(X[0]=Ve.geta_centroid_pos0(He),X[1]=Ve.geta_centroid_pos1(He))}if(X[0]===0&&X[1]===1)return!1;x.projection.name==="globe"&&(u=__([u],[new Ne(0,0),new Ne(Ai,Ai)],s.tileID.canonical).map(Ve=>Ve.polygon).flat());const _e=J?M:null,[Pe,je]=function(Ve,He,$e,bt,gt,It,Qt,Et,Nt,Ut,Gt){return Ve.projection.name==="globe"?function(si,At,fi,Si,_i,Ji,ri,Di,Qi,Pn,en){const Bi=[],fs=[],sn=si.projection.upVectorScale(en,si.center.lat,si.worldSize).metersToTile,rn=[0,0,0,1],Jn=[0,0,0,1],os=(Qn,Ps,Hs,tr)=>{Qn[0]=Ps,Qn[1]=Hs,Qn[2]=tr,Qn[3]=1},as=zx();fi>0&&(fi+=as),Si+=as;for(const Qn of At){const Ps=[],Hs=[];for(const tr of Qn){const es=tr.x+_i.x,dr=tr.y+_i.y,ir=si.projection.projectTilePoint(es,dr,en),Fs=si.projection.upVector(en,tr.x,tr.y);let zn=fi,nr=Si;if(ri){const ls=W(es,dr,fi,Si,ri,Di,Qi,Pn);zn+=ls.base,nr+=ls.top}fi!==0?os(rn,ir.x+Fs[0]*sn*zn,ir.y+Fs[1]*sn*zn,ir.z+Fs[2]*sn*zn):os(rn,ir.x,ir.y,ir.z),os(Jn,ir.x+Fs[0]*sn*nr,ir.y+Fs[1]*sn*nr,ir.z+Fs[2]*sn*nr),Es(rn,rn,Ji),Es(Jn,Jn,Ji),Ps.push(new I(rn[0],rn[1],rn[2])),Hs.push(new I(Jn[0],Jn[1],Jn[2]))}Bi.push(Ps),fs.push(Hs)}return[Bi,fs]}(Ve,He,$e,bt,gt,It,Qt,Et,Nt,Ut,Gt):Qt?function(si,At,fi,Si,_i,Ji,ri,Di,Qi){const Pn=[],en=[],Bi=[0,0,0,1];for(const fs of si){const sn=[],rn=[];for(const Jn of fs){const os=Jn.x+Si.x,as=Jn.y+Si.y,Qn=W(os,as,At,fi,Ji,ri,Di,Qi);Bi[0]=os,Bi[1]=as,Bi[2]=Qn.base,Bi[3]=1,Zr(Bi,Bi,_i),Bi[3]=Math.max(Bi[3],1e-5);const Ps=new I(Bi[0]/Bi[3],Bi[1]/Bi[3],Bi[2]/Bi[3]);Bi[0]=os,Bi[1]=as,Bi[2]=Qn.top,Bi[3]=1,Zr(Bi,Bi,_i),Bi[3]=Math.max(Bi[3],1e-5);const Hs=new I(Bi[0]/Bi[3],Bi[1]/Bi[3],Bi[2]/Bi[3]);sn.push(Ps),rn.push(Hs)}Pn.push(sn),en.push(rn)}return[Pn,en]}(He,$e,bt,gt,It,Qt,Et,Nt,Ut):function(si,At,fi,Si,_i){const Ji=[],ri=[],Di=_i[8]*At,Qi=_i[9]*At,Pn=_i[10]*At,en=_i[11]*At,Bi=_i[8]*fi,fs=_i[9]*fi,sn=_i[10]*fi,rn=_i[11]*fi;for(const Jn of si){const os=[],as=[];for(const Qn of Jn){const Ps=Qn.x+Si.x,Hs=Qn.y+Si.y,tr=_i[0]*Ps+_i[4]*Hs+_i[12],es=_i[1]*Ps+_i[5]*Hs+_i[13],dr=_i[2]*Ps+_i[6]*Hs+_i[14],ir=_i[3]*Ps+_i[7]*Hs+_i[15],Fs=tr+Di,zn=es+Qi,nr=dr+Pn,ls=Math.max(ir+en,1e-5),To=tr+Bi,sr=es+fs,Br=dr+sn,Ir=Math.max(ir+rn,1e-5);os.push(new I(Fs/ls,zn/ls,nr/ls)),as.push(new I(To/Ir,sr/Ir,Br/Ir))}Ji.push(os),ri.push(as)}return[Ji,ri]}(He,$e,bt,gt,It)}(x,u,G,V,D,w,_e,X,Q,x.center.lat,s.tileID.canonical),Le=s.queryGeometry;return function(Ve,He,$e){let bt=1/0;t_($e,He)&&(bt=B($e,He[0]));for(let gt=0;gt<He.length;gt++){const It=He[gt],Qt=Ve[gt];for(let Et=0;Et<It.length-1;Et++){const Nt=It[Et],Ut=[Nt,It[Et+1],Qt[Et+1],Qt[Et],Nt];Uf($e,Ut)&&(bt=Math.min(bt,B($e,Ut)))}}return bt!==1/0&&bt}(Pe,je,Le.isPointQuery()?Le.screenBounds:Le.screenGeometry)}},line:class extends Wa{constructor(s){super(s,xe),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Jd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(s,i){super.recalculate(s,i),this.paint._values["line-floorwidth"]=et.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new oe(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new Bc(this,s)}queryRadius(s){const i=s,o=Ge(td("line-width",this,i),td("line-gap-width",this,i)),u=td("line-offset",this,i);return o/2+Math.abs(u)+yl(this.paint.get("line-translate"))}queryIntersectsFeature(s,i,o,u,p,x){if(s.queryGeometry.isAboveHorizon)return!1;const w=i_(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,s.pixelToTileUnitsFactor),M=s.pixelToTileUnitsFactor/2*Ge(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),P=this.paint.get("line-offset").evaluate(i,o);return P&&(u=function(D,V){const G=[],X=new Ne(0,0);for(let J=0;J<D.length;J++){const Q=D[J],ae=[];for(let _e=0;_e<Q.length;_e++){const Pe=Q[_e],je=Q[_e+1],Le=_e===0?X:Pe.sub(Q[_e-1])._unit()._perp(),Ve=_e===Q.length-1?X:je.sub(Pe)._unit()._perp(),He=Le._add(Ve)._unit();He._mult(1/(He.x*Ve.x+He.y*Ve.y)),ae.push(He._mult(V)._add(Pe))}G.push(ae)}return G}(u,P*s.pixelToTileUnitsFactor)),function(D,V,G){for(let X=0;X<V.length;X++){const J=V[X];if(D.length>=3){for(let Q=0;Q<J.length;Q++)if(_l(D,J[Q]))return!0}if(px(D,J,G))return!0}return!1}(w,u,M)}isTileClipped(){return!0}},symbol:Zx,background:class extends Wa{constructor(s){super(s,oO)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Wa{constructor(s){super(s,aO)}getProgramIds(){return["raster"]}},sky:class extends Wa{constructor(s){super(s,cO),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=s_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(s,i){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),p=!u,x=s.style.light,w=x.properties.get("position");return p&&x.properties.get("anchor")==="viewport"&&Bt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?Yb(w.azimuthal,90-w.polar,i):Yb(u[0],90-u[1],i)}const o=this.paint.get("sky-gradient-center");return Yb(o[0],90-o[1],i)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}}};class S_{constructor(i,o,u,p){this.context=i,this.format=u,this.texture=i.gl.createTexture(),this.update(o,p)}update(i,o,u){const{width:p,height:x}=i,{context:w}=this,{gl:M}=w,{HTMLImageElement:P,HTMLCanvasElement:D,HTMLVideoElement:V,ImageData:G,ImageBitmap:X}=C;if(M.bindTexture(M.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!o||o.premultiply!==!1)),u||this.size&&this.size[0]===p&&this.size[1]===x){const{x:J,y:Q}=u||{x:0,y:0};i instanceof P||i instanceof D||i instanceof V||i instanceof G||X&&i instanceof X?M.texSubImage2D(M.TEXTURE_2D,0,J,Q,M.RGBA,M.UNSIGNED_BYTE,i):M.texSubImage2D(M.TEXTURE_2D,0,J,Q,p,x,M.RGBA,M.UNSIGNED_BYTE,i.data)}else this.size=[p,x],i instanceof P||i instanceof D||i instanceof V||i instanceof G||X&&i instanceof X?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,i):M.texImage2D(M.TEXTURE_2D,0,this.format,p,x,0,this.format,M.UNSIGNED_BYTE,i.data);this.useMipmap=!!(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&M.generateMipmap(M.TEXTURE_2D)}bind(i,o){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),i!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?i===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:i),this.filter=i),o!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class uO{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class dO{constructor(){this.tasks={},this.taskQueue=[],jt(["process"],this),this.invoker=new uO(this.process),this.nextId=0}add(i,o){const u=this.nextId++,p=function({type:x,isSymbolTile:w,zoom:M}){return M=M||0,x==="message"?0:x!=="maybePrepare"||w?x!=="parseTile"||w?x==="parseTile"&&w?300-M:x==="maybePrepare"&&w?400-M:500:200-M:100-M}(o);if(p===0){di();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:i,metadata:o,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){di();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const o=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let i=null,o=1/0;for(let p=0;p<this.taskQueue.length;p++){const x=this.tasks[this.taskQueue[p]];x.priority<o&&(o=x.priority,i=p)}if(i===null)return null;const u=this.taskQueue[i];return this.taskQueue.splice(i,1),u}remove(){this.invoker.remove()}}class DE{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const u=i[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const fO=["tile","layer","source","sourceLayer","state"];class OE{constructor(i,o,u,p,x){this.type="Feature",this._vectorTileFeature=i,this._z=o,this._x=u,this._y=p,this.properties=i.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(i.id=this.id);for(const o of fO)this[o]!==void 0&&(i[o]=this[o]);return i}}const xl=32,qc=33,hd=new Uint16Array(8184);for(let s=0;s<2046;s++){let i=s+2,o=0,u=0,p=0,x=0,w=0,M=0;for(1&i?p=x=w=xl:o=u=M=xl;(i>>=1)>1;){const D=o+p>>1,V=u+x>>1;1&i?(p=o,x=u,o=w,u=M):(o=p,u=x,p=w,x=M),w=D,M=V}const P=4*s;hd[P+0]=o,hd[P+1]=u,hd[P+2]=p,hd[P+3]=x}const Xc=new Uint16Array(2178),ud=new Uint8Array(1089),Yx=new Uint16Array(1089);function RE(s){return s===0?-.03125:s===32?.03125:0}var zE=ot([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const BE={type:2,extent:Ai,loadGeometry:()=>[[new Ne(0,0),new Ne(Ai+1,0),new Ne(Ai+1,Ai+1),new Ne(0,Ai+1),new Ne(0,0)]]};class Kb{constructor(i,o,u,p,x){this.tileID=i,this.uid=wn(),this.uses=0,this.tileSize=o,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=x,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(i){const o=i+this.timeAdded;o<sa.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=sp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,o,u){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(p,x){const w={};if(!x)return w;for(const M of p){const P=M.layerIds.map(D=>x.getLayer(D)).filter(Boolean);if(P.length!==0){M.layers=P,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(D=>P.filter(V=>V.id===D)[0]));for(const D of P)w[D.id]=M}}return w}(i.buckets,o.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const x=this.buckets[p];if(x instanceof cd){if(this.hasSymbolBuckets=!0,!u)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const x=this.buckets[p];if(x instanceof cd&&x.hasRTLText){this.hasRTLText=!0,z.isLoading()||z.isLoaded()||A()!=="deferred"||R();break}}this.queryPadding=0;for(const p in this.buckets){const x=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(p).queryRadius(x))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new Xn}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.id]}upload(i){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(i)}const o=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new S_(i,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new S_(i,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new S_(i,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,o,u,p,x,w,M,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:M,transform:w,params:x,tileTransform:this.tileTransform},i,o,u):{}}querySourceFeatures(i,o){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),x=o?o.sourceLayer:"",w=p._geojsonTileLayer||p[x];if(!w)return;const M=zu(o&&o.filter),{z:P,x:D,y:V}=this.tileID.canonical,G={z:P,x:D,y:V};for(let X=0;X<w.length;X++){const J=w.feature(X);if(M.needGeometry){const _e=Nh(J,!0);if(!M.filter(new j(this.tileID.overscaledZ),_e,this.tileID.canonical))continue}else if(!M.filter(new j(this.tileID.overscaledZ),J))continue;const Q=u.getId(J,x),ae=new OE(J,P,D,V,Q);ae.tile=G,i.push(ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const o=this.expirationTime;if(i.cacheControl){const u=Ie(i.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(o)if(this.expirationTime<o)p=!0;else{const x=this.expirationTime-o;x?this.expirationTime=u+Math.max(x,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0||!o)return;const u=this.latestFeatureIndex.loadVTLayers(),p=o.style.listImages();for(const x in this.buckets){if(!o.style.hasLayer(x))continue;const w=this.buckets[x],M=w.layers[0].sourceLayer||"_geojsonTileLayer",P=u[M],D=i[M];if(!P||!D||Object.keys(D).length===0)continue;if(w.update(D,P,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof oe||w instanceof Zf){const G=o.style._getSourceCache(w.layers[0].source);o._terrain&&o._terrain.enabled&&G&&w.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(G.id,this.tileID)}const V=o&&o.style&&o.style.getLayer(x);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<sa.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=sa.now()+i}setTexture(i,o){const u=o.context,p=u.gl;this.texture=this.texture||o.getTileTexture(i.width),this.texture?this.texture.update(i,{useMipmap:!0}):(this.texture=new S_(u,i,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(i,o){const u={};for(const p of o)u[p]=!0;this.dependencies[i]=u}hasDependency(i,o){for(const u of i){const p=this.dependencies[u];if(p){for(const x of o)if(p[x])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,o){if(!o||o.name==="mercator"||this._tileDebugBuffer)return;const u=Za(BE,this.tileID.canonical,this.tileTransform)[0],p=new Wt,x=new _o;for(let w=0;w<u.length;w++){const{x:M,y:P}=u[w];p.emplaceBack(M,P),x.emplaceBack(w)}x.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(x),this._tileDebugBuffer=i.createVertexBuffer(p,ga.members),this._tileDebugSegments=zs.simpleSegment(0,0,p.length,x.length)}_makeTileBoundsBuffers(i,o){if(this._tileBoundsBuffer||!o||o.name==="mercator")return;const u=Za(BE,this.tileID.canonical,this.tileTransform)[0];let p,x;if(this.isRaster){const w=function(M,P){const D=sp(M,P),V=Math.pow(2,M.z);for(let _e=0;_e<qc;_e++)for(let Pe=0;Pe<qc;Pe++){const je=Ho((M.x+(Pe+RE(Pe))/xl)/V),Le=kr((M.y+(_e+RE(_e))/xl)/V),Ve=P.project(je,Le),He=_e*qc+Pe;Xc[2*He+0]=Math.round((Ve.x*D.scale-D.x)*Ai),Xc[2*He+1]=Math.round((Ve.y*D.scale-D.y)*Ai)}ud.fill(0),Yx.fill(0);for(let _e=2045;_e>=0;_e--){const Pe=4*_e,je=hd[Pe+0],Le=hd[Pe+1],Ve=hd[Pe+2],He=hd[Pe+3],$e=je+Ve>>1,bt=Le+He>>1,gt=$e+bt-Le,It=bt+je-$e,Qt=Le*qc+je,Et=He*qc+Ve,Nt=bt*qc+$e,Ut=Math.hypot((Xc[2*Qt+0]+Xc[2*Et+0])/2-Xc[2*Nt+0],(Xc[2*Qt+1]+Xc[2*Et+1])/2-Xc[2*Nt+1])>=16;ud[Nt]=ud[Nt]||(Ut?1:0),_e<1022&&(ud[Nt]=ud[Nt]||ud[(Le+It>>1)*qc+(je+gt>>1)]||ud[(He+It>>1)*qc+(Ve+gt>>1)])}const G=new Lt,X=new Ci;let J=0;function Q(_e,Pe){const je=Pe*qc+_e;return Yx[je]===0&&(G.emplaceBack(Xc[2*je+0],Xc[2*je+1],_e*Ai/xl,Pe*Ai/xl),Yx[je]=++J),Yx[je]-1}function ae(_e,Pe,je,Le,Ve,He){const $e=_e+je>>1,bt=Pe+Le>>1;if(Math.abs(_e-Ve)+Math.abs(Pe-He)>1&&ud[bt*qc+$e])ae(Ve,He,_e,Pe,$e,bt),ae(je,Le,Ve,He,$e,bt);else{const gt=Q(_e,Pe),It=Q(je,Le),Qt=Q(Ve,He);X.emplaceBack(gt,It,Qt)}}return ae(0,0,xl,xl,xl,0),ae(xl,xl,0,0,0,xl),{vertices:G,indices:X}}(this.tileID.canonical,o);p=w.vertices,x=w.indices}else{p=new Lt,x=new Ci;for(const{x:M,y:P}of u)p.emplaceBack(M,P,0,0);const w=h_(p.int16,void 0,4);for(let M=0;M<w.length;M+=3)x.emplaceBack(w[M],w[M+1],w[M+2])}this._tileBoundsBuffer=i.createVertexBuffer(p,zE.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(x),this._tileBoundsSegments=zs.simpleSegment(0,0,p.length,x.length)}_makeGlobeTileDebugBuffers(i,o){const u=o.projection;if(!u||u.name!=="globe"||o.freezeTileCoverage)return;const p=this.tileID.canonical,x=Fh(Yg(p,o)),w=Yu(o.zoom);let M;w>0&&(M=cm(new Float64Array(16),o.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,p,o,x,M,w),this._makeGlobeTileDebugTextBuffer(i,p,o,x,M,w)}_globePoint(i,o,u,p,x,w,M){let P=zf(i,o,u);if(w){const D=1<<u.z,V=qa(p.center.lng),G=ya(p.center.lat),X=(u.x+.5)/D-V;let J=0;X>.5?J=-1:X<-.5&&(J=1);let Q=(i/Ai+u.x)/D+J,ae=(o/Ai+u.y)/D;Q=(Q-V)*p._pixelsPerMercatorPixel+V,ae=(ae-G)*p._pixelsPerMercatorPixel+G;const _e=[Q*p.worldSize,ae*p.worldSize,0];Es(_e,_e,w),P=Ha(P,_e,M)}return Es(P,P,x)}_makeGlobeTileDebugBorderBuffer(i,o,u,p,x,w){const M=new Wt,P=new _o,D=new pt,V=(X,J,Q,ae,_e)=>{const Pe=(Q-X)/(_e-1),je=(ae-J)/(_e-1),Le=M.length;for(let Ve=0;Ve<_e;Ve++){const He=X+Ve*Pe,$e=J+Ve*je;M.emplaceBack(He,$e);const bt=this._globePoint(He,$e,o,u,p,x,w);D.emplaceBack(bt[0],bt[1],bt[2]),P.emplaceBack(Le+Ve)}},G=Ai;V(0,0,G,0,16),V(G,0,G,G,16),V(G,G,0,G,16),V(0,G,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(P),this._tileDebugBuffer=i.createVertexBuffer(M,ga.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(D,nx.members),this._tileDebugSegments=zs.simpleSegment(0,0,M.length,P.length)}_makeGlobeTileDebugTextBuffer(i,o,u,p,x,w){const M=Ai/4,P=new Wt,D=new Ci,V=new pt,G=25;D.reserve(32),P.reserve(G),V.reserve(G);const X=(J,Q)=>G*J+Q;for(let J=0;J<G;J++){const Q=J*M;for(let ae=0;ae<G;ae++){const _e=ae*M;P.emplaceBack(_e,Q);const Pe=this._globePoint(_e,Q,o,u,p,x,w);V.emplaceBack(Pe[0],Pe[1],Pe[2])}}for(let J=0;J<4;J++)for(let Q=0;Q<4;Q++){const ae=X(J,Q),_e=X(J,Q+1),Pe=X(J+1,Q),je=X(J+1,Q+1);D.emplaceBack(ae,_e,Pe),D.emplaceBack(Pe,_e,je)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(D),this._tileDebugTextBuffer=i.createVertexBuffer(P,ga.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(V,nx.members),this._tileDebugTextSegments=zs.simpleSegment(0,0,G,32)}}class pO{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,o,u){const p=String(o);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][p]=this.stateChanges[i][p]||{},Hi(this.stateChanges[i][p],u),this.deletedStates[i]===null){this.deletedStates[i]={};for(const x in this.state[i])x!==p&&(this.deletedStates[i][x]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][p]===null){this.deletedStates[i][p]={};for(const x in this.state[i][p])u[x]||(this.deletedStates[i][p][x]=null)}else for(const x in u)this.deletedStates[i]&&this.deletedStates[i][p]&&this.deletedStates[i][p][x]===null&&delete this.deletedStates[i][p][x]}removeFeatureState(i,o,u){if(this.deletedStates[i]===null)return;const p=String(o);if(this.deletedStates[i]=this.deletedStates[i]||{},u&&o!==void 0)this.deletedStates[i][p]!==null&&(this.deletedStates[i][p]=this.deletedStates[i][p]||{},this.deletedStates[i][p][u]=null);else if(o!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][p])for(u in this.deletedStates[i][p]={},this.stateChanges[i][p])this.deletedStates[i][p][u]=null;else this.deletedStates[i][p]=null;else this.deletedStates[i]=null}getState(i,o){const u=String(o),p=Hi({},(this.state[i]||{})[u],(this.stateChanges[i]||{})[u]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const x=this.deletedStates[i][o];if(x===null)return{};for(const w in x)delete p[w]}return p}initializeTileState(i,o){i.setFeatureState(this.state,o)}coalesceChanges(i,o){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const x={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),Hi(this.state[p][w],this.stateChanges[p][w]),x[w]=this.state[p][w];u[p]=x}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const x={};if(this.deletedStates[p]===null)for(const w in this.state[p])x[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else if(this.state[p][w])for(const M of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][M];x[w]=this.state[p][w]}u[p]=u[p]||{},Hi(u[p],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in i)i[p].setFeatureState(u,o)}}class FE{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,o){const u=this.toIdx(i,o);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(i,o){return this.leaves[this.toIdx(i,o)]}toIdx(i,o){return o*this.size+i}}function NE(s,i,o,u){let p=0,x=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(u[w])<1e-15){if(o[w]<s[w]||o[w]>i[w])return null}else{const M=1/u[w];let P=(s[w]-o[w])*M,D=(i[w]-o[w])*M;if(P>D){const V=P;P=D,D=V}if(P>p&&(p=P),D<x&&(x=D),p>x)return null}return p}function UE(s,i,o,u,p,x,w,M,P,D,V){const G=u-s,X=p-i,J=x-o,Q=w-s,ae=M-i,_e=P-o,Pe=V[1]*_e-V[2]*ae,je=V[2]*Q-V[0]*_e,Le=V[0]*ae-V[1]*Q,Ve=G*Pe+X*je+J*Le;if(Math.abs(Ve)<1e-15)return null;const He=1/Ve,$e=D[0]-s,bt=D[1]-i,gt=D[2]-o,It=($e*Pe+bt*je+gt*Le)*He;if(It<0||It>1)return null;const Qt=bt*J-gt*X,Et=gt*G-$e*J,Nt=$e*X-bt*G,Ut=(V[0]*Qt+V[1]*Et+V[2]*Nt)*He;return Ut<0||It+Ut>1?null:(Q*Qt+ae*Et+_e*Nt)*He}function VE(s,i,o){return(s-i)/(o-i)}function jE(s,i,o,u,p,x,w,M,P){const D=1<<o,V=x-u,G=w-p,X=(s+1)/D*V+u,J=(i+0)/D*G+p,Q=(i+1)/D*G+p;M[0]=(s+0)/D*V+u,M[1]=J,P[0]=X,P[1]=Q}class $E{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(x){const w=Math.ceil(Math.log2(x.dim/8)),M=[];let P=Math.ceil(Math.pow(2,w));const D=1/P,V=(J,Q,ae,_e,Pe)=>{const je=_e?1:0,Le=(J+1)*ae-je,Ve=Q*ae,He=(Q+1)*ae-je;Pe[0]=J*ae,Pe[1]=Ve,Pe[2]=Le,Pe[3]=He};let G=new FE(P);const X=[];for(let J=0;J<P*P;J++){V(J%P,Math.floor(J/P),D,!1,X);const Q=dd(X[0],X[1],x),ae=dd(X[2],X[1],x),_e=dd(X[2],X[3],x),Pe=dd(X[0],X[3],x);G.minimums.push(Math.min(Q,ae,_e,Pe)),G.maximums.push(Math.max(Q,ae,_e,Pe)),G.leaves.push(1)}for(M.push(G),P/=2;P>=1;P/=2){const J=M[M.length-1];G=new FE(P);for(let Q=0;Q<P*P;Q++){V(Q%P,Math.floor(Q/P),2,!0,X);const ae=J.getElevation(X[0],X[1]),_e=J.getElevation(X[2],X[1]),Pe=J.getElevation(X[2],X[3]),je=J.getElevation(X[0],X[3]),Le=J.isLeaf(X[0],X[1]),Ve=J.isLeaf(X[2],X[1]),He=J.isLeaf(X[2],X[3]),$e=J.isLeaf(X[0],X[3]),bt=Math.min(ae.min,_e.min,Pe.min,je.min),gt=Math.max(ae.max,_e.max,Pe.max,je.max),It=Le&&Ve&&He&&$e;G.maximums.push(gt),G.minimums.push(bt),G.leaves.push(gt-bt<=5&&It?1:0)}M.push(G)}return M}(this.dem),u=o.length-1,p=o[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(o,0,0,u,0)}raycastRoot(i,o,u,p,x,w,M=1){return NE([i,o,-100],[u,p,this.maximums[0]*M],x,w)}raycast(i,o,u,p,x,w,M=1){if(!this.nodeCount)return null;const P=this.raycastRoot(i,o,u,p,x,w,M);if(P==null)return null;const D=[],V=[],G=[],X=[],J=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;J.length>0;){const{idx:Q,t:ae,nodex:_e,nodey:Pe,depth:je}=J.pop();if(this.leaves[Q]){jE(_e,Pe,je,i,o,u,p,G,X);const Ve=1<<je,He=(_e+0)/Ve,$e=(_e+1)/Ve,bt=(Pe+0)/Ve,gt=(Pe+1)/Ve,It=dd(He,bt,this.dem)*M,Qt=dd($e,bt,this.dem)*M,Et=dd($e,gt,this.dem)*M,Nt=dd(He,gt,this.dem)*M,Ut=UE(G[0],G[1],It,X[0],G[1],Qt,X[0],X[1],Et,x,w),Gt=UE(X[0],X[1],Et,G[0],X[1],Nt,G[0],G[1],It,x,w),si=Math.min(Ut!==null?Ut:Number.MAX_VALUE,Gt!==null?Gt:Number.MAX_VALUE);if(si!==Number.MAX_VALUE)return si;{const At=kf([],x,w,ae);if(WE(It,Qt,Nt,Et,VE(At[0],G[0],X[0]),VE(At[1],G[1],X[1]))>=At[2])return ae}continue}let Le=0;for(let Ve=0;Ve<this._siblingOffset.length;Ve++){jE((_e<<1)+this._siblingOffset[Ve][0],(Pe<<1)+this._siblingOffset[Ve][1],je+1,i,o,u,p,G,X),G[2]=-100,X[2]=this.maximums[this.childOffsets[Q]+Ve]*M;const He=NE(G,X,x,w);if(He!=null){const $e=He;D[Ve]=$e;let bt=!1;for(let gt=0;gt<Le&&!bt;gt++)$e>=D[V[gt]]&&(V.splice(gt,0,Ve),bt=!0);bt||(V[Le]=Ve),Le++}}for(let Ve=0;Ve<Le;Ve++){const He=V[Ve];J.push({idx:this.childOffsets[Q]+He,t:D[He],nodex:(_e<<1)+this._siblingOffset[He][0],nodey:(Pe<<1)+this._siblingOffset[He][1],depth:je+1})}}return null}_addNode(i,o,u){return this.minimums.push(i),this.maximums.push(o),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(i,o,u,p,x){if(i[p].isLeaf(o,u)===1)return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const w=p-1,M=i[w];let P=0,D=0;for(let V=0;V<this._siblingOffset.length;V++){const G=2*o+this._siblingOffset[V][0],X=2*u+this._siblingOffset[V][1],J=M.getElevation(G,X),Q=M.isLeaf(G,X),ae=this._addNode(J.min,J.max,Q);Q&&(P|=1<<V),D||(D=ae)}for(let V=0;V<this._siblingOffset.length;V++)P&1<<V||this._construct(i,2*o+this._siblingOffset[V][0],2*u+this._siblingOffset[V][1],w,D+V)}}function WE(s,i,o,u,p,x){return _n(_n(s,o,x),_n(i,u,x),p)}function dd(s,i,o){const u=o.dim,p=ci(s*u-.5,0,u-1),x=ci(i*u-.5,0,u-1),w=Math.floor(p),M=Math.floor(x),P=Math.min(w+1,u-1),D=Math.min(M+1,u-1);return WE(o.get(w,M),o.get(P,M),o.get(w,D),o.get(P,D),p-w,x-M)}const GE={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function mO(s,i,o){return(256*s*256+256*i+o)/10-1e4}function gO(s,i,o){return 256*s+i+o/256-32768}class Kx{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,o,u,p=!1,x=!1){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Bt(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const w=this.dim=o.height-2,M=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=u||"mapbox",this.borderReady=p,!p){for(let P=0;P<w;P++)M[this._idx(-1,P)]=M[this._idx(0,P)],M[this._idx(w,P)]=M[this._idx(w-1,P)],M[this._idx(P,-1)]=M[this._idx(P,0)],M[this._idx(P,w)]=M[this._idx(P,w-1)];M[this._idx(-1,-1)]=M[this._idx(0,0)],M[this._idx(w,-1)]=M[this._idx(w-1,0)],M[this._idx(-1,w)]=M[this._idx(0,w-1)],M[this._idx(w,w)]=M[this._idx(w-1,w-1)],x&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new $E(this)}get(i,o,u=!1){u&&(i=ci(i,-1,this.dim),o=ci(o,-1,this.dim));const p=4*this._idx(i,o);return(this.encoding==="terrarium"?gO:mO)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(i){return GE[i]}get unpackVector(){return GE[this.encoding]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}static pack(i,o){const u=[0,0,0,0],p=Kx.getUnpackVector(o);let x=Math.floor((i+p[3])/p[2]);return u[2]=x%256,x=Math.floor(x/256),u[1]=x%256,x=Math.floor(x/256),u[0]=x,u}getPixels(){return new bo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,o,u){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let p=o*this.dim,x=o*this.dim+this.dim,w=u*this.dim,M=u*this.dim+this.dim;switch(o){case-1:p=x-1;break;case 1:x=p+1}switch(u){case-1:w=M-1;break;case 1:M=w+1}const P=-o*this.dim,D=-u*this.dim;for(let V=w;V<M;V++)for(let G=p;G<x;G++){const X=4*this._idx(G,V),J=4*this._idx(G+P,V+D);this.pixels[X+0]=i.pixels[J+0],this.pixels[X+1]=i.pixels[J+1],this.pixels[X+2]=i.pixels[J+2],this.pixels[X+3]=i.pixels[J+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}bi(Kx,"DEMData"),bi($E,"DemMinMaxQuadTree",{omit:["dem"]});class _O{constructor(i,o){this.max=i,this.onRemove=o,this.reset()}reset(){for(const i in this.data)for(const o of this.data[i])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(i,o,u){const p=i.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const x={value:o,timeout:void 0};if(u!==void 0&&(x.timeout=setTimeout(()=>{this.remove(i,x)},u)),this.data[p].push(x),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const o=this.data[i].shift();return o.timeout&&clearTimeout(o.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),o.value}getByKey(i){const o=this.data[i];return o?o[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,o){if(!this.has(i))return this;const u=i.wrapped().key,p=o===void 0?0:this.data[u].indexOf(o),x=this.data[u][p];return this.data[u].splice(p,1),x.timeout&&clearTimeout(x.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(x.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(i){const o=[];for(const u in this.data)for(const p of this.data[u])i(p.value)||o.push(p);for(const u of o)this.remove(u.value.tileID,u)}}class Um{constructor(i,o,u){this.func=i,this.mask=o,this.range=u}}Um.ReadOnly=!1,Um.ReadWrite=!0,Um.disabled=new Um(519,Um.ReadOnly,[0,1]);const Jb=7680;class Qb{constructor(i,o,u,p,x,w){this.test=i,this.ref=o,this.mask=u,this.fail=p,this.depthFail=x,this.pass=w}}Qb.disabled=new Qb({func:519,mask:0},0,0,Jb,Jb,Jb);class Zc{constructor(i,o,u){this.blendFunction=i,this.blendColor=o,this.mask=u}}Zc.Replace=[1,0],Zc.disabled=new Zc(Zc.Replace,Os.transparent,[!1,!1,!1,!1]),Zc.unblended=new Zc(Zc.Replace,Os.transparent,[!0,!0,!0,!0]),Zc.alphaBlended=new Zc([1,771],Os.transparent,[!0,!0,!0,!0]);const e1=1029,t1=2305;class Kl{constructor(i,o,u){this.enable=i,this.mode=o,this.frontFace=u}}Kl.disabled=new Kl(!1,e1,t1),Kl.backCCW=new Kl(!0,e1,t1),Kl.backCW=new Kl(!0,e1,2304),Kl.frontCW=new Kl(!0,1028,2304),Kl.frontCCW=new Kl(!0,1028,t1);class rp extends Yn{constructor(i,o,u){super(),this.id=i,this._onlySymbols=u,o.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new _O(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new pO,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(i){this.map=i,this._minTileCacheSize=this._minTileCacheSize===void 0&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const o=this._tiles[i];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,o){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,o)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const u=this._tiles[o];u.upload(i),u.prepare(this.map.style.imageManager)}}getIds(){return An(this._tiles).map(i=>i.tileID).sort(HE).map(i=>i.key)}getRenderableIds(i){const o=[];for(const u in this._tiles)this._isIdRenderable(+u,i)&&o.push(this._tiles[u]);return i?o.sort((u,p)=>{const x=u.tileID,w=p.tileID,M=new Ne(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),P=new Ne(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-w.overscaledZ||P.y-M.y||P.x-M.x}).map(u=>u.tileID.key):o.map(u=>u.tileID).sort(HE).map(u=>u.key)}hasRenderableParent(i){const o=this.findLoadedParent(i,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(i,o){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(o||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(+i,"reloading")}}_reloadTile(i,o){const u=this._tiles[i];u&&(u.state!=="loading"&&(u.state=o),this._loadTile(u,this._tileLoaded.bind(this,u,i,o)))}_tileLoaded(i,o,u,p){if(p)if(i.state="errored",p.status!==404)this._source.fire(new Ia(p,{tile:i}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const x=this.map.painter.terrain;this.update(this.transform,x.getScaledDemTileSize(),!0),x.resetTileLookupCache(this.id)}else this.update(this.transform);else i.timeAdded=sa.now(),u==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(o,i),this._source.type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new ra("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const o=this.getRenderableIds();for(let p=0;p<o.length;p++){const x=o[p];if(i.neighboringTiles&&i.neighboringTiles[x]){const w=this.getTileByID(x);u(i,w),u(w,i)}}function u(p,x){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let w=x.tileID.canonical.x-p.tileID.canonical.x;const M=x.tileID.canonical.y-p.tileID.canonical.y,P=Math.pow(2,p.tileID.canonical.z),D=x.tileID.key;w===0&&M===0||Math.abs(M)>1||(Math.abs(w)>1&&(Math.abs(w+P)===1?w+=P:Math.abs(w-P)===1&&(w-=P)),x.dem&&p.dem&&(p.dem.backfillBorder(x.dem,w,M),p.neighboringTiles&&p.neighboringTiles[D]&&(p.neighboringTiles[D].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,o,u,p){for(const x in this._tiles){let w=this._tiles[x];if(p[x]||!w.hasData()||w.tileID.overscaledZ<=o||w.tileID.overscaledZ>u)continue;let M=w.tileID;for(;w&&w.tileID.overscaledZ>o+1;){const D=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[D.key],w&&w.hasData()&&(M=D)}let P=M;for(;P.overscaledZ>o;)if(P=P.scaledTo(P.overscaledZ-1),i[P.key]){p[M.key]=M;break}}}findLoadedParent(i,o){if(i.key in this._loadedParentTiles){const u=this._loadedParentTiles[i.key];return u&&u.tileID.overscaledZ>=o?u:null}for(let u=i.overscaledZ-1;u>=o;u--){const p=i.scaledTo(u),x=this._getLoadedTile(p);if(x)return x}}_getLoadedTile(i){const o=this._tiles[i.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,o){o=o||this._source.tileSize;const u=Math.ceil(i.width/o)+1,p=Math.ceil(i.height/o)+1,x=Math.floor(u*p*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,x):x,M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(M)}handleWrapJump(i){const o=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,o){const u={};for(const p in this._tiles){const x=this._tiles[p];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+o),u[x.tileID.key]=x}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(i,o,u){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let p;this.updateCacheSize(i,o),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new E(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(p=i.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(M=>this._source.hasTile(M)))):p=[];const x=this._updateRetainedTiles(p);if(qE(this._source.type)&&p.length!==0){const M={},P={},D=Object.keys(x);for(const G of D){const X=x[G],J=this._tiles[G];if(!J||J.fadeEndTime&&J.fadeEndTime<=sa.now())continue;const Q=this.findLoadedParent(X,Math.max(X.overscaledZ-rp.maxOverzooming,this._source.minzoom));Q&&(this._addTile(Q.tileID),M[Q.tileID.key]=Q.tileID),P[G]=X}const V=p[p.length-1].overscaledZ;for(const G in this._tiles){const X=this._tiles[G];if(x[G]||!X.hasData())continue;let J=X.tileID;for(;J.overscaledZ>V;){J=J.scaledTo(J.overscaledZ-1);const Q=this._tiles[J.key];if(Q&&Q.hasData()&&P[J.key]){x[G]=X.tileID;break}}}for(const G in M)x[G]||(this._coveredTiles[G]=!0,x[G]=M[G])}for(const M in x)this._tiles[M].clearFadeHold();const w=function(M,P){const D=[];for(const V in M)V in P||D.push(V);return D}(this._tiles,x);for(const M of w){const P=this._tiles[M];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(+M)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const o={};if(i.length===0)return o;const u={},p=i.reduce((D,V)=>Math.min(D,V.overscaledZ),1/0),x=i[0].overscaledZ,w=Math.max(x-rp.maxOverzooming,this._source.minzoom),M=Math.max(x+rp.maxUnderzooming,this._source.minzoom),P={};for(const D of i){const V=this._addTile(D);o[D.key]=D,V.hasData()||p<this._source.maxzoom&&(P[D.key]=D)}this._retainLoadedChildren(P,p,M,o);for(const D of i){let V=this._tiles[D.key];if(V.hasData())continue;if(D.canonical.z>=this._source.maxzoom){const X=D.children(this._source.maxzoom)[0],J=this.getTile(X);if(J&&J.hasData()){o[X.key]=X;continue}}else{const X=D.children(this._source.maxzoom);if(o[X[0].key]&&o[X[1].key]&&o[X[2].key]&&o[X[3].key])continue}let G=V.wasRequested();for(let X=D.overscaledZ-1;X>=w;--X){const J=D.scaledTo(X);if(u[J.key]||(u[J.key]=!0,V=this.getTile(J),!V&&G&&(V=this._addTile(J)),V&&(o[J.key]=J,G=V.wasRequested(),V.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const o=[];let u,p=this._tiles[i].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}o.push(p.key);const x=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(x),u)break;p=x}for(const x of o)this._loadedParentTiles[x]=u}}_addTile(i){let o=this._tiles[i.key];if(o)return o;o=this._cache.getAndRemove(i),o&&(this._setTileReloadTimer(i.key,o),o.tileID=i,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,o)));const u=!!o;if(!u){const p=this.map?this.map.painter:null;o=new Kb(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(o,this._tileLoaded.bind(this,o,i.key,o.state))}return o?(o.uses++,this._tiles[i.key]=o,u||this._source.fire(new ra("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(i,o){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const u=o.getExpiryTimeout();u&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},u))}_removeTile(i){const o=this._tiles[i];o&&(o.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,o,u){const p=[],x=this.transform;if(!x)return p;const w=x.projection.name==="globe",M=qa(x.center.lng);for(const P in this._tiles){const D=this._tiles[P];if(u&&D.clearQueryDebugViz(),D.holdingForFade())continue;let V;if(w){const G=D.tileID.canonical;if(G.z===0){const X=[Math.abs(ci(M,...M_(G,-1))-M),Math.abs(ci(M,...M_(G,1))-M)];V=[0,2*X.indexOf(Math.min(...X))-1]}else{const X=[Math.abs(ci(M,...M_(G,-1))-M),Math.abs(ci(M,...M_(G,0))-M),Math.abs(ci(M,...M_(G,1))-M)];V=[X.indexOf(Math.min(...X))-1]}}else V=[0];for(const G of V){const X=i.containsTile(D,x,o,G);X&&p.push(X)}}return p}getVisibleCoordinates(i){const o=this.getRenderableIds(i).map(u=>this._tiles[u].tileID);for(const u of o)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(qE(this._source.type))for(const i in this._tiles){const o=this._tiles[i];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=sa.now())return!0}return!1}setFeatureState(i,o,u){this._state.updateState(i=i||"_geojsonTileLayer",o,u)}removeFeatureState(i,o,u){this._state.removeFeatureState(i=i||"_geojsonTileLayer",o,u)}getFeatureState(i,o){return this._state.getState(i=i||"_geojsonTileLayer",o)}setDependencies(i,o,u){const p=this._tiles[i];p&&p.setDependencies(o,u)}reloadTilesForDependencies(i,o){for(const u in this._tiles)this._tiles[u].hasDependency(i,o)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(i,o))}_preloadTiles(i,o){if(!this._sourceLoaded){const M=()=>{this._sourceLoaded&&(this._source.off("data",M),this._preloadTiles(i,o))};return void this._source.on("data",M)}const u=new Map,p=Array.isArray(i)?i:[i],x=this.map.painter.terrain,w=this.usedForTerrain&&x?x.getScaledDemTileSize():this._source.tileSize;for(const M of p){const P=M.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of P)u.set(D.key,D);this.usedForTerrain&&M.updateElevation(!1)}ji(Array.from(u.values()),(M,P)=>{const D=new Kb(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,V=>{this._source.type==="raster-dem"&&D.dem&&this._backfillDEM(D),P(V,D)})},o)}}function HE(s,i){const o=Math.abs(2*s.wrap)-+(s.wrap<0),u=Math.abs(2*i.wrap)-+(i.wrap<0);return s.overscaledZ-i.overscaledZ||u-o||i.canonical.y-s.canonical.y||i.canonical.x-s.canonical.x}function qE(s){return s==="raster"||s==="image"||s==="video"||s==="custom"}function M_(s,i){const o=1<<s.z;return[s.x/o+i,(s.x+1)/o+i]}rp.maxOverzooming=10,rp.maxUnderzooming=3;class Jx{constructor(i,o,u){this._demTile=i,this._dem=this._demTile.dem,this._scale=o,this._offset=u}static create(i,o,u){const p=u||i.findDEMTileFor(o);if(!p||!p.dem)return;const x=p.dem,w=p.tileID,M=1<<o.canonical.z-w.canonical.z;return new Jx(p,p.tileSize/Ai/M,[(o.canonical.x/M-w.canonical.x)*x.dim,(o.canonical.y/M-w.canonical.y)*x.dim])}tileCoordToPixel(i,o){const u=o*this._scale+this._offset[1],p=Math.floor(i*this._scale+this._offset[0]),x=Math.floor(u);return new Ne(p,x)}getElevationAt(i,o,u,p){const x=i*this._scale+this._offset[0],w=o*this._scale+this._offset[1],M=Math.floor(x),P=Math.floor(w),D=this._dem;return p=!!p,u?_n(_n(D.get(M,P,p),D.get(M,P+1,p),w-P),_n(D.get(M+1,P,p),D.get(M+1,P+1,p),w-P),x-M):D.get(M,P,p)}getElevationAtPixel(i,o,u){return this._dem.get(i,o,!!u)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*Xa(1,i)*this._dem.stride}}class XE{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Ul(Ai,16,0),this.featureIndexArray=new zc,this.promoteId=o}insert(i,o,u,p,x,w=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,x,w);const P=this.grid;for(let D=0;D<o.length;D++){const V=o[D],G=[1/0,1/0,-1/0,-1/0];for(let X=0;X<V.length;X++){const J=V[X];G[0]=Math.min(G[0],J.x),G[1]=Math.min(G[1],J.y),G[2]=Math.max(G[2],J.x),G[3]=Math.max(G[3],J.y)}G[0]<Ai&&G[1]<Ai&&G[2]>=0&&G[3]>=0&&P.insert(M,G[0],G[1],G[2],G[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new g_(new Bx(this.rawTileData)).layers,this.sourceLayerCoder=new DE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,o,u,p){this.loadVTLayers();const x=i.params||{},w=zu(x.filter),M=i.tileResult,P=i.transform,D=M.bufferedTilespaceBounds,V=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(Q,ae,_e,Pe)=>jf(M.bufferedTilespaceGeometry,Q,ae,_e,Pe));V.sort(yO);let G=null;P.elevation&&V.length>0&&(G=Jx.create(P.elevation,this.tileID));const X={};let J;for(let Q=0;Q<V.length;Q++){const ae=V[Q];if(ae===J)continue;J=ae;const _e=this.featureIndexArray.get(ae);let Pe=null;this.loadMatchingFeature(X,_e,w,x.layers,x.availableImages,o,u,p,(je,Le,Ve,He=0)=>(Pe||(Pe=Za(je,this.tileID.canonical,i.tileTransform)),Le.queryIntersectsFeature(M,je,Ve,Pe,this.z,i.transform,i.pixelPosMatrix,G,He)))}return X}loadMatchingFeature(i,o,u,p,x,w,M,P,D){const{featureIndex:V,bucketIndex:G,sourceLayerIndex:X,layoutVertexArrayOffset:J}=o,Q=this.bucketLayerIDs[G];if(p&&!function(je,Le){for(let Ve=0;Ve<je.length;Ve++)if(Le.indexOf(je[Ve])>=0)return!0;return!1}(p,Q))return;const ae=this.sourceLayerCoder.decode(X),_e=this.vtLayers[ae].feature(V);if(u.needGeometry){const je=Nh(_e,!0);if(!u.filter(new j(this.tileID.overscaledZ),je,this.tileID.canonical))return}else if(!u.filter(new j(this.tileID.overscaledZ),_e))return;const Pe=this.getId(_e,ae);for(let je=0;je<Q.length;je++){const Le=Q[je];if(p&&p.indexOf(Le)<0)continue;const Ve=w[Le];if(!Ve)continue;let He={};Pe!==void 0&&P&&(He=P.getState(Ve.sourceLayer||"_geojsonTileLayer",Pe));const $e=Hi({},M[Le]);$e.paint=ZE($e.paint,Ve.paint,_e,He,x),$e.layout=ZE($e.layout,Ve.layout,_e,He,x);const bt=!D||D(_e,Ve,He,J);if(!bt)continue;const gt=new OE(_e,this.z,this.x,this.y,Pe);gt.layer=$e;let It=i[Le];It===void 0&&(It=i[Le]=[]),It.push({featureIndex:V,feature:gt,intersectionZ:bt})}}lookupSymbolFeatures(i,o,u,p,x,w,M,P){const D={};this.loadVTLayers();const V=zu(x);for(const G of i)this.loadMatchingFeature(D,{bucketIndex:u,sourceLayerIndex:p,featureIndex:G,layoutVertexArrayOffset:0},V,w,M,P,o);return D}loadFeature(i){const{featureIndex:o,sourceLayerIndex:u}=i;this.loadVTLayers();const p=this.sourceLayerCoder.decode(u),x=this.vtFeatures[p];if(x[o])return x[o];const w=this.vtLayers[p].feature(o);return x[o]=w,w}hasLayer(i){for(const o of this.bucketLayerIDs)for(const u of o)if(i===u)return!0;return!1}getId(i,o){let u=i.id;if(this.promoteId){const p=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];p!=null&&(u=i.properties[p]),typeof u=="boolean"&&(u=Number(u))}return u}}function ZE(s,i,o,u,p){return ai(s,(x,w)=>{const M=i instanceof ke?i.get(w):null;return M&&M.evaluate?M.evaluate(o,u,p):M})}function yO(s,i){return i-s}bi(XE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class YE{constructor(i,o){this.width=i,this.height=o,this.nextRow=0,this.image=new Zl({width:i,height:o}),this.positions={},this.uploaded=!1}getDash(i,o){const u=this.getKey(i,o);return this.positions[u]}trim(){const i=this.width,o=this.height=Mt(this.nextRow);this.image.resize({width:i,height:o})}getKey(i,o){return i.join(",")+o}getDashRanges(i,o,u){const p=[];let x=i.length%2==1?-i[i.length-1]*u:0,w=i[0]*u,M=!0;p.push({left:x,right:w,isDash:M,zeroLength:i[0]===0});let P=i[0];for(let D=1;D<i.length;D++){M=!M;const V=i[D];x=P*u,P+=V,w=P*u,p.push({left:x,right:w,isDash:M,zeroLength:V===0})}return p}addRoundDash(i,o,u){const p=o/2;for(let x=-u;x<=u;x++){const w=this.width*(this.nextRow+u+x);let M=0,P=i[M];for(let D=0;D<this.width;D++){D/P.right>1&&(P=i[++M]);const V=Math.abs(D-P.left),G=Math.abs(D-P.right),X=Math.min(V,G);let J;const Q=x/u*(p+1);if(P.isDash){const ae=p-Math.abs(Q);J=Math.sqrt(X*X+ae*ae)}else J=p-Math.sqrt(X*X+Q*Q);this.image.data[w+D]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(i,o){for(let P=i.length-1;P>=0;--P){const D=i[P],V=i[P+1];D.zeroLength?i.splice(P,1):V&&V.isDash===D.isDash&&(V.left=D.left,i.splice(P,1))}const u=i[0],p=i[i.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const x=this.width*this.nextRow;let w=0,M=i[w];for(let P=0;P<this.width;P++){P/M.right>1&&(M=i[++w]);const D=Math.abs(P-M.left),V=Math.abs(P-M.right),G=Math.min(D,V);this.image.data[x+P]=Math.max(0,Math.min(255,(M.isDash?G:-G)+o+128))}}addDash(i,o){const u=this.getKey(i,o);if(this.positions[u])return this.positions[u];const p=o==="round",x=p?7:0,w=2*x+1;if(this.nextRow+w>this.height)return Bt("LineAtlas out of space"),null;i.length===0&&i.push(1);let M=0;for(let V=0;V<i.length;V++)i[V]<0&&(Bt("Negative value is found in line dasharray, replacing values with 0"),i[V]=0),M+=i[V];if(M!==0){const V=this.width/M,G=this.getDashRanges(i,this.width,V);p?this.addRoundDash(G,V,x):this.addRegularDash(G,o==="square"?.5*V:0)}const P=this.nextRow+x;this.nextRow+=w;const D={tl:[P,x],br:[M,0]};return this.positions[u]=D,D}}bi(YE,"LineAtlas");const KE=1*Yl;class JE{constructor(i){const o={},u=[];for(const M in i){const P=i[M],D=o[M]={};for(const V in P.glyphs){const G=P.glyphs[+V];if(!G||G.bitmap.width===0||G.bitmap.height===0)continue;const X=G.metrics.localGlyph?KE:1,J={x:0,y:0,w:G.bitmap.width+2*X,h:G.bitmap.height+2*X};u.push(J),D[V]=J}}const{w:p,h:x}=Nb(u),w=new Zl({width:p||1,height:x||1});for(const M in i){const P=i[M];for(const D in P.glyphs){const V=P.glyphs[+D];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const G=o[M][D],X=V.metrics.localGlyph?KE:1;Zl.copy(V.bitmap,w,{x:0,y:0},{x:G.x+X,y:G.y+X},V.bitmap)}}this.image=w,this.positions=o}}bi(JE,"GlyphAtlas");class xO{constructor(i){this.tileID=new E(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile,this.tileTransform=sp(i.tileID.canonical,i.projection),this.projection=i.projection}parse(i,o,u,p,x){this.status="parsing",this.data=i,this.collisionBoxArray=new Xn;const w=new DE(Object.keys(i.layers).sort()),M=new XE(this.tileID,this.promoteId);M.bucketLayerIDs=[];const P={},D=new YE(256,256),V={featureIndex:M,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:D,availableImages:u},G=o.familiesBySource[this.source];for(const He in G){const $e=i.layers[He];if(!$e)continue;let bt=!1,gt=!1;for(const Et of G[He])Et[0].type==="symbol"?bt=!0:gt=!0;if(this.isSymbolTile===!0&&!bt||this.isSymbolTile===!1&&!gt)continue;$e.version===1&&Bt(`Vector tile source "${this.source}" layer "${He}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const It=w.encode(He),Qt=[];for(let Et=0;Et<$e.length;Et++){const Nt=$e.feature(Et),Ut=M.getId(Nt,He);Qt.push({feature:Nt,id:Ut,index:Et,sourceLayerIndex:It})}for(const Et of G[He]){const Nt=Et[0];this.isSymbolTile!==void 0&&Nt.type==="symbol"!==this.isSymbolTile||Nt.minzoom&&this.zoom<Math.floor(Nt.minzoom)||Nt.maxzoom&&this.zoom>=Nt.maxzoom||Nt.visibility!=="none"&&(i1(Et,this.zoom,u),(P[Nt.id]=Nt.createBucket({index:M.bucketLayerIDs.length,layers:Et,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:It,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:u})).populate(Qt,V,this.tileID.canonical,this.tileTransform),M.bucketLayerIDs.push(Et.map(Ut=>Ut.id)))}}let X,J,Q,ae;D.trim();const _e={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Pe=()=>{if(X)return x(X);if(J&&Q&&ae){const He=new JE(J),$e=new rE(Q,ae);for(const bt in P){const gt=P[bt];gt instanceof cd?(i1(gt.layers,this.zoom,u),GD(gt,J,He.positions,Q,$e.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection)):gt.hasPattern&&(gt instanceof oe||gt instanceof Zf||gt instanceof Qf)&&(i1(gt.layers,this.zoom,u),gt.addFeatures(V,this.tileID.canonical,$e.patternPositions,u,this.tileTransform))}this.status="done",x(null,{buckets:An(P).filter(bt=>!bt.isEmpty()),featureIndex:M,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:He.image,lineAtlas:D,imageAtlas:$e,glyphMap:this.returnDependencies?J:null,iconMap:this.returnDependencies?Q:null,glyphPositions:this.returnDependencies?He.positions:null})}},je=ai(V.glyphDependencies,He=>Object.keys(He).map(Number));Object.keys(je).length?p.send("getGlyphs",{uid:this.uid,stacks:je},(He,$e)=>{X||(X=He,J=$e,Pe())},void 0,!1,_e):J={};const Le=Object.keys(V.iconDependencies);Le.length?p.send("getImages",{icons:Le,source:this.source,tileID:this.tileID,type:"icons"},(He,$e)=>{X||(X=He,Q=$e,Pe())},void 0,!1,_e):Q={};const Ve=Object.keys(V.patternDependencies);Ve.length?p.send("getImages",{icons:Ve,source:this.source,tileID:this.tileID,type:"patterns"},(He,$e)=>{X||(X=He,ae=$e,Pe())},void 0,!1,_e):ae={},Pe()}}function i1(s,i,o){const u=new j(i);for(const p of s)p.recalculate(u,o)}class QE{constructor(i){this.entries={},this.scheduler=i}request(i,o,u,p){const x=this.entries[i]=this.entries[i]||{callbacks:[]};if(x.result){const[w,M]=x.result;return this.scheduler?this.scheduler.add(()=>{p(w,M)},o):p(w,M),()=>{}}return x.callbacks.push(p),x.cancel||(x.cancel=u((w,M)=>{x.result=[w,M];for(const P of x.callbacks)this.scheduler?this.scheduler.add(()=>{P(w,M)},o):P(w,M);setTimeout(()=>delete this.entries[i],3e3)})),()=>{x.result||(x.callbacks=x.callbacks.filter(w=>w!==p),x.callbacks.length||(x.cancel(),delete this.entries[i]))}}}function eS(s,i,o){const u=JSON.stringify(s.request);return s.data&&(this.deduped.entries[u]={result:[null,s.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},p=>{const x=pr(s.request,(w,M,P,D)=>{w?p(w):M&&p(null,{vectorTile:o?void 0:new g_(new Bx(M)),rawData:M,cacheControl:P,expires:D})});return()=>{x.cancel(),p()}},i)}const tS=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class n1{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const x=tS[15&u];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(i,2,1),[M]=new Uint32Array(i,4,1);return new n1(M,w,x,i)}constructor(i,o=64,u=Float64Array,p){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const x=tS.indexOf(this.ArrayType),w=2*i*this.ArrayType.BYTES_PER_ELEMENT,M=i*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-M%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+M+P,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+w+M+P),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+M+P,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=i,this.coords[this._pos++]=o,u}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return s1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:M}=this,P=[0,x.length-1,0],D=[];for(;P.length;){const V=P.pop()||0,G=P.pop()||0,X=P.pop()||0;if(G-X<=M){for(let _e=X;_e<=G;_e++){const Pe=w[2*_e],je=w[2*_e+1];Pe>=i&&Pe<=u&&je>=o&&je<=p&&D.push(x[_e])}continue}const J=X+G>>1,Q=w[2*J],ae=w[2*J+1];Q>=i&&Q<=u&&ae>=o&&ae<=p&&D.push(x[J]),(V===0?i<=Q:o<=ae)&&(P.push(X),P.push(J-1),P.push(1-V)),(V===0?u>=Q:p>=ae)&&(P.push(J+1),P.push(G),P.push(1-V))}return D}within(i,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:x,nodeSize:w}=this,M=[0,p.length-1,0],P=[],D=u*u;for(;M.length;){const V=M.pop()||0,G=M.pop()||0,X=M.pop()||0;if(G-X<=w){for(let _e=X;_e<=G;_e++)nS(x[2*_e],x[2*_e+1],i,o)<=D&&P.push(p[_e]);continue}const J=X+G>>1,Q=x[2*J],ae=x[2*J+1];nS(Q,ae,i,o)<=D&&P.push(p[J]),(V===0?i-u<=Q:o-u<=ae)&&(M.push(X),M.push(J-1),M.push(1-V)),(V===0?i+u>=Q:o+u>=ae)&&(M.push(J+1),M.push(G),M.push(1-V))}return P}}function s1(s,i,o,u,p,x){if(p-u<=o)return;const w=u+p>>1;iS(s,i,w,u,p,x),s1(s,i,o,u,w-1,1-x),s1(s,i,o,w+1,p,1-x)}function iS(s,i,o,u,p,x){for(;p>u;){if(p-u>600){const D=p-u+1,V=o-u+1,G=Math.log(D),X=.5*Math.exp(2*G/3),J=.5*Math.sqrt(G*X*(D-X)/D)*(V-D/2<0?-1:1);iS(s,i,o,Math.max(u,Math.floor(o-V*X/D+J)),Math.min(p,Math.floor(o+(D-V)*X/D+J)),x)}const w=i[2*o+x];let M=u,P=p;for(C_(s,i,u,o),i[2*p+x]>w&&C_(s,i,u,p);M<P;){for(C_(s,i,M,P),M++,P--;i[2*M+x]<w;)M++;for(;i[2*P+x]>w;)P--}i[2*u+x]===w?C_(s,i,u,P):(P++,C_(s,i,P,p)),P<=o&&(u=P+1),o<=P&&(p=P-1)}}function C_(s,i,o,u){r1(s,o,u),r1(i,2*o,2*u),r1(i,2*o+1,2*u+1)}function r1(s,i,o){const u=s[i];s[i]=s[o],s[o]=u}function nS(s,i,o,u){const p=s-o,x=i-u;return p*p+x*x}r.ARRAY_TYPE=yo,r.AUTH_ERR_MSG=qe,r.Aabb=_r,r.Actor=class{constructor(s,i,o){this.target=s,this.parent=i,this.mapId=o,this.callbacks={},this.cancelCallbacks={},jt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=di()?s:C,this.scheduler=new dO}send(s,i,o,u,p=!1,x){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=x,this.callbacks[w]=o);const M=rt(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:s,hasCallback:!!o,targetMapId:u,mustQueue:p,sourceMapId:this.mapId,data:Vl(i,M)},M),{cancel:()=>{o&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(s){const i=s.data,o=i.id;if(o&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const u=this.cancelCallbacks[o];delete this.cancelCallbacks[o],u&&u.cancel()}else if(i.mustQueue||di()){const u=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,i),u&&u.metadata||{type:"message"})}else this.processTask(o,i)}processTask(s,i){if(i.type==="<response>"){const o=this.callbacks[s];delete this.callbacks[s],o&&(i.error?o(dl(i.error)):o(null,dl(i.data)))}else{const o=rt(this.globalScope)?void 0:[],u=i.hasCallback?(x,w)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:x?Vl(x):null,data:Vl(w,o)},o)}:x=>{},p=dl(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,p,u);else if(this.parent.getWorkerSource){const x=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,x[0],p.source)[x[1]](p,u)}else u(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.CanonicalTileID=y,r.Color=Os,r.ColorMode=Zc,r.CullFaceMode=Kl,r.DEMData=Kx,r.DataConstantProperty=re,r.DedupedRequest=QE,r.DepthMode=Um,r.EXTENT=Ai,r.Elevation=class{isDataAvailableAtPoint(s){const i=this._source();if(this.isUsingMockSource()||!i||s.y<0||s.y>1)return!1;const o=i.getSource().maxzoom,u=1<<o,p=Math.floor(s.x),x=Math.floor((s.x-p)*u),w=Math.floor(s.y*u),M=this.findDEMTileFor(new E(o,p,o,x,w));return!(!M||!M.dem)}getAtPointOrZero(s,i=0){return this.getAtPoint(s,i)||0}getAtPoint(s,i,o=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const u=this._source();if(!u||s.y<0||s.y>1)return i;const p=u.getSource().maxzoom,x=1<<p,w=Math.floor(s.x),M=s.x-w,P=new E(p,w,p,Math.floor(M*x),Math.floor(s.y*x)),D=this.findDEMTileFor(P);if(!D||!D.dem)return i;const V=D.dem,G=1<<D.tileID.canonical.z,X=(M*G-D.tileID.canonical.x)*V.dim,J=(s.y*G-D.tileID.canonical.y)*V.dim,Q=Math.floor(X),ae=Math.floor(J);return(o?this.exaggeration():1)*_n(_n(V.get(Q,ae),V.get(Q,ae+1),J-ae),_n(V.get(Q+1,ae),V.get(Q+1,ae+1),J-ae),X-Q)}getAtTileOffset(s,i,o){const u=1<<s.canonical.z;return this.getAtPointOrZero(new Ku(s.wrap+(s.canonical.x+i/Ai)/u,(s.canonical.y+o/Ai)/u))}getAtTileOffsetFunc(s,i,o,u){return p=>{const x=this.getAtTileOffset(s,p.x,p.y),w=u.upVector(s.canonical,p.x,p.y);return xo(w,w,x*u.upVectorScale(s.canonical,i,o).metersToTile),w}}getForTilePoints(s,i,o,u){if(this.isUsingMockSource())return!1;const p=Jx.create(this,s,u);return!!p&&(i.forEach(x=>{x[2]=this.exaggeration()*p.getElevationAt(x[0],x[1],o)}),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(s);if(!i||!i.dem)return null;const o=i.dem.tree,u=i.tileID,p=1<<s.canonical.z-u.canonical.z;let x=s.canonical.x/p-u.canonical.x,w=s.canonical.y/p-u.canonical.y,M=0;for(let P=0;P<s.canonical.z-u.canonical.z&&!o.leaves[M];P++){x*=2,w*=2;const D=2*Math.floor(w)+Math.floor(x);M=o.childOffsets[M]+D,x%=1,w%=1}return{min:this.exaggeration()*o.minimums[M],max:this.exaggeration()*o.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},r.ErrorEvent=Ia,r.EvaluationParameters=j,r.Event=ra,r.Evented=Yn,r.FillExtrusionBucket=Qf,r.Frustum=ml,r.FrustumCorners=Zg,r.GLOBE_RADIUS=gl,r.GLOBE_SCALE_MATCH_LATITUDE=45,r.GLOBE_ZOOM_THRESHOLD_MAX=gm,r.GLOBE_ZOOM_THRESHOLD_MIN=Lf,r.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_fillGridMeshWithLods(s,i){const o=new Wt,u=new Ci,p=[],x=s+1+2,w=i[0]+1,M=i[0]+1+(1+i.length),P=(D,V,G)=>{let X=D===x-1?D-2:D===0?D:D-1;return X+=G?24575:0,[X,V]};for(let D=0;D<x;++D)o.emplaceBack(...P(D,0,!0));for(let D=0;D<w;++D)for(let V=0;V<x;++V)o.emplaceBack(...P(V,D,(V===0||V===x-1)&&!0));for(let D=0;D<i.length;++D){const V=i[D];for(let G=0;G<x;++G)o.emplaceBack(...P(G,V,!0))}for(let D=0;D<i.length;++D){const V=u.length,G=i[D]+1+2,X=new Ci;for(let ae=0;ae<G-1;ae++){const _e=ae===G-2,Pe=_e?x*(M-i.length+D-ae):x;for(let je=0;je<x-1;je++){const Le=ae*x+je;ae===0||_e||je===0||je===x-2?(X.emplaceBack(Le+1,Le,Le+Pe),X.emplaceBack(Le+Pe,Le+Pe+1,Le+1)):(u.emplaceBack(Le+1,Le,Le+Pe),u.emplaceBack(Le+Pe,Le+Pe+1,Le+1))}}const J=zs.simpleSegment(0,V,o.length,u.length-V);for(let ae=0;ae<X.uint16.length;ae+=3)u.emplaceBack(X.uint16[ae],X.uint16[ae+1],X.uint16[ae+2]);const Q=zs.simpleSegment(0,V,o.length,u.length-V);p.push({withoutSkirts:J,withSkirts:Q})}return{vertices:o,indices:u,segments:p}}_createGrid(s){const i=this._fillGridMeshWithLods(Vc,Df);this._gridSegments=i.segments,this._gridBuffer=s.createVertexBuffer(i.vertices,ga.members),this._gridIndexBuffer=s.createIndexBuffer(i.indices,!0)}_createPoles(s){const i=new Ci;for(let p=0;p<=Vc;p++)i.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=s.createIndexBuffer(i,!0);const o=new jn,u=new jn;this._poleSegments=[];for(let p=0,x=0;p<Lf;p++){const w=360/(1<<p);o.emplaceBack(0,-gl,0,.5,0),u.emplaceBack(0,-gl,0,.5,1);for(let M=0;M<=Vc;M++){const P=M/Vc,D=_n(0,w,P),[V,G,X]=Bh(db,fb,D,gl);o.emplaceBack(V,G,X,P,0),u.emplaceBack(V,G,X,P,1)}this._poleSegments.push(zs.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(o,ix,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(u,ix,!1)}getGridBuffers(s,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,i){if(!this._wireframeSegments){const o=new ur,u=Vc,p=u+1+2,x=1;this._wireframeSegments=[];for(let w=0,M=0;w<Df.length;w++){const P=Df[w];for(let V=x;V<P+x;V++)for(let G=x;G<u+x;G++){const X=V*p+G;o.emplaceBack(X,X+1),o.emplaceBack(X,X+p),o.emplaceBack(X,X+p+1)}const D=P*u*3;this._wireframeSegments.push(zs.simpleSegment(0,M,(P+1)*p,D)),M+=D}this._wireframeIndexBuffer=s.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[i]]}},r.GlyphManager=zm,r.ImagePosition=Ub,r.KDBush=n1,r.LivePerformanceUtils=Bp,r.LngLat=$n,r.LngLatBounds=gr,r.LocalGlyphMode=$b,r.MAX_MERCATOR_LATITUDE=qo,r.MercatorCoordinate=Ku,r.ONE_EM=$t,r.OverscaledTileID=E,r.PerformanceMarkers=Ds,r.Point=Ne,r.Properties=Re,r.RGBAImage=bo,r.Ray=Xg,r.RequestManager=class{constructor(s,i,o){this._transformRequestFn=s,this._customAccessToken=i,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const s=function(){let i="";for(let o=0;o<10;o++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",se,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeStyleURL(s,i){if(!Je(s))return s;const o=hi(s);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeGlyphsURL(s,i){if(!Je(s))return s;const o=hi(s);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeSourceURL(s,i,o,u){if(!Je(s))return s;const p=hi(s);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),o&&p.params.push(`language=${o}`),u&&p.params.push(`worldview=${u}`),this._makeAPIURL(p,this._customAccessToken||i)}normalizeSpriteURL(s,i,o,u){const p=hi(s);return Je(s)?(p.path=`/styles/v1${p.path}/sprite${i}${o}`,this._makeAPIURL(p,this._customAccessToken||u)):(p.path+=`${i}${o}`,Kt(p))}normalizeTileURL(s,i,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Je(s))return s;const u=hi(s);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||o&&u.authority!=="raster"&&o===512?"@2x":""}${q.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${$.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${$.TILE_URL_VERSION}${u.path}`);const p=this._customAccessToken||function(x){for(const w of x){const M=w.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(u.params)||$.ACCESS_TOKEN;return $.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,p)}canonicalizeTileURL(s,i){const o=hi(s);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return s;let u="mapbox://";o.path.match(/^\/raster\/v1\//)?u+=`raster/${o.path.replace(`/${$.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${o.path.replace(`/${$.TILE_URL_VERSION}/`,"")}`;let p=o.params;return i&&(p=p.filter(x=>!x.match(/^access_token=/))),p.length&&(u+=`?${p.join("&")}`),u}canonicalizeTileset(s,i){const o=!!i&&Je(i),u=[];for(const p of s.tiles||[])ft(p)?u.push(this.canonicalizeTileURL(p,o)):u.push(p);return u}_makeAPIURL(s,i){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=hi($.API_URL);if(s.protocol=u.protocol,s.authority=u.authority,s.protocol==="http"){const p=s.params.indexOf("secure");p>=0&&s.params.splice(p,1)}if(u.path!=="/"&&(s.path=`${u.path}${s.path}`),!$.REQUIRE_ACCESS_TOKEN)return Kt(s);if(i=i||$.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(i[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return s.params=s.params.filter(p=>p.indexOf("access_token")===-1),s.params.push(`access_token=${i||""}`),Kt(s)}},r.ResourceType=vr,r.SegmentVector=zs,r.SourceCache=rp,r.StencilMode=Qb,r.StructArrayLayout1ui2=_o,r.StructArrayLayout2f1f2i16=Li,r.StructArrayLayout2i4=Wt,r.StructArrayLayout2ui4=ur,r.StructArrayLayout3f12=Yi,r.StructArrayLayout3ui6=Ci,r.StructArrayLayout4i8=Lt,r.StructArrayLayout5f20=jn,r.Texture=S_,r.Tile=Kb,r.Transitionable=ne,r.Uniform1f=Js,r.Uniform1i=class extends fl{constructor(s){super(s),this.current=0}set(s,i,o){this.fetchUniformLocation(s,i)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},r.Uniform2f=class extends fl{constructor(s){super(s),this.current=[0,0]}set(s,i,o){this.fetchUniformLocation(s,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}},r.Uniform3f=class extends fl{constructor(s){super(s),this.current=[0,0,0]}set(s,i,o){this.fetchUniformLocation(s,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}},r.Uniform4f=Xy,r.UniformColor=Gu,r.UniformMatrix2f=class extends fl{constructor(s){super(s),this.current=sb}set(s,i,o){if(this.fetchUniformLocation(s,i)){for(let u=0;u<4;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}},r.UniformMatrix3f=class extends fl{constructor(s){super(s),this.current=Rs}set(s,i,o){if(this.fetchUniformLocation(s,i)){for(let u=0;u<9;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},r.UniformMatrix4f=class extends fl{constructor(s){super(s),this.current=Gg}set(s,i,o){if(this.fetchUniformLocation(s,i)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let u=1;u<16;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}},r.UnwrappedTileID=T,r.ValidationError=yi,r.VectorTileFeature=Yf,r.VectorTileWorkerSource=class extends Yn{constructor(s,i,o,u,p){super(),this.actor=s,this.layerIndex=i,this.availableImages=o,this.loadVectorData=p||eS,this.loading={},this.loaded={},this.deduped=new QE(s.scheduler),this.isSpriteLoaded=u,this.scheduler=s.scheduler}loadTile(s,i){const o=s.uid,u=s&&s.request,p=u&&u.collectResourceTiming,x=this.loading[o]=new xO(s);x.abort=this.loadVectorData(s,(w,M)=>{const P=!this.loading[o];if(delete this.loading[o],P||w||!M)return x.status="done",P||(this.loaded[o]=x),i(w);const D=M.rawData,V={};M.expires&&(V.expires=M.expires),M.cacheControl&&(V.cacheControl=M.cacheControl),x.vectorTile=M.vectorTile||new g_(new Bx(D));const G=()=>{x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,(X,J)=>{if(X||!J)return i(X);const Q={};if(p){const ae=jd(u);ae.length>0&&(Q.resourceTiming=JSON.parse(JSON.stringify(ae)))}i(null,Hi({rawTileData:D.slice(0)},J,V,Q))})};this.isSpriteLoaded?G():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(G,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):G()}),this.loaded=this.loaded||{},this.loaded[o]=x})}reloadTile(s,i){const o=this.loaded,u=s.uid,p=this;if(o&&o[u]){const x=o[u];x.showCollisionBoxes=s.showCollisionBoxes,x.enableTerrain=!!s.enableTerrain,x.projection=s.projection,x.tileTransform=sp(s.tileID.canonical,s.projection);const w=(M,P)=>{const D=x.reloadCallback;D&&(delete x.reloadCallback,x.parse(x.vectorTile,p.layerIndex,this.availableImages,p.actor,D)),i(M,P)};x.status==="parsing"?x.reloadCallback=w:x.status==="done"&&(x.vectorTile?x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(s,i){const o=s.uid,u=this.loading[o];u&&(u.abort&&u.abort(),delete this.loading[o]),i()}removeTile(s,i){const o=this.loaded,u=s.uid;o&&o[u]&&delete o[u],i()}},r.WritingMode=Ka,r.ZoomDependentExpression=Fl,r.add=Ga,r.addDynamicAttributes=Xx,r.adjoint=function(s,i){var o=i[0],u=i[1],p=i[2],x=i[3],w=i[4],M=i[5],P=i[6],D=i[7],V=i[8];return s[0]=w*V-M*D,s[1]=p*D-u*V,s[2]=u*M-p*w,s[3]=M*P-x*V,s[4]=o*V-p*P,s[5]=p*x-o*M,s[6]=x*D-w*P,s[7]=u*P-o*D,s[8]=o*w-u*x,s},r.asyncAll=ji,r.bezier=Pt,r.bindAll=jt,r.boundsAttributes=zE,r.bufferConvexPolygon=function(s,i){const o=[];for(let u=0;u<s.length;u++){const p=Ni(u-1,-1,s.length-1),x=Ni(u+1,-1,s.length-1),w=s[u],M=s[x],P=s[p].sub(w).unit(),D=M.sub(w).unit(),V=D.angleWithSep(P.x,P.y),G=P.add(D).unit().mult(-1*i/Math.sin(V/2));o.push(w.add(G))}return o},r.cacheEntryPossiblyAdded=function(s){un++,un>zt&&(s.getActor().send("enforceCacheSizeLimit",mt),un=0)},r.calculateGlobeLabelMatrix=function(s,i){const{x:o,y:u}=s.point,p=lx(o,u,s.worldSize/s._pixelsPerMercatorPixel,0,0);return ql(p,p,Kg(_a(i)))},r.calculateGlobeMatrix=function(s){const{x:i,y:o}=s.point,{lng:u,lat:p}=s._center;return lx(i,o,s.worldSize,u,p)},r.calculateGlobeMercatorMatrix=function(s){const i=s.pixelsPerMeter,o=i/Xa(1,s.center.lat),u=$o(new Float64Array(16));return Mf(u,u,[s.point.x,s.point.y,0]),Xl(u,u,[o,o,i]),Float32Array.from(u)},r.circumferenceAtLatitude=Qg,r.clamp=ci,r.clearTileCache=function(s){if(!Kn())return;const i=C.caches.delete(ti);s&&i.catch(s).then(()=>s())},r.clipLine=yE,r.clone=function(s){var i=new yo(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},r.clone$1=Ce,r.collisionCircleLayout=li,r.config=$,r.conjugate=function(s,i){return s[0]=-i[0],s[1]=-i[1],s[2]=-i[2],s[3]=i[3],s},r.create=function(){var s=new yo(16);return yo!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},r.create$1=Yy,r.createExpression=Ic,r.createLayout=ot,r.createStyleLayer=function(s){return s.type==="custom"?new lO(s):new hO[s.type](s)},r.cross=pl,r.degToRad=Xe,r.distance=function(s,i){return Math.hypot(i[0]-s[0],i[1]-s[1],i[2]-s[2])},r.div=function(s,i,o){return s[0]=i[0]/o[0],s[1]=i[1]/o[1],s[2]=i[2]/o[2],s},r.dot=vo,r.earthRadius=Bf,r.ease=oi,r.easeCubicInOut=St,r.ecefToLatLng=function([s,i,o]){const u=Math.hypot(s,i,o),p=Math.atan2(s,o),x=.5*Math.PI-Math.acos(-i/u);return new $n(Tt(p),Tt(x))},r.emitValidationErrors=tm,r.endsWith=ki,r.enforceCacheSizeLimit=function(s){qn(),Ii&&Ii.then(i=>{i.keys().then(o=>{for(let u=0;u<o.length-s;u++)i.delete(o[u])})})},r.evaluateSizeForFeature=Wi,r.evaluateSizeForZoom=Ti,r.evaluateVariableOffset=TE,r.evented=S,r.exactEquals=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]&&s[3]===i[3]},r.exactEquals$1=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]},r.exported=sa,r.exported$1=q,r.extend=Hi,r.extend$1=oa,r.fillExtrusionHeightLift=zx,r.filterObject=Ee,r.fromMat4=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[4],s[4]=i[5],s[5]=i[6],s[6]=i[8],s[7]=i[9],s[8]=i[10],s},r.fromQuat=function(s,i){var o=i[0],u=i[1],p=i[2],x=i[3],w=o+o,M=u+u,P=p+p,D=o*w,V=u*w,G=u*M,X=p*w,J=p*M,Q=p*P,ae=x*w,_e=x*M,Pe=x*P;return s[0]=1-G-Q,s[1]=V+Pe,s[2]=X-_e,s[3]=0,s[4]=V-Pe,s[5]=1-D-Q,s[6]=J+ae,s[7]=0,s[8]=X+_e,s[9]=J-ae,s[10]=1-D-G,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},r.fromRotation=function(s,i){var o=Math.sin(i),u=Math.cos(i);return s[0]=u,s[1]=o,s[2]=0,s[3]=-o,s[4]=u,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},r.fromScaling=Hg,r.furthestTileCorner=function(s){const i=Math.round((s+45+360)%360/90)%4;return Rt[i]},r.getAABBPointSquareDist=function(s,i,o){let u=0;for(let p=0;p<2;++p){const x=o?o[p]:0;s[p]>x&&(u+=(s[p]-x)*(s[p]-x)),i[p]<x&&(u+=(x-i[p])*(x-i[p]))}return u},r.getAnchorAlignment=jb,r.getAnchorJustification=Gb,r.getBounds=function(s){let i=1/0,o=1/0,u=-1/0,p=-1/0;for(const x of s)i=Math.min(i,x.x),o=Math.min(o,x.y),u=Math.max(u,x.x),p=Math.max(p,x.y);return{min:new Ne(i,o),max:new Ne(u,p)}},r.getColumn=Yt,r.getDefaultExportFromCjs=he,r.getGridMatrix=function(s,i,o,u){const p=i.getNorth(),x=i.getSouth(),w=i.getWest(),M=i.getEast(),P=1<<s.z,D=M-w,V=p-x,G=D/Vc,X=-V/Df[o],J=[0,G,0,X,0,0,p,w,0];if(s.z>0){const Q=180/u;Ky(J,J,[Q/D+1,0,0,0,Q/V+1,0,-.5*Q/G,.5*Q/X,1])}return J[2]=P,J[5]=s.x,J[8]=s.y,J},r.getImage=Be,r.getJSON=function(s,i){return or(Hi(s,{type:"json"}),i)},r.getLatitudinalLod=function(s){const i=qo-5;s=ci(s,-80.051129,i)/i*90;const o=Math.pow(Math.abs(Math.sin(Xe(s))),3);return Math.round(o*(Df.length-1))},r.getMapSessionAPI=Ks,r.getPerformanceMeasurement=jd,r.getProjection=PE,r.getRTLTextPluginStatus=A,r.getReferrer=js,r.getTilePoint=function(s,{x:i,y:o},u=0){return new Ne(((i-u)*s.scale-s.x)*Ai,(o*s.scale-s.y)*Ai)},r.getTileVec3=function(s,i,o=0){return Uc(((i.x-o)*s.scale-s.x)*Ai,(i.y*s.scale-s.y)*Ai,Ff(i.z,i.y))},r.getVideo=function(s,i){const o=C.document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let u=0;u<s.length;u++){const p=C.document.createElement("source");fc(s[u])||(o.crossOrigin="Anonymous"),p.src=s[u],o.appendChild(p)}return{cancel:()=>{}}},r.globeCenterToScreenPoint=function(s){const i=[0,0,0],o=$o(new Float64Array(16));return ql(o,s.pixelMatrix,s.globeMatrix),Es(i,i,o),new Ne(i[0],i[1])},r.globeDenormalizeECEF=Kg,r.globeECEFOrigin=function(s,i){const o=[0,0,0];return Es(o,o,Fh(_a(i.canonical))),Es(o,o,s),o},r.globeMetersToEcef=_m,r.globeNormalizeECEF=Fh,r.globePixelsToTileUnits=function(s,i){return Ai/(512*Math.pow(2,s))*Zu(_a(i))},r.globePoleMatrixForTile=function(s,i,o){const u=$o(new Float64Array(16)),p=(i/(1<<s)-.5)*Math.PI*2;return hm(u,o.globeMatrix,p),Float32Array.from(u)},r.globeTileBounds=_a,r.globeTiltAtLngLat=cx,r.globeToMercatorTransition=Yu,r.globeUseCustomAntiAliasing=function(s,i,o){const u=Yu(o.zoom),p=s.style.map._antialias,x=!!i.extStandardDerivatives,w=i.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return u===0&&!p&&!w&&x},r.identity=$o,r.identity$1=Ar,r.invert=cm,r.isFullscreen=function(){return!!C.document.fullscreenElement||!!C.document.webkitFullscreenElement},r.isLngLatBehindGlobe=Jg,r.isMapAuthenticated=function(s){return br.has(s)},r.isMapboxURL=Je,r.isSafariWithAntialiasingBug=function(s){const i=s.navigator?s.navigator.userAgent:null;return!!rt(s)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.latFromMercatorY=kr,r.latLngToECEF=Xu,r.len=qu,r.length=Hu,r.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},r.lngFromMercatorX=Ho,r.loadVectorTile=eS,r.makeRequest=or,r.mapValue=function(s,i,o,u,p){return ci((s-i)/(o-i)*(p-u)+u,u,p)},r.mercatorScale=e_,r.mercatorXfromLng=qa,r.mercatorYfromLat=ya,r.mercatorZfromAltitude=Xa,r.mul=Af,r.mul$1=cb,r.multiply=ql,r.multiply$1=Ky,r.multiply$2=fm,r.nextPowerOfTwo=Mt,r.normalize=Xr,r.normalize$1=tx,r.normalize$2=Pf,r.number=_n,r.ortho=function(s,i,o,u,p,x,w){var M=1/(i-o),P=1/(u-p),D=1/(x-w);return s[0]=-2*M,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*P,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*D,s[11]=0,s[12]=(i+o)*M,s[13]=(p+u)*P,s[14]=(w+x)*D,s[15]=1,s},r.pbf=vn,r.perspective=function(s,i,o,u,p){var x,w=1/Math.tan(i/2);return s[0]=w/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=w,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p!=null&&p!==1/0?(s[10]=(p+u)*(x=1/(u-p)),s[14]=2*p*u*x):(s[10]=-1,s[14]=-2*u),s},r.pick=function(s,i){const o={};for(let u=0;u<i.length;u++){const p=i[u];p in s&&(o[p]=s[p])}return o},r.plugin=z,r.pointGeometry=ve,r.polesInViewport=function(s){const i=$o(new Float64Array(16));ql(i,s.pixelMatrix,s.globeMatrix);const o=[0,Go,0],u=[0,Yr,0];return Es(o,o,i),Es(u,u,i),[o[0]>0&&o[0]<=s.width&&o[1]>0&&o[1]<=s.height&&!Jg(s,new $n(s.center.lat,90)),u[0]>0&&u[0]<=s.width&&u[1]>0&&u[1]<=s.height&&!Jg(s,new $n(s.center.lat,-90))]},r.polygonContainsPoint=_l,r.polygonIntersectsBox=jf,r.polygonIntersectsPolygon=Uf,r.polygonizeBounds=function(s,i,o=0,u=!0){const p=new Ne(o,o),x=s.sub(p),w=i.add(p),M=[x,new Ne(w.x,x.y),w,new Ne(x.x,w.y)];return u&&M.push(x.clone()),M},r.posAttributes=ga,r.postMapLoadEvent=Cs,r.postPerformanceEvent=Ys,r.postTurnstileEvent=mn,r.potpack=Nb,r.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},r.radToDeg=Tt,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.registerForPluginStateChange=function(s){return s({pluginStatus:_,pluginURL:a}),S.on("pluginStateChange",s),s},r.removeAuthState=function(s){br.delete(s)},r.renderColorRamp=s_,r.resample=ym,r.rotateX=Cf,r.rotateX$1=ex,r.rotateY=hm,r.rotateY$1=qg,r.rotateZ=function(s,i,o){var u=Math.sin(o),p=Math.cos(o),x=i[0],w=i[1],M=i[2],P=i[3],D=i[4],V=i[5],G=i[6],X=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=x*p+D*u,s[1]=w*p+V*u,s[2]=M*p+G*u,s[3]=P*p+X*u,s[4]=D*p-x*u,s[5]=V*p-w*u,s[6]=G*p-M*u,s[7]=X*p-P*u,s},r.rotateZ$1=function(s,i,o){o*=.5;var u=i[0],p=i[1],x=i[2],w=i[3],M=Math.sin(o),P=Math.cos(o);return s[0]=u*P+p*M,s[1]=p*P-u*M,s[2]=x*P+w*M,s[3]=w*P-x*M,s},r.scale=Xl,r.scale$1=Qy,r.scale$2=xo,r.scaleAndAdd=kf,r.set=function(s,i,o,u){return s[0]=i,s[1]=o,s[2]=u,s},r.setCacheLimits=function(s,i){mt=s,zt=i},r.setColumn=function(s,i,o){s[4*i+0]=o[0],s[4*i+1]=o[1],s[4*i+2]=o[2],s[4*i+3]=o[3]},r.setRTLTextPlugin=function(s,i,o=!1){if(_===Oh||_===ju||_===wf)throw new Error("setRTLTextPlugin cannot be called multiple times.");a=sa.resolveURL(s),_=Oh,Rc=i,v(),o||R()},r.smoothstep=pn,r.spec=Ct,r.squaredLength=function(s){var i=s[0],o=s[1],u=s[2];return i*i+o*o+u*u},r.storeAuthState=function(s,i){i?br.add(s):br.delete(s)},r.sub=Wo,r.subtract=dm,r.symbolSize=Gi,r.tileAABB=function(s,i,o,u,p,x,w,M,P){if(P.name==="globe")return ub(s,i,new y(o,u,p));const D=sp({z:o,x:u,y:p},P);return new _r([(x+D.x/D.scale)*i,i*(D.y/D.scale),w],[(x+D.x2/D.scale)*i,i*(D.y2/D.scale),M])},r.tileCornersToBounds=Rf,r.tileTransform=sp,r.transformMat3=function(s,i,o){var u=i[0],p=i[1],x=i[2];return s[0]=u*o[0]+p*o[3]+x*o[6],s[1]=u*o[1]+p*o[4]+x*o[7],s[2]=u*o[2]+p*o[5]+x*o[8],s},r.transformMat4=Es,r.transformMat4$1=Zr,r.transformQuat=In,r.transitionTileAABBinECEF=Yg,r.translate=Mf,r.transpose=function(s,i){if(s===i){var o=i[1],u=i[2],p=i[5];s[1]=i[3],s[2]=i[6],s[3]=o,s[5]=i[7],s[6]=u,s[7]=p}else s[0]=i[0],s[1]=i[3],s[2]=i[6],s[3]=i[1],s[4]=i[4],s[5]=i[7],s[6]=i[2],s[7]=i[5],s[8]=i[8];return s},r.triggerPluginCompletionEvent=f,r.uniqueId=wn,r.updateGlobeVertexNormal=function(s,i,o,u,p){const x=5*i+2;s.float32[x+0]=o,s.float32[x+1]=u,s.float32[x+2]=p},r.validateCustomStyleLayer=function(s){const i=[],o=s.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},r.validateFilter=s=>go(Ph(s)),r.validateFog=s=>go(Qp(s)),r.validateLayer=s=>go(Kp(s)),r.validateLight=s=>go(Jp(s)),r.validateSource=s=>go(pf(s)),r.validateStyle=Dh,r.validateTerrain=s=>go(mf(s)),r.values=An,r.vectorTile=Dm,r.version=O,r.warnOnce=Bt,r.window=C,r.wrap=Ni}),g(["./shared"],function(r){function C(Fe){if(typeof Fe=="number"||typeof Fe=="boolean"||typeof Fe=="string"||Fe==null)return JSON.stringify(Fe);if(Array.isArray(Fe)){let pe="[";for(const Be of Fe)pe+=`${C(Be)},`;return`${pe}]`}let ue="{";for(const pe of Object.keys(Fe).sort())ue+=`${pe}:${C(Fe[pe])},`;return`${ue}}`}function O(Fe){let ue="";for(const pe of r.refProperties)ue+=`/${C(Fe[pe])}`;return ue}class U{constructor(ue){this.keyCache={},ue&&this.replace(ue)}replace(ue){this._layerConfigs={},this._layers={},this.update(ue,[])}update(ue,pe){for(const qe of ue)this._layerConfigs[qe.id]=qe,(this._layers[qe.id]=r.createStyleLayer(qe)).compileFilter(),this.keyCache[qe.id]&&delete this.keyCache[qe.id];for(const qe of pe)delete this.keyCache[qe],delete this._layerConfigs[qe],delete this._layers[qe];this.familiesBySource={};const Be=function(qe,Je){const ft={};for(let st=0;st<qe.length;st++){const ht=Je&&Je[qe[st].id]||O(qe[st]);Je&&(Je[qe[st].id]=ht);let ni=ft[ht];ni||(ni=ft[ht]=[]),ni.push(qe[st])}const ut=[];for(const st in ft)ut.push(ft[st]);return ut}(r.values(this._layerConfigs),this.keyCache);for(const qe of Be){const Je=qe.map(hi=>this._layers[hi.id]),ft=Je[0];if(ft.visibility==="none")continue;const ut=ft.source||"";let st=this.familiesBySource[ut];st||(st=this.familiesBySource[ut]={});const ht=ft.sourceLayer||"_geojsonTileLayer";let ni=st[ht];ni||(ni=st[ht]=[]),ni.push(Je)}}}class ${loadTile(ue,pe){const{uid:Be,encoding:qe,rawImageData:Je,padding:ft,buildQuadTree:ut}=ue,st=r.window.ImageBitmap&&Je instanceof r.window.ImageBitmap?this.getImageData(Je,ft):Je;pe(null,new r.DEMData(Be,st,qe,ft<1,ut))}getImageData(ue,pe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ue.width,ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ue.width,this.offscreenCanvas.height=ue.height,this.offscreenCanvasContext.drawImage(ue,0,0,ue.width,ue.height);const Be=this.offscreenCanvasContext.getImageData(-pe,-pe,ue.width+2*pe,ue.height+2*pe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Be}}function q(Fe,ue){if(Fe.length!==0){ee(Fe[0],ue);for(var pe=1;pe<Fe.length;pe++)ee(Fe[pe],!ue)}}function ee(Fe,ue){for(var pe=0,Be=0,qe=0,Je=Fe.length,ft=Je-1;qe<Je;ft=qe++){var ut=(Fe[qe][0]-Fe[ft][0])*(Fe[ft][1]+Fe[qe][1]),st=pe+ut;Be+=Math.abs(pe)>=Math.abs(ut)?pe-st+ut:ut-st+pe,pe=st}pe+Be>=0!=!!ue&&Fe.reverse()}var ie=r.getDefaultExportFromCjs(function Fe(ue,pe){var Be,qe=ue&&ue.type;if(qe==="FeatureCollection")for(Be=0;Be<ue.features.length;Be++)Fe(ue.features[Be],pe);else if(qe==="GeometryCollection")for(Be=0;Be<ue.geometries.length;Be++)Fe(ue.geometries[Be],pe);else if(qe==="Feature")Fe(ue.geometry,pe);else if(qe==="Polygon")q(ue.coordinates,pe);else if(qe==="MultiPolygon")for(Be=0;Be<ue.coordinates.length;Be++)q(ue.coordinates[Be],pe);return ue});const de=r.VectorTileFeature.prototype.toGeoJSON;var ye={exports:{}},be=r.pointGeometry,se=r.vectorTile.VectorTileFeature,he=fe;function fe(Fe,ue){this.options=ue||{},this.features=Fe,this.length=Fe.length}function Me(Fe,ue){this.id=typeof Fe.id=="number"?Fe.id:void 0,this.type=Fe.type,this.rawGeometry=Fe.type===1?[Fe.geometry]:Fe.geometry,this.properties=Fe.tags,this.extent=ue||4096}fe.prototype.feature=function(Fe){return new Me(this.features[Fe],this.options.extent)},Me.prototype.loadGeometry=function(){var Fe=this.rawGeometry;this.geometry=[];for(var ue=0;ue<Fe.length;ue++){for(var pe=Fe[ue],Be=[],qe=0;qe<pe.length;qe++)Be.push(new be(pe[qe][0],pe[qe][1]));this.geometry.push(Be)}return this.geometry},Me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Fe=this.geometry,ue=1/0,pe=-1/0,Be=1/0,qe=-1/0,Je=0;Je<Fe.length;Je++)for(var ft=Fe[Je],ut=0;ut<ft.length;ut++){var st=ft[ut];ue=Math.min(ue,st.x),pe=Math.max(pe,st.x),Be=Math.min(Be,st.y),qe=Math.max(qe,st.y)}return[ue,Be,pe,qe]},Me.prototype.toGeoJSON=se.prototype.toGeoJSON;var ze=r.pbf,ve=he;function Ue(Fe){var ue=new ze;return function(pe,Be){for(var qe in pe.layers)Be.writeMessage(3,Ne,pe.layers[qe])}(Fe,ue),ue.finish()}function Ne(Fe,ue){var pe;ue.writeVarintField(15,Fe.version||1),ue.writeStringField(1,Fe.name||""),ue.writeVarintField(5,Fe.extent||4096);var Be={keys:[],values:[],keycache:{},valuecache:{}};for(pe=0;pe<Fe.length;pe++)Be.feature=Fe.feature(pe),ue.writeMessage(2,it,Be);var qe=Be.keys;for(pe=0;pe<qe.length;pe++)ue.writeStringField(3,qe[pe]);var Je=Be.values;for(pe=0;pe<Je.length;pe++)ue.writeMessage(4,St,Je[pe])}function it(Fe,ue){var pe=Fe.feature;pe.id!==void 0&&ue.writeVarintField(1,pe.id),ue.writeMessage(2,Qe,Fe),ue.writeVarintField(3,pe.type),ue.writeMessage(4,Rt,pe)}function Qe(Fe,ue){var pe=Fe.feature,Be=Fe.keys,qe=Fe.values,Je=Fe.keycache,ft=Fe.valuecache;for(var ut in pe.properties){var st=pe.properties[ut],ht=Je[ut];if(st!==null){ht===void 0&&(Be.push(ut),Je[ut]=ht=Be.length-1),ue.writeVarint(ht);var ni=typeof st;ni!=="string"&&ni!=="boolean"&&ni!=="number"&&(st=JSON.stringify(st));var hi=ni+":"+st,Kt=ft[hi];Kt===void 0&&(qe.push(st),ft[hi]=Kt=qe.length-1),ue.writeVarint(Kt)}}}function Xe(Fe,ue){return(ue<<3)+(7&Fe)}function Tt(Fe){return Fe<<1^Fe>>31}function Rt(Fe,ue){for(var pe=Fe.loadGeometry(),Be=Fe.type,qe=0,Je=0,ft=pe.length,ut=0;ut<ft;ut++){var st=pe[ut],ht=1;Be===1&&(ht=st.length),ue.writeVarint(Xe(1,ht));for(var ni=Be===3?st.length-1:st.length,hi=0;hi<ni;hi++){hi===1&&Be!==1&&ue.writeVarint(Xe(2,ni-1));var Kt=st[hi].x-qe,qi=st[hi].y-Je;ue.writeVarint(Tt(Kt)),ue.writeVarint(Tt(qi)),qe+=Kt,Je+=qi}Be===3&&ue.writeVarint(Xe(7,1))}}function St(Fe,ue){var pe=typeof Fe;pe==="string"?ue.writeStringField(1,Fe):pe==="boolean"?ue.writeBooleanField(7,Fe):pe==="number"&&(Fe%1!=0?ue.writeDoubleField(3,Fe):Fe<0?ue.writeSVarintField(6,Fe):ue.writeVarintField(5,Fe))}ye.exports=Ue,ye.exports.fromVectorTileJs=Ue,ye.exports.fromGeojsonVt=function(Fe,ue){ue=ue||{};var pe={};for(var Be in Fe)pe[Be]=new ve(Fe[Be].features,ue),pe[Be].name=Be,pe[Be].version=ue.version,pe[Be].extent=ue.extent;return Ue({layers:pe})},ye.exports.GeoJSONWrapper=ve;var Pt=r.getDefaultExportFromCjs(ye.exports);const oi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Fe=>Fe},ci=Math.fround||(pn=new Float32Array(1),Fe=>(pn[0]=+Fe,pn[0]));var pn;const Ni=3,ji=5,An=6;class Hi{constructor(ue){this.options=Object.assign(Object.create(oi),ue),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ue){const{log:pe,minZoom:Be,maxZoom:qe}=this.options;pe&&console.time("total time");const Je=`prepare ${ue.length} points`;pe&&console.time(Je),this.points=ue;const ft=[];for(let st=0;st<ue.length;st++){const ht=ue[st];if(!ht.geometry)continue;const[ni,hi]=ht.geometry.coordinates,Kt=ci(nt(ni)),qi=ci(Mt(hi));ft.push(Kt,qi,1/0,st,-1,1),this.options.reduce&&ft.push(0)}let ut=this.trees[qe+1]=this._createTree(ft);pe&&console.timeEnd(Je);for(let st=qe;st>=Be;st--){const ht=+Date.now();ut=this.trees[st]=this._createTree(this._cluster(ut,st)),pe&&console.log("z%d: %d clusters in %dms",st,ut.numItems,+Date.now()-ht)}return pe&&console.timeEnd("total time"),this}getClusters(ue,pe){let Be=((ue[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,ue[1]));let Je=ue[2]===180?180:((ue[2]+180)%360+360)%360-180;const ft=Math.max(-90,Math.min(90,ue[3]));if(ue[2]-ue[0]>=360)Be=-180,Je=180;else if(Be>Je){const hi=this.getClusters([Be,qe,180,ft],pe),Kt=this.getClusters([-180,qe,Je,ft],pe);return hi.concat(Kt)}const ut=this.trees[this._limitZoom(pe)],st=ut.range(nt(Be),Mt(ft),nt(Je),Mt(qe)),ht=ut.data,ni=[];for(const hi of st){const Kt=this.stride*hi;ni.push(ht[Kt+ji]>1?Zn(ht,Kt,this.clusterProps):this.points[ht[Kt+Ni]])}return ni}getChildren(ue){const pe=this._getOriginId(ue),Be=this._getOriginZoom(ue),qe="No cluster with the specified id.",Je=this.trees[Be];if(!Je)throw new Error(qe);const ft=Je.data;if(pe*this.stride>=ft.length)throw new Error(qe);const ut=this.options.radius/(this.options.extent*Math.pow(2,Be-1)),st=Je.within(ft[pe*this.stride],ft[pe*this.stride+1],ut),ht=[];for(const ni of st){const hi=ni*this.stride;ft[hi+4]===ue&&ht.push(ft[hi+ji]>1?Zn(ft,hi,this.clusterProps):this.points[ft[hi+Ni]])}if(ht.length===0)throw new Error(qe);return ht}getLeaves(ue,pe,Be){const qe=[];return this._appendLeaves(qe,ue,pe=pe||10,Be=Be||0,0),qe}getTile(ue,pe,Be){const qe=this.trees[this._limitZoom(ue)],Je=Math.pow(2,ue),{extent:ft,radius:ut}=this.options,st=ut/ft,ht=(Be-st)/Je,ni=(Be+1+st)/Je,hi={features:[]};return this._addTileFeatures(qe.range((pe-st)/Je,ht,(pe+1+st)/Je,ni),qe.data,pe,Be,Je,hi),pe===0&&this._addTileFeatures(qe.range(1-st/Je,ht,1,ni),qe.data,Je,Be,Je,hi),pe===Je-1&&this._addTileFeatures(qe.range(0,ht,st/Je,ni),qe.data,-1,Be,Je,hi),hi.features.length?hi:null}getClusterExpansionZoom(ue){let pe=this._getOriginZoom(ue)-1;for(;pe<=this.options.maxZoom;){const Be=this.getChildren(ue);if(pe++,Be.length!==1)break;ue=Be[0].properties.cluster_id}return pe}_appendLeaves(ue,pe,Be,qe,Je){const ft=this.getChildren(pe);for(const ut of ft){const st=ut.properties;if(st&&st.cluster?Je+st.point_count<=qe?Je+=st.point_count:Je=this._appendLeaves(ue,st.cluster_id,Be,qe,Je):Je<qe?Je++:ue.push(ut),ue.length===Be)break}return Je}_createTree(ue){const pe=new r.KDBush(ue.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Be=0;Be<ue.length;Be+=this.stride)pe.add(ue[Be],ue[Be+1]);return pe.finish(),pe.data=ue,pe}_addTileFeatures(ue,pe,Be,qe,Je,ft){for(const ut of ue){const st=ut*this.stride,ht=pe[st+ji]>1;let ni,hi,Kt;if(ht)ni=wn(pe,st,this.clusterProps),hi=pe[st],Kt=pe[st+1];else{const Xi=this.points[pe[st+Ni]];ni=Xi.properties;const[cn,mn]=Xi.geometry.coordinates;hi=nt(cn),Kt=Mt(mn)}const qi={type:1,geometry:[[Math.round(this.options.extent*(hi*Je-Be)),Math.round(this.options.extent*(Kt*Je-qe))]],tags:ni};let zi;zi=ht||this.options.generateId?pe[st+Ni]:this.points[pe[st+Ni]].id,zi!==void 0&&(qi.id=zi),ft.features.push(qi)}}_limitZoom(ue){return Math.max(this.options.minZoom,Math.min(Math.floor(+ue),this.options.maxZoom+1))}_cluster(ue,pe){const{radius:Be,extent:qe,reduce:Je,minPoints:ft}=this.options,ut=Be/(qe*Math.pow(2,pe)),st=ue.data,ht=[],ni=this.stride;for(let hi=0;hi<st.length;hi+=ni){if(st[hi+2]<=pe)continue;st[hi+2]=pe;const Kt=st[hi],qi=st[hi+1],zi=ue.within(st[hi],st[hi+1],ut),Xi=st[hi+ji];let cn=Xi;for(const mn of zi){const ys=mn*ni;st[ys+2]>pe&&(cn+=st[ys+ji])}if(cn>Xi&&cn>=ft){let mn,ys=Kt*Xi,Cs=qi*Xi,mr=-1;const Ys=((hi/ni|0)<<5)+(pe+1)+this.points.length;for(const na of zi){const Ks=na*ni;if(st[Ks+2]<=pe)continue;st[Ks+2]=pe;const br=st[Ks+ji];ys+=st[Ks]*br,Cs+=st[Ks+1]*br,st[Ks+4]=Ys,Je&&(mn||(mn=this._map(st,hi,!0),mr=this.clusterProps.length,this.clusterProps.push(mn)),Je(mn,this._map(st,Ks)))}st[hi+4]=Ys,ht.push(ys/cn,Cs/cn,1/0,Ys,-1,cn),Je&&ht.push(mr)}else{for(let mn=0;mn<ni;mn++)ht.push(st[hi+mn]);if(cn>1)for(const mn of zi){const ys=mn*ni;if(!(st[ys+2]<=pe)){st[ys+2]=pe;for(let Cs=0;Cs<ni;Cs++)ht.push(st[ys+Cs])}}}}return ht}_getOriginId(ue){return ue-this.points.length>>5}_getOriginZoom(ue){return(ue-this.points.length)%32}_map(ue,pe,Be){if(ue[pe+ji]>1){const ft=this.clusterProps[ue[pe+An]];return Be?Object.assign({},ft):ft}const qe=this.points[ue[pe+Ni]].properties,Je=this.options.map(qe);return Be&&Je===qe?Object.assign({},Je):Je}}function Zn(Fe,ue,pe){return{type:"Feature",id:Fe[ue+Ni],properties:wn(Fe,ue,pe),geometry:{type:"Point",coordinates:[(Be=Fe[ue],360*(Be-.5)),xt(Fe[ue+1])]}};var Be}function wn(Fe,ue,pe){const Be=Fe[ue+ji],qe=Be>=1e4?`${Math.round(Be/1e3)}k`:Be>=1e3?Math.round(Be/100)/10+"k":Be,Je=Fe[ue+An],ft=Je===-1?{}:Object.assign({},pe[Je]);return Object.assign(ft,{cluster:!0,cluster_id:Fe[ue+Ni],point_count:Be,point_count_abbreviated:qe})}function nt(Fe){return Fe/360+.5}function Mt(Fe){const ue=Math.sin(Fe*Math.PI/180),pe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return pe<0?0:pe>1?1:pe}function xt(Fe){const ue=(180-360*Fe)*Math.PI/180;return 360*Math.atan(Math.exp(ue))/Math.PI-90}function jt(Fe,ue,pe,Be){for(var qe,Je=Be,ft=pe-ue>>1,ut=pe-ue,st=Fe[ue],ht=Fe[ue+1],ni=Fe[pe],hi=Fe[pe+1],Kt=ue+3;Kt<pe;Kt+=3){var qi=ki(Fe[Kt],Fe[Kt+1],st,ht,ni,hi);if(qi>Je)qe=Kt,Je=qi;else if(qi===Je){var zi=Math.abs(Kt-ft);zi<ut&&(qe=Kt,ut=zi)}}Je>Be&&(qe-ue>3&&jt(Fe,ue,qe,Be),Fe[qe+2]=Je,pe-qe>3&&jt(Fe,qe,pe,Be))}function ki(Fe,ue,pe,Be,qe,Je){var ft=qe-pe,ut=Je-Be;if(ft!==0||ut!==0){var st=((Fe-pe)*ft+(ue-Be)*ut)/(ft*ft+ut*ut);st>1?(pe=qe,Be=Je):st>0&&(pe+=ft*st,Be+=ut*st)}return(ft=Fe-pe)*ft+(ut=ue-Be)*ut}function ai(Fe,ue,pe,Be){var qe={id:Fe===void 0?null:Fe,type:ue,geometry:pe,tags:Be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Je){var ft=Je.geometry,ut=Je.type;if(ut==="Point"||ut==="MultiPoint"||ut==="LineString")Ee(Je,ft);else if(ut==="Polygon"||ut==="MultiLineString")for(var st=0;st<ft.length;st++)Ee(Je,ft[st]);else if(ut==="MultiPolygon")for(st=0;st<ft.length;st++)for(var ht=0;ht<ft[st].length;ht++)Ee(Je,ft[st][ht])}(qe),qe}function Ee(Fe,ue){for(var pe=0;pe<ue.length;pe+=3)Fe.minX=Math.min(Fe.minX,ue[pe]),Fe.minY=Math.min(Fe.minY,ue[pe+1]),Fe.maxX=Math.max(Fe.maxX,ue[pe]),Fe.maxY=Math.max(Fe.maxY,ue[pe+1])}function Ce(Fe,ue,pe,Be){if(ue.geometry){var qe=ue.geometry.coordinates,Je=ue.geometry.type,ft=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2),ut=[],st=ue.id;if(pe.promoteId?st=ue.properties[pe.promoteId]:pe.generateId&&(st=Be||0),Je==="Point")ct(qe,ut);else if(Je==="MultiPoint")for(var ht=0;ht<qe.length;ht++)ct(qe[ht],ut);else if(Je==="LineString")Bt(qe,ut,ft,!1);else if(Je==="MultiLineString"){if(pe.lineMetrics){for(ht=0;ht<qe.length;ht++)Bt(qe[ht],ut=[],ft,!1),Fe.push(ai(st,"LineString",ut,ue.properties));return}Dt(qe,ut,ft,!1)}else if(Je==="Polygon")Dt(qe,ut,ft,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(ht=0;ht<ue.geometry.geometries.length;ht++)Ce(Fe,{id:st,geometry:ue.geometry.geometries[ht],properties:ue.properties},pe,Be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ht=0;ht<qe.length;ht++){var ni=[];Dt(qe[ht],ni,ft,!0),ut.push(ni)}}Fe.push(ai(st,Je,ut,ue.properties))}}function ct(Fe,ue){ue.push(ei(Fe[0])),ue.push(di(Fe[1])),ue.push(0)}function Bt(Fe,ue,pe,Be){for(var qe,Je,ft=0,ut=0;ut<Fe.length;ut++){var st=ei(Fe[ut][0]),ht=di(Fe[ut][1]);ue.push(st),ue.push(ht),ue.push(0),ut>0&&(ft+=Be?(qe*ht-st*Je)/2:Math.sqrt(Math.pow(st-qe,2)+Math.pow(ht-Je,2))),qe=st,Je=ht}var ni=ue.length-3;ue[2]=1,jt(ue,0,ni,pe),ue[ni+2]=1,ue.size=Math.abs(ft),ue.start=0,ue.end=ue.size}function Dt(Fe,ue,pe,Be){for(var qe=0;qe<Fe.length;qe++){var Je=[];Bt(Fe[qe],Je,pe,Be),ue.push(Je)}}function ei(Fe){return Fe/360+.5}function di(Fe){var ue=Math.sin(Fe*Math.PI/180),pe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return pe<0?0:pe>1?1:pe}function Ie(Fe,ue,pe,Be,qe,Je,ft,ut){if(Be/=ue,Je>=(pe/=ue)&&ft<Be)return Fe;if(ft<pe||Je>=Be)return null;for(var st=[],ht=0;ht<Fe.length;ht++){var ni=Fe[ht],hi=ni.geometry,Kt=ni.type,qi=qe===0?ni.minX:ni.minY,zi=qe===0?ni.maxX:ni.maxY;if(qi>=pe&&zi<Be)st.push(ni);else if(!(zi<pe||qi>=Be)){var Xi=[];if(Kt==="Point"||Kt==="MultiPoint")Oe(hi,Xi,pe,Be,qe);else if(Kt==="LineString")rt(hi,Xi,pe,Be,qe,!1,ut.lineMetrics);else if(Kt==="MultiLineString")Yt(hi,Xi,pe,Be,qe,!1);else if(Kt==="Polygon")Yt(hi,Xi,pe,Be,qe,!0);else if(Kt==="MultiPolygon")for(var cn=0;cn<hi.length;cn++){var mn=[];Yt(hi[cn],mn,pe,Be,qe,!0),mn.length&&Xi.push(mn)}if(Xi.length){if(ut.lineMetrics&&Kt==="LineString"){for(cn=0;cn<Xi.length;cn++)st.push(ai(ni.id,Kt,Xi[cn],ni.tags));continue}Kt!=="LineString"&&Kt!=="MultiLineString"||(Xi.length===1?(Kt="LineString",Xi=Xi[0]):Kt="MultiLineString"),Kt!=="Point"&&Kt!=="MultiPoint"||(Kt=Xi.length===3?"Point":"MultiPoint"),st.push(ai(ni.id,Kt,Xi,ni.tags))}}}return st.length?st:null}function Oe(Fe,ue,pe,Be,qe){for(var Je=0;Je<Fe.length;Je+=3){var ft=Fe[Je+qe];ft>=pe&&ft<=Be&&(ue.push(Fe[Je]),ue.push(Fe[Je+1]),ue.push(Fe[Je+2]))}}function rt(Fe,ue,pe,Be,qe,Je,ft){for(var ut,st,ht=Zt(Fe),ni=qe===0?mt:zt,hi=Fe.start,Kt=0;Kt<Fe.length-3;Kt+=3){var qi=Fe[Kt],zi=Fe[Kt+1],Xi=Fe[Kt+2],cn=Fe[Kt+3],mn=Fe[Kt+4],ys=qe===0?qi:zi,Cs=qe===0?cn:mn,mr=!1;ft&&(ut=Math.sqrt(Math.pow(qi-cn,2)+Math.pow(zi-mn,2))),ys<pe?Cs>pe&&(st=ni(ht,qi,zi,cn,mn,pe),ft&&(ht.start=hi+ut*st)):ys>Be?Cs<Be&&(st=ni(ht,qi,zi,cn,mn,Be),ft&&(ht.start=hi+ut*st)):ti(ht,qi,zi,Xi),Cs<pe&&ys>=pe&&(st=ni(ht,qi,zi,cn,mn,pe),mr=!0),Cs>Be&&ys<=Be&&(st=ni(ht,qi,zi,cn,mn,Be),mr=!0),!Je&&mr&&(ft&&(ht.end=hi+ut*st),ue.push(ht),ht=Zt(Fe)),ft&&(hi+=ut)}var Ys=Fe.length-3;qi=Fe[Ys],zi=Fe[Ys+1],Xi=Fe[Ys+2],(ys=qe===0?qi:zi)>=pe&&ys<=Be&&ti(ht,qi,zi,Xi),Ys=ht.length-3,Je&&Ys>=3&&(ht[Ys]!==ht[0]||ht[Ys+1]!==ht[1])&&ti(ht,ht[0],ht[1],ht[2]),ht.length&&ue.push(ht)}function Zt(Fe){var ue=[];return ue.size=Fe.size,ue.start=Fe.start,ue.end=Fe.end,ue}function Yt(Fe,ue,pe,Be,qe,Je){for(var ft=0;ft<Fe.length;ft++)rt(Fe[ft],ue,pe,Be,qe,Je,!1)}function ti(Fe,ue,pe,Be){Fe.push(ue),Fe.push(pe),Fe.push(Be)}function mt(Fe,ue,pe,Be,qe,Je){var ft=(Je-ue)/(Be-ue);return Fe.push(Je),Fe.push(pe+(qe-pe)*ft),Fe.push(1),ft}function zt(Fe,ue,pe,Be,qe,Je){var ft=(Je-pe)/(qe-pe);return Fe.push(ue+(Be-ue)*ft),Fe.push(Je),Fe.push(1),ft}function Ii(Fe,ue){for(var pe=[],Be=0;Be<Fe.length;Be++){var qe,Je=Fe[Be],ft=Je.type;if(ft==="Point"||ft==="MultiPoint"||ft==="LineString")qe=Oi(Je.geometry,ue);else if(ft==="MultiLineString"||ft==="Polygon"){qe=[];for(var ut=0;ut<Je.geometry.length;ut++)qe.push(Oi(Je.geometry[ut],ue))}else if(ft==="MultiPolygon")for(qe=[],ut=0;ut<Je.geometry.length;ut++){for(var st=[],ht=0;ht<Je.geometry[ut].length;ht++)st.push(Oi(Je.geometry[ut][ht],ue));qe.push(st)}pe.push(ai(Je.id,ft,qe,Je.tags))}return pe}function Oi(Fe,ue){var pe=[];pe.size=Fe.size,Fe.start!==void 0&&(pe.start=Fe.start,pe.end=Fe.end);for(var Be=0;Be<Fe.length;Be+=3)pe.push(Fe[Be]+ue,Fe[Be+1],Fe[Be+2]);return pe}function Kn(Fe,ue){if(Fe.transformed)return Fe;var pe,Be,qe,Je=1<<Fe.z,ft=Fe.x,ut=Fe.y;for(pe=0;pe<Fe.features.length;pe++){var st=Fe.features[pe],ht=st.geometry,ni=st.type;if(st.geometry=[],ni===1)for(Be=0;Be<ht.length;Be+=2)st.geometry.push(qn(ht[Be],ht[Be+1],ue,Je,ft,ut));else for(Be=0;Be<ht.length;Be++){var hi=[];for(qe=0;qe<ht[Be].length;qe+=2)hi.push(qn(ht[Be][qe],ht[Be][qe+1],ue,Je,ft,ut));st.geometry.push(hi)}}return Fe.transformed=!0,Fe}function qn(Fe,ue,pe,Be,qe,Je){return[Math.round(pe*(Fe*Be-qe)),Math.round(pe*(ue*Be-Je))]}function _s(Fe,ue,pe,Be,qe){for(var Je=ue===qe.maxZoom?0:qe.tolerance/((1<<ue)*qe.extent),ft={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pe,y:Be,z:ue,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ut=0;ut<Fe.length;ut++){ft.numFeatures++,un(ft,Fe[ut],Je,qe);var st=Fe[ut].minX,ht=Fe[ut].minY,ni=Fe[ut].maxX,hi=Fe[ut].maxY;st<ft.minX&&(ft.minX=st),ht<ft.minY&&(ft.minY=ht),ni>ft.maxX&&(ft.maxX=ni),hi>ft.maxY&&(ft.maxY=hi)}return ft}function un(Fe,ue,pe,Be){var qe=ue.geometry,Je=ue.type,ft=[];if(Je==="Point"||Je==="MultiPoint")for(var ut=0;ut<qe.length;ut+=3)ft.push(qe[ut]),ft.push(qe[ut+1]),Fe.numPoints++,Fe.numSimplified++;else if(Je==="LineString")vr(ft,qe,Fe,pe,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(ut=0;ut<qe.length;ut++)vr(ft,qe[ut],Fe,pe,Je==="Polygon",ut===0);else if(Je==="MultiPolygon")for(var st=0;st<qe.length;st++){var ht=qe[st];for(ut=0;ut<ht.length;ut++)vr(ft,ht[ut],Fe,pe,!0,ut===0)}if(ft.length){var ni=ue.tags||null;if(Je==="LineString"&&Be.lineMetrics){for(var hi in ni={},ue.tags)ni[hi]=ue.tags[hi];ni.mapbox_clip_start=qe.start/qe.size,ni.mapbox_clip_end=qe.end/qe.size}var Kt={geometry:ft,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:ni};ue.id!==null&&(Kt.id=ue.id),Fe.features.push(Kt)}}function vr(Fe,ue,pe,Be,qe,Je){var ft=Be*Be;if(Be>0&&ue.size<(qe?ft:Be))pe.numPoints+=ue.length/3;else{for(var ut=[],st=0;st<ue.length;st+=3)(Be===0||ue[st+2]>ft)&&(pe.numSimplified++,ut.push(ue[st]),ut.push(ue[st+1])),pe.numPoints++;qe&&function(ht,ni){for(var hi=0,Kt=0,qi=ht.length,zi=qi-2;Kt<qi;zi=Kt,Kt+=2)hi+=(ht[Kt]-ht[zi])*(ht[Kt+1]+ht[zi+1]);if(hi>0===ni)for(Kt=0,qi=ht.length;Kt<qi/2;Kt+=2){var Xi=ht[Kt],cn=ht[Kt+1];ht[Kt]=ht[qi-2-Kt],ht[Kt+1]=ht[qi-1-Kt],ht[qi-2-Kt]=Xi,ht[qi-1-Kt]=cn}}(ut,Je),Fe.push(ut)}}function Oo(Fe,ue){var pe=(ue=this.options=function(qe,Je){for(var ft in Je)qe[ft]=Je[ft];return qe}(Object.create(this.options),ue)).debug;if(pe&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");var Be=function(qe,Je){var ft=[];if(qe.type==="FeatureCollection")for(var ut=0;ut<qe.features.length;ut++)Ce(ft,qe.features[ut],Je,ut);else Ce(ft,qe.type==="Feature"?qe:{geometry:qe},Je);return ft}(Fe,ue);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Be=function(qe,Je){var ft=Je.buffer/Je.extent,ut=qe,st=Ie(qe,1,-1-ft,ft,0,-1,2,Je),ht=Ie(qe,1,1-ft,2+ft,0,-1,2,Je);return(st||ht)&&(ut=Ie(qe,1,-ft,1+ft,0,-1,2,Je)||[],st&&(ut=Ii(st,1).concat(ut)),ht&&(ut=ut.concat(Ii(ht,-1)))),ut}(Be,ue),Be.length&&this.splitTile(Be,0,0,0),pe&&(Be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function js(Fe,ue,pe){return 32*((1<<Fe)*pe+ue)+Fe}function or(Fe,ue){const pe=Fe.tileID.canonical;if(!this._geoJSONIndex)return ue(null,null);const Be=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!Be)return ue(null,null);const qe=new class{constructor(ft){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=ft.length,this._features=ft}feature(ft){return new class{constructor(ut){this._feature=ut,this.extent=r.EXTENT,this.type=ut.type,this.properties=ut.tags,"id"in ut&&!isNaN(ut.id)&&(this.id=parseInt(ut.id,10))}loadGeometry(){if(this._feature.type===1){const ut=[];for(const st of this._feature.geometry)ut.push([new r.Point(st[0],st[1])]);return ut}{const ut=[];for(const st of this._feature.geometry){const ht=[];for(const ni of st)ht.push(new r.Point(ni[0],ni[1]));ut.push(ht)}return ut}}toGeoJSON(ut,st,ht){return de.call(this,ut,st,ht)}}(this._features[ft])}}(Be.features);let Je=Pt(qe);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),ue(null,{vectorTile:qe,rawData:Je.buffer})}Oo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Oo.prototype.splitTile=function(Fe,ue,pe,Be,qe,Je,ft){for(var ut=[Fe,ue,pe,Be],st=this.options,ht=st.debug;ut.length;){Be=ut.pop(),pe=ut.pop(),ue=ut.pop(),Fe=ut.pop();var ni=1<<ue,hi=js(ue,pe,Be),Kt=this.tiles[hi];if(!Kt&&(ht>1&&console.time("creation"),Kt=this.tiles[hi]=_s(Fe,ue,pe,Be,st),this.tileCoords.push({z:ue,x:pe,y:Be}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,pe,Be,Kt.numFeatures,Kt.numPoints,Kt.numSimplified),console.timeEnd("creation"));var qi="z"+ue;this.stats[qi]=(this.stats[qi]||0)+1,this.total++}if(Kt.source=Fe,qe){if(ue===st.maxZoom||ue===qe)continue;var zi=1<<qe-ue;if(pe!==Math.floor(Je/zi)||Be!==Math.floor(ft/zi))continue}else if(ue===st.indexMaxZoom||Kt.numPoints<=st.indexMaxPoints)continue;if(Kt.source=null,Fe.length!==0){ht>1&&console.time("clipping");var Xi,cn,mn,ys,Cs,mr,Ys=.5*st.buffer/st.extent,na=.5-Ys,Ks=.5+Ys,br=1+Ys;Xi=cn=mn=ys=null,Cs=Ie(Fe,ni,pe-Ys,pe+Ks,0,Kt.minX,Kt.maxX,st),mr=Ie(Fe,ni,pe+na,pe+br,0,Kt.minX,Kt.maxX,st),Fe=null,Cs&&(Xi=Ie(Cs,ni,Be-Ys,Be+Ks,1,Kt.minY,Kt.maxY,st),cn=Ie(Cs,ni,Be+na,Be+br,1,Kt.minY,Kt.maxY,st),Cs=null),mr&&(mn=Ie(mr,ni,Be-Ys,Be+Ks,1,Kt.minY,Kt.maxY,st),ys=Ie(mr,ni,Be+na,Be+br,1,Kt.minY,Kt.maxY,st),mr=null),ht>1&&console.timeEnd("clipping"),ut.push(Xi||[],ue+1,2*pe,2*Be),ut.push(cn||[],ue+1,2*pe,2*Be+1),ut.push(mn||[],ue+1,2*pe+1,2*Be),ut.push(ys||[],ue+1,2*pe+1,2*Be+1)}}},Oo.prototype.getTile=function(Fe,ue,pe){var Be=this.options,qe=Be.extent,Je=Be.debug;if(Fe<0||Fe>24)return null;var ft=1<<Fe,ut=js(Fe,ue=(ue%ft+ft)%ft,pe);if(this.tiles[ut])return Kn(this.tiles[ut],qe);Je>1&&console.log("drilling down to z%d-%d-%d",Fe,ue,pe);for(var st,ht=Fe,ni=ue,hi=pe;!st&&ht>0;)ht--,ni=Math.floor(ni/2),hi=Math.floor(hi/2),st=this.tiles[js(ht,ni,hi)];return st&&st.source?(Je>1&&console.log("found parent tile z%d-%d-%d",ht,ni,hi),Je>1&&console.time("drilling down"),this.splitTile(st.source,ht,ni,hi,Fe,ue,pe),Je>1&&console.timeEnd("drilling down"),this.tiles[ut]?Kn(this.tiles[ut],qe):null):null};class pr extends r.VectorTileWorkerSource{constructor(ue,pe,Be,qe,Je){super(ue,pe,Be,qe,or),Je&&(this.loadGeoJSON=Je)}loadData(ue,pe){const Be=ue&&ue.request,qe=Be&&Be.collectResourceTiming;this.loadGeoJSON(ue,(Je,ft)=>{if(Je||!ft)return pe(Je);if(typeof ft!="object")return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));{ie(ft,!0);try{if(ue.filter){const st=r.createExpression(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(st.result==="error")throw new Error(st.value.map(ni=>`${ni.key}: ${ni.message}`).join(", "));ft={type:"FeatureCollection",features:ft.features.filter(ni=>st.value.evaluate({zoom:0},ni))}}this._geoJSONIndex=ue.cluster?new Hi(function({superclusterOptions:st,clusterProperties:ht}){if(!ht||!st)return st;const ni={},hi={},Kt={accumulated:null,zoom:0},qi={properties:null},zi=Object.keys(ht);for(const Xi of zi){const[cn,mn]=ht[Xi],ys=r.createExpression(mn),Cs=r.createExpression(typeof cn=="string"?[cn,["accumulated"],["get",Xi]]:cn);ni[Xi]=ys.value,hi[Xi]=Cs.value}return st.map=Xi=>{qi.properties=Xi;const cn={};for(const mn of zi)cn[mn]=ni[mn].evaluate(Kt,qi);return cn},st.reduce=(Xi,cn)=>{qi.properties=cn;for(const mn of zi)Kt.accumulated=Xi[mn],Xi[mn]=hi[mn].evaluate(Kt,qi)},st}(ue)).load(ft.features):function(st,ht){return new Oo(st,ht)}(ft,ue.geojsonVtOptions)}catch(st){return pe(st)}this.loaded={};const ut={};if(qe){const st=r.getPerformanceMeasurement(Be);st&&(ut.resourceTiming={},ut.resourceTiming[ue.source]=JSON.parse(JSON.stringify(st)))}pe(null,ut)}})}reloadTile(ue,pe){const Be=this.loaded;return Be&&Be[ue.uid]?super.reloadTile(ue,pe):this.loadTile(ue,pe)}loadGeoJSON(ue,pe){if(ue.request)r.getJSON(ue.request,pe);else{if(typeof ue.data!="string")return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));try{return pe(null,JSON.parse(ue.data))}catch{return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ue,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(Be){pe(Be)}}getClusterChildren(ue,pe){try{pe(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(Be){pe(Be)}}getClusterLeaves(ue,pe){try{pe(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(Be){pe(Be)}}}class fc{constructor(ue){this.self=ue,this.actor=new r.Actor(ue,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.getProjection({name:"mercator"}),this.workerSourceTypes={vector:r.VectorTileWorkerSource,geojson:pr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,Be)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=Be},this.self.registerRTLTextPlugin=pe=>{if(r.plugin.isParsed())throw new Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=pe.applyArabicShaping,r.plugin.processBidirectionalText=pe.processBidirectionalText,r.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}}clearCaches(ue,pe,Be){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],Be()}checkIfReady(ue,pe,Be){Be()}setReferrer(ue,pe){this.referrer=pe}spriteLoaded(ue,pe){this.isSpriteLoaded[ue]=pe;for(const Be in this.workerSources[ue]){const qe=this.workerSources[ue][Be];for(const Je in qe)qe[Je]instanceof r.VectorTileWorkerSource&&(qe[Je].isSpriteLoaded=pe,qe[Je].fire(new r.Event("isSpriteLoaded")))}}setImages(ue,pe,Be){this.availableImages[ue]=pe;for(const qe in this.workerSources[ue]){const Je=this.workerSources[ue][qe];for(const ft in Je)Je[ft].availableImages=pe}Be()}enableTerrain(ue,pe,Be){this.terrain=pe,Be()}setProjection(ue,pe){this.projections[ue]=r.getProjection(pe)}setLayers(ue,pe,Be){this.getLayerIndex(ue).replace(pe),Be()}updateLayers(ue,pe,Be){this.getLayerIndex(ue).update(pe.layers,pe.removedIds),Be()}loadTile(ue,pe,Be){const qe=this.enableTerrain?r.extend({enableTerrain:this.terrain},pe):pe;qe.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,pe.type,pe.source).loadTile(qe,Be)}loadDEMTile(ue,pe,Be){const qe=this.enableTerrain?r.extend({buildQuadTree:this.terrain},pe):pe;this.getDEMWorkerSource(ue,pe.source).loadTile(qe,Be)}reloadTile(ue,pe,Be){const qe=this.enableTerrain?r.extend({enableTerrain:this.terrain},pe):pe;qe.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,pe.type,pe.source).reloadTile(qe,Be)}abortTile(ue,pe,Be){this.getWorkerSource(ue,pe.type,pe.source).abortTile(pe,Be)}removeTile(ue,pe,Be){this.getWorkerSource(ue,pe.type,pe.source).removeTile(pe,Be)}removeSource(ue,pe,Be){if(!this.workerSources[ue]||!this.workerSources[ue][pe.type]||!this.workerSources[ue][pe.type][pe.source])return;const qe=this.workerSources[ue][pe.type][pe.source];delete this.workerSources[ue][pe.type][pe.source],qe.removeSource!==void 0?qe.removeSource(pe,Be):Be()}loadWorkerSource(ue,pe,Be){try{this.self.importScripts(pe.url),Be()}catch(qe){Be(qe.toString())}}syncRTLPluginState(ue,pe,Be){try{r.plugin.setState(pe);const qe=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&qe!=null){this.self.importScripts(qe);const Je=r.plugin.isParsed();Be(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${qe}`),Je)}}catch(qe){Be(qe.toString())}}getAvailableImages(ue){let pe=this.availableImages[ue];return pe||(pe=[]),pe}getLayerIndex(ue){let pe=this.layerIndexes[ue];return pe||(pe=this.layerIndexes[ue]=new U),pe}getWorkerSource(ue,pe,Be){if(this.workerSources[ue]||(this.workerSources[ue]={}),this.workerSources[ue][pe]||(this.workerSources[ue][pe]={}),!this.workerSources[ue][pe][Be]){const qe={send:(Je,ft,ut,st,ht,ni)=>{this.actor.send(Je,ft,ut,ue,ht,ni)},scheduler:this.actor.scheduler};this.workerSources[ue][pe][Be]=new this.workerSourceTypes[pe](qe,this.getLayerIndex(ue),this.getAvailableImages(ue),this.isSpriteLoaded[ue])}return this.workerSources[ue][pe][Be]}getDEMWorkerSource(ue,pe){return this.demWorkerSources[ue]||(this.demWorkerSources[ue]={}),this.demWorkerSources[ue][pe]||(this.demWorkerSources[ue][pe]=new $),this.demWorkerSources[ue][pe]}enforceCacheSizeLimit(ue,pe){r.enforceCacheSizeLimit(pe)}getWorkerPerformanceMetrics(ue,pe,Be){Be(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new fc(self)),fc}),g(["./shared"],function(r){function C(_,a){if(Array.isArray(_)){if(!Array.isArray(a)||_.length!==a.length)return!1;for(let f=0;f<_.length;f++)if(!C(_[f],a[f]))return!1;return!0}if(typeof _=="object"&&_!==null&&a!==null){if(typeof a!="object"||Object.keys(_).length!==Object.keys(a).length)return!1;for(const f in _)if(!C(_[f],a[f]))return!1;return!0}return _===a}var O=U;function U(_){return!function(a){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,S,A=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(A);try{S=new Worker(R),v=!0}catch{v=!1}return S&&S.terminate(),URL.revokeObjectURL(R),v}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var v=document.createElement("canvas");v.width=v.height=1;var S=v.getContext("2d");if(!S)return!1;var A=S.getImageData(0,0,1,1);return A&&A.width===v.width}()?($[f=a&&a.failIfMajorPerformanceCaveat]===void 0&&($[f]=function(v){var S,A=function(R){var z=document.createElement("canvas"),j=Object.create(U.webGLContextAttributes);return j.failIfMajorPerformanceCaveat=R,z.getContext("webgl",j)||z.getContext("experimental-webgl",j)}(v);if(!A)return!1;try{S=A.createShader(A.VERTEX_SHADER)}catch{return!1}return!(!S||A.isContextLost())&&(A.shaderSource(S,"void main() {}"),A.compileShader(S),A.getShaderParameter(S,A.COMPILE_STATUS)===!0)}(f)),$[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(_)}var $={};function q(_,a,f){const v=r.window.document.createElement(_);return a!==void 0&&(v.className=a),f&&f.appendChild(v),v}function ee(_,a,f){const v=r.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const S of Object.keys(a))v.setAttributeNS(null,S,a[S]);return f&&f.appendChild(v),v}U.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ie=r.window.document&&r.window.document.documentElement.style,de=ie&&ie.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ye;function be(){ie&&de&&(ye=ie[de],ie[de]="none")}function se(){ie&&de&&(ie[de]=ye)}function he(_){_.preventDefault(),_.stopPropagation(),r.window.removeEventListener("click",he,!0)}function fe(){r.window.addEventListener("click",he,!0),r.window.setTimeout(()=>{r.window.removeEventListener("click",he,!0)},0)}function Me(_,a){const f=_.getBoundingClientRect();return Ue(_,f,a)}function ze(_,a){const f=_.getBoundingClientRect(),v=[];for(let S=0;S<a.length;S++)v.push(Ue(_,f,a[S]));return v}function ve(_){return r.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function Ue(_,a,f){const v=_.offsetWidth===a.width?1:_.offsetWidth/a.width;return new r.Point((f.clientX-a.left)*v,(f.clientY-a.top)*v)}function Ne(_,a){var f=a[0],v=a[1],S=a[2],A=a[3],R=f*A-S*v;return R?(_[0]=A*(R=1/R),_[1]=-v*R,_[2]=-S*R,_[3]=f*R,_):null}function it(_){const{userImage:a}=_;return!!(a&&a.render&&a.render())&&(_.data.replace(new Uint8Array(a.data.buffer)),!0)}class Qe extends r.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:f,callback:v}of this.requestors)this._notify(f,v);this.requestors=[]}}hasImage(a){return!!this.getImage(a)}getImage(a){return this.images[a]}addImage(a,f){this._validate(a,f)&&(this.images[a]=f)}_validate(a,f){let v=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new r.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),v=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new r.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),v=!1),this._validateContent(f.content,f)||(this.fire(new r.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),v=!1),v}_validateStretch(a,f){if(!a)return!0;let v=0;for(const S of a){if(S[0]<v||S[1]<S[0]||f<S[1])return!1;v=S[1]}return!0}_validateContent(a,f){return!(a&&(a.length!==4||a[0]<0||f.data.width<a[0]||a[1]<0||f.data.height<a[1]||a[2]<0||f.data.width<a[2]||a[3]<0||f.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))}updateImage(a,f){f.version=this.images[a].version+1,this.images[a]=f,this.updatedImages[a]=!0}removeImage(a){const f=this.images[a];delete this.images[a],delete this.patterns[a],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,f){let v=!0;if(!this.isLoaded())for(const S of a)this.images[S]||(v=!1);this.isLoaded()||v?this._notify(a,f):this.requestors.push({ids:a,callback:f})}_notify(a,f){const v={};for(const S of a){this.images[S]||this.fire(new r.Event("styleimagemissing",{id:S}));const A=this.images[S];A?v[S]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:r.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,v)}getPixelSize(){const{width:a,height:f}=this.atlasImage;return{width:a,height:f}}getPattern(a){const f=this.patterns[a],v=this.getImage(a);if(!v)return null;if(f&&f.position.version===v.version)return f.position;if(f)f.position.version=v.version;else{const S={w:v.data.width+2,h:v.data.height+2,x:0,y:0},A=new r.ImagePosition(S,v);this.patterns[a]={bin:S,position:A}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const f=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(a,this.atlasImage,f.RGBA),this.atlasTexture&&this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const A in this.patterns)a.push(this.patterns[A].bin);const{w:f,h:v}=r.potpack(a),S=this.atlasImage;S.resize({width:f||1,height:v||1});for(const A in this.patterns){const{bin:R}=this.patterns[A],z=R.x+1,j=R.y+1,Z=this.images[A].data,Y=Z.width,ne=Z.height;r.RGBAImage.copy(Z,S,{x:0,y:0},{x:z,y:j},{width:Y,height:ne}),r.RGBAImage.copy(Z,S,{x:0,y:ne-1},{x:z,y:j-1},{width:Y,height:1}),r.RGBAImage.copy(Z,S,{x:0,y:0},{x:z,y:j+ne},{width:Y,height:1}),r.RGBAImage.copy(Z,S,{x:Y-1,y:0},{x:z-1,y:j},{width:1,height:ne}),r.RGBAImage.copy(Z,S,{x:0,y:0},{x:z+Y,y:j},{width:1,height:ne})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const f of a){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const v=this.images[f];it(v)&&this.updateImage(f,v)}}}const Xe=new r.Properties({anchor:new r.DataConstantProperty(r.spec.light.anchor),position:new class{constructor(){this.specification=r.spec.light.position}possiblyEvaluate(_,a){return function([f,v,S]){const A=r.degToRad(v+90),R=r.degToRad(S);return{x:f*Math.cos(A)*Math.sin(R),y:f*Math.sin(A)*Math.sin(R),z:f*Math.cos(R),azimuthal:v,polar:S}}(_.expression.evaluate(a))}interpolate(_,a,f){return{x:r.number(_.x,a.x,f),y:r.number(_.y,a.y,f),z:r.number(_.z,a.z,f),azimuthal:r.number(_.azimuthal,a.azimuthal,f),polar:r.number(_.polar,a.polar,f)}}},color:new r.DataConstantProperty(r.spec.light.color),intensity:new r.DataConstantProperty(r.spec.light.intensity)});class Tt extends r.Evented{constructor(a){super(),this._transitionable=new r.Transitionable(Xe),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,f={}){if(!this._validate(r.validateLight,a,f))for(const v in a){const S=a[v];r.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-11),S):this._transitionable.setValue(v,S)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,f,v){return(!v||v.validate!==!1)&&r.emitValidationErrors(this,a.call(r.validateStyle,r.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}const Rt=new r.Properties({source:new r.DataConstantProperty(r.spec.terrain.source),exaggeration:new r.DataConstantProperty(r.spec.terrain.exaggeration)});let St=class extends r.Evented{constructor(_,a){super(),this._transitionable=new r.Transitionable(Rt),this.set(_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a}get(){return this._transitionable.serialize()}set(_){for(const a in _){const f=_[a];r.endsWith(a,"-transition")?this._transitionable.setTransition(a.slice(0,-11),f):this._transitionable.setValue(a,f)}}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}};function Pt(_,a,f,v){const S=r.smoothstep(45,65,f),[A,R]=oi(_,v),z=r.length(a);let j=1-Math.min(1,Math.exp((z-A)/(R-A)*-6));return j*=j*j,j=Math.min(1,1.00747*j),j*S*_.alpha}function oi(_,a){const f=.5/Math.tan(.5*a);return[_.range[0]+f,_.range[1]+f]}const ci=new r.Properties({range:new r.DataConstantProperty(r.spec.fog.range),color:new r.DataConstantProperty(r.spec.fog.color),"high-color":new r.DataConstantProperty(r.spec.fog["high-color"]),"space-color":new r.DataConstantProperty(r.spec.fog["space-color"]),"horizon-blend":new r.DataConstantProperty(r.spec.fog["horizon-blend"]),"star-intensity":new r.DataConstantProperty(r.spec.fog["star-intensity"])});class pn extends r.Evented{constructor(a,f){super(),this._transitionable=new r.Transitionable(ci),this.set(a),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const a=this._transform,f=a.projection.name==="globe",v=r.globeToMercatorTransition(a.zoom),S=this.properties.get("range"),A=[.5,3];return{range:f?[r.number(A[0],S[0],v),r.number(A[1],S[1],v)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,f={}){if(!this._validate(r.validateFog,a,f)){for(const v of Object.keys(r.spec.fog))a&&a[v]===void 0&&(a[v]=r.spec.fog[v].default);for(const v in a){const S=a[v];r.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-11),S):this._transitionable.setValue(v,S)}}}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.smoothstep(45,65,a))*f.a}getOpacityAtLatLng(a,f){return this._transform.projection.supportsFog?function(v,S,A){const R=r.MercatorCoordinate.fromLngLat(S),z=A.elevation?A.elevation.getAtPointOrZero(R):0,j=[R.x,R.y,z];return r.transformMat4(j,j,A.mercatorFogMatrix),Pt(v,j,A.pitch,A._fov)}(this.state,a,f):0}getFovAdjustedRange(a){return this._transform.projection.supportsFog?oi(this.state,a):[0,1]}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,f,v){return(!v||v.validate!==!1)&&r.emitValidationErrors(this,a.call(r.validateStyle,r.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}class Ni{constructor(a,f){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=r.uniqueId();const v=this.workerPool.acquire(this.id);for(let S=0;S<v.length;S++){const A=new Ni.Actor(v[S],f,this.id);A.name=`Worker ${S}`,this.actors.push(A)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,f,v){r.asyncAll(this.actors,(S,A)=>{S.send(a,f,A)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ji(_,a,f){return a*(r.EXTENT/(_.tileSize*Math.pow(2,f-_.tileID.overscaledZ)))}Ni.Actor=r.Actor;class An{constructor(a,f,v,S){this.screenBounds=a,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(a,f){let v,S;if(a instanceof r.Point||typeof a[0]=="number"){const A=r.Point.convert(a);v=[A],S=f.isPointAboveHorizon(A)}else{const A=r.Point.convert(a[0]),R=r.Point.convert(a[1]);v=[A,R],S=r.polygonizeBounds(A,R).every(z=>f.isPointAboveHorizon(z))}return new An(v,f.getCameraPoint(),S,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(a){return r.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const f=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new r.Point(1,1)):this.screenBounds[1],S=r.polygonizeBounds(f,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<v.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?S[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(S[3]=this.cameraPoint)),r.bufferConvexPolygon(S,a)}bufferedCameraGeometryGlobe(a){const f=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new r.Point(1,1)):this.screenBounds[1],S=r.polygonizeBounds(f,v,a),A=this.cameraPoint.clone();switch(3*((A.y>f.y)+(A.y>v.y))+((A.x>f.x)+(A.x>v.x))){case 0:S[0]=A,S[4]=A.clone();break;case 1:S.splice(1,0,A);break;case 2:S[1]=A;break;case 3:S.splice(4,0,A);break;case 5:S.splice(2,0,A);break;case 6:S[3]=A;break;case 7:S.splice(3,0,A);break;case 8:S[2]=A}return S}containsTile(a,f,v,S=0){const A=a.queryPadding/f._pixelsPerMercatorPixel+1,R=v?this._bufferedCameraMercator(A,f):this._bufferedScreenMercator(A,f);let z=a.tileID.wrap+(R.unwrapped?S:0);const j=R.polygon.map(ke=>r.getTilePoint(a.tileTransform,ke,z));if(!r.polygonIntersectsBox(j,0,0,r.EXTENT,r.EXTENT))return;z=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const Z=this.screenGeometryMercator.polygon.map(ke=>r.getTileVec3(a.tileTransform,ke,z)),Y=Z.map(ke=>new r.Point(ke[0],ke[1])),ne=f.getFreeCameraOptions().position||new r.MercatorCoordinate(0,0,0),ge=r.getTileVec3(a.tileTransform,ne,z),Te=Z.map(ke=>{const re=r.sub(ke,ke,ge);return r.normalize(re,re),new r.Ray(ge,re)}),Ae=ji(a,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:Te,bufferedTilespaceGeometry:j,bufferedTilespaceBounds:(Se=r.getBounds(j),Se.min.x=r.clamp(Se.min.x,0,r.EXTENT),Se.min.y=r.clamp(Se.min.y,0,r.EXTENT),Se.max.x=r.clamp(Se.max.x,0,r.EXTENT),Se.max.y=r.clamp(Se.max.y,0,r.EXTENT),Se),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:Ae};var Se}_bufferedScreenMercator(a,f){const v=wn(a);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let S;return S=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(a),f):{polygon:this.bufferedScreenGeometry(a).map(A=>f.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[v]=S,S}}_bufferedCameraMercator(a,f){const v=wn(a);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let S;return S=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),f):{polygon:this.bufferedCameraGeometry(a).map(A=>f.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[v]=S,S}}_projectAndResample(a,f){const v=function(A,R){const z=r.multiply([],R.pixelMatrix,R.globeMatrix),j=[0,-r.GLOBE_RADIUS,0,1],Z=[0,r.GLOBE_RADIUS,0,1],Y=[0,0,0,1];r.transformMat4$1(j,j,z),r.transformMat4$1(Z,Z,z),r.transformMat4$1(Y,Y,z);const ne=new r.Point(j[0]/j[3],j[1]/j[3]),ge=new r.Point(Z[0]/Z[3],Z[1]/Z[3]),Te=r.polygonContainsPoint(A,ne)&&j[3]<Y[3],Ae=r.polygonContainsPoint(A,ge)&&Z[3]<Y[3];if(!Te&&!Ae)return null;const Se=function(Ke,lt,ot){for(let _t=1;_t<Ke.length;_t++){const Wt=Zn(lt.pointCoordinate3D(Ke[_t-1]).x),pt=Zn(lt.pointCoordinate3D(Ke[_t]).x);if(ot<0){if(Wt<pt)return{idx:_t,t:-Wt/(pt-1-Wt)}}else if(pt<Wt)return{idx:_t,t:(1-Wt)/(pt+1-Wt)}}return null}(A,R,Te?-1:1);if(!Se)return null;const{idx:ke,t:re}=Se;let we=ke>1?Hi(A.slice(0,ke),R):[],De=ke<A.length?Hi(A.slice(ke),R):[];we=we.map(Ke=>new r.Point(Zn(Ke.x),Ke.y)),De=De.map(Ke=>new r.Point(Zn(Ke.x),Ke.y));const Re=[...we];Re.length===0&&Re.push(De[De.length-1]);const Ye=r.number(Re[Re.length-1].y,(De.length===0?we[0]:De[0]).y,re);let We;return We=Te?[new r.Point(0,Ye),new r.Point(0,0),new r.Point(1,0),new r.Point(1,Ye)]:[new r.Point(1,Ye),new r.Point(1,1),new r.Point(0,1),new r.Point(0,Ye)],Re.push(...We),De.length===0?Re.push(we[0]):Re.push(...De),{polygon:Re.map(Ke=>new r.MercatorCoordinate(Ke.x,Ke.y)),unwrapped:!1}}(a,f);if(v)return v;const S=function(A,R){let z=!1,j=-1/0,Z=0;for(let ne=0;ne<A.length-1;ne++)A[ne].x>j&&(j=A[ne].x,Z=ne);for(let ne=0;ne<A.length-1;ne++){const ge=(Z+ne)%(A.length-1),Te=A[ge],Ae=A[ge+1];Math.abs(Te.x-Ae.x)>.5&&(Te.x<Ae.x?(Te.x+=1,ge===0&&(A[A.length-1].x+=1)):(Ae.x+=1,ge+1===A.length-1&&(A[0].x+=1)),z=!0)}const Y=r.mercatorXfromLng(R.center.lng);return z&&Y<Math.abs(Y-1)&&A.forEach(ne=>{ne.x-=1}),{polygon:A,unwrapped:z}}(Hi(a,f).map(A=>new r.Point(Zn(A.x),A.y)),f);return{polygon:S.polygon.map(A=>new r.MercatorCoordinate(A.x,A.y)),unwrapped:S.unwrapped}}}function Hi(_,a){return r.resample(_,f=>{const v=a.pointCoordinate3D(f);f.x=v.x,f.y=v.y},1/256)}function Zn(_){return _<0?1+_%1:_%1}function wn(_){return 100*_|0}function nt(_,a,f,v,S){const A=function(R,z){if(R)return S(R);if(z){_.url&&z.tiles&&_.tiles&&delete _.tiles;const j=r.pick(r.extend(z,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(j.vectorLayers=z.vector_layers,j.vectorLayerIds=j.vectorLayers.map(Z=>Z.id)),j.tiles=a.canonicalizeTileset(j,_.url),S(null,j)}};return _.url?r.getJSON(a.transformRequest(a.normalizeSourceURL(_.url,null,f,v),r.ResourceType.Source),A):r.exported.frame(()=>A(null,_))}class Mt{constructor(a,f,v){this.bounds=r.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=f||0,this.maxzoom=v||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const f=Math.pow(2,a.z),v=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*f),S=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*f),A=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*f),R=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*f);return a.x>=v&&a.x<A&&a.y>=S&&a.y<R}}class xt{constructor(a,f,v){this.context=a;const S=a.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ki{constructor(a,f,v,S){this.length=f.length,this.attributes=v,this.itemSize=f.bytesPerElement,this.dynamicDraw=S,this.context=a;const A=a.gl;this.buffer=A.createBuffer(),a.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,f){for(let v=0;v<this.attributes.length;v++){const S=f.attributes[this.attributes[v].name];S!==void 0&&a.enableVertexAttribArray(S)}}setVertexAttribPointers(a,f,v){for(let S=0;S<this.attributes.length;S++){const A=this.attributes[S],R=f.attributes[A.name];R!==void 0&&a.vertexAttribPointer(R,A.components,a[jt[A.type]],!1,this.itemSize,A.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ai{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ee extends ai{getDefault(){return r.Color.transparent}set(a){const f=this.current;(a.r!==f.r||a.g!==f.g||a.b!==f.b||a.a!==f.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Ce extends ai{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class ct extends ai{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class Bt extends ai{getDefault(){return[!0,!0,!0,!0]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||a[3]!==f[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Dt extends ai{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class ei extends ai{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class di extends ai{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const f=this.current;(a.func!==f.func||a.ref!==f.ref||a.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Ie extends ai{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class Oe extends ai{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=a,this.dirty=!1}}class rt extends ai{getDefault(){return[0,1]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Zt extends ai{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=a,this.dirty=!1}}class Yt extends ai{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class ti extends ai{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.BLEND):f.disable(f.BLEND),this.current=a,this.dirty=!1}}class mt extends ai{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class zt extends ai{getDefault(){return r.Color.transparent}set(a){const f=this.current;(a.r!==f.r||a.g!==f.g||a.b!==f.b||a.a!==f.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Ii extends ai{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class Oi extends ai{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=a,this.dirty=!1}}class Kn extends ai{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class qn extends ai{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}let _s,un=class extends ai{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class vr extends ai{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class Oo extends ai{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||a[3]!==f[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class js extends ai{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class or extends ai{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class pr extends ai{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class fc extends ai{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Fe extends ai{getDefault(){return null}set(a){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class ue extends ai{constructor(a){super(a),this.vao=a.extVertexArrayObject}getDefault(){return null}set(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)}}class pe extends ai{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class Be extends ai{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class qe extends ai{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Je extends ai{constructor(a,f){super(a),this.context=a,this.parent=f}getDefault(){return null}}class ft extends Je{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class ut extends Je{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class st extends ut{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ht{constructor(a,f,v,S){this.context=a,this.width=f,this.height=v;const A=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new ft(a,A),S&&(this.depthAttachment=new ut(a,A))}destroy(){const a=this.context.gl,f=this.colorAttachment.get();if(f&&a.deleteTexture(f),this.depthAttachment){const v=this.depthAttachment.get();v&&a.deleteRenderbuffer(v)}a.deleteFramebuffer(this.framebuffer)}}class ni{constructor(a,f=!1){if(this.gl=a,this.isWebGL2=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),f){const v=a;this.extVertexArrayObject={createVertexArrayOES:v.createVertexArray.bind(a),deleteVertexArrayOES:v.deleteVertexArray.bind(a),bindVertexArrayOES:v.bindVertexArray.bind(a)}}this.clearColor=new Ee(this),this.clearDepth=new Ce(this),this.clearStencil=new ct(this),this.colorMask=new Bt(this),this.depthMask=new Dt(this),this.stencilMask=new ei(this),this.stencilFunc=new di(this),this.stencilOp=new Ie(this),this.stencilTest=new Oe(this),this.depthRange=new rt(this),this.depthTest=new Zt(this),this.depthFunc=new Yt(this),this.blend=new ti(this),this.blendFunc=new mt(this),this.blendColor=new zt(this),this.blendEquation=new Ii(this),this.cullFace=new Oi(this),this.cullFaceSide=new Kn(this),this.frontFace=new qn(this),this.program=new un(this),this.activeTexture=new vr(this),this.viewport=new Oo(this),this.bindFramebuffer=new js(this),this.bindRenderbuffer=new or(this),this.bindTexture=new pr(this),this.bindVertexBuffer=new fc(this),this.bindElementBuffer=new Fe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ue(this),this.pixelStoreUnpack=new pe(this),this.pixelStoreUnpackPremultiplyAlpha=new Be(this),this.pixelStoreUnpackFlipY=new qe(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=a.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=a.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=a.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),f||(this.extTextureHalfFloat=a.getExtension("OES_texture_half_float")),(f||this.extTextureHalfFloat&&a.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=f||a.getExtension("OES_standard_derivatives"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,f){return new xt(this,a,f)}createVertexBuffer(a,f,v){return new ki(this,a,f,v)}createRenderbuffer(a,f,v){const S=this.gl,A=S.createRenderbuffer();return this.bindRenderbuffer.set(A),S.renderbufferStorage(S.RENDERBUFFER,a,f,v),this.bindRenderbuffer.set(null),A}createFramebuffer(a,f,v){return new ht(this,a,f,v)}clear({color:a,depth:f,stencil:v}){const S=this.gl;let A=0;a&&(A|=S.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(A|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),v!==void 0&&(A|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),S.clear(A)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){C(a.blendFunction,r.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class hi extends r.Evented{constructor(a,f,v,S){if(super(),this.id=a,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(f,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new r.DedupedRequest}load(a){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map._worldview;this._tileJSONRequest=nt(this._options,this.map._requestManager,f,v,(S,A)=>{this._tileJSONRequest=null,this._loaded=!0,S?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),v&&v.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new r.ErrorEvent(S))):A&&(r.extend(this,A),A.bounds&&(this.tileBounds=new Mt(A.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(A.tiles,this.map._requestManager._customAccessToken),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),a&&a(S)})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}loadTile(a,f){const v=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(v,r.ResourceType.Tile),data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:a.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired")a.state==="loading"?a.reloadCallback=f:a.request=a.actor.send("reloadTile",S,A.bind(this));else if(a.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)a.request=a.actor.send("loadTile",S,A.bind(this),void 0,!0);else{const R=r.loadVectorTile.call({deduped:this._deduped},S,(z,j)=>{z||!j?A.call(this,z):(S.data={cacheControl:j.cacheControl,expires:j.expires,rawData:j.rawData.slice(0)},a.actor&&a.actor.send("loadTile",S,A.bind(this),void 0,!0))},!0);a.request={cancel:R}}function A(R,z){return delete a.request,a.aborted?f(null):R&&R.status!==404?f(R):(z&&z.resourceTiming&&(a.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&a.setExpiryData(z),a.loadVectorData(z,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),f(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id})}unloadTile(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Kt extends r.Evented{constructor(a,f,v,S){super(),this.id=a,this.dispatcher=v,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},f),r.extend(this,r.pick(f,["url","scheme","tileSize"]))}load(a){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nt(this._options,this.map._requestManager,null,null,(f,v)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new r.ErrorEvent(f)):v&&(r.extend(this,v),v.bounds&&(this.tileBounds=new Mt(v.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(v.tiles),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),a&&a(f)})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,f){const v=r.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);a.request=r.getImage(this.map._requestManager.transformRequest(S,r.ResourceType.Tile),(A,R,z,j)=>(delete a.request,a.aborted?(a.state="unloaded",f(null)):A?(a.state="errored",f(A)):R?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:z,expires:j}),a.setTexture(R,this.map.painter),a.state="loaded",r.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(a,f,v){a.setTexture(f,v)}static unloadTileData(a,f){a.texture&&f.saveTileTexture(a.texture)}abortTile(a,f){a.request&&(a.request.cancel(),delete a.request),f()}unloadTile(a,f){a.texture&&this.map.painter.saveTileTexture(a.texture),f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function qi(_,a,f,v,S,A,R,z){const j=[_,f,S,a,v,A,1,1,1],Z=[R,z,1],Y=r.adjoint([],j),[ne,ge,Te]=r.transformMat3(Z,Z,r.transpose(Y,Y));return r.multiply$1(j,[ne,0,0,0,ge,0,0,0,Te],j)}class zi extends r.Evented{constructor(a,f,v,S){super(),this.id=a,this.dispatcher=v,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=f,this._dirty=!1}load(a,f){this._loaded=f||!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),(v,S)=>{if(this._imageRequest=null,this._loaded=!0,v)this.fire(new r.ErrorEvent(v));else if(S){const{HTMLImageElement:A}=r.window;this.image=S instanceof A?r.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,a&&(this.coordinates=a),this._finishLoading()}})}loaded(){return this._loaded}updateImage(a){return this.image&&a.url?(this._imageRequest&&a.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=a.url,this.load(a.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(a){this.coordinates=a,this._boundsArray=void 0;const f=a.map(r.MercatorCoordinate.fromLngLat);return this.tileID=function(v){let S=1/0,A=1/0,R=-1/0,z=-1/0;for(const ne of v)S=Math.min(S,ne.x),A=Math.min(A,ne.y),R=Math.max(R,ne.x),z=Math.max(z,ne.y);const j=Math.max(R-S,z-A),Z=Math.max(0,Math.floor(-Math.log(j)/Math.LN2)),Y=Math.pow(2,Z);return new r.CanonicalTileID(Z,Math.floor((S+R)/2*Y),Math.floor((A+z)/2*Y))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(a){for(const j in this.tiles){const Z=this.tiles[j];Z.state!=="loaded"&&(Z.state="loaded",Z.texture=this.texture)}if(this._boundsArray)return;const f=r.tileTransform(this.tileID,this.map.transform.projection),[v,S,A,R]=this.coordinates.map(j=>{const Z=f.projection.project(j[0],j[1]);return r.getTilePoint(f,Z)._round()});this.perspectiveTransform=function(j,Z,Y,ne,ge,Te,Ae,Se,ke,re){const we=qi(0,0,j,0,0,Z,j,Z),De=qi(Y,ne,ge,Te,Ae,Se,ke,re);return r.multiply$1(De,r.adjoint(we,we),De),[De[6]/De[8]*j/r.EXTENT,De[7]/De[8]*Z/r.EXTENT]}(this.width,this.height,v.x,v.y,S.x,S.y,R.x,R.y,A.x,A.y);const z=this._boundsArray=new r.StructArrayLayout4i8;z.emplaceBack(v.x,v.y,0,0),z.emplaceBack(S.x,S.y,r.EXTENT,0),z.emplaceBack(R.x,R.y,0,r.EXTENT),z.emplaceBack(A.x,A.y,r.EXTENT,r.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=a.createVertexBuffer(z,r.boundsAttributes.members),this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const a=this.map.painter.context,f=a.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new r.Texture(a,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(a)}loadTile(a,f){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},f(null)):(a.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Xi={vector:hi,raster:Kt,"raster-dem":class extends Kt{constructor(_,a,f,v){super(_,a,f,v),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(_,a){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(S,A){S&&(_.state="errored",a(S)),A&&(_.dem=A,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",a(null))}_.request=r.getImage(this.map._requestManager.transformRequest(f,r.ResourceType.Tile),(function(S,A,R,z){if(delete _.request,_.aborted)_.state="unloaded",a(null);else if(S)_.state="errored",a(S);else if(A){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:R,expires:z});const j=r.window.ImageBitmap&&A instanceof r.window.ImageBitmap&&(_s==null&&(_s=r.window.OffscreenCanvas&&new r.window.OffscreenCanvas(1,1).getContext("2d")&&typeof r.window.createImageBitmap=="function"),_s),Z=1-(A.width-r.prevPowerOfTwo(A.width))/2;Z<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const Y=j?A:r.exported.getImageData(A,Z),ne={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:Y,encoding:this.encoding,padding:Z};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",ne,v.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(_){const a=_.canonical,f=Math.pow(2,a.z),v=(a.x-1+f)%f,S=a.x===0?_.wrap-1:_.wrap,A=(a.x+1+f)%f,R=a.x+1===f?_.wrap+1:_.wrap,z={};return z[new r.OverscaledTileID(_.overscaledZ,S,a.z,v,a.y).key]={backfilled:!1},z[new r.OverscaledTileID(_.overscaledZ,R,a.z,A,a.y).key]={backfilled:!1},a.y>0&&(z[new r.OverscaledTileID(_.overscaledZ,S,a.z,v,a.y-1).key]={backfilled:!1},z[new r.OverscaledTileID(_.overscaledZ,_.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},z[new r.OverscaledTileID(_.overscaledZ,R,a.z,A,a.y-1).key]={backfilled:!1}),a.y+1<f&&(z[new r.OverscaledTileID(_.overscaledZ,S,a.z,v,a.y+1).key]={backfilled:!1},z[new r.OverscaledTileID(_.overscaledZ,_.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},z[new r.OverscaledTileID(_.overscaledZ,R,a.z,A,a.y+1).key]={backfilled:!1}),z}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends r.Evented{constructor(_,a,f,v){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(v),this._data=a.data,this._options=r.extend({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const S=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*S,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*S,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:r.EXTENT,radius:(a.clusterRadius!==void 0?a.clusterRadius:50)*S,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},a),this}getClusterChildren(_,a){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},a),this}getClusterLeaves(_,a,f,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:a,offset:f},v),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=r.extend({},this.workerOptions),a=this._data;typeof a=="string"?(_.request=this.map._requestManager.transformRequest(r.exported.resolveURL(a),r.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(a),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(f,v)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new r.ErrorEvent(f));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(S.resourceTiming=v.resourceTiming[this.id]),this.fire(new r.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,a){const f=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(f,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(v,S)=>(delete _.request,_.unloadVectorData(),_.aborted?a(null):v?a(v):(_.loadVectorData(S,this.map.painter,f==="reloadTile"),a(null))),void 0,f==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends zi{constructor(_,a,f,v){super(_,a,f,v),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const a of _.urls)this.urls.push(this.map._requestManager.transformRequest(a,r.ResourceType.Source).url);r.getVideo(this.urls,(a,f)=>{this._loaded=!0,a?this.fire(new r.ErrorEvent(a)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const a=this.video.seekable;_<a.start(0)||_>a.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,a=_.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(_,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:zi,canvas:class extends zi{constructor(_,a,f,v){super(_,a,f,v),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(A=>typeof A!="number"))||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(a,this.canvas,a.gl.RGBA,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends r.Evented{constructor(_,a,f,v){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=a,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Mt(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.clearTiles=this._clearTiles.bind(this),a.coveringTiles=this._coveringTiles.bind(this),r.extend(this,r.pick(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:a,y:f,z:v}=_.canonical;return this._implementation.hasTile({x:a,y:f,z:v})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,a){const{x:f,y:v,z:S}=_.tileID.canonical,A=new r.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:f,y:v,z:S},{signal:A.signal})).then((function(R){return delete _.request,_.aborted?(_.state="unloaded",a(null)):R===void 0?(_.state="errored",a(null)):R===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",a(null)):function(z){return z instanceof r.window.ImageData||z instanceof r.window.HTMLCanvasElement||z instanceof r.window.ImageBitmap||z instanceof r.window.HTMLImageElement}(R)?(this.loadTileData(_,R),_.state="loaded",void a(null)):(_.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(R=>{R.code!==20&&(_.state="errored",a(R))}),_.request.cancel=()=>A.abort()}loadTileData(_,a){Kt.loadTileData(_,a,this._map.painter)}unloadTileData(_){Kt.unloadTileData(_,this._map.painter)}unloadTile(_,a){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:f,y:v,z:S}=_.tileID.canonical;this._implementation.unloadTile({x:f,y:v,z:S})}a()}abortTile(_,a){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),a()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}}},cn=function(_,a,f,v){const S=new Xi[a.type](_,a,f,v);if(S.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${S.id}`);return r.bindAll(["load","abort","unload","serialize","prepare"],S),S};function mn(_,a){const f=r.identity([]);return r.scale(f,f,[.5*_.width,.5*-_.height,1]),r.translate(f,f,[1,-1,0]),r.multiply(f,f,_.calculateProjMatrix(a.toUnwrapped())),Float32Array.from(f)}function ys(_,a,f,v,S,A,R,z=!1){const j=_.tilesIn(v,R,z);j.sort(mr);const Z=[];for(const ne of j)Z.push({wrappedTileID:ne.tile.tileID.wrapped().key,queryResults:ne.tile.queryRenderedFeatures(a,f,_._state,ne,S,A,mn(_.transform,ne.tile.tileID),z)});const Y=function(ne){const ge={},Te={};for(const Ae of ne){const Se=Ae.queryResults,ke=Ae.wrappedTileID,re=Te[ke]=Te[ke]||{};for(const we in Se){const De=Se[we],Re=re[we]=re[we]||{},Ye=ge[we]=ge[we]||[];for(const We of De)Re[We.featureIndex]||(Re[We.featureIndex]=!0,Ye.push(We))}}return ge}(Z);for(const ne in Y)Y[ne].forEach(ge=>{const Te=ge.feature,Ae=Te.layer;Ae&&Ae.type!=="background"&&Ae.type!=="sky"&&(Te.source=Ae.source,Ae["source-layer"]&&(Te.sourceLayer=Ae["source-layer"]),Te.state=Te.id!==void 0?_.getFeatureState(Ae["source-layer"],Te.id):{})});return Y}function Cs(_,a){const f=_.getRenderableIds().map(A=>_.getTileByID(A)),v=[],S={};for(let A=0;A<f.length;A++){const R=f[A],z=R.tileID.canonical.key;S[z]||(S[z]=!0,R.querySourceFeatures(v,a))}return v}function mr(_,a){const f=_.tileID,v=a.tileID;return f.overscaledZ-v.overscaledZ||f.canonical.y-v.canonical.y||f.wrap-v.wrap||f.canonical.x-v.canonical.x}function Ys(){return Rc.workerClass!=null?new Rc.workerClass:new r.window.Worker(Rc.workerUrl)}const na="mapboxgl_preloaded_worker_pool";class Ks{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Ks.workerCount;)this.workers.push(new Ys);return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[na]}numActive(){return Object.keys(this.active).length}}let br;function Ds(){return br||(br=new Ks),br}function Bp(_,a){const f={};for(const v in _)v!=="ref"&&(f[v]=_[v]);return r.refProperties.forEach(v=>{v in a&&(f[v]=a[v])}),f}function Fp(_){_=_.slice();const a=Object.create(null);for(let f=0;f<_.length;f++)a[_[f].id]=_[f];for(let f=0;f<_.length;f++)"ref"in _[f]&&(_[f]=Bp(_[f],a[_[f].ref]));return _}Ks.workerCount=2;const kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function jd(_,a,f){f.push({command:kn.addSource,args:[_,a[_]]})}function hh(_,a,f){a.push({command:kn.removeSource,args:[_]}),f[_]=!0}function fu(_,a,f,v){hh(_,f,v),jd(_,a,f)}function pu(_,a,f){let v;for(v in _[f])if(_[f].hasOwnProperty(v)&&v!=="data"&&!C(_[f][v],a[f][v]))return!1;for(v in a[f])if(a[f].hasOwnProperty(v)&&v!=="data"&&!C(_[f][v],a[f][v]))return!1;return!0}function Ro(_,a,f,v,S,A){let R;for(R in a=a||{},_=_||{})_.hasOwnProperty(R)&&(C(_[R],a[R])||f.push({command:A,args:[v,R,a[R],S]}));for(R in a)a.hasOwnProperty(R)&&!_.hasOwnProperty(R)&&(C(_[R],a[R])||f.push({command:A,args:[v,R,a[R],S]}))}function sa(_){return _.id}function $d(_,a){return _[a.id]=a,_}class uh{constructor(a,f){this.reset(a,f)}reset(a,f){this.points=a||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=r.clamp(a,0,1);let f=1,v=this._distances[f];const S=a*this.paddedLength+this.padding;for(;v<S&&f<this._distances.length;)v=this._distances[++f];const A=f-1,R=this._distances[A],z=v-R,j=z>0?(S-R)/z:0;return this.points[A].mult(1-j).add(this.points[f].mult(j))}}class ra{constructor(a,f,v){const S=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(a/v),this.yCellCount=Math.ceil(f/v);for(let R=0;R<this.xCellCount*this.yCellCount;R++)S.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=f,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,f,v,S,A){this._forEachCell(f,v,S,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(A)}insertCircle(a,f,v,S){this._forEachCell(f-S,v-S,f+S,v+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(f),this.circles.push(v),this.circles.push(S)}_insertBoxCell(a,f,v,S,A,R){this.boxCells[A].push(R)}_insertCircleCell(a,f,v,S,A,R){this.circleCells[A].push(R)}_query(a,f,v,S,A,R){if(v<0||a>this.width||S<0||f>this.height)return!A&&[];const z=[];if(a<=0&&f<=0&&this.width<=v&&this.height<=S){if(A)return!0;for(let j=0;j<this.boxKeys.length;j++)z.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const Z=this.circles[3*j],Y=this.circles[3*j+1],ne=this.circles[3*j+2];z.push({key:this.circleKeys[j],x1:Z-ne,y1:Y-ne,x2:Z+ne,y2:Y+ne})}return R?z.filter(R):z}return this._forEachCell(a,f,v,S,this._queryCell,z,{hitTest:A,seenUids:{box:{},circle:{}}},R),A?z.length>0:z}_queryCircle(a,f,v,S,A){const R=a-v,z=a+v,j=f-v,Z=f+v;if(z<0||R>this.width||Z<0||j>this.height)return!S&&[];const Y=[];return this._forEachCell(R,j,z,Z,this._queryCellCircle,Y,{hitTest:S,circle:{x:a,y:f,radius:v},seenUids:{box:{},circle:{}}},A),S?Y.length>0:Y}query(a,f,v,S,A){return this._query(a,f,v,S,!1,A)}hitTest(a,f,v,S,A){return this._query(a,f,v,S,!0,A)}hitTestCircle(a,f,v,S){return this._queryCircle(a,f,v,!0,S)}_queryCell(a,f,v,S,A,R,z,j){const Z=z.seenUids,Y=this.boxCells[A];if(Y!==null){const ge=this.bboxes;for(const Te of Y)if(!Z.box[Te]){Z.box[Te]=!0;const Ae=4*Te;if(a<=ge[Ae+2]&&f<=ge[Ae+3]&&v>=ge[Ae+0]&&S>=ge[Ae+1]&&(!j||j(this.boxKeys[Te]))){if(z.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[Te],x1:ge[Ae],y1:ge[Ae+1],x2:ge[Ae+2],y2:ge[Ae+3]})}}}const ne=this.circleCells[A];if(ne!==null){const ge=this.circles;for(const Te of ne)if(!Z.circle[Te]){Z.circle[Te]=!0;const Ae=3*Te;if(this._circleAndRectCollide(ge[Ae],ge[Ae+1],ge[Ae+2],a,f,v,S)&&(!j||j(this.circleKeys[Te]))){if(z.hitTest)return R.push(!0),!0;{const Se=ge[Ae],ke=ge[Ae+1],re=ge[Ae+2];R.push({key:this.circleKeys[Te],x1:Se-re,y1:ke-re,x2:Se+re,y2:ke+re})}}}}}_queryCellCircle(a,f,v,S,A,R,z,j){const Z=z.circle,Y=z.seenUids,ne=this.boxCells[A];if(ne!==null){const Te=this.bboxes;for(const Ae of ne)if(!Y.box[Ae]){Y.box[Ae]=!0;const Se=4*Ae;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,Te[Se+0],Te[Se+1],Te[Se+2],Te[Se+3])&&(!j||j(this.boxKeys[Ae])))return R.push(!0),!0}}const ge=this.circleCells[A];if(ge!==null){const Te=this.circles;for(const Ae of ge)if(!Y.circle[Ae]){Y.circle[Ae]=!0;const Se=3*Ae;if(this._circlesCollide(Te[Se],Te[Se+1],Te[Se+2],Z.x,Z.y,Z.radius)&&(!j||j(this.circleKeys[Ae])))return R.push(!0),!0}}}_forEachCell(a,f,v,S,A,R,z,j){const Z=this._convertToXCellCoord(a),Y=this._convertToYCellCoord(f),ne=this._convertToXCellCoord(v),ge=this._convertToYCellCoord(S);for(let Te=Z;Te<=ne;Te++)for(let Ae=Y;Ae<=ge;Ae++)if(A.call(this,a,f,v,S,this.xCellCount*Ae+Te,R,z,j))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,f,v,S,A,R){const z=S-a,j=A-f,Z=v+R;return Z*Z>z*z+j*j}_circleAndRectCollide(a,f,v,S,A,R,z){const j=(R-S)/2,Z=Math.abs(a-(S+j));if(Z>j+v)return!1;const Y=(z-A)/2,ne=Math.abs(f-(A+Y));if(ne>Y+v)return!1;if(Z<=j||ne<=Y)return!0;const ge=Z-j,Te=ne-Y;return ge*ge+Te*Te<=v*v}}const Ia={unknown:0,flipRequired:1,flipNotRequired:2},Yn=Math.tan(85*Math.PI/180);function Ct(_,a,f,v,S,A,R){const z=r.create();if(f)if(A.name==="globe"){const j=r.calculateGlobeLabelMatrix(S,a);r.multiply(z,z,j)}else{const j=Ne([],R);z[0]=j[0],z[1]=j[1],z[4]=j[2],z[5]=j[3],v||r.rotateZ(z,z,S.angle)}else r.multiply(z,S.labelPlaneMatrix,_);return z}function oa(_,a,f,v,S,A,R){const z=Ct(_,a,f,v,S,A,R);return A.name==="globe"&&f||(z[2]=z[6]=z[10]=z[14]=0),z}function $s(_,a,f,v,S,A,R){if(f){if(A.name==="globe"){const z=Ct(_,a,f,v,S,A,R);return r.invert(z,z),r.multiply(z,_,z),z}{const z=r.clone(_),j=r.identity([]);return j[0]=R[0],j[1]=R[1],j[4]=R[2],j[5]=R[3],r.multiply(z,z,j),v||r.rotateZ(z,z,-S.angle),z}}return S.glCoordMatrix}function ar(_,a,f,v){const S=[_,a,f,1];f?r.transformMat4$1(S,S,v):nn(S,S,v);const A=S[3];return S[0]/=A,S[1]/=A,S[2]/=A,S}function Np(_,a){return Math.min(.5+_/a*.5,1.5)}function aa(_,a){const f=_[0]/_[3],v=_[1]/_[3];return f>=-a[0]&&f<=a[0]&&v>=-a[1]&&v<=a[1]}function mu(_,a,f,v,S,A,R,z,j,Z){const Y=f.transform,ne=v?_.textSizeData:_.iconSizeData,ge=r.evaluateSizeForZoom(ne,f.transform.zoom),Te=Y.projection.name==="globe",Ae=[256/f.width*2+1,256/f.height*2+1],Se=v?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;Se.clear();let ke=null;Te&&(ke=v?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const re=_.lineVertexArray,we=v?_.text.placedSymbolArray:_.icon.placedSymbolArray,De=f.transform.width/f.transform.height;let Re,Ye=!1;for(let We=0;We<we.length;We++){const Ke=we.get(We),{numGlyphs:lt,writingMode:ot}=Ke;if(ot!==r.WritingMode.vertical||Ye||Re===r.WritingMode.horizontal||(Ye=!0),Re=ot,(Ke.hidden||ot===r.WritingMode.vertical)&&!Ye){co(lt,Se);continue}Ye=!1;const _t=new r.Point(Ke.tileAnchorX,Ke.tileAnchorY);let{x:Wt,y:pt,z:Lt}=Y.projection.projectTilePoint(_t.x,_t.y,Z.canonical);if(j){const[$i,wi,Li]=j(_t);Wt+=$i,pt+=wi,Lt+=Li}const wt=[Wt,pt,Lt,1];if(r.transformMat4$1(wt,wt,a),!aa(wt,Ae)){co(lt,Se);continue}const qt=Np(f.transform.cameraToCenterDistance,wt[3]),dt=r.evaluateSizeForFeature(ne,ge,Ke),Ot=R?dt/qt:dt*qt,Xt=ar(Wt,pt,Lt,S);if(Xt[3]<=0){co(lt,Se);continue}let kt={};const Jt=R?null:j,Pi=mi(Ke,Ot,!1,z,a,S,A,_.glyphOffsetArray,re,Se,ke,Xt,_t,kt,De,Jt,Y.projection,Z,R);Ye=Pi.useVertical,Jt&&Pi.needsFlipping&&(kt={}),(Pi.notEnoughRoom||Ye||Pi.needsFlipping&&mi(Ke,Ot,!0,z,a,S,A,_.glyphOffsetArray,re,Se,ke,Xt,_t,kt,De,Jt,Y.projection,Z,R).notEnoughRoom)&&co(lt,Se)}v?(_.text.dynamicLayoutVertexBuffer.updateData(Se),ke&&_.text.globeExtVertexBuffer.updateData(ke)):(_.icon.dynamicLayoutVertexBuffer.updateData(Se),ke&&_.icon.globeExtVertexBuffer.updateData(ke))}function Up(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se){const{lineStartIndex:ke,glyphStartIndex:re,segment:we}=z,De=re+z.numGlyphs,Re=ke+z.lineLength,Ye=a.getoffsetX(re),We=a.getoffsetX(De-1),Ke=$r(_*Ye,f,v,S,A,R,we,ke,Re,j,Z,Y,ne,ge,!0,Te,Ae,Se);if(!Ke)return null;const lt=$r(_*We,f,v,S,A,R,we,ke,Re,j,Z,Y,ne,ge,!0,Te,Ae,Se);return lt?{first:Ke,last:lt}:null}function pc(_,a,f,v){return _===r.WritingMode.horizontal&&Math.abs(v)>Math.abs(f)?{useVertical:!0}:_===r.WritingMode.vertical?v>0?{needsFlipping:!0}:null:a!==Ia.unknown&&function(S,A){return S===0||Math.abs(A/S)>Yn}(f,v)?a===Ia.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function mi(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se,ke,re,we){const De=a/24,Re=_.lineOffsetX*De,Ye=_.lineOffsetY*De,{lineStartIndex:We,glyphStartIndex:Ke,numGlyphs:lt,segment:ot,writingMode:_t,flipState:Wt}=_,pt=We+_.lineLength,Lt=wt=>{if(Y){const[Xt,kt,Jt]=wt.up,Pi=Z.length;r.updateGlobeVertexNormal(Y,Pi+0,Xt,kt,Jt),r.updateGlobeVertexNormal(Y,Pi+1,Xt,kt,Jt),r.updateGlobeVertexNormal(Y,Pi+2,Xt,kt,Jt),r.updateGlobeVertexNormal(Y,Pi+3,Xt,kt,Jt)}const[qt,dt,Ot]=wt.point;r.addDynamicAttributes(Z,qt,dt,Ot,wt.angle)};if(lt>1){const wt=Up(De,z,Re,Ye,f,ne,ge,_,j,A,Te,Se,!1,ke,re,we);if(!wt)return{notEnoughRoom:!0};if(v&&!f){let[qt,dt,Ot]=wt.first.point,[Xt,kt,Jt]=wt.last.point;[qt,dt]=ar(qt,dt,Ot,R),[Xt,kt]=ar(Xt,kt,Jt,R);const Pi=pc(_t,Wt,(Xt-qt)*Ae,kt-dt);if(_.flipState=Pi&&Pi.needsFlipping?Ia.flipRequired:Ia.flipNotRequired,Pi)return Pi}Lt(wt.first);for(let qt=Ke+1;qt<Ke+lt-1;qt++){const dt=$r(De*z.getoffsetX(qt),Re,Ye,f,ne,ge,ot,We,pt,j,A,Te,Se,!1,!1,ke,re,we);if(!dt)return Z.length-=4*(qt-Ke),{notEnoughRoom:!0};Lt(dt)}Lt(wt.last)}else{if(v&&!f){const qt=ar(ge.x,ge.y,0,S),dt=We+ot+1,Ot=new r.Point(j.getx(dt),j.gety(dt)),Xt=ar(Ot.x,Ot.y,0,S),kt=Xt[3]>0?Xt:tn(ge,Ot,qt,1,S,void 0,ke,re.canonical),Jt=pc(_t,Wt,(kt[0]-qt[0])*Ae,kt[1]-qt[1]);if(_.flipState=Jt&&Jt.needsFlipping?Ia.flipRequired:Ia.flipNotRequired,Jt)return Jt}const wt=$r(De*z.getoffsetX(Ke),Re,Ye,f,ne,ge,ot,We,pt,j,A,Te,Se,!1,!1,ke,re,we);if(!wt)return{notEnoughRoom:!0};Lt(wt)}return{}}function dn(_,a,f,v,S){const{x:A,y:R,z}=v.projectTilePoint(_.x,_.y,a);if(!S)return ar(A,R,z,f);const[j,Z,Y]=S(_);return ar(A+j,R+Z,z+Y,f)}function tn(_,a,f,v,S,A,R,z){const j=dn(_.sub(a)._unit()._add(_),z,S,R,A);return r.sub(j,f,j),r.normalize(j,j),r.scaleAndAdd(j,f,j,v)}function $r(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se,ke,re){const we=v?_-a:_+a;let De=we>0?1:-1,Re=0;v&&(De*=-1,Re=Math.PI),De<0&&(Re+=Math.PI);let Ye=z+R+(De>0?0:1)|0,We=S,Ke=S,lt=0,ot=0;const _t=Math.abs(we),Wt=[],pt=[];let Lt=A,wt=Lt;const qt=()=>tn(wt,Lt,Ke,_t-lt+1,Y,ge,Se,ke.canonical);for(;lt+ot<=_t;){if(Ye+=De,Ye<z||Ye>=j)return null;if(Ke=We,wt=Lt,Wt.push(Ke),Te&&pt.push(wt),Lt=new r.Point(Z.getx(Ye),Z.gety(Ye)),We=ne[Ye],!We){const Li=dn(Lt,ke.canonical,Y,Se,ge);We=Li[3]>0?ne[Ye]=Li:qt()}lt+=ot,ot=r.distance(Ke,We)}Ae&&ge&&(ne[Ye]&&(We=qt(),ot=r.distance(Ke,We)),ne[Ye]=We);const dt=(_t-lt)/ot,Ot=Lt.sub(wt)._mult(dt)._add(wt),Xt=r.sub([],We,Ke),kt=r.scaleAndAdd([],Ke,Xt,dt);let Jt=[0,0,1],Pi=Xt[0],$i=Xt[1];if(re&&(Jt=Se.upVector(ke.canonical,Ot.x,Ot.y),Jt[0]!==0||Jt[1]!==0||Jt[2]!==1)){const Li=[Jt[2],0,-Jt[0]],Zi=r.cross([],Jt,Li);r.normalize(Li,Li),r.normalize(Zi,Zi),Pi=r.dot(Xt,Li),$i=r.dot(Xt,Zi)}if(f){const Li=r.cross([],Jt,Xt);r.normalize(Li,Li),r.scaleAndAdd(kt,kt,Li,f*De)}const wi=Re+Math.atan2($i,Pi);return Wt.push(kt),Te&&pt.push(Ot),{point:kt,angle:wi,path:Wt,tilePath:pt,up:Jt}}function co(_,a){const f=a.length,v=f+4*_;a.resize(v),a.float32.fill(-1/0,4*f,4*v)}function nn(_,a,f){const v=a[0],S=a[1];return _[0]=f[0]*v+f[4]*S+f[12],_[1]=f[1]*v+f[5]*S+f[13],_[3]=f[3]*v+f[7]*S+f[15],_}const Wr=100;class wr{constructor(a,f,v=new ra(a.width+200,a.height+200,25),S=new ra(a.width+200,a.height+200,25)){this.transform=a,this.grid=v,this.ignoredGrid=S,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Wr,this.screenBottomBoundary=a.height+Wr,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=f}placeCollisionBox(a,f,v,S,A,R,z,j){let Z=v.projectedAnchorX,Y=v.projectedAnchorY,ne=v.projectedAnchorZ;const ge=v.elevation,Te=v.tileID,Ae=a.getProjection();if(ge&&Te){const[We,Ke,lt]=Ae.upVector(Te.canonical,v.tileAnchorX,v.tileAnchorY),ot=Ae.upVectorScale(Te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=We*ge*ot,Y+=Ke*ge*ot,ne+=lt*ge*ot}const Se=this.projectAndGetPerspectiveRatio(z,Z,Y,ne,v.tileID,Ae.name==="globe"||!!ge||this.transform.pitch>0,Ae),ke=R*Se.perspectiveRatio,re=(v.x1*f+S.x-v.padding)*ke+Se.point.x,we=(v.y1*f+S.y-v.padding)*ke+Se.point.y,De=(v.x2*f+S.x+v.padding)*ke+Se.point.x,Re=(v.y2*f+S.y+v.padding)*ke+Se.point.y,Ye=Se.perspectiveRatio<=.55||Se.occluded;return!this.isInsideGrid(re,we,De,Re)||!A&&this.grid.hitTest(re,we,De,Re,j)||Ye?{box:[],offscreen:!1,occluded:Se.occluded}:{box:[re,we,De,Re],offscreen:this.isOffscreen(re,we,De,Re),occluded:!1}}placeCollisionCircles(a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se){const ke=[],re=this.transform.elevation,we=a.getProjection(),De=re?re.getAtTileOffsetFunc(Se,this.transform.center.lat,this.transform.worldSize,we):null,Re=new r.Point(v.tileAnchorX,v.tileAnchorY);let{x:Ye,y:We,z:Ke}=we.projectTilePoint(Re.x,Re.y,Se.canonical);if(De){const[Ot,Xt,kt]=De(Re);Ye+=Ot,We+=Xt,Ke+=kt}const lt=we.name==="globe",ot=this.projectAndGetPerspectiveRatio(z,Ye,We,Ke,Se,lt||!!re||this.transform.pitch>0,we),{perspectiveRatio:_t}=ot,Wt=(ne?R/_t:R*_t)/r.ONE_EM,pt=ar(Ye,We,Ke,j),Lt=ot.signedDistanceFromCamera>0?Up(Wt,A,v.lineOffsetX*Wt,v.lineOffsetY*Wt,!1,pt,Re,v,S,j,{},re&&!ne?De:null,ne&&!!re,we,Se,ne):null;let wt=!1,qt=!1,dt=!0;if(Lt&&!ot.occluded){const Ot=.5*Te*_t+Ae,Xt=new r.Point(-100,-100),kt=new r.Point(this.screenRightBoundary,this.screenBottomBoundary),Jt=new uh,{first:Pi,last:$i}=Lt,wi=Pi.path.length;let Li=[];for(let Ci=wi-1;Ci>=1;Ci--)Li.push(Pi.path[Ci]);for(let Ci=1;Ci<$i.path.length;Ci++)Li.push($i.path[Ci]);const Zi=2.5*Ot;Z&&(Li=Li.map(([Ci,Rn,Un],Vn)=>(De&&!lt&&(Un=De(Vn<wi-1?Pi.tilePath[wi-1-Vn]:$i.tilePath[Vn-wi+2])[2]),ar(Ci,Rn,Un,Z))),Li.some(Ci=>Ci[3]<=0)&&(Li=[]));let Yi=[];if(Li.length>0){let Ci=1/0,Rn=-1/0,Un=1/0,Vn=-1/0;for(const jn of Li)Ci=Math.min(Ci,jn[0]),Un=Math.min(Un,jn[1]),Rn=Math.max(Rn,jn[0]),Vn=Math.max(Vn,jn[1]);Rn>=Xt.x&&Ci<=kt.x&&Vn>=Xt.y&&Un<=kt.y&&(Yi=[Li.map(jn=>new r.Point(jn[0],jn[1]))],(Ci<Xt.x||Rn>kt.x||Un<Xt.y||Vn>kt.y)&&(Yi=r.clipLine(Yi,Xt.x,Xt.y,kt.x,kt.y)))}for(const Ci of Yi){Jt.reset(Ci,.25*Ot);let Rn=0;Rn=Jt.length<=.5*Ot?1:Math.ceil(Jt.paddedLength/Zi)+1;for(let Un=0;Un<Rn;Un++){const Vn=Un/Math.max(Rn-1,1),jn=Jt.lerp(Vn),Mr=jn.x+Wr,ur=jn.y+Wr;ke.push(Mr,ur,Ot,0);const _o=Mr-Ot,Bn=ur-Ot,ns=Mr+Ot,Xn=ur+Ot;if(dt=dt&&this.isOffscreen(_o,Bn,ns,Xn),qt=qt||this.isInsideGrid(_o,Bn,ns,Xn),!f&&this.grid.hitTestCircle(Mr,ur,Ot,ge)&&(wt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:wt,occluded:!1}}}}return{circles:!Y&&wt||!qt?[]:ke,offscreen:dt,collisionDetected:wt,occluded:ot.occluded}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let v=1/0,S=1/0,A=-1/0,R=-1/0;for(const Y of a){const ne=new r.Point(Y.x+Wr,Y.y+Wr);v=Math.min(v,ne.x),S=Math.min(S,ne.y),A=Math.max(A,ne.x),R=Math.max(R,ne.y),f.push(ne)}const z=this.grid.query(v,S,A,R).concat(this.ignoredGrid.query(v,S,A,R)),j={},Z={};for(const Y of z){const ne=Y.key;if(j[ne.bucketInstanceId]===void 0&&(j[ne.bucketInstanceId]={}),j[ne.bucketInstanceId][ne.featureIndex])continue;const ge=[new r.Point(Y.x1,Y.y1),new r.Point(Y.x2,Y.y1),new r.Point(Y.x2,Y.y2),new r.Point(Y.x1,Y.y2)];r.polygonIntersectsPolygon(f,ge)&&(j[ne.bucketInstanceId][ne.featureIndex]=!0,Z[ne.bucketInstanceId]===void 0&&(Z[ne.bucketInstanceId]=[]),Z[ne.bucketInstanceId].push(ne.featureIndex))}return Z}insertCollisionBox(a,f,v,S,A){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:S,collisionGroupID:A},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,f,v,S,A){const R=f?this.ignoredGrid:this.grid,z={bucketInstanceId:v,featureIndex:S,collisionGroupID:A};for(let j=0;j<a.length;j+=4)R.insertCircle(z,a[j],a[j+1],a[j+2])}projectAndGetPerspectiveRatio(a,f,v,S,A,R,z){const j=[f,v,S,1];let Z=!1;S||this.transform.pitch>0?(r.transformMat4$1(j,j,a),this.fogState&&A&&z.name!=="globe"&&(Z=function(ge,Te,Ae,Se,ke,re){const we=re.calculateFogTileMatrix(ke),De=[Te,Ae,Se];return r.transformMat4(De,De,we),Pt(ge,De,re.pitch,re._fov)}(this.fogState,f,v,S,A.toUnwrapped(),this.transform)>.9)):nn(j,j,a);const Y=j[3];return{point:new r.Point((j[0]/Y+1)/2*this.transform.width+Wr,(-j[1]/Y+1)/2*this.transform.height+Wr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:R&&j[2]>Y||Z}}isOffscreen(a,f,v,S){return v<Wr||a>=this.screenRightBoundary||S<Wr||f>this.screenBottomBoundary}isInsideGrid(a,f,v,S){return v>=0&&a<this.gridRightBoundary&&S>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const a=r.identity([]);return r.translate(a,a,[-100,-100,0]),a}}function zo(_,a,f){const v=a.createTileMatrix(_,_.worldSize,f.toUnwrapped());return r.multiply(new Float32Array(16),_.projMatrix,v)}function ho(_,a,f){if(a.projection.name===f.projection.name)return _.projMatrix;const v=f.clone();return v.setProjection(a.projection),zo(v,a.getProjection(),_)}function us(_,a,f){return a.name===f.projection.name?_.projMatrix:zo(f,a,_)}class Vp{constructor(a,f,v,S){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?f:-f))):S&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class Bo{constructor(a,f,v,S,A,R=!1){this.text=new Vp(a?a.text:null,f,v,A),this.icon=new Vp(a?a.icon:null,f,S,A),this.clipped=R}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class sl{constructor(a,f,v,S=!1){this.text=a,this.icon=f,this.skipFade=v,this.clipped=S}}class dh{constructor(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]}}class Wd{constructor(a,f,v,S,A){this.bucketInstanceId=a,this.featureIndex=f,this.sourceLayerIndex=v,this.bucketIndex=S,this.tileID=A}}class Gd{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const f=++this.maxGroupID;this.collisionGroups[a]={ID:f,predicate:v=>v.collisionGroupID===f}}return this.collisionGroups[a]}}function mc(_,a,f,v,S){const{horizontalAlign:A,verticalAlign:R}=r.getAnchorAlignment(_),z=-(A-.5)*a,j=-(R-.5)*f,Z=r.evaluateVariableOffset(_,v);return new r.Point(z+Z[0]*S,j+Z[1]*S)}function la(_,a,f,v,S){const A=new r.Point(_,a);return f&&A._rotate(v?S:-S),A}class gu{constructor(a,f,v,S,A){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new wr(this.transform,A),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Gd(v),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,f,v,S){const A=v.getBucket(f),R=v.latestFeatureIndex;if(!A||!R||f.id!==A.layerIds[0])return;const z=A.layers[0].layout,j=v.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),Y=v.tileSize/r.EXTENT,ne=v.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ge=(Te=v.tileID,Ae=A.getProjection(),Se=this.transform,Ae.name===this.projection?Se.calculateProjMatrix(Te.toUnwrapped()):zo(Se,Ae,Te));var Te,Ae,Se;const ke=z.get("text-pitch-alignment")==="map",re=z.get("text-rotation-alignment")==="map";f.compileFilter();const we=f.dynamicFilter(),De=f.dynamicFilterNeedsFeature(),Re=this.transform.calculatePixelsToTileUnitsMatrix(v),Ye=oa(ge,v.tileID.canonical,ke,re,this.transform,A.getProjection(),Re);let We=null;if(ke){const ot=$s(ge,v.tileID.canonical,ke,re,this.transform,A.getProjection(),Re);We=r.multiply([],this.transform.labelPlaneMatrix,ot)}let Ke=null;we&&v.latestFeatureIndex&&(Ke={unwrappedTileID:ne,dynamicFilter:we,dynamicFilterNeedsFeature:De,featureIndex:v.latestFeatureIndex}),this.retainedQueryData[A.bucketInstanceId]=new Wd(A.bucketInstanceId,R,A.sourceLayerIndex,A.index,v.tileID);const lt={bucket:A,layout:z,posMatrix:ge,textLabelPlaneMatrix:Ye,labelToScreenMatrix:We,clippingData:Ke,scale:Z,textPixelRatio:Y,holdingForFade:v.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(A.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.evaluateSizeForZoom(A.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(S)for(const ot of A.sortKeyRanges){const{sortKey:_t,symbolInstanceStart:Wt,symbolInstanceEnd:pt}=ot;a.push({sortKey:_t,symbolInstanceStart:Wt,symbolInstanceEnd:pt,parameters:lt})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:lt})}attemptAnchorPlacement(a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se,ke,re,we){const{textOffset0:De,textOffset1:Re,crossTileID:Ye}=ge,We=[De,Re],Ke=mc(a,v,S,We,A),lt=this.collisionIndex.placeCollisionBox(Ae,A,f,la(Ke.x,Ke.y,R,z,this.transform.angle),ne,j,Z,Y.predicate);if(ke){const ot=Ae.getSymbolInstanceIconSize(we,this.transform.zoom,ge.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Ae,ot,ke,la(Ke.x,Ke.y,R,z,this.transform.angle),ne,j,Z,Y.predicate).box.length===0)return}if(lt.box.length>0){let ot;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ye]&&this.prevPlacement.placements[Ye]&&this.prevPlacement.placements[Ye].text&&(ot=this.prevPlacement.variableOffsets[Ye].anchor),this.variableOffsets[Ye]={textOffset:We,width:v,height:S,anchor:a,textScale:A,prevAnchor:ot},this.markUsedJustification(Ae,a,ge,Se),Ae.allowVerticalPlacement&&(this.markUsedOrientation(Ae,Se,ge),this.placedOrientations[Ye]=Se),{shift:Ke,placedGlyphBoxes:lt}}}placeLayerBucketPart(a,f,v,S){const{bucket:A,layout:R,posMatrix:z,textLabelPlaneMatrix:j,labelToScreenMatrix:Z,clippingData:Y,textPixelRatio:ne,holdingForFade:ge,collisionBoxArray:Te,partiallyEvaluatedTextSize:Ae,partiallyEvaluatedIconSize:Se,collisionGroup:ke}=a.parameters,re=R.get("text-optional"),we=R.get("icon-optional"),De=R.get("text-allow-overlap"),Re=R.get("icon-allow-overlap"),Ye=R.get("text-rotation-alignment")==="map",We=R.get("text-pitch-alignment")==="map",Ke=R.get("icon-text-fit")!=="none",lt=R.get("symbol-z-order")==="viewport-y";this.transform.setProjection(A.projection);let ot=De&&(Re||!A.hasIconData()||we),_t=Re&&(De||!A.hasTextData()||re);!A.collisionArrays&&Te&&A.deserializeCollisionBoxes(Te),v&&S&&A.updateCollisionDebugBuffers(this.transform.zoom,Te);const Wt=(pt,Lt,wt)=>{const{crossTileID:qt,numVerticalGlyphVertices:dt}=pt;if(Y){const ns={zoom:this.transform.zoom,pitch:this.transform.pitch};let Xn=null;if(Y.dynamicFilterNeedsFeature){const yn=this.retainedQueryData[A.bucketInstanceId];Xn=Y.featureIndex.loadFeature({featureIndex:pt.featureIndex,bucketIndex:yn.bucketIndex,sourceLayerIndex:yn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Y.dynamicFilter)(ns,Xn,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new r.Point(pt.tileAnchorX,pt.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[qt]=new sl(!1,!1,!1,!0),void f.add(qt)}if(f.has(qt))return;if(ge)return void(this.placements[qt]=new sl(!1,!1,!1));let Ot=!1,Xt=!1,kt=!0,Jt=!1,Pi=!1,$i=null,wi={box:null,offscreen:null,occluded:null},Li={box:null},Zi=null,Yi=null,Ci=null,Rn=0,Un=0,Vn=0;wt.textFeatureIndex?Rn=wt.textFeatureIndex:pt.useRuntimeCollisionCircles&&(Rn=pt.featureIndex),wt.verticalTextFeatureIndex&&(Un=wt.verticalTextFeatureIndex);const jn=ns=>{ns.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const Xn=this.transform.elevation;(Xn||ns.elevation)&&(ns.elevation=Xn?Xn.getAtTileOffset(ns.tileID,ns.tileAnchorX,ns.tileAnchorY):0)},Mr=wt.textBox;if(Mr){jn(Mr);const ns=yn=>{let Ws=r.WritingMode.horizontal;if(A.allowVerticalPlacement&&!yn&&this.prevPlacement){const Rr=this.prevPlacement.placedOrientations[qt];Rr&&(this.placedOrientations[qt]=Rr,Ws=Rr,this.markUsedOrientation(A,Ws,pt))}return Ws},Xn=(yn,Ws)=>{if(A.allowVerticalPlacement&&dt>0&&wt.verticalTextBox){for(const Rr of A.writingModes)if(Rr===r.WritingMode.vertical?(wi=Ws(),Li=wi):wi=yn(),wi&&wi.box&&wi.box.length)break}else wi=yn()};if(R.get("text-variable-anchor")){let yn=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[qt]){const ss=this.prevPlacement.variableOffsets[qt];yn.indexOf(ss.anchor)>0&&(yn=yn.filter(Qs=>Qs!==ss.anchor),yn.unshift(ss.anchor))}const Ws=(ss,Qs,$u)=>{const Va=A.getSymbolInstanceTextSize(Ae,pt,this.transform.zoom,Lt),zc=(ss.x2-ss.x1)*Va+2*ss.padding,pa=(ss.y2-ss.y1)*Va+2*ss.padding,ja=Ke&&!Re?Qs:null;ja&&jn(ja);let $l={box:[],offscreen:!1,occluded:!1};const Is=De?2*yn.length:yn.length;for(let Rh=0;Rh<Is;++Rh){const Tf=this.attemptAnchorPlacement(yn[Rh%yn.length],ss,zc,pa,Va,Ye,We,ne,z,ke,Rh>=yn.length,pt,Lt,A,$u,ja,Ae,Se);if(Tf&&($l=Tf.placedGlyphBoxes,$l&&$l.box&&$l.box.length)){Ot=!0,$i=Tf.shift;break}}return $l};Xn(()=>Ws(Mr,wt.iconBox,r.WritingMode.horizontal),()=>{const ss=wt.verticalTextBox;return ss&&jn(ss),A.allowVerticalPlacement&&!(wi&&wi.box&&wi.box.length)&&dt>0&&ss?Ws(ss,wt.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),wi&&(Ot=wi.box,kt=wi.offscreen,Jt=wi.occluded);const Rr=ns(!(!wi||!wi.box));if(!Ot&&this.prevPlacement){const ss=this.prevPlacement.variableOffsets[qt];ss&&(this.variableOffsets[qt]=ss,this.markUsedJustification(A,ss.anchor,pt,Rr))}}else{const yn=(Ws,Rr)=>{const ss=A.getSymbolInstanceTextSize(Ae,pt,this.transform.zoom,Lt),Qs=this.collisionIndex.placeCollisionBox(A,ss,Ws,new r.Point(0,0),De,ne,z,ke.predicate);return Qs&&Qs.box&&Qs.box.length&&(this.markUsedOrientation(A,Rr,pt),this.placedOrientations[qt]=Rr),Qs};Xn(()=>yn(Mr,r.WritingMode.horizontal),()=>{const Ws=wt.verticalTextBox;return A.allowVerticalPlacement&&dt>0&&Ws?(jn(Ws),yn(Ws,r.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),ns(!!(wi&&wi.box&&wi.box.length))}}if(Zi=wi,Ot=Zi&&Zi.box&&Zi.box.length>0,kt=Zi&&Zi.offscreen,Jt=Zi&&Zi.occluded,pt.useRuntimeCollisionCircles){const ns=A.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex>=0?pt.centerJustifiedTextSymbolIndex:pt.verticalPlacedTextSymbolIndex),Xn=r.evaluateSizeForFeature(A.textSizeData,Ae,ns),yn=R.get("text-padding");Yi=this.collisionIndex.placeCollisionCircles(A,De,ns,A.lineVertexArray,A.glyphOffsetArray,Xn,z,j,Z,v,We,ke.predicate,pt.collisionCircleDiameter*Xn/r.ONE_EM,yn,this.retainedQueryData[A.bucketInstanceId].tileID),Ot=De||Yi.circles.length>0&&!Yi.collisionDetected,kt=kt&&Yi.offscreen,Jt=Yi.occluded}if(wt.iconFeatureIndex&&(Vn=wt.iconFeatureIndex),wt.iconBox){const ns=Xn=>{jn(Xn);const yn=Ke&&$i?la($i.x,$i.y,Ye,We,this.transform.angle):new r.Point(0,0),Ws=A.getSymbolInstanceIconSize(Se,this.transform.zoom,pt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,Ws,Xn,yn,Re,ne,z,ke.predicate)};Li&&Li.box&&Li.box.length&&wt.verticalIconBox?(Ci=ns(wt.verticalIconBox),Xt=Ci.box.length>0):(Ci=ns(wt.iconBox),Xt=Ci.box.length>0),kt=kt&&Ci.offscreen,Pi=Ci.occluded}const ur=re||pt.numHorizontalGlyphVertices===0&&dt===0,_o=we||pt.numIconVertices===0;if(ur||_o?_o?ur||(Xt=Xt&&Ot):Ot=Xt&&Ot:Xt=Ot=Xt&&Ot,Ot&&Zi&&Zi.box&&this.collisionIndex.insertCollisionBox(Zi.box,R.get("text-ignore-placement"),A.bucketInstanceId,Li&&Li.box&&Un?Un:Rn,ke.ID),Xt&&Ci&&this.collisionIndex.insertCollisionBox(Ci.box,R.get("icon-ignore-placement"),A.bucketInstanceId,Vn,ke.ID),Yi&&(Ot&&this.collisionIndex.insertCollisionCircles(Yi.circles,R.get("text-ignore-placement"),A.bucketInstanceId,Rn,ke.ID),v)){const ns=A.bucketInstanceId;let Xn=this.collisionCircleArrays[ns];Xn===void 0&&(Xn=this.collisionCircleArrays[ns]=new dh);for(let yn=0;yn<Yi.circles.length;yn+=4)Xn.circles.push(Yi.circles[yn+0]),Xn.circles.push(Yi.circles[yn+1]),Xn.circles.push(Yi.circles[yn+2]),Xn.circles.push(Yi.collisionDetected?1:0)}const Bn=A.projection.name!=="globe";ot=ot&&(Bn||!Jt),_t=_t&&(Bn||!Pi),this.placements[qt]=new sl(Ot||ot,Xt||_t,kt||A.justReloaded),f.add(qt)};if(lt){const pt=A.getSortedSymbolIndexes(this.transform.angle);for(let Lt=pt.length-1;Lt>=0;--Lt){const wt=pt[Lt];Wt(A.symbolInstances.get(wt),wt,A.collisionArrays[wt])}}else for(let pt=a.symbolInstanceStart;pt<a.symbolInstanceEnd;pt++)Wt(A.symbolInstances.get(pt),pt,A.collisionArrays[pt]);if(v&&A.bucketInstanceId in this.collisionCircleArrays){const pt=this.collisionCircleArrays[A.bucketInstanceId];r.invert(pt.invProjMatrix,z),pt.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(a,f,v,S){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:j,crossTileID:Z}=v,Y=r.getAnchorJustification(f),ne=S===r.WritingMode.vertical?j:Y==="left"?A:Y==="center"?R:Y==="right"?z:-1;A>=0&&(a.text.placedSymbolArray.get(A).crossTileID=ne>=0&&A!==ne?0:Z),R>=0&&(a.text.placedSymbolArray.get(R).crossTileID=ne>=0&&R!==ne?0:Z),z>=0&&(a.text.placedSymbolArray.get(z).crossTileID=ne>=0&&z!==ne?0:Z),j>=0&&(a.text.placedSymbolArray.get(j).crossTileID=ne>=0&&j!==ne?0:Z)}markUsedOrientation(a,f,v){const S=f===r.WritingMode.horizontal||f===r.WritingMode.horizontalOnly?f:0,A=f===r.WritingMode.vertical?f:0,{leftJustifiedTextSymbolIndex:R,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:j,verticalPlacedTextSymbolIndex:Z}=v,Y=a.text.placedSymbolArray;R>=0&&(Y.get(R).placedOrientation=S),z>=0&&(Y.get(z).placedOrientation=S),j>=0&&(Y.get(j).placedOrientation=S),Z>=0&&(Y.get(Z).placedOrientation=A)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let v=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const S=f?f.symbolFadeChange(a):1,A=f?f.opacities:{},R=f?f.variableOffsets:{},z=f?f.placedOrientations:{};for(const j in this.placements){const Z=this.placements[j],Y=A[j];Y?(this.opacities[j]=new Bo(Y,S,Z.text,Z.icon,null,Z.clipped),v=v||Z.text!==Y.text.placed||Z.icon!==Y.icon.placed):(this.opacities[j]=new Bo(null,S,Z.text,Z.icon,Z.skipFade,Z.clipped),v=v||Z.text||Z.icon)}for(const j in A){const Z=A[j];if(!this.opacities[j]){const Y=new Bo(Z,S,!1,!1);Y.isHidden()||(this.opacities[j]=Y,v=v||Z.text.placed||Z.icon.placed)}}for(const j in R)this.variableOffsets[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.variableOffsets[j]=R[j]);for(const j in z)this.placedOrientations[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.placedOrientations[j]=z[j]);v?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:a)}updateLayerOpacities(a,f){const v=new Set;for(const S of f){const A=S.getBucket(a);A&&S.latestFeatureIndex&&a.id===A.layerIds[0]&&this.updateBucketOpacities(A,v,S.collisionBoxArray)}}updateBucketOpacities(a,f,v){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const S=a.layers[0].layout,A=!!a.layers[0].dynamicFilter(),R=new Bo(null,0,!1,!1,!0),z=S.get("text-allow-overlap"),j=S.get("icon-allow-overlap"),Z=S.get("text-variable-anchor"),Y=S.get("text-rotation-alignment")==="map",ne=S.get("text-pitch-alignment")==="map",ge=S.get("icon-text-fit")!=="none",Te=new Bo(null,0,z&&(j||!a.hasIconData()||S.get("icon-optional")),j&&(z||!a.hasTextData()||S.get("text-optional")),!0);!a.collisionArrays&&v&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(v);const Ae=(ke,re,we)=>{for(let De=0;De<re/4;De++)ke.opacityVertexArray.emplaceBack(we)};let Se=0;for(let ke=0;ke<a.symbolInstances.length;ke++){const re=a.symbolInstances.get(ke),{numHorizontalGlyphVertices:we,numVerticalGlyphVertices:De,crossTileID:Re,numIconVertices:Ye}=re,We=f.has(Re);let Ke=this.opacities[Re];We?Ke=R:Ke||(Ke=Te,this.opacities[Re]=Ke),f.add(Re);const lt=we>0||De>0,ot=Ye>0,_t=this.placedOrientations[Re],Wt=_t===r.WritingMode.vertical,pt=_t===r.WritingMode.horizontal||_t===r.WritingMode.horizontalOnly;if(!lt&&!ot||Ke.isHidden()||Se++,lt){const Lt=qr(Ke.text);Ae(a.text,we,Wt?As:Lt),Ae(a.text,De,pt?As:Lt);const wt=Ke.text.isHidden(),{leftJustifiedTextSymbolIndex:qt,centerJustifiedTextSymbolIndex:dt,rightJustifiedTextSymbolIndex:Ot,verticalPlacedTextSymbolIndex:Xt}=re,kt=a.text.placedSymbolArray,Jt=wt||Wt?1:0;qt>=0&&(kt.get(qt).hidden=Jt),dt>=0&&(kt.get(dt).hidden=Jt),Ot>=0&&(kt.get(Ot).hidden=Jt),Xt>=0&&(kt.get(Xt).hidden=wt||pt?1:0);const Pi=this.variableOffsets[Re];Pi&&this.markUsedJustification(a,Pi.anchor,re,_t);const $i=this.placedOrientations[Re];$i&&(this.markUsedJustification(a,"left",re,$i),this.markUsedOrientation(a,$i,re))}if(ot){const Lt=qr(Ke.icon),{placedIconSymbolIndex:wt,verticalPlacedIconSymbolIndex:qt}=re,dt=a.icon.placedSymbolArray,Ot=Ke.icon.isHidden()?1:0;wt>=0&&(Ae(a.icon,Ye,Wt?As:Lt),dt.get(wt).hidden=Ot),qt>=0&&(Ae(a.icon,re.numVerticalIconVertices,pt?As:Lt),dt.get(qt).hidden=Ot)}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Lt=a.collisionArrays[ke];if(Lt){let wt=new r.Point(0,0),qt=!0;if(Lt.textBox||Lt.verticalTextBox){if(Z){const Ot=this.variableOffsets[Re];Ot?(wt=mc(Ot.anchor,Ot.width,Ot.height,Ot.textOffset,Ot.textScale),Y&&wt._rotate(ne?this.transform.angle:-this.transform.angle)):qt=!1}A&&(qt=!Ke.clipped),Lt.textBox&&Pa(a.textCollisionBox.collisionVertexArray,Ke.text.placed,!qt||Wt,wt.x,wt.y),Lt.verticalTextBox&&Pa(a.textCollisionBox.collisionVertexArray,Ke.text.placed,!qt||pt,wt.x,wt.y)}const dt=qt&&!!(!pt&&Lt.verticalIconBox);Lt.iconBox&&Pa(a.iconCollisionBox.collisionVertexArray,Ke.icon.placed,dt,ge?wt.x:0,ge?wt.y:0),Lt.verticalIconBox&&Pa(a.iconCollisionBox.collisionVertexArray,Ke.icon.placed,!dt,ge?wt.x:0,ge?wt.y:0)}}}if(a.fullyClipped=Se===0,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=ke.invProjMatrix,a.placementViewportMatrix=ke.viewportMatrix,a.collisionCircleArray=ke.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,f){const v=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*v>a}setStale(){this.stale=!0}}function Pa(_,a,f,v,S){_.emplaceBack(a?1:0,f?1:0,v||0,S||0),_.emplaceBack(a?1:0,f?1:0,v||0,S||0),_.emplaceBack(a?1:0,f?1:0,v||0,S||0),_.emplaceBack(a?1:0,f?1:0,v||0,S||0)}const Gr=Math.pow(2,25),Os=Math.pow(2,24),Hd=Math.pow(2,17),fh=Math.pow(2,16),Hr=Math.pow(2,9),Or=Math.pow(2,8),qd=Math.pow(2,1);function qr(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const a=_.placed?1:0,f=Math.floor(127*_.opacity);return f*Gr+a*Os+f*Hd+a*fh+f*Hr+a*Or+f*qd+a}const As=0;class La{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(a,f,v,S,A){const R=this._bucketParts;for(;this._currentTileIndex<a.length;)if(f.getBucketParts(R,S,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((z,j)=>z.sortKey-j.sortKey));this._currentPartIndex<R.length;){const z=R[this._currentPartIndex];if(f.placeLayerBucketPart(z,this._seenCrossTileIDs,v,z.symbolInstanceStart===0),this._currentPartIndex++,A())return!0}return!1}}class ph{constructor(a,f,v,S,A,R,z,j){this.placement=new gu(a,A,R,z,j),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(a,f,v){const S=r.exported.now(),A=()=>{const R=r.exported.now()-S;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=f[a[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=z)&&(!R.maxzoom||R.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new La(R)),this._inProgressLayer.continuePlacement(v[R.source],this.placement,this._showCollisionBoxes,R,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const Da=512/r.EXTENT/2;class lr{constructor(a,f,v){this.tileID=a,this.bucketInstanceId=v,this.index=new r.KDBush(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=a.canonical.x*r.EXTENT,A=a.canonical.y*r.EXTENT;for(let R=0;R<f.length;R++){const{key:z,crossTileID:j,tileAnchorX:Z,tileAnchorY:Y}=f.get(R),ne=Math.floor((S+Z)*Da),ge=Math.floor((A+Y)*Da);this.index.add(ne,ge),this.keys.push(z),this.crossTileIDs.push(j)}this.index.finish()}findMatches(a,f,v){const S=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),A=Da/Math.pow(2,f.canonical.z-this.tileID.canonical.z),R=f.canonical.x*r.EXTENT,z=f.canonical.y*r.EXTENT;for(let j=0;j<a.length;j++){const Z=a.get(j);if(Z.crossTileID)continue;const{key:Y,tileAnchorX:ne,tileAnchorY:ge}=Z,Te=Math.floor((R+ne)*A),Ae=Math.floor((z+ge)*A),Se=this.index.range(Te-S,Ae-S,Te+S,Ae+S);for(const ke of Se){const re=this.crossTileIDs[ke];if(this.keys[ke]===Y&&!v.has(re)){v.add(re),Z.crossTileID=re;break}}}}}class _u{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const f=Math.round((a-this.lng)/360);if(f!==0)for(const v in this.indexes){const S=this.indexes[v],A={};for(const R in S){const z=S[R];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+f),A[z.tileID.key]=z}this.indexes[v]=A}this.lng=a}addBucket(a,f,v){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let A=0;A<f.symbolInstances.length;A++)f.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]=new Set);const S=this.usedCrossTileIDs[a.overscaledZ];for(const A in this.indexes){const R=this.indexes[A];if(Number(A)>a.overscaledZ)for(const z in R){const j=R[z];j.tileID.isChildOf(a)&&j.findMatches(f.symbolInstances,a,S)}else{const z=R[a.scaledTo(Number(A)).key];z&&z.findMatches(f.symbolInstances,a,S)}}for(let A=0;A<f.symbolInstances.length;A++){const R=f.symbolInstances.get(A);R.crossTileID||(R.crossTileID=v.generate(),S.add(R.crossTileID))}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new lr(a,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(a,f){for(const v of f.crossTileIDs)this.usedCrossTileIDs[a].delete(v)}removeStaleBuckets(a){let f=!1;for(const v in this.indexes){const S=this.indexes[v];for(const A in S)a[S[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,S[A]),delete S[A],f=!0)}return f}}class Oa{constructor(){this.layerIndexes={},this.crossTileIDs=new _u,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,f,v,S){let A=this.layerIndexes[a.id];A===void 0&&(A=this.layerIndexes[a.id]=new Xd);let R=!1;const z={};S.name!=="globe"&&A.handleWrapJump(v);for(const j of f){const Z=j.getBucket(a);Z&&a.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(j.tileID,Z,this.crossTileIDs)&&(R=!0),z[Z.bucketInstanceId]=!0)}return A.removeStaleBuckets(z)&&(R=!0),R}pruneUnusedLayers(a){const f={};a.forEach(v=>{f[v]=!0});for(const v in this.layerIndexes)f[v]||delete this.layerIndexes[v]}}const Ra=(_,a)=>r.emitValidationErrors(_,a&&a.filter(f=>f.identifier!=="source.canvas")),gc=r.pick(kn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),_c=r.pick(kn,["setCenter","setZoom","setBearing","setPitch"]),Fo={version:8,layers:[],sources:{}},za={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ca extends r.Evented{constructor(a,f={}){super(),this.map=a,this.dispatcher=new Ni(Ds(),this),this.imageManager=new Qe,this.imageManager.setEventedParent(this),this.glyphManager=new r.GlyphManager(a._requestManager,f.localFontFamily?r.LocalGlyphMode.all:f.localIdeographFontFamily?r.LocalGlyphMode.ideographs:r.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new Oa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());const v=this;this._rtlTextPluginCallback=ca.registerForPluginStateChange(S=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(A,R)=>{if(r.triggerPluginCompletionEvent(A),R&&R.every(z=>z))for(const z in v._sourceCaches){const j=v._sourceCaches[z],Z=j.getSource().type;Z!=="vector"&&Z!=="geojson"||j.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const A=this.getSource(S.sourceId);if(A&&A.vectorLayerIds)for(const R in this._layers){const z=this._layers[R];z.source===A.id&&this._validateLayer(z)}})}loadURL(a,f={}){this.fire(new r.Event("dataloading",{dataType:"style"}));const v=typeof f.validate=="boolean"?f.validate:!r.isMapboxURL(a);a=this.map._requestManager.normalizeStyleURL(a,f.accessToken);const S=this.map._requestManager.transformRequest(a,r.ResourceType.Style);this._request=r.getJSON(S,(A,R)=>{this._request=null,A?this.fire(new r.ErrorEvent(A)):R&&this._load(R,v)})}loadJSON(a,f={}){this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.exported.frame(()=>{this._request=null,this._load(a,f.validate!==!1)})}loadEmpty(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(Fo,!1)}_updateLayerCount(a,f){const v=f?1:-1;a.is3D()&&(this._num3DLayers+=v),a.type==="circle"&&(this._numCircleLayers+=v),a.type==="symbol"&&(this._numSymbolLayers+=v)}_load(a,f){if(f&&Ra(this,r.validateStyle(a)))return;this._loaded=!0,this.stylesheet=r.clone$1(a),this._updateMapProjection();for(const S in a.sources)this.addSource(S,a.sources[S],{validate:!1});this._changed=!1,a.sprite?this._loadSprite(a.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(a.glyphs);const v=Fp(this.stylesheet.layers);this._order=v.map(S=>S.id),this._layers={},this._serializedLayers={};for(const S of v){const A=r.createStyleLayer(S);A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Tt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(a){this._spriteRequest=function(f,v,S){let A,R,z;const j=r.exported.devicePixelRatio>1?"@2x":"";let Z=r.getJSON(v.transformRequest(v.normalizeSpriteURL(f,j,".json"),r.ResourceType.SpriteJSON),(ge,Te)=>{Z=null,z||(z=ge,A=Te,ne())}),Y=r.getImage(v.transformRequest(v.normalizeSpriteURL(f,j,".png"),r.ResourceType.SpriteImage),(ge,Te)=>{Y=null,z||(z=ge,R=Te,ne())});function ne(){if(z)S(z);else if(A&&R){const ge=r.exported.getImageData(R),Te={};for(const Ae in A){const{width:Se,height:ke,x:re,y:we,sdf:De,pixelRatio:Re,stretchX:Ye,stretchY:We,content:Ke}=A[Ae],lt=new r.RGBAImage({width:Se,height:ke});r.RGBAImage.copy(ge,lt,{x:re,y:we},{x:0,y:0},{width:Se,height:ke}),Te[Ae]={data:lt,pixelRatio:Re,sdf:De,stretchX:Ye,stretchY:We,content:Ke}}S(null,Te)}}return{cancel(){Z&&(Z.cancel(),Z=null),Y&&(Y.cancel(),Y=null)}}}(a,this.map._requestManager,(f,v)=>{if(this._spriteRequest=null,f)this.fire(new r.ErrorEvent(f));else if(v)for(const S in v)this.imageManager.addImage(S,v[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new r.Event("data",{dataType:"style"}))})}_validateLayer(a){const f=this.getSource(a.source);if(!f)return;const v=a.sourceLayer;v&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(v)===-1)&&this.fire(new r.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${f.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(a){const f=[];for(const v of a){const S=this._layers[v];S.type!=="custom"&&f.push(S.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(a){return!!this.terrain&&(typeof a.isLayerDraped=="function"?a.isLayerDraped():za[a.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(a){if(!this._loaded)return;const f=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),A=Object.keys(this._removedLayers);(S.length||A.length)&&this._updateWorkerLayers(S,A);for(const R in this._updatedSources){const z=this._updatedSources[R];z==="reload"?this._reloadSource(R):z==="clear"&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(a);this.light.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this._resetUpdates()}const v={};for(const S in this._sourceCaches){const A=this._sourceCaches[S];v[S]=A.used,A.used=!1}for(const S of this._order){const A=this._layers[S];if(A.recalculate(a,this._availableImages),!A.isHidden(a.zoom)){const z=this._getLayerSourceCache(A);z&&(z.used=!0)}const R=this.map.painter;if(R){const z=A.getProgramIds();if(!z)continue;const j=A.getProgramConfiguration(a.zoom);for(const Z of z)R.useProgram(Z,j)}}for(const S in v){const A=this._sourceCaches[S];v[S]!==A.used&&A.getSource().fire(new r.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A.getSource().id}))}this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new r.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateWorkerLayers(a,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(a){if(this._checkLoaded(),Ra(this,r.validateStyle(a)))return!1;(a=r.clone$1(a)).layers=Fp(a.layers);const f=function(S,A){if(!S)return[{command:kn.setStyle,args:[A]}];let R=[];try{if(!C(S.version,A.version))return[{command:kn.setStyle,args:[A]}];C(S.center,A.center)||R.push({command:kn.setCenter,args:[A.center]}),C(S.zoom,A.zoom)||R.push({command:kn.setZoom,args:[A.zoom]}),C(S.bearing,A.bearing)||R.push({command:kn.setBearing,args:[A.bearing]}),C(S.pitch,A.pitch)||R.push({command:kn.setPitch,args:[A.pitch]}),C(S.sprite,A.sprite)||R.push({command:kn.setSprite,args:[A.sprite]}),C(S.glyphs,A.glyphs)||R.push({command:kn.setGlyphs,args:[A.glyphs]}),C(S.transition,A.transition)||R.push({command:kn.setTransition,args:[A.transition]}),C(S.light,A.light)||R.push({command:kn.setLight,args:[A.light]}),C(S.fog,A.fog)||R.push({command:kn.setFog,args:[A.fog]}),C(S.projection,A.projection)||R.push({command:kn.setProjection,args:[A.projection]});const z={},j=[];(function(ne,ge,Te,Ae){let Se;for(Se in ge=ge||{},ne=ne||{})ne.hasOwnProperty(Se)&&(ge.hasOwnProperty(Se)||hh(Se,Te,Ae));for(Se in ge){if(!ge.hasOwnProperty(Se))continue;const ke=ge[Se];ne.hasOwnProperty(Se)?C(ne[Se],ke)||(ne[Se].type==="geojson"&&ke.type==="geojson"&&pu(ne,ge,Se)?Te.push({command:kn.setGeoJSONSourceData,args:[Se,ke.data]}):fu(Se,ge,Te,Ae)):jd(Se,ge,Te)}})(S.sources,A.sources,j,z);const Z=[];S.layers&&S.layers.forEach(ne=>{ne.source&&z[ne.source]?R.push({command:kn.removeLayer,args:[ne.id]}):Z.push(ne)});let Y=S.terrain;Y&&z[Y.source]&&(R.push({command:kn.setTerrain,args:[void 0]}),Y=void 0),R=R.concat(j),C(Y,A.terrain)||R.push({command:kn.setTerrain,args:[A.terrain]}),function(ne,ge,Te){ge=ge||[];const Ae=(ne=ne||[]).map(sa),Se=ge.map(sa),ke=ne.reduce($d,{}),re=ge.reduce($d,{}),we=Ae.slice(),De=Object.create(null);let Re,Ye,We,Ke,lt,ot,_t;for(Re=0,Ye=0;Re<Ae.length;Re++)We=Ae[Re],re.hasOwnProperty(We)?Ye++:(Te.push({command:kn.removeLayer,args:[We]}),we.splice(we.indexOf(We,Ye),1));for(Re=0,Ye=0;Re<Se.length;Re++)We=Se[Se.length-1-Re],we[we.length-1-Re]!==We&&(ke.hasOwnProperty(We)?(Te.push({command:kn.removeLayer,args:[We]}),we.splice(we.lastIndexOf(We,we.length-Ye),1)):Ye++,ot=we[we.length-Re],Te.push({command:kn.addLayer,args:[re[We],ot]}),we.splice(we.length-Re,0,We),De[We]=!0);for(Re=0;Re<Se.length;Re++)if(We=Se[Re],Ke=ke[We],lt=re[We],!De[We]&&!C(Ke,lt))if(C(Ke.source,lt.source)&&C(Ke["source-layer"],lt["source-layer"])&&C(Ke.type,lt.type)){for(_t in Ro(Ke.layout,lt.layout,Te,We,null,kn.setLayoutProperty),Ro(Ke.paint,lt.paint,Te,We,null,kn.setPaintProperty),C(Ke.filter,lt.filter)||Te.push({command:kn.setFilter,args:[We,lt.filter]}),C(Ke.minzoom,lt.minzoom)&&C(Ke.maxzoom,lt.maxzoom)||Te.push({command:kn.setLayerZoomRange,args:[We,lt.minzoom,lt.maxzoom]}),Ke)Ke.hasOwnProperty(_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?Ro(Ke[_t],lt[_t],Te,We,_t.slice(6),kn.setPaintProperty):C(Ke[_t],lt[_t])||Te.push({command:kn.setLayerProperty,args:[We,_t,lt[_t]]}));for(_t in lt)lt.hasOwnProperty(_t)&&!Ke.hasOwnProperty(_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?Ro(Ke[_t],lt[_t],Te,We,_t.slice(6),kn.setPaintProperty):C(Ke[_t],lt[_t])||Te.push({command:kn.setLayerProperty,args:[We,_t,lt[_t]]}))}else Te.push({command:kn.removeLayer,args:[We]}),ot=we[we.lastIndexOf(We)+1],Te.push({command:kn.addLayer,args:[lt,ot]})}(Z,A.layers,R)}catch(z){console.warn("Unable to compute style diff:",z),R=[{command:kn.setStyle,args:[A]}]}return R}(this.serialize(),a).filter(S=>!(S.command in _c));if(f.length===0)return!1;const v=f.filter(S=>!(S.command in gc));if(v.length>0)throw new Error(`Unimplemented: ${v.map(S=>S.command).join(", ")}.`);return f.forEach(S=>{S.command!=="setTransition"&&S.command!=="setProjection"&&this[S.command].apply(this,S.args)}),this.stylesheet=a,this._updateMapProjection(),!0}addImage(a,f){return this.getImage(a)?this.fire(new r.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(a,f),this._afterImageUpdated(a),this)}updateImage(a,f){this.imageManager.updateImage(a,f)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a),this._afterImageUpdated(a),this):this.fire(new r.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(a,f,v={}){if(this._checkLoaded(),this.getSource(a)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(r.validateSource,`sources.${a}`,f,null,v))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const S=cn(a,f,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(a),source:S.serialize(),sourceId:a}));const A=R=>{const z=(R?"symbol:":"other:")+a,j=this._sourceCaches[z]=new r.SourceCache(z,S,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[a]=j,j.style=this,j.onAdd(this.map)};A(!1),f.type!=="vector"&&f.type!=="geojson"||A(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(a){this._checkLoaded();const f=this.getSource(a);if(!f)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===a)return this.fire(new r.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===a)return this.fire(new r.ErrorEvent(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));const v=this._getSourceCaches(a);for(const S of v)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(a,f){this._checkLoaded(),this.getSource(a).setData(f),this._changed=!0}getSource(a){const f=this._getSourceCache(a);return f&&f.getSource()}_getSources(){const a=[];for(const f in this._otherSourceCaches){const v=this._getSourceCache(f);v&&a.push(v.getSource())}return a}addLayer(a,f,v={}){this._checkLoaded();const S=a.id;if(this.getLayer(S))return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let A;if(a.type==="custom"){if(Ra(this,r.validateCustomStyleLayer(a)))return;A=r.createStyleLayer(a)}else{if(typeof a.source=="object"&&(this.addSource(S,a.source),a=r.clone$1(a),a=r.extend(a,{source:S})),this._validate(r.validateLayer,`layers.${S}`,a,{arrayIndex:-1},v))return;A=r.createStyleLayer(a),this._validateLayer(A),A.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}const R=f?this._order.indexOf(f):this._order.length;if(f&&R===-1)return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(R,0,S),this._layerOrderChanged=!0,this._layers[S]=A;const z=this._getLayerSourceCache(A);if(this._removedLayers[S]&&A.source&&z&&A.type!=="custom"){const j=this._removedLayers[S];delete this._removedLayers[S],j.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",z.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(a,f){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===f)return;const v=this._order.indexOf(a);this._order.splice(v,1);const S=f?this._order.indexOf(f):this._order.length;f&&S===-1?this.fire(new r.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(S,0,a),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(a){this._checkLoaded();const f=this._layers[a];if(!f)return void this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const v=this._order.indexOf(a);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=f,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}hasLayerType(a){for(const f in this._layers)if(this._layers[f].type===a)return!0;return!1}setLayerZoomRange(a,f,v){this._checkLoaded();const S=this.getLayer(a);S?S.minzoom===f&&S.maxzoom===v||(f!=null&&(S.minzoom=f),v!=null&&(S.maxzoom=v),this._updateLayer(S)):this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(a,f,v={}){this._checkLoaded();const S=this.getLayer(a);if(S){if(!C(S.filter,f))return f==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(r.validateFilter,`layers.${S.id}.filter`,f,{layerType:S.type},v)||(S.filter=r.clone$1(f),this._updateLayer(S)))}else this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be filtered.`)))}getFilter(a){const f=this.getLayer(a);return f&&r.clone$1(f.filter)}setLayoutProperty(a,f,v,S={}){this._checkLoaded();const A=this.getLayer(a);A?C(A.getLayoutProperty(f),v)||(A.setLayoutProperty(f,v,S),this._updateLayer(A)):this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(a,f){const v=this.getLayer(a);if(v)return v.getLayoutProperty(f);this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style.`)))}setPaintProperty(a,f,v,S={}){this._checkLoaded();const A=this.getLayer(a);A?C(A.getPaintProperty(f),v)||(A.setPaintProperty(f,v,S)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new r.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(a,f){const v=this.getLayer(a);return v&&v.getPaintProperty(f)}setFeatureState(a,f){this._checkLoaded();const v=a.source,S=a.sourceLayer,A=this.getSource(v);if(!A)return void this.fire(new r.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const R=A.type;if(R==="geojson"&&S)return void this.fire(new r.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(R==="vector"&&!S)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));a.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided.")));const z=this._getSourceCaches(v);for(const j of z)j.setFeatureState(S,a.id,f)}removeFeatureState(a,f){this._checkLoaded();const v=a.source,S=this.getSource(v);if(!S)return void this.fire(new r.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const A=S.type,R=A==="vector"?a.sourceLayer:void 0;if(A==="vector"&&!R)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof a.id!="string"&&typeof a.id!="number")return void this.fire(new r.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const z=this._getSourceCaches(v);for(const j of z)j.removeFeatureState(R,a.id,f)}getFeatureState(a){this._checkLoaded();const f=a.source,v=a.sourceLayer,S=this.getSource(f);if(S){if(S.type!=="vector"||v)return a.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(v,a.id);this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const a={};for(const f in this._sourceCaches){const v=this._sourceCaches[f].getSource();a[v.id]||(a[v.id]=v.serialize())}return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:a,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(a){this._updatedLayers[a.id]=!0;const f=this._getLayerSourceCache(a);a.source&&!this._updatedSources[a.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",f.pause()),this._changed=!0,a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const f=R=>this._layers[R].type==="fill-extrusion",v={},S=[];for(let R=this._order.length-1;R>=0;R--){const z=this._order[R];if(f(z)){v[z]=R;for(const j of a){const Z=j[z];if(Z)for(const Y of Z)S.push(Y)}}}S.sort((R,z)=>z.intersectionZ-R.intersectionZ);const A=[];for(let R=this._order.length-1;R>=0;R--){const z=this._order[R];if(f(z))for(let j=S.length-1;j>=0;j--){const Z=S[j].feature;if(v[Z.layer.id]<R)break;A.push(Z),S.pop()}else for(const j of a){const Z=j[z];if(Z)for(const Y of Z)A.push(Y.feature)}}return A}queryRenderedFeatures(a,f,v){f&&f.filter&&this._validate(r.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const S={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new r.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const j of f.layers){const Z=this._layers[j];if(!Z)return this.fire(new r.ErrorEvent(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];S[Z.source]=!0}}const A=[];f.availableImages=this._availableImages;const R=f&&f.layers?f.layers.some(j=>{const Z=this.getLayer(j);return Z&&Z.is3D()}):this.has3DLayers(),z=An.createFromScreenPoints(a,v);for(const j in this._sourceCaches){const Z=this._sourceCaches[j].getSource().id;f.layers&&!S[Z]||A.push(ys(this._sourceCaches[j],this._layers,this._serializedLayers,z,f,v,R,!!this.map._showQueryGeometry))}return this.placement&&A.push(function(j,Z,Y,ne,ge,Te,Ae){const Se={},ke=Te.queryRenderedSymbols(ne),re=[];for(const we of Object.keys(ke).map(Number))re.push(Ae[we]);re.sort(mr);for(const we of re){const De=we.featureIndex.lookupSymbolFeatures(ke[we.bucketInstanceId],Z,we.bucketIndex,we.sourceLayerIndex,ge.filter,ge.layers,ge.availableImages,j);for(const Re in De){const Ye=Se[Re]=Se[Re]||[],We=De[Re];We.sort((Ke,lt)=>{const ot=we.featureSortOrder;if(ot){const _t=ot.indexOf(Ke.featureIndex);return ot.indexOf(lt.featureIndex)-_t}return lt.featureIndex-Ke.featureIndex});for(const Ke of We)Ye.push(Ke)}}for(const we in Se)Se[we].forEach(De=>{const Re=De.feature,Ye=Y(j[we]);if(!Ye)return;const We=Ye.getFeatureState(Re.layer["source-layer"],Re.id);Re.source=Re.layer.source,Re.layer["source-layer"]&&(Re.sourceLayer=Re.layer["source-layer"]),Re.state=We});return Se}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),z.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(a,f){f&&f.filter&&this._validate(r.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const v=this._getSourceCaches(a);let S=[];for(const A of v)S=S.concat(Cs(A,f));return S}addSourceType(a,f,v){return ca.getSourceType(a)?v(new Error(`A source type called "${a}" already exists.`)):(ca.setSourceType(a,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:f.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(a,f={}){this._checkLoaded();const v=this.light.getLight();let S=!1;for(const R in a)if(!C(a[R],v[R])){S=!0;break}if(!S)return;const A=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(a,f),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(a,f=1){if(this._checkLoaded(),!a)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let v=a;if(f===1){if(typeof v.source=="object"){const S="terrain-dem-src";this.addSource(S,v.source),v=r.clone$1(v),v=r.extend(v,{source:S})}if(this._validate(r.validateTerrain,"terrain",v))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode){if(!v)return;this._createTerrain(v,f)}else{const S=this.terrain,A=S.get();for(const R of Object.keys(r.spec.terrain))!v.hasOwnProperty(R)&&r.spec.terrain[R].default&&(v[R]=r.spec.terrain[R].default);for(const R in v)if(!C(v[R],A[R])){S.set(v),this.stylesheet.terrain=v;const z=this._setTransitionParameters({duration:0});S.updateTransitions(z);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const f=this.fog=new pn(a,this.map.transform);this.stylesheet.fog=a;const v=this._setTransitionParameters({duration:0});f.updateTransitions(v)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,v=f.get();Object.keys(a).length===0&&f.set(a);for(const S in a)if(!C(a[S],v[S])){f.set(a),this.stylesheet.fog=a;const A=this._setTransitionParameters({duration:0});f.updateTransitions(A);break}}else this._createFog(a);this._markersNeedUpdate=!0}_setTransitionParameters(a){return{now:r.exported.now(),transition:r.extend(a,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const a=this._order.filter(v=>this.isLayerDraped(this._layers[v])),f=this._order.filter(v=>!this.isLayerDraped(this._layers[v]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...f)}_createTerrain(a,f){const v=this.terrain=new St(a,f);this.stylesheet.terrain=a,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});v.updateTransitions(S)}_force3DLayerUpdate(){for(const a in this._layers){const f=this._layers[a];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const f=this._layers[a];f.type==="symbol"&&this._updateLayer(f)}}_validate(a,f,v,S,A={}){return(!A||A.validate!==!1)&&Ra(this,a.call(r.validateStyle,r.extend({key:f,style:this.serialize(),value:v,styleSpec:r.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this._sourceCaches)this._sourceCaches[a].clearTiles(),this._sourceCaches[a].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(a){const f=this._getSourceCaches(a);for(const v of f)v.clearTiles()}_reloadSource(a){const f=this._getSourceCaches(a);for(const v of f)v.resume(),v.reload()}_reloadSources(){for(const a of this._getSources())a.reload&&a.reload()}_updateSources(a){for(const f in this._sourceCaches)this._sourceCaches[f].update(a)}_generateCollisionBoxes(){for(const a in this._sourceCaches){const f=this._sourceCaches[a];f.resume(),f.reload()}}_updatePlacement(a,f,v,S,A=!1){let R=!1,z=!1;const j={};for(const Z of this._order){const Y=this._layers[Z];if(Y.type!=="symbol")continue;if(!j[Y.source]){const ge=this._getLayerSourceCache(Y);if(!ge)continue;j[Y.source]=ge.getRenderableIds(!0).map(Te=>ge.getTileByID(Te)).sort((Te,Ae)=>Ae.tileID.overscaledZ-Te.tileID.overscaledZ||(Te.tileID.isLessThan(Ae.tileID)?-1:1))}const ne=this.crossTileSymbolIndex.addLayer(Y,j[Y.source],a.center.lng,a.projection);R=R||ne}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),A=A||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new r.Event("neworder")),(A||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.exported.now(),a.zoom))&&(this.pauseablePlacement=new ph(a,this._order,A,f,v,S,this.placement,this.fog&&a.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,j),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.exported.now()),z=!0),R&&this.pauseablePlacement.placement.setStale()),z||R)for(const Z of this._order){const Y=this._layers[Z];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,j[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.exported.now())}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,f,v){this.imageManager.getImages(f.icons,v),this._updateTilesForChangedImages();const S=A=>{A&&A.setDependencies(f.tileID.key,f.type,f.icons)};S(this._otherSourceCaches[f.source]),S(this._symbolSourceCaches[f.source])}getGlyphs(a,f,v){this.glyphManager.getGlyphs(f.stacks,v)}getResource(a,f,v){return r.makeRequest(f,v)}_getSourceCache(a){return this._otherSourceCaches[a]}_getLayerSourceCache(a){return a.type==="symbol"?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}_getSourceCaches(a){const f=[];return this._otherSourceCaches[a]&&f.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&f.push(this._symbolSourceCaches[a]),f}_isSourceCacheLoaded(a){const f=this._getSourceCaches(a);return f.length===0?(this.fire(new r.ErrorEvent(new Error(`There is no source with ID '${a}'`))),!1):f.every(v=>v.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ca.getSourceType=function(_){return Xi[_]},ca.setSourceType=function(_,a){Xi[_]=a},ca.registerForPluginStateChange=r.registerForPluginStateChange;var Zd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Al="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ha=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,ks=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,cr=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let mh={},yc={};const xc=[];uo(Zd,xc),uo(ha,xc),uo(ks,xc),uo(cr,xc),mh=Cn("",ha),yc=Cn(cr,ks);const vc=Cn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),yu=Zd,bc=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var xu={background:Cn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Cn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Cn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Cn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Cn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Cn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Cn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Cn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Cn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Cn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Cn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Cn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Cn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Cn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Cn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Cn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Cn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Cn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Cn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Cn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Cn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Cn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Cn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Cn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Cn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Cn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Al),skyboxGradient:Cn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Al),skyboxCapture:Cn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Cn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Cn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function uo(_,a){const f=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let v of f)if(v=v.trim(),v[0]==="#"&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=v.split(" ");for(const A of S)a.includes(A)||a.push(A)}}function Cn(_,a){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=a.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},A=[...xc];return uo(_,A),uo(a,A),{fragmentSource:_=_.replace(f,(R,z,j,Z,Y)=>(S[Y]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
varying ${j} ${Z} ${Y};
#else
uniform ${j} ${Z} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${j} ${Z} ${Y} = u_${Y};
#endif
`)),vertexSource:a=a.replace(f,(R,z,j,Z,Y)=>{const ne=Z==="float"?"vec2":"vec4",ge=Y.match(/color/)?"color":ne;return S[Y]?z==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${j} ${ne} a_${Y};
varying ${j} ${Z} ${Y};
#else
uniform ${j} ${Z} u_${Y};
#endif
`:ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${j} ${Z} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${ge}(a_${Y}, u_${Y}_t);
#else
    ${j} ${Z} ${Y} = u_${Y};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${j} ${ne} a_${Y};
#else
uniform ${j} ${Z} u_${Y};
#endif
`:ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${j} ${Z} ${Y} = a_${Y};
#else
    ${j} ${Z} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${j} ${Z} ${Y} = unpack_mix_${ge}(a_${Y}, u_${Y}_t);
#else
    ${j} ${Z} ${Y} = u_${Y};
#endif
`}),staticAttributes:v,usedDefines:A}}class Ig{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,f,v,S,A,R,z){this.context=a;let j=this.boundPaintVertexBuffers.length!==S.length;for(let Y=0;!j&&Y<S.length;Y++)this.boundPaintVertexBuffers[Y]!==S[Y]&&(j=!0);let Z=this.boundDynamicVertexBuffers.length!==z.length;for(let Y=0;!Z&&Y<z.length;Y++)this.boundDynamicVertexBuffers[Y]!==z[Y]&&(Z=!0);if(!a.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==v||j||Z||this.boundIndexBuffer!==A||this.boundVertexOffset!==R)this.freshBind(f,v,S,A,R,z);else{a.bindVertexArrayOES.set(this.vao);for(const Y of z)Y&&Y.bind();A&&A.dynamicDraw&&A.bind()}}freshBind(a,f,v,S,A,R){let z;const j=a.numAttributes,Z=this.context,Y=Z.gl;if(Z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Z.extVertexArrayObject.createVertexArrayOES(),Z.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=a,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=S,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=R;else{z=Z.currentNumAttributes||0;for(let ne=j;ne<z;ne++)Y.disableVertexAttribArray(ne)}f.enableAttributes(Y,a),f.bind(),f.setVertexAttribPointers(Y,a,A);for(const ne of v)ne.enableAttributes(Y,a),ne.bind(),ne.setVertexAttribPointers(Y,a,A);for(const ne of R)ne&&(ne.enableAttributes(Y,a),ne.bind(),ne.setVertexAttribPointers(Y,a,A));S&&S.bind(),Z.currentNumAttributes=j}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function kl(_,a){const f=Math.pow(2,a.canonical.z),v=a.canonical.y;return[new r.MercatorCoordinate(0,v/f).toLngLat().lat,new r.MercatorCoordinate(0,(v+1)/f).toLngLat().lat]}function Yd(_,a,f,v,S,A,R){const z=_.context,j=z.gl,Z=f.fbo;if(!Z)return;_.prepareDrawTile();const Y=_.useProgram("hillshade");z.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,Z.colorAttachment.get());const ne=((Se,ke,re,we)=>{const De=re.paint.get("hillshade-shadow-color"),Re=re.paint.get("hillshade-highlight-color"),Ye=re.paint.get("hillshade-accent-color");let We=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(We-=Se.transform.angle);const Ke=!Se.options.moving;return{u_matrix:we||Se.transform.calculateProjMatrix(ke.tileID.toUnwrapped(),Ke),u_image:0,u_latrange:kl(0,ke.tileID),u_light:[re.paint.get("hillshade-exaggeration"),We],u_shadow:De,u_highlight:Re,u_accent:Ye}})(_,f,v,_.terrain?a.projMatrix:null);_.prepareDrawProgram(z,Y,a.toUnwrapped());const{tileBoundsBuffer:ge,tileBoundsIndexBuffer:Te,tileBoundsSegments:Ae}=_.getTileBoundsBuffers(f);Y.draw(z,j.TRIANGLES,S,A,R,r.CullFaceMode.disabled,ne,v.id,ge,Te,Ae)}function vu(_,a,f){if(!a.needsDEMTextureUpload)return;const v=_.context,S=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||_.getTileTexture(f.stride);const A=f.getPixels();a.demTexture?a.demTexture.update(A,{premultiply:!1}):a.demTexture=new r.Texture(v,A,S.RGBA,{premultiply:!1}),a.needsDEMTextureUpload=!1}function bu(_,a,f,v,S,A){const R=_.context,z=R.gl;if(!a.dem)return;const j=a.dem;if(R.activeTexture.set(z.TEXTURE1),vu(_,a,j),!a.demTexture)return;a.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);const Z=j.dim;R.activeTexture.set(z.TEXTURE0);let Y=a.fbo;if(!Y){const Ae=new r.Texture(R,{width:Z,height:Z,data:null},z.RGBA);Ae.bind(z.LINEAR,z.CLAMP_TO_EDGE),Y=a.fbo=R.createFramebuffer(Z,Z,!0),Y.colorAttachment.set(Ae.texture)}R.bindFramebuffer.set(Y.framebuffer),R.viewport.set([0,0,Z,Z]);const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:ge,tileBoundsSegments:Te}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(R,z.TRIANGLES,v,S,A,r.CullFaceMode.disabled,((Ae,Se)=>{const ke=Se.stride,re=r.create();return r.ortho(re,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(re,re,[0,-r.EXTENT,0]),{u_matrix:re,u_image:1,u_dimension:[ke,ke],u_zoom:Ae.overscaledZ,u_unpack:Se.unpackVector}})(a.tileID,j),f.id,ne,ge,Te),a.needsHillshadePrepare=!1}const wu=_=>({u_matrix:new r.UniformMatrix4f(_),u_image0:new r.Uniform1i(_),u_skirt_height:new r.Uniform1f(_)}),rl=(_,a)=>({u_matrix:_,u_image0:0,u_skirt_height:a}),Tu=(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:f,u_zoom_transition:S,u_merc_center:A,u_image0:0,u_frustum_tl:R,u_frustum_tr:z,u_frustum_br:j,u_frustum_bl:Z,u_globe_pos:Y,u_globe_radius:ne,u_viewport:ge,u_grid_matrix:Ae?Float32Array.from(Ae):new Float32Array(9),u_skirt_height:Te});function Il(_,a){return _!=null&&a!=null&&!(!_.hasData()||!a.hasData())&&_.demTexture!=null&&a.demTexture!=null&&_.tileID.key!==a.tileID.key}const No=new class{constructor(){this.operations={}}newMorphing(_,a,f,v,S){if(_ in this.operations){const A=this.operations[_];A.to.tileID.key!==f.tileID.key&&(A.queued=f)}else this.operations[_]={startTime:v,phase:0,duration:S,from:a,to:f,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const a=this.operations[_];return{from:a.from,to:a.to,phase:a.phase}}update(_){for(const a in this.operations){const f=this.operations[a];for(f.phase=(_-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,_)){delete this.operations[a];break}}}_nextOp(_,a){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=a,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Pl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Eu(_){return 6*Math.pow(1.5,22-_)}function jp(_,a){const f=1<<_.z;return!a&&(_.x===0||_.x===f-1)||_.y===0||_.y===f-1}const gh=_=>({u_matrix:_});function Kd(_,a,f,v,S){if(S>0){const A=r.exported.now(),R=(A-_.timeAdded)/S,z=a?(A-a.timeAdded)/S:-1,j=f.getSource(),Z=v.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),Y=!a||Math.abs(a.tileID.overscaledZ-Z)>Math.abs(_.tileID.overscaledZ-Z),ne=Y&&_.refreshedUponExpiration?1:r.clamp(Y?R:1-z,0,1);return _.refreshedUponExpiration&&R>=1&&(_.refreshedUponExpiration=!1),a?{opacity:1,mix:1-ne}:{opacity:ne,mix:0}}return{opacity:1,mix:0}}class _h extends r.SourceCache{constructor(a){const f={type:"raster-dem",maxzoom:a.transform.maxZoom},v=new Ni(Ds(),null),S=cn("mock-dem",f,v,a.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,f){a.state="loaded",f(null)}}class Su extends r.SourceCache{constructor(a){const f=cn("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},new Ni(Ds(),null),a.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,f,v){if(a.freezeTileCoverage)return;this.transform=a;const S=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,R)=>{if(A[R.key]="",!this._tiles[R.key]){const z=new r.Tile(R,this._source.tileSize*R.overscaleFactor(),a.tileZoom);z.state="loaded",this._tiles[R.key]=z}return A},{});for(const A in this._tiles)A in S||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(a){const f=this.proxyCachedFBO[a];if(f!==void 0){const v=Object.values(f);this.renderCachePool.push(...v),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mu extends r.OverscaledTileID{constructor(a,f,v){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=f,this.projMatrix=v}}class Jd extends r.Elevation{constructor(a,f){super(),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,S,A]=function(j){const Z=new r.StructArrayLayout2i4,Y=new r.StructArrayLayout3ui6,ne=131;Z.reserve(17161),Y.reserve(33800);const ge=r.EXTENT/128,Te=r.EXTENT+ge/2,Ae=Te+ge;for(let ke=-ge;ke<Ae;ke+=ge)for(let re=-ge;re<Ae;re+=ge){const we=re<0||re>Te||ke<0||ke>Te?24575:0,De=r.clamp(Math.round(re),0,r.EXTENT),Re=r.clamp(Math.round(ke),0,r.EXTENT);Z.emplaceBack(De+we,Re)}const Se=(ke,re)=>{const we=re*ne+ke;Y.emplaceBack(we+1,we,we+ne),Y.emplaceBack(we+ne,we+ne+1,we+1)};for(let ke=1;ke<129;ke++)for(let re=1;re<129;re++)Se(re,ke);return[0,129].forEach(ke=>{for(let re=0;re<130;re++)Se(re,ke),Se(ke,re)}),[Z,Y,32768]}(),R=a.context;this.gridBuffer=R.createVertexBuffer(v,r.posAttributes.members),this.gridIndexBuffer=R.createIndexBuffer(S),this.gridSegments=r.SegmentVector.simpleSegment(0,0,v.length,S.length),this.gridNoSkirtSegments=r.SegmentVector.simpleSegment(0,0,v.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Su(f.map),this.orthoMatrix=r.create(),r.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.EXTENT,0,r.EXTENT,0,1);const z=R.gl;this._overlapStencilMode=new r.StencilMode({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new _h(f.map)}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),a.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=a,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(a,f,v){if(a&&a.terrain){this._style!==a&&(this.style=a),this.enabled=!0;const S=a.terrain.properties;this.sourceCache=a.terrain.drapeRenderMode===0?this._mockSourceCache:a._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const A=()=>{this.sourceCache.used&&r.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.getScaledDemTileSize();this.sourceCache.update(f,R,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,A(),this._initializing=!0),A(),f.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const a=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||a.efficiency!==100&&r.warnOnce(`Terrain render cache efficiency is not optimal (${a.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${a.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(a){a.coord&&a.dataType==="source"?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):a.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._sourceCaches)this._style._sourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=v._centerAltitude===0&&this.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(v.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=f.getIds().map(j=>{const Z=f.getTileByID(j).tileID;return Z.projMatrix=v.calculateProjMatrix(Z.toUnwrapped()),Z});(function(j,Z){const Y=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),ne=new r.Point(Y.x,Y.y);j.sort((ge,Te)=>{if(Te.overscaledZ-ge.overscaledZ)return Te.overscaledZ-ge.overscaledZ;const Ae=new r.Point(ge.canonical.x+(1<<ge.canonical.z)*ge.wrap,ge.canonical.y),Se=new r.Point(Te.canonical.x+(1<<Te.canonical.z)*Te.wrap,Te.canonical.y),ke=ne.mult(1<<ge.canonical.z);return ke.x-=.5,ke.y-=.5,ke.distSqr(Ae)-ke.distSqr(Se)})})(S,this.painter),this._previousZoom=v.zoom;const A=this.proxyToSource||{};this.proxyToSource={},S.forEach(j=>{this.proxyToSource[j.key]={}}),this.terrainTileForTile={};const R=this._style._sourceCaches;for(const j in R){const Z=R[j];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,a[j],A),Z.usedForTerrain))continue;const Y=a[j];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[f.id]=S.map(j=>new Mu(j,j.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1,this._updateTimestamp=r.exported.now();const z={};this._visibleDemTiles=[];for(const j of this.proxyCoords){const Z=this.terrainTileForTile[j.key];if(!Z)continue;const Y=Z.tileID.key;Y in z||(this._visibleDemTiles.push(Z),z[Y]=Y)}}_assignTerrainTiles(a){this._initializing||a.forEach(f=>{if(this.terrainTileForTile[f.key])return;const v=this._findTileCoveringTileID(f,this.sourceCache);v&&(this.terrainTileForTile[f.key]=v)})}_prepareDEMTextures(){const a=this.painter.context,f=a.gl;for(const v in this.terrainTileForTile){const S=this.terrainTileForTile[v],A=S.dem;!A||S.demTexture&&!S.needsDEMTextureUpload||(a.activeTexture.set(f.TEXTURE1),vu(this.painter,S,A))}}_prepareDemTileUniforms(a,f,v,S){if(!f||f.demTexture==null)return!1;const A=a.tileID.canonical,R=Math.pow(2,f.tileID.canonical.z-A.z),z=S||"";return v[`u_dem_tl${z}`]=[A.x*R%1,A.y*R%1],v[`u_dem_scale${z}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const a=this.painter.context,f=a.gl;if(!this._emptyDepthBufferTexture){const v=new r.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.Texture(a,v,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let a=0;const f=this._visibleDemTiles.reduce((v,S)=>{if(!S.dem)return v;const A=S.dem.tree.minimums[0];return A>0&&a++,v+A},0);return a?f/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,f=a.gl;a.activeTexture.set(f.TEXTURE2);const v=this._getLoadedAreaMinimum(),S=new r.RGBAImage({width:1,height:1},new Uint8Array(r.DEMData.pack(v,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(S,{premultiply:!1}):A=this._emptyDEMTexture=new r.Texture(a,S,f.RGBA,{premultiply:!1}),A}setupElevationDraw(a,f,v){const S=this.painter.context,A=S.gl,R=(z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:r.DEMData.getUnpackVector(z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var z;R.u_dem_size=this.sourceCache.getSource().tileSize,R.u_exaggeration=this.exaggeration();let j=null,Z=null,Y=1;if(v&&v.morphing&&this._useVertexMorphing){const ne=v.morphing.srcDemTile,ge=v.morphing.dstDemTile;Y=v.morphing.phase,ne&&ge&&(this._prepareDemTileUniforms(a,ne,R,"_prev")&&(Z=ne),this._prepareDemTileUniforms(a,ge,R)&&(j=ge))}if(Z&&j?(S.activeTexture.set(A.TEXTURE2),j.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),S.activeTexture.set(A.TEXTURE4),Z.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),R.u_dem_lerp=Y):(j=this.terrainTileForTile[a.tileID.key],S.activeTexture.set(A.TEXTURE2),(this._prepareDemTileUniforms(a,j,R)?j.demTexture:this.emptyDEMTexture).bind(A.NEAREST,A.CLAMP_TO_EDGE)),S.activeTexture.set(A.TEXTURE3),v&&v.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),this._depthFBO&&(R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),R.u_depth_size_inv=[1,1]),v&&v.useMeterToDem&&j){const ne=(1<<j.tileID.canonical.z)*r.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=ne}if(v&&v.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),f.setTerrainUniformValues(S,R),this.painter.transform.projection.name==="globe"){const ne=this.globeUniformValues(this.painter.transform,a.tileID.canonical,v&&v.useDenormalizedUpVectorScale);f.setGlobeUniformValues(S,ne)}}globeUniformValues(a,f,v){const S=a.projection;return{u_tile_tl_up:S.upVector(f,0,0),u_tile_tr_up:S.upVector(f,r.EXTENT,0),u_tile_br_up:S.upVector(f,r.EXTENT,r.EXTENT),u_tile_bl_up:S.upVector(f,0,r.EXTENT),u_tile_up_scale:v?r.globeMetersToEcef(1):S.upVectorScale(f,a.center.lat,a.worldSize).metersToTile}}renderToBackBuffer(a){const f=this.painter,v=this.painter.context;a.length!==0&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,A,R,z,j){if(S.transform.projection.name==="globe")(function(Z,Y,ne,ge,Te){const Ae=Z.context,Se=Ae.gl;let ke,re;const we=Z.options.showTerrainWireframe?2:0,De=Z.transform,Re=r.globeUseCustomAntiAliasing(Z,Ae,De),Ye=(qt,dt)=>{if(re===qt)return;const Ot=[Pl[qt],"PROJECTION_GLOBE_VIEW"];Re&&Ot.push("CUSTOM_ANTIALIASING"),dt&&Ot.push(Pl[we]),ke=Z.useProgram("globeRaster",null,Ot),re=qt},We=Z.colorModeForRenderPass(),Ke=new r.DepthMode(Se.LEQUAL,r.DepthMode.ReadWrite,Z.depthRangeFor3D);No.update(Te);const lt=r.calculateGlobeMercatorMatrix(De),ot=[r.mercatorXfromLng(De.center.lng),r.mercatorYfromLat(De.center.lat)],_t=we?[!1,!0]:[!1],Wt=Z.globeSharedBuffers,pt=[De.width*r.exported.devicePixelRatio,De.height*r.exported.devicePixelRatio],Lt=Float32Array.from(De.globeMatrix),wt={useDenormalizedUpVectorScale:!0};if(_t.forEach(qt=>{const dt=Z.transform,Ot=Eu(dt.zoom)*Y.exaggeration();re=-1;const Xt=qt?Se.LINES:Se.TRIANGLES;for(const kt of ge){const Jt=ne.getTile(kt),Pi=r.StencilMode.disabled,$i=Y.prevTerrainTileForTile[kt.key],wi=Y.terrainTileForTile[kt.key];Il($i,wi)&&No.newMorphing(kt.key,$i,wi,Te,250),Ae.activeTexture.set(Se.TEXTURE0),Jt.texture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE);const Li=No.getMorphValuesForProxy(kt.key),Zi=Li?1:0;Li&&r.extend$1(wt,{morphing:{srcDemTile:Li.from,dstDemTile:Li.to,phase:r.easeCubicInOut(Li.phase)}});const Yi=r.tileCornersToBounds(kt.canonical),Ci=r.getLatitudinalLod(Yi.getCenter().lat),Rn=r.getGridMatrix(kt.canonical,Yi,Ci,dt.worldSize/dt._pixelsPerMercatorPixel),Un=r.globeNormalizeECEF(r.globeTileBounds(kt.canonical)),Vn=Tu(dt.projMatrix,Lt,lt,Un,r.globeToMercatorTransition(dt.zoom),ot,dt.frustumCorners.TL,dt.frustumCorners.TR,dt.frustumCorners.BR,dt.frustumCorners.BL,dt.globeCenterInViewSpace,dt.globeRadius,pt,Ot,Rn);if(Ye(Zi,qt),Y.setupElevationDraw(Jt,ke,wt),Z.prepareDrawProgram(Ae,ke,kt.toUnwrapped()),Wt){const[jn,Mr,ur]=qt?Wt.getWirefameBuffers(Z.context,Ci):Wt.getGridBuffers(Ci,Ot!==0);ke.draw(Ae,Xt,Ke,Pi,We,r.CullFaceMode.backCCW,Vn,"globe_raster",jn,Mr,ur)}}}),Wt){const qt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Re&&qt.push("CUSTOM_ANTIALIASING"),ke=Z.useProgram("globeRaster",null,qt);for(const dt of ge){const{x:Ot,y:Xt,z:kt}=dt.canonical,Jt=Xt===0,Pi=Xt===(1<<kt)-1,[$i,wi,Li,Zi]=Wt.getPoleBuffers(kt);if(Zi&&(Jt||Pi)){const Yi=ne.getTile(dt);Ae.activeTexture.set(Se.TEXTURE0),Yi.texture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE);let Ci=r.globePoleMatrixForTile(kt,Ot,De);const Rn=r.globeNormalizeECEF(r.globeTileBounds(dt.canonical)),Un=(Vn,jn)=>Vn.draw(Ae,Se.TRIANGLES,Ke,r.StencilMode.disabled,We,r.CullFaceMode.disabled,Tu(De.projMatrix,Ci,Ci,Rn,0,ot,De.frustumCorners.TL,De.frustumCorners.TR,De.frustumCorners.BR,De.frustumCorners.BL,De.globeCenterInViewSpace,De.globeRadius,pt,0),"globe_pole_raster",jn,Li,Zi);Y.setupElevationDraw(Yi,ke,wt),Z.prepareDrawProgram(Ae,ke,dt.toUnwrapped()),Jt&&Un(ke,$i),Pi&&(Ci=r.scale(r.create(),Ci,[1,-1,1]),Un(ke,wi))}}}})(S,A,R,z,j);else{const Z=S.context,Y=Z.gl;let ne,ge;const Te=S.options.showTerrainWireframe?2:0,Ae=(De,Re)=>{if(ge===De)return;const Ye=[Pl[De]];Re&&Ye.push(Pl[Te]),ne=S.useProgram("terrainRaster",null,Ye),ge=De},Se=S.colorModeForRenderPass(),ke=new r.DepthMode(Y.LEQUAL,r.DepthMode.ReadWrite,S.depthRangeFor3D);No.update(j);const re=S.transform,we=Eu(re.zoom)*A.exaggeration();(Te?[!1,!0]:[!1]).forEach(De=>{ge=-1;const Re=De?Y.LINES:Y.TRIANGLES,[Ye,We]=De?A.getWirefameBuffer():[A.gridIndexBuffer,A.gridSegments];for(const Ke of z){const lt=R.getTile(Ke),ot=r.StencilMode.disabled,_t=A.prevTerrainTileForTile[Ke.key],Wt=A.terrainTileForTile[Ke.key];Il(_t,Wt)&&No.newMorphing(Ke.key,_t,Wt,j,250),Z.activeTexture.set(Y.TEXTURE0),lt.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST);const pt=No.getMorphValuesForProxy(Ke.key),Lt=pt?1:0;let wt;pt&&(wt={morphing:{srcDemTile:pt.from,dstDemTile:pt.to,phase:r.easeCubicInOut(pt.phase)}});const qt=rl(Ke.projMatrix,jp(Ke.canonical,re.renderWorldCopies)?we/10:we);Ae(Lt,De),A.setupElevationDraw(lt,ne,wt),S.prepareDrawProgram(Z,ne,Ke.toUnwrapped()),ne.draw(Z,Re,ke,ot,Se,r.CullFaceMode.backCCW,qt,"terrain_raster",A.gridBuffer,Ye,We)}})}}(f,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(this._drapedRenderBatches.length===0)return a+1;this.renderingToTexture=!0;const f=this.painter,v=this.painter.context,S=this.proxySourceCache,A=this.proxiedCoords[S.id],R=this._drapedRenderBatches.shift(),z=[],j=f.style.order;let Z=0;for(const Y of A){const ne=S.getTileByID(Y.proxyTileKey),ge=S.proxyCachedFBO[Y.key]?S.proxyCachedFBO[Y.key][a]:void 0,Te=ge!==void 0?S.renderCache[ge]:this.pool[Z++],Ae=ge!==void 0;if(ne.texture=Te.tex,Ae&&!Te.dirty){z.push(ne.tileID);continue}let Se;v.bindFramebuffer.set(Te.fb.framebuffer),this.renderedToTile=!1,Te.dirty&&(v.clear({color:r.Color.transparent,stencil:0}),Te.dirty=!1);for(let ke=R.start;ke<=R.end;++ke){const re=f.style._layers[j[ke]];if(re.isHidden(f.transform.zoom))continue;const we=f.style._getLayerSourceCache(re),De=we?this.proxyToSource[Y.key][we.id]:[Y];if(!De)continue;const Re=De;v.viewport.set([0,0,Te.fb.width,Te.fb.height]),Se!==(we?we.id:null)&&(this._setupStencil(Te,De,re,we),Se=we?we.id:null),f.renderLayer(f,we,re,Re)}this.renderedToTile?(Te.dirty=!0,z.push(ne.tileID)):Ae||--Z,Z===5&&(Z=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,f.width,f.height]),R.end+1}postRender(){}renderCacheEfficiency(a){const f=a.order.length;if(f===0)return{efficiency:100};let v,S=0,A=0,R=!1;for(let z=0;z<f;++z){const j=a._layers[a.order[z]];this._style.isLayerDraped(j)?(R&&++S,++A):R||(R=!0,v=j.id)}return A===0?{efficiency:100}:{efficiency:100*(1-S/A),firstUndrapedLayer:v}}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{a=Math.min(a,f.dem.tree.minimums[0])}),a===0?a:(a-30)*this._exaggeration}raycast(a,f,v){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const R=A.tileID,z=1<<R.overscaledZ,{x:j,y:Z}=R.canonical,Y=j/z,ne=(j+1)/z,ge=Z/z,Te=(Z+1)/z;return{minx:Y,miny:ge,maxx:ne,maxy:Te,t:A.dem.tree.raycastRoot(Y,ge,ne,Te,a,f,v),tile:A}});S.sort((A,R)=>(A.t!==null?A.t:Number.MAX_VALUE)-(R.t!==null?R.t:Number.MAX_VALUE));for(const A of S){if(A.t==null)return null;const R=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,a,f,v);if(R!=null)return R}return null}_createFBO(){const a=this.painter.context,f=a.gl,v=this.drapeBufferSize;a.activeTexture.set(f.TEXTURE0);const S=new r.Texture(a,{width:v[0],height:v[1],data:null},f.RGBA);S.bind(f.LINEAR,f.CLAMP_TO_EDGE);const A=a.createFramebuffer(v[0],v[1],!1);return A.colorAttachment.set(S.texture),A.depthAttachment=new st(a,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&!a.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:A,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const a in this._style._sourceCaches)if(this._style._sourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{const f=this._style._layers[a],v=f.isHidden(this.painter.transform.zoom);return f.type==="custom"?!v&&f.shouldRedrape():!v&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let a=!1;for(const v of this._style._getSources())if(v instanceof hi){a=!0;break}if(!a)return;const f={};for(let v=0;v<this._style.order.length;++v){const S=this._style._layers[this._style.order[v]],A=this._style._getLayerSourceCache(S);if(A&&!f[A.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof r.ZoomDependentExpression){f[A.id]=!0;for(const R of this.proxyCoords){const z=this.proxyToSource[R.key][A.id];if(z)for(const j of z)this._clearRenderCacheForTile(A.id,j)}}}}_clearRasterLayersFromRenderCache(){let a=!1;for(const v in this._style._sourceCaches)if(this._style._sourceCaches[v]._source instanceof Kt){a=!0;break}if(!a)return;const f={};for(let v=0;v<this._style.order.length;++v){const S=this._style._layers[this._style.order[v]],A=this._style._getLayerSourceCache(S);if(!A||f[A.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const R=S.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const j=this.proxyToSource[z.key][A.id];if(j)for(const Z of j){const Y=Kd(A.getTile(Z),A.findLoadedParent(Z,0),A,this.painter.transform,R);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(A.id,Z)}}}}_setupDrapedRenderBatches(){const a=this._style.order,f=a.length;if(f===0)return;const v=[];let S,A=0,R=this._style._layers[a[A]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++A<f;)R=this._style._layers[a[A]];for(;A<f;++A){const z=this._style._layers[a[A]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?S===void 0&&(S=A):S!==void 0&&(v.push({start:S,end:A-1}),S=void 0))}S!==void 0&&v.push({start:S,end:A-1}),this._drapedRenderBatches=v}_setupRenderCache(a){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const R=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let z=0;z<R.length;++z){const j=Object.values(R[z]);f.renderCachePool.push(...j)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,S=this._tilesDirty;for(let R=v.length-1;R>=0;R--){const z=v[R];if(f.getTileByID(z.key),f.proxyCachedFBO[z.key]!==void 0){const j=a[z.key],Z=this.proxyToSource[z.key];let Y=0;for(const ne in Z){const ge=Z[ne],Te=j[ne];if(!Te||Te.length!==ge.length||ge.some((Ae,Se)=>Ae!==Te[Se]||S[ne]&&S[ne].hasOwnProperty(Ae.key))){Y=-1;break}++Y}for(const ne in f.proxyCachedFBO[z.key])f.renderCache[f.proxyCachedFBO[z.key][ne]].dirty=Y<0||Y!==Object.values(j).length}}const A=[...this._drapedRenderBatches];A.sort((R,z)=>z.end-z.start-(R.end-R.start));for(const R of A)for(const z of v){if(f.proxyCachedFBO[z.key])continue;let j=f.renderCachePool.pop();j===void 0&&f.renderCache.length<50&&(j=f.renderCache.length,f.renderCache.push(this._createFBO())),j!==void 0&&(f.proxyCachedFBO[z.key]={},f.proxyCachedFBO[z.key][R.start]=j,f.renderCache[j].dirty=!0)}this._tilesDirty={}}_setupStencil(a,f,v,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,R=A.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let z;if(v.isTileClipped())z=f.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):r.StencilMode.disabled}_renderTileClippingMasks(a,f){const v=this.painter,S=this.painter.context,A=S.gl;v._tileClippingMaskIDs={},S.setColorMode(r.ColorMode.disabled),S.setDepthMode(r.DepthMode.disabled);const R=v.useProgram("clippingMask");for(const z of a){const j=v._tileClippingMaskIDs[z.key]=--f;R.draw(S,A.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:A.ALWAYS,mask:0},j,255,A.KEEP,A.KEEP,A.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,gh(z.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(a){const f=this.painter.transform;if(a.x<0||a.x>f.width||a.y<0||a.y>f.height)return null;const v=[a.x,a.y,1,1];r.transformMat4$1(v,v,f.pixelMatrixInverse),r.scale$1(v,v,1/v[3]),v[0]/=f.worldSize,v[1]/=f.worldSize;const S=f._camera.position,A=r.mercatorZfromAltitude(1,f.center.lat),R=[S[0],S[1],S[2]/A,0],z=r.subtract([],v.slice(0,3),R);r.normalize(z,z);const j=this.raycast(R,z,this._exaggeration);return j!==null&&j?(r.scaleAndAdd(R,R,z,j),R[3]=R[2],R[2]*=A,R):null}drawDepth(){const a=this.painter,f=a.context,v=this.proxySourceCache,S=Math.ceil(a.width),A=Math.ceil(a.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===A||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const R=f.gl,z=f.createFramebuffer(S,A,!0);f.activeTexture.set(R.TEXTURE0);const j=new r.Texture(f,{width:S,height:A,data:null},R.RGBA);j.bind(R.NEAREST,R.CLAMP_TO_EDGE),z.colorAttachment.set(j.texture);const Z=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,S,A);z.depthAttachment.set(Z),this._depthFBO=z,this._depthTexture=j}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,S,A]),function(R,z,j,Z){if(R.transform.projection.name==="globe")return;const Y=R.context,ne=Y.gl;Y.clear({depth:1});const ge=R.useProgram("terrainDepth"),Te=new r.DepthMode(ne.LESS,r.DepthMode.ReadWrite,R.depthRangeFor3D);for(const Ae of Z){const Se=j.getTile(Ae),ke=rl(Ae.projMatrix,0);z.setupElevationDraw(Se,ge),ge.draw(Y,ne.TRIANGLES,Te,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.backCCW,ke,"terrain_depth",z.gridBuffer,z.gridIndexBuffer,z.gridNoSkirtSegments)}}(a,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(a,f,v){if(a.getSource()instanceof zi)return this._setupProxiedCoordsForImageSource(a,f,v);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const S=this.proxiedCoords[a.id]=[],A=this.proxyCoords;for(let z=0;z<A.length;z++){const j=A[z],Z=this._findTileCoveringTileID(j,a);if(Z){const Y=this._createProxiedId(j,Z,v[j.key]&&v[j.key][a.id]);S.push(Y),this.proxyToSource[j.key][a.id]=[Y]}}let R=!1;for(let z=0;z<f.length;z++){const j=a.getTile(f[z]);if(!j||!j.hasData())continue;const Z=this._findTileCoveringTileID(j.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==j.tileID.canonical.z){const Y=this.proxyToSource[Z.tileID.key][a.id],ne=this._createProxiedId(Z.tileID,j,v[Z.tileID.key]&&v[Z.tileID.key][a.id]);Y?Y.splice(Y.length-1,0,ne):this.proxyToSource[Z.tileID.key][a.id]=[ne],S.push(ne),R=!0}}this._sourceTilesOverlap[a.id]=R}_setupProxiedCoordsForImageSource(a,f,v){if(!a.getSource().loaded())return;const S=this.proxiedCoords[a.id]=[],A=this.proxyCoords,R=a.getSource(),z=new r.Point(R.tileID.x,R.tileID.y)._div(1<<R.tileID.z),j=R.coordinates.map(r.MercatorCoordinate.fromLngLat).reduce((Y,ne)=>(Y.min.x=Math.min(Y.min.x,ne.x-z.x),Y.min.y=Math.min(Y.min.y,ne.y-z.y),Y.max.x=Math.max(Y.max.x,ne.x-z.x),Y.max.y=Math.max(Y.max.y,ne.y-z.y),Y),{min:new r.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(Y,ne)=>{const ge=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),Te=Y.canonical.y/(1<<Y.canonical.z),Ae=r.EXTENT/(1<<Y.canonical.z),Se=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),ke=ne.canonical.y/(1<<ne.canonical.z);return ge+Ae<Se+j.min.x||ge>Se+j.max.x||Te+Ae<ke+j.min.y||Te>ke+j.max.y};for(let Y=0;Y<A.length;Y++){const ne=A[Y];for(let ge=0;ge<f.length;ge++){const Te=a.getTile(f[ge]);if(!Te||!Te.hasData()||Z(ne,Te.tileID))continue;const Ae=this._createProxiedId(ne,Te,v[ne.key]&&v[ne.key][a.id]),Se=this.proxyToSource[ne.key][a.id];Se?Se.push(Ae):this.proxyToSource[ne.key][a.id]=[Ae],S.push(Ae)}}}_createProxiedId(a,f,v){let S=this.orthoMatrix;if(v){const A=v.find(R=>R.key===f.tileID.key);if(A)return A}if(f.tileID.key!==a.key){const A=a.canonical.z-f.tileID.canonical.z;let R,z,j;S=r.create();const Z=f.tileID.wrap-a.wrap<<a.overscaledZ;A>0?(R=r.EXTENT>>A,z=R*((f.tileID.canonical.x<<A)-a.canonical.x+Z),j=R*((f.tileID.canonical.y<<A)-a.canonical.y)):(R=r.EXTENT<<-A,z=r.EXTENT*(f.tileID.canonical.x-(a.canonical.x+Z<<-A)),j=r.EXTENT*(f.tileID.canonical.y-(a.canonical.y<<-A))),r.ortho(S,0,R,0,R,0,1),r.translate(S,S,[z,j,0])}return new Mu(f.tileID,a.key,S)}_findTileCoveringTileID(a,f){let v=f.getTile(a);if(v&&v.hasData())return v;const S=this._findCoveringTileCache[f.id],A=S[a.key];if(v=A?f.getTileByID(A):null,v&&v.hasData()||A===null)return v;let R=v?v.tileID:a,z=R.overscaledZ;const j=f.getSource().minzoom,Z=[];if(!A){const ne=f.getSource().maxzoom;if(a.canonical.z>=ne){const ge=a.canonical.z-ne;f.getSource().reparseOverscaled?(z=Math.max(a.canonical.z+2,f.transform.tileZoom),R=new r.OverscaledTileID(z,a.wrap,ne,a.canonical.x>>ge,a.canonical.y>>ge)):ge!==0&&(z=ne,R=new r.OverscaledTileID(z,a.wrap,ne,a.canonical.x>>ge,a.canonical.y>>ge))}R.key!==a.key&&(Z.push(R.key),v=f.getTile(R))}const Y=ne=>{Z.forEach(ge=>{S[ge]=ne}),Z.length=0};for(z-=1;z>=j&&(!v||!v.hasData());z--){v&&Y(v.tileID.key);const ne=R.calculateScaledKey(z);if(v=f.getTileByID(ne),v&&v.hasData())break;const ge=S[ne];if(ge===null)break;ge===void 0?Z.push(ne):v=f.getTileByID(ge)}return Y(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,f){let v=this._tilesDirty[a];v||(v=this._tilesDirty[a]={}),v[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const a=function(f){let v=0;const S=new r.StructArrayLayout2ui4,A=131;for(let R=1;R<129;R++){for(let z=1;z<129;z++)v=R*A+z,S.emplaceBack(v,v+1),S.emplaceBack(v,v+A),S.emplaceBack(v+1,v+A),R===128&&S.emplaceBack(v+A,v+A+1);S.emplaceBack(v+1,v+1+A)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(a),this.wireframeSegments=r.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,a.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class _n{static cacheKey(a,f,v,S){let A=`${f}${S?S.cacheKey:""}`;for(const R of v)a.usedDefines.includes(R)&&(A+=`/${R}`);return A}constructor(a,f,v,S,A,R){const z=a.gl;this.program=z.createProgram();const j=function(re){const we=[];for(let De=0;De<re.length;De++){if(re[De]===null)continue;const Re=re[De].split(" ");we.push(Re.pop())}return we}(v.staticAttributes),Z=S?S.getBinderAttributes():[],Y=j.concat(Z);let ne=S?S.defines():[];ne=ne.concat(R.map(re=>`#define ${re}`));const ge=a.isWebGL2?`#version 300 es
`:"",Te=ge+ne.concat(a.extStandardDerivatives&&ge.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(bc):bc,bc,yu,vc.fragmentSource,yc.fragmentSource,v.fragmentSource).join(`
`),Ae=ge+ne.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,yu,vc.vertexSource,yc.vertexSource,mh.vertexSource,v.vertexSource).join(`
`),Se=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(Se,Te),z.compileShader(Se),z.attachShader(this.program,Se);const ke=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(ke,Ae),z.compileShader(ke),z.attachShader(this.program,ke),this.attributes={},this.numAttributes=Y.length;for(let re=0;re<this.numAttributes;re++)Y[re]&&(z.bindAttribLocation(this.program,re,Y[re]),this.attributes[Y[re]]=re);z.linkProgram(this.program),z.deleteShader(ke),z.deleteShader(Se),this.fixedUniforms=A(a),this.binderUniforms=S?S.getUniforms(a):[],R.includes("TERRAIN")&&(this.terrainUniforms=(re=>({u_dem:new r.Uniform1i(re),u_dem_prev:new r.Uniform1i(re),u_dem_unpack:new r.Uniform4f(re),u_dem_tl:new r.Uniform2f(re),u_dem_scale:new r.Uniform1f(re),u_dem_tl_prev:new r.Uniform2f(re),u_dem_scale_prev:new r.Uniform1f(re),u_dem_size:new r.Uniform1f(re),u_dem_lerp:new r.Uniform1f(re),u_exaggeration:new r.Uniform1f(re),u_depth:new r.Uniform1i(re),u_depth_size_inv:new r.Uniform2f(re),u_meter_to_dem:new r.Uniform1f(re),u_label_plane_matrix_inv:new r.UniformMatrix4f(re)}))(a)),R.includes("GLOBE")&&(this.globeUniforms=(re=>({u_tile_tl_up:new r.Uniform3f(re),u_tile_tr_up:new r.Uniform3f(re),u_tile_br_up:new r.Uniform3f(re),u_tile_bl_up:new r.Uniform3f(re),u_tile_up_scale:new r.Uniform1f(re)}))(a)),R.includes("FOG")&&(this.fogUniforms=(re=>({u_fog_matrix:new r.UniformMatrix4f(re),u_fog_range:new r.Uniform2f(re),u_fog_color:new r.Uniform4f(re),u_fog_horizon_blend:new r.Uniform1f(re),u_fog_temporal_offset:new r.Uniform1f(re),u_frustum_tl:new r.Uniform3f(re),u_frustum_tr:new r.Uniform3f(re),u_frustum_br:new r.Uniform3f(re),u_frustum_bl:new r.Uniform3f(re),u_globe_pos:new r.Uniform3f(re),u_globe_radius:new r.Uniform1f(re),u_globe_transition:new r.Uniform1f(re),u_is_globe:new r.Uniform1i(re),u_viewport:new r.Uniform2f(re)}))(a))}}setTerrainUniformValues(a,f){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in f)v[S]&&v[S].set(this.program,S,f[S])}}setGlobeUniformValues(a,f){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in f)v[S]&&v[S].set(this.program,S,f[S])}}setFogUniformValues(a,f){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const S in f)v[S].set(this.program,S,f[S])}}draw(a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se){const ke=a.gl;if(this.failedToCreate)return;a.program.set(this.program),a.setDepthMode(v),a.setStencilMode(S),a.setColorMode(A),a.setCullFace(R);for(const we of Object.keys(this.fixedUniforms))this.fixedUniforms[we].set(this.program,we,z[we]);Ae&&Ae.setUniforms(this.program,a,this.binderUniforms,ge,{zoom:Te});const re={[ke.LINES]:2,[ke.TRIANGLES]:3,[ke.LINE_STRIP]:1}[f];for(const we of ne.get()){const De=we.vaos||(we.vaos={});(De[j]||(De[j]=new Ig)).bind(a,this,Z,Ae?Ae.getPaintVertexBuffers():[],Y,we.vertexOffset,Se||[]),ke.drawElements(f,we.primitiveLength*re,ke.UNSIGNED_SHORT,we.primitiveOffset*re*2)}}}function ua(_,a){const f=Math.pow(2,a.tileID.overscaledZ),v=a.tileSize*Math.pow(2,_.transform.tileZoom)/f,S=v*(a.tileID.canonical.x+a.tileID.wrap*f),A=v*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_tile_units_to_pixels:1/ji(a,1,_.transform.tileZoom),u_pixel_coord_upper:[S>>16,A>>16],u_pixel_coord_lower:[65535&S,65535&A]}}const Qd=r.create(),Cu=(_,a,f,v,S,A,R,z,j,Z,Y)=>{const ne=a.style.light,ge=ne.properties.get("position"),Te=[ge.x,ge.y,ge.z],Ae=r.create$1();ne.properties.get("anchor")==="viewport"&&(r.fromRotation(Ae,-a.transform.angle),r.transformMat3(Te,Te,Ae));const Se=ne.properties.get("color"),ke=a.transform,re={u_matrix:_,u_lightpos:Te,u_lightintensity:ne.properties.get("intensity"),u_lightcolor:[Se.r,Se.g,Se.b],u_vertical_gradient:+f,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Qd,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:A};return ke.projection.name==="globe"&&(re.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],re.u_zoom_transition=j,re.u_inv_rot_matrix=Y,re.u_merc_center=Z,re.u_up_dir=ke.projection.upVector(new r.CanonicalTileID(0,0,0),Z[0]*r.EXTENT,Z[1]*r.EXTENT),re.u_height_lift=z),re},$p=(_,a,f,v,S,A,R,z,j,Z,Y,ne)=>{const ge=Cu(_,a,f,v,S,A,R,j,Z,Y,ne),Te={u_height_factor:-Math.pow(2,R.overscaledZ)/z.tileSize/8};return r.extend(ge,ua(a,z),Te)},Ll=_=>({u_matrix:_}),ef=(_,a,f)=>r.extend(Ll(_),ua(a,f)),tf=(_,a)=>({u_matrix:_,u_world:a}),nf=(_,a,f,v)=>r.extend(ef(_,a,f),{u_world:v}),Au=r.create(),wc=(_,a,f,v,S,A)=>{const R=_.transform,z=R.projection.name==="globe";let j;if(A.paint.get("circle-pitch-alignment")==="map")if(z){const Y=r.globePixelsToTileUnits(R.zoom,a.canonical)*R._pixelsPerMercatorPixel;j=Float32Array.from([Y,0,0,Y])}else j=R.calculatePixelsToTileUnitsMatrix(f);else j=new Float32Array([R.pixelsToGLUnits[0],0,0,R.pixelsToGLUnits[1]]);const Z={u_camera_to_center_distance:R.cameraToCenterDistance,u_matrix:_.translatePosMatrix(a.projMatrix,f,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_device_pixel_ratio:r.exported.devicePixelRatio,u_extrude_scale:j,u_inv_rot_matrix:Au,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){Z.u_inv_rot_matrix=v,Z.u_merc_center=S,Z.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],Z.u_zoom_transition=r.globeToMercatorTransition(R.zoom);const Y=S[0]*r.EXTENT,ne=S[1]*r.EXTENT;Z.u_up_dir=R.projection.upVector(new r.CanonicalTileID(0,0,0),Y,ne)}return Z},sf=_=>{const a=[];return _.paint.get("circle-pitch-alignment")==="map"&&a.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&a.push("SCALE_WITH_MAP"),a},ku=(_,a,f,v)=>{const S=r.EXTENT/f.tileSize;return{u_matrix:_,u_camera_to_center_distance:a.getCameraToCenterDistance(v),u_extrude_scale:[a.pixelsToGLUnits[0]/S,a.pixelsToGLUnits[1]/S]}},Dl=(_,a,f=1)=>({u_matrix:_,u_color:a,u_overlay:0,u_overlay_scale:f}),ol=r.create(),Wp=(_,a,f,v,S,A,R)=>{const z=_.transform,j=z.projection.name==="globe",Z=j?r.globePixelsToTileUnits(z.zoom,a.canonical)*z._pixelsPerMercatorPixel:ji(f,1,A),Y={u_matrix:a.projMatrix,u_extrude_scale:Z,u_intensity:R,u_inv_rot_matrix:ol,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(j){Y.u_inv_rot_matrix=v,Y.u_merc_center=S,Y.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],Y.u_zoom_transition=r.globeToMercatorTransition(z.zoom);const ne=S[0]*r.EXTENT,ge=S[1]*r.EXTENT;Y.u_up_dir=z.projection.upVector(new r.CanonicalTileID(0,0,0),ne,ge)}return Y},Ol=(_,a,f,v,S,A,R)=>{const z=_.transform,j=z.calculatePixelsToTileUnitsMatrix(a);return{u_matrix:Rl(_,a,f,v),u_pixels_to_tile_units:j,u_device_pixel_ratio:A,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:xh(f)?a.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Uo(a,_.transform),u_alpha_discard_threshold:0,u_trim_offset:R}},yh=(_,a,f,v,S)=>{const A=_.transform;return{u_matrix:Rl(_,a,f,v),u_texsize:a.imageAtlasTexture.size,u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(a),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Uo(a,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Uo(_,a){return 1/ji(_,1,a.tileZoom)}function Rl(_,a,f,v){return _.translatePosMatrix(v||a.tileID.projMatrix,a,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function xh(_){const a=_.paint.get("line-dasharray").value;return a.value||a.kind!=="constant"}const vh=(_,a,f,v,S,A)=>{return{u_matrix:_,u_tl_parent:a,u_scale_parent:f,u_fade_t:v.mix,u_opacity:v.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(z=S.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(R=S.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:fo(S.paint.get("raster-hue-rotate")),u_perspective_transform:A};var R,z};function fo(_){_*=Math.PI/180;const a=Math.sin(_),f=Math.cos(_);return[(2*f+1)/3,(-Math.sqrt(3)*a-f+1)/3,(Math.sqrt(3)*a-f+1)/3]}const Iu=r.create(),rf=(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se)=>{const ke=S.transform,re={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:ke.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:ke.width/ke.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:R,u_coord_matrix:z,u_is_text:+j,u_pitch_with_map:+v,u_texsize:Z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Iu,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Iu,u_up_vector:[0,-1,0]};return Se.name==="globe"&&(re.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],re.u_zoom_transition=ne,re.u_inv_rot_matrix=Te,re.u_merc_center=ge,re.u_camera_forward=ke._camera.forward(),re.u_ecef_origin=r.globeECEFOrigin(ke.globeMatrix,Y.toUnwrapped()),re.u_tile_matrix=Float32Array.from(ke.globeMatrix),re.u_up_vector=Ae),re},Pu=(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se,ke)=>r.extend(rf(_,a,f,v,S,A,R,z,j,Z,ne,ge,Te,Ae,Se,ke),{u_gamma_scale:v?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:r.exported.devicePixelRatio,u_is_halo:1}),bh=(_,a,f,v,S,A,R,z,j,Z,Y,ne,ge,Te,Ae,Se)=>r.extend(Pu(_,a,f,v,S,A,R,z,!0,j,!0,Y,ne,ge,Te,Ae,Se),{u_texsize_icon:Z,u_texture_icon:1}),of=(_,a,f)=>({u_matrix:_,u_opacity:a,u_color:f}),Pg=(_,a,f,v,S)=>r.extend(function(A,R,z){const j=R.imageManager.getPattern(A.toString()),{width:Z,height:Y}=R.imageManager.getPixelSize(),ne=Math.pow(2,z.tileID.overscaledZ),ge=z.tileSize*Math.pow(2,R.transform.tileZoom)/ne,Te=ge*(z.tileID.canonical.x+z.tileID.wrap*ne),Ae=ge*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:j.tl,u_pattern_br:j.br,u_texsize:[Z,Y],u_pattern_size:j.displaySize,u_tile_units_to_pixels:1/ji(z,1,R.transform.tileZoom),u_pixel_coord_upper:[Te>>16,Ae>>16],u_pixel_coord_lower:[65535&Te,65535&Ae]}}(v,f,S),{u_matrix:_,u_opacity:a}),af={fillExtrusion:_=>({u_matrix:new r.UniformMatrix4f(_),u_lightpos:new r.Uniform3f(_),u_lightintensity:new r.Uniform1f(_),u_lightcolor:new r.Uniform3f(_),u_vertical_gradient:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_),u_edge_radius:new r.Uniform1f(_),u_ao:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_up_dir:new r.Uniform3f(_),u_height_lift:new r.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_lightpos:new r.Uniform3f(_),u_lightintensity:new r.Uniform1f(_),u_lightcolor:new r.Uniform3f(_),u_vertical_gradient:new r.Uniform1f(_),u_height_factor:new r.Uniform1f(_),u_edge_radius:new r.Uniform1f(_),u_ao:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_up_dir:new r.Uniform3f(_),u_height_lift:new r.Uniform1f(_),u_image:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_)}),fill:_=>({u_matrix:new r.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_image:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_)}),fillOutline:_=>({u_matrix:new r.UniformMatrix4f(_),u_world:new r.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_world:new r.Uniform2f(_),u_image:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new r.Uniform1f(_),u_extrude_scale:new r.UniformMatrix2f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_up_dir:new r.Uniform3f(_)}),collisionBox:_=>({u_matrix:new r.UniformMatrix4f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_extrude_scale:new r.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new r.UniformMatrix4f(_),u_inv_matrix:new r.UniformMatrix4f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_viewport_size:new r.Uniform2f(_)}),debug:_=>({u_color:new r.UniformColor(_),u_matrix:new r.UniformMatrix4f(_),u_overlay:new r.Uniform1i(_),u_overlay_scale:new r.Uniform1f(_)}),clippingMask:_=>({u_matrix:new r.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new r.Uniform1f(_),u_intensity:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_up_dir:new r.Uniform3f(_)}),heatmapTexture:_=>({u_image:new r.Uniform1i(_),u_color_ramp:new r.Uniform1i(_),u_opacity:new r.Uniform1f(_)}),hillshade:_=>({u_matrix:new r.UniformMatrix4f(_),u_image:new r.Uniform1i(_),u_latrange:new r.Uniform2f(_),u_light:new r.Uniform2f(_),u_shadow:new r.UniformColor(_),u_highlight:new r.UniformColor(_),u_accent:new r.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new r.UniformMatrix4f(_),u_image:new r.Uniform1i(_),u_dimension:new r.Uniform2f(_),u_zoom:new r.Uniform1f(_),u_unpack:new r.Uniform4f(_)}),line:_=>({u_matrix:new r.UniformMatrix4f(_),u_pixels_to_tile_units:new r.UniformMatrix2f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_units_to_pixels:new r.Uniform2f(_),u_dash_image:new r.Uniform1i(_),u_gradient_image:new r.Uniform1i(_),u_image_height:new r.Uniform1f(_),u_texsize:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_),u_alpha_discard_threshold:new r.Uniform1f(_),u_trim_offset:new r.Uniform2f(_)}),linePattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_texsize:new r.Uniform2f(_),u_pixels_to_tile_units:new r.UniformMatrix2f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_image:new r.Uniform1i(_),u_units_to_pixels:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_),u_alpha_discard_threshold:new r.Uniform1f(_)}),raster:_=>({u_matrix:new r.UniformMatrix4f(_),u_tl_parent:new r.Uniform2f(_),u_scale_parent:new r.Uniform1f(_),u_fade_t:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_),u_image0:new r.Uniform1i(_),u_image1:new r.Uniform1i(_),u_brightness_low:new r.Uniform1f(_),u_brightness_high:new r.Uniform1f(_),u_saturation_factor:new r.Uniform1f(_),u_contrast_factor:new r.Uniform1f(_),u_spin_weights:new r.Uniform3f(_),u_perspective_transform:new r.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new r.Uniform1i(_),u_is_size_feature_constant:new r.Uniform1i(_),u_size_t:new r.Uniform1f(_),u_size:new r.Uniform1f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_rotate_symbol:new r.Uniform1i(_),u_aspect_ratio:new r.Uniform1f(_),u_fade_change:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_label_plane_matrix:new r.UniformMatrix4f(_),u_coord_matrix:new r.UniformMatrix4f(_),u_is_text:new r.Uniform1i(_),u_pitch_with_map:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_camera_forward:new r.Uniform3f(_),u_tile_matrix:new r.UniformMatrix4f(_),u_up_vector:new r.Uniform3f(_),u_ecef_origin:new r.Uniform3f(_),u_texture:new r.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new r.Uniform1i(_),u_is_size_feature_constant:new r.Uniform1i(_),u_size_t:new r.Uniform1f(_),u_size:new r.Uniform1f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_rotate_symbol:new r.Uniform1i(_),u_aspect_ratio:new r.Uniform1f(_),u_fade_change:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_label_plane_matrix:new r.UniformMatrix4f(_),u_coord_matrix:new r.UniformMatrix4f(_),u_is_text:new r.Uniform1i(_),u_pitch_with_map:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_texture:new r.Uniform1i(_),u_gamma_scale:new r.Uniform1f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_camera_forward:new r.Uniform3f(_),u_tile_matrix:new r.UniformMatrix4f(_),u_up_vector:new r.Uniform3f(_),u_ecef_origin:new r.Uniform3f(_),u_is_halo:new r.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new r.Uniform1i(_),u_is_size_feature_constant:new r.Uniform1i(_),u_size_t:new r.Uniform1f(_),u_size:new r.Uniform1f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_rotate_symbol:new r.Uniform1i(_),u_aspect_ratio:new r.Uniform1f(_),u_fade_change:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_label_plane_matrix:new r.UniformMatrix4f(_),u_coord_matrix:new r.UniformMatrix4f(_),u_is_text:new r.Uniform1i(_),u_pitch_with_map:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_texsize_icon:new r.Uniform2f(_),u_texture:new r.Uniform1i(_),u_texture_icon:new r.Uniform1i(_),u_gamma_scale:new r.Uniform1f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_is_halo:new r.Uniform1i(_)}),background:_=>({u_matrix:new r.UniformMatrix4f(_),u_opacity:new r.Uniform1f(_),u_color:new r.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_opacity:new r.Uniform1f(_),u_image:new r.Uniform1i(_),u_pattern_tl:new r.Uniform2f(_),u_pattern_br:new r.Uniform2f(_),u_texsize:new r.Uniform2f(_),u_pattern_size:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_)}),terrainRaster:wu,terrainDepth:wu,skybox:_=>({u_matrix:new r.UniformMatrix4f(_),u_sun_direction:new r.Uniform3f(_),u_cubemap:new r.Uniform1i(_),u_opacity:new r.Uniform1f(_),u_temporal_offset:new r.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new r.UniformMatrix4f(_),u_color_ramp:new r.Uniform1i(_),u_center_direction:new r.Uniform3f(_),u_radius:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_),u_temporal_offset:new r.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new r.UniformMatrix3f(_),u_sun_direction:new r.Uniform3f(_),u_sun_intensity:new r.Uniform1f(_),u_color_tint_r:new r.Uniform4f(_),u_color_tint_m:new r.Uniform4f(_),u_luminance:new r.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new r.UniformMatrix4f(_),u_globe_matrix:new r.UniformMatrix4f(_),u_normalize_matrix:new r.UniformMatrix4f(_),u_merc_matrix:new r.UniformMatrix4f(_),u_zoom_transition:new r.Uniform1f(_),u_merc_center:new r.Uniform2f(_),u_image0:new r.Uniform1i(_),u_grid_matrix:new r.UniformMatrix3f(_),u_skirt_height:new r.Uniform1f(_),u_frustum_tl:new r.Uniform3f(_),u_frustum_tr:new r.Uniform3f(_),u_frustum_br:new r.Uniform3f(_),u_frustum_bl:new r.Uniform3f(_),u_globe_pos:new r.Uniform3f(_),u_globe_radius:new r.Uniform1f(_),u_viewport:new r.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new r.Uniform3f(_),u_frustum_tr:new r.Uniform3f(_),u_frustum_br:new r.Uniform3f(_),u_frustum_bl:new r.Uniform3f(_),u_horizon:new r.Uniform1f(_),u_transition:new r.Uniform1f(_),u_fadeout_range:new r.Uniform1f(_),u_color:new r.Uniform4f(_),u_high_color:new r.Uniform4f(_),u_space_color:new r.Uniform4f(_),u_star_intensity:new r.Uniform1f(_),u_star_density:new r.Uniform1f(_),u_star_size:new r.Uniform1f(_),u_temporal_offset:new r.Uniform1f(_),u_horizon_angle:new r.Uniform1f(_),u_rotation_matrix:new r.UniformMatrix4f(_)})};let Vo;function wh(_,a,f,v,S,A,R){const z=_.context,j=z.gl,Z=_.transform,Y=_.useProgram("collisionBox"),ne=[];let ge=0,Te=0;for(let Re=0;Re<v.length;Re++){const Ye=v[Re],We=a.getTile(Ye),Ke=We.getBucket(f);if(!Ke)continue;const lt=ho(Ye,Ke,Z);let ot=lt;S[0]===0&&S[1]===0||(ot=_.translatePosMatrix(lt,We,S,A));const _t=R?Ke.textCollisionBox:Ke.iconCollisionBox,Wt=Ke.collisionCircleArray;if(Wt.length>0){const pt=r.create(),Lt=ot;r.mul(pt,Ke.placementInvProjMatrix,Z.glCoordMatrix),r.mul(pt,pt,Ke.placementViewportMatrix),ne.push({circleArray:Wt,circleOffset:Te,transform:Lt,invTransform:pt,projection:Ke.getProjection()}),ge+=Wt.length/4,Te=ge}_t&&(_.terrain&&_.terrain.setupElevationDraw(We,Y),Y.draw(z,j.LINES,r.DepthMode.disabled,r.StencilMode.disabled,_.colorModeForRenderPass(),r.CullFaceMode.disabled,ku(ot,Z,We,Ke.getProjection()),f.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,null,Z.zoom,null,[_t.collisionVertexBuffer,_t.collisionVertexBufferExt]))}if(!R||!ne.length)return;const Ae=_.useProgram("collisionCircle"),Se=new r.StructArrayLayout2f1f2i16;Se.resize(4*ge),Se._trim();let ke=0;for(const Re of ne)for(let Ye=0;Ye<Re.circleArray.length/4;Ye++){const We=4*Ye,Ke=Re.circleArray[We+0],lt=Re.circleArray[We+1],ot=Re.circleArray[We+2],_t=Re.circleArray[We+3];Se.emplace(ke++,Ke,lt,ot,_t,0),Se.emplace(ke++,Ke,lt,ot,_t,1),Se.emplace(ke++,Ke,lt,ot,_t,2),Se.emplace(ke++,Ke,lt,ot,_t,3)}(!Vo||Vo.length<2*ge)&&(Vo=function(Re){const Ye=2*Re,We=new r.StructArrayLayout3ui6;We.resize(Ye),We._trim();for(let Ke=0;Ke<Ye;Ke++){const lt=6*Ke;We.uint16[lt+0]=4*Ke+0,We.uint16[lt+1]=4*Ke+1,We.uint16[lt+2]=4*Ke+2,We.uint16[lt+3]=4*Ke+2,We.uint16[lt+4]=4*Ke+3,We.uint16[lt+5]=4*Ke+0}return We}(ge));const re=z.createIndexBuffer(Vo,!0),we=z.createVertexBuffer(Se,r.collisionCircleLayout.members,!0);for(const Re of ne){const Ye={u_matrix:Re.transform,u_inv_matrix:Re.invTransform,u_camera_to_center_distance:(De=Z).getCameraToCenterDistance(Re.projection),u_viewport_size:[De.width,De.height]};Ae.draw(z,j.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,_.colorModeForRenderPass(),r.CullFaceMode.disabled,Ye,f.id,we,re,r.SegmentVector.simpleSegment(0,2*Re.circleOffset,Re.circleArray.length,Re.circleArray.length/2),null,Z.zoom)}var De;we.destroy(),re.destroy()}const lf=r.create();function cf({width:_,height:a,anchor:f,textOffset:v,textScale:S},A){const{horizontalAlign:R,verticalAlign:z}=r.getAnchorAlignment(f),j=-(R-.5)*_,Z=-(z-.5)*a,Y=r.evaluateVariableOffset(f,v);return new r.Point((j/S+Y[0])*A,(Z/S+Y[1])*A)}function Lg(_,a,f,v,S,A,R,z,j,Z,Y){const ne=_.text.placedSymbolArray,ge=_.text.dynamicLayoutVertexArray,Te=_.icon.dynamicLayoutVertexArray,Ae={},Se=_.getProjection(),ke=us(z,Se,A),re=A.elevation,we=Se.upVectorScale(z.canonical,A.center.lat,A.worldSize).metersToTile;ge.clear();for(let De=0;De<ne.length;De++){const Re=ne.get(De),{tileAnchorX:Ye,tileAnchorY:We,numGlyphs:Ke}=Re,lt=Re.hidden||!Re.crossTileID||_.allowVerticalPlacement&&!Re.placedOrientation?null:v[Re.crossTileID];if(lt){let ot=0,_t=0,Wt=0;if(re){const Jt=re?re.getAtTileOffset(z,Ye,We):0,[Pi,$i,wi]=Se.upVector(z.canonical,Ye,We);ot=Jt*Pi*we,_t=Jt*$i*we,Wt=Jt*wi*we}let[pt,Lt,wt,qt]=ar(Re.projectedAnchorX+ot,Re.projectedAnchorY+_t,Re.projectedAnchorZ+Wt,f?ke:R);const dt=Np(A.getCameraToCenterDistance(Se),qt);let Ot=S.evaluateSizeForFeature(_.textSizeData,Z,Re)*dt/r.ONE_EM;f&&(Ot*=_.tilePixelRatio/j);const Xt=cf(lt,Ot);f?({x:pt,y:Lt,z:wt}=Se.projectTilePoint(Ye+Xt.x,We+Xt.y,z.canonical),[pt,Lt,wt]=ar(pt+ot,Lt+_t,wt+Wt,R)):(a&&Xt._rotate(-A.angle),pt+=Xt.x,Lt+=Xt.y,wt=0);const kt=_.allowVerticalPlacement&&Re.placedOrientation===r.WritingMode.vertical?Math.PI/2:0;for(let Jt=0;Jt<Ke;Jt++)r.addDynamicAttributes(ge,pt,Lt,wt,kt);Y&&Re.associatedIconIndex>=0&&(Ae[Re.associatedIconIndex]={x:pt,y:Lt,z:wt,angle:kt})}else co(Ke,ge)}if(Y){Te.clear();const De=_.icon.placedSymbolArray;for(let Re=0;Re<De.length;Re++){const Ye=De.get(Re),{numGlyphs:We}=Ye,Ke=Ae[Re];if(Ye.hidden||!Ke)co(We,Te);else{const{x:lt,y:ot,z:_t,angle:Wt}=Ke;for(let pt=0;pt<We;pt++)r.addDynamicAttributes(Te,lt,ot,_t,Wt)}}_.icon.dynamicLayoutVertexBuffer.updateData(Te)}_.text.dynamicLayoutVertexBuffer.updateData(ge)}function Tc(_,a,f){return f.iconsInText&&a?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Gp(_,a,f,v,S,A,R,z,j,Z,Y,ne){const ge=_.context,Te=ge.gl,Ae=_.transform,Se=z==="map",ke=j==="map",re=Se&&f.layout.get("symbol-placement")!=="point",we=Se&&!ke&&!re,De=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Re=!1;const Ye=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),We=[r.mercatorXfromLng(Ae.center.lng),r.mercatorYfromLat(Ae.center.lat)],Ke=f.layout.get("text-variable-anchor"),lt=Ae.projection.name==="globe",ot=[],_t=[0,-1,0];let Wt=_t;!lt&&!Ae.mercatorFromTransition||Se||(Wt=function(pt){const Lt=pt._camera.getWorldToCamera(pt.worldSize,1),wt=r.multiply([],Lt,pt.globeMatrix);r.invert(wt,wt);const qt=[0,0,0],dt=[0,1,0,0];return r.transformMat4$1(dt,dt,wt),qt[0]=dt[0],qt[1]=dt[1],qt[2]=dt[2],r.normalize(qt,qt),qt}(Ae));for(const pt of v){const Lt=a.getTile(pt),wt=Lt.getBucket(f);if(!wt||wt.projection.name==="mercator"&&lt)continue;const qt=S?wt.text:wt.icon;if(!qt||wt.fullyClipped||!qt.segments.get().length)continue;const dt=qt.programConfigurations.get(f.id),Ot=S||wt.sdfIcons,Xt=S?wt.textSizeData:wt.iconSizeData,kt=ke||Ae.pitch!==0,Jt=r.evaluateSizeForZoom(Xt,Ae.zoom);let Pi,$i,wi,Li,Zi=[0,0],Yi=null;if(S)$i=Lt.glyphAtlasTexture,wi=Te.LINEAR,Pi=Lt.glyphAtlasTexture.size,wt.iconsInText&&(Zi=Lt.imageAtlasTexture.size,Yi=Lt.imageAtlasTexture,Li=kt||_.options.rotating||_.options.zooming||Xt.kind==="composite"||Xt.kind==="camera"?Te.LINEAR:Te.NEAREST);else{const pa=f.layout.get("icon-size").constantOr(0)!==1||wt.iconsNeedLinear;$i=Lt.imageAtlasTexture,wi=Ot||_.options.rotating||_.options.zooming||pa||kt?Te.LINEAR:Te.NEAREST,Pi=Lt.imageAtlasTexture.size}const Ci=wt.projection.name==="globe",Rn=Ci?Wt:_t,Un=Ci?r.globeToMercatorTransition(Ae.zoom):0,Vn=us(pt,wt.getProjection(),Ae),jn=Ae.calculatePixelsToTileUnitsMatrix(Lt),Mr=Ct(Vn,Lt.tileID.canonical,ke,Se,Ae,wt.getProjection(),jn),ur=_.terrain&&ke&&re?r.invert(r.create(),Mr):lf,_o=$s(Vn,Lt.tileID.canonical,ke,Se,Ae,wt.getProjection(),jn),Bn=Ke&&wt.hasTextData(),ns=f.layout.get("icon-text-fit")!=="none"&&Bn&&wt.hasIconData();if(re){const pa=Ae.elevation,ja=pa?pa.getAtTileOffsetFunc(pt,Ae.center.lat,Ae.worldSize,wt.getProjection()):null,$l=oa(Vn,Lt.tileID.canonical,ke,Se,Ae,wt.getProjection(),jn);mu(wt,Vn,_,S,$l,_o,ke,Z,ja,pt)}const Xn=re||S&&Ke||ns,yn=_.translatePosMatrix(Vn,Lt,A,R),Ws=Xn?lf:Mr,Rr=_.translatePosMatrix(_o,Lt,A,R,!0),ss=wt.getProjection().createInversionMatrix(Ae,pt.canonical),Qs=[];_.terrainRenderModeElevated()&&ke&&Qs.push("PITCH_WITH_MAP_TERRAIN"),Ci&&Qs.push("PROJECTION_GLOBE_VIEW"),Xn&&Qs.push("PROJECTED_POS_ON_VIEWPORT");const $u=Ot&&f.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Va;Va=Ot?wt.iconsInText?bh(Xt.kind,Jt,we,ke,_,yn,Ws,Rr,Pi,Zi,pt,Un,We,ss,Rn,wt.getProjection()):Pu(Xt.kind,Jt,we,ke,_,yn,Ws,Rr,S,Pi,!0,pt,Un,We,ss,Rn,wt.getProjection()):rf(Xt.kind,Jt,we,ke,_,yn,Ws,Rr,S,Pi,pt,Un,We,ss,Rn,wt.getProjection());const zc={program:_.useProgram(Tc(Ot,S,wt),dt,Qs),buffers:qt,uniformValues:Va,atlasTexture:$i,atlasTextureIcon:Yi,atlasInterpolation:wi,atlasInterpolationIcon:Li,isSDF:Ot,hasHalo:$u,tile:Lt,labelPlaneMatrixInv:ur};if(De&&wt.canOverlap){Re=!0;const pa=qt.segments.get();for(const ja of pa)ot.push({segments:new r.SegmentVector([ja]),sortKey:ja.sortKey,state:zc})}else ot.push({segments:qt.segments,sortKey:0,state:zc})}Re&&ot.sort((pt,Lt)=>pt.sortKey-Lt.sortKey);for(const pt of ot){const Lt=pt.state;if(_.terrain&&_.terrain.setupElevationDraw(Lt.tile,Lt.program,{useDepthForOcclusion:!lt,labelPlaneMatrixInv:Lt.labelPlaneMatrixInv}),ge.activeTexture.set(Te.TEXTURE0),Lt.atlasTexture.bind(Lt.atlasInterpolation,Te.CLAMP_TO_EDGE),Lt.atlasTextureIcon&&(ge.activeTexture.set(Te.TEXTURE1),Lt.atlasTextureIcon&&Lt.atlasTextureIcon.bind(Lt.atlasInterpolationIcon,Te.CLAMP_TO_EDGE)),Lt.isSDF){const wt=Lt.uniformValues;Lt.hasHalo&&(wt.u_is_halo=1,Th(Lt.buffers,pt.segments,f,_,Lt.program,Ye,Y,ne,wt)),wt.u_is_halo=0}Th(Lt.buffers,pt.segments,f,_,Lt.program,Ye,Y,ne,Lt.uniformValues)}}function Th(_,a,f,v,S,A,R,z,j){const Z=v.context,Y=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];S.draw(Z,Z.gl.TRIANGLES,A,R,z,r.CullFaceMode.disabled,j,f.id,_.layoutVertexBuffer,_.indexBuffer,a,f.paint,v.transform.zoom,_.programConfigurations.get(f.id),Y)}function hf(_,a,f,v,S,A,R){const z=_.context.gl,j=f.paint.get("fill-pattern"),Z=j&&j.constantOr(1);let Y,ne,ge,Te,Ae;R?(ne=Z&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=z.LINES):(ne=Z?"fillPattern":"fill",Y=z.TRIANGLES);for(const Se of v){const ke=a.getTile(Se);if(Z&&!ke.patternsLoaded())continue;const re=ke.getBucket(f);if(!re)continue;_.prepareDrawTile();const we=re.programConfigurations.get(f.id),De=_.useProgram(ne,we);Z&&(_.context.activeTexture.set(z.TEXTURE0),ke.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),we.updatePaintBuffers());const Re=j.constantOr(null);if(Re&&ke.imageAtlas){const We=ke.imageAtlas.patternPositions[Re.toString()];We&&we.setConstantPatternPositions(We)}const Ye=_.translatePosMatrix(Se.projMatrix,ke,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(R){Te=re.indexBuffer2,Ae=re.segments2;const We=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];ge=ne==="fillOutlinePattern"&&Z?nf(Ye,_,ke,We):tf(Ye,We)}else Te=re.indexBuffer,Ae=re.segments,ge=Z?ef(Ye,_,ke):Ll(Ye);_.prepareDrawProgram(_.context,De,Se.toUnwrapped()),De.draw(_.context,Y,S,_.stencilModeForClipping(Se),A,r.CullFaceMode.disabled,ge,f.id,re.layoutVertexBuffer,Te,Ae,f.paint,_.transform.zoom,we)}}function Lu(_,a,f,v,S,A,R){const z=_.context,j=z.gl,Z=_.transform,Y=f.paint.get("fill-extrusion-pattern"),ne=Y.constantOr(1),ge=f.paint.get("fill-extrusion-opacity"),Te=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],Ae=f.layout.get("fill-extrusion-edge-radius"),Se=Ae>0&&!f.paint.get("fill-extrusion-rounded-roof"),ke=Se?0:Ae,re=Z.projection.name==="globe"?r.fillExtrusionHeightLift():0,we=Z.projection.name==="globe",De=we?r.globeToMercatorTransition(Z.zoom):0,Re=[r.mercatorXfromLng(Z.center.lng),r.mercatorYfromLat(Z.center.lat)],Ye=[];we&&Ye.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&Ye.push("FAUX_AO"),Se&&Ye.push("ZERO_ROOF_RADIUS");for(const We of v){const Ke=a.getTile(We),lt=Ke.getBucket(f);if(!lt||lt.projection.name!==Z.projection.name)continue;const ot=lt.programConfigurations.get(f.id),_t=_.useProgram(ne?"fillExtrusionPattern":"fillExtrusion",ot,Ye);if(_.terrain){const Ot=_.terrain;if(_.style.terrainSetForDrapingOnly())Ot.setupElevationDraw(Ke,_t,{useMeterToDem:!0});else{if(!lt.enableTerrain)continue;if(Ot.setupElevationDraw(Ke,_t,{useMeterToDem:!0}),zl(z,a,We,lt,f,Ot),!lt.centroidVertexBuffer){const Xt=_t.attributes.a_centroid_pos;Xt!==void 0&&j.vertexAttrib2f(Xt,0,0)}}}ne&&(_.context.activeTexture.set(j.TEXTURE0),Ke.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),ot.updatePaintBuffers());const Wt=Y.constantOr(null);if(Wt&&Ke.imageAtlas){const Ot=Ke.imageAtlas.patternPositions[Wt.toString()];Ot&&ot.setConstantPatternPositions(Ot)}const pt=_.translatePosMatrix(We.projMatrix,Ke,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Lt=Z.projection.createInversionMatrix(Z,We.canonical),wt=f.paint.get("fill-extrusion-vertical-gradient"),qt=ne?$p(pt,_,wt,ge,Te,ke,We,Ke,re,De,Re,Lt):Cu(pt,_,wt,ge,Te,ke,We,re,De,Re,Lt);_.prepareDrawProgram(z,_t,We.toUnwrapped());const dt=[];_.terrain&&dt.push(lt.centroidVertexBuffer),we&&dt.push(lt.layoutVertexExtBuffer),_t.draw(z,z.gl.TRIANGLES,S,A,R,r.CullFaceMode.backCCW,qt,f.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,f.paint,_.transform.zoom,ot,dt)}}function zl(_,a,f,v,S,A){const R=[re=>{let we=re.canonical.x-1,De=re.wrap;return we<0&&(we=(1<<re.canonical.z)-1,De--),new r.OverscaledTileID(re.overscaledZ,De,re.canonical.z,we,re.canonical.y)},re=>{let we=re.canonical.x+1,De=re.wrap;return we===1<<re.canonical.z&&(we=0,De++),new r.OverscaledTileID(re.overscaledZ,De,re.canonical.z,we,re.canonical.y)},re=>new r.OverscaledTileID(re.overscaledZ,re.wrap,re.canonical.z,re.canonical.x,(re.canonical.y===0?1<<re.canonical.z:re.canonical.y)-1),re=>new r.OverscaledTileID(re.overscaledZ,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y===(1<<re.canonical.z)-1?0:re.canonical.y+1)],z=re=>{const we=a.getSource().minzoom,De=Ye=>{const We=a.getTileByID(Ye);if(We&&We.hasData())return We.getBucket(S)},Re=[0,-1,1];for(const Ye of Re){if(re.overscaledZ+Ye<we)continue;const We=De(re.calculateScaledKey(re.overscaledZ+Ye));if(We)return We}},j=[0,0,0],Z=(re,we)=>(j[0]=Math.min(re.min.y,we.min.y),j[1]=Math.max(re.max.y,we.max.y),j[2]=r.EXTENT-we.min.x>re.max.x?we.min.x-r.EXTENT:re.max.x,j),Y=(re,we)=>(j[0]=Math.min(re.min.x,we.min.x),j[1]=Math.max(re.max.x,we.max.x),j[2]=r.EXTENT-we.min.y>re.max.y?we.min.y-r.EXTENT:re.max.y,j),ne=[(re,we)=>Z(re,we),(re,we)=>Z(we,re),(re,we)=>Y(re,we),(re,we)=>Y(we,re)],ge=new r.Point(0,0);let Te,Ae,Se;const ke=(re,we,De,Re,Ye)=>{const We=[[Re?De:re,Re?re:De,0],[Re?De:we,Re?we:De,0]],Ke=Ye<0?r.EXTENT+Ye:Ye,lt=[Re?Ke:(re+we)/2,Re?(re+we)/2:Ke,0];return De===0&&Ye<0||De!==0&&Ye>0?A.getForTilePoints(Se,[lt],!0,Ae):We.push(lt),A.getForTilePoints(f,We,!0,Te),Math.max(We[0][2],We[1][2],lt[2])/A.exaggeration()};for(let re=0;re<4;re++){const we=(re<2?1:5)-re,De=v.borders[re];if(De.length===0)continue;const Re=Se=R[re](f),Ye=z(Re);if(!(Ye&&Ye instanceof r.FillExtrusionBucket&&Ye.enableTerrain)||v.borderDoneWithNeighborZ[re]===Ye.canonical.z&&Ye.borderDoneWithNeighborZ[we]===v.canonical.z||(Ae=A.findDEMTileFor(Re),!Ae||!Ae.dem))continue;if(!Te){const ot=A.findDEMTileFor(f);if(!ot||!ot.dem)return;Te=ot}const We=Ye.borders[we];let Ke=0;const lt=Ye.borderDoneWithNeighborZ[we]!==v.canonical.z;if(v.canonical.z===Ye.canonical.z){for(let ot=0;ot<De.length;ot++){const _t=v.featuresOnBorder[De[ot]],Wt=_t.borders[re];let pt;for(;Ke<We.length&&(pt=Ye.featuresOnBorder[We[Ke]],!(pt.borders[we][1]>Wt[0]+3));)lt&&Ye.encodeCentroid(void 0,pt,!1),Ke++;if(pt&&Ke<We.length){const Lt=Ke;let wt=0;for(;!(pt.borders[we][0]>Wt[1]-3)&&(wt++,++Ke!==We.length);)pt=Ye.featuresOnBorder[We[Ke]];if(pt=Ye.featuresOnBorder[We[Lt]],_t.intersectsCount()>1||pt.intersectsCount()>1||wt!==1){wt!==1&&(Ke=Lt),v.encodeCentroid(void 0,_t,!1),lt&&Ye.encodeCentroid(void 0,pt,!1);continue}const qt=ne[re](_t,pt),dt=re%2?r.EXTENT-1:0;ge.x=ke(qt[0],Math.min(r.EXTENT-1,qt[1]),dt,re<2,qt[2]),ge.y=0,v.encodeCentroid(ge,_t,!1),lt&&Ye.encodeCentroid(ge,pt,!1)}else v.encodeCentroid(void 0,_t,!1)}v.borderDoneWithNeighborZ[re]=Ye.canonical.z,v.needsCentroidUpdate=!0,lt&&(Ye.borderDoneWithNeighborZ[we]=v.canonical.z,Ye.needsCentroidUpdate=!0)}else{for(const ot of De)v.encodeCentroid(void 0,v.featuresOnBorder[ot],!1);if(lt){for(const ot of We)Ye.encodeCentroid(void 0,Ye.featuresOnBorder[ot],!1);Ye.borderDoneWithNeighborZ[we]=v.canonical.z,Ye.needsCentroidUpdate=!0}v.borderDoneWithNeighborZ[re]=Ye.canonical.z,v.needsCentroidUpdate=!0}}(v.needsCentroidUpdate||!v.centroidVertexBuffer&&v.centroidVertexArray.length!==0)&&v.uploadCentroid(_)}const po=new r.Color(1,0,0,1),Dg=new r.Color(0,1,0,1),Og=new r.Color(0,0,1,1),Rg=new r.Color(1,0,1,1),zg=new r.Color(0,1,1,1);function Bg(_,a,f){const v=_.context,S=_.transform,A=v.gl,R=S.projection.name==="globe",z=R?["PROJECTION_GLOBE_VIEW"]:null;let j=f.projMatrix;if(R&&r.globeToMercatorTransition(S.zoom)>0){const _t=r.transitionTileAABBinECEF(f.canonical,S),Wt=r.globeDenormalizeECEF(_t);j=r.multiply(new Float32Array(16),S.globeMatrix,Wt),r.multiply(j,S.projMatrix,j)}const Z=_.useProgram("debug",null,z),Y=a.getTileByID(f.key);_.terrain&&_.terrain.setupElevationDraw(Y,Z);const ne=r.DepthMode.disabled,ge=r.StencilMode.disabled,Te=_.colorModeForRenderPass(),Ae="$debug";v.activeTexture.set(A.TEXTURE0),_.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),R?Y._makeGlobeTileDebugBuffers(_.context,S):Y._makeDebugTileBoundsBuffers(_.context,S.projection);const Se=Y._tileDebugBuffer||_.debugBuffer,ke=Y._tileDebugIndexBuffer||_.debugIndexBuffer,re=Y._tileDebugSegments||_.debugSegments;Z.draw(v,A.LINE_STRIP,ne,ge,Te,r.CullFaceMode.disabled,Dl(j,r.Color.red),Ae,Se,ke,re,null,null,null,[Y._globeTileDebugBorderBuffer]);const we=Y.latestRawTileData,De=Math.floor((we&&we.byteLength||0)/1024),Re=a.getTile(f).tileSize,Ye=512/Math.min(Re,512)*(f.overscaledZ/S.zoom)*.5;let We=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(We+=` => ${f.overscaledZ}`),We+=` ${De}kb`,function(_t,Wt){_t.initDebugOverlayCanvas();const pt=_t.debugOverlayCanvas,Lt=_t.context.gl,wt=_t.debugOverlayCanvas.getContext("2d");wt.clearRect(0,0,pt.width,pt.height),wt.shadowColor="white",wt.shadowBlur=2,wt.lineWidth=1.5,wt.strokeStyle="white",wt.textBaseline="top",wt.font="bold 36px Open Sans, sans-serif",wt.fillText(Wt,5,5),wt.strokeText(Wt,5,5),_t.debugOverlayTexture.update(pt),_t.debugOverlayTexture.bind(Lt.LINEAR,Lt.CLAMP_TO_EDGE)}(_,We);const Ke=Y._tileDebugTextBuffer||_.debugBuffer,lt=Y._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,ot=Y._tileDebugTextSegments||_.debugSegments;Z.draw(v,A.TRIANGLES,ne,ge,r.ColorMode.alphaBlended,r.CullFaceMode.disabled,Dl(j,r.Color.transparent,Ye),Ae,Ke,lt,ot,null,null,null,[Y._globeTileDebugTextBuffer])}function Eh(_,a,f,v){Sc(_,0,a+f/2,_.transform.width,f,v)}function Ec(_,a,f,v){Sc(_,a-f/2,0,f,_.transform.height,v)}function Sc(_,a,f,v,S,A){const R=_.context,z=R.gl;z.enable(z.SCISSOR_TEST),z.scissor(a*r.exported.devicePixelRatio,f*r.exported.devicePixelRatio,v*r.exported.devicePixelRatio,S*r.exported.devicePixelRatio),R.clear({color:A}),z.disable(z.SCISSOR_TEST)}const Sh=r.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Du}=Sh;function Ba(_,a,f,v){_.emplaceBack(a,f,v)}class Mh{constructor(a){this.vertexArray=new r.StructArrayLayout3f12,this.indices=new r.StructArrayLayout3ui6,Ba(this.vertexArray,-1,-1,1),Ba(this.vertexArray,1,-1,1),Ba(this.vertexArray,-1,1,1),Ba(this.vertexArray,1,1,1),Ba(this.vertexArray,-1,-1,-1),Ba(this.vertexArray,1,-1,-1),Ba(this.vertexArray,-1,1,-1),Ba(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,Du),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=r.SegmentVector.simpleSegment(0,0,36,12)}}function Tr(_,a,f,v,S,A){const R=_.gl,z=a.paint.get("sky-atmosphere-color"),j=a.paint.get("sky-atmosphere-halo-color"),Z=a.paint.get("sky-atmosphere-sun-intensity"),Y=((ne,ge,Te,Ae,Se)=>({u_matrix_3f:ne,u_sun_direction:ge,u_sun_intensity:Te,u_color_tint_r:[Ae.r,Ae.g,Ae.b,Ae.a],u_color_tint_m:[Se.r,Se.g,Se.b,Se.a],u_luminance:5e-5}))(r.fromMat4(r.create$1(),v),S,Z,z,j);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+A,a.skyboxTexture,0),f.draw(_,R.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.frontCW,Y,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const Ch=r.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ah{constructor(a){const f=new r.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const v=new r.StructArrayLayout3ui6;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(f,Ch.members),this.indexBuffer=a.createIndexBuffer(v),this.segments=r.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Bl={symbol:function(_,a,f,v,S){if(_.renderPass!=="translucent")return;const A=r.StencilMode.disabled,R=_.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(z,j,Z,Y,ne,ge,Te){const Ae=j.transform,Se=ne==="map",ke=ge==="map";for(const re of z){const we=Y.getTile(re),De=we.getBucket(Z);if(!De||!De.text||!De.text.segments.get().length)continue;const Re=r.evaluateSizeForZoom(De.textSizeData,Ae.zoom),Ye=us(re,De.getProjection(),Ae),We=Ae.calculatePixelsToTileUnitsMatrix(we),Ke=Ct(Ye,we.tileID.canonical,ke,Se,Ae,De.getProjection(),We),lt=Z.layout.get("icon-text-fit")!=="none"&&De.hasIconData();if(Re){const ot=Math.pow(2,Ae.zoom-we.tileID.overscaledZ);Lg(De,Se,ke,Te,r.symbolSize,Ae,Ke,re,ot,Re,lt)}}}(v,_,f,a,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),S),f.paint.get("icon-opacity").constantOr(1)!==0&&Gp(_,a,f,v,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),A,R),f.paint.get("text-opacity").constantOr(1)!==0&&Gp(_,a,f,v,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),A,R),a.map.showCollisionBoxes&&(wh(_,a,f,v,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),wh(_,a,f,v,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(_,a,f,v){if(_.renderPass!=="translucent")return;const S=f.paint.get("circle-opacity"),A=f.paint.get("circle-stroke-width"),R=f.paint.get("circle-stroke-opacity"),z=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)===0&&(A.constantOr(1)===0||R.constantOr(1)===0))return;const j=_.context,Z=j.gl,Y=_.transform,ne=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),ge=r.StencilMode.disabled,Te=_.colorModeForRenderPass(),Ae=Y.projection.name==="globe",Se=[r.mercatorXfromLng(Y.center.lng),r.mercatorYfromLat(Y.center.lat)],ke=[];for(let we=0;we<v.length;we++){const De=v[we],Re=a.getTile(De),Ye=Re.getBucket(f);if(!Ye||Ye.projection.name!==Y.projection.name)continue;const We=Ye.programConfigurations.get(f.id),Ke=sf(f);Ae&&Ke.push("PROJECTION_GLOBE_VIEW");const lt=_.useProgram("circle",We,Ke),ot=Ye.layoutVertexBuffer,_t=Ye.globeExtVertexBuffer,Wt=Ye.indexBuffer,pt=Y.projection.createInversionMatrix(Y,De.canonical),Lt={programConfiguration:We,program:lt,layoutVertexBuffer:ot,globeExtVertexBuffer:_t,indexBuffer:Wt,uniformValues:wc(_,De,Re,pt,Se,f),tile:Re};if(z){const wt=Ye.segments.get();for(const qt of wt)ke.push({segments:new r.SegmentVector([qt]),sortKey:qt.sortKey,state:Lt})}else ke.push({segments:Ye.segments,sortKey:0,state:Lt})}z&&ke.sort((we,De)=>we.sortKey-De.sortKey);const re={useDepthForOcclusion:!Ae};for(const we of ke){const{programConfiguration:De,program:Re,layoutVertexBuffer:Ye,globeExtVertexBuffer:We,indexBuffer:Ke,uniformValues:lt,tile:ot}=we.state,_t=we.segments;_.terrain&&_.terrain.setupElevationDraw(ot,Re,re),_.prepareDrawProgram(j,Re,ot.tileID.toUnwrapped()),Re.draw(j,Z.TRIANGLES,ne,ge,Te,r.CullFaceMode.disabled,lt,f.id,Ye,Ke,_t,f.paint,Y.zoom,De,[We])}},heatmap:function(_,a,f,v){if(f.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const S=_.context,A=S.gl,R=r.StencilMode.disabled,z=new r.ColorMode([A.ONE,A.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(Te,Ae,Se,ke){const re=Te.gl,we=Ae.width*ke,De=Ae.height*ke;Te.activeTexture.set(re.TEXTURE1),Te.viewport.set([0,0,we,De]);let Re=Se.heatmapFbo;if(!Re||Re&&(Re.width!==we||Re.height!==De)){Re&&Re.destroy();const Ye=re.createTexture();re.bindTexture(re.TEXTURE_2D,Ye),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,re.LINEAR),Re=Se.heatmapFbo=Te.createFramebuffer(we,De,!1),function(We,Ke,lt,ot,_t,Wt){const pt=We.gl;pt.texImage2D(pt.TEXTURE_2D,0,We.isWebGL2&&We.extRenderToTextureHalfFloat?pt.RGBA16F:pt.RGBA,_t,Wt,0,pt.RGBA,We.extRenderToTextureHalfFloat?We.isWebGL2?pt.HALF_FLOAT:We.extTextureHalfFloat.HALF_FLOAT_OES:pt.UNSIGNED_BYTE,null),ot.colorAttachment.set(lt)}(Te,0,Ye,Re,we,De)}else re.bindTexture(re.TEXTURE_2D,Re.colorAttachment.get()),Te.bindFramebuffer.set(Re.framebuffer)})(S,_,f,_.transform.projection.name==="globe"?.5:.25),S.clear({color:r.Color.transparent});const j=_.transform,Z=j.projection.name==="globe",Y=Z?["PROJECTION_GLOBE_VIEW"]:null,ne=Z?r.CullFaceMode.frontCCW:r.CullFaceMode.disabled,ge=[r.mercatorXfromLng(j.center.lng),r.mercatorYfromLat(j.center.lat)];for(let Te=0;Te<v.length;Te++){const Ae=v[Te];if(a.hasRenderableParent(Ae))continue;const Se=a.getTile(Ae),ke=Se.getBucket(f);if(!ke||ke.projection.name!==j.projection.name)continue;const re=ke.programConfigurations.get(f.id),we=_.useProgram("heatmap",re,Y),{zoom:De}=_.transform;_.terrain&&_.terrain.setupElevationDraw(Se,we),_.prepareDrawProgram(S,we,Ae.toUnwrapped());const Re=j.projection.createInversionMatrix(j,Ae.canonical);we.draw(S,A.TRIANGLES,r.DepthMode.disabled,R,z,ne,Wp(_,Ae,Se,Re,ge,De,f.paint.get("heatmap-intensity")),f.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,f.paint,_.transform.zoom,re,Z?[ke.globeExtVertexBuffer]:null)}S.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(S,A){const R=S.context,z=R.gl,j=A.heatmapFbo;if(!j)return;R.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,j.colorAttachment.get()),R.activeTexture.set(z.TEXTURE1);let Z=A.colorRampTexture;Z||(Z=A.colorRampTexture=new r.Texture(R,A.colorRamp,z.RGBA)),Z.bind(z.LINEAR,z.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(R,z.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,S.colorModeForRenderPass(),r.CullFaceMode.disabled,((Y,ne,ge,Te)=>({u_image:0,u_color_ramp:1,u_opacity:ne.paint.get("heatmap-opacity")}))(0,A),A.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,A.paint,S.transform.zoom)}(_,f))},line:function(_,a,f,v){if(_.renderPass!=="translucent")return;const S=f.paint.get("line-opacity"),A=f.paint.get("line-width");if(S.constantOr(1)===0||A.constantOr(1)===0)return;const R=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),z=_.colorModeForRenderPass(),j=_.terrain&&_.terrain.renderingToTexture?1:r.exported.devicePixelRatio,Z=f.paint.get("line-dasharray"),Y=Z.constantOr(1),ne=f.layout.get("line-cap"),ge=f.paint.get("line-pattern"),Te=ge.constantOr(1),Ae=f.paint.get("line-gradient"),Se=Te?"linePattern":"line",ke=_.context,re=ke.gl,we=(Re=>{const Ye=[];xh(Re)&&Ye.push("RENDER_LINE_DASH"),Re.paint.get("line-gradient")&&Ye.push("RENDER_LINE_GRADIENT");const We=Re.paint.get("line-trim-offset");We[0]===0&&We[1]===0||Ye.push("RENDER_LINE_TRIM_OFFSET");const Ke=Re.paint.get("line-pattern").constantOr(1),lt=Re.paint.get("line-opacity").constantOr(1)!==1;return!Ke&&lt&&Ye.push("RENDER_LINE_ALPHA_DISCARD"),Ye})(f);let De=we.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(De=!1);for(const Re of v){const Ye=a.getTile(Re);if(Te&&!Ye.patternsLoaded())continue;const We=Ye.getBucket(f);if(!We)continue;_.prepareDrawTile();const Ke=We.programConfigurations.get(f.id),lt=_.useProgram(Se,Ke,we),ot=ge.constantOr(null);if(ot&&Ye.imageAtlas){const Ot=Ye.imageAtlas.patternPositions[ot.toString()];Ot&&Ke.setConstantPatternPositions(Ot)}const _t=Z.constantOr(null),Wt=ne.constantOr(null);if(!Te&&_t&&Wt&&Ye.lineAtlas){const Ot=Ye.lineAtlas.getDash(_t,Wt);Ot&&Ke.setConstantPatternPositions(Ot)}let[pt,Lt]=f.paint.get("line-trim-offset");(Wt==="round"||Wt==="square")&&pt!==Lt&&(pt===0&&(pt-=1),Lt===1&&(Lt+=1));const wt=_.terrain?Re.projMatrix:null,qt=Te?yh(_,Ye,f,wt,j):Ol(_,Ye,f,wt,We.lineClipsArray.length,j,[pt,Lt]);if(Ae){const Ot=We.gradients[f.id];let Xt=Ot.texture;if(f.gradientVersion!==Ot.version){let kt=256;if(f.stepInterpolant){const Jt=a.getSource().maxzoom,Pi=Re.canonical.z===Jt?Math.ceil(1<<_.transform.maxZoom-Re.canonical.z):1;kt=r.clamp(r.nextPowerOfTwo(We.maxLineLength/r.EXTENT*1024*Pi),256,ke.maxTextureSize)}Ot.gradient=r.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:kt,image:Ot.gradient||void 0,clips:We.lineClipsArray}),Ot.texture?Ot.texture.update(Ot.gradient):Ot.texture=new r.Texture(ke,Ot.gradient,re.RGBA),Ot.version=f.gradientVersion,Xt=Ot.texture}ke.activeTexture.set(re.TEXTURE1),Xt.bind(f.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}Y&&(ke.activeTexture.set(re.TEXTURE0),Ye.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),Ke.updatePaintBuffers()),Te&&(ke.activeTexture.set(re.TEXTURE0),Ye.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Ke.updatePaintBuffers()),_.prepareDrawProgram(ke,lt,Re.toUnwrapped());const dt=Ot=>{lt.draw(ke,re.TRIANGLES,R,Ot,z,r.CullFaceMode.disabled,qt,f.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,f.paint,_.transform.zoom,Ke,[We.layoutVertexBuffer2])};if(De){const Ot=_.stencilModeForClipping(Re).ref;Ot===0&&_.terrain&&ke.clear({stencil:0});const Xt={func:re.EQUAL,mask:255};qt.u_alpha_discard_threshold=.8,dt(new r.StencilMode(Xt,Ot,255,re.KEEP,re.KEEP,re.INVERT)),qt.u_alpha_discard_threshold=0,dt(new r.StencilMode(Xt,Ot,255,re.KEEP,re.KEEP,re.KEEP))}else dt(_.stencilModeForClipping(Re))}De&&(_.resetStencilClippingMasks(),_.terrain&&ke.clear({stencil:0}))},fill:function(_,a,f,v){const S=f.paint.get("fill-color"),A=f.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const R=_.colorModeForRenderPass(),z=f.paint.get("fill-pattern"),j=_.opaquePassEnabledForLayer()&&!z.constantOr(1)&&S.constantOr(r.Color.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===j){const Z=_.depthModeForSublayer(1,_.renderPass==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly);hf(_,a,f,v,Z,R,!1)}if(_.renderPass==="translucent"&&f.paint.get("fill-antialias")){const Z=_.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,r.DepthMode.ReadOnly);hf(_,a,f,v,Z,R,!0)}},"fill-extrusion":function(_,a,f,v){const S=f.paint.get("fill-extrusion-opacity");if(S!==0&&_.renderPass==="translucent"){const A=new r.DepthMode(_.context.gl.LEQUAL,r.DepthMode.ReadWrite,_.depthRangeFor3D);if(S!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))Lu(_,a,f,v,A,r.StencilMode.disabled,r.ColorMode.disabled),Lu(_,a,f,v,A,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const R=_.colorModeForRenderPass();Lu(_,a,f,v,A,r.StencilMode.disabled,R)}}},hillshade:function(_,a,f,v){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const S=_.context,A=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),R=_.colorModeForRenderPass(),z=_.terrain&&_.terrain.renderingToTexture,[j,Z]=_.renderPass!=="translucent"||z?[{},v]:_.stencilConfigForOverlap(v);for(const Y of Z){const ne=a.getTile(Y);if(ne.needsHillshadePrepare&&_.renderPass==="offscreen")bu(_,ne,f,A,r.StencilMode.disabled,R);else if(_.renderPass==="translucent"){const ge=z&&_.terrain?_.terrain.stencilModeForRTTOverlap(Y):j[Y.overscaledZ];Yd(_,Y,ne,f,A,ge,R)}}S.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,a,f,v,S,A){if(_.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!v.length)return;const R=_.context,z=R.gl,j=a.getSource(),Z=_.useProgram("raster"),Y=_.colorModeForRenderPass(),ne=_.terrain&&_.terrain.renderingToTexture,[ge,Te]=j instanceof zi||ne?[{},v]:_.stencilConfigForOverlap(v),Ae=Te[Te.length-1].overscaledZ,Se=!_.options.moving;for(const ke of Te){const re=ne?r.DepthMode.disabled:_.depthModeForSublayer(ke.overscaledZ-Ae,f.paint.get("raster-opacity")===1?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly,z.LESS),we=ke.toUnwrapped(),De=a.getTile(ke);if(ne&&(!De||!De.hasData()))continue;const Re=ne?ke.projMatrix:_.transform.calculateProjMatrix(we,Se),Ye=_.terrain&&ne?_.terrain.stencilModeForRTTOverlap(ke):ge[ke.overscaledZ],We=A?0:f.paint.get("raster-fade-duration");De.registerFadeDuration(We);const Ke=a.findLoadedParent(ke,0),lt=Kd(De,Ke,a,_.transform,We);let ot,_t;_.terrain&&_.terrain.prepareDrawTile();const Wt=f.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;R.activeTexture.set(z.TEXTURE0),De.texture.bind(Wt,z.CLAMP_TO_EDGE),R.activeTexture.set(z.TEXTURE1),Ke?(Ke.texture.bind(Wt,z.CLAMP_TO_EDGE),ot=Math.pow(2,Ke.tileID.overscaledZ-De.tileID.overscaledZ),_t=[De.tileID.canonical.x*ot%1,De.tileID.canonical.y*ot%1]):De.texture.bind(Wt,z.CLAMP_TO_EDGE),De.texture.useMipmap&&R.extTextureFilterAnisotropic&&_.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const pt=vh(Re,_t||[0,0],ot||1,lt,f,j instanceof zi?j.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(R,Z,we),j instanceof zi)j.boundsBuffer&&j.boundsSegments&&Z.draw(R,z.TRIANGLES,re,r.StencilMode.disabled,Y,r.CullFaceMode.disabled,pt,f.id,j.boundsBuffer,_.quadTriangleIndexBuffer,j.boundsSegments);else{const{tileBoundsBuffer:Lt,tileBoundsIndexBuffer:wt,tileBoundsSegments:qt}=_.getTileBoundsBuffers(De);Z.draw(R,z.TRIANGLES,re,Ye,Y,r.CullFaceMode.disabled,pt,f.id,Lt,wt,qt)}}_.resetStencilClippingMasks()},background:function(_,a,f,v){const S=f.paint.get("background-color"),A=f.paint.get("background-opacity");if(A===0)return;const R=_.context,z=R.gl,j=_.transform,Z=j.tileSize,Y=f.paint.get("background-pattern");if(_.isPatternMissing(Y))return;const ne=!Y&&S.a===1&&A===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==ne)return;const ge=r.StencilMode.disabled,Te=_.depthModeForSublayer(0,ne==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly),Ae=_.colorModeForRenderPass(),Se=_.useProgram(Y?"backgroundPattern":"background");let ke,re=v;re||(ke=_.getBackgroundTiles(),re=Object.values(ke).map(we=>we.tileID)),Y&&(R.activeTexture.set(z.TEXTURE0),_.imageManager.bind(_.context));for(const we of re){const De=we.toUnwrapped(),Re=v?we.projMatrix:_.transform.calculateProjMatrix(De);_.prepareDrawTile();const Ye=a?a.getTile(we):ke?ke[we.key]:new r.Tile(we,Z,j.zoom,_),We=Y?Pg(Re,A,_,Y,{tileID:we,tileSize:Z}):of(Re,A,S);_.prepareDrawProgram(R,Se,De);const{tileBoundsBuffer:Ke,tileBoundsIndexBuffer:lt,tileBoundsSegments:ot}=_.getTileBoundsBuffers(Ye);Se.draw(R,z.TRIANGLES,Te,ge,Ae,r.CullFaceMode.disabled,We,f.id,Ke,lt,ot)}},sky:function(_,a,f){const v=_.transform,S=v.projection.name==="mercator"||v.projection.name==="globe"?1:r.smoothstep(7,8,v.zoom),A=f.paint.get("sky-opacity")*S;if(A===0)return;const R=_.context,z=f.paint.get("sky-type"),j=new r.DepthMode(R.gl.LEQUAL,r.DepthMode.ReadOnly,[0,1]),Z=_.frameCounter/1e3%1;z==="atmosphere"?_.renderPass==="offscreen"?f.needsSkyboxCapture(_)&&(function(Y,ne,ge,Te){const Ae=Y.context,Se=Ae.gl;let ke=ne.skyboxFbo;if(!ke){ke=ne.skyboxFbo=Ae.createFramebuffer(32,32,!1),ne.skyboxGeometry=new Mh(Ae),ne.skyboxTexture=Ae.gl.createTexture(),Se.bindTexture(Se.TEXTURE_CUBE_MAP,ne.skyboxTexture),Se.texParameteri(Se.TEXTURE_CUBE_MAP,Se.TEXTURE_WRAP_S,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_CUBE_MAP,Se.TEXTURE_WRAP_T,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_CUBE_MAP,Se.TEXTURE_MIN_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_CUBE_MAP,Se.TEXTURE_MAG_FILTER,Se.LINEAR);for(let Re=0;Re<6;++Re)Se.texImage2D(Se.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,Se.RGBA,32,32,0,Se.RGBA,Se.UNSIGNED_BYTE,null)}Ae.bindFramebuffer.set(ke.framebuffer),Ae.viewport.set([0,0,32,32]);const re=ne.getCenter(Y,!0),we=Y.useProgram("skyboxCapture"),De=new Float64Array(16);r.identity(De),r.rotateY(De,De,.5*-Math.PI),Tr(Ae,ne,we,De,re,0),r.identity(De),r.rotateY(De,De,.5*Math.PI),Tr(Ae,ne,we,De,re,1),r.identity(De),r.rotateX(De,De,.5*-Math.PI),Tr(Ae,ne,we,De,re,2),r.identity(De),r.rotateX(De,De,.5*Math.PI),Tr(Ae,ne,we,De,re,3),r.identity(De),Tr(Ae,ne,we,De,re,4),r.identity(De),r.rotateY(De,De,Math.PI),Tr(Ae,ne,we,De,re,5),Ae.viewport.set([0,0,Y.width,Y.height])}(_,f),f.markSkyboxValid(_)):_.renderPass==="sky"&&function(Y,ne,ge,Te,Ae){const Se=Y.context,ke=Se.gl,re=Y.transform,we=Y.useProgram("skybox");Se.activeTexture.set(ke.TEXTURE0),ke.bindTexture(ke.TEXTURE_CUBE_MAP,ne.skyboxTexture);const De=((Re,Ye,We,Ke,lt)=>({u_matrix:Re,u_sun_direction:Ye,u_cubemap:0,u_opacity:Ke,u_temporal_offset:lt}))(re.skyboxMatrix,ne.getCenter(Y,!1),0,Te,Ae);Y.prepareDrawProgram(Se,we),we.draw(Se,ke.TRIANGLES,ge,r.StencilMode.disabled,Y.colorModeForRenderPass(),r.CullFaceMode.backCW,De,"skybox",ne.skyboxGeometry.vertexBuffer,ne.skyboxGeometry.indexBuffer,ne.skyboxGeometry.segment)}(_,f,j,A,Z):z==="gradient"&&_.renderPass==="sky"&&function(Y,ne,ge,Te,Ae){const Se=Y.context,ke=Se.gl,re=Y.transform,we=Y.useProgram("skyboxGradient");ne.skyboxGeometry||(ne.skyboxGeometry=new Mh(Se)),Se.activeTexture.set(ke.TEXTURE0);let De=ne.colorRampTexture;De||(De=ne.colorRampTexture=new r.Texture(Se,ne.colorRamp,ke.RGBA)),De.bind(ke.LINEAR,ke.CLAMP_TO_EDGE);const Re=((Ye,We,Ke,lt,ot)=>({u_matrix:Ye,u_color_ramp:0,u_center_direction:We,u_radius:r.degToRad(Ke),u_opacity:lt,u_temporal_offset:ot}))(re.skyboxMatrix,ne.getCenter(Y,!1),ne.paint.get("sky-gradient-radius"),Te,Ae);Y.prepareDrawProgram(Se,we),we.draw(Se,ke.TRIANGLES,ge,r.StencilMode.disabled,Y.colorModeForRenderPass(),r.CullFaceMode.backCW,Re,"skyboxGradient",ne.skyboxGeometry.vertexBuffer,ne.skyboxGeometry.indexBuffer,ne.skyboxGeometry.segment)}(_,f,j,A,Z)},debug:function(_,a,f){for(let v=0;v<f.length;v++)Bg(_,a,f[v])},custom:function(_,a,f,v){const S=_.context,A=f.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&f.isLayerDraped()){if(_.renderPass==="offscreen"){const R=A.prerender;if(R){if(_.setCustomLayerDefaults(),S.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const z=_.transform.pointMerc;R.call(A,S.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),r.globeToMercatorTransition(_.transform.zoom),[z.x,z.y],_.transform.pixelsPerMeterRatio)}else R.call(A,S.gl,_.transform.customLayerMatrix());S.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const z=A.renderToTile;if(z){const j=v[0].canonical,Z=new r.MercatorCoordinate(j.x+v[0].wrap*(1<<j.z),j.y,j.z);S.setDepthMode(r.DepthMode.disabled),S.setStencilMode(r.StencilMode.disabled),S.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),z.call(A,S.gl,Z),S.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),S.setColorMode(_.colorModeForRenderPass()),S.setStencilMode(r.StencilMode.disabled);const R=A.renderingMode==="3d"?new r.DepthMode(_.context.gl.LEQUAL,r.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,r.DepthMode.ReadOnly);if(S.setDepthMode(R),_.transform.projection.name==="globe"){const z=_.transform.pointMerc;A.render(S.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),r.globeToMercatorTransition(_.transform.zoom),[z.x,z.y],_.transform.pixelsPerMeterRatio)}else A.render(S.gl,_.transform.customLayerMatrix());S.setDirty(),_.setBaseState(),S.bindFramebuffer.set(null)}}else r.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Mc{constructor(a,f,v=!1){this.context=new ni(a,v),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=r.SourceCache.maxUnderzooming+r.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(a,f){const v=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Jd(this,a));const S=this._terrain;this.transform.elevation=v?S:null,S.update(a,this.transform,f)}_updateFog(a){const f=a.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,S]=f.getFovAdjustedRange(this.transform._fov);if(v>S)return void(this.transform.fogCullDistSq=null);const A=v+.78*(S-v);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(a,f){if(this.width=a*r.exported.devicePixelRatio,this.height=f*r.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._layers[v].resize()}setup(){const a=this.context,f=new r.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(r.EXTENT,0),f.emplaceBack(0,r.EXTENT),f.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(f,r.posAttributes.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);const v=new r.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(r.EXTENT,0),v.emplaceBack(0,r.EXTENT),v.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=a.createVertexBuffer(v,r.posAttributes.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);const S=new r.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(S,r.posAttributes.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);const A=new r.StructArrayLayout4i8;A.emplaceBack(0,0,0,0),A.emplaceBack(r.EXTENT,0,r.EXTENT,0),A.emplaceBack(0,r.EXTENT,0,r.EXTENT),A.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.mercatorBoundsBuffer=a.createVertexBuffer(A,r.boundsAttributes.members),this.mercatorBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);const R=new r.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(R);const z=new r.StructArrayLayout1ui2;for(const Z of[0,1,3,2,0])z.emplaceBack(Z);this.debugIndexBuffer=a.createIndexBuffer(z),this.emptyTexture=new r.Texture(a,new r.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA),this.identityMat=r.create();const j=this.context.gl;this.stencilClearMode=new r.StencilMode({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.loadTimeStamps.push(r.window.performance.now()),this.atmosphereBuffer=new Ah(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context,f=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(a,f.TRIANGLES,r.DepthMode.disabled,this.stencilClearMode,r.ColorMode.disabled,r.CullFaceMode.disabled,gh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,f,v){if(!f||this.currentStencilSource===f.id||!a.isTileClipped()||!v||v.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const j of v)if(this._tileClippingMaskIDs[j.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=f.id;const S=this.context,A=S.gl;this.nextStencilID+v.length>256&&this.clearStencil(),S.setColorMode(r.ColorMode.disabled),S.setDepthMode(r.DepthMode.disabled);const R=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of v){const j=f.getTile(z),Z=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ne,tileBoundsSegments:ge}=this.getTileBoundsBuffers(j);R.draw(S,A.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:A.ALWAYS,mask:0},Z,255,A.KEEP,A.KEEP,A.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,gh(z.projMatrix),"$clipping",Y,ne,ge)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,f=this.context.gl;return new r.StencilMode({func:f.NOTEQUAL,mask:255},a,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const f=this.context.gl;return new r.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(a){const f=this.context.gl,v=a.sort((R,z)=>z.overscaledZ-R.overscaledZ),S=v[v.length-1].overscaledZ,A=v[0].overscaledZ-S+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const R={};for(let z=0;z<A;z++)R[z+S]=new r.StencilMode({func:f.GEQUAL,mask:255},z+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=A,[R,v]}return[{[S]:r.StencilMode.disabled},v]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new r.ColorMode([a.CONSTANT_COLOR,a.ONE],new r.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.ColorMode.unblended:r.ColorMode.alphaBlended}depthModeForSublayer(a,f,v){if(!this.opaquePassEnabledForLayer())return r.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new r.DepthMode(v||this.context.gl.LEQUAL,f,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,f){this.style=a,this.options=f,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(r.exported.now()),this.imageManager.beginFrame();const v=this.style.order,S=this.style._sourceCaches;for(const Z in S){const Y=S[Z];Y.used&&Y.prepare(this.context)}const A={},R={},z={};for(const Z in S){const Y=S[Z];A[Z]=Y.getVisibleCoordinates(),R[Z]=A[Z].slice().reverse(),z[Z]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Z=0;Z<v.length;Z++)if(this.style._layers[v[Z]].is3D()){this.opaquePassCutoff=Z;break}if(this.terrain&&(this.terrain.updateTileBinding(z),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.GlobeSharedBuffers(this.context)),!r.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const Z of v){const Y=this.style._layers[Z],ne=a._getLayerSourceCache(Y);if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const ge=ne?R[ne.id]:void 0;(Y.type==="custom"||Y.isSky()||ge&&ge.length)&&this.renderLayer(this,ne,Y,ge)}this.depthRangeFor3D=[0,1-(a.order.length+2)*this.numSublayers*this.depthEpsilon];const j=this.terrain;if(j&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&j.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?r.Color.black:r.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const Z=this.style._layers[v[this.currentLayer]],Y=a._getLayerSourceCache(Z);if(Z.isSky())continue;const ne=Y?R[Y.id]:void 0;this._renderTileClippingMasks(Z,Y,ne),this.renderLayer(this,Y,Z,ne)}if(this.style.fog&&this.transform.projection.supportsFog&&function(Z,Y){const ne=Z.context,ge=ne.gl,Te=Z.transform,Ae=new r.DepthMode(ge.LEQUAL,r.DepthMode.ReadOnly,[0,1]),Se=Z.useProgram("globeAtmosphere",null,Te.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ke=r.globeToMercatorTransition(Te.zoom),re=Y.properties.get("color").toArray01(),we=Y.properties.get("high-color").toArray01(),De=Y.properties.get("space-color").toArray01PremultipliedAlpha(),Re=r.identity$1([]);r.rotateY$1(Re,Re,-r.degToRad(Te._center.lng)),r.rotateX$1(Re,Re,r.degToRad(Te._center.lat)),r.rotateZ$1(Re,Re,Te.angle),r.rotateX$1(Re,Re,-Te._pitch);const Ye=r.fromQuat(new Float32Array(16),Re),We=r.mapValue(Y.properties.get("star-intensity"),0,1,0,.25),Ke=5e-4,lt=r.mapValue(Y.properties.get("horizon-blend"),0,1,Ke,.25),ot=r.globeUseCustomAntiAliasing(Z,ne,Te)&&lt===Ke?Te.worldSize/(2*Math.PI*1.025)-1:Te.globeRadius,_t=Z.frameCounter/1e3%1,Wt=r.length(Te.globeCenterInViewSpace),pt=Math.sqrt(Math.pow(Wt,2)-Math.pow(ot,2)),Lt=Math.acos(pt/Wt),wt=((dt,Ot,Xt,kt,Jt,Pi,$i,wi,Li,Zi,Yi,Ci,Rn,Un)=>({u_frustum_tl:dt,u_frustum_tr:Ot,u_frustum_br:Xt,u_frustum_bl:kt,u_horizon:Jt,u_transition:Pi,u_fadeout_range:$i,u_color:wi,u_high_color:Li,u_space_color:Zi,u_star_intensity:Yi,u_star_size:5*r.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ci,u_horizon_angle:Rn,u_rotation_matrix:Un}))(Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.frustumCorners.horizon,ke,lt,re,we,De,We,_t,Lt,Ye);Z.prepareDrawProgram(ne,Se);const qt=Z.atmosphereBuffer;qt&&Se.draw(ne,ge.TRIANGLES,Ae,r.StencilMode.disabled,r.ColorMode.alphaBlended,r.CullFaceMode.backCW,wt,"skybox",qt.vertexBuffer,qt.indexBuffer,qt.segments)}(this,this.style.fog),this.renderPass="sky",(r.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const Z=this.style._layers[v[this.currentLayer]],Y=a._getLayerSourceCache(Z);Z.isSky()&&this.renderLayer(this,Y,Z,Y?R[Y.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;){const Z=this.style._layers[v[this.currentLayer]],Y=a._getLayerSourceCache(Z);if(Z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(Z)){if(Z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ne=Y?(Z.type==="symbol"?z:R)[Y.id]:void 0;this._renderTileClippingMasks(Z,Y,Y?A[Y.id]:void 0),this.renderLayer(this,Y,Z,ne),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Z=null;r.values(this.style._layers).forEach(Y=>{const ne=a._getLayerSourceCache(Y);ne&&!Y.isHidden(this.transform.zoom)&&(!Z||Z.getSource().maxzoom<ne.getSource().maxzoom)&&(Z=ne)}),Z&&this.options.showTileBoundaries&&Bl.debug(this,Z,Z.getVisibleCoordinates())}this.options.showPadding&&function(Z){const Y=Z.transform.padding;Eh(Z,Z.transform.height-(Y.top||0),3,po),Eh(Z,Y.bottom||0,3,Dg),Ec(Z,Y.left||0,3,Og),Ec(Z,Z.transform.width-(Y.right||0),3,Rg);const ne=Z.transform.centerPoint;(function(ge,Te,Ae,Se){Sc(ge,Te-1,Ae-10,2,20,Se),Sc(ge,Te-10,Ae-1,20,2,Se)})(Z,ne.x,Z.transform.height-ne.y,zg)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(r.window.performance.now()),this.saveCanvasCopy())}renderLayer(a,f,v,S){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="sky"||v.type==="custom"||S&&S.length)&&(this.id=v.id,this.gpuTimingStart(v),(!a.transform.projection.unsupportedLayers||!a.transform.projection.unsupportedLayers.includes(v.type)||a.terrain&&v.type==="custom")&&Bl[v.type](a,f,v,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let v=this.gpuTimers[a.id];v||(v=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),v.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,f=a.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),a.beginQueryEXT(a.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const f={};for(const v in a){const S=a[v],A=this.context.extTimerQuery,R=A.getQueryObjectEXT(S.query,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(S.query),f[v]=R}return f}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let v=0;for(const S of a)v+=f.getQueryObjectEXT(S,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(S);return v}translatePosMatrix(a,f,v,S,A){if(!v[0]&&!v[1])return a;const R=A?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(R){const Z=Math.sin(R),Y=Math.cos(R);v=[v[0]*Y-v[1]*Z,v[0]*Z+v[1]*Y]}const z=[A?v[0]:ji(f,v[0],this.transform.zoom),A?v[1]:ji(f,v[1],this.transform.zoom),0],j=new Float32Array(16);return r.translate(j,a,z),j}saveTileTexture(a){const f=this._tileTextures[a.size[0]];f?f.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const f=this._tileTextures[a];return f&&f.length>0?f.pop():null}isPatternMissing(a){return a===null||a!==void 0&&!this.imageManager.getPattern(a.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const a=this.terrain&&this.terrain.renderingToTexture,f=this.terrain&&this.terrain.exaggeration()===0,v=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),this.transform.projection.name==="globe"&&S.push("GLOBE"),f&&S.push("ZERO_EXAGGERATION"),v&&!a&&v.getOpacity(this.transform.pitch)!==0&&S.push("FOG"),a&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(a,f,v){this.cache=this.cache||{};const S=v||[],A=this.currentGlobalDefines().concat(S),R=_n.cacheKey(xu[a],a,A,f);return this.cache[R]||(this.cache[R]=new _n(this.context,a,xu[a],f,af[a],A)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(a,f,v){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const A=S.getOpacity(this.transform.pitch),R=((z,j,Z,Y,ne,ge,Te,Ae,Se,ke,re)=>{const we=z.transform,De=j.properties.get("color").toArray01();De[3]=Y;const Re=z.frameCounter/1e3%1;return{u_fog_matrix:Z?we.calculateFogTileMatrix(Z):z.identityMat,u_fog_range:j.getFovAdjustedRange(we._fov),u_fog_color:De,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_temporal_offset:Re,u_frustum_tl:ne,u_frustum_tr:ge,u_frustum_br:Te,u_frustum_bl:Ae,u_globe_pos:Se,u_globe_radius:ke,u_viewport:re,u_globe_transition:r.globeToMercatorTransition(we.zoom),u_is_globe:+(we.projection.name==="globe")}})(this,S,v,A,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.exported.devicePixelRatio,this.transform.height*r.exported.devicePixelRatio]);f.setFogUniformValues(a,R)}}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){const a=this.canvasCopy();a&&(this.frameCopies.push(a),this.tileLoaded=!1)}canvasCopy(){const a=this.context.gl,f=a.createTexture();return a.bindTexture(a.TEXTURE_2D,f),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&a.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const a=this._backgroundTiles,f=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const S of v)f[S.key]=a[S.key]||new r.Tile(S,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class io{constructor(a=0,f=0,v=0,S=0){if(isNaN(a)||a<0||isNaN(f)||f<0||isNaN(v)||v<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=f,this.left=v,this.right=S}interpolate(a,f,v){return f.top!=null&&a.top!=null&&(this.top=r.number(a.top,f.top,v)),f.bottom!=null&&a.bottom!=null&&(this.bottom=r.number(a.bottom,f.bottom,v)),f.left!=null&&a.left!=null&&(this.left=r.number(a.left,f.left,v)),f.right!=null&&a.right!=null&&(this.right=r.number(a.right,f.right,v)),this}getCenter(a,f){const v=r.clamp((this.left+a-this.right)/2,0,a),S=r.clamp((this.top+f-this.bottom)/2,0,f);return new r.Point(v,S)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new io(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fa(_,a){const f=r.getColumn(_,3);r.fromQuat(_,a),r.setColumn(_,3,f)}function Tn(_,a){const f=r.identity$1([]);return r.rotateZ$1(f,f,-a),r.rotateX$1(f,f,-_),f}function Cc(_,a){const f=[_[0],_[1],0],v=[a[0],a[1],0];if(r.length(f)>=1e-15){const R=r.normalize([],f);r.scale$2(v,R,r.dot(v,R)),a[0]=v[0],a[1]=v[1]}const S=r.cross([],a,_);if(r.len(S)<1e-15)return null;const A=Math.atan2(-S[1],S[0]);return Tn(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),A)}class Hp{constructor(a,f){this.position=a,this.orientation=f}get position(){return this._position}set position(a){if(a){const f=a instanceof r.MercatorCoordinate?a:new r.MercatorCoordinate(a[0],a[1],a[2]);this._renderWorldCopies&&(f.x=r.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(a,f){if(this.orientation=null,!this.position)return;const v=this.position,S=this._elevation?this._elevation.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(a)):0,A=r.MercatorCoordinate.fromLngLat(a,S),R=[A.x-v.x,A.y-v.y,A.z-v.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Cc(R,f)}setPitchBearing(a,f){this.orientation=Tn(r.degToRad(a),r.degToRad(-f))}}class Ac{constructor(a,f){this._transform=r.identity([]),this.orientation=f,this.position=a}get mercatorPosition(){const a=this.position;return new r.MercatorCoordinate(a[0],a[1],a[2])}get position(){const a=r.getColumn(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var f;a&&r.setColumn(this._transform,3,[(f=a)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||r.identity$1([]),a&&Fa(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,f){this._orientation=Tn(a,f),Fa(this._transform,this._orientation)}forward(){const a=r.getColumn(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=r.getColumn(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=r.getColumn(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,f){const v=new Float64Array(16);return r.invert(v,this.getWorldToCamera(a,f)),v}getWorldToCameraPosition(a,f,v){const S=this.position;r.scale$2(S,S,-a);const A=new Float64Array(16);return r.fromScaling(A,[v,v,v]),r.translate(A,A,S),A[10]*=f,A}getWorldToCamera(a,f){const v=new Float64Array(16),S=new Float64Array(4),A=this.position;return r.conjugate(S,this._orientation),r.scale$2(A,A,-a),r.fromQuat(v,S),r.translate(v,v,A),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=f,v[9]*=f,v[10]*=f,v[11]*=f,v}getCameraToClipPerspective(a,f,v,S){const A=new Float64Array(16);return r.perspective(A,a,f,v,S),A}getDistanceToElevation(a,f=!1){const v=a===0?0:r.mercatorZfromAltitude(a,f?r.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(v-this.position[2])/S[2]}clone(){return new Ac([...this.position],[...this.orientation])}}function kc(_,a){const f=kh(_.projection,_.zoom,_.width,_.height),v=function(A,R,z,j,Z){const Y=new r.LngLat(z.lng-180*Na,z.lat),ne=new r.LngLat(z.lng+180*Na,z.lat),ge=A.project(Y.lng,Y.lat),Te=A.project(ne.lng,ne.lat),Ae=-Math.atan2(Te.y-ge.y,Te.x-ge.x),Se=r.MercatorCoordinate.fromLngLat(z);Se.y=r.clamp(Se.y,-1+Na,1-Na);const ke=Se.toLngLat(),re=A.project(ke.lng,ke.lat),we=r.MercatorCoordinate.fromLngLat(ke);we.x+=Na;const De=we.toLngLat(),Re=A.project(De.lng,De.lat),Ye=Er(Re.x-re.x,Re.y-re.y,Ae),We=r.MercatorCoordinate.fromLngLat(ke);We.y+=Na;const Ke=We.toLngLat(),lt=A.project(Ke.lng,Ke.lat),ot=Er(lt.x-re.x,lt.y-re.y,Ae),_t=Math.abs(Ye.x)/Math.abs(ot.y),Wt=r.identity([]);r.rotateZ(Wt,Wt,-Ae*(1-(Z?0:j)));const pt=r.identity([]);return r.scale(pt,pt,[1,1-(1-_t)*j,1]),pt[4]=-ot.x/ot.y*j,r.rotateZ(pt,pt,Ae),r.multiply(pt,Wt,pt),pt}(_.projection,0,_.center,f,a),S=qp(_);return r.scale(v,v,[S,S,1]),v}function qp(_){const a=_.projection,f=kh(_.projection,_.zoom,_.width,_.height),v=Ou(a,_.center),S=Ou(a,r.LngLat.convert(a.center));return Math.pow(2,v*f+(1-f)*S)}function kh(_,a,f,v,S=1/0){const A=_.range;if(!A)return 0;const R=Math.min(S,Math.max(f,v)),z=Math.log(R/1024)/Math.LN2;return r.smoothstep(A[0]+z,A[1]+z,a)}const Na=1/4e4;function Ou(_,a){const f=r.clamp(a.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),v=new r.LngLat(a.lng-180*Na,f),S=new r.LngLat(a.lng+180*Na,f),A=_.project(v.lng,f),R=_.project(S.lng,f),z=r.MercatorCoordinate.fromLngLat(v),j=r.MercatorCoordinate.fromLngLat(S),Z=R.x-A.x,Y=R.y-A.y,ne=j.x-z.x,ge=j.y-z.y,Te=Math.sqrt((ne*ne+ge*ge)/(Z*Z+Y*Y));return Math.log(Te)/Math.LN2}function Er(_,a,f){const v=Math.cos(f),S=Math.sin(f);return{x:_*v-a*S,y:_*S+a*v}}class On{constructor(a,f,v,S,A,R,z){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=a||0,this._maxZoom=f||22,this._minPitch=v??0,this._maxPitch=S??60,this.setProjection(R),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new io,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ac,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const a=new On(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.mercatorFromTransition=this.mercatorFromTransition,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(a,f=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||v)&&this._updateCameraOnTerrain(),(a||v)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return r.pick(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=r.getProjection(this.projectionOptions);const v=!C(f,this.getProjection());return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setMercatorFromTransition(){const a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.getProjection({name:"mercator"});const f=a!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.Point(this.width,this.height)}get bearing(){return r.wrap(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const f=-a*Math.PI/180;var v;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(v=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),function(S,A,R){var z=A[0],j=A[1],Z=A[2],Y=A[3],ne=Math.sin(R),ge=Math.cos(R);S[0]=z*ge+Z*ne,S[1]=j*ge+Y*ne,S[2]=z*-ne+Z*ge,S[3]=j*-ne+Y*ge}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const f=r.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const a=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/a)}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=r.degToRad(a),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const f=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const a=this._elevation;this._centerAltitude=a.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=a.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let S=0,A=0;for(let R=0;R<f.length;R++){const z=new r.Point(f[R][0]*this.width,v+f[R][1]*(this.height-v)),j=a.pointCoordinate(z);if(!j)continue;const Z=1/Math.hypot(j[0]-this._camera.position[0],j[1]-this._camera.position[1]);S+=j[3]*Z,A+=Z}return A===0?NaN:S/A}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const a=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*f,S=this._mercatorZfromZoom(a),A=this._mercatorZfromZoom(this._maxZoom),R=Math.max(S-v,A);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let v;v=a.z<this._camera.position[2]?[f.x,f.y,f.z]:[a.x,a.y,a.z];const S=r.length(r.sub([],this._camera.position,v));return r.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let f=!1;if(a.orientation&&!r.exactEquals(a.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(a.orientation)),a.position){const v=[a.position.x,a.position.y,a.position.z];r.exactEquals$1(v,this._camera.position)||(this._setCameraPosition(v),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,f=new Hp;return f.position=new r.MercatorCoordinate(a[0],a[1],a[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(a){if(!r.length$1(a))return!1;r.normalize$1(a,a);const f=r.transformQuat([],[0,0,-1],a),v=r.transformQuat([],[0,-1,0],a);if(v[2]<0)return!1;const S=Cc(f,v);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(a){const f=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;a[2]=r.clamp(a[2],S/v,S/f),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,f,v){this._unmodified=!1,this._edgeInsets.interpolate(a,f,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const f=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(a){const f=[new r.UnwrappedTileID(0,a)];if(this.renderWorldCopies){const v=this.pointCoordinate(new r.Point(0,0)),S=this.pointCoordinate(new r.Point(this.width,0)),A=this.pointCoordinate(new r.Point(this.width,this.height)),R=this.pointCoordinate(new r.Point(0,this.height)),z=Math.floor(Math.min(v.x,S.x,A.x,R.x)),j=Math.floor(Math.max(v.x,S.x,A.x,R.x)),Z=1;for(let Y=z-Z;Y<=j+Z;Y++)Y!==0&&f.push(new r.UnwrappedTileID(Y,a))}return f}coveringTiles(a){let f=this.coveringZoomLevel(a);const v=f,S=this.elevation&&!a.isTerrainDEM,A=this.projection.name==="mercator";if(a.minzoom!==void 0&&f<a.minzoom)return[];a.maxzoom!==void 0&&f>a.maxzoom&&(f=a.maxzoom);const R=this.locationCoordinate(this.center),z=this.center.lat,j=1<<f,Z=[j*R.x,j*R.y,0],Y=this.projection.name==="globe",ne=!Y,ge=r.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,ne),Te=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ae=j*r.mercatorZfromAltitude(1,this.center.lat),Se=this._camera.position[2]/r.mercatorZfromAltitude(1,this.center.lat),ke=[j*Te.x,j*Te.y,Se*(ne?1:Ae)],re=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),we=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,De=a.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Re=a.isTerrainDEM?-De:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ye=this.projection.isReprojectedInTileSpace?qp(this):1,We=dt=>{const Xt=new r.MercatorCoordinate(dt.x+25e-6,dt.y,dt.z),kt=new r.MercatorCoordinate(dt.x,dt.y+25e-6,dt.z),Jt=dt.toLngLat(),Pi=Xt.toLngLat(),$i=kt.toLngLat(),wi=this.locationCoordinate(Jt),Li=this.locationCoordinate(Pi),Zi=this.locationCoordinate($i),Yi=Math.hypot(Li.x-wi.x,Li.y-wi.y),Ci=Math.hypot(Zi.x-wi.x,Zi.y-wi.y);return Math.sqrt(Yi*Ci)*Ye/25e-6},Ke=dt=>{const Ot=De,Xt=Re;return{aabb:r.tileAABB(this,j,0,0,0,dt,Xt,Ot,this.projection),zoom:0,x:0,y:0,minZ:Xt,maxZ:Ot,wrap:dt,fullyVisible:!1}},lt=[];let ot=[];const _t=f,Wt=a.reparseOverscaled?v:f,pt=dt=>dt*dt,Lt=pt((Se-this._centerAltitude)*Ae),wt=dt=>{if(!this._elevation||!dt.tileID||!A)return;const Ot=this._elevation.getMinMaxForTile(dt.tileID),Xt=dt.aabb;Ot?(Xt.min[2]=Ot.min,Xt.max[2]=Ot.max,Xt.center[2]=(Xt.min[2]+Xt.max[2])/2):(dt.shouldSplit=qt(dt),dt.shouldSplit||(Xt.min[2]=Xt.max[2]=Xt.center[2]=this._centerAltitude))},qt=dt=>{if(dt.zoom<we)return!0;if(dt.zoom===_t)return!1;if(dt.shouldSplit!=null)return dt.shouldSplit;const Ot=dt.aabb.distanceX(ke),Xt=dt.aabb.distanceY(ke);let kt=Lt,Jt=1;if(Y){kt=pt(dt.aabb.distanceZ(ke));const wi=Math.pow(2,dt.zoom),Li=r.latFromMercatorY((dt.y+1)/wi),Zi=r.latFromMercatorY(dt.y/wi),Yi=Math.min(Math.max(z,Li),Zi),Ci=r.circumferenceAtLatitude(Yi)/r.circumferenceAtLatitude(z);if(Jt=Yi===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ci/this._mercatorScaleRatio),this.zoom<=r.GLOBE_ZOOM_THRESHOLD_MIN&&dt.zoom===_t-1&&Ci>=.9)return!0}else if(S&&(kt=pt(dt.aabb.distanceZ(ke)*Ae)),this.projection.isReprojectedInTileSpace&&v<=5){const wi=Math.pow(2,dt.zoom),Li=We(new r.MercatorCoordinate((dt.x+.5)/wi,(dt.y+.5)/wi));Jt=Li>.85?1:Li}const Pi=Ot*Ot+Xt*Xt+kt,$i=pt((1<<_t-dt.zoom)*re*Jt*((wi,Li)=>{if(Li*pt(.707)<wi)return 1;const Zi=Math.sqrt(Li/wi);return Zi/(1.4144271570014144+(Math.pow(1.1,Zi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(kt,Lt),Pi));return Pi<$i};if(this.renderWorldCopies)for(let dt=1;dt<=3;dt++)lt.push(Ke(-dt)),lt.push(Ke(dt));for(lt.push(Ke(0));lt.length>0;){const dt=lt.pop(),Ot=dt.x,Xt=dt.y;let kt=dt.fullyVisible;if(!kt){const Jt=dt.aabb.intersects(ge);if(Jt===0)continue;kt=Jt===2}if(dt.zoom!==_t&&qt(dt))for(let Jt=0;Jt<4;Jt++){const Pi=(Ot<<1)+Jt%2,$i=(Xt<<1)+(Jt>>1),wi={aabb:A?dt.aabb.quadrant(Jt):r.tileAABB(this,j,dt.zoom+1,Pi,$i,dt.wrap,dt.minZ,dt.maxZ,this.projection),zoom:dt.zoom+1,x:Pi,y:$i,wrap:dt.wrap,fullyVisible:kt,tileID:void 0,shouldSplit:void 0,minZ:dt.minZ,maxZ:dt.maxZ};S&&!Y&&(wi.tileID=new r.OverscaledTileID(dt.zoom+1===_t?Wt:dt.zoom+1,dt.wrap,dt.zoom+1,Pi,$i),wt(wi)),lt.push(wi)}else{const Jt=dt.zoom===_t?Wt:dt.zoom;if(a.minzoom&&a.minzoom>Jt)continue;const Pi=Z[0]-(.5+Ot+(dt.wrap<<dt.zoom))*(1<<f-dt.zoom),$i=Z[1]-.5-Xt,wi=dt.tileID?dt.tileID:new r.OverscaledTileID(Jt,dt.wrap,dt.zoom,Ot,Xt);ot.push({tileID:wi,distanceSq:Pi*Pi+$i*$i})}}if(this.fogCullDistSq){const dt=this.fogCullDistSq,Ot=this.horizonLineFromTop();ot=ot.filter(Xt=>{const kt=[0,0,0,1],Jt=[r.EXTENT,r.EXTENT,0,1],Pi=this.calculateFogTileMatrix(Xt.tileID.toUnwrapped());r.transformMat4$1(kt,kt,Pi),r.transformMat4$1(Jt,Jt,Pi);const $i=r.getAABBPointSquareDist(kt,Jt);if($i===0)return!0;let wi=!1;const Li=this._elevation;if(Li&&$i>dt&&Ot!==0){const Zi=this.calculateProjMatrix(Xt.tileID.toUnwrapped());let Yi;a.isTerrainDEM||(Yi=Li.getMinMaxForTile(Xt.tileID)),Yi||(Yi={min:Re,max:De});const Ci=r.furthestTileCorner(this.rotation),Rn=[Ci[0]*r.EXTENT,Ci[1]*r.EXTENT,Yi.max];r.transformMat4(Rn,Rn,Zi),wi=(1-Rn[1])*this.height*.5<Ot}return $i<dt||wi})}return ot.sort((dt,Ot)=>dt.distanceSq-Ot.distanceSq).map(dt=>dt.tileID)}resize(a,f){this.width=a,this.height=f,this.pixelsToGLUnits=[2/a,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const f=r.clamp(a.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),v=this.projection.project(a.lng,f);return new r.Point(v.x*this.worldSize,v.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(a,f){let v,S;const A=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;v=(f.x-A.x)/z,S=(f.y-A.y)/z}else{const z=this.pointCoordinate(f),j=this.pointCoordinate(A);v=z.x-j.x,S=z.y-j.y}const R=this.locationCoordinate(a);this.setLocation(new r.MercatorCoordinate(R.x-v,R.y-S))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a){return this.projection.locationPoint(this,a)}locationPoint3D(a){return this.projection.locationPoint(this,a,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a){return this.coordinateLocation(this.pointCoordinate3D(a))}locationCoordinate(a,f){const v=f?r.mercatorZfromAltitude(f,a.lat):void 0,S=this.projection.project(a.lng,a.lat);return new r.MercatorCoordinate(S.x,S.y,v)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,f){const v=f??this._centerAltitude,S=[a.x,a.y,0,1],A=[a.x,a.y,1,1];r.transformMat4$1(S,S,this.pixelMatrixInverse),r.transformMat4$1(A,A,this.pixelMatrixInverse);const R=A[3];r.scale$1(S,S,1/S[3]),r.scale$1(A,A,1/R);const z=S[2],j=A[2];return{p0:S,p1:A,t:z===j?0:(v-z)/(j-z)}}screenPointToMercatorRay(a){const f=[a.x,a.y,0,1],v=[a.x,a.y,1,1];return r.transformMat4$1(f,f,this.pixelMatrixInverse),r.transformMat4$1(v,v,this.pixelMatrixInverse),r.scale$1(f,f,1/f[3]),r.scale$1(v,v,1/v[3]),f[2]=r.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,v[2]=r.mercatorZfromAltitude(v[2],this._center.lat)*this.worldSize,r.scale$1(f,f,1/this.worldSize),r.scale$1(v,v,1/this.worldSize),new r.Ray([f[0],f[1],f[2]],r.normalize([],r.sub([],v,f)))}rayIntersectionCoordinate(a){const{p0:f,p1:v,t:S}=a,A=r.mercatorZfromAltitude(f[2],this._center.lat),R=r.mercatorZfromAltitude(v[2],this._center.lat);return new r.MercatorCoordinate(r.number(f[0],v[0],S)/this.worldSize,r.number(f[1],v[1],S)/this.worldSize,r.number(A,R,S))}pointCoordinate(a,f=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,f)}pointCoordinate3D(a){if(!this.elevation)return this.pointCoordinate(a);let f=this.projection.pointCoordinate3D(this,a.x,a.y);if(f)return new r.MercatorCoordinate(f[0],f[1],f[2]);let v=0,S=this.horizonLineFromTop();if(a.y>S)return this.pointCoordinate(a);const A=.02*S,R=a.clone();for(let z=0;z<10&&S-v>A;z++){R.y=r.number(v,S,.66);const j=this.projection.pointCoordinate3D(this,R.x,R.y);j?(S=R.y,f=j):v=R.y}return f?new r.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}isPointOnSurface(a){if(a.y<0||a.y>this.height||a.x<0||a.x>this.width)return!1;if(this.elevation||this.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(a);const f=this.pointCoordinate(a);return f.y>=0&&f.y<=1}_coordinatePoint(a,f){const v=f&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,S=[a.x*this.worldSize,a.y*this.worldSize,v+a.toAltitude(),1];return r.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new r.Point(S[0]/S[3],S[1]/S[3]):new r.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:a,left:f}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,A=this.pointLocation3D(new r.Point(f,a)),R=this.pointLocation3D(new r.Point(S,a)),z=this.pointLocation3D(new r.Point(S,v)),j=this.pointLocation3D(new r.Point(f,v));let Z=Math.min(A.lng,R.lng,z.lng,j.lng),Y=Math.max(A.lng,R.lng,z.lng,j.lng),ne=Math.min(A.lat,R.lat,z.lat,j.lat),ge=Math.max(A.lat,R.lat,z.lat,j.lat);const Te=Math.pow(2,-this.zoom)/16*270,Ae=this.projection.name==="globe"?1:4,Se=(ke,re,we,De,Re)=>{const Ye=(ke+we)/2,We=(re+De)/2,Ke=new r.Point(Ye,We),{lng:lt,lat:ot}=this.pointLocation3D(Ke),_t=Math.max(0,Z-lt,ne-ot,lt-Y,ot-ge);Z=Math.min(Z,lt),Y=Math.max(Y,lt),ne=Math.min(ne,ot),ge=Math.max(ge,ot),(Re<Ae||_t>Te)&&(Se(ke,re,Ye,We,Re+1),Se(Ye,We,we,De,Re+1))};if(Se(f,a,S,a,1),Se(S,a,S,v,1),Se(S,v,f,v,1),Se(f,v,f,a,1),this.projection.name==="globe"){const[ke,re]=r.polesInViewport(this);ke?(ge=90,Y=180,Z=-180):re&&(ne=-90,Y=180,Z=-180)}return new r.LngLatBounds(new r.LngLat(Z,ne),new r.LngLat(Y,ge))}_getBoundsRectangular(a,f){const{top:v,left:S}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,R=this.width-this._edgeInsets.right,z=new r.Point(S,v),j=new r.Point(R,v),Z=new r.Point(R,A),Y=new r.Point(S,A);let ne=this.pointCoordinate(z,a),ge=this.pointCoordinate(j,a);const Te=this.pointCoordinate(Z,f),Ae=this.pointCoordinate(Y,f),Se=(ke,re)=>(re.y-ke.y)/(re.x-ke.x);return ne.y>1&&ge.y>=0?ne=new r.MercatorCoordinate((1-Ae.y)/Se(Ae,ne)+Ae.x,1):ne.y<0&&ge.y<=1&&(ne=new r.MercatorCoordinate(-Ae.y/Se(Ae,ne)+Ae.x,0)),ge.y>1&&ne.y>=0?ge=new r.MercatorCoordinate((1-Te.y)/Se(Te,ge)+Te.x,1):ge.y<0&&ne.y<=1&&(ge=new r.MercatorCoordinate(-Te.y/Se(Te,ge)+Te.x,0)),new r.LngLatBounds().extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(ge)).extend(this.coordinateLocation(Ae)).extend(this.coordinateLocation(Te))}_getBoundsRectangularTerrain(){const a=this.elevation;if(!a.visibleDemTiles.length||a.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=a.visibleDemTiles.reduce((v,S)=>{if(S.dem){const A=S.dem.tree;v.min=Math.min(v.min,A.minimums[0]),v.max=Math.max(v.max,A.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*a.exaggeration(),f.max*a.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(a=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,v=this.height/2-f*(1-this._horizonShift);return a?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-r.MAX_MERCATOR_LATITUDE,this.maxLat=r.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=r.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=r.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=r.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,f){return this.projection.createTileMatrix(this,f,a)}calculateDistanceTileData(a){const f=a.key,v=this._distanceTileDataCache;if(v[f])return v[f];const S=a.canonical,A=1/this.height,R=this.cameraWorldSize,z=R/this.zoomScale(S.z),j=(S.x+Math.pow(2,S.z)*a.wrap)*z,Z=S.y*z,Y=this.point;Y.x*=R/this.worldSize,Y.y*=R/this.worldSize;const ne=this.angle,ge=Math.sin(-ne),Te=-Math.cos(-ne);return v[f]={bearing:[ge,Te],center:[(Y.x-j)*A,(Y.y-Z)*A],scale:z/r.EXTENT*A},v[f]}calculateFogTileMatrix(a){const f=a.key,v=this._fogTileMatrixCache;if(v[f])return v[f];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,a);return r.multiply(S,this.worldToFogMatrix,S),v[f]=new Float32Array(S),v[f]}calculateProjMatrix(a,f=!1){const v=a.key,S=f?this._alignedProjMatrixCache:this._projMatrixCache;if(S[v])return S[v];const A=this.calculatePosMatrix(a,this.worldSize);return r.multiply(A,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,A),S[v]=new Float32Array(A),S[v]}calculatePixelsToTileUnitsMatrix(a){const f=a.tileID.key,v=this._pixelsToTileUnitsCache;if(v[f])return v[f];const S=function(A,R){const{scale:z}=A.tileTransform,j=z*r.EXTENT/(A.tileSize*Math.pow(2,R.zoom-A.tileID.overscaledZ+A.tileID.canonical.z));return Z=new Float32Array(4),ge=(Y=R.inverseAdjustmentMatrix)[1],Te=Y[2],Ae=Y[3],ke=(ne=[j,j])[1],Z[0]=Y[0]*(Se=ne[0]),Z[1]=ge*Se,Z[2]=Te*ke,Z[3]=Ae*ke,Z;var Z,Y,ne,ge,Te,Ae,Se,ke}(a,this);return v[f]=S,v[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const a=1/this.worldSize,f=r.fromScaling([],[a,a,a]);return r.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const a=this._elevation;this._updateCameraState();const f=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(f),S=this._camera.forward(),A=r.mercatorZfromAltitude(1,this._center.lat);v[2]/=A,S[2]/=A,r.normalize(S,S);const R=a.raycast(v,S,a.exaggeration());if(R){const z=r.scaleAndAdd([],v,S,R),j=new r.MercatorCoordinate(z[0],z[1],r.mercatorZfromAltitude(z[2],r.latFromMercatorY(z[1]))),Z=(j.z+r.length([j.x-v[0],j.y-v[1],j.z-v[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=j.toAltitude(),this._center=this.coordinateLocation(j),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(a=!1){if(!this._elevation)return;const f=this._elevation,v=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(v),A=f.getAtPointOrZero(new r.MercatorCoordinate(...S)),R=this.pixelsPerMeter/this.worldSize*A,z=this._minimumHeightOverTerrain(),j=S[2]-R;if(j<=z)if(j<0||a){const Z=this.locationCoordinate(this._center,this._centerAltitude),Y=[S[0],S[1],Z.z-S[2]],ne=r.length(Y);Y[2]-=(z-j)/this._pixelsPerMercatorPixel;const ge=r.length(Y);if(ge===0)return;r.scale$2(Y,Y,ne/ge*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],Z.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){const ge=this.center;return ge.lat=r.clamp(ge.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&(ge.lng=r.clamp(ge.lng,this.minLng,this.maxLng)),this.center=ge,void(this._constraining=!1)}const f=this._unmodified,{x:v,y:S}=this.point;let A=0,R=v,z=S;const j=this.width/2,Z=this.height/2,Y=this.worldMinY*this.scale,ne=this.worldMaxY*this.scale;if(S-Z<Y&&(z=Y+Z),S+Z>ne&&(z=ne-Z),ne-Y<this.height&&(A=Math.max(A,this.height/(ne-Y)),z=(ne+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ge=this.worldMinX*this.scale,Te=this.worldMaxX*this.scale,Ae=this.worldSize/2-(ge+Te)/2;R=(v+Ae+this.worldSize)%this.worldSize-Ae,R-j<ge&&(R=ge+j),R+j>Te&&(R=Te-j),Te-ge<this.width&&(A=Math.max(A,this.width/(Te-ge)),R=(Te+ge)/2)}R===v&&z===S||(this.center=this.unproject(new r.Point(R,z))),A&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.mercatorZfromAltitude(1,this.center.lat)/r.mercatorZfromAltitude(1,r.GLOBE_SCALE_MATCH_LATITUDE));const v=kh(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?f:1,A=this._camera.getWorldToCamera(this.worldSize,S),R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);R[8]=2*-a.x/this.width,R[9]=2*a.y/this.height;let z=r.mul([],R,A);if(this.projection.isReprojectedInTileSpace){const We=this.locationCoordinate(this.center),Ke=r.identity([]);r.translate(Ke,Ke,[We.x*this.worldSize,We.y*this.worldSize,0]),r.multiply(Ke,Ke,kc(this)),r.translate(Ke,Ke,[-We.x*this.worldSize,-We.y*this.worldSize,0]),r.multiply(z,z,Ke),this.inverseAdjustmentMatrix=function(lt){const ot=kc(lt,!0);return Ne([],[ot[0],ot[1],ot[4],ot[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=r.scale([],z,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=z,this.invProjMatrix=r.invert(new Float64Array(16),this.projMatrix);const j=r.invert([],R);this.frustumCorners=r.FrustumCorners.fromInvProjectionMatrix(j,this.horizonLineFromTop(),this.height);const Z=new Float32Array(16);r.identity(Z),r.scale(Z,Z,[1,-1,1]),r.rotateX(Z,Z,this._pitch),r.rotateZ(Z,Z,this.angle);const Y=r.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ne=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Y[8]=2*-a.x/this.width,Y[9]=2*(a.y+ne)/this.height,this.skyboxMatrix=r.multiply(Z,Y,Z);const ge=this.point,Te=ge.x,Ae=ge.y,Se=this.width%2/2,ke=this.height%2/2,re=Math.cos(this.angle),we=Math.sin(this.angle),De=Te-Math.round(Te)+re*Se+we*ke,Re=Ae-Math.round(Ae)+re*ke+we*Se,Ye=new Float64Array(z);if(r.translate(Ye,Ye,[De>.5?De-1:De,Re>.5?Re-1:Re,0]),this.alignedProjMatrix=Ye,z=r.create(),r.scale(z,z,[this.width/2,-this.height/2,1]),r.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=r.create(),r.scale(z,z,[1,-1,1]),r.translate(z,z,[-1,-1,0]),r.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=r.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=r.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.calculateGlobeMatrix(this);const We=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.transformMat4(We,We,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,v=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,A=[a,a,f];r.scale$2(A,A,S),r.scale$2(v,v,-1),r.multiply$2(v,v,A);const R=r.create();r.translate(R,R,v),r.scale(R,R,A),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,f,S)}_computeCameraPosition(a){const f=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),S=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-a/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-v[0]*A,S.y/this.worldSize-v[1]*A,a/this.worldSize*this._centerAltitude-v[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],S=a[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(A=Math.min((f-v)/S,1)),this._camera.position=r.scaleAndAdd([],this._camera.position,a,A),this._updateStateFromCamera()}_updateStateFromCamera(){const a=this._camera.position,f=this._camera.forward(),{pitch:v,bearing:S}=this._camera.getPitchBearing(),A=r.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.degToRad(this._maxPitch)),z=Math.max((a[2]-A)/Math.cos(v),R),j=this._zoomFromMercatorZ(z);r.scaleAndAdd(a,a,f,z),this._pitch=r.clamp(v,r.degToRad(this.minPitch),r.degToRad(this.maxPitch)),this.angle=r.wrap(S,-Math.PI,Math.PI),this._setZoom(r.clamp(j,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.MercatorCoordinate(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(a*this.tileSize))}zoomFromMercatorZAdjusted(a){let f=0,v=r.GLOBE_ZOOM_THRESHOLD_MAX,S=0,A=1/0;for(;v-f>1e-6&&v>f;){const R=f+.5*(v-f),z=this.tileSize*Math.pow(2,R),j=this.getCameraToCenterDistance(this.projection,R,z),Z=this.scaleZoom(j/(a*this.tileSize)),Y=Math.abs(R-Z);Y<A&&(A=Y,S=R),R<Z?f=R:v=R}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,f){const v=Math.min(a.x,f.x),S=Math.max(a.x,f.x),A=Math.min(a.y,f.y),R=Math.max(a.y,f.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new r.Point(v,A),new r.Point(S,R),new r.Point(v,R),new r.Point(S,A)],j=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const Y of z){const ne=this.pointRayIntersection(Y);if(ne.t<0)return!0;const ge=this.rayIntersectionCoordinate(ne);if(ge.x<j||ge.y<0||ge.x>Z||ge.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.Point(0,0),new r.Point(this.width,this.height))}zoomDeltaToMovement(a,f){const v=r.length(r.sub([],this._camera.position,a)),S=this._zoomFromMercatorZ(v)+f;return v-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const a=function([f,v,S],A){const R=[f,v,S,1];r.transformMat4$1(R,R,A);const z=R[3]=Math.max(R[3],1e-6);return R[0]/=z,R[1]/=z,R[2]/=z,R}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.Point(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.Point(0,a))}}getCameraToCenterDistance(a,f=this.zoom,v=this.worldSize){const S=kh(a,f,this.width,this.height,1024),A=a.pixelSpaceConversion(this.center.lat,v,S);return .5/Math.tan(.5*this._fov)*this.height*A}getWorldToCameraMatrix(){const a=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.multiply(a,a,this.globeMatrix),a}}function Ic(_,a){let f=!1,v=null;const S=()=>{v=null,f&&(_(),v=setTimeout(S,a),f=!1)};return()=>(f=!0,v||S(),v)}class Ru{constructor(a){this._hashName=a&&encodeURIComponent(a),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ic(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,r.window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),r.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const a=this._map;if(!a)return"";const f=Fl(a);if(this._hashName){const v=this._hashName;let S=!1;const A=r.window.location.hash.slice(1).split("&").map(R=>{const z=R.split("=")[0];return z===v?(S=!0,`${z}=${f}`):R}).filter(R=>R);return S||A.push(`${v}=${f}`),`#${A.join("&")}`}return`#${f}`}_getCurrentHash(){const a=r.window.location.hash.replace("#","");if(this._hashName){let f;return a.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(f=v)}),(f&&f[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(v=>isNaN(v))){const v=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(f[3]||0):a.getBearing();return a.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:v,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const a=r.window.location.href.replace(/(#.+)?$/,this.getHashString());r.window.history.replaceState(r.window.history.state,null,a)}}function Fl(_,a){const f=_.getCenter(),v=Math.round(100*_.getZoom())/100,S=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,S),R=Math.round(f.lng*A)/A,z=Math.round(f.lat*A)/A,j=_.getBearing(),Z=_.getPitch();let Y=a?`/${R}/${z}/${v}`:`${v}/${z}/${R}`;return(j||Z)&&(Y+="/"+Math.round(10*j)/10),Z&&(Y+=`/${Math.round(Z)}`),Y}const al={linearity:.3,easing:r.bezier(0,0,.3,1)},is=r.extend({deceleration:2500,maxSpeed:1400},al),Ih=r.extend({deceleration:20,maxSpeed:1400},al),yi=r.extend({deceleration:1e3,maxSpeed:360},al),mo=r.extend({deceleration:1e3,maxSpeed:90},al);class Ui{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.exported.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,f=r.exported.now();for(;a.length>0&&f-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new r.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)f.zoom+=A.zoomDelta||0,f.bearing+=A.bearingDelta||0,f.pitch+=A.pitchDelta||0,A.panDelta&&f.pan._add(A.panDelta),A.around&&(f.around=A.around),A.pinchAround&&(f.pinchAround=A.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(f.pan.mag()){const A=ll(f.pan.mag(),v,r.extend({},is,a||{}));S.offset=f.pan.mult(A.amount/f.pan.mag()),S.center=this._map.transform.center,Pc(S,A)}if(f.zoom){const A=ll(f.zoom,v,Ih);S.zoom=this._map.transform.zoom+A.amount,Pc(S,A)}if(f.bearing){const A=ll(f.bearing,v,yi);S.bearing=this._map.transform.bearing+r.clamp(A.amount,-179,179),Pc(S,A)}if(f.pitch){const A=ll(f.pitch,v,mo);S.pitch=this._map.transform.pitch+A.amount,Pc(S,A)}if(S.zoom||S.bearing){const A=f.pinchAround===void 0?f.around:f.pinchAround;S.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Pc(_,a){(!_.duration||_.duration<a.duration)&&(_.duration=a.duration,_.easing=a.easing)}function ll(_,a,f){const{maxSpeed:v,linearity:S,deceleration:A}=f,R=r.clamp(_*S/(a/1e3),-v,v),z=Math.abs(R)/(A*S);return{easing:f.easing,duration:1e3*z,amount:R*(z/2)}}class hr extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,f,v,S={}){const A=Me(f.getCanvasContainer(),v),R=f.unproject(A);super(a,r.extend({point:A,lngLat:R,originalEvent:v},S)),this._defaultPrevented=!1,this.target=f}}class cl extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,f,v){const S=a==="touchend"?v.changedTouches:v.touches,A=ze(f.getCanvasContainer(),S),R=A.map(j=>f.unproject(j)),z=A.reduce((j,Z,Y,ne)=>j.add(Z.div(ne.length)),new r.Point(0,0));super(a,{points:A,point:z,lngLats:R,lngLat:f.unproject(z),originalEvent:v}),this._defaultPrevented=!1}}class an extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,f,v){super(a,{originalEvent:v}),this._defaultPrevented=!1}}class Lc{constructor(a,f){this._map=a,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new an(a.type,this._map,a))}mousedown(a,f){return this._mousedownPos=f,this._firePreventable(new hr(a.type,this._map,a))}mouseup(a){this._map.fire(new hr(a.type,this._map,a))}preclick(a){const f=r.extend({},a);f.type="preclick",this._map.fire(new hr(f.type,this._map,f))}click(a,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(a),this._map.fire(new hr(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new hr(a.type,this._map,a))}mouseover(a){this._map.fire(new hr(a.type,this._map,a))}mouseout(a){this._map.fire(new hr(a.type,this._map,a))}touchstart(a){return this._firePreventable(new cl(a.type,this._map,a))}touchmove(a){this._map.fire(new cl(a.type,this._map,a))}touchend(a){this._map.fire(new cl(a.type,this._map,a))}touchcancel(a){this._map.fire(new cl(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zu{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new hr(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new hr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new hr(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xp{constructor(a,f){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,f){this.isEnabled()&&a.shiftKey&&a.button===0&&(be(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(a,f){if(!this._active)return;const v=f,S=this._startPos,A=this._lastPos;if(!S||!A||A.equals(v)||!this._box&&v.dist(S)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=q("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const R=Math.min(S.x,v.x),z=Math.max(S.x,v.x),j=Math.min(S.y,v.y),Z=Math.max(S.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${R}px,${j}px)`,this._box.style.width=z-R+"px",this._box.style.height=Z-j+"px")})}mouseupWindow(a,f){if(!this._active)return;const v=this._startPos,S=f;if(v&&a.button===0){if(this.reset(),fe(),v.x!==S.x||v.y!==S.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:A=>A.fitScreenCoordinates(v,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),se(),delete this._startPos,delete this._lastPos}_fireEvent(a,f){return this._map.fire(new r.Event(a,{originalEvent:f}))}}function Bu(_,a){const f={};for(let v=0;v<_.length;v++)f[_[v].identifier]=a[v];return f}class Nl{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,f,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=a.timeStamp),v.length===this.numTouches&&(this.centroid=function(S){const A=new r.Point(0,0);for(const R of S)A._add(R);return A.div(S.length)}(f),this.touches=Bu(v,f)))}touchmove(a,f,v){if(this.aborted||!this.centroid)return;const S=Bu(v,f);for(const A in this.touches){const R=S[A];(!R||R.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(a,f,v){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class hl{constructor(a){this.singleTap=new Nl(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,f,v){this.singleTap.touchstart(a,f,v)}touchmove(a,f,v){this.singleTap.touchmove(a,f,v)}touchend(a,f,v){const S=this.singleTap.touchend(a,f,v);if(S){const A=a.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(S)<30;if(A&&R||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class Fg{constructor(){this._zoomIn=new hl({numTouches:1,numTaps:2}),this._zoomOut=new hl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,f,v){this._zoomIn.touchstart(a,f,v),this._zoomOut.touchstart(a,f,v)}touchmove(a,f,v){this._zoomIn.touchmove(a,f,v),this._zoomOut.touchmove(a,f,v)}touchend(a,f,v){const S=this._zoomIn.touchend(a,f,v),A=this._zoomOut.touchend(a,f,v);return S?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(S)},{originalEvent:a})}):A?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(A)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Zp={0:1,2:2};class Dc{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,f){return!1}_move(a,f){return{}}mousedown(a,f){if(this._lastPoint)return;const v=ve(a);this._correctButton(a,v)&&(this._lastPoint=f,this._eventButton=v)}mousemoveWindow(a,f){const v=this._lastPoint;if(v){if(a.preventDefault(),this._eventButton!=null&&function(S,A){const R=Zp[A];return S.buttons===void 0||(S.buttons&R)!==R}(a,this._eventButton))this.reset();else if(this._moved||!(f.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(v,f)}}mouseupWindow(a){this._lastPoint&&ve(a)===this._eventButton&&(this._moved&&fe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oc extends Dc{mousedown(a,f){super.mousedown(a,f),this._lastPoint&&(this._active=!0)}_correctButton(a,f){return f===0&&!a.ctrlKey}_move(a,f){return{around:f,panDelta:f.sub(a)}}}class uf extends Dc{_correctButton(a,f){return f===0&&a.ctrlKey||f===2}_move(a,f){const v=.8*(f.x-a.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(a){a.preventDefault()}}class Fu extends Dc{_correctButton(a,f){return f===0&&a.ctrlKey||f===2}_move(a,f){const v=-.5*(f.y-a.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(a){a.preventDefault()}}class Nu{constructor(a,f){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),r.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.Point(0,0)}touchstart(a,f,v){return this._calculateTransform(a,f,v)}touchmove(a,f,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(v.length===1&&!r.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,f,v)}}touchend(a,f,v){this._calculateTransform(a,f,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,f,v){v.length>0&&(this._active=!0);const S=Bu(v,f),A=new r.Point(0,0),R=new r.Point(0,0);let z=0;for(const Z in S){const Y=S[Z],ne=this._touches[Z];ne&&(A._add(Y),R._add(Y.sub(ne)),z++,S[Z]=Y)}if(this._touches=S,z<this._minTouches||!R.mag())return;const j=R.div(z);return this._sum._add(j),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(z),panDelta:j}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=q("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ph{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,f,v){return{}}touchstart(a,f,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([f[0],f[1]]))}touchmove(a,f,v){const S=this._firstTwoTouches;if(!S)return;a.preventDefault();const[A,R]=S,z=Lh(v,f,A),j=Lh(v,f,R);if(!z||!j)return;const Z=this._aroundCenter?null:z.add(j).div(2);return this._move([z,j],Z,a)}touchend(a,f,v){if(!this._firstTwoTouches)return;const[S,A]=this._firstTwoTouches,R=Lh(v,f,S),z=Lh(v,f,A);R&&z||(this._active&&fe(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Lh(_,a,f){for(let v=0;v<_.length;v++)if(_[v].identifier===f)return a[v]}function df(_,a){return Math.log(_/a)/Math.LN2}class Yp extends Ph{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,f){const v=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(df(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:df(this._distance,v),pinchAround:f}}}function Uu(_,a){return 180*_.angleWith(a)/Math.PI}class Kp extends Ph{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,f){const v=this._vector;if(this._vector=a[0].sub(a[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Uu(this._vector,v),pinchAround:f}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const f=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const S=Uu(a,v);return Math.abs(S)<f}}function ul(_){return Math.abs(_.y)>Math.abs(_.x)}class ff extends Ph{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,ul(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,f,v){const S=this._lastPoints;if(!S)return;const A=a[0].sub(S[0]),R=a[1].sub(S[1]);return this._map._cooperativeGestures&&!r.isFullscreen()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(A,R,v.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(A.y+R.y)/2*-.5})}gestureBeginsVertically(a,f,v){if(this._valid!==void 0)return this._valid;const S=a.mag()>=2,A=f.mag()>=2;if(!S&&!A)return;if(!S||!A)return this._firstMove==null&&(this._firstMove=v),v-this._firstMove<100&&void 0;const R=a.y>0==f.y>0;return ul(a)&&ul(f)&&R}}const pf={panStep:100,bearingStep:15,pitchStep:10};class da{constructor(){const a=pf;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let f=0,v=0,S=0,A=0,R=0;switch(a.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:a.shiftKey?v=-1:(a.preventDefault(),A=-1);break;case 39:a.shiftKey?v=1:(a.preventDefault(),A=1);break;case 38:a.shiftKey?S=1:(a.preventDefault(),R=-1);break;case 40:a.shiftKey?S=-1:(a.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(v=0,S=0),{cameraAnimation:z=>{const j=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Jp,zoom:f?Math.round(j)+f*(a.shiftKey?2:1):j,bearing:z.getBearing()+v*this._bearingStep,pitch:z.getPitch()+S*this._pitchStep,offset:[-A*this._panStep,-R*this._panStep],center:z.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jp(_){return _*(2-_)}const mf=4.000244140625;class Qp{constructor(a,f){this._map=a,this._el=a.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,r.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||r.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=a.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const v=r.exported.now(),S=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,f!==0&&f%mf==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(S*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),a.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=a,this._delta-=f,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=Me(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform;this._type==="wheel"&&a.projection.wrap&&(a._center.lng>=180||a._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(this._delta!==0){const j=this._type==="wheel"&&Math.abs(this._delta)>mf?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&Z!==0&&(Z=1/Z);const Y=f(),ne=Math.pow(2,Y),ge=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):ne;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(ge*Z))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._delta=0}const v=typeof this._targetZoom=="number"?this._targetZoom:f(),S=this._startZoom,A=this._easing;let R,z=!1;if(this._type==="wheel"&&S&&A){const j=Math.min((r.exported.now()-this._lastWheelEventTime)/200,1),Z=A(j);R=r.number(S,v,Z),j<1?this._frameId||(this._frameId=!0):z=!0}else R=v,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:R-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let f=r.ease;if(this._prevEase){const v=this._prevEase,S=(r.exported.now()-v.start)/v.duration,A=v.easing(S+.01)-v.easing(S),R=.27/Math.sqrt(A*A+1e-4)*.01,z=Math.sqrt(.0729-R*R);f=r.bezier(R,z,.25,1)}return this._prevEase={start:r.exported.now(),duration:a,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=q("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(r.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class gf{constructor(a,f){this._clickZoom=a,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Sr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,f){return a.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(a.shiftKey?-1:1),around:v.unproject(f)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ng{constructor(){this._tap=new hl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,f,v){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=f[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(a,f,v))}touchmove(a,f,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const S=f[0],A=S.y-this._swipePoint.y;return this._swipePoint=S,a.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(a,f,v)}touchend(a,f,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(a,f,v)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dh{constructor(a,f,v){this._el=a,this._mousePan=f,this._touchPan=v}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ug{constructor(a,f,v){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=f,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class em{constructor(a,f,v,S){this._el=a,this._touchZoom=f,this._touchRotate=v,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const go=_=>_.zoom||_.drag||_.pitch||_.rotate;class tm extends r.Event{}class im{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,f){const v=r.sub([],f,a);this.radius=r.length(v[2]<0?r.div([],v,this.constants):[v[0],v[1],0])}projectRay(a){r.div(a,a,this.constants),r.normalize(a,a),r.mul$1(a,a,this.constants);const f=r.scale$2([],a,this.radius);if(f[2]>0){const v=r.scale$2([],[0,0,1],r.dot(f,[0,0,1])),S=r.scale$2([],r.normalize([],[f[0],f[1],0]),this.radius),A=r.add([],f,r.scale$2([],r.sub([],r.add([],S,v),f),2));f[0]=A[0],f[1]=A[1]}return f}}function jo(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class fa{constructor(a,f){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ui(a),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new im,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),r.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[r.window,"blur",void 0]];for(const[S,A,R]of this._listeners)S.addEventListener(A,S===r.window.document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[a,f,v]of this._listeners)a.removeEventListener(f,a===r.window.document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(a){const f=this._map,v=f.getCanvasContainer();this._add("mapEvent",new Lc(f,a));const S=f.boxZoom=new Xp(f,a);this._add("boxZoom",S);const A=new Fg,R=new Sr;f.doubleClickZoom=new gf(R,A),this._add("tapZoom",A),this._add("clickZoom",R);const z=new Ng;this._add("tapDragZoom",z);const j=f.touchPitch=new ff(f);this._add("touchPitch",j);const Z=new uf(a),Y=new Fu(a);f.dragRotate=new Ug(a,Z,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const ne=new Oc(a),ge=new Nu(f,a);f.dragPan=new Dh(v,ne,ge),this._add("mousePan",ne),this._add("touchPan",ge,["touchZoom","touchRotate"]);const Te=new Kp,Ae=new Yp;f.touchZoomRotate=new em(v,Ae,Te,z),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",Ae,["touchPan","touchRotate"]),this._add("blockableMapEvent",new zu(f));const Se=f.scrollZoom=new Qp(f,this);this._add("scrollZoom",Se,["mousePan"]);const ke=f.keyboard=new da;this._add("keyboard",ke);for(const re of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[re]&&f[re].enable(a[re])}_add(a,f,v){this._handlers.push({handlerName:a,handler:f,allowed:v}),this._handlersById[a]=f}stop(a){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!go(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(a,f,v){for(const S in a)if(S!==v&&(!f||f.indexOf(S)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const f=[];for(const v of a)this._el.contains(v.target)&&f.push(v);return f}handleEvent(a,f){this._updatingCamera=!0;const v=a.type==="renderFrame",S=v?void 0:a,A={needsRenderFrame:!1},R={},z={},j=a.touches?this._getMapTouches(a.touches):void 0,Z=j?ze(this._el,j):v?void 0:Me(this._el,a);for(const{handlerName:ge,handler:Te,allowed:Ae}of this._handlers){if(!Te.isEnabled())continue;let Se;this._blockedByActive(z,Ae,ge)?Te.reset():Te[f||a.type]&&(Se=Te[f||a.type](a,Z,j),this.mergeHandlerResult(A,R,Se,ge,S),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||Te.isActive())&&(z[ge]=Te)}const Y={};for(const ge in this._previousActiveHandlers)z[ge]||(Y[ge]=S);this._previousActiveHandlers=z,(Object.keys(Y).length||jo(A))&&(this._changes.push([A,R,Y]),this._triggerRenderFrame()),(Object.keys(z).length||jo(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ne}=A;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))}mergeHandlerResult(a,f,v,S,A){if(!v)return;r.extend(a,v);const R={handlerName:S,originalEvent:v.originalEvent||A};v.zoomDelta!==void 0&&(f.zoom=R),v.panDelta!==void 0&&(f.drag=R),v.pitchDelta!==void 0&&(f.pitch=R),v.bearingDelta!==void 0&&(f.rotate=R)}_applyChanges(){const a={},f={},v={};for(const[S,A,R]of this._changes)S.panDelta&&(a.panDelta=(a.panDelta||new r.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(a.around=S.around),S.aroundCoord!==void 0&&(a.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(a.pinchAround=S.pinchAround),S.noInertia&&(a.noInertia=S.noInertia),r.extend(f,A),r.extend(v,R);this._updateMapTransform(a,f,v),this._changes=[]}_updateMapTransform(a,f,v){const S=this._map,A=S.transform,R=we=>[we.x,we.y,we.z];if((we=>{const De=this._eventsInProgress.drag;return De&&!this._handlersById[De.handlerName].isActive()})()&&!jo(a)){const we=A.zoom;A.cameraElevationReference="sea",A.recenterOnTerrain(),A.cameraElevationReference="ground",we!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&S._stop(!0),!jo(a))return void this._fireEvents(f,v,!0);let{panDelta:z,zoomDelta:j,bearingDelta:Z,pitchDelta:Y,around:ne,aroundCoord:ge,pinchAround:Te}=a;A._isCameraConstrained&&(j>0&&(j=0),A._isCameraConstrained=!1),Te!==void 0&&(ne=Te),(j||(we=>f[we]&&!this._eventsInProgress[we])("drag"))&&ne&&(this._dragOrigin=R(A.pointCoordinate3D(ne)),this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",S._stop(!0),ne=ne||S.transform.centerPoint,Z&&(A.bearing+=Z),Y&&(A.pitch+=Y),A._updateCameraState();const Ae=[0,0,0];if(z)if(A.projection.name==="mercator"){const we=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ne).dir),De=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ne.sub(z)).dir);Ae[0]=De[0]-we[0],Ae[1]=De[1]-we[1]}else{const we=A.pointCoordinate(ne);if(A.projection.name==="globe"){z=z.rotate(-A.angle);const De=A._pixelsPerMercatorPixel/A.worldSize;Ae[0]=-z.x*r.mercatorScale(r.latFromMercatorY(we.y))*De,Ae[1]=-z.y*r.mercatorScale(A.center.lat)*De}else{const De=A.pointCoordinate(ne.sub(z));we&&De&&(Ae[0]=De.x-we.x,Ae[1]=De.y-we.y)}}const Se=A.zoom,ke=[0,0,0];if(j){const we=R(ge||A.pointCoordinate3D(ne)),De={dir:r.normalize([],r.sub([],we,A._camera.position))};if(De.dir[2]<0){const Re=A.zoomDeltaToMovement(we,j);r.scale$2(ke,De.dir,Re)}}const re=r.add(Ae,Ae,ke);A._translateCameraConstrained(re),j&&Math.abs(A.zoom-Se)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(f,v,!0)}_fireEvents(a,f,v){const S=go(this._eventsInProgress),A=go(a),R={};for(const Y in a){const{originalEvent:ne}=a[Y];this._eventsInProgress[Y]||(R[`${Y}start`]=ne),this._eventsInProgress[Y]=a[Y]}!S&&A&&this._fireEvent("movestart",A.originalEvent);for(const Y in R)this._fireEvent(Y,R[Y]);A&&this._fireEvent("move",A.originalEvent);for(const Y in a){const{originalEvent:ne}=a[Y];this._fireEvent(Y,ne)}const z={};let j;for(const Y in this._eventsInProgress){const{handlerName:ne,originalEvent:ge}=this._eventsInProgress[Y];this._handlersById[ne].isActive()||(delete this._eventsInProgress[Y],j=f[ne]||ge,z[`${Y}end`]=j)}for(const Y in z)this._fireEvent(Y,z[Y]);const Z=go(this._eventsInProgress);if(v&&(S||A)&&!Z){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=ge=>ge!==0&&-this._bearingSnap<ge&&ge<this._bearingSnap;Y?(ne(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:j})):(this._map.fire(new r.Event("moveend",{originalEvent:j})),ne(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,f){this._map.fire(new r.Event(a,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new tm("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ul="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ua extends r.Evented{constructor(a,f){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=f.respectPrefersReducedMotion!==!1,r.bindAll(["_renderFrameCallback"],this)}getCenter(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,f){return this.jumpTo({center:a},f)}panBy(a,f,v){return a=r.Point.convert(a).mult(-1),this.panTo(this.transform.center,r.extend({offset:a},f),v)}panTo(a,f,v){return this.easeTo(r.extend({center:a},f),v)}getZoom(){return this.transform.zoom}setZoom(a,f){return this.jumpTo({zoom:a},f),this}zoomTo(a,f,v){return this.easeTo(r.extend({zoom:a},f),v)}zoomIn(a,f){return this.zoomTo(this.getZoom()+1,a,f),this}zoomOut(a,f){return this.zoomTo(this.getZoom()-1,a,f),this}getBearing(){return this.transform.bearing}setBearing(a,f){return this.jumpTo({bearing:a},f),this}getPadding(){return this.transform.padding}setPadding(a,f){return this.jumpTo({padding:a},f),this}rotateTo(a,f,v){return this.easeTo(r.extend({bearing:a},f),v)}resetNorth(a,f){return this.rotateTo(0,r.extend({duration:1e3},a),f),this}resetNorthPitch(a,f){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},a),f),this}snapToNorth(a,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,f):this}getPitch(){return this.transform.pitch}setPitch(a,f){return this.jumpTo({pitch:a},f),this}cameraForBounds(a,f){a=r.LngLatBounds.convert(a);const v=f&&f.bearing||0,S=f&&f.pitch||0,A=a.getNorthWest(),R=a.getSouthEast();return this._cameraForBounds(this.transform,A,R,v,S,f)}_extendCameraOptions(a){const f={top:0,bottom:0,right:0,left:0};if(typeof(a=r.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding=="number"){const v=a.padding;a.padding={top:v,bottom:v,right:v,left:v}}return a.padding=r.extend(f,a.padding),a}_minimumAABBFrustumDistance(a,f){const v=f.max[0]-f.min[0],S=f.max[1]-f.min[1];return v/S>a.aspect?v/(2*Math.tan(.5*a.fovX)*a.aspect):S/(2*Math.tan(.5*a.fovY)*a.aspect)}_cameraForBoundsOnGlobe(a,f,v,S,A,R){const z=a.clone(),j=this._extendCameraOptions(R);z.bearing=S,z.pitch=A;const Z=r.LngLat.convert(f),Y=r.LngLat.convert(v),ne=.5*(Z.lat+Y.lat),ge=.5*(Z.lng+Y.lng),Te=r.latLngToECEF(ne,ge),Ae=r.normalize([],Te),Se=r.normalize([],r.cross([],Ae,[0,1,0])),ke=r.cross([],Se,Ae),re=[Se[0],Se[1],Se[2],0,ke[0],ke[1],ke[2],0,Ae[0],Ae[1],Ae[2],0,0,0,0,1],we=[Te,r.latLngToECEF(Z.lat,Z.lng),r.latLngToECEF(Y.lat,Z.lng),r.latLngToECEF(Y.lat,Y.lng),r.latLngToECEF(Z.lat,Y.lng),r.latLngToECEF(ne,Z.lng),r.latLngToECEF(ne,Y.lng),r.latLngToECEF(Z.lat,ge),r.latLngToECEF(Y.lat,ge)];let De=r.Aabb.fromPoints(we.map(kt=>[r.dot(Se,kt),r.dot(ke,kt),r.dot(Ae,kt)]));const Re=r.transformMat4([],De.center,re);r.squaredLength(Re)===0&&r.set(Re,0,0,1),r.normalize(Re,Re),r.scale$2(Re,Re,r.GLOBE_RADIUS),z.center=r.ecefToLatLng(Re);const Ye=z.getWorldToCameraMatrix(),We=r.invert(new Float64Array(16),Ye);De=r.Aabb.applyTransform(De,r.multiply([],Ye,re)),r.transformMat4(Re,Re,Ye);const Ke=.5*(De.max[2]-De.min[2]),lt=this._minimumAABBFrustumDistance(z,De),ot=r.scale$2([],[0,0,1],Ke),_t=r.add(ot,Re,ot),Wt=lt+(z.pitch===0?0:r.distance(Re,_t)),pt=z.globeCenterInViewSpace,Lt=r.sub([],Re,[pt[0],pt[1],pt[2]]);r.normalize(Lt,Lt),r.scale$2(Lt,Lt,Wt);const wt=r.add([],Re,Lt);r.transformMat4(wt,wt,We);const qt=r.earthRadius/r.GLOBE_RADIUS,dt=r.length(wt),Ot=r.mercatorZfromAltitude(Math.max(dt*qt-r.earthRadius,Number.EPSILON),0),Xt=Math.min(z.zoomFromMercatorZAdjusted(Ot),j.maxZoom);return Xt>.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"mercator"}),z.zoom=Xt,this._cameraForBounds(z,f,v,S,A,R)):{center:z.center,zoom:Xt,bearing:S,pitch:A}}queryTerrainElevation(a,f){const v=this.transform.elevation;return v?(f=r.extend({},{exaggerated:!0},f),v.getAtPoint(r.MercatorCoordinate.fromLngLat(a),null,f.exaggerated)):null}_cameraForBounds(a,f,v,S,A,R){if(a.projection.name==="globe")return this._cameraForBoundsOnGlobe(a,f,v,S,A,R);const z=a.clone(),j=this._extendCameraOptions(R),Z=z.padding;z.bearing=S,z.pitch=A;const Y=r.LngLat.convert(f),ne=r.LngLat.convert(v),ge=new r.LngLat(Y.lng,ne.lat),Te=new r.LngLat(ne.lng,Y.lat),Ae=z.project(Y),Se=z.project(ne),ke=this.queryTerrainElevation(Y),re=this.queryTerrainElevation(ne),we=this.queryTerrainElevation(ge),De=this.queryTerrainElevation(Te),Re=[[Ae.x,Ae.y,Math.min(ke||0,re||0,we||0,De||0)],[Se.x,Se.y,Math.max(ke||0,re||0,we||0,De||0)]];let Ye=r.Aabb.fromPoints(Re);const We=z.getWorldToCameraMatrix(),Ke=r.invert(new Float64Array(16),We);Ye=r.Aabb.applyTransform(Ye,We);const lt=r.sub([],Ye.max,Ye.min),ot=Z.left||0,_t=Z.right||0,Wt=Z.bottom||0,pt=Z.top||0,{left:Lt,right:wt,top:qt,bottom:dt}=j.padding,Ot=.5*(ot+_t),Xt=.5*(pt+Wt),kt=Math.min(z.scaleZoom(z.scale*Math.min((z.width-(ot+_t+Lt+wt))/lt[0],(z.height-(Wt+pt+dt+qt))/lt[1])),j.maxZoom),Jt=z.scale/z.zoomScale(kt);Ye=new r.Aabb([Ye.min[0]-(Lt+Ot)*Jt,Ye.min[1]-(dt+Xt)*Jt,Ye.min[2]],[Ye.max[0]+(wt+Ot)*Jt,Ye.max[1]+(qt+Xt)*Jt,Ye.max[2]]);const Pi=.5*lt[2],$i=this._minimumAABBFrustumDistance(z,Ye),wi=[0,0,1,0];r.transformMat4$1(wi,wi,We),r.normalize$2(wi,wi);const Li=r.scale$2([],wi,$i+Pi),Zi=r.add([],Ye.center,Li),Yi=(typeof j.offset.x=="number"&&typeof j.offset.y=="number"?new r.Point(j.offset.x,j.offset.y):r.Point.convert(j.offset)).rotate(-r.degToRad(S));Ye.center[0]-=Yi.x*Jt,Ye.center[1]+=Yi.y*Jt,r.transformMat4(Ye.center,Ye.center,Ke),r.transformMat4(Zi,Zi,Ke);const Ci=[Ye.center[0],Ye.center[1],Zi[2]*z.pixelsPerMeter];r.scale$2(Ci,Ci,1/z.worldSize);const Rn=r.lngFromMercatorX(Ci[0]),Un=r.latFromMercatorY(Ci[1]),Vn=Math.min(z._zoomFromMercatorZ(Ci[2]),j.maxZoom),jn=new r.LngLat(Rn,Un);return z.mercatorFromTransition&&Vn<.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"globe"}),z.zoom=Vn,this._cameraForBounds(z,f,v,S,A,R)):{center:jn,zoom:Vn,bearing:S,pitch:A}}fitBounds(a,f,v){const S=this.cameraForBounds(a,f);return this._fitInternal(S,f,v)}fitScreenCoordinates(a,f,v,S,A){const R=r.Point.convert(a),z=r.Point.convert(f),j=new r.Point(Math.min(R.x,z.x),Math.min(R.y,z.y)),Z=new r.Point(Math.max(R.x,z.x),Math.max(R.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(R,z))return this;const Y=this.transform.pointLocation3D(j),ne=this.transform.pointLocation3D(Z),ge=this.transform.pointLocation3D(new r.Point(j.x,Z.y)),Te=this.transform.pointLocation3D(new r.Point(Z.x,j.y)),Ae=[Math.min(Y.lng,ne.lng,ge.lng,Te.lng),Math.min(Y.lat,ne.lat,ge.lat,Te.lat)],Se=[Math.max(Y.lng,ne.lng,ge.lng,Te.lng),Math.max(Y.lat,ne.lat,ge.lat,Te.lat)],ke=S&&S.pitch?S.pitch:this.getPitch(),re=this._cameraForBounds(this.transform,Ae,Se,v,ke,S);return this._fitInternal(re,S,A)}_fitInternal(a,f,v){return a?(delete(f=r.extend(a,f)).padding,f.linear?this.easeTo(f,v):this.flyTo(f,v)):this}jumpTo(a,f){this.stop();const v=a.preloadOnly?this.transform.clone():this.transform;let S=!1,A=!1,R=!1;return"zoom"in a&&v.zoom!==+a.zoom&&(S=!0,v.zoom=+a.zoom),a.center!==void 0&&(v.center=r.LngLat.convert(a.center)),"bearing"in a&&v.bearing!==+a.bearing&&(A=!0,v.bearing=+a.bearing),"pitch"in a&&v.pitch!==+a.pitch&&(R=!0,v.pitch=+a.pitch),a.padding==null||v.isPaddingEqual(a.padding)||(v.padding=a.padding),a.preloadOnly?(this._preloadTiles(v),this):(this.fire(new r.Event("movestart",f)).fire(new r.Event("move",f)),S&&this.fire(new r.Event("zoomstart",f)).fire(new r.Event("zoom",f)).fire(new r.Event("zoomend",f)),A&&this.fire(new r.Event("rotatestart",f)).fire(new r.Event("rotate",f)).fire(new r.Event("rotateend",f)),R&&this.fire(new r.Event("pitchstart",f)).fire(new r.Event("pitch",f)).fire(new r.Event("pitchend",f)),this.fire(new r.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.warnOnce(Ul),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,f){const v=this.transform;if(!v.projection.supportsFreeCamera)return r.warnOnce(Ul),this;this.stop();const S=v.zoom,A=v.pitch,R=v.bearing;v.setFreeCameraOptions(a);const z=S!==v.zoom,j=A!==v.pitch,Z=R!==v.bearing;return this.fire(new r.Event("movestart",f)).fire(new r.Event("move",f)),z&&this.fire(new r.Event("zoomstart",f)).fire(new r.Event("zoom",f)).fire(new r.Event("zoomend",f)),Z&&this.fire(new r.Event("rotatestart",f)).fire(new r.Event("rotate",f)).fire(new r.Event("rotateend",f)),j&&this.fire(new r.Event("pitchstart",f)).fire(new r.Event("pitch",f)).fire(new r.Event("pitchend",f)),this.fire(new r.Event("moveend",f)),this}easeTo(a,f){this._stop(!1,a.easeId),((a=r.extend({offset:[0,0],duration:500,easing:r.ease},a)).animate===!1||this._prefersReducedMotion(a))&&(a.duration=0);const v=this.transform,S=this.getZoom(),A=this.getBearing(),R=this.getPitch(),z=this.getPadding(),j="zoom"in a?+a.zoom:S,Z="bearing"in a?this._normalizeBearing(a.bearing,A):A,Y="pitch"in a?+a.pitch:R,ne="padding"in a?a.padding:v.padding,ge=r.Point.convert(a.offset);let Te,Ae,Se;if(v.projection.name==="globe"){const ot=r.MercatorCoordinate.fromLngLat(v.center),_t=ge.rotate(-v.angle);ot.x+=_t.x/v.worldSize,ot.y+=_t.y/v.worldSize;const Wt=ot.toLngLat(),pt=r.LngLat.convert(a.center||Wt);this._normalizeCenter(pt),Te=v.centerPoint.add(_t),Ae=new r.Point(ot.x,ot.y).mult(v.worldSize),Se=new r.Point(r.mercatorXfromLng(pt.lng),r.mercatorYfromLat(pt.lat)).mult(v.worldSize).sub(Ae)}else{Te=v.centerPoint.add(ge);const ot=v.pointLocation(Te),_t=r.LngLat.convert(a.center||ot);this._normalizeCenter(_t),Ae=v.project(ot),Se=v.project(_t).sub(Ae)}const ke=v.zoomScale(j-S);let re,we;a.around&&(re=r.LngLat.convert(a.around),we=v.locationPoint(re));const De=this._zooming||j!==S,Re=this._rotating||A!==Z,Ye=this._pitching||Y!==R,We=!v.isPaddingEqual(ne),Ke=ot=>_t=>{if(De&&(ot.zoom=r.number(S,j,_t)),Re&&(ot.bearing=r.number(A,Z,_t)),Ye&&(ot.pitch=r.number(R,Y,_t)),We&&(ot.interpolatePadding(z,ne,_t),Te=ot.centerPoint.add(ge)),re)ot.setLocationAtPoint(re,we);else{const Wt=ot.zoomScale(ot.zoom-S),pt=j>S?Math.min(2,ke):Math.max(.5,ke),Lt=Math.pow(pt,1-_t),wt=ot.unproject(Ae.add(Se.mult(_t*Lt)).mult(Wt));ot.setLocationAtPoint(ot.renderWorldCopies?wt.wrap():wt,Te)}return a.preloadOnly||this._fireMoveEvents(f),ot};if(a.preloadOnly){const ot=this._emulate(Ke,a.duration,v);return this._preloadTiles(ot),this}const lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=De,this._rotating=Re,this._pitching=Ye,this._padding=We,this._easeId=a.easeId,this._prepareEase(f,a.noMoveStart,lt),this._ease(Ke(v),ot=>{v.recenterOnTerrain(),this._afterEase(f,ot)},a),this}_prepareEase(a,f,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||v.moving||this.fire(new r.Event("movestart",a)),this._zooming&&!v.zooming&&this.fire(new r.Event("zoomstart",a)),this._rotating&&!v.rotating&&this.fire(new r.Event("rotatestart",a)),this._pitching&&!v.pitching&&this.fire(new r.Event("pitchstart",a))}_fireMoveEvents(a){this.fire(new r.Event("move",a)),this._zooming&&this.fire(new r.Event("zoom",a)),this._rotating&&this.fire(new r.Event("rotate",a)),this._pitching&&this.fire(new r.Event("pitch",a))}_afterEase(a,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,S=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new r.Event("zoomend",a)),S&&this.fire(new r.Event("rotateend",a)),A&&this.fire(new r.Event("pitchend",a)),this.fire(new r.Event("moveend",a))}flyTo(a,f){if(this._prefersReducedMotion(a)){const kt=r.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(kt,f)}this.stop(),a=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},a);const v=this.transform,S=this.getZoom(),A=this.getBearing(),R=this.getPitch(),z=this.getPadding(),j="zoom"in a?r.clamp(+a.zoom,v.minZoom,v.maxZoom):S,Z="bearing"in a?this._normalizeBearing(a.bearing,A):A,Y="pitch"in a?+a.pitch:R,ne="padding"in a?a.padding:v.padding,ge=v.zoomScale(j-S),Te=r.Point.convert(a.offset);let Ae=v.centerPoint.add(Te);const Se=v.pointLocation(Ae),ke=r.LngLat.convert(a.center||Se);this._normalizeCenter(ke);const re=v.project(Se),we=v.project(ke).sub(re);let De=a.curve;const Re=Math.max(v.width,v.height),Ye=Re/ge,We=we.mag();if("minZoom"in a){const kt=r.clamp(Math.min(a.minZoom,S,j),v.minZoom,v.maxZoom),Jt=Re/v.zoomScale(kt-S);De=Math.sqrt(Jt/We*2)}const Ke=De*De;function lt(kt){const Jt=(Ye*Ye-Re*Re+(kt?-1:1)*Ke*Ke*We*We)/(2*(kt?Ye:Re)*Ke*We);return Math.log(Math.sqrt(Jt*Jt+1)-Jt)}function ot(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function _t(kt){return(Math.exp(kt)+Math.exp(-kt))/2}const Wt=lt(0);let pt=function(kt){return _t(Wt)/_t(Wt+De*kt)},Lt=function(kt){return Re*((_t(Wt)*(ot(Jt=Wt+De*kt)/_t(Jt))-ot(Wt))/Ke)/We;var Jt},wt=(lt(1)-Wt)/De;if(Math.abs(We)<1e-6||!isFinite(wt)){if(Math.abs(Re-Ye)<1e-6)return this.easeTo(a,f);const kt=Ye<Re?-1:1;wt=Math.abs(Math.log(Ye/Re))/De,Lt=function(){return 0},pt=function(Jt){return Math.exp(kt*De*Jt)}}a.duration="duration"in a?+a.duration:1e3*wt/("screenSpeed"in a?+a.screenSpeed/De:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const qt=A!==Z,dt=Y!==R,Ot=!v.isPaddingEqual(ne),Xt=kt=>Jt=>{const Pi=Jt*wt,$i=1/pt(Pi);kt.zoom=Jt===1?j:S+kt.scaleZoom($i),qt&&(kt.bearing=r.number(A,Z,Jt)),dt&&(kt.pitch=r.number(R,Y,Jt)),Ot&&(kt.interpolatePadding(z,ne,Jt),Ae=kt.centerPoint.add(Te));const wi=Jt===1?ke:kt.unproject(re.add(we.mult(Lt(Pi))).mult($i));return kt.setLocationAtPoint(kt.renderWorldCopies?wi.wrap():wi,Ae),kt._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(f),kt};if(a.preloadOnly){const kt=this._emulate(Xt,a.duration,v);return this._preloadTiles(kt),this}return this._zooming=!0,this._rotating=qt,this._pitching=dt,this._padding=Ot,this._prepareEase(f,!1),this._ease(Xt(v),()=>this._afterEase(f),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,f)}if(!a){const v=this.handlers;v&&v.stop(!1)}return this}_ease(a,f,v){v.animate===!1||v.duration===0?(a(1),f()):(this._easeStart=r.exported.now(),this._easeOptions=v,this._onEaseFrame=a,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((r.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,f){a=r.wrap(a,-180,180);const v=Math.abs(a-f);return Math.abs(a-360-f)<v&&(a-=360),Math.abs(a+360-f)<v&&(a+=360),a}_normalizeCenter(a){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const v=a.lng-f.center.lng;a.lng+=v>180?-360:v<-180?360:0}_prefersReducedMotion(a){return this._respectPrefersReducedMotion&&r.exported.prefersReducedMotion&&!(a&&a.essential)}_emulate(a,f,v){const S=Math.ceil(15*f/1e3),A=[],R=a(v.clone());for(let z=0;z<=S;z++){const j=R(z/S);A.push(j.clone())}return A}}class bi{constructor(a={}){this.options=a,r.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const f=this.options&&this.options.compact;return this._map=a,this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=q("button","mapboxgl-ctrl-attrib-button",this._container),q("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(a,f){const v=this._map._getUIString(`AttributionControl.${f}`);a.setAttribute("aria-label",v),a.removeAttribute("title"),a.firstElementChild&&a.firstElementChild.setAttribute("title",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(a){const v=f.reduce((S,A,R)=>(A.value&&(S+=`${A.key}=${A.value}${R<f.length-1?"&":""}`),S),"?");a.href=`${r.config.FEEDBACK_URL}/${v}#${Fl(this._map,!0)}`,a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}}_updateData(a){!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const f=this._map.style._sourceCaches;for(const S in f){const A=f[S];if(A.used){const R=A.getSource();R.attribution&&a.indexOf(R.attribution)<0&&a.push(R.attribution)}}a.sort((S,A)=>S.length-A.length),a=a.filter((S,A)=>{for(let R=A+1;R<a.length;R++)if(a[R].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const v=a.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,a.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class _f{constructor(){r.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=q("div","mapboxgl-ctrl");const f=q("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&a.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(Object.entries(a).length===0)return!0;for(const f in a){const v=a[f].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const f=a[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class yf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const f=++this._id;return this._queue.push({callback:a,id:f,cancelled:!1}),f}remove(a){const f=this._currentlyRunning,v=f?this._queue.concat(f):this._queue;for(const S of v)if(S.id===a)return void(S.cancelled=!0)}run(a=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const v of f)if(!v.cancelled&&(v.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Vl(_,a,f){if(_=new r.LngLat(_.lng,_.lat),a){const v=new r.LngLat(_.lng-360,_.lat),S=new r.LngLat(_.lng+360,_.lat),A=360*Math.ceil(Math.abs(_.lng-f.center.lng)/360),R=f.locationPoint(_).distSqr(a),z=a.x<0||a.y<0||a.x>f.width||a.y>f.height;f.locationPoint(v).distSqr(a)<R&&(z||Math.abs(v.lng-f.center.lng)<A)?_=v:f.locationPoint(S).distSqr(a)<R&&(z||Math.abs(S.lng-f.center.lng)<A)&&(_=S)}for(;Math.abs(_.lng-f.center.lng)>180;){const v=f.locationPoint(_);if(v.x>=0&&v.y>=0&&v.x<=f.width&&v.y<=f.height)break;_.lng>f.center.lng?_.lng-=360:_.lng+=360}return _}const dl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class pi extends r.Evented{constructor(a,f){if(super(),(a instanceof r.window.HTMLElement||f)&&(a=r.extend({element:a},f)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=a&&a.occludedOpacity||.2,a&&a.element)this._element=a.element,this._offset=r.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=q("div");const S=41,A=27,R=ee("svg",{display:"block",height:S*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${S}`},this._element),z=ee("radialGradient",{id:"shadowGradient"},ee("defs",{},R));ee("stop",{offset:"10%","stop-opacity":.4},z),ee("stop",{offset:"100%","stop-opacity":.05},z),ee("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},R),ee("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},R),ee("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},R),ee("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},R),this._offset=r.Point.convert(a&&a.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const v=this._element.classList;for(const S in dl)v.remove(`mapboxgl-marker-anchor-${S}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=r.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,a._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const f=a.code,v=a.charCode||a.keyCode;f!=="Space"&&f!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(a){const f=a.originalEvent.target,v=this._element;this._popup&&(f===v||v.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map,f=this._pos;if(!a||!f)return!1;const v=a.unproject(f),S=a.getFreeCameraOptions();if(!S.position)return!1;const A=S.position.toLngLat();return A.distanceTo(v)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const f=this._pos;if(!f||f.x<0||f.x>a.transform.width||f.y<0||f.y>a.transform.height)return void this._clearFadeTimer();const v=a.unproject(f);let S;a._showingGlobe()&&r.isLngLatBehindGlobe(a.transform,this._lngLat)?S=0:(S=1-a._queryFogOpacity(v),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${a.x}px,${a.y}px)
            ${dl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const a=this._pos,f=this._map,v=this.getPitchAlignment();if(!f||!a||v!=="map")return"";if(!f._showingGlobe()){const j=f.getPitch();return j?`rotateX(${j}deg)`:""}const S=r.radToDeg(r.globeTiltAtLngLat(f.transform,this._lngLat)),A=a.sub(r.globeCenterToScreenPoint(f.transform)),R=Math.abs(A.x)+Math.abs(A.y);if(R===0)return"";const z=S/R;return`rotateX(${-A.y*z}deg) rotateY(${A.x*z}deg)`}_calculateZTransform(){const a=this._pos,f=this._map;if(!f||!a)return"";let v=0;const S=this.getRotationAlignment();if(S==="map")if(f._showingGlobe()){const A=f.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),R=f.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(A);v=r.radToDeg(Math.atan2(R.y,R.x))-90}else v=-f.getBearing();else if(S==="horizon"){const A=r.smoothstep(4,6,f.getZoom()),R=r.globeCenterToScreenPoint(f.transform);R.y+=A*f.transform.height;const z=a.sub(R),j=r.radToDeg(Math.atan2(z.y,z.x));v=(j>90?j-270:j+90)*(1-A)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(a){r.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Vl(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),a===!0?this._updateFrameId=r.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=r.Point.convert(a),this._update(),this}_onMove(a){const f=this._map;if(!f)return;const v=this._pointerdownPos,S=this._positionDelta;if(v&&S){if(!this._isDragging){const A=this._clickTolerance||f._clickTolerance;if(a.point.dist(v)<A)return;this._isDragging=!0}this._pos=a.point.sub(S),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.Event("dragend")),this._state="inactive"}_addDragHandler(a){const f=this._map,v=this._pos;f&&v&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(v),this._pointerdownPos=a.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const f=this._map;return f&&(a?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(a){return this._occludedOpacity=a||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const xf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Vg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vu(_=new r.Point(0,0),a="bottom"){if(typeof _=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(a){case"top":return new r.Point(0,_);case"top-left":return new r.Point(f,f);case"top-right":return new r.Point(-f,f);case"bottom":return new r.Point(0,-_);case"bottom-left":return new r.Point(f,-f);case"bottom-right":return new r.Point(-f,-f);case"left":return new r.Point(_,0);case"right":return new r.Point(-_,0)}return new r.Point(0,0)}return _ instanceof r.Point||Array.isArray(_)?r.Point.convert(_):r.Point.convert(_[a]||[0,0])}class vf{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const f=r.easeCubicInOut((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,f,v){this._start=this.getValue(f),this._end=a,this._startTime=f,this._endTime=f+v}}const jl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},nm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},bf={showCompass:!0,showZoom:!0,visualizePitch:!1};class jg{constructor(a,f,v=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new uf({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,v&&(this.mousePitch=new Fu({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(a,f){this.mouseRotate.mousedown(a,f),this.mousePitch&&this.mousePitch.mousedown(a,f),be()}move(a,f){const v=this.map,S=this.mouseRotate.mousemoveWindow(a,f),A=S&&S.bearingDelta;if(A&&v.setBearing(v.getBearing()+A),this.mousePitch){const R=this.mousePitch.mousemoveWindow(a,f),z=R&&R.pitchDelta;z&&v.setPitch(v.getPitch()+z)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart,{passive:!1}),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){se(),r.window.removeEventListener("mousemove",this.mousemove),r.window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(r.extend({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),Me(this.element,a)),r.window.addEventListener("mousemove",this.mousemove),r.window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,Me(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){a.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ze(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){a.targetTouches.length!==1?this.reset():(this._lastPos=ze(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){a.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Oh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ju={maxWidth:100,unit:"metric"},wf={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Rc={version:r.version,supported:O,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:class extends Ua{constructor(_){if(r.LivePerformanceUtils.mark(r.PerformanceMarkers.create),(_=r.extend({},nm,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&r.isSafariWithAntialiasingBug(r.window)&&(_.antialias=!1,r.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new On(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._useWebGL2=_.useWebGL2,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new yf,this._domRenderTaskQueue=new yf,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.uniqueId(),this._locale=r.extend({},jl,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new vf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new r.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=r.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof r.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&r.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),r.window!==void 0&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1),r.window.addEventListener("orientationchange",this._onWindowResize,!1),r.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new fa(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new Ru(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,r.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new bi({customAttribution:_.customAttribution})),this._logoControl=new _f,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new r.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new r.Event(`${a.dataType}dataloading`,a))})}_getMapId(){return this._mapId}addControl(_,a){if(a===void 0&&(a=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=_.onAdd(this);this._controls.push(_);const v=this._controlPositions[a];return a.indexOf("bottom")!==-1?v.insertBefore(f,v.firstChild):v.appendChild(f),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(_);return a>-1&&this._controls.splice(a,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new r.Event("movestart",_)).fire(new r.Event("move",_)),this.fire(new r.Event("resize",_)),a&&this.fire(new r.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(r.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?r.window.navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(a=>a==="auto"?r.window.navigator.language:a):_}setLanguage(_){const a=this._parseLanguage(_);if(!this.style||a===this._language)return this;this._language=a,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,a=_.projection.name;let f;a==="globe"&&_.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),f=!0):a==="mercator"&&_.zoom<r.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,a){return this._updateProjection(_||a||{name:"mercator"})}_updateProjection(_){let a;if(a=_.name==="globe"&&this.transform.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),a){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(r.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(r.Point.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,a,f){if(_==="mouseenter"||_==="mouseover"){let v=!1;const S=R=>{const z=a.filter(Z=>this.getLayer(Z)),j=z.length?this.queryRenderedFeatures(R.point,{layers:z}):[];j.length?v||(v=!0,f.call(this,new hr(_,this,R.originalEvent,{features:j}))):v=!1},A=()=>{v=!1};return{layers:new Set(a),listener:f,delegates:{mousemove:S,mouseout:A}}}if(_==="mouseleave"||_==="mouseout"){let v=!1;const S=R=>{const z=a.filter(j=>this.getLayer(j));(z.length?this.queryRenderedFeatures(R.point,{layers:z}):[]).length?v=!0:v&&(v=!1,f.call(this,new hr(_,this,R.originalEvent)))},A=R=>{v&&(v=!1,f.call(this,new hr(_,this,R.originalEvent)))};return{layers:new Set(a),listener:f,delegates:{mousemove:S,mouseout:A}}}{const v=S=>{const A=a.filter(z=>this.getLayer(z)),R=A.length?this.queryRenderedFeatures(S.point,{layers:A}):[];R.length&&(S.features=R,f.call(this,S),delete S.features)};return{layers:new Set(a),listener:f,delegates:{[_]:v}}}}on(_,a,f){if(f===void 0)return super.on(_,a);Array.isArray(a)||(a=[a]);const v=this._createDelegatedListener(_,a,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(v);for(const S in v.delegates)this.on(S,v.delegates[S]);return this}once(_,a,f){if(f===void 0)return super.once(_,a);Array.isArray(a)||(a=[a]);const v=this._createDelegatedListener(_,a,f);for(const S in v.delegates)this.once(S,v.delegates[S]);return this}off(_,a,f){if(f===void 0)return super.off(_,a);a=new Set(Array.isArray(a)?a:[a]);const v=(A,R)=>{if(A.size!==R.size)return!1;for(const z of A)if(!R.has(z))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[_]:void 0;return S&&(A=>{for(let R=0;R<A.length;R++){const z=A[R];if(z.listener===f&&v(z.layers,a)){for(const j in z.delegates)this.off(j,z.delegates[j]);return A.splice(R,1),this}}})(S),this}queryRenderedFeatures(_,a){return this.style?(a!==void 0||_===void 0||_ instanceof r.Point||Array.isArray(_)||(a=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],a=a||{},this.transform)):[]}querySourceFeatures(_,a){return this.style.querySourceFeatures(_,a)}isPointOnSurface(_){const{name:a}=this.transform.projection;return a!=="globe"&&a!=="mercator"&&r.warnOnce(`${a} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.Point.convert(_))}setStyle(_,a){return(a=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&a.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(_,a))}_getUIString(_){const a=this._locale[_];if(a==null)throw new Error(`Missing UI string '${_}'`);return a}_updateStyle(_,a){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new ca(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ca(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,a){if(typeof _=="string"){const f=this._requestManager.normalizeStyleURL(_),v=this._requestManager.transformRequest(f,r.ResourceType.Style);r.getJSON(v,(S,A)=>{S?this.fire(new r.ErrorEvent(S)):A&&this._updateDiff(A,a)})}else typeof _=="object"&&this._updateDiff(_,a)}_updateDiff(_,a){try{this.style.setState(_)&&this._update(!0)}catch(f){r.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(_,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.warnOnce("There is no style added to the map."),!1)}addSource(_,a){return this._lazyInitEmptyStyle(),this.style.addSource(_,a),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const a in _){const f=_[a]._tiles;for(const v in f){const S=f[v];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(_,a,f){this._lazyInitEmptyStyle(),this.style.addSourceType(_,a,f)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,a,{pixelRatio:f=1,sdf:v=!1,stretchX:S,stretchY:A,content:R}={}){if(this._lazyInitEmptyStyle(),a instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&a instanceof r.window.ImageBitmap){const{width:z,height:j,data:Z}=r.exported.getImageData(a);this.style.addImage(_,{data:new r.RGBAImage({width:z,height:j},Z),pixelRatio:f,stretchX:S,stretchY:A,content:R,sdf:v,version:0})}else if(a.width===void 0||a.height===void 0)this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:j}=a,Z=a;this.style.addImage(_,{data:new r.RGBAImage({width:z,height:j},new Uint8Array(Z.data)),pixelRatio:f,stretchX:S,stretchY:A,content:R,sdf:v,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,_)}}updateImage(_,a){const f=this.style.getImage(_);if(!f)return void this.fire(new r.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=a instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&a instanceof r.window.ImageBitmap?r.exported.getImageData(a):a,{width:S,height:A}=v;S!==void 0&&A!==void 0?S===f.data.width&&A===f.data.height?(f.data.replace(v.data,!(a instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&a instanceof r.window.ImageBitmap)),this.style.updateImage(_,f)):this.fire(new r.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${A})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new r.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,a){r.getImage(this._requestManager.transformRequest(_,r.ResourceType.Image),(f,v)=>{a(f,v instanceof r.window.HTMLImageElement?r.exported.getImageData(v):v)})}listImages(){return this.style.listImages()}addLayer(_,a){return this._lazyInitEmptyStyle(),this.style.addLayer(_,a),this._update(!0)}moveLayer(_,a){return this.style.moveLayer(_,a),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,a,f){return this.style.setLayerZoomRange(_,a,f),this._update(!0)}setFilter(_,a,f={}){return this.style.setFilter(_,a,f),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,a,f,v={}){return this.style.setPaintProperty(_,a,f,v),this._update(!0)}getPaintProperty(_,a){return this.style.getPaintProperty(_,a)}setLayoutProperty(_,a,f,v={}){return this.style.setLayoutProperty(_,a,f,v),this._update(!0)}getLayoutProperty(_,a){return this.style.getLayoutProperty(_,a)}setLight(_,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,a),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.LngLat.convert(_),this.transform):0}setFeatureState(_,a){return this.style.setFeatureState(_,a),this._update()}removeFeatureState(_,a){return this.style.removeFeatureState(_,a),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let f,v,S,A=this._container;for(;A&&(!v||!S);){const R=r.window.getComputedStyle(A).transform;R&&R!=="none"&&(f=R.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(v=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(S=f[3])),A=A.parentElement}this._containerWidth=v?Math.abs(_/v):_,this._containerHeight=S?Math.abs(a/S):a}_detectMissingCSS(){r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=q("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=q("div","mapboxgl-canvas-container",_);this._interactive&&a.classList.add("mapboxgl-interactive"),this._canvas=q("canvas","mapboxgl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=q("div","mapboxgl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{v[S]=q("div",`mapboxgl-ctrl-${S}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,a){const f=r.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(_),this._canvas.height=f*Math.ceil(a),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${a}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const a=this._markers.indexOf(_);a!==-1&&this._markers.splice(a,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const a=this._popups.indexOf(_);a!==-1&&this._popups.splice(a,1)}_setupPainter(){const _=r.extend({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._useWebGL2&&this._canvas.getContext("webgl2",_),f=a||this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);f?(this._useWebGL2&&!a&&r.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),r.storeAuthState(f,!0),this.painter=new Mc(f,this.transform,!!a),this.on("data",v=>{v.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.exported$1.testSupport(f)):this.fire(new r.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let a;const f=this.painter.context.extTimerQuery,v=r.exported.now();if(this.listens("gpu-timing-frame")&&(a=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],r.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],r.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,j=this.transform.pitch,Z=r.exported.now(),Y=new r.EvaluationParameters(z,{now:Z,fadeDuration:S,pitch:j,transition:this.style.getTransition()});this.style.update(Y)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(v),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(v),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const z=r.exported.now()-v;f.endQueryEXT(f.TIME_ELAPSED_EXT,a),setTimeout(()=>{const j=f.getQueryObjectEXT(a,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(a),this.fire(new r.Event("gpu-timing-frame",{cpuTime:z,gpuTime:j})),r.window.performance.mark("frame-gpu",{startTime:v,detail:{gpuTime:j}})},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const j=this.painter.queryGpuTimers(z);this.fire(new r.Event("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const j=this.painter.queryGpuTimeDeferredRender(z);this.fire(new r.Event("gpu-timing-deferred-render",{gpuTime:j}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(R||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(A=this._updateAverageElevation(v,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new r.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new r.Event("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,r.LivePerformanceUtils.mark(r.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&r.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const a of this._markers)_&&!this.getRenderWorldCopies()&&(a._lngLat=a._lngLat.wrap()),a._update();for(const a of this._popups)!_||this.getRenderWorldCopies()||a._trackPointer||(a._lngLat=a._lngLat.wrap()),a._update()}_updateAverageElevation(_,a=!1){const f=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((a||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const v=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),A=!1;this.transform.elevation&&(A=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=_;const R=Math.abs(v-S);if(R>1){if(this._isInitialLoad||A)return this._averageElevation.jumpTo(S),f(S);this._averageElevation.easeTo(S,_,300)}else if(R>1e-4)return this._averageElevation.jumpTo(S),f(S)}return!!this._averageElevation.isEasing(_)&&f(this._averageElevation.getValue(_))}_authenticate(){r.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===r.AUTH_ERR_MSG||_.status===401)){const a=this.painter.context.gl;r.storeAuthState(a,!1),this._logoControl instanceof _f&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),r.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const f=this.painter.context.gl,v=f.createFramebuffer();function S(A){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,A,0);const R=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,R),R}return f.bindFramebuffer(f.FRAMEBUFFER,v),this._canvasPixelComparison(S(_),a.canvasCopies.map(S),a.timeStamps)}_canvasPixelComparison(_,a,f){let v=f[1]-f[0];const S=_.length/4;for(let A=0;A<a.length;A++){const R=a[A];let z=0;for(let j=0;j<R.length;j+=4)R[j]===_[j]&&R[j+1]===_[j+1]&&R[j+2]===_[j+2]&&R[j+3]===_[j+3]&&(z+=1);v+=(f[A+2]-f[A+1])*(1-z/S)}return v}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),r.window!==void 0&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("orientationchange",this._onWindowResize,!1),r.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1),r.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),r.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new r.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=r.exported.frame(a=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(a)}))}_preloadTiles(_){const a=this.style?Object.values(this.style._sourceCaches):[];return r.asyncAll(a,(f,v)=>f._preloadTiles(_,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){r.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,a){r.setCacheLimits(_,a)}get version(){return r.version}},NavigationControl:class{constructor(_){this.options=r.extend({},bf,_),this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),q("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),q("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:a}):f.resetNorth({},{originalEvent:a}))}),this._compassIcon=q("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const a=_.getZoom(),f=a===_.getMaxZoom(),v=a===_.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jg(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,a){const f=q("button",_,this._container);return f.type="button",f.addEventListener("click",a),f}_setButtonTitle(_,a){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${a}`);_.setAttribute("aria-label",f),_.firstElementChild&&_.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends r.Evented{constructor(_){super(),this.options=r.extend({geolocation:r.window.navigator.geolocation},Oh,_),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ic(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const a=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,_(f)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):r.window.navigator.permissions!==void 0?r.window.navigator.permissions.query({name:"geolocation"}).then(f=>a(f.state!=="denied")).catch(()=>a()):a()}_isOutOfMapMaxBounds(_){const a=this._map.getMaxBounds(),f=_.coords;return!!a&&(f.longitude<a.getWest()||f.longitude>a.getEast()||f.latitude<a.getSouth()||f.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",_)),this._finish()}}_updateCamera(_){const a=new r.LngLat(_.coords.longitude,_.coords.latitude),f=_.coords.accuracy,v=this._map.getBearing(),S=r.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(f),S,{geolocateSource:!0})}_updateMarker(_){if(_){const a=new r.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,a=r.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,f=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=q("button","mapboxgl-ctrl-geolocate",this._container),q("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q("div","mapboxgl-user-location"),this._dotElement.appendChild(q("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(q("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new pi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=q("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new pi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.Event("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{r.window.addEventListener("ondeviceorientationabsolute"in r.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};r.window.DeviceMotionEvent!==void 0&&typeof r.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(a=>{a==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:bi,ScaleControl:class{constructor(_){this.options=r.extend({},ju,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,a=this._map,f=a._containerHeight/2,v=a._containerWidth/2-_/2,S=a.unproject([v,f]),A=a.unproject([v+_,f]),R=S.distanceTo(A);if(this.options.unit==="imperial"){const z=3.2808*R;z>5280?this._setScale(_,z/5280,"mile"):this._setScale(_,z,"foot")}else this.options.unit==="nautical"?this._setScale(_,R/1852,"nautical-mile"):R>=1e3?this._setScale(_,R/1e3,"kilometer"):this._setScale(_,R,"meter")}_setScale(_,a,f){this._map._requestDomTask(()=>{const v=function(A){const R=Math.pow(10,`${Math.floor(A)}`.length-1);let z=A/R;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(j){const Z=Math.pow(10,Math.ceil(-Math.log(j)/Math.LN10));return Math.round(j*Z)/Z}(z),R*z}(a),S=v/a;this._container.innerHTML=this._isNumberFormatSupported&&f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(v):`${v}&nbsp;${wf[f]}`,this._container.style.width=_*S+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof r.window.HTMLElement?this._container=_.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in r.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!r.window.document.fullscreenEnabled&&!r.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=q("button","mapboxgl-ctrl-fullscreen",this._controlContainer);q("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(r.window.document.fullscreenElement||r.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.Evented{constructor(_){super(),this.options=r.extend(Object.create(xf),_),r.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new r.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new r.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=r.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(r.window.document.createTextNode(_))}setHTML(_){const a=r.window.document.createDocumentFragment(),f=r.window.document.createElement("body");let v;for(f.innerHTML=_;v=f.firstChild,v;)a.appendChild(v);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=q("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(_),this.options.closeButton){const f=this._closeButton=q("button","mapboxgl-popup-close-button",a);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let a;return this._classList.delete(_)?a=!1:(this._classList.add(_),a=!0),this._updateClassList(),a}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const a=this._map,f=this._container,v=this._pos;if(!a||!f||!v)return"bottom";const S=f.offsetWidth,A=f.offsetHeight,R=v.x<S/2,z=v.x>a.transform.width-S/2;if(v.y+_<A)return R?"top-left":z?"top-right":"top";if(v.y>a.transform.height-A){if(R)return"bottom-left";if(z)return"bottom-right"}return R?"left":z?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),_.className=a.join(" ")}_update(_){const a=this._map,f=this._content;if(!a||!this._lngLat&&!this._trackPointer||!f)return;let v=this._container;if(v||(v=this._container=q("div","mapboxgl-popup",a.getContainer()),this._tip=q("div","mapboxgl-popup-tip",v),v.appendChild(f)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Vl(this._lngLat,this._pos,a.transform)),!this._trackPointer||_){const S=this._pos=this._trackPointer&&_?_:a.project(this._lngLat),A=Vu(this.options.offset),R=this._anchor=this._getAnchor(A.y),z=Vu(this.options.offset,R),j=S.add(z).round();a._requestDomTask(()=>{this._container&&R&&(this._container.style.transform=`${dl[R]} translate(${j.x}px,${j.y}px)`)})}if(!this._marker&&a._showingGlobe()){const S=r.isLngLatBehindGlobe(a.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Vg);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:pi,Style:ca,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.Point,MercatorCoordinate:r.MercatorCoordinate,FreeCameraOptions:Hp,Evented:r.Evented,config:r.config,prewarm:function(){Ds().acquire(na)},clearPrewarmedResources:function(){const _=br;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(na),br=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(_){r.config.ACCESS_TOKEN=_},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(_){r.config.API_URL=_},get workerCount(){return Ks.workerCount},set workerCount(_){Ks.workerCount=_},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){r.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){r.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:r.exported.setNow,restoreNow:r.exported.restoreNow};return Rc});var b=d;return b})})(pL);var hU=pL.exports;const Jm=fL(hU);function uU(e){return(e==null?void 0:e.id)??(e==null?void 0:e.ID)??(e==null?void 0:e.gid)??(e==null?void 0:e.GID)??(e==null?void 0:e.ADM_CODE)??null}function dU(e){return(e==null?void 0:e.name)??(e==null?void 0:e.Name)??(e==null?void 0:e.NAME)??(e==null?void 0:e.adm_name)??(e==null?void 0:e.ADM_NAME)??(e==null?void 0:e.adm2_name)??(e==null?void 0:e.ADM2_NAME)??""}function O1(e,t){return{type:"FeatureCollection",features:((Array.isArray(e)?e:e==null?void 0:e.features)||[]).map(h=>{const d=(h==null?void 0:h.properties)??{},g={...d,id:uU(d),name:dU(d),layer:t};return{type:"Feature",geometry:h.geometry,properties:g}})}}function fU(e){const t=[],n=d=>{if(d)switch(d.type){case"Polygon":d.coordinates.forEach(g=>g.forEach(b=>t.push(b[0],b[1])));break;case"MultiPolygon":d.coordinates.forEach(g=>g.forEach(b=>b.forEach(r=>t.push(r[0],r[1]))));break;case"GeometryCollection":(d.geometries||[]).forEach(g=>n(g));break}};if((e==null?void 0:e.type)==="FeatureCollection")e.features.forEach(d=>n(d.geometry));else if((e==null?void 0:e.type)==="Feature")n(e.geometry);else if(e!=null&&e.type)n(e);else return null;if(t.length<2)return null;const l=[],h=[];for(let d=0;d<t.length;d+=2){const g=Number(t[d]),b=Number(t[d+1]);Number.isFinite(g)&&Number.isFinite(b)&&(l.push(g),h.push(b))}return!l.length||!h.length?null:new Jm.LngLatBounds([Math.min(...l),Math.min(...h)],[Math.max(...l),Math.max(...h)])}const UT=zT("map",{state:()=>({map:null,boundaries:{country:{type:"FeatureCollection",features:[]},watershed:{type:"FeatureCollection",features:[]},commune:{type:"FeatureCollection",features:[]}},basemapStyle:"light",uiVersion:0}),actions:{setMap(e){this.map=e},resizeMap(){var e;(e=this.map)==null||e.resize()},tickUI(){var e;this.uiVersion++,(e=this.map)==null||e.resize()},setBoundaries(e){this.boundaries={country:O1(e.country??{type:"FeatureCollection",features:[]},"country"),watershed:O1(e.watershed??{type:"FeatureCollection",features:[]},"watershed"),commune:O1(e.commune??{type:"FeatureCollection",features:[]},"commune")}},setBasemapStyle(e){this.basemapStyle=e},findByName(e,t){const n=(t||"").trim().toLowerCase();return n?this.boundaries[e].features.find(h=>{var d;return String(((d=h==null?void 0:h.properties)==null?void 0:d.name)||"").toLowerCase()===n}):void 0},fitTo(e,t=40){if(!this.map)return;const n=fU(e);n&&this.map.fitBounds(n,{padding:t,duration:800})},highlightFeature(e){if(!this.map||!e)return;const t=this.map.getSource("selected-boundary");if(t){t.setData({type:"FeatureCollection",features:[e]});try{this.map.setLayoutProperty("selected-boundary-casing","visibility","visible"),this.map.setLayoutProperty("selected-boundary-highlight","visibility","visible")}catch{}this.fitTo(e)}},clearHighlight(){if(!this.map)return;const e=this.map.getSource("selected-boundary");e&&e.setData({type:"FeatureCollection",features:[]});try{this.map.setLayoutProperty("selected-boundary-casing","visibility","none"),this.map.setLayoutProperty("selected-boundary-highlight","visibility","none")}catch{}},resetView(){this.map&&(this.map.flyTo({center:[2,14],zoom:5,essential:!0}),this.clearHighlight())}}}),gL=zT("biophysical",{state:()=>({lcVisible:!1,layerName:null,opacity:1,filterHash:0}),getters:{urlParams(){return{format:"image/png",transparent:"true",tiled:"true",crs:"EPSG:3857",srs:"EPSG:3857"}}},actions:{setYear(e){this.layerName=e,this.bump()},setVisible(e){this.lcVisible=e,this.bump()},setOpacity(e){const t=Math.max(0,Math.min(1,e));this.opacity=t,this.bump()},reset(){this.lcVisible=!1,this.layerName=null,this.opacity=1,this.bump()},bump(){this.filterHash=this.filterHash+1|0}}});/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Gy(e){return e+.5|0}const Sd=(e,t,n)=>Math.max(Math.min(e,n),t);function W_(e){return Sd(Gy(e*2.55),0,255)}function Id(e){return Sd(Gy(e*255),0,255)}function Qh(e){return Sd(Gy(e/2.55)/100,0,1)}function cC(e){return Sd(Gy(e*100),0,100)}const bl={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Bw=[..."0123456789ABCDEF"],pU=e=>Bw[e&15],mU=e=>Bw[(e&240)>>4]+Bw[e&15],u0=e=>(e&240)>>4===(e&15),gU=e=>u0(e.r)&&u0(e.g)&&u0(e.b)&&u0(e.a);function _U(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&bl[e[1]]*17,g:255&bl[e[2]]*17,b:255&bl[e[3]]*17,a:t===5?bl[e[4]]*17:255}:(t===7||t===9)&&(n={r:bl[e[1]]<<4|bl[e[2]],g:bl[e[3]]<<4|bl[e[4]],b:bl[e[5]]<<4|bl[e[6]],a:t===9?bl[e[7]]<<4|bl[e[8]]:255})),n}const yU=(e,t)=>e<255?t(e):"";function xU(e){var t=gU(e)?pU:mU;return e?"#"+t(e.r)+t(e.g)+t(e.b)+yU(e.a,t):void 0}const vU=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function _L(e,t,n){const l=t*Math.min(n,1-n),h=(d,g=(d+e/30)%12)=>n-l*Math.max(Math.min(g-3,9-g,1),-1);return[h(0),h(8),h(4)]}function bU(e,t,n){const l=(h,d=(h+e/60)%6)=>n-n*t*Math.max(Math.min(d,4-d,1),0);return[l(5),l(3),l(1)]}function wU(e,t,n){const l=_L(e,1,.5);let h;for(t+n>1&&(h=1/(t+n),t*=h,n*=h),h=0;h<3;h++)l[h]*=1-t-n,l[h]+=t;return l}function TU(e,t,n,l,h){return e===h?(t-n)/l+(t<n?6:0):t===h?(n-e)/l+2:(e-t)/l+4}function VT(e){const n=e.r/255,l=e.g/255,h=e.b/255,d=Math.max(n,l,h),g=Math.min(n,l,h),b=(d+g)/2;let r,C,O;return d!==g&&(O=d-g,C=b>.5?O/(2-d-g):O/(d+g),r=TU(n,l,h,O,d),r=r*60+.5),[r|0,C||0,b]}function jT(e,t,n,l){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,l)).map(Id)}function $T(e,t,n){return jT(_L,e,t,n)}function EU(e,t,n){return jT(wU,e,t,n)}function SU(e,t,n){return jT(bU,e,t,n)}function yL(e){return(e%360+360)%360}function MU(e){const t=vU.exec(e);let n=255,l;if(!t)return;t[5]!==l&&(n=t[6]?W_(+t[5]):Id(+t[5]));const h=yL(+t[2]),d=+t[3]/100,g=+t[4]/100;return t[1]==="hwb"?l=EU(h,d,g):t[1]==="hsv"?l=SU(h,d,g):l=$T(h,d,g),{r:l[0],g:l[1],b:l[2],a:n}}function CU(e,t){var n=VT(e);n[0]=yL(n[0]+t),n=$T(n),e.r=n[0],e.g=n[1],e.b=n[2]}function AU(e){if(!e)return;const t=VT(e),n=t[0],l=cC(t[1]),h=cC(t[2]);return e.a<255?`hsla(${n}, ${l}%, ${h}%, ${Qh(e.a)})`:`hsl(${n}, ${l}%, ${h}%)`}const hC={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},uC={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function kU(){const e={},t=Object.keys(uC),n=Object.keys(hC);let l,h,d,g,b;for(l=0;l<t.length;l++){for(g=b=t[l],h=0;h<n.length;h++)d=n[h],b=b.replace(d,hC[d]);d=parseInt(uC[g],16),e[b]=[d>>16&255,d>>8&255,d&255]}return e}let d0;function IU(e){d0||(d0=kU(),d0.transparent=[0,0,0,0]);const t=d0[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const PU=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function LU(e){const t=PU.exec(e);let n=255,l,h,d;if(t){if(t[7]!==l){const g=+t[7];n=t[8]?W_(g):Sd(g*255,0,255)}return l=+t[1],h=+t[3],d=+t[5],l=255&(t[2]?W_(l):Sd(l,0,255)),h=255&(t[4]?W_(h):Sd(h,0,255)),d=255&(t[6]?W_(d):Sd(d,0,255)),{r:l,g:h,b:d,a:n}}}function DU(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Qh(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const R1=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Gm=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function OU(e,t,n){const l=Gm(Qh(e.r)),h=Gm(Qh(e.g)),d=Gm(Qh(e.b));return{r:Id(R1(l+n*(Gm(Qh(t.r))-l))),g:Id(R1(h+n*(Gm(Qh(t.g))-h))),b:Id(R1(d+n*(Gm(Qh(t.b))-d))),a:e.a+n*(t.a-e.a)}}function f0(e,t,n){if(e){let l=VT(e);l[t]=Math.max(0,Math.min(l[t]+l[t]*n,t===0?360:1)),l=$T(l),e.r=l[0],e.g=l[1],e.b=l[2]}}function xL(e,t){return e&&Object.assign(t||{},e)}function dC(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Id(e[3]))):(t=xL(e,{r:0,g:0,b:0,a:1}),t.a=Id(t.a)),t}function RU(e){return e.charAt(0)==="r"?LU(e):MU(e)}class Cy{constructor(t){if(t instanceof Cy)return t;const n=typeof t;let l;n==="object"?l=dC(t):n==="string"&&(l=_U(t)||IU(t)||RU(t)),this._rgb=l,this._valid=!!l}get valid(){return this._valid}get rgb(){var t=xL(this._rgb);return t&&(t.a=Qh(t.a)),t}set rgb(t){this._rgb=dC(t)}rgbString(){return this._valid?DU(this._rgb):void 0}hexString(){return this._valid?xU(this._rgb):void 0}hslString(){return this._valid?AU(this._rgb):void 0}mix(t,n){if(t){const l=this.rgb,h=t.rgb;let d;const g=n===d?.5:n,b=2*g-1,r=l.a-h.a,C=((b*r===-1?b:(b+r)/(1+b*r))+1)/2;d=1-C,l.r=255&C*l.r+d*h.r+.5,l.g=255&C*l.g+d*h.g+.5,l.b=255&C*l.b+d*h.b+.5,l.a=g*l.a+(1-g)*h.a,this.rgb=l}return this}interpolate(t,n){return t&&(this._rgb=OU(this._rgb,t._rgb,n)),this}clone(){return new Cy(this.rgb)}alpha(t){return this._rgb.a=Id(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=Gy(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return f0(this._rgb,2,t),this}darken(t){return f0(this._rgb,2,-t),this}saturate(t){return f0(this._rgb,1,t),this}desaturate(t){return f0(this._rgb,1,-t),this}rotate(t){return CU(this._rgb,t),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Zh(){}const zU=(()=>{let e=0;return()=>e++})();function ms(e){return e==null}function Dr(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Nn(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Do(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Jc(e,t){return Do(e)?e:t}function Mn(e,t){return typeof e>"u"?t:e}const BU=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,vL=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function qs(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function vs(e,t,n,l){let h,d,g;if(Dr(e))for(d=e.length,h=0;h<d;h++)t.call(n,e[h],h);else if(Nn(e))for(g=Object.keys(e),d=g.length,h=0;h<d;h++)t.call(n,e[g[h]],g[h])}function av(e,t){let n,l,h,d;if(!e||!t||e.length!==t.length)return!1;for(n=0,l=e.length;n<l;++n)if(h=e[n],d=t[n],h.datasetIndex!==d.datasetIndex||h.index!==d.index)return!1;return!0}function lv(e){if(Dr(e))return e.map(lv);if(Nn(e)){const t=Object.create(null),n=Object.keys(e),l=n.length;let h=0;for(;h<l;++h)t[n[h]]=lv(e[n[h]]);return t}return e}function bL(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function FU(e,t,n,l){if(!bL(e))return;const h=t[e],d=n[e];Nn(h)&&Nn(d)?Ay(h,d,l):t[e]=lv(d)}function Ay(e,t,n){const l=Dr(t)?t:[t],h=l.length;if(!Nn(e))return e;n=n||{};const d=n.merger||FU;let g;for(let b=0;b<h;++b){if(g=l[b],!Nn(g))continue;const r=Object.keys(g);for(let C=0,O=r.length;C<O;++C)d(r[C],e,g,n)}return e}function oy(e,t){return Ay(e,t,{merger:NU})}function NU(e,t,n){if(!bL(e))return;const l=t[e],h=n[e];Nn(l)&&Nn(h)?oy(l,h):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=lv(h))}const fC={"":e=>e,x:e=>e.x,y:e=>e.y};function UU(e){const t=e.split("."),n=[];let l="";for(const h of t)l+=h,l.endsWith("\\")?l=l.slice(0,-1)+".":(n.push(l),l="");return n}function VU(e){const t=UU(e);return n=>{for(const l of t){if(l==="")break;n=n&&n[l]}return n}}function Ip(e,t){return(fC[t]||(fC[t]=VU(t)))(e)}function WT(e){return e.charAt(0).toUpperCase()+e.slice(1)}const ky=e=>typeof e<"u",Rd=e=>typeof e=="function",pC=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function jU(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const ws=Math.PI,rr=2*ws,$U=rr+ws,cv=Number.POSITIVE_INFINITY,WU=ws/180,Vr=ws/2,dp=ws/4,mC=ws*2/3,wL=Math.log10,ah=Math.sign;function ay(e,t,n){return Math.abs(e-t)<n}function gC(e){const t=Math.round(e);e=ay(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(wL(e))),l=e/n;return(l<=1?1:l<=2?2:l<=5?5:10)*n}function GU(e){const t=[],n=Math.sqrt(e);let l;for(l=1;l<n;l++)e%l===0&&(t.push(l),t.push(e/l));return n===(n|0)&&t.push(n),t.sort((h,d)=>h-d).pop(),t}function HU(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Iy(e){return!HU(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function qU(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function XU(e,t,n){let l,h,d;for(l=0,h=e.length;l<h;l++)d=e[l][n],isNaN(d)||(t.min=Math.min(t.min,d),t.max=Math.max(t.max,d))}function su(e){return e*(ws/180)}function ZU(e){return e*(180/ws)}function _C(e){if(!Do(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function TL(e,t){const n=t.x-e.x,l=t.y-e.y,h=Math.sqrt(n*n+l*l);let d=Math.atan2(l,n);return d<-.5*ws&&(d+=rr),{angle:d,distance:h}}function Fw(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function YU(e,t){return(e-t+$U)%rr-ws}function Ja(e){return(e%rr+rr)%rr}function Py(e,t,n,l){const h=Ja(e),d=Ja(t),g=Ja(n),b=Ja(d-h),r=Ja(g-h),C=Ja(h-d),O=Ja(h-g);return h===d||h===g||l&&d===g||b>r&&C<O}function Po(e,t,n){return Math.max(t,Math.min(n,e))}function KU(e){return Po(e,-32768,32767)}function ru(e,t,n,l=1e-6){return e>=Math.min(t,n)-l&&e<=Math.max(t,n)+l}function GT(e,t,n){n=n||(g=>e[g]<t);let l=e.length-1,h=0,d;for(;l-h>1;)d=h+l>>1,n(d)?h=d:l=d;return{lo:h,hi:l}}const xp=(e,t,n,l)=>GT(e,n,l?h=>{const d=e[h][t];return d<n||d===n&&e[h+1][t]===n}:h=>e[h][t]<n),JU=(e,t,n)=>GT(e,n,l=>e[l][t]>=n);function QU(e,t,n){let l=0,h=e.length;for(;l<h&&e[l]<t;)l++;for(;h>l&&e[h-1]>n;)h--;return l>0||h<e.length?e.slice(l,h):e}const EL=["push","pop","shift","splice","unshift"];function eV(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),EL.forEach(n=>{const l="_onData"+WT(n),h=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...d){const g=h.apply(this,d);return e._chartjs.listeners.forEach(b=>{typeof b[l]=="function"&&b[l](...d)}),g}})})}function yC(e,t){const n=e._chartjs;if(!n)return;const l=n.listeners,h=l.indexOf(t);h!==-1&&l.splice(h,1),!(l.length>0)&&(EL.forEach(d=>{delete e[d]}),delete e._chartjs)}function SL(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const ML=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function CL(e,t){let n=[],l=!1;return function(...h){n=h,l||(l=!0,ML.call(window,()=>{l=!1,e.apply(t,n)}))}}function tV(e,t){let n;return function(...l){return t?(clearTimeout(n),n=setTimeout(e,t,l)):e.apply(this,l),t}}const HT=e=>e==="start"?"left":e==="end"?"right":"center",So=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,iV=(e,t,n,l)=>e===(l?"left":"right")?n:e==="center"?(t+n)/2:t;function nV(e,t,n){const l=t.length;let h=0,d=l;if(e._sorted){const{iScale:g,vScale:b,_parsed:r}=e,C=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,O=g.axis,{min:U,max:$,minDefined:q,maxDefined:ee}=g.getUserBounds();if(q){if(h=Math.min(xp(r,O,U).lo,n?l:xp(t,O,g.getPixelForValue(U)).lo),C){const ie=r.slice(0,h+1).reverse().findIndex(de=>!ms(de[b.axis]));h-=Math.max(0,ie)}h=Po(h,0,l-1)}if(ee){let ie=Math.max(xp(r,g.axis,$,!0).hi+1,n?0:xp(t,O,g.getPixelForValue($),!0).hi+1);if(C){const de=r.slice(ie-1).findIndex(ye=>!ms(ye[b.axis]));ie+=Math.max(0,de)}d=Po(ie,h,l)-h}else d=l-h}return{start:h,count:d}}function sV(e){const{xScale:t,yScale:n,_scaleRanges:l}=e,h={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!l)return e._scaleRanges=h,!0;const d=l.xmin!==t.min||l.xmax!==t.max||l.ymin!==n.min||l.ymax!==n.max;return Object.assign(l,h),d}const p0=e=>e===0||e===1,xC=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*rr/n)),vC=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*rr/n)+1,ly={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Vr)+1,easeOutSine:e=>Math.sin(e*Vr),easeInOutSine:e=>-.5*(Math.cos(ws*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>p0(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>p0(e)?e:xC(e,.075,.3),easeOutElastic:e=>p0(e)?e:vC(e,.075,.3),easeInOutElastic(e){return p0(e)?e:e<.5?.5*xC(e*2,.1125,.45):.5+.5*vC(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-ly.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?ly.easeInBounce(e*2)*.5:ly.easeOutBounce(e*2-1)*.5+.5};function qT(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function bC(e){return qT(e)?e:new Cy(e)}function z1(e){return qT(e)?e:new Cy(e).saturate(.5).darken(.1).hexString()}const rV=["x","y","borderWidth","radius","tension"],oV=["color","borderColor","backgroundColor"];function aV(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:oV},numbers:{type:"number",properties:rV}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function lV(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const wC=new Map;function cV(e,t){t=t||{};const n=e+JSON.stringify(t);let l=wC.get(n);return l||(l=new Intl.NumberFormat(e,t),wC.set(n,l)),l}function XT(e,t,n){return cV(t,n).format(e)}const hV={values(e){return Dr(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const l=this.chart.options.locale;let h,d=e;if(n.length>1){const C=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(C<1e-4||C>1e15)&&(h="scientific"),d=uV(e,n)}const g=wL(Math.abs(d)),b=isNaN(g)?1:Math.max(Math.min(-1*Math.floor(g),20),0),r={notation:h,minimumFractionDigits:b,maximumFractionDigits:b};return Object.assign(r,this.options.ticks.format),XT(e,l,r)}};function uV(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var AL={formatters:hV};function dV(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:AL.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Pp=Object.create(null),Nw=Object.create(null);function cy(e,t){if(!t)return e;const n=t.split(".");for(let l=0,h=n.length;l<h;++l){const d=n[l];e=e[d]||(e[d]=Object.create(null))}return e}function B1(e,t,n){return typeof t=="string"?Ay(cy(e,t),n):Ay(cy(e,""),t)}class fV{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=l=>l.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(l,h)=>z1(h.backgroundColor),this.hoverBorderColor=(l,h)=>z1(h.borderColor),this.hoverColor=(l,h)=>z1(h.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return B1(this,t,n)}get(t){return cy(this,t)}describe(t,n){return B1(Nw,t,n)}override(t,n){return B1(Pp,t,n)}route(t,n,l,h){const d=cy(this,t),g=cy(this,l),b="_"+n;Object.defineProperties(d,{[b]:{value:d[n],writable:!0},[n]:{enumerable:!0,get(){const r=this[b],C=g[h];return Nn(r)?Object.assign({},C,r):Mn(r,C)},set(r){this[b]=r}}})}apply(t){t.forEach(n=>n(this))}}var xr=new fV({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[aV,lV,dV]);function pV(e){return!e||ms(e.size)||ms(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function TC(e,t,n,l,h){let d=t[h];return d||(d=t[h]=e.measureText(h).width,n.push(h)),d>l&&(l=d),l}function fp(e,t,n){const l=e.currentDevicePixelRatio,h=n!==0?Math.max(n/2,.5):0;return Math.round((t-h)*l)/l+h}function EC(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Uw(e,t,n,l){kL(e,t,n,l,null)}function kL(e,t,n,l,h){let d,g,b,r,C,O,U,$;const q=t.pointStyle,ee=t.rotation,ie=t.radius;let de=(ee||0)*WU;if(q&&typeof q=="object"&&(d=q.toString(),d==="[object HTMLImageElement]"||d==="[object HTMLCanvasElement]")){e.save(),e.translate(n,l),e.rotate(de),e.drawImage(q,-q.width/2,-q.height/2,q.width,q.height),e.restore();return}if(!(isNaN(ie)||ie<=0)){switch(e.beginPath(),q){default:h?e.ellipse(n,l,h/2,ie,0,0,rr):e.arc(n,l,ie,0,rr),e.closePath();break;case"triangle":O=h?h/2:ie,e.moveTo(n+Math.sin(de)*O,l-Math.cos(de)*ie),de+=mC,e.lineTo(n+Math.sin(de)*O,l-Math.cos(de)*ie),de+=mC,e.lineTo(n+Math.sin(de)*O,l-Math.cos(de)*ie),e.closePath();break;case"rectRounded":C=ie*.516,r=ie-C,g=Math.cos(de+dp)*r,U=Math.cos(de+dp)*(h?h/2-C:r),b=Math.sin(de+dp)*r,$=Math.sin(de+dp)*(h?h/2-C:r),e.arc(n-U,l-b,C,de-ws,de-Vr),e.arc(n+$,l-g,C,de-Vr,de),e.arc(n+U,l+b,C,de,de+Vr),e.arc(n-$,l+g,C,de+Vr,de+ws),e.closePath();break;case"rect":if(!ee){r=Math.SQRT1_2*ie,O=h?h/2:r,e.rect(n-O,l-r,2*O,2*r);break}de+=dp;case"rectRot":U=Math.cos(de)*(h?h/2:ie),g=Math.cos(de)*ie,b=Math.sin(de)*ie,$=Math.sin(de)*(h?h/2:ie),e.moveTo(n-U,l-b),e.lineTo(n+$,l-g),e.lineTo(n+U,l+b),e.lineTo(n-$,l+g),e.closePath();break;case"crossRot":de+=dp;case"cross":U=Math.cos(de)*(h?h/2:ie),g=Math.cos(de)*ie,b=Math.sin(de)*ie,$=Math.sin(de)*(h?h/2:ie),e.moveTo(n-U,l-b),e.lineTo(n+U,l+b),e.moveTo(n+$,l-g),e.lineTo(n-$,l+g);break;case"star":U=Math.cos(de)*(h?h/2:ie),g=Math.cos(de)*ie,b=Math.sin(de)*ie,$=Math.sin(de)*(h?h/2:ie),e.moveTo(n-U,l-b),e.lineTo(n+U,l+b),e.moveTo(n+$,l-g),e.lineTo(n-$,l+g),de+=dp,U=Math.cos(de)*(h?h/2:ie),g=Math.cos(de)*ie,b=Math.sin(de)*ie,$=Math.sin(de)*(h?h/2:ie),e.moveTo(n-U,l-b),e.lineTo(n+U,l+b),e.moveTo(n+$,l-g),e.lineTo(n-$,l+g);break;case"line":g=h?h/2:Math.cos(de)*ie,b=Math.sin(de)*ie,e.moveTo(n-g,l-b),e.lineTo(n+g,l+b);break;case"dash":e.moveTo(n,l),e.lineTo(n+Math.cos(de)*(h?h/2:ie),l+Math.sin(de)*ie);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Ly(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Zv(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Yv(e){e.restore()}function mV(e,t,n,l,h){if(!t)return e.lineTo(n.x,n.y);if(h==="middle"){const d=(t.x+n.x)/2;e.lineTo(d,t.y),e.lineTo(d,n.y)}else h==="after"!=!!l?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function gV(e,t,n,l){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(l?t.cp1x:t.cp2x,l?t.cp1y:t.cp2y,l?n.cp2x:n.cp1x,l?n.cp2y:n.cp1y,n.x,n.y)}function _V(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),ms(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function yV(e,t,n,l,h){if(h.strikethrough||h.underline){const d=e.measureText(l),g=t-d.actualBoundingBoxLeft,b=t+d.actualBoundingBoxRight,r=n-d.actualBoundingBoxAscent,C=n+d.actualBoundingBoxDescent,O=h.strikethrough?(r+C)/2:C;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=h.decorationWidth||2,e.moveTo(g,O),e.lineTo(b,O),e.stroke()}}function xV(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Dy(e,t,n,l,h,d={}){const g=Dr(t)?t:[t],b=d.strokeWidth>0&&d.strokeColor!=="";let r,C;for(e.save(),e.font=h.string,_V(e,d),r=0;r<g.length;++r)C=g[r],d.backdrop&&xV(e,d.backdrop),b&&(d.strokeColor&&(e.strokeStyle=d.strokeColor),ms(d.strokeWidth)||(e.lineWidth=d.strokeWidth),e.strokeText(C,n,l,d.maxWidth)),e.fillText(C,n,l,d.maxWidth),yV(e,n,l,C,d),l+=Number(h.lineHeight);e.restore()}function hv(e,t){const{x:n,y:l,w:h,h:d,radius:g}=t;e.arc(n+g.topLeft,l+g.topLeft,g.topLeft,1.5*ws,ws,!0),e.lineTo(n,l+d-g.bottomLeft),e.arc(n+g.bottomLeft,l+d-g.bottomLeft,g.bottomLeft,ws,Vr,!0),e.lineTo(n+h-g.bottomRight,l+d),e.arc(n+h-g.bottomRight,l+d-g.bottomRight,g.bottomRight,Vr,0,!0),e.lineTo(n+h,l+g.topRight),e.arc(n+h-g.topRight,l+g.topRight,g.topRight,0,-Vr,!0),e.lineTo(n+g.topLeft,l)}const vV=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,bV=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function wV(e,t){const n=(""+e).match(vV);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const TV=e=>+e||0;function ZT(e,t){const n={},l=Nn(t),h=l?Object.keys(t):t,d=Nn(e)?l?g=>Mn(e[g],e[t[g]]):g=>e[g]:()=>e;for(const g of h)n[g]=TV(d(g));return n}function IL(e){return ZT(e,{top:"y",right:"x",bottom:"y",left:"x"})}function ag(e){return ZT(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Cl(e){const t=IL(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Lo(e,t){e=e||{},t=t||xr.font;let n=Mn(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let l=Mn(e.style,t.style);l&&!(""+l).match(bV)&&(console.warn('Invalid font style specified: "'+l+'"'),l=void 0);const h={family:Mn(e.family,t.family),lineHeight:wV(Mn(e.lineHeight,t.lineHeight),n),size:n,style:l,weight:Mn(e.weight,t.weight),string:""};return h.string=pV(h),h}function m0(e,t,n,l){let h,d,g;for(h=0,d=e.length;h<d;++h)if(g=e[h],g!==void 0&&g!==void 0)return g}function EV(e,t,n){const{min:l,max:h}=e,d=vL(t,(h-l)/2),g=(b,r)=>n&&b===0?0:b+r;return{min:g(l,-Math.abs(d)),max:g(h,d)}}function zp(e,t){return Object.assign(Object.create(e),t)}function YT(e,t=[""],n,l,h=()=>e[0]){const d=n||e;typeof l>"u"&&(l=OL("_fallback",e));const g={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:d,_fallback:l,_getTarget:h,override:b=>YT([b,...e],t,d,l)};return new Proxy(g,{deleteProperty(b,r){return delete b[r],delete b._keys,delete e[0][r],!0},get(b,r){return LL(b,r,()=>LV(r,t,e,b))},getOwnPropertyDescriptor(b,r){return Reflect.getOwnPropertyDescriptor(b._scopes[0],r)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(b,r){return MC(b).includes(r)},ownKeys(b){return MC(b)},set(b,r,C){const O=b._storage||(b._storage=h());return b[r]=O[r]=C,delete b._keys,!0}})}function _g(e,t,n,l){const h={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:PL(e,l),setContext:d=>_g(e,d,n,l),override:d=>_g(e.override(d),t,n,l)};return new Proxy(h,{deleteProperty(d,g){return delete d[g],delete e[g],!0},get(d,g,b){return LL(d,g,()=>MV(d,g,b))},getOwnPropertyDescriptor(d,g){return d._descriptors.allKeys?Reflect.has(e,g)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,g)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(d,g){return Reflect.has(e,g)},ownKeys(){return Reflect.ownKeys(e)},set(d,g,b){return e[g]=b,delete d[g],!0}})}function PL(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:l=t.indexable,_allKeys:h=t.allKeys}=e;return{allKeys:h,scriptable:n,indexable:l,isScriptable:Rd(n)?n:()=>n,isIndexable:Rd(l)?l:()=>l}}const SV=(e,t)=>e?e+WT(t):t,KT=(e,t)=>Nn(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function LL(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const l=n();return e[t]=l,l}function MV(e,t,n){const{_proxy:l,_context:h,_subProxy:d,_descriptors:g}=e;let b=l[t];return Rd(b)&&g.isScriptable(t)&&(b=CV(t,b,e,n)),Dr(b)&&b.length&&(b=AV(t,b,e,g.isIndexable)),KT(t,b)&&(b=_g(b,h,d&&d[t],g)),b}function CV(e,t,n,l){const{_proxy:h,_context:d,_subProxy:g,_stack:b}=n;if(b.has(e))throw new Error("Recursion detected: "+Array.from(b).join("->")+"->"+e);b.add(e);let r=t(d,g||l);return b.delete(e),KT(e,r)&&(r=JT(h._scopes,h,e,r)),r}function AV(e,t,n,l){const{_proxy:h,_context:d,_subProxy:g,_descriptors:b}=n;if(typeof d.index<"u"&&l(e))return t[d.index%t.length];if(Nn(t[0])){const r=t,C=h._scopes.filter(O=>O!==r);t=[];for(const O of r){const U=JT(C,h,e,O);t.push(_g(U,d,g&&g[e],b))}}return t}function DL(e,t,n){return Rd(e)?e(t,n):e}const kV=(e,t)=>e===!0?t:typeof e=="string"?Ip(t,e):void 0;function IV(e,t,n,l,h){for(const d of t){const g=kV(n,d);if(g){e.add(g);const b=DL(g._fallback,n,h);if(typeof b<"u"&&b!==n&&b!==l)return b}else if(g===!1&&typeof l<"u"&&n!==l)return null}return!1}function JT(e,t,n,l){const h=t._rootScopes,d=DL(t._fallback,n,l),g=[...e,...h],b=new Set;b.add(l);let r=SC(b,g,n,d||n,l);return r===null||typeof d<"u"&&d!==n&&(r=SC(b,g,d,r,l),r===null)?!1:YT(Array.from(b),[""],h,d,()=>PV(t,n,l))}function SC(e,t,n,l,h){for(;n;)n=IV(e,t,n,l,h);return n}function PV(e,t,n){const l=e._getTarget();t in l||(l[t]={});const h=l[t];return Dr(h)&&Nn(n)?n:h||{}}function LV(e,t,n,l){let h;for(const d of t)if(h=OL(SV(d,e),n),typeof h<"u")return KT(e,h)?JT(n,l,e,h):h}function OL(e,t){for(const n of t){if(!n)continue;const l=n[e];if(typeof l<"u")return l}}function MC(e){let t=e._keys;return t||(t=e._keys=DV(e._scopes)),t}function DV(e){const t=new Set;for(const n of e)for(const l of Object.keys(n).filter(h=>!h.startsWith("_")))t.add(l);return Array.from(t)}const OV=Number.EPSILON||1e-14,yg=(e,t)=>t<e.length&&!e[t].skip&&e[t],RL=e=>e==="x"?"y":"x";function RV(e,t,n,l){const h=e.skip?t:e,d=t,g=n.skip?t:n,b=Fw(d,h),r=Fw(g,d);let C=b/(b+r),O=r/(b+r);C=isNaN(C)?0:C,O=isNaN(O)?0:O;const U=l*C,$=l*O;return{previous:{x:d.x-U*(g.x-h.x),y:d.y-U*(g.y-h.y)},next:{x:d.x+$*(g.x-h.x),y:d.y+$*(g.y-h.y)}}}function zV(e,t,n){const l=e.length;let h,d,g,b,r,C=yg(e,0);for(let O=0;O<l-1;++O)if(r=C,C=yg(e,O+1),!(!r||!C)){if(ay(t[O],0,OV)){n[O]=n[O+1]=0;continue}h=n[O]/t[O],d=n[O+1]/t[O],b=Math.pow(h,2)+Math.pow(d,2),!(b<=9)&&(g=3/Math.sqrt(b),n[O]=h*g*t[O],n[O+1]=d*g*t[O])}}function BV(e,t,n="x"){const l=RL(n),h=e.length;let d,g,b,r=yg(e,0);for(let C=0;C<h;++C){if(g=b,b=r,r=yg(e,C+1),!b)continue;const O=b[n],U=b[l];g&&(d=(O-g[n])/3,b[`cp1${n}`]=O-d,b[`cp1${l}`]=U-d*t[C]),r&&(d=(r[n]-O)/3,b[`cp2${n}`]=O+d,b[`cp2${l}`]=U+d*t[C])}}function FV(e,t="x"){const n=RL(t),l=e.length,h=Array(l).fill(0),d=Array(l);let g,b,r,C=yg(e,0);for(g=0;g<l;++g)if(b=r,r=C,C=yg(e,g+1),!!r){if(C){const O=C[t]-r[t];h[g]=O!==0?(C[n]-r[n])/O:0}d[g]=b?C?ah(h[g-1])!==ah(h[g])?0:(h[g-1]+h[g])/2:h[g-1]:h[g]}zV(e,h,d),BV(e,d,t)}function g0(e,t,n){return Math.max(Math.min(e,n),t)}function NV(e,t){let n,l,h,d,g,b=Ly(e[0],t);for(n=0,l=e.length;n<l;++n)g=d,d=b,b=n<l-1&&Ly(e[n+1],t),d&&(h=e[n],g&&(h.cp1x=g0(h.cp1x,t.left,t.right),h.cp1y=g0(h.cp1y,t.top,t.bottom)),b&&(h.cp2x=g0(h.cp2x,t.left,t.right),h.cp2y=g0(h.cp2y,t.top,t.bottom)))}function UV(e,t,n,l,h){let d,g,b,r;if(t.spanGaps&&(e=e.filter(C=>!C.skip)),t.cubicInterpolationMode==="monotone")FV(e,h);else{let C=l?e[e.length-1]:e[0];for(d=0,g=e.length;d<g;++d)b=e[d],r=RV(C,b,e[Math.min(d+1,g-(l?0:1))%g],t.tension),b.cp1x=r.previous.x,b.cp1y=r.previous.y,b.cp2x=r.next.x,b.cp2y=r.next.y,C=b}t.capBezierPoints&&NV(e,n)}function QT(){return typeof window<"u"&&typeof document<"u"}function eE(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function uv(e,t,n){let l;return typeof e=="string"?(l=parseInt(e,10),e.indexOf("%")!==-1&&(l=l/100*t.parentNode[n])):l=e,l}const Kv=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function VV(e,t){return Kv(e).getPropertyValue(t)}const jV=["top","right","bottom","left"];function Sp(e,t,n){const l={};n=n?"-"+n:"";for(let h=0;h<4;h++){const d=jV[h];l[d]=parseFloat(e[t+"-"+d+n])||0}return l.width=l.left+l.right,l.height=l.top+l.bottom,l}const $V=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function WV(e,t){const n=e.touches,l=n&&n.length?n[0]:e,{offsetX:h,offsetY:d}=l;let g=!1,b,r;if($V(h,d,e.target))b=h,r=d;else{const C=t.getBoundingClientRect();b=l.clientX-C.left,r=l.clientY-C.top,g=!0}return{x:b,y:r,box:g}}function gp(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:l}=t,h=Kv(n),d=h.boxSizing==="border-box",g=Sp(h,"padding"),b=Sp(h,"border","width"),{x:r,y:C,box:O}=WV(e,n),U=g.left+(O&&b.left),$=g.top+(O&&b.top);let{width:q,height:ee}=t;return d&&(q-=g.width+b.width,ee-=g.height+b.height),{x:Math.round((r-U)/q*n.width/l),y:Math.round((C-$)/ee*n.height/l)}}function GV(e,t,n){let l,h;if(t===void 0||n===void 0){const d=e&&eE(e);if(!d)t=e.clientWidth,n=e.clientHeight;else{const g=d.getBoundingClientRect(),b=Kv(d),r=Sp(b,"border","width"),C=Sp(b,"padding");t=g.width-C.width-r.width,n=g.height-C.height-r.height,l=uv(b.maxWidth,d,"clientWidth"),h=uv(b.maxHeight,d,"clientHeight")}}return{width:t,height:n,maxWidth:l||cv,maxHeight:h||cv}}const _0=e=>Math.round(e*10)/10;function HV(e,t,n,l){const h=Kv(e),d=Sp(h,"margin"),g=uv(h.maxWidth,e,"clientWidth")||cv,b=uv(h.maxHeight,e,"clientHeight")||cv,r=GV(e,t,n);let{width:C,height:O}=r;if(h.boxSizing==="content-box"){const $=Sp(h,"border","width"),q=Sp(h,"padding");C-=q.width+$.width,O-=q.height+$.height}return C=Math.max(0,C-d.width),O=Math.max(0,l?C/l:O-d.height),C=_0(Math.min(C,g,r.maxWidth)),O=_0(Math.min(O,b,r.maxHeight)),C&&!O&&(O=_0(C/2)),(t!==void 0||n!==void 0)&&l&&r.height&&O>r.height&&(O=r.height,C=_0(Math.floor(O*l))),{width:C,height:O}}function CC(e,t,n){const l=t||1,h=Math.floor(e.height*l),d=Math.floor(e.width*l);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const g=e.canvas;return g.style&&(n||!g.style.height&&!g.style.width)&&(g.style.height=`${e.height}px`,g.style.width=`${e.width}px`),e.currentDevicePixelRatio!==l||g.height!==h||g.width!==d?(e.currentDevicePixelRatio=l,g.height=h,g.width=d,e.ctx.setTransform(l,0,0,l,0,0),!0):!1}const qV=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};QT()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function AC(e,t){const n=VV(e,t),l=n&&n.match(/^(\d+)(\.\d+)?px$/);return l?+l[1]:void 0}function _p(e,t,n,l){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function XV(e,t,n,l){return{x:e.x+n*(t.x-e.x),y:l==="middle"?n<.5?e.y:t.y:l==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function ZV(e,t,n,l){const h={x:e.cp2x,y:e.cp2y},d={x:t.cp1x,y:t.cp1y},g=_p(e,h,n),b=_p(h,d,n),r=_p(d,t,n),C=_p(g,b,n),O=_p(b,r,n);return _p(C,O,n)}const YV=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,l){return n-l},leftForLtr(n,l){return n-l}}},KV=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function lg(e,t,n){return e?YV(t,n):KV()}function zL(e,t){let n,l;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,l=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=l)}function BL(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function FL(e){return e==="angle"?{between:Py,compare:YU,normalize:Ja}:{between:ru,compare:(t,n)=>t-n,normalize:t=>t}}function kC({start:e,end:t,count:n,loop:l,style:h}){return{start:e%n,end:t%n,loop:l&&(t-e+1)%n===0,style:h}}function JV(e,t,n){const{property:l,start:h,end:d}=n,{between:g,normalize:b}=FL(l),r=t.length;let{start:C,end:O,loop:U}=e,$,q;if(U){for(C+=r,O+=r,$=0,q=r;$<q&&g(b(t[C%r][l]),h,d);++$)C--,O--;C%=r,O%=r}return O<C&&(O+=r),{start:C,end:O,loop:U,style:e.style}}function NL(e,t,n){if(!n)return[e];const{property:l,start:h,end:d}=n,g=t.length,{compare:b,between:r,normalize:C}=FL(l),{start:O,end:U,loop:$,style:q}=JV(e,t,n),ee=[];let ie=!1,de=null,ye,be,se;const he=()=>r(h,se,ye)&&b(h,se)!==0,fe=()=>b(d,ye)===0||r(d,se,ye),Me=()=>ie||he(),ze=()=>!ie||fe();for(let ve=O,Ue=O;ve<=U;++ve)be=t[ve%g],!be.skip&&(ye=C(be[l]),ye!==se&&(ie=r(ye,h,d),de===null&&Me()&&(de=b(ye,h)===0?ve:Ue),de!==null&&ze()&&(ee.push(kC({start:de,end:ve,loop:$,count:g,style:q})),de=null),Ue=ve,se=ye));return de!==null&&ee.push(kC({start:de,end:U,loop:$,count:g,style:q})),ee}function UL(e,t){const n=[],l=e.segments;for(let h=0;h<l.length;h++){const d=NL(l[h],e.points,t);d.length&&n.push(...d)}return n}function QV(e,t,n,l){let h=0,d=t-1;if(n&&!l)for(;h<t&&!e[h].skip;)h++;for(;h<t&&e[h].skip;)h++;for(h%=t,n&&(d+=h);d>h&&e[d%t].skip;)d--;return d%=t,{start:h,end:d}}function ej(e,t,n,l){const h=e.length,d=[];let g=t,b=e[t],r;for(r=t+1;r<=n;++r){const C=e[r%h];C.skip||C.stop?b.skip||(l=!1,d.push({start:t%h,end:(r-1)%h,loop:l}),t=g=C.stop?r:null):(g=r,b.skip&&(t=r)),b=C}return g!==null&&d.push({start:t%h,end:g%h,loop:l}),d}function tj(e,t){const n=e.points,l=e.options.spanGaps,h=n.length;if(!h)return[];const d=!!e._loop,{start:g,end:b}=QV(n,h,d,l);if(l===!0)return IC(e,[{start:g,end:b,loop:d}],n,t);const r=b<g?b+h:b,C=!!e._fullLoop&&g===0&&b===h-1;return IC(e,ej(n,g,r,C),n,t)}function IC(e,t,n,l){return!l||!l.setContext||!n?t:ij(e,t,n,l)}function ij(e,t,n,l){const h=e._chart.getContext(),d=PC(e.options),{_datasetIndex:g,options:{spanGaps:b}}=e,r=n.length,C=[];let O=d,U=t[0].start,$=U;function q(ee,ie,de,ye){const be=b?-1:1;if(ee!==ie){for(ee+=r;n[ee%r].skip;)ee-=be;for(;n[ie%r].skip;)ie+=be;ee%r!==ie%r&&(C.push({start:ee%r,end:ie%r,loop:de,style:ye}),O=ye,U=ie%r)}}for(const ee of t){U=b?U:ee.start;let ie=n[U%r],de;for($=U+1;$<=ee.end;$++){const ye=n[$%r];de=PC(l.setContext(zp(h,{type:"segment",p0:ie,p1:ye,p0DataIndex:($-1)%r,p1DataIndex:$%r,datasetIndex:g}))),nj(de,O)&&q(U,$-1,ee.loop,O),ie=ye,O=de}U<$-1&&q(U,$-1,ee.loop,O)}return C}function PC(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function nj(e,t){if(!t)return!1;const n=[],l=function(h,d){return qT(d)?(n.includes(d)||n.push(d),n.indexOf(d)):d};return JSON.stringify(e,l)!==JSON.stringify(t,l)}function y0(e,t,n){return e.options.clip?e[n]:t[n]}function sj(e,t){const{xScale:n,yScale:l}=e;return n&&l?{left:y0(n,t,"left"),right:y0(n,t,"right"),top:y0(l,t,"top"),bottom:y0(l,t,"bottom")}:t}function VL(e,t){const n=t._clip;if(n.disabled)return!1;const l=sj(t,e.chartArea);return{left:n.left===!1?0:l.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:l.right+(n.right===!0?0:n.right),top:n.top===!1?0:l.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:l.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class rj{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,l,h){const d=n.listeners[h],g=n.duration;d.forEach(b=>b({chart:t,initial:n.initial,numSteps:g,currentStep:Math.min(l-n.start,g)}))}_refresh(){this._request||(this._running=!0,this._request=ML.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((l,h)=>{if(!l.running||!l.items.length)return;const d=l.items;let g=d.length-1,b=!1,r;for(;g>=0;--g)r=d[g],r._active?(r._total>l.duration&&(l.duration=r._total),r.tick(t),b=!0):(d[g]=d[d.length-1],d.pop());b&&(h.draw(),this._notify(h,l,t,"progress")),d.length||(l.running=!1,this._notify(h,l,t,"complete"),l.initial=!1),n+=d.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let l=n.get(t);return l||(l={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,l)),l}listen(t,n,l){this._getAnims(t).listeners[n].push(l)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((l,h)=>Math.max(l,h._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const l=n.items;let h=l.length-1;for(;h>=0;--h)l[h].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Yh=new rj;const LC="transparent",oj={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const l=bC(e||LC),h=l.valid&&bC(t||LC);return h&&h.valid?h.mix(l,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class aj{constructor(t,n,l,h){const d=n[l];h=m0([t.to,h,d,t.from]);const g=m0([t.from,d,h]);this._active=!0,this._fn=t.fn||oj[t.type||typeof g],this._easing=ly[t.easing]||ly.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=l,this._from=g,this._to=h,this._promises=void 0}active(){return this._active}update(t,n,l){if(this._active){this._notify(!1);const h=this._target[this._prop],d=l-this._start,g=this._duration-d;this._start=l,this._duration=Math.floor(Math.max(g,t.duration)),this._total+=d,this._loop=!!t.loop,this._to=m0([t.to,n,h,t.from]),this._from=m0([t.from,h,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,l=this._duration,h=this._prop,d=this._from,g=this._loop,b=this._to;let r;if(this._active=d!==b&&(g||n<l),!this._active){this._target[h]=b,this._notify(!0);return}if(n<0){this._target[h]=d;return}r=n/l%2,r=g&&r>1?2-r:r,r=this._easing(Math.min(1,Math.max(0,r))),this._target[h]=this._fn(d,b,r)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,l)=>{t.push({res:n,rej:l})})}_notify(t){const n=t?"res":"rej",l=this._promises||[];for(let h=0;h<l.length;h++)l[h][n]()}}class jL{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Nn(t))return;const n=Object.keys(xr.animation),l=this._properties;Object.getOwnPropertyNames(t).forEach(h=>{const d=t[h];if(!Nn(d))return;const g={};for(const b of n)g[b]=d[b];(Dr(d.properties)&&d.properties||[h]).forEach(b=>{(b===h||!l.has(b))&&l.set(b,g)})})}_animateOptions(t,n){const l=n.options,h=cj(t,l);if(!h)return[];const d=this._createAnimations(h,l);return l.$shared&&lj(t.options.$animations,l).then(()=>{t.options=l},()=>{}),d}_createAnimations(t,n){const l=this._properties,h=[],d=t.$animations||(t.$animations={}),g=Object.keys(n),b=Date.now();let r;for(r=g.length-1;r>=0;--r){const C=g[r];if(C.charAt(0)==="$")continue;if(C==="options"){h.push(...this._animateOptions(t,n));continue}const O=n[C];let U=d[C];const $=l.get(C);if(U)if($&&U.active()){U.update($,O,b);continue}else U.cancel();if(!$||!$.duration){t[C]=O;continue}d[C]=U=new aj($,t,C,O),h.push(U)}return h}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const l=this._createAnimations(t,n);if(l.length)return Yh.add(this._chart,l),!0}}function lj(e,t){const n=[],l=Object.keys(t);for(let h=0;h<l.length;h++){const d=e[l[h]];d&&d.active()&&n.push(d.wait())}return Promise.all(n)}function cj(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function DC(e,t){const n=e&&e.options||{},l=n.reverse,h=n.min===void 0?t:0,d=n.max===void 0?t:0;return{start:l?d:h,end:l?h:d}}function hj(e,t,n){if(n===!1)return!1;const l=DC(e,n),h=DC(t,n);return{top:h.end,right:l.end,bottom:h.start,left:l.start}}function uj(e){let t,n,l,h;return Nn(e)?(t=e.top,n=e.right,l=e.bottom,h=e.left):t=n=l=h=e,{top:t,right:n,bottom:l,left:h,disabled:e===!1}}function $L(e,t){const n=[],l=e._getSortedDatasetMetas(t);let h,d;for(h=0,d=l.length;h<d;++h)n.push(l[h].index);return n}function OC(e,t,n,l={}){const h=e.keys,d=l.mode==="single";let g,b,r,C;if(t===null)return;let O=!1;for(g=0,b=h.length;g<b;++g){if(r=+h[g],r===n){if(O=!0,l.all)continue;break}C=e.values[r],Do(C)&&(d||t===0||ah(t)===ah(C))&&(t+=C)}return!O&&!l.all?0:t}function dj(e,t){const{iScale:n,vScale:l}=t,h=n.axis==="x"?"x":"y",d=l.axis==="x"?"x":"y",g=Object.keys(e),b=new Array(g.length);let r,C,O;for(r=0,C=g.length;r<C;++r)O=g[r],b[r]={[h]:O,[d]:e[O]};return b}function F1(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function fj(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function pj(e){const{min:t,max:n,minDefined:l,maxDefined:h}=e.getUserBounds();return{min:l?t:Number.NEGATIVE_INFINITY,max:h?n:Number.POSITIVE_INFINITY}}function mj(e,t,n){const l=e[t]||(e[t]={});return l[n]||(l[n]={})}function RC(e,t,n,l){for(const h of t.getMatchingVisibleMetas(l).reverse()){const d=e[h.index];if(n&&d>0||!n&&d<0)return h.index}return null}function zC(e,t){const{chart:n,_cachedMeta:l}=e,h=n._stacks||(n._stacks={}),{iScale:d,vScale:g,index:b}=l,r=d.axis,C=g.axis,O=fj(d,g,l),U=t.length;let $;for(let q=0;q<U;++q){const ee=t[q],{[r]:ie,[C]:de}=ee,ye=ee._stacks||(ee._stacks={});$=ye[C]=mj(h,O,ie),$[b]=de,$._top=RC($,g,!0,l.type),$._bottom=RC($,g,!1,l.type);const be=$._visualValues||($._visualValues={});be[b]=de}}function N1(e,t){const n=e.scales;return Object.keys(n).filter(l=>n[l].axis===t).shift()}function gj(e,t){return zp(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function _j(e,t,n){return zp(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function B_(e,t){const n=e.controller.index,l=e.vScale&&e.vScale.axis;if(l){t=t||e._parsed;for(const h of t){const d=h._stacks;if(!d||d[l]===void 0||d[l][n]===void 0)return;delete d[l][n],d[l]._visualValues!==void 0&&d[l]._visualValues[n]!==void 0&&delete d[l]._visualValues[n]}}}const U1=e=>e==="reset"||e==="none",BC=(e,t)=>t?e:Object.assign({},e),yj=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:$L(n,!0),values:null};class Mp{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=F1(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&B_(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,l=this.getDataset(),h=(U,$,q,ee)=>U==="x"?$:U==="r"?ee:q,d=n.xAxisID=Mn(l.xAxisID,N1(t,"x")),g=n.yAxisID=Mn(l.yAxisID,N1(t,"y")),b=n.rAxisID=Mn(l.rAxisID,N1(t,"r")),r=n.indexAxis,C=n.iAxisID=h(r,d,g,b),O=n.vAxisID=h(r,g,d,b);n.xScale=this.getScaleForId(d),n.yScale=this.getScaleForId(g),n.rScale=this.getScaleForId(b),n.iScale=this.getScaleForId(C),n.vScale=this.getScaleForId(O)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&yC(this._data,this),t._stacked&&B_(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),l=this._data;if(Nn(n)){const h=this._cachedMeta;this._data=dj(n,h)}else if(l!==n){if(l){yC(l,this);const h=this._cachedMeta;B_(h),h._parsed=[]}n&&Object.isExtensible(n)&&eV(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,l=this.getDataset();let h=!1;this._dataCheck();const d=n._stacked;n._stacked=F1(n.vScale,n),n.stack!==l.stack&&(h=!0,B_(n),n.stack=l.stack),this._resyncElements(t),(h||d!==n._stacked)&&(zC(this,n._parsed),n._stacked=F1(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),l=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(l,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:l,_data:h}=this,{iScale:d,_stacked:g}=l,b=d.axis;let r=t===0&&n===h.length?!0:l._sorted,C=t>0&&l._parsed[t-1],O,U,$;if(this._parsing===!1)l._parsed=h,l._sorted=!0,$=h;else{Dr(h[t])?$=this.parseArrayData(l,h,t,n):Nn(h[t])?$=this.parseObjectData(l,h,t,n):$=this.parsePrimitiveData(l,h,t,n);const q=()=>U[b]===null||C&&U[b]<C[b];for(O=0;O<n;++O)l._parsed[O+t]=U=$[O],r&&(q()&&(r=!1),C=U);l._sorted=r}g&&zC(this,$)}parsePrimitiveData(t,n,l,h){const{iScale:d,vScale:g}=t,b=d.axis,r=g.axis,C=d.getLabels(),O=d===g,U=new Array(h);let $,q,ee;for($=0,q=h;$<q;++$)ee=$+l,U[$]={[b]:O||d.parse(C[ee],ee),[r]:g.parse(n[ee],ee)};return U}parseArrayData(t,n,l,h){const{xScale:d,yScale:g}=t,b=new Array(h);let r,C,O,U;for(r=0,C=h;r<C;++r)O=r+l,U=n[O],b[r]={x:d.parse(U[0],O),y:g.parse(U[1],O)};return b}parseObjectData(t,n,l,h){const{xScale:d,yScale:g}=t,{xAxisKey:b="x",yAxisKey:r="y"}=this._parsing,C=new Array(h);let O,U,$,q;for(O=0,U=h;O<U;++O)$=O+l,q=n[$],C[O]={x:d.parse(Ip(q,b),$),y:g.parse(Ip(q,r),$)};return C}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,l){const h=this.chart,d=this._cachedMeta,g=n[t.axis],b={keys:$L(h,!0),values:n._stacks[t.axis]._visualValues};return OC(b,g,d.index,{mode:l})}updateRangeFromParsed(t,n,l,h){const d=l[n.axis];let g=d===null?NaN:d;const b=h&&l._stacks[n.axis];h&&b&&(h.values=b,g=OC(h,d,this._cachedMeta.index)),t.min=Math.min(t.min,g),t.max=Math.max(t.max,g)}getMinMax(t,n){const l=this._cachedMeta,h=l._parsed,d=l._sorted&&t===l.iScale,g=h.length,b=this._getOtherScale(t),r=yj(n,l,this.chart),C={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:O,max:U}=pj(b);let $,q;function ee(){q=h[$];const ie=q[b.axis];return!Do(q[t.axis])||O>ie||U<ie}for($=0;$<g&&!(!ee()&&(this.updateRangeFromParsed(C,t,q,r),d));++$);if(d){for($=g-1;$>=0;--$)if(!ee()){this.updateRangeFromParsed(C,t,q,r);break}}return C}getAllParsedValues(t){const n=this._cachedMeta._parsed,l=[];let h,d,g;for(h=0,d=n.length;h<d;++h)g=n[h][t.axis],Do(g)&&l.push(g);return l}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,l=n.iScale,h=n.vScale,d=this.getParsed(t);return{label:l?""+l.getLabelForValue(d[l.axis]):"",value:h?""+h.getLabelForValue(d[h.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=uj(Mn(this.options.clip,hj(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,l=this._cachedMeta,h=l.data||[],d=n.chartArea,g=[],b=this._drawStart||0,r=this._drawCount||h.length-b,C=this.options.drawActiveElementsOnTop;let O;for(l.dataset&&l.dataset.draw(t,d,b,r),O=b;O<b+r;++O){const U=h[O];U.hidden||(U.active&&C?g.push(U):U.draw(t,d))}for(O=0;O<g.length;++O)g[O].draw(t,d)}getStyle(t,n){const l=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(l):this.resolveDataElementOptions(t||0,l)}getContext(t,n,l){const h=this.getDataset();let d;if(t>=0&&t<this._cachedMeta.data.length){const g=this._cachedMeta.data[t];d=g.$context||(g.$context=_j(this.getContext(),t,g)),d.parsed=this.getParsed(t),d.raw=h.data[t],d.index=d.dataIndex=t}else d=this.$context||(this.$context=gj(this.chart.getContext(),this.index)),d.dataset=h,d.index=d.datasetIndex=this.index;return d.active=!!n,d.mode=l,d}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",l){const h=n==="active",d=this._cachedDataOpts,g=t+"-"+n,b=d[g],r=this.enableOptionSharing&&ky(l);if(b)return BC(b,r);const C=this.chart.config,O=C.datasetElementScopeKeys(this._type,t),U=h?[`${t}Hover`,"hover",t,""]:[t,""],$=C.getOptionScopes(this.getDataset(),O),q=Object.keys(xr.elements[t]),ee=()=>this.getContext(l,h,n),ie=C.resolveNamedOptions($,q,ee,U);return ie.$shared&&(ie.$shared=r,d[g]=Object.freeze(BC(ie,r))),ie}_resolveAnimations(t,n,l){const h=this.chart,d=this._cachedDataOpts,g=`animation-${n}`,b=d[g];if(b)return b;let r;if(h.options.animation!==!1){const O=this.chart.config,U=O.datasetAnimationScopeKeys(this._type,n),$=O.getOptionScopes(this.getDataset(),U);r=O.createResolver($,this.getContext(t,l,n))}const C=new jL(h,r&&r.animations);return r&&r._cacheable&&(d[g]=Object.freeze(C)),C}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||U1(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const l=this.resolveDataElementOptions(t,n),h=this._sharedOptions,d=this.getSharedOptions(l),g=this.includeOptions(n,d)||d!==h;return this.updateSharedOptions(d,n,l),{sharedOptions:d,includeOptions:g}}updateElement(t,n,l,h){U1(h)?Object.assign(t,l):this._resolveAnimations(n,h).update(t,l)}updateSharedOptions(t,n,l){t&&!U1(n)&&this._resolveAnimations(void 0,n).update(t,l)}_setStyle(t,n,l,h){t.active=h;const d=this.getStyle(n,h);this._resolveAnimations(n,l,h).update(t,{options:!h&&this.getSharedOptions(d)||d})}removeHoverStyle(t,n,l){this._setStyle(t,l,"active",!1)}setHoverStyle(t,n,l){this._setStyle(t,l,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,l=this._cachedMeta.data;for(const[b,r,C]of this._syncList)this[b](r,C);this._syncList=[];const h=l.length,d=n.length,g=Math.min(d,h);g&&this.parse(0,g),d>h?this._insertElements(h,d-h,t):d<h&&this._removeElements(d,h-d)}_insertElements(t,n,l=!0){const h=this._cachedMeta,d=h.data,g=t+n;let b;const r=C=>{for(C.length+=n,b=C.length-1;b>=g;b--)C[b]=C[b-n]};for(r(d),b=t;b<g;++b)d[b]=new this.dataElementType;this._parsing&&r(h._parsed),this.parse(t,n),l&&this.updateElements(d,t,n,"reset")}updateElements(t,n,l,h){}_removeElements(t,n){const l=this._cachedMeta;if(this._parsing){const h=l._parsed.splice(t,n);l._stacked&&B_(l,h)}l.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,l,h]=t;this[n](l,h)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const l=arguments.length-2;l&&this._sync(["_insertElements",t,l])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Fi(Mp,"defaults",{}),Fi(Mp,"datasetElementType",null),Fi(Mp,"dataElementType",null);function xj(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let l=[];for(let h=0,d=n.length;h<d;h++)l=l.concat(n[h].controller.getAllParsedValues(e));e._cache.$bar=SL(l.sort((h,d)=>h-d))}return e._cache.$bar}function vj(e){const t=e.iScale,n=xj(t,e.type);let l=t._length,h,d,g,b;const r=()=>{g===32767||g===-32768||(ky(b)&&(l=Math.min(l,Math.abs(g-b)||l)),b=g)};for(h=0,d=n.length;h<d;++h)g=t.getPixelForValue(n[h]),r();for(b=void 0,h=0,d=t.ticks.length;h<d;++h)g=t.getPixelForTick(h),r();return l}function bj(e,t,n,l){const h=n.barThickness;let d,g;return ms(h)?(d=t.min*n.categoryPercentage,g=n.barPercentage):(d=h*l,g=1),{chunk:d/l,ratio:g,start:t.pixels[e]-d/2}}function wj(e,t,n,l){const h=t.pixels,d=h[e];let g=e>0?h[e-1]:null,b=e<h.length-1?h[e+1]:null;const r=n.categoryPercentage;g===null&&(g=d-(b===null?t.end-t.start:b-d)),b===null&&(b=d+d-g);const C=d-(d-Math.min(g,b))/2*r;return{chunk:Math.abs(b-g)/2*r/l,ratio:n.barPercentage,start:C}}function Tj(e,t,n,l){const h=n.parse(e[0],l),d=n.parse(e[1],l),g=Math.min(h,d),b=Math.max(h,d);let r=g,C=b;Math.abs(g)>Math.abs(b)&&(r=b,C=g),t[n.axis]=C,t._custom={barStart:r,barEnd:C,start:h,end:d,min:g,max:b}}function WL(e,t,n,l){return Dr(e)?Tj(e,t,n,l):t[n.axis]=n.parse(e,l),t}function FC(e,t,n,l){const h=e.iScale,d=e.vScale,g=h.getLabels(),b=h===d,r=[];let C,O,U,$;for(C=n,O=n+l;C<O;++C)$=t[C],U={},U[h.axis]=b||h.parse(g[C],C),r.push(WL($,U,d,C));return r}function V1(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function Ej(e,t,n){return e!==0?ah(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function Sj(e){let t,n,l,h,d;return e.horizontal?(t=e.base>e.x,n="left",l="right"):(t=e.base<e.y,n="bottom",l="top"),t?(h="end",d="start"):(h="start",d="end"),{start:n,end:l,reverse:t,top:h,bottom:d}}function Mj(e,t,n,l){let h=t.borderSkipped;const d={};if(!h){e.borderSkipped=d;return}if(h===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:g,end:b,reverse:r,top:C,bottom:O}=Sj(e);h==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===l?h=C:(n._bottom||0)===l?h=O:(d[NC(O,g,b,r)]=!0,h=C)),d[NC(h,g,b,r)]=!0,e.borderSkipped=d}function NC(e,t,n,l){return l?(e=Cj(e,t,n),e=UC(e,n,t)):e=UC(e,t,n),e}function Cj(e,t,n){return e===t?n:e===n?t:e}function UC(e,t,n){return e==="start"?t:e==="end"?n:e}function Aj(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class R0 extends Mp{parsePrimitiveData(t,n,l,h){return FC(t,n,l,h)}parseArrayData(t,n,l,h){return FC(t,n,l,h)}parseObjectData(t,n,l,h){const{iScale:d,vScale:g}=t,{xAxisKey:b="x",yAxisKey:r="y"}=this._parsing,C=d.axis==="x"?b:r,O=g.axis==="x"?b:r,U=[];let $,q,ee,ie;for($=l,q=l+h;$<q;++$)ie=n[$],ee={},ee[d.axis]=d.parse(Ip(ie,C),$),U.push(WL(Ip(ie,O),ee,g,$));return U}updateRangeFromParsed(t,n,l,h){super.updateRangeFromParsed(t,n,l,h);const d=l._custom;d&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,d.min),t.max=Math.max(t.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:l,vScale:h}=n,d=this.getParsed(t),g=d._custom,b=V1(g)?"["+g.start+", "+g.end+"]":""+h.getLabelForValue(d[h.axis]);return{label:""+l.getLabelForValue(d[l.axis]),value:b}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,l,h){const d=h==="reset",{index:g,_cachedMeta:{vScale:b}}=this,r=b.getBasePixel(),C=b.isHorizontal(),O=this._getRuler(),{sharedOptions:U,includeOptions:$}=this._getSharedOptions(n,h);for(let q=n;q<n+l;q++){const ee=this.getParsed(q),ie=d||ms(ee[b.axis])?{base:r,head:r}:this._calculateBarValuePixels(q),de=this._calculateBarIndexPixels(q,O),ye=(ee._stacks||{})[b.axis],be={horizontal:C,base:ie.base,enableBorderRadius:!ye||V1(ee._custom)||g===ye._top||g===ye._bottom,x:C?ie.head:de.center,y:C?de.center:ie.head,height:C?de.size:Math.abs(ie.size),width:C?Math.abs(ie.size):de.size};$&&(be.options=U||this.resolveDataElementOptions(q,t[q].active?"active":h));const se=be.options||t[q].options;Mj(be,se,ye,g),Aj(be,se,O.ratio),this.updateElement(t[q],q,be,h)}}_getStacks(t,n){const{iScale:l}=this._cachedMeta,h=l.getMatchingVisibleMetas(this._type).filter(O=>O.controller.options.grouped),d=l.options.stacked,g=[],b=this._cachedMeta.controller.getParsed(n),r=b&&b[l.axis],C=O=>{const U=O._parsed.find(q=>q[l.axis]===r),$=U&&U[O.vScale.axis];if(ms($)||isNaN($))return!0};for(const O of h)if(!(n!==void 0&&C(O))&&((d===!1||g.indexOf(O.stack)===-1||d===void 0&&O.stack===void 0)&&g.push(O.stack),O.index===t))break;return g.length||g.push(void 0),g}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(t).filter(l=>t[l].axis===n).shift()}_getAxis(){const t={},n=this.getFirstScaleIdForIndexAxis();for(const l of this.chart.data.datasets)t[Mn(this.chart.options.indexAxis==="x"?l.xAxisID:l.yAxisID,n)]=!0;return Object.keys(t)}_getStackIndex(t,n,l){const h=this._getStacks(t,l),d=n!==void 0?h.indexOf(n):-1;return d===-1?h.length-1:d}_getRuler(){const t=this.options,n=this._cachedMeta,l=n.iScale,h=[];let d,g;for(d=0,g=n.data.length;d<g;++d)h.push(l.getPixelForValue(this.getParsed(d)[l.axis],d));const b=t.barThickness;return{min:b||vj(n),pixels:h,start:l._startPixel,end:l._endPixel,stackCount:this._getStackCount(),scale:l,grouped:t.grouped,ratio:b?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:l,index:h},options:{base:d,minBarLength:g}}=this,b=d||0,r=this.getParsed(t),C=r._custom,O=V1(C);let U=r[n.axis],$=0,q=l?this.applyStack(n,r,l):U,ee,ie;q!==U&&($=q-U,q=U),O&&(U=C.barStart,q=C.barEnd-C.barStart,U!==0&&ah(U)!==ah(C.barEnd)&&($=0),$+=U);const de=!ms(d)&&!O?d:$;let ye=n.getPixelForValue(de);if(this.chart.getDataVisibility(t)?ee=n.getPixelForValue($+q):ee=ye,ie=ee-ye,Math.abs(ie)<g){ie=Ej(ie,n,b)*g,U===b&&(ye-=ie/2);const be=n.getPixelForDecimal(0),se=n.getPixelForDecimal(1),he=Math.min(be,se),fe=Math.max(be,se);ye=Math.max(Math.min(ye,fe),he),ee=ye+ie,l&&!O&&(r._stacks[n.axis]._visualValues[h]=n.getValueForPixel(ee)-n.getValueForPixel(ye))}if(ye===n.getPixelForValue(b)){const be=ah(ie)*n.getLineWidthForValue(b)/2;ye+=be,ie-=be}return{size:ie,base:ye,head:ee,center:ee+ie/2}}_calculateBarIndexPixels(t,n){const l=n.scale,h=this.options,d=h.skipNull,g=Mn(h.maxBarThickness,1/0);let b,r;const C=this._getAxisCount();if(n.grouped){const O=d?this._getStackCount(t):n.stackCount,U=h.barThickness==="flex"?wj(t,n,h,O*C):bj(t,n,h,O*C),$=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,q=this._getAxis().indexOf(Mn($,this.getFirstScaleIdForIndexAxis())),ee=this._getStackIndex(this.index,this._cachedMeta.stack,d?t:void 0)+q;b=U.start+U.chunk*ee+U.chunk/2,r=Math.min(g,U.chunk*U.ratio)}else b=l.getPixelForValue(this.getParsed(t)[l.axis],t),r=Math.min(g,n.min*n.ratio);return{base:b-r/2,head:b+r/2,center:b,size:r}}draw(){const t=this._cachedMeta,n=t.vScale,l=t.data,h=l.length;let d=0;for(;d<h;++d)this.getParsed(d)[n.axis]!==null&&!l[d].hidden&&l[d].draw(this._ctx)}}Fi(R0,"id","bar"),Fi(R0,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Fi(R0,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function kj(e,t,n){let l=1,h=1,d=0,g=0;if(t<rr){const b=e,r=b+t,C=Math.cos(b),O=Math.sin(b),U=Math.cos(r),$=Math.sin(r),q=(se,he,fe)=>Py(se,b,r,!0)?1:Math.max(he,he*n,fe,fe*n),ee=(se,he,fe)=>Py(se,b,r,!0)?-1:Math.min(he,he*n,fe,fe*n),ie=q(0,C,U),de=q(Vr,O,$),ye=ee(ws,C,U),be=ee(ws+Vr,O,$);l=(ie-ye)/2,h=(de-be)/2,d=-(ie+ye)/2,g=-(de+be)/2}return{ratioX:l,ratioY:h,offsetX:d,offsetY:g}}class G_ extends Mp{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const l=this.getDataset().data,h=this._cachedMeta;if(this._parsing===!1)h._parsed=l;else{let d=r=>+l[r];if(Nn(l[t])){const{key:r="value"}=this._parsing;d=C=>+Ip(l[C],r)}let g,b;for(g=t,b=t+n;g<b;++g)h._parsed[g]=d(g)}}_getRotation(){return su(this.options.rotation-90)}_getCircumference(){return su(this.options.circumference)}_getRotationExtents(){let t=rr,n=-rr;for(let l=0;l<this.chart.data.datasets.length;++l)if(this.chart.isDatasetVisible(l)&&this.chart.getDatasetMeta(l).type===this._type){const h=this.chart.getDatasetMeta(l).controller,d=h._getRotation(),g=h._getCircumference();t=Math.min(t,d),n=Math.max(n,d+g)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:l}=n,h=this._cachedMeta,d=h.data,g=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,b=Math.max((Math.min(l.width,l.height)-g)/2,0),r=Math.min(BU(this.options.cutout,b),1),C=this._getRingWeight(this.index),{circumference:O,rotation:U}=this._getRotationExtents(),{ratioX:$,ratioY:q,offsetX:ee,offsetY:ie}=kj(U,O,r),de=(l.width-g)/$,ye=(l.height-g)/q,be=Math.max(Math.min(de,ye)/2,0),se=vL(this.options.radius,be),he=Math.max(se*r,0),fe=(se-he)/this._getVisibleDatasetWeightTotal();this.offsetX=ee*se,this.offsetY=ie*se,h.total=this.calculateTotal(),this.outerRadius=se-fe*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-fe*C,0),this.updateElements(d,0,d.length,t)}_circumference(t,n){const l=this.options,h=this._cachedMeta,d=this._getCircumference();return n&&l.animation.animateRotate||!this.chart.getDataVisibility(t)||h._parsed[t]===null||h.data[t].hidden?0:this.calculateCircumference(h._parsed[t]*d/rr)}updateElements(t,n,l,h){const d=h==="reset",g=this.chart,b=g.chartArea,C=g.options.animation,O=(b.left+b.right)/2,U=(b.top+b.bottom)/2,$=d&&C.animateScale,q=$?0:this.innerRadius,ee=$?0:this.outerRadius,{sharedOptions:ie,includeOptions:de}=this._getSharedOptions(n,h);let ye=this._getRotation(),be;for(be=0;be<n;++be)ye+=this._circumference(be,d);for(be=n;be<n+l;++be){const se=this._circumference(be,d),he=t[be],fe={x:O+this.offsetX,y:U+this.offsetY,startAngle:ye,endAngle:ye+se,circumference:se,outerRadius:ee,innerRadius:q};de&&(fe.options=ie||this.resolveDataElementOptions(be,he.active?"active":h)),ye+=se,this.updateElement(he,be,fe,h)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let l=0,h;for(h=0;h<n.length;h++){const d=t._parsed[h];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(h)&&!n[h].hidden&&(l+=Math.abs(d))}return l}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?rr*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,l=this.chart,h=l.data.labels||[],d=XT(n._parsed[t],l.options.locale);return{label:h[t]||"",value:d}}getMaxBorderWidth(t){let n=0;const l=this.chart;let h,d,g,b,r;if(!t){for(h=0,d=l.data.datasets.length;h<d;++h)if(l.isDatasetVisible(h)){g=l.getDatasetMeta(h),t=g.data,b=g.controller;break}}if(!t)return 0;for(h=0,d=t.length;h<d;++h)r=b.resolveDataElementOptions(h),r.borderAlign!=="inner"&&(n=Math.max(n,r.borderWidth||0,r.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let l=0,h=t.length;l<h;++l){const d=this.resolveDataElementOptions(l);n=Math.max(n,d.offset||0,d.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let l=0;l<t;++l)this.chart.isDatasetVisible(l)&&(n+=this._getRingWeight(l));return n}_getRingWeight(t){return Math.max(Mn(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Fi(G_,"id","doughnut"),Fi(G_,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Fi(G_,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Fi(G_,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:l,color:h}}=t.legend.options;return n.labels.map((d,g)=>{const r=t.getDatasetMeta(0).controller.getStyle(g);return{text:d,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,fontColor:h,lineWidth:r.borderWidth,pointStyle:l,hidden:!t.getDataVisibility(g),index:g}})}return[]}},onClick(t,n,l){l.chart.toggleDataVisibility(n.index),l.chart.update()}}}});class z0 extends Mp{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:l,data:h=[],_dataset:d}=n,g=this.chart._animationsDisabled;let{start:b,count:r}=nV(n,h,g);this._drawStart=b,this._drawCount=r,sV(n)&&(b=0,r=h.length),l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!d._decimated,l.points=h;const C=this.resolveDatasetElementOptions(t);this.options.showLine||(C.borderWidth=0),C.segment=this.options.segment,this.updateElement(l,void 0,{animated:!g,options:C},t),this.updateElements(h,b,r,t)}updateElements(t,n,l,h){const d=h==="reset",{iScale:g,vScale:b,_stacked:r,_dataset:C}=this._cachedMeta,{sharedOptions:O,includeOptions:U}=this._getSharedOptions(n,h),$=g.axis,q=b.axis,{spanGaps:ee,segment:ie}=this.options,de=Iy(ee)?ee:Number.POSITIVE_INFINITY,ye=this.chart._animationsDisabled||d||h==="none",be=n+l,se=t.length;let he=n>0&&this.getParsed(n-1);for(let fe=0;fe<se;++fe){const Me=t[fe],ze=ye?Me:{};if(fe<n||fe>=be){ze.skip=!0;continue}const ve=this.getParsed(fe),Ue=ms(ve[q]),Ne=ze[$]=g.getPixelForValue(ve[$],fe),it=ze[q]=d||Ue?b.getBasePixel():b.getPixelForValue(r?this.applyStack(b,ve,r):ve[q],fe);ze.skip=isNaN(Ne)||isNaN(it)||Ue,ze.stop=fe>0&&Math.abs(ve[$]-he[$])>de,ie&&(ze.parsed=ve,ze.raw=C.data[fe]),U&&(ze.options=O||this.resolveDataElementOptions(fe,Me.active?"active":h)),ye||this.updateElement(Me,fe,ze,h),he=ve}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,l=n.options&&n.options.borderWidth||0,h=t.data||[];if(!h.length)return l;const d=h[0].size(this.resolveDataElementOptions(0)),g=h[h.length-1].size(this.resolveDataElementOptions(h.length-1));return Math.max(l,d,g)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Fi(z0,"id","line"),Fi(z0,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Fi(z0,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function pp(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class tE{constructor(t){Fi(this,"options");this.options=t||{}}static override(t){Object.assign(tE.prototype,t)}init(){}formats(){return pp()}parse(){return pp()}format(){return pp()}add(){return pp()}diff(){return pp()}startOf(){return pp()}endOf(){return pp()}}var Ij={_date:tE};function Pj(e,t,n,l){const{controller:h,data:d,_sorted:g}=e,b=h._cachedMeta.iScale,r=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(b&&t===b.axis&&t!=="r"&&g&&d.length){const C=b._reversePixels?JU:xp;if(l){if(h._sharedOptions){const O=d[0],U=typeof O.getRange=="function"&&O.getRange(t);if(U){const $=C(d,t,n-U),q=C(d,t,n+U);return{lo:$.lo,hi:q.hi}}}}else{const O=C(d,t,n);if(r){const{vScale:U}=h._cachedMeta,{_parsed:$}=e,q=$.slice(0,O.lo+1).reverse().findIndex(ie=>!ms(ie[U.axis]));O.lo-=Math.max(0,q);const ee=$.slice(O.hi).findIndex(ie=>!ms(ie[U.axis]));O.hi+=Math.max(0,ee)}return O}}return{lo:0,hi:d.length-1}}function Jv(e,t,n,l,h){const d=e.getSortedVisibleDatasetMetas(),g=n[t];for(let b=0,r=d.length;b<r;++b){const{index:C,data:O}=d[b],{lo:U,hi:$}=Pj(d[b],t,g,h);for(let q=U;q<=$;++q){const ee=O[q];ee.skip||l(ee,C,q)}}}function Lj(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(l,h){const d=t?Math.abs(l.x-h.x):0,g=n?Math.abs(l.y-h.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(g,2))}}function j1(e,t,n,l,h){const d=[];return!h&&!e.isPointInArea(t)||Jv(e,n,t,function(b,r,C){!h&&!Ly(b,e.chartArea,0)||b.inRange(t.x,t.y,l)&&d.push({element:b,datasetIndex:r,index:C})},!0),d}function Dj(e,t,n,l){let h=[];function d(g,b,r){const{startAngle:C,endAngle:O}=g.getProps(["startAngle","endAngle"],l),{angle:U}=TL(g,{x:t.x,y:t.y});Py(U,C,O)&&h.push({element:g,datasetIndex:b,index:r})}return Jv(e,n,t,d),h}function Oj(e,t,n,l,h,d){let g=[];const b=Lj(n);let r=Number.POSITIVE_INFINITY;function C(O,U,$){const q=O.inRange(t.x,t.y,h);if(l&&!q)return;const ee=O.getCenterPoint(h);if(!(!!d||e.isPointInArea(ee))&&!q)return;const de=b(t,ee);de<r?(g=[{element:O,datasetIndex:U,index:$}],r=de):de===r&&g.push({element:O,datasetIndex:U,index:$})}return Jv(e,n,t,C),g}function $1(e,t,n,l,h,d){return!d&&!e.isPointInArea(t)?[]:n==="r"&&!l?Dj(e,t,n,h):Oj(e,t,n,l,h,d)}function VC(e,t,n,l,h){const d=[],g=n==="x"?"inXRange":"inYRange";let b=!1;return Jv(e,n,t,(r,C,O)=>{r[g]&&r[g](t[n],h)&&(d.push({element:r,datasetIndex:C,index:O}),b=b||r.inRange(t.x,t.y,h))}),l&&!b?[]:d}var Rj={modes:{index(e,t,n,l){const h=gp(t,e),d=n.axis||"x",g=n.includeInvisible||!1,b=n.intersect?j1(e,h,d,l,g):$1(e,h,d,!1,l,g),r=[];return b.length?(e.getSortedVisibleDatasetMetas().forEach(C=>{const O=b[0].index,U=C.data[O];U&&!U.skip&&r.push({element:U,datasetIndex:C.index,index:O})}),r):[]},dataset(e,t,n,l){const h=gp(t,e),d=n.axis||"xy",g=n.includeInvisible||!1;let b=n.intersect?j1(e,h,d,l,g):$1(e,h,d,!1,l,g);if(b.length>0){const r=b[0].datasetIndex,C=e.getDatasetMeta(r).data;b=[];for(let O=0;O<C.length;++O)b.push({element:C[O],datasetIndex:r,index:O})}return b},point(e,t,n,l){const h=gp(t,e),d=n.axis||"xy",g=n.includeInvisible||!1;return j1(e,h,d,l,g)},nearest(e,t,n,l){const h=gp(t,e),d=n.axis||"xy",g=n.includeInvisible||!1;return $1(e,h,d,n.intersect,l,g)},x(e,t,n,l){const h=gp(t,e);return VC(e,h,"x",n.intersect,l)},y(e,t,n,l){const h=gp(t,e);return VC(e,h,"y",n.intersect,l)}}};const GL=["left","top","right","bottom"];function F_(e,t){return e.filter(n=>n.pos===t)}function jC(e,t){return e.filter(n=>GL.indexOf(n.pos)===-1&&n.box.axis===t)}function N_(e,t){return e.sort((n,l)=>{const h=t?l:n,d=t?n:l;return h.weight===d.weight?h.index-d.index:h.weight-d.weight})}function zj(e){const t=[];let n,l,h,d,g,b;for(n=0,l=(e||[]).length;n<l;++n)h=e[n],{position:d,options:{stack:g,stackWeight:b=1}}=h,t.push({index:n,box:h,pos:d,horizontal:h.isHorizontal(),weight:h.weight,stack:g&&d+g,stackWeight:b});return t}function Bj(e){const t={};for(const n of e){const{stack:l,pos:h,stackWeight:d}=n;if(!l||!GL.includes(h))continue;const g=t[l]||(t[l]={count:0,placed:0,weight:0,size:0});g.count++,g.weight+=d}return t}function Fj(e,t){const n=Bj(e),{vBoxMaxWidth:l,hBoxMaxHeight:h}=t;let d,g,b;for(d=0,g=e.length;d<g;++d){b=e[d];const{fullSize:r}=b.box,C=n[b.stack],O=C&&b.stackWeight/C.weight;b.horizontal?(b.width=O?O*l:r&&t.availableWidth,b.height=h):(b.width=l,b.height=O?O*h:r&&t.availableHeight)}return n}function Nj(e){const t=zj(e),n=N_(t.filter(C=>C.box.fullSize),!0),l=N_(F_(t,"left"),!0),h=N_(F_(t,"right")),d=N_(F_(t,"top"),!0),g=N_(F_(t,"bottom")),b=jC(t,"x"),r=jC(t,"y");return{fullSize:n,leftAndTop:l.concat(d),rightAndBottom:h.concat(r).concat(g).concat(b),chartArea:F_(t,"chartArea"),vertical:l.concat(h).concat(r),horizontal:d.concat(g).concat(b)}}function $C(e,t,n,l){return Math.max(e[n],t[n])+Math.max(e[l],t[l])}function HL(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Uj(e,t,n,l){const{pos:h,box:d}=n,g=e.maxPadding;if(!Nn(h)){n.size&&(e[h]-=n.size);const U=l[n.stack]||{size:0,count:1};U.size=Math.max(U.size,n.horizontal?d.height:d.width),n.size=U.size/U.count,e[h]+=n.size}d.getPadding&&HL(g,d.getPadding());const b=Math.max(0,t.outerWidth-$C(g,e,"left","right")),r=Math.max(0,t.outerHeight-$C(g,e,"top","bottom")),C=b!==e.w,O=r!==e.h;return e.w=b,e.h=r,n.horizontal?{same:C,other:O}:{same:O,other:C}}function Vj(e){const t=e.maxPadding;function n(l){const h=Math.max(t[l]-e[l],0);return e[l]+=h,h}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function jj(e,t){const n=t.maxPadding;function l(h){const d={left:0,top:0,right:0,bottom:0};return h.forEach(g=>{d[g]=Math.max(t[g],n[g])}),d}return l(e?["left","right"]:["top","bottom"])}function H_(e,t,n,l){const h=[];let d,g,b,r,C,O;for(d=0,g=e.length,C=0;d<g;++d){b=e[d],r=b.box,r.update(b.width||t.w,b.height||t.h,jj(b.horizontal,t));const{same:U,other:$}=Uj(t,n,b,l);C|=U&&h.length,O=O||$,r.fullSize||h.push(b)}return C&&H_(h,t,n,l)||O}function x0(e,t,n,l,h){e.top=n,e.left=t,e.right=t+l,e.bottom=n+h,e.width=l,e.height=h}function WC(e,t,n,l){const h=n.padding;let{x:d,y:g}=t;for(const b of e){const r=b.box,C=l[b.stack]||{placed:0,weight:1},O=b.stackWeight/C.weight||1;if(b.horizontal){const U=t.w*O,$=C.size||r.height;ky(C.start)&&(g=C.start),r.fullSize?x0(r,h.left,g,n.outerWidth-h.right-h.left,$):x0(r,t.left+C.placed,g,U,$),C.start=g,C.placed+=U,g=r.bottom}else{const U=t.h*O,$=C.size||r.width;ky(C.start)&&(d=C.start),r.fullSize?x0(r,d,h.top,$,n.outerHeight-h.bottom-h.top):x0(r,d,t.top+C.placed,$,U),C.start=d,C.placed+=U,d=r.right}}t.x=d,t.y=g}var Tl={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,l){if(!e)return;const h=Cl(e.options.layout.padding),d=Math.max(t-h.width,0),g=Math.max(n-h.height,0),b=Nj(e.boxes),r=b.vertical,C=b.horizontal;vs(e.boxes,ie=>{typeof ie.beforeLayout=="function"&&ie.beforeLayout()});const O=r.reduce((ie,de)=>de.box.options&&de.box.options.display===!1?ie:ie+1,0)||1,U=Object.freeze({outerWidth:t,outerHeight:n,padding:h,availableWidth:d,availableHeight:g,vBoxMaxWidth:d/2/O,hBoxMaxHeight:g/2}),$=Object.assign({},h);HL($,Cl(l));const q=Object.assign({maxPadding:$,w:d,h:g,x:h.left,y:h.top},h),ee=Fj(r.concat(C),U);H_(b.fullSize,q,U,ee),H_(r,q,U,ee),H_(C,q,U,ee)&&H_(r,q,U,ee),Vj(q),WC(b.leftAndTop,q,U,ee),q.x+=q.w,q.y+=q.h,WC(b.rightAndBottom,q,U,ee),e.chartArea={left:q.left,top:q.top,right:q.left+q.w,bottom:q.top+q.h,height:q.h,width:q.w},vs(b.chartArea,ie=>{const de=ie.box;Object.assign(de,e.chartArea),de.update(q.w,q.h,{left:0,top:0,right:0,bottom:0})})}};class qL{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,l){}removeEventListener(t,n,l){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,l,h){return n=Math.max(0,n||t.width),l=l||t.height,{width:n,height:Math.max(0,h?Math.floor(n/h):l)}}isAttached(t){return!0}updateConfig(t){}}class $j extends qL{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const B0="$chartjs",Wj={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},GC=e=>e===null||e==="";function Gj(e,t){const n=e.style,l=e.getAttribute("height"),h=e.getAttribute("width");if(e[B0]={initial:{height:l,width:h,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",GC(h)){const d=AC(e,"width");d!==void 0&&(e.width=d)}if(GC(l))if(e.style.height==="")e.height=e.width/(t||2);else{const d=AC(e,"height");d!==void 0&&(e.height=d)}return e}const XL=qV?{passive:!0}:!1;function Hj(e,t,n){e&&e.addEventListener(t,n,XL)}function qj(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,XL)}function Xj(e,t){const n=Wj[e.type]||e.type,{x:l,y:h}=gp(e,t);return{type:n,chart:t,native:e,x:l!==void 0?l:null,y:h!==void 0?h:null}}function dv(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function Zj(e,t,n){const l=e.canvas,h=new MutationObserver(d=>{let g=!1;for(const b of d)g=g||dv(b.addedNodes,l),g=g&&!dv(b.removedNodes,l);g&&n()});return h.observe(document,{childList:!0,subtree:!0}),h}function Yj(e,t,n){const l=e.canvas,h=new MutationObserver(d=>{let g=!1;for(const b of d)g=g||dv(b.removedNodes,l),g=g&&!dv(b.addedNodes,l);g&&n()});return h.observe(document,{childList:!0,subtree:!0}),h}const Oy=new Map;let HC=0;function ZL(){const e=window.devicePixelRatio;e!==HC&&(HC=e,Oy.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function Kj(e,t){Oy.size||window.addEventListener("resize",ZL),Oy.set(e,t)}function Jj(e){Oy.delete(e),Oy.size||window.removeEventListener("resize",ZL)}function Qj(e,t,n){const l=e.canvas,h=l&&eE(l);if(!h)return;const d=CL((b,r)=>{const C=h.clientWidth;n(b,r),C<h.clientWidth&&n()},window),g=new ResizeObserver(b=>{const r=b[0],C=r.contentRect.width,O=r.contentRect.height;C===0&&O===0||d(C,O)});return g.observe(h),Kj(e,d),g}function W1(e,t,n){n&&n.disconnect(),t==="resize"&&Jj(e)}function e6(e,t,n){const l=e.canvas,h=CL(d=>{e.ctx!==null&&n(Xj(d,e))},e);return Hj(l,t,h),h}class t6 extends qL{acquireContext(t,n){const l=t&&t.getContext&&t.getContext("2d");return l&&l.canvas===t?(Gj(t,n),l):null}releaseContext(t){const n=t.canvas;if(!n[B0])return!1;const l=n[B0].initial;["height","width"].forEach(d=>{const g=l[d];ms(g)?n.removeAttribute(d):n.setAttribute(d,g)});const h=l.style||{};return Object.keys(h).forEach(d=>{n.style[d]=h[d]}),n.width=n.width,delete n[B0],!0}addEventListener(t,n,l){this.removeEventListener(t,n);const h=t.$proxies||(t.$proxies={}),g={attach:Zj,detach:Yj,resize:Qj}[n]||e6;h[n]=g(t,n,l)}removeEventListener(t,n){const l=t.$proxies||(t.$proxies={}),h=l[n];if(!h)return;({attach:W1,detach:W1,resize:W1}[n]||qj)(t,n,h),l[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,l,h){return HV(t,n,l,h)}isAttached(t){const n=t&&eE(t);return!!(n&&n.isConnected)}}function i6(e){return!QT()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?$j:t6}var M0;let du=(M0=class{constructor(){Fi(this,"x");Fi(this,"y");Fi(this,"active",!1);Fi(this,"options");Fi(this,"$animations")}tooltipPosition(t){const{x:n,y:l}=this.getProps(["x","y"],t);return{x:n,y:l}}hasValue(){return Iy(this.x)&&Iy(this.y)}getProps(t,n){const l=this.$animations;if(!n||!l)return this;const h={};return t.forEach(d=>{h[d]=l[d]&&l[d].active()?l[d]._to:this[d]}),h}},Fi(M0,"defaults",{}),Fi(M0,"defaultRoutes"),M0);function n6(e,t){const n=e.options.ticks,l=s6(e),h=Math.min(n.maxTicksLimit||l,l),d=n.major.enabled?o6(t):[],g=d.length,b=d[0],r=d[g-1],C=[];if(g>h)return a6(t,C,d,g/h),C;const O=r6(d,t,h);if(g>0){let U,$;const q=g>1?Math.round((r-b)/(g-1)):null;for(v0(t,C,O,ms(q)?0:b-q,b),U=0,$=g-1;U<$;U++)v0(t,C,O,d[U],d[U+1]);return v0(t,C,O,r,ms(q)?t.length:r+q),C}return v0(t,C,O),C}function s6(e){const t=e.options.offset,n=e._tickSize(),l=e._length/n+(t?0:1),h=e._maxLength/n;return Math.floor(Math.min(l,h))}function r6(e,t,n){const l=l6(e),h=t.length/n;if(!l)return Math.max(h,1);const d=GU(l);for(let g=0,b=d.length-1;g<b;g++){const r=d[g];if(r>h)return r}return Math.max(h,1)}function o6(e){const t=[];let n,l;for(n=0,l=e.length;n<l;n++)e[n].major&&t.push(n);return t}function a6(e,t,n,l){let h=0,d=n[0],g;for(l=Math.ceil(l),g=0;g<e.length;g++)g===d&&(t.push(e[g]),h++,d=n[h*l])}function v0(e,t,n,l,h){const d=Mn(l,0),g=Math.min(Mn(h,e.length),e.length);let b=0,r,C,O;for(n=Math.ceil(n),h&&(r=h-l,n=r/Math.floor(r/n)),O=d;O<0;)b++,O=Math.round(d+b*n);for(C=Math.max(d,0);C<g;C++)C===O&&(t.push(e[C]),b++,O=Math.round(d+b*n))}function l6(e){const t=e.length;let n,l;if(t<2)return!1;for(l=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==l)return!1;return l}const c6=e=>e==="left"?"right":e==="right"?"left":e,qC=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,XC=(e,t)=>Math.min(t||e,e);function ZC(e,t){const n=[],l=e.length/t,h=e.length;let d=0;for(;d<h;d+=l)n.push(e[Math.floor(d)]);return n}function h6(e,t,n){const l=e.ticks.length,h=Math.min(t,l-1),d=e._startPixel,g=e._endPixel,b=1e-6;let r=e.getPixelForTick(h),C;if(!(n&&(l===1?C=Math.max(r-d,g-r):t===0?C=(e.getPixelForTick(1)-r)/2:C=(r-e.getPixelForTick(h-1))/2,r+=h<t?C:-C,r<d-b||r>g+b)))return r}function u6(e,t){vs(e,n=>{const l=n.gc,h=l.length/2;let d;if(h>t){for(d=0;d<h;++d)delete n.data[l[d]];l.splice(0,h)}})}function U_(e){return e.drawTicks?e.tickLength:0}function YC(e,t){if(!e.display)return 0;const n=Lo(e.font,t),l=Cl(e.padding);return(Dr(e.text)?e.text.length:1)*n.lineHeight+l.height}function d6(e,t){return zp(e,{scale:t,type:"scale"})}function f6(e,t,n){return zp(e,{tick:n,index:t,type:"tick"})}function p6(e,t,n){let l=HT(e);return(n&&t!=="right"||!n&&t==="right")&&(l=c6(l)),l}function m6(e,t,n,l){const{top:h,left:d,bottom:g,right:b,chart:r}=e,{chartArea:C,scales:O}=r;let U=0,$,q,ee;const ie=g-h,de=b-d;if(e.isHorizontal()){if(q=So(l,d,b),Nn(n)){const ye=Object.keys(n)[0],be=n[ye];ee=O[ye].getPixelForValue(be)+ie-t}else n==="center"?ee=(C.bottom+C.top)/2+ie-t:ee=qC(e,n,t);$=b-d}else{if(Nn(n)){const ye=Object.keys(n)[0],be=n[ye];q=O[ye].getPixelForValue(be)-de+t}else n==="center"?q=(C.left+C.right)/2-de+t:q=qC(e,n,t);ee=So(l,g,h),U=n==="left"?-Vr:Vr}return{titleX:q,titleY:ee,maxWidth:$,rotation:U}}class Ag extends du{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:l,_suggestedMax:h}=this;return t=Jc(t,Number.POSITIVE_INFINITY),n=Jc(n,Number.NEGATIVE_INFINITY),l=Jc(l,Number.POSITIVE_INFINITY),h=Jc(h,Number.NEGATIVE_INFINITY),{min:Jc(t,l),max:Jc(n,h),minDefined:Do(t),maxDefined:Do(n)}}getMinMax(t){let{min:n,max:l,minDefined:h,maxDefined:d}=this.getUserBounds(),g;if(h&&d)return{min:n,max:l};const b=this.getMatchingVisibleMetas();for(let r=0,C=b.length;r<C;++r)g=b[r].controller.getMinMax(this,t),h||(n=Math.min(n,g.min)),d||(l=Math.max(l,g.max));return n=d&&n>l?l:n,l=h&&n>l?n:l,{min:Jc(n,Jc(l,n)),max:Jc(l,Jc(n,l))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qs(this.options.beforeUpdate,[this])}update(t,n,l){const{beginAtZero:h,grace:d,ticks:g}=this.options,b=g.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=l=Object.assign({left:0,right:0,top:0,bottom:0},l),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+l.left+l.right:this.height+l.top+l.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=EV(this,d,h),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const r=b<this.ticks.length;this._convertTicksToLabels(r?ZC(this.ticks,b):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),g.display&&(g.autoSkip||g.source==="auto")&&(this.ticks=n6(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),r&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,l;this.isHorizontal()?(n=this.left,l=this.right):(n=this.top,l=this.bottom,t=!t),this._startPixel=n,this._endPixel=l,this._reversePixels=t,this._length=l-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qs(this.options.afterUpdate,[this])}beforeSetDimensions(){qs(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qs(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),qs(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qs(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let l,h,d;for(l=0,h=t.length;l<h;l++)d=t[l],d.label=qs(n.callback,[d.value,l,t],this)}afterTickToLabelConversion(){qs(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qs(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,l=XC(this.ticks.length,t.ticks.maxTicksLimit),h=n.minRotation||0,d=n.maxRotation;let g=h,b,r,C;if(!this._isVisible()||!n.display||h>=d||l<=1||!this.isHorizontal()){this.labelRotation=h;return}const O=this._getLabelSizes(),U=O.widest.width,$=O.highest.height,q=Po(this.chart.width-U,0,this.maxWidth);b=t.offset?this.maxWidth/l:q/(l-1),U+6>b&&(b=q/(l-(t.offset?.5:1)),r=this.maxHeight-U_(t.grid)-n.padding-YC(t.title,this.chart.options.font),C=Math.sqrt(U*U+$*$),g=ZU(Math.min(Math.asin(Po((O.highest.height+6)/b,-1,1)),Math.asin(Po(r/C,-1,1))-Math.asin(Po($/C,-1,1)))),g=Math.max(h,Math.min(d,g))),this.labelRotation=g}afterCalculateLabelRotation(){qs(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qs(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:l,title:h,grid:d}}=this,g=this._isVisible(),b=this.isHorizontal();if(g){const r=YC(h,n.options.font);if(b?(t.width=this.maxWidth,t.height=U_(d)+r):(t.height=this.maxHeight,t.width=U_(d)+r),l.display&&this.ticks.length){const{first:C,last:O,widest:U,highest:$}=this._getLabelSizes(),q=l.padding*2,ee=su(this.labelRotation),ie=Math.cos(ee),de=Math.sin(ee);if(b){const ye=l.mirror?0:de*U.width+ie*$.height;t.height=Math.min(this.maxHeight,t.height+ye+q)}else{const ye=l.mirror?0:ie*U.width+de*$.height;t.width=Math.min(this.maxWidth,t.width+ye+q)}this._calculatePadding(C,O,de,ie)}}this._handleMargins(),b?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,l,h){const{ticks:{align:d,padding:g},position:b}=this.options,r=this.labelRotation!==0,C=b!=="top"&&this.axis==="x";if(this.isHorizontal()){const O=this.getPixelForTick(0)-this.left,U=this.right-this.getPixelForTick(this.ticks.length-1);let $=0,q=0;r?C?($=h*t.width,q=l*n.height):($=l*t.height,q=h*n.width):d==="start"?q=n.width:d==="end"?$=t.width:d!=="inner"&&($=t.width/2,q=n.width/2),this.paddingLeft=Math.max(($-O+g)*this.width/(this.width-O),0),this.paddingRight=Math.max((q-U+g)*this.width/(this.width-U),0)}else{let O=n.height/2,U=t.height/2;d==="start"?(O=0,U=t.height):d==="end"&&(O=n.height,U=0),this.paddingTop=O+g,this.paddingBottom=U+g}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qs(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,l;for(n=0,l=t.length;n<l;n++)ms(t[n].label)&&(t.splice(n,1),l--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let l=this.ticks;n<l.length&&(l=ZC(l,n)),this._labelSizes=t=this._computeLabelSizes(l,l.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,l){const{ctx:h,_longestTextCache:d}=this,g=[],b=[],r=Math.floor(n/XC(n,l));let C=0,O=0,U,$,q,ee,ie,de,ye,be,se,he,fe;for(U=0;U<n;U+=r){if(ee=t[U].label,ie=this._resolveTickFontOptions(U),h.font=de=ie.string,ye=d[de]=d[de]||{data:{},gc:[]},be=ie.lineHeight,se=he=0,!ms(ee)&&!Dr(ee))se=TC(h,ye.data,ye.gc,se,ee),he=be;else if(Dr(ee))for($=0,q=ee.length;$<q;++$)fe=ee[$],!ms(fe)&&!Dr(fe)&&(se=TC(h,ye.data,ye.gc,se,fe),he+=be);g.push(se),b.push(he),C=Math.max(se,C),O=Math.max(he,O)}u6(d,n);const Me=g.indexOf(C),ze=b.indexOf(O),ve=Ue=>({width:g[Ue]||0,height:b[Ue]||0});return{first:ve(0),last:ve(n-1),widest:ve(Me),highest:ve(ze),widths:g,heights:b}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return KU(this._alignToPixels?fp(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const l=n[t];return l.$context||(l.$context=f6(this.getContext(),t,l))}return this.$context||(this.$context=d6(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=su(this.labelRotation),l=Math.abs(Math.cos(n)),h=Math.abs(Math.sin(n)),d=this._getLabelSizes(),g=t.autoSkipPadding||0,b=d?d.widest.width+g:0,r=d?d.highest.height+g:0;return this.isHorizontal()?r*l>b*h?b/l:r/h:r*h<b*l?r/l:b/h}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,l=this.chart,h=this.options,{grid:d,position:g,border:b}=h,r=d.offset,C=this.isHorizontal(),U=this.ticks.length+(r?1:0),$=U_(d),q=[],ee=b.setContext(this.getContext()),ie=ee.display?ee.width:0,de=ie/2,ye=function(St){return fp(l,St,ie)};let be,se,he,fe,Me,ze,ve,Ue,Ne,it,Qe,Xe;if(g==="top")be=ye(this.bottom),ze=this.bottom-$,Ue=be-de,it=ye(t.top)+de,Xe=t.bottom;else if(g==="bottom")be=ye(this.top),it=t.top,Xe=ye(t.bottom)-de,ze=be+de,Ue=this.top+$;else if(g==="left")be=ye(this.right),Me=this.right-$,ve=be-de,Ne=ye(t.left)+de,Qe=t.right;else if(g==="right")be=ye(this.left),Ne=t.left,Qe=ye(t.right)-de,Me=be+de,ve=this.left+$;else if(n==="x"){if(g==="center")be=ye((t.top+t.bottom)/2+.5);else if(Nn(g)){const St=Object.keys(g)[0],Pt=g[St];be=ye(this.chart.scales[St].getPixelForValue(Pt))}it=t.top,Xe=t.bottom,ze=be+de,Ue=ze+$}else if(n==="y"){if(g==="center")be=ye((t.left+t.right)/2);else if(Nn(g)){const St=Object.keys(g)[0],Pt=g[St];be=ye(this.chart.scales[St].getPixelForValue(Pt))}Me=be-de,ve=Me-$,Ne=t.left,Qe=t.right}const Tt=Mn(h.ticks.maxTicksLimit,U),Rt=Math.max(1,Math.ceil(U/Tt));for(se=0;se<U;se+=Rt){const St=this.getContext(se),Pt=d.setContext(St),oi=b.setContext(St),ci=Pt.lineWidth,pn=Pt.color,Ni=oi.dash||[],ji=oi.dashOffset,An=Pt.tickWidth,Hi=Pt.tickColor,Zn=Pt.tickBorderDash||[],wn=Pt.tickBorderDashOffset;he=h6(this,se,r),he!==void 0&&(fe=fp(l,he,ci),C?Me=ve=Ne=Qe=fe:ze=Ue=it=Xe=fe,q.push({tx1:Me,ty1:ze,tx2:ve,ty2:Ue,x1:Ne,y1:it,x2:Qe,y2:Xe,width:ci,color:pn,borderDash:Ni,borderDashOffset:ji,tickWidth:An,tickColor:Hi,tickBorderDash:Zn,tickBorderDashOffset:wn}))}return this._ticksLength=U,this._borderValue=be,q}_computeLabelItems(t){const n=this.axis,l=this.options,{position:h,ticks:d}=l,g=this.isHorizontal(),b=this.ticks,{align:r,crossAlign:C,padding:O,mirror:U}=d,$=U_(l.grid),q=$+O,ee=U?-O:q,ie=-su(this.labelRotation),de=[];let ye,be,se,he,fe,Me,ze,ve,Ue,Ne,it,Qe,Xe="middle";if(h==="top")Me=this.bottom-ee,ze=this._getXAxisLabelAlignment();else if(h==="bottom")Me=this.top+ee,ze=this._getXAxisLabelAlignment();else if(h==="left"){const Rt=this._getYAxisLabelAlignment($);ze=Rt.textAlign,fe=Rt.x}else if(h==="right"){const Rt=this._getYAxisLabelAlignment($);ze=Rt.textAlign,fe=Rt.x}else if(n==="x"){if(h==="center")Me=(t.top+t.bottom)/2+q;else if(Nn(h)){const Rt=Object.keys(h)[0],St=h[Rt];Me=this.chart.scales[Rt].getPixelForValue(St)+q}ze=this._getXAxisLabelAlignment()}else if(n==="y"){if(h==="center")fe=(t.left+t.right)/2-q;else if(Nn(h)){const Rt=Object.keys(h)[0],St=h[Rt];fe=this.chart.scales[Rt].getPixelForValue(St)}ze=this._getYAxisLabelAlignment($).textAlign}n==="y"&&(r==="start"?Xe="top":r==="end"&&(Xe="bottom"));const Tt=this._getLabelSizes();for(ye=0,be=b.length;ye<be;++ye){se=b[ye],he=se.label;const Rt=d.setContext(this.getContext(ye));ve=this.getPixelForTick(ye)+d.labelOffset,Ue=this._resolveTickFontOptions(ye),Ne=Ue.lineHeight,it=Dr(he)?he.length:1;const St=it/2,Pt=Rt.color,oi=Rt.textStrokeColor,ci=Rt.textStrokeWidth;let pn=ze;g?(fe=ve,ze==="inner"&&(ye===be-1?pn=this.options.reverse?"left":"right":ye===0?pn=this.options.reverse?"right":"left":pn="center"),h==="top"?C==="near"||ie!==0?Qe=-it*Ne+Ne/2:C==="center"?Qe=-Tt.highest.height/2-St*Ne+Ne:Qe=-Tt.highest.height+Ne/2:C==="near"||ie!==0?Qe=Ne/2:C==="center"?Qe=Tt.highest.height/2-St*Ne:Qe=Tt.highest.height-it*Ne,U&&(Qe*=-1),ie!==0&&!Rt.showLabelBackdrop&&(fe+=Ne/2*Math.sin(ie))):(Me=ve,Qe=(1-it)*Ne/2);let Ni;if(Rt.showLabelBackdrop){const ji=Cl(Rt.backdropPadding),An=Tt.heights[ye],Hi=Tt.widths[ye];let Zn=Qe-ji.top,wn=0-ji.left;switch(Xe){case"middle":Zn-=An/2;break;case"bottom":Zn-=An;break}switch(ze){case"center":wn-=Hi/2;break;case"right":wn-=Hi;break;case"inner":ye===be-1?wn-=Hi:ye>0&&(wn-=Hi/2);break}Ni={left:wn,top:Zn,width:Hi+ji.width,height:An+ji.height,color:Rt.backdropColor}}de.push({label:he,font:Ue,textOffset:Qe,options:{rotation:ie,color:Pt,strokeColor:oi,strokeWidth:ci,textAlign:pn,textBaseline:Xe,translation:[fe,Me],backdrop:Ni}})}return de}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-su(this.labelRotation))return t==="top"?"left":"right";let h="center";return n.align==="start"?h="left":n.align==="end"?h="right":n.align==="inner"&&(h="inner"),h}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:l,mirror:h,padding:d}}=this.options,g=this._getLabelSizes(),b=t+d,r=g.widest.width;let C,O;return n==="left"?h?(O=this.right+d,l==="near"?C="left":l==="center"?(C="center",O+=r/2):(C="right",O+=r)):(O=this.right-b,l==="near"?C="right":l==="center"?(C="center",O-=r/2):(C="left",O=this.left)):n==="right"?h?(O=this.left+d,l==="near"?C="right":l==="center"?(C="center",O-=r/2):(C="left",O-=r)):(O=this.left+b,l==="near"?C="left":l==="center"?(C="center",O+=r/2):(C="right",O=this.right)):C="right",{textAlign:C,x:O}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:l,top:h,width:d,height:g}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(l,h,d,g),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const h=this.ticks.findIndex(d=>d.value===t);return h>=0?n.setContext(this.getContext(h)).lineWidth:0}drawGrid(t){const n=this.options.grid,l=this.ctx,h=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let d,g;const b=(r,C,O)=>{!O.width||!O.color||(l.save(),l.lineWidth=O.width,l.strokeStyle=O.color,l.setLineDash(O.borderDash||[]),l.lineDashOffset=O.borderDashOffset,l.beginPath(),l.moveTo(r.x,r.y),l.lineTo(C.x,C.y),l.stroke(),l.restore())};if(n.display)for(d=0,g=h.length;d<g;++d){const r=h[d];n.drawOnChartArea&&b({x:r.x1,y:r.y1},{x:r.x2,y:r.y2},r),n.drawTicks&&b({x:r.tx1,y:r.ty1},{x:r.tx2,y:r.ty2},{color:r.tickColor,width:r.tickWidth,borderDash:r.tickBorderDash,borderDashOffset:r.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:l,grid:h}}=this,d=l.setContext(this.getContext()),g=l.display?d.width:0;if(!g)return;const b=h.setContext(this.getContext(0)).lineWidth,r=this._borderValue;let C,O,U,$;this.isHorizontal()?(C=fp(t,this.left,g)-g/2,O=fp(t,this.right,b)+b/2,U=$=r):(U=fp(t,this.top,g)-g/2,$=fp(t,this.bottom,b)+b/2,C=O=r),n.save(),n.lineWidth=d.width,n.strokeStyle=d.color,n.beginPath(),n.moveTo(C,U),n.lineTo(O,$),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const l=this.ctx,h=this._computeLabelArea();h&&Zv(l,h);const d=this.getLabelItems(t);for(const g of d){const b=g.options,r=g.font,C=g.label,O=g.textOffset;Dy(l,C,0,O,r,b)}h&&Yv(l)}drawTitle(){const{ctx:t,options:{position:n,title:l,reverse:h}}=this;if(!l.display)return;const d=Lo(l.font),g=Cl(l.padding),b=l.align;let r=d.lineHeight/2;n==="bottom"||n==="center"||Nn(n)?(r+=g.bottom,Dr(l.text)&&(r+=d.lineHeight*(l.text.length-1))):r+=g.top;const{titleX:C,titleY:O,maxWidth:U,rotation:$}=m6(this,r,n,b);Dy(t,l.text,0,0,d,{color:l.color,maxWidth:U,rotation:$,textAlign:p6(b,n,h),textBaseline:"middle",translation:[C,O]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,l=Mn(t.grid&&t.grid.z,-1),h=Mn(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ag.prototype.draw?[{z:n,draw:d=>{this.draw(d)}}]:[{z:l,draw:d=>{this.drawBackground(),this.drawGrid(d),this.drawTitle()}},{z:h,draw:()=>{this.drawBorder()}},{z:n,draw:d=>{this.drawLabels(d)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),l=this.axis+"AxisID",h=[];let d,g;for(d=0,g=n.length;d<g;++d){const b=n[d];b[l]===this.id&&(!t||b.type===t)&&h.push(b)}return h}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return Lo(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class b0{constructor(t,n,l){this.type=t,this.scope=n,this.override=l,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let l;y6(n)&&(l=this.register(n));const h=this.items,d=t.id,g=this.scope+"."+d;if(!d)throw new Error("class does not have id: "+t);return d in h||(h[d]=t,g6(t,g,l),this.override&&xr.override(t.id,t.overrides)),g}get(t){return this.items[t]}unregister(t){const n=this.items,l=t.id,h=this.scope;l in n&&delete n[l],h&&l in xr[h]&&(delete xr[h][l],this.override&&delete Pp[l])}}function g6(e,t,n){const l=Ay(Object.create(null),[n?xr.get(n):{},xr.get(t),e.defaults]);xr.set(t,l),e.defaultRoutes&&_6(t,e.defaultRoutes),e.descriptors&&xr.describe(t,e.descriptors)}function _6(e,t){Object.keys(t).forEach(n=>{const l=n.split("."),h=l.pop(),d=[e].concat(l).join("."),g=t[n].split("."),b=g.pop(),r=g.join(".");xr.route(d,h,r,b)})}function y6(e){return"id"in e&&"defaults"in e}class x6{constructor(){this.controllers=new b0(Mp,"datasets",!0),this.elements=new b0(du,"elements"),this.plugins=new b0(Object,"plugins"),this.scales=new b0(Ag,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,l){[...n].forEach(h=>{const d=l||this._getRegistryForType(h);l||d.isForType(h)||d===this.plugins&&h.id?this._exec(t,d,h):vs(h,g=>{const b=l||this._getRegistryForType(g);this._exec(t,b,g)})})}_exec(t,n,l){const h=WT(t);qs(l["before"+h],[],l),n[t](l),qs(l["after"+h],[],l)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const l=this._typedRegistries[n];if(l.isForType(t))return l}return this.plugins}_get(t,n,l){const h=n.get(t);if(h===void 0)throw new Error('"'+t+'" is not a registered '+l+".");return h}}var ih=new x6;class v6{constructor(){this._init=[]}notify(t,n,l,h){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const d=h?this._descriptors(t).filter(h):this._descriptors(t),g=this._notify(d,t,n,l);return n==="afterDestroy"&&(this._notify(d,t,"stop"),this._notify(this._init,t,"uninstall")),g}_notify(t,n,l,h){h=h||{};for(const d of t){const g=d.plugin,b=g[l],r=[n,h,d.options];if(qs(b,r,g)===!1&&h.cancelable)return!1}return!0}invalidate(){ms(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const l=t&&t.config,h=Mn(l.options&&l.options.plugins,{}),d=b6(l);return h===!1&&!n?[]:T6(t,d,h,n)}_notifyStateChanges(t){const n=this._oldCache||[],l=this._cache,h=(d,g)=>d.filter(b=>!g.some(r=>b.plugin.id===r.plugin.id));this._notify(h(n,l),t,"stop"),this._notify(h(l,n),t,"start")}}function b6(e){const t={},n=[],l=Object.keys(ih.plugins.items);for(let d=0;d<l.length;d++)n.push(ih.getPlugin(l[d]));const h=e.plugins||[];for(let d=0;d<h.length;d++){const g=h[d];n.indexOf(g)===-1&&(n.push(g),t[g.id]=!0)}return{plugins:n,localIds:t}}function w6(e,t){return!t&&e===!1?null:e===!0?{}:e}function T6(e,{plugins:t,localIds:n},l,h){const d=[],g=e.getContext();for(const b of t){const r=b.id,C=w6(l[r],h);C!==null&&d.push({plugin:b,options:E6(e.config,{plugin:b,local:n[r]},C,g)})}return d}function E6(e,{plugin:t,local:n},l,h){const d=e.pluginScopeKeys(t),g=e.getOptionScopes(l,d);return n&&t.defaults&&g.push(t.defaults),e.createResolver(g,h,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Vw(e,t){const n=xr.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function S6(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function M6(e,t){return e===t?"_index_":"_value_"}function KC(e){if(e==="x"||e==="y"||e==="r")return e}function C6(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function jw(e,...t){if(KC(e))return e;for(const n of t){const l=n.axis||C6(n.position)||e.length>1&&KC(e[0].toLowerCase());if(l)return l}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function JC(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function A6(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(l=>l.xAxisID===e||l.yAxisID===e);if(n.length)return JC(e,"x",n[0])||JC(e,"y",n[0])}return{}}function k6(e,t){const n=Pp[e.type]||{scales:{}},l=t.scales||{},h=Vw(e.type,t),d=Object.create(null);return Object.keys(l).forEach(g=>{const b=l[g];if(!Nn(b))return console.error(`Invalid scale configuration for scale: ${g}`);if(b._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${g}`);const r=jw(g,b,A6(g,e),xr.scales[b.type]),C=M6(r,h),O=n.scales||{};d[g]=oy(Object.create(null),[{axis:r},b,O[r],O[C]])}),e.data.datasets.forEach(g=>{const b=g.type||e.type,r=g.indexAxis||Vw(b,t),O=(Pp[b]||{}).scales||{};Object.keys(O).forEach(U=>{const $=S6(U,r),q=g[$+"AxisID"]||$;d[q]=d[q]||Object.create(null),oy(d[q],[{axis:$},l[q],O[U]])})}),Object.keys(d).forEach(g=>{const b=d[g];oy(b,[xr.scales[b.type],xr.scale])}),d}function YL(e){const t=e.options||(e.options={});t.plugins=Mn(t.plugins,{}),t.scales=k6(e,t)}function KL(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function I6(e){return e=e||{},e.data=KL(e.data),YL(e),e}const QC=new Map,JL=new Set;function w0(e,t){let n=QC.get(e);return n||(n=t(),QC.set(e,n),JL.add(n)),n}const V_=(e,t,n)=>{const l=Ip(t,n);l!==void 0&&e.add(l)};class P6{constructor(t){this._config=I6(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=KL(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),YL(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return w0(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return w0(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return w0(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,l=this.type;return w0(`${l}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const l=this._scopeCache;let h=l.get(t);return(!h||n)&&(h=new Map,l.set(t,h)),h}getOptionScopes(t,n,l){const{options:h,type:d}=this,g=this._cachedScopes(t,l),b=g.get(n);if(b)return b;const r=new Set;n.forEach(O=>{t&&(r.add(t),O.forEach(U=>V_(r,t,U))),O.forEach(U=>V_(r,h,U)),O.forEach(U=>V_(r,Pp[d]||{},U)),O.forEach(U=>V_(r,xr,U)),O.forEach(U=>V_(r,Nw,U))});const C=Array.from(r);return C.length===0&&C.push(Object.create(null)),JL.has(n)&&g.set(n,C),C}chartOptionScopes(){const{options:t,type:n}=this;return[t,Pp[n]||{},xr.datasets[n]||{},{type:n},xr,Nw]}resolveNamedOptions(t,n,l,h=[""]){const d={$shared:!0},{resolver:g,subPrefixes:b}=eA(this._resolverCache,t,h);let r=g;if(D6(g,n)){d.$shared=!1,l=Rd(l)?l():l;const C=this.createResolver(t,l,b);r=_g(g,l,C)}for(const C of n)d[C]=r[C];return d}createResolver(t,n,l=[""],h){const{resolver:d}=eA(this._resolverCache,t,l);return Nn(n)?_g(d,n,void 0,h):d}}function eA(e,t,n){let l=e.get(t);l||(l=new Map,e.set(t,l));const h=n.join();let d=l.get(h);return d||(d={resolver:YT(t,n),subPrefixes:n.filter(b=>!b.toLowerCase().includes("hover"))},l.set(h,d)),d}const L6=e=>Nn(e)&&Object.getOwnPropertyNames(e).some(t=>Rd(e[t]));function D6(e,t){const{isScriptable:n,isIndexable:l}=PL(e);for(const h of t){const d=n(h),g=l(h),b=(g||d)&&e[h];if(d&&(Rd(b)||L6(b))||g&&Dr(b))return!0}return!1}var O6="4.5.0";const R6=["top","bottom","left","right","chartArea"];function tA(e,t){return e==="top"||e==="bottom"||R6.indexOf(e)===-1&&t==="x"}function iA(e,t){return function(n,l){return n[e]===l[e]?n[t]-l[t]:n[e]-l[e]}}function nA(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),qs(n&&n.onComplete,[e],t)}function z6(e){const t=e.chart,n=t.options.animation;qs(n&&n.onProgress,[e],t)}function QL(e){return QT()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const F0={},sA=e=>{const t=QL(e);return Object.values(F0).filter(n=>n.canvas===t).pop()};function B6(e,t,n){const l=Object.keys(e);for(const h of l){const d=+h;if(d>=t){const g=e[h];delete e[h],(n>0||d>t)&&(e[d+n]=g)}}}function F6(e,t,n,l){return!n||e.type==="mouseout"?null:l?t:e}var _d;let Qv=(_d=class{static register(...t){ih.add(...t),rA()}static unregister(...t){ih.remove(...t),rA()}constructor(t,n){const l=this.config=new P6(n),h=QL(t),d=sA(h);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const g=l.createResolver(l.chartOptionScopes(),this.getContext());this.platform=new(l.platform||i6(h)),this.platform.updateConfig(l);const b=this.platform.acquireContext(h,g.aspectRatio),r=b&&b.canvas,C=r&&r.height,O=r&&r.width;if(this.id=zU(),this.ctx=b,this.canvas=r,this.width=O,this.height=C,this._options=g,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new v6,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=tV(U=>this.update(U),g.resizeDelay||0),this._dataChanges=[],F0[this.id]=this,!b||!r){console.error("Failed to create chart: can't acquire context from the given item");return}Yh.listen(this,"complete",nA),Yh.listen(this,"progress",z6),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:l,height:h,_aspectRatio:d}=this;return ms(t)?n&&d?d:h?l/h:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ih}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():CC(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return EC(this.canvas,this.ctx),this}stop(){return Yh.stop(this),this}resize(t,n){Yh.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const l=this.options,h=this.canvas,d=l.maintainAspectRatio&&this.aspectRatio,g=this.platform.getMaximumSize(h,t,n,d),b=l.devicePixelRatio||this.platform.getDevicePixelRatio(),r=this.width?"resize":"attach";this.width=g.width,this.height=g.height,this._aspectRatio=this.aspectRatio,CC(this,b,!0)&&(this.notifyPlugins("resize",{size:g}),qs(l.onResize,[this,g],this),this.attached&&this._doResize(r)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};vs(n,(l,h)=>{l.id=h})}buildOrUpdateScales(){const t=this.options,n=t.scales,l=this.scales,h=Object.keys(l).reduce((g,b)=>(g[b]=!1,g),{});let d=[];n&&(d=d.concat(Object.keys(n).map(g=>{const b=n[g],r=jw(g,b),C=r==="r",O=r==="x";return{options:b,dposition:C?"chartArea":O?"bottom":"left",dtype:C?"radialLinear":O?"category":"linear"}}))),vs(d,g=>{const b=g.options,r=b.id,C=jw(r,b),O=Mn(b.type,g.dtype);(b.position===void 0||tA(b.position,C)!==tA(g.dposition))&&(b.position=g.dposition),h[r]=!0;let U=null;if(r in l&&l[r].type===O)U=l[r];else{const $=ih.getScale(O);U=new $({id:r,type:O,ctx:this.ctx,chart:this}),l[U.id]=U}U.init(b,t)}),vs(h,(g,b)=>{g||delete l[b]}),vs(l,g=>{Tl.configure(this,g,g.options),Tl.addBox(this,g)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,l=t.length;if(t.sort((h,d)=>h.index-d.index),l>n){for(let h=n;h<l;++h)this._destroyDatasetMeta(h);t.splice(n,l-n)}this._sortedMetasets=t.slice(0).sort(iA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((l,h)=>{n.filter(d=>d===l._dataset).length===0&&this._destroyDatasetMeta(h)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let l,h;for(this._removeUnreferencedMetasets(),l=0,h=n.length;l<h;l++){const d=n[l];let g=this.getDatasetMeta(l);const b=d.type||this.config.type;if(g.type&&g.type!==b&&(this._destroyDatasetMeta(l),g=this.getDatasetMeta(l)),g.type=b,g.indexAxis=d.indexAxis||Vw(b,this.options),g.order=d.order||0,g.index=l,g.label=""+d.label,g.visible=this.isDatasetVisible(l),g.controller)g.controller.updateIndex(l),g.controller.linkScales();else{const r=ih.getController(b),{datasetElementType:C,dataElementType:O}=xr.datasets[b];Object.assign(r,{dataElementType:ih.getElement(O),datasetElementType:C&&ih.getElement(C)}),g.controller=new r(this,l),t.push(g.controller)}}return this._updateMetasets(),t}_resetElements(){vs(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const l=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),h=this._animationsDisabled=!l.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let g=0;for(let C=0,O=this.data.datasets.length;C<O;C++){const{controller:U}=this.getDatasetMeta(C),$=!h&&d.indexOf(U)===-1;U.buildOrUpdateElements($),g=Math.max(+U.getMaxOverflow(),g)}g=this._minPadding=l.layout.autoPadding?g:0,this._updateLayout(g),h||vs(d,C=>{C.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(iA("z","_idx"));const{_active:b,_lastEvent:r}=this;r?this._eventHandler(r,!0):b.length&&this._updateHoverStyles(b,b,!0),this.render()}_updateScales(){vs(this.scales,t=>{Tl.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),l=new Set(t.events);(!pC(n,l)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:l,start:h,count:d}of n){const g=l==="_removeElements"?-d:d;B6(t,h,g)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,l=d=>new Set(t.filter(g=>g[0]===d).map((g,b)=>b+","+g.splice(1).join(","))),h=l(0);for(let d=1;d<n;d++)if(!pC(h,l(d)))return;return Array.from(h).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Tl.update(this,this.width,this.height,t);const n=this.chartArea,l=n.width<=0||n.height<=0;this._layers=[],vs(this.boxes,h=>{l&&h.position==="chartArea"||(h.configure&&h.configure(),this._layers.push(...h._layers()))},this),this._layers.forEach((h,d)=>{h._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,l=this.data.datasets.length;n<l;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,l=this.data.datasets.length;n<l;++n)this._updateDataset(n,Rd(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const l=this.getDatasetMeta(t),h={meta:l,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",h)!==!1&&(l.controller._update(n),h.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",h))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Yh.has(this)?this.attached&&!Yh.running(this)&&Yh.start(this):(this.draw(),nA({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:l,height:h}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(l,h)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,l=[];let h,d;for(h=0,d=n.length;h<d;++h){const g=n[h];(!t||g.visible)&&l.push(g)}return l}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,l={meta:t,index:t.index,cancelable:!0},h=VL(this,t);this.notifyPlugins("beforeDatasetDraw",l)!==!1&&(h&&Zv(n,h),t.controller.draw(),h&&Yv(n),l.cancelable=!1,this.notifyPlugins("afterDatasetDraw",l))}isPointInArea(t){return Ly(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,l,h){const d=Rj.modes[n];return typeof d=="function"?d(this,t,l,h):[]}getDatasetMeta(t){const n=this.data.datasets[t],l=this._metasets;let h=l.filter(d=>d&&d._dataset===n).pop();return h||(h={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},l.push(h)),h}getContext(){return this.$context||(this.$context=zp(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const l=this.getDatasetMeta(t);return typeof l.hidden=="boolean"?!l.hidden:!n.hidden}setDatasetVisibility(t,n){const l=this.getDatasetMeta(t);l.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,l){const h=l?"show":"hide",d=this.getDatasetMeta(t),g=d.controller._resolveAnimations(void 0,h);ky(n)?(d.data[n].hidden=!l,this.update()):(this.setDatasetVisibility(t,l),g.update(d,{visible:l}),this.update(b=>b.datasetIndex===t?h:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Yh.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),EC(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete F0[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,l=(d,g)=>{n.addEventListener(this,d,g),t[d]=g},h=(d,g,b)=>{d.offsetX=g,d.offsetY=b,this._eventHandler(d)};vs(this.options.events,d=>l(d,h))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,l=(r,C)=>{n.addEventListener(this,r,C),t[r]=C},h=(r,C)=>{t[r]&&(n.removeEventListener(this,r,C),delete t[r])},d=(r,C)=>{this.canvas&&this.resize(r,C)};let g;const b=()=>{h("attach",b),this.attached=!0,this.resize(),l("resize",d),l("detach",g)};g=()=>{this.attached=!1,h("resize",d),this._stop(),this._resize(0,0),l("attach",b)},n.isAttached(this.canvas)?b():g()}unbindEvents(){vs(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},vs(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,l){const h=l?"set":"remove";let d,g,b,r;for(n==="dataset"&&(d=this.getDatasetMeta(t[0].datasetIndex),d.controller["_"+h+"DatasetHoverStyle"]()),b=0,r=t.length;b<r;++b){g=t[b];const C=g&&this.getDatasetMeta(g.datasetIndex).controller;C&&C[h+"HoverStyle"](g.element,g.datasetIndex,g.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],l=t.map(({datasetIndex:d,index:g})=>{const b=this.getDatasetMeta(d);if(!b)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:b.data[g],index:g}});!av(l,n)&&(this._active=l,this._lastEvent=null,this._updateHoverStyles(l,n))}notifyPlugins(t,n,l){return this._plugins.notify(this,t,n,l)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,l){const h=this.options.hover,d=(r,C)=>r.filter(O=>!C.some(U=>O.datasetIndex===U.datasetIndex&&O.index===U.index)),g=d(n,t),b=l?t:d(t,n);g.length&&this.updateHoverStyle(g,h.mode,!1),b.length&&h.mode&&this.updateHoverStyle(b,h.mode,!0)}_eventHandler(t,n){const l={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},h=g=>(g.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",l,h)===!1)return;const d=this._handleEvent(t,n,l.inChartArea);return l.cancelable=!1,this.notifyPlugins("afterEvent",l,h),(d||l.changed)&&this.render(),this}_handleEvent(t,n,l){const{_active:h=[],options:d}=this,g=n,b=this._getActiveElements(t,h,l,g),r=jU(t),C=F6(t,this._lastEvent,l,r);l&&(this._lastEvent=null,qs(d.onHover,[t,b,this],this),r&&qs(d.onClick,[t,b,this],this));const O=!av(b,h);return(O||n)&&(this._active=b,this._updateHoverStyles(b,h,n)),this._lastEvent=C,O}_getActiveElements(t,n,l,h){if(t.type==="mouseout")return[];if(!l)return n;const d=this.options.hover;return this.getElementsAtEventForMode(t,d.mode,d,h)}},Fi(_d,"defaults",xr),Fi(_d,"instances",F0),Fi(_d,"overrides",Pp),Fi(_d,"registry",ih),Fi(_d,"version",O6),Fi(_d,"getChart",sA),_d);function rA(){return vs(Qv.instances,e=>e._plugins.invalidate())}function N6(e,t,n){const{startAngle:l,x:h,y:d,outerRadius:g,innerRadius:b,options:r}=t,{borderWidth:C,borderJoinStyle:O}=r,U=Math.min(C/g,Ja(l-n));if(e.beginPath(),e.arc(h,d,g-C/2,l+U/2,n-U/2),b>0){const $=Math.min(C/b,Ja(l-n));e.arc(h,d,b+C/2,n-$/2,l+$/2,!0)}else{const $=Math.min(C/2,g*Ja(l-n));if(O==="round")e.arc(h,d,$,n-ws/2,l+ws/2,!0);else if(O==="bevel"){const q=2*$*$,ee=-q*Math.cos(n+ws/2)+h,ie=-q*Math.sin(n+ws/2)+d,de=q*Math.cos(l+ws/2)+h,ye=q*Math.sin(l+ws/2)+d;e.lineTo(ee,ie),e.lineTo(de,ye)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function U6(e,t,n){const{startAngle:l,pixelMargin:h,x:d,y:g,outerRadius:b,innerRadius:r}=t;let C=h/b;e.beginPath(),e.arc(d,g,b,l-C,n+C),r>h?(C=h/r,e.arc(d,g,r,n+C,l-C,!0)):e.arc(d,g,h,n+Vr,l-Vr),e.closePath(),e.clip()}function V6(e){return ZT(e,["outerStart","outerEnd","innerStart","innerEnd"])}function j6(e,t,n,l){const h=V6(e.options.borderRadius),d=(n-t)/2,g=Math.min(d,l*t/2),b=r=>{const C=(n-Math.min(d,r))*l/2;return Po(r,0,Math.min(d,C))};return{outerStart:b(h.outerStart),outerEnd:b(h.outerEnd),innerStart:Po(h.innerStart,0,g),innerEnd:Po(h.innerEnd,0,g)}}function Hm(e,t,n,l){return{x:n+e*Math.cos(t),y:l+e*Math.sin(t)}}function fv(e,t,n,l,h,d){const{x:g,y:b,startAngle:r,pixelMargin:C,innerRadius:O}=t,U=Math.max(t.outerRadius+l+n-C,0),$=O>0?O+l+n+C:0;let q=0;const ee=h-r;if(l){const Rt=O>0?O-l:0,St=U>0?U-l:0,Pt=(Rt+St)/2,oi=Pt!==0?ee*Pt/(Pt+l):ee;q=(ee-oi)/2}const ie=Math.max(.001,ee*U-n/ws)/U,de=(ee-ie)/2,ye=r+de+q,be=h-de-q,{outerStart:se,outerEnd:he,innerStart:fe,innerEnd:Me}=j6(t,$,U,be-ye),ze=U-se,ve=U-he,Ue=ye+se/ze,Ne=be-he/ve,it=$+fe,Qe=$+Me,Xe=ye+fe/it,Tt=be-Me/Qe;if(e.beginPath(),d){const Rt=(Ue+Ne)/2;if(e.arc(g,b,U,Ue,Rt),e.arc(g,b,U,Rt,Ne),he>0){const ci=Hm(ve,Ne,g,b);e.arc(ci.x,ci.y,he,Ne,be+Vr)}const St=Hm(Qe,be,g,b);if(e.lineTo(St.x,St.y),Me>0){const ci=Hm(Qe,Tt,g,b);e.arc(ci.x,ci.y,Me,be+Vr,Tt+Math.PI)}const Pt=(be-Me/$+(ye+fe/$))/2;if(e.arc(g,b,$,be-Me/$,Pt,!0),e.arc(g,b,$,Pt,ye+fe/$,!0),fe>0){const ci=Hm(it,Xe,g,b);e.arc(ci.x,ci.y,fe,Xe+Math.PI,ye-Vr)}const oi=Hm(ze,ye,g,b);if(e.lineTo(oi.x,oi.y),se>0){const ci=Hm(ze,Ue,g,b);e.arc(ci.x,ci.y,se,ye-Vr,Ue)}}else{e.moveTo(g,b);const Rt=Math.cos(Ue)*U+g,St=Math.sin(Ue)*U+b;e.lineTo(Rt,St);const Pt=Math.cos(Ne)*U+g,oi=Math.sin(Ne)*U+b;e.lineTo(Pt,oi)}e.closePath()}function $6(e,t,n,l,h){const{fullCircles:d,startAngle:g,circumference:b}=t;let r=t.endAngle;if(d){fv(e,t,n,l,r,h);for(let C=0;C<d;++C)e.fill();isNaN(b)||(r=g+(b%rr||rr))}return fv(e,t,n,l,r,h),e.fill(),r}function W6(e,t,n,l,h){const{fullCircles:d,startAngle:g,circumference:b,options:r}=t,{borderWidth:C,borderJoinStyle:O,borderDash:U,borderDashOffset:$,borderRadius:q}=r,ee=r.borderAlign==="inner";if(!C)return;e.setLineDash(U||[]),e.lineDashOffset=$,ee?(e.lineWidth=C*2,e.lineJoin=O||"round"):(e.lineWidth=C,e.lineJoin=O||"bevel");let ie=t.endAngle;if(d){fv(e,t,n,l,ie,h);for(let de=0;de<d;++de)e.stroke();isNaN(b)||(ie=g+(b%rr||rr))}ee&&U6(e,t,ie),r.selfJoin&&ie-g>=ws&&q===0&&O!=="miter"&&N6(e,t,ie),d||(fv(e,t,n,l,ie,h),e.stroke())}class q_ extends du{constructor(n){super();Fi(this,"circumference");Fi(this,"endAngle");Fi(this,"fullCircles");Fi(this,"innerRadius");Fi(this,"outerRadius");Fi(this,"pixelMargin");Fi(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,l,h){const d=this.getProps(["x","y"],h),{angle:g,distance:b}=TL(d,{x:n,y:l}),{startAngle:r,endAngle:C,innerRadius:O,outerRadius:U,circumference:$}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],h),q=(this.options.spacing+this.options.borderWidth)/2,ee=Mn($,C-r),ie=Py(g,r,C)&&r!==C,de=ee>=rr||ie,ye=ru(b,O+q,U+q);return de&&ye}getCenterPoint(n){const{x:l,y:h,startAngle:d,endAngle:g,innerRadius:b,outerRadius:r}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:C,spacing:O}=this.options,U=(d+g)/2,$=(b+r+O+C)/2;return{x:l+Math.cos(U)*$,y:h+Math.sin(U)*$}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:l,circumference:h}=this,d=(l.offset||0)/4,g=(l.spacing||0)/2,b=l.circular;if(this.pixelMargin=l.borderAlign==="inner"?.33:0,this.fullCircles=h>rr?Math.floor(h/rr):0,h===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const r=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(r)*d,Math.sin(r)*d);const C=1-Math.sin(Math.min(ws,h||0)),O=d*C;n.fillStyle=l.backgroundColor,n.strokeStyle=l.borderColor,$6(n,this,O,g,b),W6(n,this,O,g,b),n.restore()}}Fi(q_,"id","arc"),Fi(q_,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Fi(q_,"defaultRoutes",{backgroundColor:"backgroundColor"}),Fi(q_,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function eD(e,t,n=t){e.lineCap=Mn(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Mn(n.borderDash,t.borderDash)),e.lineDashOffset=Mn(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Mn(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Mn(n.borderWidth,t.borderWidth),e.strokeStyle=Mn(n.borderColor,t.borderColor)}function G6(e,t,n){e.lineTo(n.x,n.y)}function H6(e){return e.stepped?mV:e.tension||e.cubicInterpolationMode==="monotone"?gV:G6}function tD(e,t,n={}){const l=e.length,{start:h=0,end:d=l-1}=n,{start:g,end:b}=t,r=Math.max(h,g),C=Math.min(d,b),O=h<g&&d<g||h>b&&d>b;return{count:l,start:r,loop:t.loop,ilen:C<r&&!O?l+C-r:C-r}}function q6(e,t,n,l){const{points:h,options:d}=t,{count:g,start:b,loop:r,ilen:C}=tD(h,n,l),O=H6(d);let{move:U=!0,reverse:$}=l||{},q,ee,ie;for(q=0;q<=C;++q)ee=h[(b+($?C-q:q))%g],!ee.skip&&(U?(e.moveTo(ee.x,ee.y),U=!1):O(e,ie,ee,$,d.stepped),ie=ee);return r&&(ee=h[(b+($?C:0))%g],O(e,ie,ee,$,d.stepped)),!!r}function X6(e,t,n,l){const h=t.points,{count:d,start:g,ilen:b}=tD(h,n,l),{move:r=!0,reverse:C}=l||{};let O=0,U=0,$,q,ee,ie,de,ye;const be=he=>(g+(C?b-he:he))%d,se=()=>{ie!==de&&(e.lineTo(O,de),e.lineTo(O,ie),e.lineTo(O,ye))};for(r&&(q=h[be(0)],e.moveTo(q.x,q.y)),$=0;$<=b;++$){if(q=h[be($)],q.skip)continue;const he=q.x,fe=q.y,Me=he|0;Me===ee?(fe<ie?ie=fe:fe>de&&(de=fe),O=(U*O+he)/++U):(se(),e.lineTo(he,fe),ee=Me,U=0,ie=de=fe),ye=fe}se()}function $w(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?X6:q6}function Z6(e){return e.stepped?XV:e.tension||e.cubicInterpolationMode==="monotone"?ZV:_p}function Y6(e,t,n,l){let h=t._path;h||(h=t._path=new Path2D,t.path(h,n,l)&&h.closePath()),eD(e,t.options),e.stroke(h)}function K6(e,t,n,l){const{segments:h,options:d}=t,g=$w(t);for(const b of h)eD(e,d,b.style),e.beginPath(),g(e,t,b,{start:n,end:n+l-1})&&e.closePath(),e.stroke()}const J6=typeof Path2D=="function";function Q6(e,t,n,l){J6&&!t.options.segment?Y6(e,t,n,l):K6(e,t,n,l)}class Md extends du{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const l=this.options;if((l.tension||l.cubicInterpolationMode==="monotone")&&!l.stepped&&!this._pointsUpdated){const h=l.spanGaps?this._loop:this._fullLoop;UV(this._points,l,t,h,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=tj(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,l=t.length;return l&&n[t[l-1].end]}interpolate(t,n){const l=this.options,h=t[n],d=this.points,g=UL(this,{property:n,start:h,end:h});if(!g.length)return;const b=[],r=Z6(l);let C,O;for(C=0,O=g.length;C<O;++C){const{start:U,end:$}=g[C],q=d[U],ee=d[$];if(q===ee){b.push(q);continue}const ie=Math.abs((h-q[n])/(ee[n]-q[n])),de=r(q,ee,ie,l.stepped);de[n]=t[n],b.push(de)}return b.length===1?b[0]:b}pathSegment(t,n,l){return $w(this)(t,this,n,l)}path(t,n,l){const h=this.segments,d=$w(this);let g=this._loop;n=n||0,l=l||this.points.length-n;for(const b of h)g&=d(t,this,b,{start:n,end:n+l-1});return!!g}draw(t,n,l,h){const d=this.options||{};(this.points||[]).length&&d.borderWidth&&(t.save(),Q6(t,this,l,h),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Fi(Md,"id","line"),Fi(Md,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Fi(Md,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Fi(Md,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function oA(e,t,n,l){const h=e.options,{[n]:d}=e.getProps([n],l);return Math.abs(t-d)<h.radius+h.hitRadius}class N0 extends du{constructor(n){super();Fi(this,"parsed");Fi(this,"skip");Fi(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,l,h){const d=this.options,{x:g,y:b}=this.getProps(["x","y"],h);return Math.pow(n-g,2)+Math.pow(l-b,2)<Math.pow(d.hitRadius+d.radius,2)}inXRange(n,l){return oA(this,n,"x",l)}inYRange(n,l){return oA(this,n,"y",l)}getCenterPoint(n){const{x:l,y:h}=this.getProps(["x","y"],n);return{x:l,y:h}}size(n){n=n||this.options||{};let l=n.radius||0;l=Math.max(l,l&&n.hoverRadius||0);const h=l&&n.borderWidth||0;return(l+h)*2}draw(n,l){const h=this.options;this.skip||h.radius<.1||!Ly(this,l,this.size(h)/2)||(n.strokeStyle=h.borderColor,n.lineWidth=h.borderWidth,n.fillStyle=h.backgroundColor,Uw(n,h,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Fi(N0,"id","point"),Fi(N0,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Fi(N0,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function iD(e,t){const{x:n,y:l,base:h,width:d,height:g}=e.getProps(["x","y","base","width","height"],t);let b,r,C,O,U;return e.horizontal?(U=g/2,b=Math.min(n,h),r=Math.max(n,h),C=l-U,O=l+U):(U=d/2,b=n-U,r=n+U,C=Math.min(l,h),O=Math.max(l,h)),{left:b,top:C,right:r,bottom:O}}function Cd(e,t,n,l){return e?0:Po(t,n,l)}function e$(e,t,n){const l=e.options.borderWidth,h=e.borderSkipped,d=IL(l);return{t:Cd(h.top,d.top,0,n),r:Cd(h.right,d.right,0,t),b:Cd(h.bottom,d.bottom,0,n),l:Cd(h.left,d.left,0,t)}}function t$(e,t,n){const{enableBorderRadius:l}=e.getProps(["enableBorderRadius"]),h=e.options.borderRadius,d=ag(h),g=Math.min(t,n),b=e.borderSkipped,r=l||Nn(h);return{topLeft:Cd(!r||b.top||b.left,d.topLeft,0,g),topRight:Cd(!r||b.top||b.right,d.topRight,0,g),bottomLeft:Cd(!r||b.bottom||b.left,d.bottomLeft,0,g),bottomRight:Cd(!r||b.bottom||b.right,d.bottomRight,0,g)}}function i$(e){const t=iD(e),n=t.right-t.left,l=t.bottom-t.top,h=e$(e,n/2,l/2),d=t$(e,n/2,l/2);return{outer:{x:t.left,y:t.top,w:n,h:l,radius:d},inner:{x:t.left+h.l,y:t.top+h.t,w:n-h.l-h.r,h:l-h.t-h.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(h.t,h.l)),topRight:Math.max(0,d.topRight-Math.max(h.t,h.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(h.b,h.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(h.b,h.r))}}}}function G1(e,t,n,l){const h=t===null,d=n===null,b=e&&!(h&&d)&&iD(e,l);return b&&(h||ru(t,b.left,b.right))&&(d||ru(n,b.top,b.bottom))}function n$(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function s$(e,t){e.rect(t.x,t.y,t.w,t.h)}function H1(e,t,n={}){const l=e.x!==n.x?-t:0,h=e.y!==n.y?-t:0,d=(e.x+e.w!==n.x+n.w?t:0)-l,g=(e.y+e.h!==n.y+n.h?t:0)-h;return{x:e.x+l,y:e.y+h,w:e.w+d,h:e.h+g,radius:e.radius}}class U0 extends du{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:l,backgroundColor:h}}=this,{inner:d,outer:g}=i$(this),b=n$(g.radius)?hv:s$;t.save(),(g.w!==d.w||g.h!==d.h)&&(t.beginPath(),b(t,H1(g,n,d)),t.clip(),b(t,H1(d,-n,g)),t.fillStyle=l,t.fill("evenodd")),t.beginPath(),b(t,H1(d,n)),t.fillStyle=h,t.fill(),t.restore()}inRange(t,n,l){return G1(this,t,n,l)}inXRange(t,n){return G1(this,t,null,n)}inYRange(t,n){return G1(this,null,t,n)}getCenterPoint(t){const{x:n,y:l,base:h,horizontal:d}=this.getProps(["x","y","base","horizontal"],t);return{x:d?(n+h)/2:n,y:d?l:(l+h)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Fi(U0,"id","bar"),Fi(U0,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Fi(U0,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function r$(e,t,n){const l=e.segments,h=e.points,d=t.points,g=[];for(const b of l){let{start:r,end:C}=b;C=eb(r,C,h);const O=Ww(n,h[r],h[C],b.loop);if(!t.segments){g.push({source:b,target:O,start:h[r],end:h[C]});continue}const U=UL(t,O);for(const $ of U){const q=Ww(n,d[$.start],d[$.end],$.loop),ee=NL(b,h,q);for(const ie of ee)g.push({source:ie,target:$,start:{[n]:aA(O,q,"start",Math.max)},end:{[n]:aA(O,q,"end",Math.min)}})}}return g}function Ww(e,t,n,l){if(l)return;let h=t[e],d=n[e];return e==="angle"&&(h=Ja(h),d=Ja(d)),{property:e,start:h,end:d}}function o$(e,t){const{x:n=null,y:l=null}=e||{},h=t.points,d=[];return t.segments.forEach(({start:g,end:b})=>{b=eb(g,b,h);const r=h[g],C=h[b];l!==null?(d.push({x:r.x,y:l}),d.push({x:C.x,y:l})):n!==null&&(d.push({x:n,y:r.y}),d.push({x:n,y:C.y}))}),d}function eb(e,t,n){for(;t>e;t--){const l=n[t];if(!isNaN(l.x)&&!isNaN(l.y))break}return t}function aA(e,t,n,l){return e&&t?l(e[n],t[n]):e?e[n]:t?t[n]:0}function nD(e,t){let n=[],l=!1;return Dr(e)?(l=!0,n=e):n=o$(e,t),n.length?new Md({points:n,options:{tension:0},_loop:l,_fullLoop:l}):null}function lA(e){return e&&e.fill!==!1}function a$(e,t,n){let h=e[t].fill;const d=[t];let g;if(!n)return h;for(;h!==!1&&d.indexOf(h)===-1;){if(!Do(h))return h;if(g=e[h],!g)return!1;if(g.visible)return h;d.push(h),h=g.fill}return!1}function l$(e,t,n){const l=d$(e);if(Nn(l))return isNaN(l.value)?!1:l;let h=parseFloat(l);return Do(h)&&Math.floor(h)===h?c$(l[0],t,h,n):["origin","start","end","stack","shape"].indexOf(l)>=0&&l}function c$(e,t,n,l){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=l?!1:n}function h$(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:Nn(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function u$(e,t,n){let l;return e==="start"?l=n:e==="end"?l=t.options.reverse?t.min:t.max:Nn(e)?l=e.value:l=t.getBaseValue(),l}function d$(e){const t=e.options,n=t.fill;let l=Mn(n&&n.target,n);return l===void 0&&(l=!!t.backgroundColor),l===!1||l===null?!1:l===!0?"origin":l}function f$(e){const{scale:t,index:n,line:l}=e,h=[],d=l.segments,g=l.points,b=p$(t,n);b.push(nD({x:null,y:t.bottom},l));for(let r=0;r<d.length;r++){const C=d[r];for(let O=C.start;O<=C.end;O++)m$(h,g[O],b)}return new Md({points:h,options:{}})}function p$(e,t){const n=[],l=e.getMatchingVisibleMetas("line");for(let h=0;h<l.length;h++){const d=l[h];if(d.index===t)break;d.hidden||n.unshift(d.dataset)}return n}function m$(e,t,n){const l=[];for(let h=0;h<n.length;h++){const d=n[h],{first:g,last:b,point:r}=g$(d,t,"x");if(!(!r||g&&b)){if(g)l.unshift(r);else if(e.push(r),!b)break}}e.push(...l)}function g$(e,t,n){const l=e.interpolate(t,n);if(!l)return{};const h=l[n],d=e.segments,g=e.points;let b=!1,r=!1;for(let C=0;C<d.length;C++){const O=d[C],U=g[O.start][n],$=g[O.end][n];if(ru(h,U,$)){b=h===U,r=h===$;break}}return{first:b,last:r,point:l}}class sD{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,l){const{x:h,y:d,radius:g}=this;return n=n||{start:0,end:rr},t.arc(h,d,g,n.end,n.start,!0),!l.bounds}interpolate(t){const{x:n,y:l,radius:h}=this,d=t.angle;return{x:n+Math.cos(d)*h,y:l+Math.sin(d)*h,angle:d}}}function _$(e){const{chart:t,fill:n,line:l}=e;if(Do(n))return y$(t,n);if(n==="stack")return f$(e);if(n==="shape")return!0;const h=x$(e);return h instanceof sD?h:nD(h,l)}function y$(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function x$(e){return(e.scale||{}).getPointPositionForValue?b$(e):v$(e)}function v$(e){const{scale:t={},fill:n}=e,l=h$(n,t);if(Do(l)){const h=t.isHorizontal();return{x:h?l:null,y:h?null:l}}return null}function b$(e){const{scale:t,fill:n}=e,l=t.options,h=t.getLabels().length,d=l.reverse?t.max:t.min,g=u$(n,t,d),b=[];if(l.grid.circular){const r=t.getPointPositionForValue(0,d);return new sD({x:r.x,y:r.y,radius:t.getDistanceFromCenterForValue(g)})}for(let r=0;r<h;++r)b.push(t.getPointPositionForValue(r,g));return b}function q1(e,t,n){const l=_$(t),{chart:h,index:d,line:g,scale:b,axis:r}=t,C=g.options,O=C.fill,U=C.backgroundColor,{above:$=U,below:q=U}=O||{},ee=h.getDatasetMeta(d),ie=VL(h,ee);l&&g.points.length&&(Zv(e,n),w$(e,{line:g,target:l,above:$,below:q,area:n,scale:b,axis:r,clip:ie}),Yv(e))}function w$(e,t){const{line:n,target:l,above:h,below:d,area:g,scale:b,clip:r}=t,C=n._loop?"angle":t.axis;e.save();let O=d;d!==h&&(C==="x"?(cA(e,l,g.top),X1(e,{line:n,target:l,color:h,scale:b,property:C,clip:r}),e.restore(),e.save(),cA(e,l,g.bottom)):C==="y"&&(hA(e,l,g.left),X1(e,{line:n,target:l,color:d,scale:b,property:C,clip:r}),e.restore(),e.save(),hA(e,l,g.right),O=h)),X1(e,{line:n,target:l,color:O,scale:b,property:C,clip:r}),e.restore()}function cA(e,t,n){const{segments:l,points:h}=t;let d=!0,g=!1;e.beginPath();for(const b of l){const{start:r,end:C}=b,O=h[r],U=h[eb(r,C,h)];d?(e.moveTo(O.x,O.y),d=!1):(e.lineTo(O.x,n),e.lineTo(O.x,O.y)),g=!!t.pathSegment(e,b,{move:g}),g?e.closePath():e.lineTo(U.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function hA(e,t,n){const{segments:l,points:h}=t;let d=!0,g=!1;e.beginPath();for(const b of l){const{start:r,end:C}=b,O=h[r],U=h[eb(r,C,h)];d?(e.moveTo(O.x,O.y),d=!1):(e.lineTo(n,O.y),e.lineTo(O.x,O.y)),g=!!t.pathSegment(e,b,{move:g}),g?e.closePath():e.lineTo(n,U.y)}e.lineTo(n,t.first().y),e.closePath(),e.clip()}function X1(e,t){const{line:n,target:l,property:h,color:d,scale:g,clip:b}=t,r=r$(n,l,h);for(const{source:C,target:O,start:U,end:$}of r){const{style:{backgroundColor:q=d}={}}=C,ee=l!==!0;e.save(),e.fillStyle=q,T$(e,g,b,ee&&Ww(h,U,$)),e.beginPath();const ie=!!n.pathSegment(e,C);let de;if(ee){ie?e.closePath():uA(e,l,$,h);const ye=!!l.pathSegment(e,O,{move:ie,reverse:!0});de=ie&&ye,de||uA(e,l,U,h)}e.closePath(),e.fill(de?"evenodd":"nonzero"),e.restore()}}function T$(e,t,n,l){const h=t.chart.chartArea,{property:d,start:g,end:b}=l||{};if(d==="x"||d==="y"){let r,C,O,U;d==="x"?(r=g,C=h.top,O=b,U=h.bottom):(r=h.left,C=g,O=h.right,U=b),e.beginPath(),n&&(r=Math.max(r,n.left),O=Math.min(O,n.right),C=Math.max(C,n.top),U=Math.min(U,n.bottom)),e.rect(r,C,O-r,U-C),e.clip()}}function uA(e,t,n,l){const h=t.interpolate(n,l);h&&e.lineTo(h.x,h.y)}var E$={id:"filler",afterDatasetsUpdate(e,t,n){const l=(e.data.datasets||[]).length,h=[];let d,g,b,r;for(g=0;g<l;++g)d=e.getDatasetMeta(g),b=d.dataset,r=null,b&&b.options&&b instanceof Md&&(r={visible:e.isDatasetVisible(g),index:g,fill:l$(b,g,l),chart:e,axis:d.controller.options.indexAxis,scale:d.vScale,line:b}),d.$filler=r,h.push(r);for(g=0;g<l;++g)r=h[g],!(!r||r.fill===!1)&&(r.fill=a$(h,g,n.propagate))},beforeDraw(e,t,n){const l=n.drawTime==="beforeDraw",h=e.getSortedVisibleDatasetMetas(),d=e.chartArea;for(let g=h.length-1;g>=0;--g){const b=h[g].$filler;b&&(b.line.updateControlPoints(d,b.axis),l&&b.fill&&q1(e.ctx,b,d))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const l=e.getSortedVisibleDatasetMetas();for(let h=l.length-1;h>=0;--h){const d=l[h].$filler;lA(d)&&q1(e.ctx,d,e.chartArea)}},beforeDatasetDraw(e,t,n){const l=t.meta.$filler;!lA(l)||n.drawTime!=="beforeDatasetDraw"||q1(e.ctx,l,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const dA=(e,t)=>{let{boxHeight:n=t,boxWidth:l=t}=e;return e.usePointStyle&&(n=Math.min(n,t),l=e.pointStyleWidth||Math.min(l,t)),{boxWidth:l,boxHeight:n,itemHeight:Math.max(t,n)}},S$=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class fA extends du{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,l){this.maxWidth=t,this.maxHeight=n,this._margins=l,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=qs(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(l=>t.filter(l,this.chart.data))),t.sort&&(n=n.sort((l,h)=>t.sort(l,h,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const l=t.labels,h=Lo(l.font),d=h.size,g=this._computeTitleHeight(),{boxWidth:b,itemHeight:r}=dA(l,d);let C,O;n.font=h.string,this.isHorizontal()?(C=this.maxWidth,O=this._fitRows(g,d,b,r)+10):(O=this.maxHeight,C=this._fitCols(g,h,b,r)+10),this.width=Math.min(C,t.maxWidth||this.maxWidth),this.height=Math.min(O,t.maxHeight||this.maxHeight)}_fitRows(t,n,l,h){const{ctx:d,maxWidth:g,options:{labels:{padding:b}}}=this,r=this.legendHitBoxes=[],C=this.lineWidths=[0],O=h+b;let U=t;d.textAlign="left",d.textBaseline="middle";let $=-1,q=-O;return this.legendItems.forEach((ee,ie)=>{const de=l+n/2+d.measureText(ee.text).width;(ie===0||C[C.length-1]+de+2*b>g)&&(U+=O,C[C.length-(ie>0?0:1)]=0,q+=O,$++),r[ie]={left:0,top:q,row:$,width:de,height:h},C[C.length-1]+=de+b}),U}_fitCols(t,n,l,h){const{ctx:d,maxHeight:g,options:{labels:{padding:b}}}=this,r=this.legendHitBoxes=[],C=this.columnSizes=[],O=g-t;let U=b,$=0,q=0,ee=0,ie=0;return this.legendItems.forEach((de,ye)=>{const{itemWidth:be,itemHeight:se}=M$(l,n,d,de,h);ye>0&&q+se+2*b>O&&(U+=$+b,C.push({width:$,height:q}),ee+=$+b,ie++,$=q=0),r[ye]={left:ee,top:q,col:ie,width:be,height:se},$=Math.max($,be),q+=se+b}),U+=$,C.push({width:$,height:q}),U}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:l,labels:{padding:h},rtl:d}}=this,g=lg(d,this.left,this.width);if(this.isHorizontal()){let b=0,r=So(l,this.left+h,this.right-this.lineWidths[b]);for(const C of n)b!==C.row&&(b=C.row,r=So(l,this.left+h,this.right-this.lineWidths[b])),C.top+=this.top+t+h,C.left=g.leftForLtr(g.x(r),C.width),r+=C.width+h}else{let b=0,r=So(l,this.top+t+h,this.bottom-this.columnSizes[b].height);for(const C of n)C.col!==b&&(b=C.col,r=So(l,this.top+t+h,this.bottom-this.columnSizes[b].height)),C.top=r,C.left+=this.left+h,C.left=g.leftForLtr(g.x(C.left),C.width),r+=C.height+h}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Zv(t,this),this._draw(),Yv(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:l,ctx:h}=this,{align:d,labels:g}=t,b=xr.color,r=lg(t.rtl,this.left,this.width),C=Lo(g.font),{padding:O}=g,U=C.size,$=U/2;let q;this.drawTitle(),h.textAlign=r.textAlign("left"),h.textBaseline="middle",h.lineWidth=.5,h.font=C.string;const{boxWidth:ee,boxHeight:ie,itemHeight:de}=dA(g,U),ye=function(Me,ze,ve){if(isNaN(ee)||ee<=0||isNaN(ie)||ie<0)return;h.save();const Ue=Mn(ve.lineWidth,1);if(h.fillStyle=Mn(ve.fillStyle,b),h.lineCap=Mn(ve.lineCap,"butt"),h.lineDashOffset=Mn(ve.lineDashOffset,0),h.lineJoin=Mn(ve.lineJoin,"miter"),h.lineWidth=Ue,h.strokeStyle=Mn(ve.strokeStyle,b),h.setLineDash(Mn(ve.lineDash,[])),g.usePointStyle){const Ne={radius:ie*Math.SQRT2/2,pointStyle:ve.pointStyle,rotation:ve.rotation,borderWidth:Ue},it=r.xPlus(Me,ee/2),Qe=ze+$;kL(h,Ne,it,Qe,g.pointStyleWidth&&ee)}else{const Ne=ze+Math.max((U-ie)/2,0),it=r.leftForLtr(Me,ee),Qe=ag(ve.borderRadius);h.beginPath(),Object.values(Qe).some(Xe=>Xe!==0)?hv(h,{x:it,y:Ne,w:ee,h:ie,radius:Qe}):h.rect(it,Ne,ee,ie),h.fill(),Ue!==0&&h.stroke()}h.restore()},be=function(Me,ze,ve){Dy(h,ve.text,Me,ze+de/2,C,{strikethrough:ve.hidden,textAlign:r.textAlign(ve.textAlign)})},se=this.isHorizontal(),he=this._computeTitleHeight();se?q={x:So(d,this.left+O,this.right-l[0]),y:this.top+O+he,line:0}:q={x:this.left+O,y:So(d,this.top+he+O,this.bottom-n[0].height),line:0},zL(this.ctx,t.textDirection);const fe=de+O;this.legendItems.forEach((Me,ze)=>{h.strokeStyle=Me.fontColor,h.fillStyle=Me.fontColor;const ve=h.measureText(Me.text).width,Ue=r.textAlign(Me.textAlign||(Me.textAlign=g.textAlign)),Ne=ee+$+ve;let it=q.x,Qe=q.y;r.setWidth(this.width),se?ze>0&&it+Ne+O>this.right&&(Qe=q.y+=fe,q.line++,it=q.x=So(d,this.left+O,this.right-l[q.line])):ze>0&&Qe+fe>this.bottom&&(it=q.x=it+n[q.line].width+O,q.line++,Qe=q.y=So(d,this.top+he+O,this.bottom-n[q.line].height));const Xe=r.x(it);if(ye(Xe,Qe,Me),it=iV(Ue,it+ee+$,se?it+Ne:this.right,t.rtl),be(r.x(it),Qe,Me),se)q.x+=Ne+O;else if(typeof Me.text!="string"){const Tt=C.lineHeight;q.y+=rD(Me,Tt)+O}else q.y+=fe}),BL(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,l=Lo(n.font),h=Cl(n.padding);if(!n.display)return;const d=lg(t.rtl,this.left,this.width),g=this.ctx,b=n.position,r=l.size/2,C=h.top+r;let O,U=this.left,$=this.width;if(this.isHorizontal())$=Math.max(...this.lineWidths),O=this.top+C,U=So(t.align,U,this.right-$);else{const ee=this.columnSizes.reduce((ie,de)=>Math.max(ie,de.height),0);O=C+So(t.align,this.top,this.bottom-ee-t.labels.padding-this._computeTitleHeight())}const q=So(b,U,U+$);g.textAlign=d.textAlign(HT(b)),g.textBaseline="middle",g.strokeStyle=n.color,g.fillStyle=n.color,g.font=l.string,Dy(g,n.text,q,O,l)}_computeTitleHeight(){const t=this.options.title,n=Lo(t.font),l=Cl(t.padding);return t.display?n.lineHeight+l.height:0}_getLegendItemAt(t,n){let l,h,d;if(ru(t,this.left,this.right)&&ru(n,this.top,this.bottom)){for(d=this.legendHitBoxes,l=0;l<d.length;++l)if(h=d[l],ru(t,h.left,h.left+h.width)&&ru(n,h.top,h.top+h.height))return this.legendItems[l]}return null}handleEvent(t){const n=this.options;if(!k$(t.type,n))return;const l=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const h=this._hoveredItem,d=S$(h,l);h&&!d&&qs(n.onLeave,[t,h,this],this),this._hoveredItem=l,l&&!d&&qs(n.onHover,[t,l,this],this)}else l&&qs(n.onClick,[t,l,this],this)}}function M$(e,t,n,l,h){const d=C$(l,e,t,n),g=A$(h,l,t.lineHeight);return{itemWidth:d,itemHeight:g}}function C$(e,t,n,l){let h=e.text;return h&&typeof h!="string"&&(h=h.reduce((d,g)=>d.length>g.length?d:g)),t+n.size/2+l.measureText(h).width}function A$(e,t,n){let l=e;return typeof t.text!="string"&&(l=rD(t,n)),l}function rD(e,t){const n=e.text?e.text.length:0;return t*n}function k$(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var I$={id:"legend",_element:fA,start(e,t,n){const l=e.legend=new fA({ctx:e.ctx,options:n,chart:e});Tl.configure(e,l,n),Tl.addBox(e,l)},stop(e){Tl.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const l=e.legend;Tl.configure(e,l,n),l.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const l=t.datasetIndex,h=n.chart;h.isDatasetVisible(l)?(h.hide(l),t.hidden=!0):(h.show(l),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:l,textAlign:h,color:d,useBorderRadius:g,borderRadius:b}}=e.legend.options;return e._getSortedDatasetMetas().map(r=>{const C=r.controller.getStyle(n?0:void 0),O=Cl(C.borderWidth);return{text:t[r.index].label,fillStyle:C.backgroundColor,fontColor:d,hidden:!r.visible,lineCap:C.borderCapStyle,lineDash:C.borderDash,lineDashOffset:C.borderDashOffset,lineJoin:C.borderJoinStyle,lineWidth:(O.width+O.height)/4,strokeStyle:C.borderColor,pointStyle:l||C.pointStyle,rotation:C.rotation,textAlign:h||C.textAlign,borderRadius:g&&(b||C.borderRadius),datasetIndex:r.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class oD extends du{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const l=this.options;if(this.left=0,this.top=0,!l.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const h=Dr(l.text)?l.text.length:1;this._padding=Cl(l.padding);const d=h*Lo(l.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=d:this.width=d}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:l,bottom:h,right:d,options:g}=this,b=g.align;let r=0,C,O,U;return this.isHorizontal()?(O=So(b,l,d),U=n+t,C=d-l):(g.position==="left"?(O=l+t,U=So(b,h,n),r=ws*-.5):(O=d-t,U=So(b,n,h),r=ws*.5),C=h-n),{titleX:O,titleY:U,maxWidth:C,rotation:r}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const l=Lo(n.font),d=l.lineHeight/2+this._padding.top,{titleX:g,titleY:b,maxWidth:r,rotation:C}=this._drawArgs(d);Dy(t,n.text,0,0,l,{color:n.color,maxWidth:r,rotation:C,textAlign:HT(n.align),textBaseline:"middle",translation:[g,b]})}}function P$(e,t){const n=new oD({ctx:e.ctx,options:t,chart:e});Tl.configure(e,n,t),Tl.addBox(e,n),e.titleBlock=n}var L$={id:"title",_element:oD,start(e,t,n){P$(e,n)},stop(e){const t=e.titleBlock;Tl.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const l=e.titleBlock;Tl.configure(e,l,n),l.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const X_={average(e){if(!e.length)return!1;let t,n,l=new Set,h=0,d=0;for(t=0,n=e.length;t<n;++t){const b=e[t].element;if(b&&b.hasValue()){const r=b.tooltipPosition();l.add(r.x),h+=r.y,++d}}return d===0||l.size===0?!1:{x:[...l].reduce((b,r)=>b+r)/l.size,y:h/d}},nearest(e,t){if(!e.length)return!1;let n=t.x,l=t.y,h=Number.POSITIVE_INFINITY,d,g,b;for(d=0,g=e.length;d<g;++d){const r=e[d].element;if(r&&r.hasValue()){const C=r.getCenterPoint(),O=Fw(t,C);O<h&&(h=O,b=r)}}if(b){const r=b.tooltipPosition();n=r.x,l=r.y}return{x:n,y:l}}};function eh(e,t){return t&&(Dr(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Kh(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function D$(e,t){const{element:n,datasetIndex:l,index:h}=t,d=e.getDatasetMeta(l).controller,{label:g,value:b}=d.getLabelAndValue(h);return{chart:e,label:g,parsed:d.getParsed(h),raw:e.data.datasets[l].data[h],formattedValue:b,dataset:d.getDataset(),dataIndex:h,datasetIndex:l,element:n}}function pA(e,t){const n=e.chart.ctx,{body:l,footer:h,title:d}=e,{boxWidth:g,boxHeight:b}=t,r=Lo(t.bodyFont),C=Lo(t.titleFont),O=Lo(t.footerFont),U=d.length,$=h.length,q=l.length,ee=Cl(t.padding);let ie=ee.height,de=0,ye=l.reduce((he,fe)=>he+fe.before.length+fe.lines.length+fe.after.length,0);if(ye+=e.beforeBody.length+e.afterBody.length,U&&(ie+=U*C.lineHeight+(U-1)*t.titleSpacing+t.titleMarginBottom),ye){const he=t.displayColors?Math.max(b,r.lineHeight):r.lineHeight;ie+=q*he+(ye-q)*r.lineHeight+(ye-1)*t.bodySpacing}$&&(ie+=t.footerMarginTop+$*O.lineHeight+($-1)*t.footerSpacing);let be=0;const se=function(he){de=Math.max(de,n.measureText(he).width+be)};return n.save(),n.font=C.string,vs(e.title,se),n.font=r.string,vs(e.beforeBody.concat(e.afterBody),se),be=t.displayColors?g+2+t.boxPadding:0,vs(l,he=>{vs(he.before,se),vs(he.lines,se),vs(he.after,se)}),be=0,n.font=O.string,vs(e.footer,se),n.restore(),de+=ee.width,{width:de,height:ie}}function O$(e,t){const{y:n,height:l}=t;return n<l/2?"top":n>e.height-l/2?"bottom":"center"}function R$(e,t,n,l){const{x:h,width:d}=l,g=n.caretSize+n.caretPadding;if(e==="left"&&h+d+g>t.width||e==="right"&&h-d-g<0)return!0}function z$(e,t,n,l){const{x:h,width:d}=n,{width:g,chartArea:{left:b,right:r}}=e;let C="center";return l==="center"?C=h<=(b+r)/2?"left":"right":h<=d/2?C="left":h>=g-d/2&&(C="right"),R$(C,e,t,n)&&(C="center"),C}function mA(e,t,n){const l=n.yAlign||t.yAlign||O$(e,n);return{xAlign:n.xAlign||t.xAlign||z$(e,t,n,l),yAlign:l}}function B$(e,t){let{x:n,width:l}=e;return t==="right"?n-=l:t==="center"&&(n-=l/2),n}function F$(e,t,n){let{y:l,height:h}=e;return t==="top"?l+=n:t==="bottom"?l-=h+n:l-=h/2,l}function gA(e,t,n,l){const{caretSize:h,caretPadding:d,cornerRadius:g}=e,{xAlign:b,yAlign:r}=n,C=h+d,{topLeft:O,topRight:U,bottomLeft:$,bottomRight:q}=ag(g);let ee=B$(t,b);const ie=F$(t,r,C);return r==="center"?b==="left"?ee+=C:b==="right"&&(ee-=C):b==="left"?ee-=Math.max(O,$)+h:b==="right"&&(ee+=Math.max(U,q)+h),{x:Po(ee,0,l.width-t.width),y:Po(ie,0,l.height-t.height)}}function T0(e,t,n){const l=Cl(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-l.right:e.x+l.left}function _A(e){return eh([],Kh(e))}function N$(e,t,n){return zp(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function yA(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const aD={beforeTitle:Zh,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,l=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(l>0&&t.dataIndex<l)return n[t.dataIndex]}return""},afterTitle:Zh,beforeBody:Zh,beforeLabel:Zh,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return ms(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Zh,afterBody:Zh,beforeFooter:Zh,footer:Zh,afterFooter:Zh};function Ta(e,t,n,l){const h=e[t].call(n,l);return typeof h>"u"?aD[t].call(n,l):h}class Gw extends du{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,l=this.options.setContext(this.getContext()),h=l.enabled&&n.options.animation&&l.animations,d=new jL(this.chart,h);return h._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=N$(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:l}=n,h=Ta(l,"beforeTitle",this,t),d=Ta(l,"title",this,t),g=Ta(l,"afterTitle",this,t);let b=[];return b=eh(b,Kh(h)),b=eh(b,Kh(d)),b=eh(b,Kh(g)),b}getBeforeBody(t,n){return _A(Ta(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:l}=n,h=[];return vs(t,d=>{const g={before:[],lines:[],after:[]},b=yA(l,d);eh(g.before,Kh(Ta(b,"beforeLabel",this,d))),eh(g.lines,Ta(b,"label",this,d)),eh(g.after,Kh(Ta(b,"afterLabel",this,d))),h.push(g)}),h}getAfterBody(t,n){return _A(Ta(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:l}=n,h=Ta(l,"beforeFooter",this,t),d=Ta(l,"footer",this,t),g=Ta(l,"afterFooter",this,t);let b=[];return b=eh(b,Kh(h)),b=eh(b,Kh(d)),b=eh(b,Kh(g)),b}_createItems(t){const n=this._active,l=this.chart.data,h=[],d=[],g=[];let b=[],r,C;for(r=0,C=n.length;r<C;++r)b.push(D$(this.chart,n[r]));return t.filter&&(b=b.filter((O,U,$)=>t.filter(O,U,$,l))),t.itemSort&&(b=b.sort((O,U)=>t.itemSort(O,U,l))),vs(b,O=>{const U=yA(t.callbacks,O);h.push(Ta(U,"labelColor",this,O)),d.push(Ta(U,"labelPointStyle",this,O)),g.push(Ta(U,"labelTextColor",this,O))}),this.labelColors=h,this.labelPointStyles=d,this.labelTextColors=g,this.dataPoints=b,b}update(t,n){const l=this.options.setContext(this.getContext()),h=this._active;let d,g=[];if(!h.length)this.opacity!==0&&(d={opacity:0});else{const b=X_[l.position].call(this,h,this._eventPosition);g=this._createItems(l),this.title=this.getTitle(g,l),this.beforeBody=this.getBeforeBody(g,l),this.body=this.getBody(g,l),this.afterBody=this.getAfterBody(g,l),this.footer=this.getFooter(g,l);const r=this._size=pA(this,l),C=Object.assign({},b,r),O=mA(this.chart,l,C),U=gA(l,C,O,this.chart);this.xAlign=O.xAlign,this.yAlign=O.yAlign,d={opacity:1,x:U.x,y:U.y,width:r.width,height:r.height,caretX:b.x,caretY:b.y}}this._tooltipItems=g,this.$context=void 0,d&&this._resolveAnimations().update(this,d),t&&l.external&&l.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,l,h){const d=this.getCaretPosition(t,l,h);n.lineTo(d.x1,d.y1),n.lineTo(d.x2,d.y2),n.lineTo(d.x3,d.y3)}getCaretPosition(t,n,l){const{xAlign:h,yAlign:d}=this,{caretSize:g,cornerRadius:b}=l,{topLeft:r,topRight:C,bottomLeft:O,bottomRight:U}=ag(b),{x:$,y:q}=t,{width:ee,height:ie}=n;let de,ye,be,se,he,fe;return d==="center"?(he=q+ie/2,h==="left"?(de=$,ye=de-g,se=he+g,fe=he-g):(de=$+ee,ye=de+g,se=he-g,fe=he+g),be=de):(h==="left"?ye=$+Math.max(r,O)+g:h==="right"?ye=$+ee-Math.max(C,U)-g:ye=this.caretX,d==="top"?(se=q,he=se-g,de=ye-g,be=ye+g):(se=q+ie,he=se+g,de=ye+g,be=ye-g),fe=se),{x1:de,x2:ye,x3:be,y1:se,y2:he,y3:fe}}drawTitle(t,n,l){const h=this.title,d=h.length;let g,b,r;if(d){const C=lg(l.rtl,this.x,this.width);for(t.x=T0(this,l.titleAlign,l),n.textAlign=C.textAlign(l.titleAlign),n.textBaseline="middle",g=Lo(l.titleFont),b=l.titleSpacing,n.fillStyle=l.titleColor,n.font=g.string,r=0;r<d;++r)n.fillText(h[r],C.x(t.x),t.y+g.lineHeight/2),t.y+=g.lineHeight+b,r+1===d&&(t.y+=l.titleMarginBottom-b)}}_drawColorBox(t,n,l,h,d){const g=this.labelColors[l],b=this.labelPointStyles[l],{boxHeight:r,boxWidth:C}=d,O=Lo(d.bodyFont),U=T0(this,"left",d),$=h.x(U),q=r<O.lineHeight?(O.lineHeight-r)/2:0,ee=n.y+q;if(d.usePointStyle){const ie={radius:Math.min(C,r)/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:1},de=h.leftForLtr($,C)+C/2,ye=ee+r/2;t.strokeStyle=d.multiKeyBackground,t.fillStyle=d.multiKeyBackground,Uw(t,ie,de,ye),t.strokeStyle=g.borderColor,t.fillStyle=g.backgroundColor,Uw(t,ie,de,ye)}else{t.lineWidth=Nn(g.borderWidth)?Math.max(...Object.values(g.borderWidth)):g.borderWidth||1,t.strokeStyle=g.borderColor,t.setLineDash(g.borderDash||[]),t.lineDashOffset=g.borderDashOffset||0;const ie=h.leftForLtr($,C),de=h.leftForLtr(h.xPlus($,1),C-2),ye=ag(g.borderRadius);Object.values(ye).some(be=>be!==0)?(t.beginPath(),t.fillStyle=d.multiKeyBackground,hv(t,{x:ie,y:ee,w:C,h:r,radius:ye}),t.fill(),t.stroke(),t.fillStyle=g.backgroundColor,t.beginPath(),hv(t,{x:de,y:ee+1,w:C-2,h:r-2,radius:ye}),t.fill()):(t.fillStyle=d.multiKeyBackground,t.fillRect(ie,ee,C,r),t.strokeRect(ie,ee,C,r),t.fillStyle=g.backgroundColor,t.fillRect(de,ee+1,C-2,r-2))}t.fillStyle=this.labelTextColors[l]}drawBody(t,n,l){const{body:h}=this,{bodySpacing:d,bodyAlign:g,displayColors:b,boxHeight:r,boxWidth:C,boxPadding:O}=l,U=Lo(l.bodyFont);let $=U.lineHeight,q=0;const ee=lg(l.rtl,this.x,this.width),ie=function(ve){n.fillText(ve,ee.x(t.x+q),t.y+$/2),t.y+=$+d},de=ee.textAlign(g);let ye,be,se,he,fe,Me,ze;for(n.textAlign=g,n.textBaseline="middle",n.font=U.string,t.x=T0(this,de,l),n.fillStyle=l.bodyColor,vs(this.beforeBody,ie),q=b&&de!=="right"?g==="center"?C/2+O:C+2+O:0,he=0,Me=h.length;he<Me;++he){for(ye=h[he],be=this.labelTextColors[he],n.fillStyle=be,vs(ye.before,ie),se=ye.lines,b&&se.length&&(this._drawColorBox(n,t,he,ee,l),$=Math.max(U.lineHeight,r)),fe=0,ze=se.length;fe<ze;++fe)ie(se[fe]),$=U.lineHeight;vs(ye.after,ie)}q=0,$=U.lineHeight,vs(this.afterBody,ie),t.y-=d}drawFooter(t,n,l){const h=this.footer,d=h.length;let g,b;if(d){const r=lg(l.rtl,this.x,this.width);for(t.x=T0(this,l.footerAlign,l),t.y+=l.footerMarginTop,n.textAlign=r.textAlign(l.footerAlign),n.textBaseline="middle",g=Lo(l.footerFont),n.fillStyle=l.footerColor,n.font=g.string,b=0;b<d;++b)n.fillText(h[b],r.x(t.x),t.y+g.lineHeight/2),t.y+=g.lineHeight+l.footerSpacing}}drawBackground(t,n,l,h){const{xAlign:d,yAlign:g}=this,{x:b,y:r}=t,{width:C,height:O}=l,{topLeft:U,topRight:$,bottomLeft:q,bottomRight:ee}=ag(h.cornerRadius);n.fillStyle=h.backgroundColor,n.strokeStyle=h.borderColor,n.lineWidth=h.borderWidth,n.beginPath(),n.moveTo(b+U,r),g==="top"&&this.drawCaret(t,n,l,h),n.lineTo(b+C-$,r),n.quadraticCurveTo(b+C,r,b+C,r+$),g==="center"&&d==="right"&&this.drawCaret(t,n,l,h),n.lineTo(b+C,r+O-ee),n.quadraticCurveTo(b+C,r+O,b+C-ee,r+O),g==="bottom"&&this.drawCaret(t,n,l,h),n.lineTo(b+q,r+O),n.quadraticCurveTo(b,r+O,b,r+O-q),g==="center"&&d==="left"&&this.drawCaret(t,n,l,h),n.lineTo(b,r+U),n.quadraticCurveTo(b,r,b+U,r),n.closePath(),n.fill(),h.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,l=this.$animations,h=l&&l.x,d=l&&l.y;if(h||d){const g=X_[t.position].call(this,this._active,this._eventPosition);if(!g)return;const b=this._size=pA(this,t),r=Object.assign({},g,this._size),C=mA(n,t,r),O=gA(t,r,C,n);(h._to!==O.x||d._to!==O.y)&&(this.xAlign=C.xAlign,this.yAlign=C.yAlign,this.width=b.width,this.height=b.height,this.caretX=g.x,this.caretY=g.y,this._resolveAnimations().update(this,O))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let l=this.opacity;if(!l)return;this._updateAnimationTarget(n);const h={width:this.width,height:this.height},d={x:this.x,y:this.y};l=Math.abs(l)<.001?0:l;const g=Cl(n.padding),b=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&b&&(t.save(),t.globalAlpha=l,this.drawBackground(d,t,h,n),zL(t,n.textDirection),d.y+=g.top,this.drawTitle(d,t,n),this.drawBody(d,t,n),this.drawFooter(d,t,n),BL(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const l=this._active,h=t.map(({datasetIndex:b,index:r})=>{const C=this.chart.getDatasetMeta(b);if(!C)throw new Error("Cannot find a dataset at index "+b);return{datasetIndex:b,element:C.data[r],index:r}}),d=!av(l,h),g=this._positionChanged(h,n);(d||g)&&(this._active=h,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,l=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const h=this.options,d=this._active||[],g=this._getActiveElements(t,d,n,l),b=this._positionChanged(g,t),r=n||!av(g,d)||b;return r&&(this._active=g,(h.enabled||h.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),r}_getActiveElements(t,n,l,h){const d=this.options;if(t.type==="mouseout")return[];if(!h)return n.filter(b=>this.chart.data.datasets[b.datasetIndex]&&this.chart.getDatasetMeta(b.datasetIndex).controller.getParsed(b.index)!==void 0);const g=this.chart.getElementsAtEventForMode(t,d.mode,d,l);return d.reverse&&g.reverse(),g}_positionChanged(t,n){const{caretX:l,caretY:h,options:d}=this,g=X_[d.position].call(this,t,n);return g!==!1&&(l!==g.x||h!==g.y)}}Fi(Gw,"positioners",X_);var U$={id:"tooltip",_element:Gw,positioners:X_,afterInit(e,t,n){n&&(e.tooltip=new Gw({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:aD},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const V$=(e,t,n,l)=>(typeof t=="string"?(n=e.push(t)-1,l.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function j$(e,t,n,l){const h=e.indexOf(t);if(h===-1)return V$(e,t,n,l);const d=e.lastIndexOf(t);return h!==d?n:h}const $$=(e,t)=>e===null?null:Po(Math.round(e),0,t);function xA(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class Hw extends Ag{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const l=this.getLabels();for(const{index:h,label:d}of n)l[h]===d&&l.splice(h,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(ms(t))return null;const l=this.getLabels();return n=isFinite(n)&&l[n]===t?n:j$(l,t,Mn(n,t),this._addedLabels),$$(n,l.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:l,max:h}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(l=0),n||(h=this.getLabels().length-1)),this.min=l,this.max=h}buildTicks(){const t=this.min,n=this.max,l=this.options.offset,h=[];let d=this.getLabels();d=t===0&&n===d.length-1?d:d.slice(t,n+1),this._valueRange=Math.max(d.length-(l?0:1),1),this._startValue=this.min-(l?.5:0);for(let g=t;g<=n;g++)h.push({value:g});return h}getLabelForValue(t){return xA.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Fi(Hw,"id","category"),Fi(Hw,"defaults",{ticks:{callback:xA}});function W$(e,t){const n=[],{bounds:h,step:d,min:g,max:b,precision:r,count:C,maxTicks:O,maxDigits:U,includeBounds:$}=e,q=d||1,ee=O-1,{min:ie,max:de}=t,ye=!ms(g),be=!ms(b),se=!ms(C),he=(de-ie)/(U+1);let fe=gC((de-ie)/ee/q)*q,Me,ze,ve,Ue;if(fe<1e-14&&!ye&&!be)return[{value:ie},{value:de}];Ue=Math.ceil(de/fe)-Math.floor(ie/fe),Ue>ee&&(fe=gC(Ue*fe/ee/q)*q),ms(r)||(Me=Math.pow(10,r),fe=Math.ceil(fe*Me)/Me),h==="ticks"?(ze=Math.floor(ie/fe)*fe,ve=Math.ceil(de/fe)*fe):(ze=ie,ve=de),ye&&be&&d&&qU((b-g)/d,fe/1e3)?(Ue=Math.round(Math.min((b-g)/fe,O)),fe=(b-g)/Ue,ze=g,ve=b):se?(ze=ye?g:ze,ve=be?b:ve,Ue=C-1,fe=(ve-ze)/Ue):(Ue=(ve-ze)/fe,ay(Ue,Math.round(Ue),fe/1e3)?Ue=Math.round(Ue):Ue=Math.ceil(Ue));const Ne=Math.max(_C(fe),_C(ze));Me=Math.pow(10,ms(r)?Ne:r),ze=Math.round(ze*Me)/Me,ve=Math.round(ve*Me)/Me;let it=0;for(ye&&($&&ze!==g?(n.push({value:g}),ze<g&&it++,ay(Math.round((ze+it*fe)*Me)/Me,g,vA(g,he,e))&&it++):ze<g&&it++);it<Ue;++it){const Qe=Math.round((ze+it*fe)*Me)/Me;if(be&&Qe>b)break;n.push({value:Qe})}return be&&$&&ve!==b?n.length&&ay(n[n.length-1].value,b,vA(b,he,e))?n[n.length-1].value=b:n.push({value:b}):(!be||ve===b)&&n.push({value:ve}),n}function vA(e,t,{horizontal:n,minRotation:l}){const h=su(l),d=(n?Math.sin(h):Math.cos(h))||.001,g=.75*t*(""+e).length;return Math.min(t/d,g)}class G$ extends Ag{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return ms(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:l}=this.getUserBounds();let{min:h,max:d}=this;const g=r=>h=n?h:r,b=r=>d=l?d:r;if(t){const r=ah(h),C=ah(d);r<0&&C<0?b(0):r>0&&C>0&&g(0)}if(h===d){let r=d===0?1:Math.abs(d*.05);b(d+r),t||g(h-r)}this.min=h,this.max=d}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:l}=t,h;return l?(h=Math.ceil(this.max/l)-Math.floor(this.min/l)+1,h>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${l} would result generating up to ${h} ticks. Limiting to 1000.`),h=1e3)):(h=this.computeTickLimit(),n=n||11),n&&(h=Math.min(n,h)),h}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let l=this.getTickLimit();l=Math.max(2,l);const h={maxTicks:l,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},d=this._range||this,g=W$(h,d);return t.bounds==="ticks"&&XU(g,this,"value"),t.reverse?(g.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),g}configure(){const t=this.ticks;let n=this.min,l=this.max;if(super.configure(),this.options.offset&&t.length){const h=(l-n)/Math.max(t.length-1,1)/2;n-=h,l+=h}this._startValue=n,this._endValue=l,this._valueRange=l-n}getLabelForValue(t){return XT(t,this.chart.options.locale,this.options.ticks.format)}}class qw extends G${determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Do(t)?t:0,this.max=Do(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,l=su(this.options.ticks.minRotation),h=(t?Math.sin(l):Math.cos(l))||.001,d=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,d.lineHeight/h))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Fi(qw,"id","linear"),Fi(qw,"defaults",{ticks:{callback:AL.formatters.numeric}});const tb={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ca=Object.keys(tb);function bA(e,t){return e-t}function wA(e,t){if(ms(t))return null;const n=e._adapter,{parser:l,round:h,isoWeekday:d}=e._parseOpts;let g=t;return typeof l=="function"&&(g=l(g)),Do(g)||(g=typeof l=="string"?n.parse(g,l):n.parse(g)),g===null?null:(h&&(g=h==="week"&&(Iy(d)||d===!0)?n.startOf(g,"isoWeek",d):n.startOf(g,h)),+g)}function TA(e,t,n,l){const h=Ca.length;for(let d=Ca.indexOf(e);d<h-1;++d){const g=tb[Ca[d]],b=g.steps?g.steps:Number.MAX_SAFE_INTEGER;if(g.common&&Math.ceil((n-t)/(b*g.size))<=l)return Ca[d]}return Ca[h-1]}function H$(e,t,n,l,h){for(let d=Ca.length-1;d>=Ca.indexOf(n);d--){const g=Ca[d];if(tb[g].common&&e._adapter.diff(h,l,g)>=t-1)return g}return Ca[n?Ca.indexOf(n):0]}function q$(e){for(let t=Ca.indexOf(e)+1,n=Ca.length;t<n;++t)if(tb[Ca[t]].common)return Ca[t]}function EA(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:l,hi:h}=GT(n,t),d=n[l]>=t?n[l]:n[h];e[d]=!0}}function X$(e,t,n,l){const h=e._adapter,d=+h.startOf(t[0].value,l),g=t[t.length-1].value;let b,r;for(b=d;b<=g;b=+h.add(b,1,l))r=n[b],r>=0&&(t[r].major=!0);return t}function SA(e,t,n){const l=[],h={},d=t.length;let g,b;for(g=0;g<d;++g)b=t[g],h[b]=g,l.push({value:b,major:!1});return d===0||!n?l:X$(e,l,h,n)}class pv extends Ag{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const l=t.time||(t.time={}),h=this._adapter=new Ij._date(t.adapters.date);h.init(n),oy(l.displayFormats,h.formats()),this._parseOpts={parser:l.parser,round:l.round,isoWeekday:l.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:wA(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,l=t.time.unit||"day";let{min:h,max:d,minDefined:g,maxDefined:b}=this.getUserBounds();function r(C){!g&&!isNaN(C.min)&&(h=Math.min(h,C.min)),!b&&!isNaN(C.max)&&(d=Math.max(d,C.max))}(!g||!b)&&(r(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&r(this.getMinMax(!1))),h=Do(h)&&!isNaN(h)?h:+n.startOf(Date.now(),l),d=Do(d)&&!isNaN(d)?d:+n.endOf(Date.now(),l)+1,this.min=Math.min(h,d-1),this.max=Math.max(h+1,d)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],l=t[t.length-1]),{min:n,max:l}}buildTicks(){const t=this.options,n=t.time,l=t.ticks,h=l.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&h.length&&(this.min=this._userMin||h[0],this.max=this._userMax||h[h.length-1]);const d=this.min,g=this.max,b=QU(h,d,g);return this._unit=n.unit||(l.autoSkip?TA(n.minUnit,this.min,this.max,this._getLabelCapacity(d)):H$(this,b.length,n.minUnit,this.min,this.max)),this._majorUnit=!l.major.enabled||this._unit==="year"?void 0:q$(this._unit),this.initOffsets(h),t.reverse&&b.reverse(),SA(this,b,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,l=0,h,d;this.options.offset&&t.length&&(h=this.getDecimalForValue(t[0]),t.length===1?n=1-h:n=(this.getDecimalForValue(t[1])-h)/2,d=this.getDecimalForValue(t[t.length-1]),t.length===1?l=d:l=(d-this.getDecimalForValue(t[t.length-2]))/2);const g=t.length<3?.5:.25;n=Po(n,0,g),l=Po(l,0,g),this._offsets={start:n,end:l,factor:1/(n+1+l)}}_generate(){const t=this._adapter,n=this.min,l=this.max,h=this.options,d=h.time,g=d.unit||TA(d.minUnit,n,l,this._getLabelCapacity(n)),b=Mn(h.ticks.stepSize,1),r=g==="week"?d.isoWeekday:!1,C=Iy(r)||r===!0,O={};let U=n,$,q;if(C&&(U=+t.startOf(U,"isoWeek",r)),U=+t.startOf(U,C?"day":g),t.diff(l,n,g)>1e5*b)throw new Error(n+" and "+l+" are too far apart with stepSize of "+b+" "+g);const ee=h.ticks.source==="data"&&this.getDataTimestamps();for($=U,q=0;$<l;$=+t.add($,b,g),q++)EA(O,$,ee);return($===l||h.bounds==="ticks"||q===1)&&EA(O,$,ee),Object.keys(O).sort(bA).map(ie=>+ie)}getLabelForValue(t){const n=this._adapter,l=this.options.time;return l.tooltipFormat?n.format(t,l.tooltipFormat):n.format(t,l.displayFormats.datetime)}format(t,n){const h=this.options.time.displayFormats,d=this._unit,g=n||h[d];return this._adapter.format(t,g)}_tickFormatFunction(t,n,l,h){const d=this.options,g=d.ticks.callback;if(g)return qs(g,[t,n,l],this);const b=d.time.displayFormats,r=this._unit,C=this._majorUnit,O=r&&b[r],U=C&&b[C],$=l[n],q=C&&U&&$&&$.major;return this._adapter.format(t,h||(q?U:O))}generateTickLabels(t){let n,l,h;for(n=0,l=t.length;n<l;++n)h=t[n],h.label=this._tickFormatFunction(h.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,l=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+l)*n.factor)}getValueForPixel(t){const n=this._offsets,l=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+l*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,l=this.ctx.measureText(t).width,h=su(this.isHorizontal()?n.maxRotation:n.minRotation),d=Math.cos(h),g=Math.sin(h),b=this._resolveTickFontOptions(0).size;return{w:l*d+b*g,h:l*g+b*d}}_getLabelCapacity(t){const n=this.options.time,l=n.displayFormats,h=l[n.unit]||l.millisecond,d=this._tickFormatFunction(t,0,SA(this,[t],this._majorUnit),h),g=this._getLabelSize(d),b=Math.floor(this.isHorizontal()?this.width/g.w:this.height/g.h)-1;return b>0?b:1}getDataTimestamps(){let t=this._cache.data||[],n,l;if(t.length)return t;const h=this.getMatchingVisibleMetas();if(this._normalized&&h.length)return this._cache.data=h[0].controller.getAllParsedValues(this);for(n=0,l=h.length;n<l;++n)t=t.concat(h[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,l;if(t.length)return t;const h=this.getLabels();for(n=0,l=h.length;n<l;++n)t.push(wA(this,h[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return SL(t.sort(bA))}}Fi(pv,"id","time"),Fi(pv,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function E0(e,t,n){let l=0,h=e.length-1,d,g,b,r;n?(t>=e[l].pos&&t<=e[h].pos&&({lo:l,hi:h}=xp(e,"pos",t)),{pos:d,time:b}=e[l],{pos:g,time:r}=e[h]):(t>=e[l].time&&t<=e[h].time&&({lo:l,hi:h}=xp(e,"time",t)),{time:d,pos:b}=e[l],{time:g,pos:r}=e[h]);const C=g-d;return C?b+(r-b)*(t-d)/C:b}class MA extends pv{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=E0(n,this.min),this._tableRange=E0(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:l}=this,h=[],d=[];let g,b,r,C,O;for(g=0,b=t.length;g<b;++g)C=t[g],C>=n&&C<=l&&h.push(C);if(h.length<2)return[{time:n,pos:0},{time:l,pos:1}];for(g=0,b=h.length;g<b;++g)O=h[g+1],r=h[g-1],C=h[g],Math.round((O+r)/2)!==C&&d.push({time:C,pos:g/(b-1)});return d}_generate(){const t=this.min,n=this.max;let l=super.getDataTimestamps();return(!l.includes(t)||!l.length)&&l.splice(0,0,t),(!l.includes(n)||l.length===1)&&l.push(n),l.sort((h,d)=>h-d)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),l=this.getLabelTimestamps();return n.length&&l.length?t=this.normalize(n.concat(l)):t=n.length?n:l,t=this._cache.all=t,t}getDecimalForValue(t){return(E0(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,l=this.getDecimalForPixel(t)/n.factor-n.end;return E0(this._table,l*this._tableRange+this._minPos,!0)}}Fi(MA,"id","timeseries"),Fi(MA,"defaults",pv.defaults);const lD={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},Z$={ariaLabel:{type:String},ariaDescribedby:{type:String}},Y$={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...lD,...Z$},K$=bT[0]==="2"?(e,t)=>Object.assign(e,{attrs:t}):(e,t)=>Object.assign(e,t);function qm(e){return bg(e)?Sn(e):e}function J$(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return bg(t)?new Proxy(e,{}):e}function Q$(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function cD(e,t){e.labels=t}function hD(e,t,n){const l=[];e.datasets=t.map(h=>{const d=e.datasets.find(g=>g[n]===h[n]);return!d||!h.data||l.includes(d)?{...h}:(l.push(d),Object.assign(d,h),d)})}function e8(e,t){const n={labels:[],datasets:[]};return cD(n,e.labels),hD(n,e.datasets,t),n}const t8=gs({props:Y$,setup(e,t){let{expose:n,slots:l}=t;const h=Vi(null),d=Dp(null);n({chart:d});const g=()=>{if(!h.value)return;const{type:C,data:O,options:U,plugins:$,datasetIdKey:q}=e,ee=e8(O,q),ie=J$(ee,O);d.value=new Qv(h.value,{type:C,data:ie,options:{...U},plugins:$})},b=()=>{const C=Sn(d.value);C&&(e.destroyDelay>0?setTimeout(()=>{C.destroy(),d.value=null},e.destroyDelay):(C.destroy(),d.value=null))},r=C=>{C.update(e.updateMode)};return nl(g),Eg(b),eo([()=>e.options,()=>e.data],(C,O)=>{let[U,$]=C,[q,ee]=O;const ie=Sn(d.value);if(!ie)return;let de=!1;if(U){const ye=qm(U),be=qm(q);ye&&ye!==be&&(Q$(ie,ye),de=!0)}if($){const ye=qm($.labels),be=qm(ee.labels),se=qm($.datasets),he=qm(ee.datasets);ye!==be&&(cD(ie.config.data,ye),de=!0),se&&se!==he&&(hD(ie.config.data,se,e.datasetIdKey),de=!0)}de&&Fd(()=>{r(ie)})},{deep:!0}),()=>hu("canvas",{role:"img",ariaLabel:e.ariaLabel,ariaDescribedby:e.ariaDescribedby,ref:h},[hu("p",{},[l.default?l.default():""])])}});function iE(e,t){return Qv.register(t),gs({props:lD,setup(n,l){let{expose:h}=l;const d=Dp(null),g=b=>{d.value=b==null?void 0:b.chart};return h({chart:d}),()=>hu(t8,K$({ref:g},{type:e,...n}))}})}const i8=iE("bar",R0),n8=iE("doughnut",G_),s8=iE("line",z0),r8={class:"biophysical-panel"},o8={class:"panel-title"},a8={class:"panel-description"},l8={key:0,class:"aoi"},c8={class:"control-section"},h8={class:"group-title"},u8={class:"row"},d8={class:"row-left"},f8={class:"row-title"},p8={class:"row-right"},m8=["title"],g8=["disabled"],_8=["value"],y8={class:"card"},x8={class:"chart-wrap"},v8={class:"legend"},b8={class:"card"},w8={class:"chart-title"},T8={class:"chart-wrap"},E8={class:"card"},S8={class:"chart-wrap"},M8=gs({__name:"BiophysicalMonitoringPanel",setup(e){Qv.register(L$,U$,I$,U0,q_,Hw,qw,Md,N0,E$);const t=UT(),n=gL(),l=Fn(()=>(t==null?void 0:t.selectedName)||(t==null?void 0:t.activeBoundaryName)||""),h=[2020,2021],d={2020:"landcover2020",2021:"landcover2021"},b=[{code:80,label:"Water",color:"#0f6ef3"},{code:10,label:"Forest",color:"#087200"},{code:40,label:"Cropland",color:"#f96de9"},{code:30,label:"Grassland",color:"#bb9019"},{code:20,label:"Shrubland",color:"#ffeb33"},{code:60,label:"Bareland",color:"#a0a0a0"},{code:50,label:"Built-up",color:"#ff1601"},{code:90,label:"Wetland",color:"#34baef"}].map(fe=>({label:fe.label,color:fe.color})),r=Fn({get:()=>n.lcVisible,set:fe=>n.setVisible(fe)}),C=Fn({get:()=>n.layerName==="landcover2021"?2021:2020,set:fe=>n.setYear(d[fe])}),O={2020:{Water:13e5,Forest:105e5,Cropland:62e5,Grassland:21e5,Shrubland:9e5,Bareland:75e4,"Built-up":52e4,Wetland:45e4},2021:{Water:135e4,Forest:102e5,Cropland:64e5,Grassland:22e5,Shrubland:95e4,Bareland:78e4,"Built-up":61e4,Wetland:47e4}},U=Array.from({length:14}).map((fe,Me)=>{const ze=2010+Me,ve=Math.max(0,Math.min(1,.05*(Me-2)+(Me>8?.2:0))),Ue=(Math.sin(Me)+1)*.05;return{year:ze,evi:Number((ve+Ue).toFixed(2))}}),$={2020:[{name:"Large improvement",value:16},{name:"Improvement",value:18},{name:"No Change",value:44},{name:"Under Stress",value:22}],2021:[{name:"Large improvement",value:15},{name:"Improvement",value:17},{name:"No Change",value:45},{name:"Under Stress",value:23}]},q=b.map(fe=>fe.label),ee={labels:q,datasets:[{label:"2020",data:q.map(fe=>+(O[2020][fe]||0)/1e6),backgroundColor:b.map(fe=>fe.color)},{label:"2021",data:q.map(fe=>+(O[2021][fe]||0)/1e6),backgroundColor:b.map(fe=>fe.color+"CC")}]},ie={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{mode:"index",intersect:!1,callbacks:{label:fe=>` ${fe.dataset.label}: ${fe.formattedValue} Mha`}}},scales:{x:{stacked:!0,ticks:{maxRotation:40,minRotation:40}},y:{stacked:!0,title:{display:!0,text:"Mha"},beginAtZero:!0}}},de=["#184e77","#2a9d8f","#e9c46a","#e76f51"],ye=Fn(()=>{const fe=String(C.value),Me=$[fe];return{labels:Me.map(ze=>ze.name),datasets:[{data:Me.map(ze=>ze.value),backgroundColor:de}]}}),be={responsive:!0,maintainAspectRatio:!1,cutout:"55%",plugins:{legend:{position:"right"},tooltip:{callbacks:{label:fe=>` ${fe.label}: ${fe.parsed}%`}}}},se={labels:U.map(fe=>fe.year),datasets:[{label:"Biophysical Health (EVI anomaly)",data:U.map(fe=>fe.evi),borderColor:"#0f4c5c",backgroundColor:"rgba(15,76,92,.08)",borderWidth:3,cubicInterpolationMode:"monotone",pointRadius:3,fill:!0}]},he={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{min:-.25,max:1.1,title:{display:!0,text:"Cumulative anomaly EVI"}}}};return nl(()=>{n.layerName||n.setYear("landcover2020"),n.lcVisible||n.setVisible(!0)}),eo(r,fe=>n.setVisible(fe)),eo(C,fe=>n.setYear(d[fe])),(fe,Me)=>(ui(),Ei("div",r8,[tt("h2",o8,Ht(fe.$t("biophysical.title")||"Biophysical Monitoring"),1),tt("p",a8,Ht(fe.$t("biophysical.description")||"Toggle land cover and switch the year. Charts update automatically."),1),l.value?(ui(),Ei("div",l8,[tt("strong",null,Ht(fe.$t("biophysical.selectedArea")||"Selected area")+":",1),fr(" "+Ht(l.value),1)])):xs("",!0),tt("section",c8,[tt("h3",h8,Ht(fe.$t("biophysical.mapLayers")||"Map layers"),1),tt("div",u8,[tt("div",d8,[tt("strong",f8,Ht(fe.$t("biophysical.landcover")||"Land cover"),1),Me[2]||(Me[2]=tt("small",{class:"row-sub"},"2020 / 2021",-1))]),tt("div",p8,[tt("label",{class:"switch",title:fe.$t("biophysical.showLayer")||"Show layer"},[Mo(tt("input",{type:"checkbox","onUpdate:modelValue":Me[0]||(Me[0]=ze=>r.value=ze)},null,512),[[Rv,r.value]]),Me[3]||(Me[3]=tt("span",{class:"slider"},null,-1))],8,m8),Mo(tt("select",{"onUpdate:modelValue":Me[1]||(Me[1]=ze=>C.value=ze),class:"select",disabled:!r.value},[(ui(),Ei(Dn,null,ta(h,ze=>tt("option",{key:ze,value:ze},Ht(ze),9,_8)),64))],8,g8),[[kd,C.value]])])])]),tt("section",y8,[Me[4]||(Me[4]=tt("h3",{class:"chart-title"},"Land Cover (2020 vs 2021)",-1)),tt("div",x8,[gn(hs(i8),{data:ee,options:ie})]),tt("div",v8,[(ui(!0),Ei(Dn,null,ta(hs(b),ze=>(ui(),Ei("span",{key:ze.label,class:"leg-item"},[tt("i",{class:"dot",style:uc({background:ze.color})},null,4),fr(Ht(ze.label),1)]))),128))])]),tt("section",b8,[tt("h3",w8,"Biophysical Health  "+Ht(C.value),1),tt("div",T8,[gn(hs(n8),{data:ye.value,options:be},null,8,["data"])])]),tt("section",E8,[Me[5]||(Me[5]=tt("h3",{class:"chart-title"},"EVI Trend (Cumulative Anomaly)",-1)),tt("div",S8,[gn(hs(s8),{data:se,options:he})])])]))}}),C8=ka(M8,[["__scopeId","data-v-aa18f664"]]),A8={class:"fertility-panel"},k8={class:"panel-title"},I8={class:"panel-description"},P8={class:"indicator-title"},L8={class:"baseline-current"},D8={class:"baseline"},O8={class:"current"},R8={class:"progress-bar"},z8=gs({__name:"FertilityMonitoringPanel",setup(e){const t=[{name:"organicMatter",baseline:"2.4%",current:"2.8%",change:"positive",changeClass:"change-positive",progress:65},{name:"nutrientLevels",baseline:"Medium",current:"High",change:"positive",changeClass:"change-positive",progress:75},{name:"erosionRisk",baseline:"Moderate",current:"No Change",change:"neutral",changeClass:"change-neutral",progress:50},{name:"waterRetention",baseline:"Low",current:"Moderate",change:"positive",changeClass:"change-positive",progress:40}];return(n,l)=>(ui(),Ei("div",A8,[tt("h2",k8,Ht(n.$t("fertility.title")),1),tt("p",I8,Ht(n.$t("fertility.description")),1),(ui(),Ei(Dn,null,ta(t,h=>tt("div",{key:h.name,class:"indicator-card"},[tt("div",P8,[tt("strong",null,Ht(n.$t(`fertility.indicators.${h.name}`)),1),tt("span",{class:Jr(h.changeClass)},Ht(n.$t(`fertility.changes.${h.change}`)),3)]),tt("div",L8,[tt("span",D8,[fr(Ht(n.$t("fertility.baseline"))+": ",1),tt("strong",null,Ht(h.baseline),1)]),tt("span",O8,[fr(Ht(n.$t("fertility.current"))+": ",1),tt("strong",null,Ht(h.current),1)])]),tt("div",R8,[tt("div",{class:"progress",style:uc({width:h.progress+"%"})},null,4)])])),64))]))}}),B8=ka(z8,[["__scopeId","data-v-0f70ca8a"]]),F8={class:"toolbox","aria-label":"Tools"},N8={class:"rail-head"},U8={class:"icon-grid"},V8=["title"],j8=["onClick"],$8={class:"emoji","aria-hidden":"true"},W8={class:"label"},G8=["aria-label"],H8={class:"sheet-head"},q8={class:"sheet-title"},X8={class:"sheet-body"},Z8={key:2,class:"sheet-placeholder"},Y8={class:"muted"},K8=gs({__name:"Toolbox",setup(e){const t=[{id:"biophysical",emoji:"",fallback:"Biophysical Monitoring"},{id:"crop",emoji:"",fallback:"Crop Monitoring"},{id:"degradation",emoji:"",fallback:"Land Degradation"},{id:"drought",emoji:"",fallback:"Drought Monitoring"},{id:"fertility",emoji:"",fallback:"Soil Fertility"},{id:"risk",emoji:"",fallback:"Risk Assessment"}],n=Vi(null),l=b=>b.split(" ")[0],h=b=>b.split(" ").slice(1).join(" ")||"Monitoring",d=b=>n.value=n.value===b?null:b,g=b=>{b.key==="Escape"&&(n.value=null)};return nl(()=>window.addEventListener("keydown",g)),Tg(()=>window.removeEventListener("keydown",g)),(b,r)=>(ui(),Ei("nav",F8,[tt("div",N8,Ht(b.$t("toolbox.title")),1),tt("ul",U8,[(ui(),Ei(Dn,null,ta(t,C=>tt("li",{key:C.id,class:"icon-cell",title:b.$t(`toolbox.tools.${C.id}.name`,C.fallback)},[tt("button",{class:"icon-button",onClick:O=>d(C.id)},[tt("span",$8,Ht(C.emoji),1),tt("span",W8,[tt("strong",null,Ht(l(b.$t(`toolbox.tools.${C.id}.name`,C.fallback))),1),tt("small",null,Ht(h(b.$t(`toolbox.tools.${C.id}.name`,C.fallback))),1)])],8,j8)],8,V8)),64))]),gn(_I,{name:"sheet"},{default:Kr(()=>[n.value?(ui(),Ei("aside",{key:0,class:"sheet",role:"region","aria-label":b.$t(`toolbox.tools.${n.value}.name`)},[tt("header",H8,[tt("h3",q8,Ht(b.$t(`toolbox.tools.${n.value}.name`)),1),tt("button",{class:"sheet-close",onClick:r[0]||(r[0]=C=>n.value=null),"aria-label":"Close"},"")]),tt("div",X8,[n.value==="biophysical"?(ui(),Qr(C8,{key:0})):n.value==="fertility"?(ui(),Qr(B8,{key:1})):(ui(),Ei("div",Z8,[tt("p",Y8,Ht(b.$t(`toolbox.tools.${n.value}.description`,"")),1)]))])],8,G8)):xs("",!0)]),_:1})]))}}),J8=ka(K8,[["__scopeId","data-v-0d39449c"]]),Q8="https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",eW="kou",S0=7,tW=8.2,ec="landcover-source",mp="landcover-raster",iW=gs({__name:"MapboxMap",setup(e){const t=Vi(null),n=UT(),l=gL(),h="pk.eyJ1Ijoib3N1bWFpIiwiYSI6ImNtOThheGt3bDAxMDYyanM1cDVoZG5jaGIifQ.rhfXn8CCj3FZ-OTeH-z-Ag",d="http://127.0.0.1:8000/api/v1",g=location.hostname.includes("github.io");let b=null;const r=it=>Q8,C=[-4.4,11.2],O={country:new Map,watershed:new Map,commune:new Map};function U(){if(!b)return;try{b.setTerrain(null)}catch{}const it=b.getStyle();for(const Qe of(it==null?void 0:it.layers)||[]){const Xe=Qe.id||"";if(Xe.includes("hillshade")||Xe.includes("terrain")||Xe.includes("3d-buildings")||Xe==="building"||Qe.type==="fill-extrusion")try{b.removeLayer(Xe)}catch{}}}function $(){if(b){try{b.getLayer("selected-boundary-casing")&&b.moveLayer("selected-boundary-casing")}catch{}try{b.getLayer("selected-boundary-highlight")&&b.moveLayer("selected-boundary-highlight")}catch{}}}function q(it){if(!b)return;const Qe=it?"visible":"none";try{b.getLayer("selected-boundary-casing")&&b.setLayoutProperty("selected-boundary-casing","visibility",Qe)}catch{}try{b.getLayer("selected-boundary-highlight")&&b.setLayoutProperty("selected-boundary-highlight","visibility",Qe)}catch{}}function ee(it){return(it==null?void 0:it.id)??(it==null?void 0:it.gid)??(it==null?void 0:it.objectid)??(it==null?void 0:it.OBJECTID)??(it==null?void 0:it.GID)}function ie(it){return(it==null?void 0:it.name)??(it==null?void 0:it.Name)??(it==null?void 0:it.NAME)??(it==null?void 0:it.adm_name)??(it==null?void 0:it.ADM_NAME)??(it==null?void 0:it.adm2_name)??(it==null?void 0:it.ADM2_NAME)??""}function de(it,Qe){O[it].clear();for(const Xe of(Qe==null?void 0:Qe.features)??[]){const Tt=ee(Xe.properties),Rt=ie(Xe.properties);Xe.properties={...Xe.properties,id:Tt,name:Rt,layer:it},Tt!=null&&String(Rt).length&&O[it].set(Tt,Xe)}}async function ye(){if(g){const[Qe,Xe,Tt]=await Promise.all([fetch("/projects/soil_values/data/countries.geojson").then(Rt=>Rt.json()),fetch("/projects/soil_values/data/intervention_watersheds.geojson").then(Rt=>Rt.json()),fetch("/projects/soil_values/data/communes.geojson").then(Rt=>Rt.json())]);return{countries:Qe,watersheds:Xe,communes:Tt}}return await(await fetch(`${d}/boundaries/all`,{headers:{Accept:"application/json"}})).json()}function be(it,Qe){const Xe=it==="landcover2020"?`${d}/wms/landcover-2020/{z}/{x}/{y}.png`:`${d}/wms/landcover-2021/{z}/{x}/{y}.png`,Rt=Object.entries(Qe).map(([St,Pt])=>St==="SLD_BODY"?`SLD_BODY=${Pt}`:`${encodeURIComponent(St)}=${encodeURIComponent(Pt)}`).join("&");return Rt?`${Xe}?${Rt}`:Xe}function se(){var Qe;return(Qe=((b==null?void 0:b.getStyle().layers)||[]).find(Xe=>Xe.type==="symbol"))==null?void 0:Qe.id}function he(it,Qe){if(!b)return;const Xe=[be(it,Qe)];if(b.getLayer(mp)){const Tt=b.getSource(ec);if(Tt!=null&&Tt.setTiles)Tt.setTiles(Xe);else{try{b.getLayer(mp)&&b.removeLayer(mp)}catch{}try{b.getSource(ec)&&b.removeSource(ec)}catch{}b.addSource(ec,{type:"raster",tiles:Xe,tileSize:256}),b.addLayer({id:mp,type:"raster",source:ec},se())}}else{try{b.getSource(ec)&&b.removeSource(ec)}catch{}b.addSource(ec,{type:"raster",tiles:Xe,tileSize:256}),b.addLayer({id:mp,type:"raster",source:ec},se())}}function fe(){if(b){try{b.getLayer(mp)&&b.removeLayer(mp)}catch{}try{b.getSource(ec)&&b.removeSource(ec)}catch{}}}function Me(){l.lcVisible&&l.layerName&&he(l.layerName,l.urlParams)}async function ze(){if(!b)return;const{countries:it,watersheds:Qe,communes:Xe}=await ye();de("country",it),de("watershed",Qe),de("commune",Xe),n.setBoundaries({country:{type:"FeatureCollection",features:(it==null?void 0:it.features)??[]},watershed:{type:"FeatureCollection",features:(Qe==null?void 0:Qe.features)??[]},commune:{type:"FeatureCollection",features:(Xe==null?void 0:Xe.features)??[]}});for(const St of["countries-outline","selected-boundary-casing","selected-boundary-highlight"])try{b.getLayer(St)&&b.removeLayer(St)}catch{}for(const St of["countries","selected-boundary"])try{b.getSource(St)&&b.removeSource(St)}catch{}const Tt=((it==null?void 0:it.features)??[]).map(St=>({type:"Feature",geometry:St.geometry,properties:{...St.properties,layer:"country",name:ie(St.properties)}}));b.addSource("countries",{type:"geojson",data:{type:"FeatureCollection",features:Tt}}),b.addLayer({id:"countries-outline",type:"line",source:"countries",paint:{"line-color":"#000","line-width":2},layout:{"line-join":"round","line-cap":"round",visibility:"visible"}}),b.addSource("selected-boundary",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),b.addLayer({id:"selected-boundary-casing",type:"line",source:"selected-boundary",paint:{"line-color":"#ffffff","line-width":6.5,"line-opacity":.95},layout:{"line-join":"round","line-cap":"round",visibility:"none"}}),b.addLayer({id:"selected-boundary-highlight",type:"line",source:"selected-boundary",paint:{"line-color":"#000000","line-width":3,"line-opacity":1},layout:{"line-join":"round","line-cap":"round",visibility:"none"}});let Rt=!1;try{const St=((Qe==null?void 0:Qe.features)??[]).find(Pt=>String(ie(Pt.properties)).toLowerCase().includes(eW));St&&(ve(St),Rt=!0)}catch{}if(!Rt)try{b.jumpTo({center:C,zoom:tW})}catch{}$()}function ve(it){if(!b||!(it!=null&&it.geometry))return;const Qe=new Jm.LngLatBounds;(Tt=>{Tt.type==="Polygon"?Tt.coordinates.forEach(Rt=>Rt.forEach(St=>Qe.extend(St))):Tt.type==="MultiPolygon"&&Tt.coordinates.forEach(Rt=>Rt.forEach(St=>St.forEach(Pt=>Qe.extend(Pt))))})(it.geometry),Qe.isEmpty()||b.fitBounds(Qe,{padding:40,duration:1e3})}eo(()=>n.basemapStyle,it=>{b&&(b.setStyle(r()),b.once("style.load",()=>{U(),ze(),Me(),$(),q((b.getZoom()??0)<S0)}))}),eo(()=>[l.lcVisible,l.layerName,l.filterHash],([it,Qe])=>{if(b){if(!it||!Qe){fe();return}he(Qe,l.urlParams)}}),nl(async()=>{Jm.accessToken=h,b=new Jm.Map({container:t.value,style:r(),center:[2,14],zoom:5,attributionControl:!1,dragRotate:!1,pitchWithRotate:!1,touchPitch:!1}),n.setMap(b),window._map=b,b.once("load",async()=>{b.addControl(new Jm.NavigationControl({showCompass:!1}),"top-right"),b.addControl(new Jm.ScaleControl({maxWidth:120,unit:"metric"})),U(),await ze(),l.layerName||l.setYear("landcover2020"),l.lcVisible||l.setVisible(!0),he("landcover2020",l.urlParams)}),b.on("zoomend",()=>{const it=b.getZoom();q(it<S0)}),b.on("style.load",()=>{U(),Me(),$(),q((b.getZoom()??0)<S0)})}),Tg(()=>{try{b==null||b.remove()}catch{}b=null});function Ue(){if(!b)return;const it=b.getSource("selected-boundary");try{it==null||it.setData({type:"FeatureCollection",features:[]})}catch{}q(!1)}function Ne(it,Qe){if(!b)return;const Xe=O[Qe].get(it);if(!Xe)return;const Tt=b.getSource("selected-boundary");Tt&&(Tt.setData({type:"FeatureCollection",features:[Xe]}),ve(Xe),$(),q((b.getZoom()??0)<S0))}return window.highlightBoundaryById=Ne,window.clearBoundaryHighlight=Ue,(it,Qe)=>(ui(),Ei("div",{ref_key:"mapContainer",ref:t,class:"mapbox-map w-full"},null,512))}}),nW=ka(iW,[["__scopeId","data-v-d8f4ee1f"]]),sW={class:"mc-wrap"},rW={class:"mc-card",role:"region","aria-label":"Map controls"},oW={class:"mc-icons"},aW={class:"mc-col"},lW={class:"mc-field"},cW=["for"],hW={class:"mc-select"},uW=["id","disabled"],dW={disabled:"",value:""},fW=["value"],pW={key:0,class:"spinner","aria-hidden":""},mW={key:0,class:"err","aria-live":"polite"},gW={key:0,class:"mc-field"},_W=["for"],yW={class:"mc-select"},xW=["id","disabled"],vW={disabled:"",value:""},bW=["value"],wW={key:0,class:"spinner","aria-hidden":""},TW={key:1,class:"mc-field"},EW=["for"],SW={class:"mc-select"},MW=["id","disabled"],CW={disabled:"",value:""},AW=["value"],kW={key:0,class:"spinner","aria-hidden":""},IW=gs({__name:"MapControlPanel",props:{showClose:{type:Boolean,default:!1}},emits:["close"],setup(e){const{t}=Rp(),n=UT(),l="http://127.0.0.1:8000/api/v1",h=Vi(null),d=Vi(null),g=Vi(null),b=Vi(!1),r=Vi(!1),C=Vi(!1),O=Vi([]),U=Vi([]),$=Vi([]),q=Vi(""),ee={country:"mc-country",watershed:"mc-watershed",commune:"mc-commune"};function ie(Xe,Tt,Rt){return Xe?((Array.isArray(Xe)?Xe:Xe.features)||[]).map(Pt=>{var oi,ci,pn,Ni,ji;return{...Pt,properties:{...Pt.properties,id:((oi=Pt==null?void 0:Pt.properties)==null?void 0:oi.id)??Pt.id??((ci=Pt==null?void 0:Pt.properties)==null?void 0:ci.gid)??((pn=Pt==null?void 0:Pt.properties)==null?void 0:pn.objectid),name:((Ni=Pt==null?void 0:Pt.properties)==null?void 0:Ni[Tt])??((ji=Pt==null?void 0:Pt.properties)==null?void 0:ji.name),layer:Rt}}}).filter(Pt=>{var oi,ci;return((oi=Pt.properties)==null?void 0:oi.id)&&((ci=Pt.properties)==null?void 0:ci.name)}).sort((Pt,oi)=>String(Pt.properties.name).localeCompare(String(oi.properties.name))):[]}function de(Xe){if(!(Xe!=null&&Xe.coordinates))return[];const Tt=[],Rt=St=>Array.isArray(St==null?void 0:St[0])?St.forEach(Rt):Array.isArray(St)&&St.length>=2?Tt.push(St[0],St[1]):null;return Rt(Xe.coordinates),Tt}function ye(Xe){const Tt=de(Xe==null?void 0:Xe.geometry),Rt=[],St=[];for(let Pt=0;Pt<Tt.length;Pt+=2)Rt.push(Tt[Pt]),St.push(Tt[Pt+1]);return Rt.length?[Math.min(...Rt),Math.min(...St),Math.max(...Rt),Math.max(...St)]:[-180,-90,180,90]}function be(Xe,[Tt,Rt,St,Pt]){const[oi,ci,pn,Ni]=ye(Xe);return!(pn<Tt||oi>St||Ni<Rt||ci>Pt)}function se(Xe){const Tt=window==null?void 0:window._map;if(!Tt||!(Xe!=null&&Xe.geometry))return;const[Rt,St,Pt,oi]=ye(Xe);try{Tt.fitBounds([[Rt,St],[Pt,oi]],{padding:40,duration:650})}catch{}}function he(Xe){var Pt,oi;const Tt=window==null?void 0:window.highlightBoundaryById,Rt=(Pt=Xe==null?void 0:Xe.properties)==null?void 0:Pt.id,St=(oi=Xe==null?void 0:Xe.properties)==null?void 0:oi.layer;if(typeof Tt=="function"&&Rt&&St)try{Tt(Rt,St)}catch{}}function fe(){const Xe=window==null?void 0:window.clearBoundaryHighlight;if(typeof Xe=="function")try{Xe()}catch{}}const Me=Fn(()=>{if(!h.value)return[];const Xe=ye(h.value);return U.value.filter(Tt=>be(Tt,Xe))}),ze=Fn(()=>{if(!d.value)return[];const Xe=ye(d.value);return $.value.filter(Tt=>be(Tt,Xe))});async function ve(){q.value="",b.value=!0;try{const Xe=await fetch(`${l}/boundaries/all`,{headers:{Accept:"application/json"}});if(!Xe.ok)throw new Error(`HTTP ${Xe.status}`);const Tt=await Xe.json().catch(()=>({}));O.value=ie(Tt==null?void 0:Tt.countries,"name","country"),U.value=ie(Tt==null?void 0:Tt.watersheds,"name","watershed"),$.value=ie(Tt==null?void 0:Tt.communes,"name","commune"),window._allBoundaryFeatures=[...O.value,...U.value,...$.value]}catch{q.value=t("errors.fetchBoundaries")||"Could not load boundaries.",O.value=[],U.value=[],$.value=[]}finally{b.value=!1}}function Ue(){var Xe,Tt;r.value=!0,h.value?(he(h.value),se(h.value),(Xe=n==null?void 0:n.setSelectedCountryId)==null||Xe.call(n,h.value.properties.id)):(fe(),(Tt=n==null?void 0:n.setSelectedCountryId)==null||Tt.call(n,null)),d.value=null,g.value=null,setTimeout(()=>r.value=!1,180)}function Ne(){var Xe,Tt;C.value=!0,d.value?(he(d.value),se(d.value),(Xe=n==null?void 0:n.setSelectedWatershedId)==null||Xe.call(n,d.value.properties.id)):(Tt=n==null?void 0:n.setSelectedWatershedId)==null||Tt.call(n,null),g.value=null,setTimeout(()=>C.value=!1,180)}function it(){var Xe,Tt;g.value?(he(g.value),se(g.value),(Xe=n==null?void 0:n.setSelectedCommuneId)==null||Xe.call(n,g.value.properties.id)):(Tt=n==null?void 0:n.setSelectedCommuneId)==null||Tt.call(n,null)}function Qe(){var Xe;h.value=d.value=g.value=null,fe(),(Xe=n==null?void 0:n.resetView)==null||Xe.call(n)}return nl(()=>ve()),eo(()=>h.value,Xe=>{Xe||(d.value=null,g.value=null)}),eo(()=>d.value,Xe=>{Xe||(g.value=null)}),(Xe,Tt)=>(ui(),Ei("div",sW,[tt("aside",rW,[tt("div",oW,[tt("button",{class:"icon-btn",onClick:Qe,title:"Reset map","aria-label":"Reset map"},""),Xe.showClose?(ui(),Ei("button",{key:0,class:"icon-btn",onClick:Tt[0]||(Tt[0]=Rt=>Xe.$emit("close")),title:"Hide controls","aria-label":"Hide controls"},"")):xs("",!0)]),tt("div",aW,[tt("div",lW,[tt("label",{class:"mc-label",for:ee.country},Ht(hs(t)("mapControls.country")||"Country"),9,cW),tt("div",hW,[Mo(tt("select",{id:ee.country,"onUpdate:modelValue":Tt[1]||(Tt[1]=Rt=>h.value=Rt),onChange:Ue,disabled:b.value||!!q.value},[tt("option",dW,Ht(hs(t)("mapControls.select")||"Select"),1),(ui(!0),Ei(Dn,null,ta(O.value,Rt=>(ui(),Ei("option",{key:Rt.properties.id,value:Rt},Ht(Rt.properties.name),9,fW))),128))],40,uW),[[kd,h.value]]),b.value?(ui(),Ei("span",pW,"")):xs("",!0)]),q.value?(ui(),Ei("small",mW,Ht(q.value),1)):xs("",!0)]),Me.value.length?(ui(),Ei("div",gW,[tt("label",{class:"mc-label",for:ee.watershed},Ht(hs(t)("mapControls.watershed")||"Watershed"),9,_W),tt("div",yW,[Mo(tt("select",{id:ee.watershed,"onUpdate:modelValue":Tt[2]||(Tt[2]=Rt=>d.value=Rt),onChange:Ne,disabled:r.value},[tt("option",vW,Ht(hs(t)("mapControls.select")||"Select"),1),(ui(!0),Ei(Dn,null,ta(Me.value,Rt=>(ui(),Ei("option",{key:Rt.properties.id,value:Rt},Ht(Rt.properties.name),9,bW))),128))],40,xW),[[kd,d.value]]),r.value?(ui(),Ei("span",wW,"")):xs("",!0)])])):xs("",!0),ze.value.length?(ui(),Ei("div",TW,[tt("label",{class:"mc-label",for:ee.commune},Ht(hs(t)("mapControls.commune")||"Commune"),9,EW),tt("div",SW,[Mo(tt("select",{id:ee.commune,"onUpdate:modelValue":Tt[3]||(Tt[3]=Rt=>g.value=Rt),onChange:it,disabled:C.value},[tt("option",CW,Ht(hs(t)("mapControls.select")||"Select"),1),(ui(!0),Ei(Dn,null,ta(ze.value,Rt=>(ui(),Ei("option",{key:Rt.properties.id,value:Rt},Ht(Rt.properties.name),9,AW))),128))],40,MW),[[kd,g.value]]),C.value?(ui(),Ei("span",kW,"")):xs("",!0)])])):xs("",!0)])])]))}}),PW=ka(IW,[["__scopeId","data-v-a84e3981"]]),LW={class:"legend",role:"note","aria-label":"Map legend"},DW={class:"legend-list"},OW={class:"label"},RW=gs({__name:"MapLegend",setup(e){const t=[{label:"Water",color:"#0f6ef3"},{label:"Forest",color:"#087200"},{label:"Cropland",color:"#f96de9"},{label:"Grassland",color:"#bb9019"},{label:"Shrubland",color:"#ffeb33"},{label:"Bareland",color:"#a0a0a0"},{label:"Built-up",color:"#ff1601"},{label:"Wetland",color:"#34baef"}];return(n,l)=>(ui(),Ei("aside",LW,[tt("ul",DW,[(ui(),Ei(Dn,null,ta(t,h=>tt("li",{key:h.label},[tt("span",{class:"swatch",style:uc({background:h.color}),"aria-hidden":"true"},null,4),tt("span",OW,Ht(h.label),1)])),64))])]))}}),zW=ka(RW,[["__scopeId","data-v-930c41ee"]]),BW={class:"map-page"},FW={class:"tools-rail"},NW={class:"map-area"},UW=gs({__name:"MapView",setup(e){return(t,n)=>(ui(),Ei("section",BW,[tt("aside",FW,[gn(J8)]),tt("div",NW,[gn(nW),gn(PW),gn(zW)])]))}}),VW=ka(UW,[["__scopeId","data-v-014017d7"]]),jW={class:"p-8 max-w-5xl mx-auto"},$W={class:"text-4xl font-bold text-indigo-800 mb-6"},WW={class:"text-gray-700 leading-relaxed whitespace-pre-line"},GW={__name:"MonitoringView",setup(e){return(t,n)=>(ui(),Ei("div",jW,[tt("h1",$W,Ht(t.$t("monitoring.title")),1),tt("p",WW,Ht(t.$t("monitoring.description")),1)]))}},HW=ka(GW,[["__scopeId","data-v-533c53c9"]]),qW={class:"p-8 max-w-5xl mx-auto"},XW={class:"text-4xl font-bold text-green-800 mb-6"},ZW={class:"text-gray-700 leading-relaxed whitespace-pre-line"},YW={__name:"CatalogView",setup(e){return(t,n)=>(ui(),Ei("div",qW,[tt("h1",XW,Ht(t.$t("catalog.title")),1),tt("p",ZW,Ht(t.$t("catalog.description")),1)]))}},KW=ka(YW,[["__scopeId","data-v-83e12bfa"]]),JW="/projects/soil_values/assets/hand_soil-1gZV898M.jpeg",QW="/projects/soil_values/assets/harvest-man-PU7mKcrC.jpg",eG="/projects/soil_values/assets/update-burkina-oEf6LrKK.jpg",tG="/projects/soil_values/assets/update-women-DMqvfeED.jpg",iG="/projects/soil_values/assets/update-dairy-D07hRLBv.jpg",nG={class:"about-root"},sG={class:"container"},rG={class:"hero about-hero"},oG={class:"hero-overlay"},aG={class:"container section"},lG={class:"prose"},cG={class:"container section"},hG={class:"section-title"},uG={class:"list"},dG={class:"container section partners"},fG={class:"section-title"},pG={class:"muted"},mG={class:"note"},gG={class:"container section"},_G={class:"section-title center"},yG={class:"updates-grid"},xG=["href"],vG=["src","alt"],bG={class:"update-info"},wG={class:"update-date"},TG={class:"update-title"},EG=gs({__name:"AboutView",setup(e){const t=[{id:1,title:"ISFM Training in Burkina Faso: A Collaborative Approach",date:"News | April 2, 2025",image:eG,link:"https://ifdc.org/2025/04/02/isfm-training-in-burkina-faso-a-collaborative-approach-to-soil-fertility-and-land-restoration/"},{id:2,title:"Celebrating Women in Sustainable Agriculture",date:"Event Recap | March 26, 2025",image:tG,link:"https://ifdc.org/2025/03/26/celebrating-women-at-the-heart-of-sustainable-agriculture/"},{id:3,title:"Improving Nigerias Dairy Sector and Empowering Pastoralist Communities",date:"News | May 1, 2025",image:iG,link:"https://ifdc.org/2025/05/01/improving-nigerias-dairy-sector-and-empowering-pastoralist-communities/"}];return(n,l)=>(ui(),Ei("div",nG,[tt("section",sG,[tt("figure",rG,[l[0]||(l[0]=tt("img",{src:JW,alt:"Hands holding soil, representing sustainable land management",class:"hero-img",loading:"eager",fetchpriority:"high"},null,-1)),tt("figcaption",oG,[tt("h1",null,Ht(n.$t("about.hero.title")),1),tt("p",null,Ht(n.$t("about.hero.subtitle")),1)])])]),tt("section",aG,[tt("div",lG,[tt("p",null,[tt("strong",null,Ht(n.$t("about.description.program")),1),fr(" "+Ht(n.$t("about.description.intro")),1)]),tt("p",null,Ht(n.$t("about.description.impact")),1),tt("p",null,Ht(n.$t("about.description.approach")),1)])]),l[2]||(l[2]=tt("section",{class:"container section"},[tt("figure",{class:"mid-figure"},[tt("img",{src:QW,alt:"Harvesting legumes in the field",class:"mid-img",loading:"lazy"})])],-1)),tt("section",cG,[tt("h2",hG,Ht(n.$t("about.outcomes.title")),1),tt("ul",uG,[tt("li",null,Ht(n.$t("about.outcomes.item1")),1),tt("li",null,Ht(n.$t("about.outcomes.item2")),1),tt("li",null,Ht(n.$t("about.outcomes.item3")),1),tt("li",null,Ht(n.$t("about.outcomes.item4")),1)])]),tt("section",dG,[tt("h2",fG,Ht(n.$t("about.partners.title")),1),tt("p",pG,Ht(n.$t("about.partners.description1")),1),tt("p",mG,Ht(n.$t("about.partners.note")),1),l[1]||(l[1]=K0('<div class="partner-logos" data-v-933739ec><div class="logo-row" data-v-933739ec><a href="https://www.government.nl/ministries/ministry-of-foreign-affairs" target="_blank" rel="noopener" data-v-933739ec><img src="'+ET+'" alt="DGIS" class="logo logo-lg" loading="lazy" data-v-933739ec></a></div><div class="logo-row" data-v-933739ec><a href="https://ifdc.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+sL+'" alt="IFDC" class="logo logo-md" loading="lazy" data-v-933739ec></a><a href="https://snv.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+oL+'" alt="SNV" class="logo logo-md" loading="lazy" data-v-933739ec></a><a href="https://wur.nl" target="_blank" rel="noopener" data-v-933739ec><img src="'+rL+'" alt="WUR" class="logo logo-md" loading="lazy" data-v-933739ec></a></div><div class="logo-row" data-v-933739ec><a href="https://agra.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+aL+'" alt="AGRA" class="logo" loading="lazy" data-v-933739ec></a><a href="https://www.iita.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+lL+'" alt="IITA" class="logo" loading="lazy" data-v-933739ec></a><a href="https://www.iwmi.cgiar.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+cL+'" alt="IWMI" class="logo" loading="lazy" data-v-933739ec></a><a href="https://www.isric.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+hL+'" alt="ISRIC" class="logo" loading="lazy" data-v-933739ec></a><a href="https://www.cifor-icraf.org" target="_blank" rel="noopener" data-v-933739ec><img src="'+uL+'" alt="CIFOR-ICRAF" class="logo" loading="lazy" data-v-933739ec></a></div></div>',1))]),tt("section",gG,[tt("h2",_G,Ht(n.$t("about.updates.title")),1),tt("div",yG,[(ui(),Ei(Dn,null,ta(t,h=>tt("a",{key:h.id,href:h.link,target:"_blank",rel:"noopener",class:"update-card"},[tt("img",{src:h.image,alt:h.title,class:"update-img",loading:"lazy"},null,8,vG),tt("div",bG,[tt("p",wG,Ht(h.date),1),tt("h3",TG,Ht(h.title),1)])],8,xG)),64))])])]))}}),SG=ka(EG,[["__scopeId","data-v-933739ec"]]),MG={class:"login-page"},CG={class:"hero",role:"img","aria-label":"Farmer in field"},AG={class:"hero-overlay"},kG={class:"hero-title"},IG={class:"hero-subtitle"},PG={class:"form-section"},LG={class:"form-card",role:"form","aria-labelledby":"form-title"},DG={id:"form-title",class:"form-title"},OG=["for"],RG=["id","placeholder"],zG={class:"pw-wrap"},BG=["for"],FG=["id","type","placeholder"],NG=["aria-pressed"],UG=["disabled"],VG={key:0,class:"error",role:"alert"},jG=gs({__name:"LoginView",setup(e){const{t}=Rp(),n=YI(),l=KI(),h=Wy(),d=Vi(""),g=Vi(""),b=Vi(!1),r=Vi(!1),C=Vi(""),O={email:"login-email",password:"login-password"};async function U(){if(r.value)return;if(r.value=!0,C.value="",await h.login(d.value,g.value)){const q=l.query.redirect&&decodeURIComponent(String(l.query.redirect))||nq(n);n.push(q)}else C.value=t("login.invalidCredentials")||"Invalid email or password";r.value=!1}return($,q)=>(ui(),Ei("div",MG,[tt("section",CG,[tt("div",AG,[tt("h1",kG,Ht(hs(t)("login.title")||"Login"),1),tt("p",IG,Ht(hs(t)("login.subtitle")||"Access your account to manage and upload data"),1)])]),tt("section",PG,[tt("div",LG,[tt("h2",DG,Ht(hs(t)("login.formTitle")||"Sign In"),1),tt("form",{onSubmit:xy(U,["prevent"]),class:"login-form",novalidate:""},[tt("label",{class:"sr-only",for:O.email},Ht(hs(t)("login.email")||"Email"),9,OG),Mo(tt("input",{id:O.email,"onUpdate:modelValue":q[0]||(q[0]=ee=>d.value=ee),type:"email",placeholder:hs(t)("login.email")||"Email",inputmode:"email",autocomplete:"username",required:"",class:"form-input"},null,8,RG),[[tc,d.value,void 0,{trim:!0}]]),tt("div",zG,[tt("label",{class:"sr-only",for:O.password},Ht(hs(t)("login.password")||"Password"),9,BG),Mo(tt("input",{id:O.password,"onUpdate:modelValue":q[1]||(q[1]=ee=>g.value=ee),type:b.value?"text":"password",placeholder:hs(t)("login.password")||"Password",autocomplete:"current-password",required:"",class:"form-input"},null,8,FG),[[TT,g.value]]),tt("button",{type:"button",class:"pw-toggle","aria-pressed":b.value?"true":"false",onClick:q[2]||(q[2]=ee=>b.value=!b.value)},Ht(b.value?hs(t)("login.hide")||"Hide":hs(t)("login.show")||"Show"),9,NG)]),tt("button",{type:"submit",disabled:r.value,class:"form-button"},Ht(r.value?hs(t)("login.loggingIn")||"Logging in...":hs(t)("login.loginButton")||"Login"),9,UG)],32),C.value?(ui(),Ei("p",VG,Ht(C.value),1)):xs("",!0)])])]))}}),$G=ka(jG,[["__scopeId","data-v-47264c5c"]]),WG={class:"admin-panel"},GG={class:"page-title"},HG={class:"tabs",role:"tablist","aria-label":"Admin sections"},qG=["aria-selected"],XG=["aria-selected"],ZG=["aria-selected"],YG=["aria-selected"],KG={key:0,class:"tab-content",role:"tabpanel","aria-labelledby":"upload"},JG={class:"section-title"},QG=["placeholder"],eH=["placeholder"],tH=["placeholder"],iH=["placeholder"],nH={class:"file-row"},sH={class:"file-col"},rH={class:"label"},oH={class:"file-col"},aH={class:"label"},lH={key:0,class:"progress-container","aria-live":"polite"},cH=["disabled"],hH={key:1,class:"upload-result"},uH={key:0,class:"success",style:{"margin-top":"8px"}},dH={key:1,class:"info",style:{"margin-top":"8px"}},fH={class:"layers-manage"},pH={class:"manage-header"},mH=["disabled"],gH={class:"lists-grid"},_H={class:"list-card"},yH={key:0},xH={key:0},vH={class:"mono"},bH={class:"actions"},wH=["onClick"],TH=["onClick"],EH={key:1,class:"muted"},SH={class:"list-card"},MH={key:0},CH={key:0},AH={class:"mono"},kH={class:"actions"},IH=["onClick"],PH={key:1,class:"muted"},LH={key:0,class:"error",style:{"margin-top":"8px"}},DH={key:1,class:"tab-content",role:"tabpanel","aria-labelledby":"createUser"},OH={class:"section-title"},RH=["placeholder"],zH=["placeholder"],BH={disabled:"",value:""},FH={value:"admin"},NH={value:"partner"},UH={value:"analyst"},VH={value:"public"},jH={type:"submit"},$H={key:2,class:"tab-content",role:"tabpanel","aria-labelledby":"generateSynthetic"},WH={class:"section-title"},GH={class:"muted"},HH=["disabled"],qH={key:1,class:"count-list"},XH={class:"mono"},ZH={key:2,class:"output"},YH={class:"term"},KH={key:3,class:"tab-content",role:"tabpanel","aria-labelledby":"manageData"},JH={class:"section-title"},QH={class:"muted"},eq=gs({__name:"AdminPanel",setup(e){const{t}=Rp(),n=Wy(),l=Vi("upload"),h=Vi(""),d=Vi(""),g=Vi(""),b=Vi(""),r=Vi(null),C=Vi(null),O=Vi(""),U=Vi(!1),$=Vi(!1),q=Vi(0),ee=Vi(null),ie=Vi(!1),de=Vi(!1),ye=Vi(""),be=Vi([]),se=Vi([]),he=Vi(""),fe=Vi(""),Me=Vi(""),ze=Vi(""),ve=Vi(!1),Ue=Vi(!1),Ne=Vi(""),it=Vi(!1),Qe=Vi({}),Xe=Vi(""),Tt="http://127.0.0.1:8000/api/v1";function Rt(){return{Authorization:`Bearer ${n.token}`}}const St=nt=>{var xt;const Mt=nt.target;(xt=Mt.files)!=null&&xt.length&&(r.value=Mt.files[0])},Pt=nt=>{var xt;const Mt=nt.target;(xt=Mt.files)!=null&&xt.length&&(C.value=Mt.files[0])},oi=async()=>{var nt,Mt,xt;de.value=!0,ye.value="";try{const{data:jt}=await bs.get(`${Tt}/raster/layers`);be.value=(((nt=jt==null?void 0:jt.layers)==null?void 0:nt.layer)||[]).map(ki=>ki.name),se.value=(jt==null?void 0:jt.orphans)||[]}catch(jt){ye.value=((xt=(Mt=jt==null?void 0:jt.response)==null?void 0:Mt.data)==null?void 0:xt.detail)||(jt==null?void 0:jt.message)||"Failed to load layers"}finally{de.value=!1}};async function ci(nt){var Mt,xt,jt,ki;if(confirm(t("admin.confirmDeleteLayer")||`Delete layer "${nt}" and its store?`))try{await bs.delete(`${Tt}/raster/layers/${encodeURIComponent(nt)}?recurse=true`,{headers:Rt()});const ai=window._map,Ee=`wms-${nt}`,Ce=`wms-layer-${nt}`;(Mt=ai==null?void 0:ai.getLayer)!=null&&Mt.call(ai,Ce)&&ai.removeLayer(Ce),(xt=ai==null?void 0:ai.getSource)!=null&&xt.call(ai,Ee)&&ai.removeSource(Ee),window.dispatchEvent(new CustomEvent("rasterDeleted",{detail:{layerName:nt}})),await oi()}catch(ai){alert(((ki=(jt=ai==null?void 0:ai.response)==null?void 0:jt.data)==null?void 0:ki.detail)||(ai==null?void 0:ai.message)||"Delete failed")}}async function pn(nt){var Mt,xt;if(confirm(t("admin.confirmDeleteStore")||`Delete orphan store "${nt}"?`))try{await bs.delete(`${Tt}/raster/coverage-stores/${encodeURIComponent(nt)}?recurse=true`,{headers:Rt()}),await oi()}catch(jt){alert(((xt=(Mt=jt==null?void 0:jt.response)==null?void 0:Mt.data)==null?void 0:xt.detail)||(jt==null?void 0:jt.message)||"Delete failed")}}function Ni(){var xt,jt;const nt=window._map;return(jt=(((xt=nt==null?void 0:nt.getStyle)==null?void 0:xt.call(nt).layers)||[]).find(ki=>ki.type==="symbol"))==null?void 0:jt.id}function ji(nt){const Mt=window._map;if(!Mt)return;const xt=`wms-${nt}`,jt=`wms-layer-${nt}`,ki=`${Tt}/proxy_geoserver/wms/soil_values/${encodeURIComponent(nt)}/{z}/{x}/{y}.png`;Mt.getLayer(jt)&&Mt.removeLayer(jt),Mt.getSource(xt)&&Mt.removeSource(xt),Mt.addSource(xt,{type:"raster",tiles:[ki],tileSize:256});const ai=Ni();ai?Mt.addLayer({id:jt,type:"raster",source:xt,paint:{"raster-opacity":.9}},ai):Mt.addLayer({id:jt,type:"raster",source:xt,paint:{"raster-opacity":.9}})}function An(nt,Mt){const xt=window._map||null,jt=`${Tt}/proxy_geoserver/wms/soil_values/${encodeURIComponent(nt)}/{z}/{x}/{y}.png`;if(!xt){window.dispatchEvent(new CustomEvent("rasterUploaded",{detail:{layerName:nt,wmsTemplateUrl:jt}})),ie.value=!1;return}const ki=`wms-${nt}`,ai=`wms-layer-${nt}`;xt.getLayer(ai)&&xt.removeLayer(ai),xt.getSource(ki)&&xt.removeSource(ki),xt.addSource(ki,{type:"raster",tiles:[jt],tileSize:256});const Ee=Ni();Ee?xt.addLayer({id:ai,type:"raster",source:ki,paint:{"raster-opacity":.9}},Ee):xt.addLayer({id:ai,type:"raster",source:ki,paint:{"raster-opacity":.9}}),ie.value=!0}const Hi=async()=>{var Mt,xt;if(!r.value)return;const nt=new FormData;nt.append("file",r.value),nt.append("name",h.value),d.value&&nt.append("category",d.value),g.value&&nt.append("year",g.value),b.value&&nt.append("description",b.value),C.value&&nt.append("sld",C.value),$.value=!0,q.value=0,O.value="",ee.value=null,ie.value=!1;try{const ki=(await bs.post(`${Tt}/raster/upload`,nt,{headers:{"Content-Type":"multipart/form-data",...Rt()},onUploadProgress:ai=>{ai.total&&(q.value=Math.round(ai.loaded/ai.total*100))}})).data;ee.value=ki,O.value=`${t("admin.rasterUploaded")||"Raster uploaded"}: ${ki.layer_name}`,U.value=!0,h.value="",d.value="",g.value="",b.value="",r.value=null,C.value=null,await oi(),ki!=null&&ki.layer_name&&An(ki.layer_name,ki.wms_url_template)}catch(jt){O.value=((xt=(Mt=jt==null?void 0:jt.response)==null?void 0:Mt.data)==null?void 0:xt.detail)||"Upload failed",U.value=!1}finally{$.value=!1}},Zn=async()=>{var nt,Mt;try{const xt=await bs.post(`${Tt}/admin/create-user`,{email:he.value,password:fe.value,role:Me.value},{headers:Rt()});ze.value=xt.data.message,ve.value=!0,he.value="",fe.value="",Me.value=""}catch(xt){ze.value=((Mt=(nt=xt==null?void 0:xt.response)==null?void 0:nt.data)==null?void 0:Mt.detail)||"Error creating user",ve.value=!1}},wn=async()=>{var nt,Mt;Ue.value=!0,Ne.value="",Xe.value="",Qe.value={};try{const xt=await bs.post(`${Tt}/admin/synthetic/generate`,{},{headers:Rt()});Ne.value=xt.data.message,it.value=!0,Qe.value=xt.data.counts||{},Xe.value=xt.data.output||""}catch(xt){Ne.value=((Mt=(nt=xt==null?void 0:xt.response)==null?void 0:nt.data)==null?void 0:Mt.detail)||"Error generating synthetic data",it.value=!1}finally{Ue.value=!1}};return nl(oi),(nt,Mt)=>(ui(),Ei("div",WG,[tt("h2",GG,Ht(nt.$t("admin.panelTitle")),1),tt("div",HG,[tt("button",{role:"tab","aria-selected":l.value==="upload",class:Jr({active:l.value==="upload"}),onClick:Mt[0]||(Mt[0]=xt=>l.value="upload")},Ht(nt.$t("admin.uploadRaster")),11,qG),tt("button",{role:"tab","aria-selected":l.value==="createUser",class:Jr({active:l.value==="createUser"}),onClick:Mt[1]||(Mt[1]=xt=>l.value="createUser")},Ht(nt.$t("admin.createUser")),11,XG),tt("button",{role:"tab","aria-selected":l.value==="generateSynthetic",class:Jr({active:l.value==="generateSynthetic"}),onClick:Mt[2]||(Mt[2]=xt=>l.value="generateSynthetic")},Ht(nt.$t("admin.generateSyntheticData")),11,ZG),tt("button",{role:"tab","aria-selected":l.value==="manageData",class:Jr({active:l.value==="manageData"}),onClick:Mt[3]||(Mt[3]=xt=>l.value="manageData")},Ht(nt.$t("admin.manageData")),11,YG)]),l.value==="upload"?(ui(),Ei("section",KG,[tt("h3",JG,Ht(nt.$t("admin.uploadRasterLayer")),1),tt("form",{onSubmit:xy(Hi,["prevent"]),class:"form-grid"},[Mo(tt("input",{"onUpdate:modelValue":Mt[4]||(Mt[4]=xt=>h.value=xt),placeholder:nt.$t("admin.layerName"),required:""},null,8,QG),[[tc,h.value]]),Mo(tt("input",{"onUpdate:modelValue":Mt[5]||(Mt[5]=xt=>d.value=xt),placeholder:nt.$t("admin.category")},null,8,eH),[[tc,d.value]]),Mo(tt("input",{"onUpdate:modelValue":Mt[6]||(Mt[6]=xt=>g.value=xt),placeholder:nt.$t("admin.year")},null,8,tH),[[tc,g.value]]),Mo(tt("textarea",{"onUpdate:modelValue":Mt[7]||(Mt[7]=xt=>b.value=xt),placeholder:nt.$t("admin.description")},null,8,iH),[[tc,b.value]]),tt("div",nH,[tt("label",sH,[tt("span",rH,Ht(nt.$t("admin.geotiff")||"GeoTIFF (.tif/.tiff)"),1),tt("input",{type:"file",onChange:St,accept:".tif,.tiff",required:""},null,32)]),tt("label",oH,[tt("span",aH,Ht(nt.$t("admin.sldOptional")||"SLD (optional)"),1),tt("input",{type:"file",onChange:Pt,accept:".sld"},null,32)])]),$.value?(ui(),Ei("div",lH,[tt("div",{class:"progress-bar",style:uc({width:q.value+"%"})},null,4)])):xs("",!0),tt("button",{type:"submit",disabled:$.value},Ht($.value?nt.$t("admin.uploading"):nt.$t("admin.upload")),9,cH)],32),O.value?(ui(),Ei("p",{key:0,class:Jr({success:U.value,error:!U.value})},Ht(O.value),3)):xs("",!0),ee.value?(ui(),Ei("div",hH,[tt("div",null,[Mt[11]||(Mt[11]=tt("strong",null,"Layer:",-1)),fr(" "+Ht(ee.value.layer_name),1)]),tt("div",null,[Mt[12]||(Mt[12]=tt("strong",null,"WMS:",-1)),fr(" "+Ht(ee.value.wms_url_template),1)]),ie.value?(ui(),Ei("div",uH,Ht(nt.$t("admin.mapLayerAdded")||"Layer added to map."),1)):(ui(),Ei("div",dH,Ht(nt.$t("admin.mapNotAvailable")||'Map instance not found. Dispatched "rasterUploaded" event.'),1))])):xs("",!0),tt("div",fH,[tt("div",pH,[tt("h3",null,Ht(nt.$t("admin.manageLayers")||"Manage Raster Layers"),1),tt("button",{class:"refresh",onClick:oi,disabled:de.value},Ht(de.value?nt.$t("admin.loading")||"Loading":nt.$t("admin.refresh")||"Refresh"),9,mH)]),tt("div",gH,[tt("div",_H,[tt("h4",null,Ht(nt.$t("admin.publishedLayers")),1),de.value?(ui(),Ei("div",yH,Ht(nt.$t("admin.loading")||"Loading"),1)):(ui(),Ei(Dn,{key:1},[be.value.length?(ui(),Ei("ul",xH,[(ui(!0),Ei(Dn,null,ta(be.value,xt=>(ui(),Ei("li",{key:xt,class:"row"},[tt("span",vH,Ht(xt),1),tt("div",bH,[tt("button",{class:"btn tiny",onClick:jt=>ji(xt)},Ht(nt.$t("admin.preview")||"Preview"),9,wH),tt("button",{class:"btn danger tiny",onClick:jt=>ci(xt)},Ht(nt.$t("admin.delete")||"Delete"),9,TH)])]))),128))])):(ui(),Ei("p",EH,Ht(nt.$t("admin.noPublished")||"No published layers."),1))],64))]),tt("div",SH,[tt("h4",null,Ht(nt.$t("admin.orphanStores")||"Orphan Coverage Stores"),1),de.value?(ui(),Ei("div",MH,Ht(nt.$t("admin.loading")||"Loading"),1)):(ui(),Ei(Dn,{key:1},[se.value.length?(ui(),Ei("ul",CH,[(ui(!0),Ei(Dn,null,ta(se.value,xt=>(ui(),Ei("li",{key:xt,class:"row"},[tt("span",AH,Ht(xt),1),tt("div",kH,[tt("button",{class:"btn danger tiny",onClick:jt=>pn(xt)},Ht(nt.$t("admin.deleteStore")||"Delete store"),9,IH)])]))),128))])):(ui(),Ei("p",PH," "+Ht(nt.$t("admin.noOrphans")||"No orphan stores"),1))],64))])]),ye.value?(ui(),Ei("p",LH,Ht(ye.value),1)):xs("",!0)])])):xs("",!0),l.value==="createUser"?(ui(),Ei("section",DH,[tt("h3",OH,Ht(nt.$t("admin.createNewUser")),1),tt("form",{onSubmit:xy(Zn,["prevent"]),class:"form-grid"},[Mo(tt("input",{"onUpdate:modelValue":Mt[8]||(Mt[8]=xt=>he.value=xt),type:"email",placeholder:nt.$t("admin.email"),required:""},null,8,RH),[[tc,he.value]]),Mo(tt("input",{"onUpdate:modelValue":Mt[9]||(Mt[9]=xt=>fe.value=xt),type:"password",placeholder:nt.$t("admin.password"),required:""},null,8,zH),[[tc,fe.value]]),Mo(tt("select",{"onUpdate:modelValue":Mt[10]||(Mt[10]=xt=>Me.value=xt),required:""},[tt("option",BH,Ht(nt.$t("admin.selectRole")),1),tt("option",FH,Ht(nt.$t("admin.adminRole")),1),tt("option",NH,Ht(nt.$t("admin.partnerRole")),1),tt("option",UH,Ht(nt.$t("admin.analystRole")),1),tt("option",VH,Ht(nt.$t("admin.publicRole")),1)],512),[[kd,Me.value]]),tt("button",jH,Ht(nt.$t("admin.createUser")),1)],32),ze.value?(ui(),Ei("p",{key:0,class:Jr({success:ve.value,error:!ve.value})},Ht(ze.value),3)):xs("",!0)])):xs("",!0),l.value==="generateSynthetic"?(ui(),Ei("section",$H,[tt("h3",WH,Ht(nt.$t("admin.generateSyntheticTitle")),1),tt("p",GH,Ht(nt.$t("admin.generateSyntheticDescription")),1),tt("button",{onClick:wn,disabled:Ue.value},Ht(Ue.value?nt.$t("admin.generating"):nt.$t("admin.generateNow")),9,HH),Ne.value?(ui(),Ei("p",{key:0,class:Jr({success:it.value,error:!it.value})},Ht(Ne.value),3)):xs("",!0),Qe.value&&Object.keys(Qe.value).length?(ui(),Ei("div",qH,[tt("h4",null,Ht(nt.$t("admin.insertedRowCounts")),1),tt("ul",null,[(ui(!0),Ei(Dn,null,ta(Qe.value,(xt,jt)=>(ui(),Ei("li",{key:jt},[tt("span",XH,Ht(jt),1),fr(": "+Ht(xt),1)]))),128))])])):xs("",!0),Xe.value?(ui(),Ei("div",ZH,[tt("strong",null,Ht(nt.$t("admin.output")),1),tt("pre",YH,Ht(Xe.value),1)])):xs("",!0)])):xs("",!0),l.value==="manageData"?(ui(),Ei("section",KH,[tt("h3",JH,Ht(nt.$t("admin.dataManagementPlaceholderTitle")),1),tt("p",QH,Ht(nt.$t("admin.dataManagementPlaceholderDescription")),1)])):xs("",!0)]))}}),tq=ka(eq,[["__scopeId","data-v-6859ff82"]]),iq=[{path:"/",name:"Home",component:lU},{path:"/map",name:"Map",component:VW,meta:{hideFooter:!0}},{path:"/catalog",name:"Catalog",component:KW},{path:"/about",name:"About",component:SG},{path:"/me-dashboard",name:"M&E Dashboard",component:HW,meta:{requiresAuth:!0,allowedRoles:["admin","partner","analyst"]}},{path:"/dashboard",redirect:"/map"},{path:"/monitoring",redirect:"/me-dashboard"},{path:"/admin-panel",name:"Admin Panel",component:tq,meta:{requiresAuth:!0,allowedRoles:["admin"]}},{path:"/login",name:"Login",component:$G},{path:"/:pathMatch(.*)*",redirect:"/"}],uD=JB({history:CB("/projects/soil_values/"),routes:iq});uD.beforeEach((e,t,n)=>{if(!l5())return n();const l=Wy(),{token:h,role:d}=m5(l),g=!!h.value;if(e.name==="Login"&&g)return n("/");if(e.meta.requiresAuth&&!g){const b=encodeURIComponent(e.fullPath);return n({path:"/login",query:{redirect:b}})}if(e.meta.allowedRoles&&g&&!(e.meta.allowedRoles.includes(d.value||"")||d.value==="admin"))return n("/");n()});function nq(e){const t=Wy(),n=e.currentRoute.value.query.redirect;return n?decodeURIComponent(n):t.role==="admin"?"/admin-panel":"/"}var dD={exports:{}},Z1={exports:{}},CA;function sq(){return CA||(CA=1,function(e,t){(function(n,l){n._Highcharts=l(),e.exports=n._Highcharts})(typeof window>"u"?dL:window,()=>(()=>{var __;let n,l;var h,d,g,b,r,C,O,U,$,q,ee,ie,de,ye,be,se,he,fe,Me={};Me.d=(F,c)=>{for(var m in c)Me.o(c,m)&&!Me.o(F,m)&&Object.defineProperty(F,m,{enumerable:!0,get:c[m]})},Me.o=(F,c)=>Object.prototype.hasOwnProperty.call(F,c);var ze={};Me.d(ze,{default:()=>zx}),function(F){var c,m,y,T,E,k,I;F.SVG_NS="http://www.w3.org/2000/svg",F.product="Highcharts",F.version="12.2.0",F.win=typeof window<"u"?window:{},F.doc=F.win.document,F.svg=!!((y=(m=(c=F.doc)==null?void 0:c.createElementNS)==null?void 0:m.call(c,F.SVG_NS,"svg"))!=null&&y.createSVGRect),F.pageLang=(k=(E=(T=F.doc)==null?void 0:T.documentElement)==null?void 0:E.closest("[lang]"))==null?void 0:k.lang,F.userAgent=((I=F.win.navigator)==null?void 0:I.userAgent)||"",F.isChrome=F.win.chrome,F.isFirefox=F.userAgent.indexOf("Firefox")!==-1,F.isMS=/(edge|msie|trident)/i.test(F.userAgent)&&!F.win.opera,F.isSafari=!F.isChrome&&F.userAgent.indexOf("Safari")!==-1,F.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(F.userAgent),F.isWebKit=F.userAgent.indexOf("AppleWebKit")!==-1,F.deg2rad=2*Math.PI/360,F.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],F.noop=function(){},F.supportsPassiveEvents=function(){let L=!1;if(!F.isMS){let B=Object.defineProperty({},"passive",{get:function(){L=!0}});F.win.addEventListener&&F.win.removeEventListener&&(F.win.addEventListener("testPassive",F.noop,B),F.win.removeEventListener("testPassive",F.noop,B))}return L}(),F.charts=[],F.composed=[],F.dateFormats={},F.seriesTypes={},F.symbolSizes={},F.chartCount=0}(h||(h={}));let ve=h,{charts:Ue,doc:Ne,win:it}=ve;function Qe(F,c,m,y){let T=c?"Highcharts error":"Highcharts warning";F===32&&(F=`${T}: Deprecated member`);let E=ci(F),k=E?`${T} #${F}: www.highcharts.com/errors/${F}/`:F.toString();if(y!==void 0){let I="";E&&(k+="?"),xt(y,function(L,B){I+=`
 - ${B}: ${L}`,E&&(k+=encodeURI(B)+"="+encodeURI(L))}),k+=I}ki(ve,"displayError",{chart:m,code:F,message:k,params:y},function(){if(c)throw Error(k);it.console&&Qe.messages.indexOf(k)===-1&&console.warn(k)}),Qe.messages.push(k)}function Xe(F,c){return parseInt(F,c||10)}function Tt(F){return typeof F=="string"}function Rt(F){let c=Object.prototype.toString.call(F);return c==="[object Array]"||c==="[object Array Iterator]"}function St(F,c){return!!F&&typeof F=="object"&&(!c||!Rt(F))}function Pt(F){return St(F)&&typeof F.nodeType=="number"}function oi(F){let c=F==null?void 0:F.constructor;return!!(St(F,!0)&&!Pt(F)&&(c!=null&&c.name)&&c.name!=="Object")}function ci(F){return typeof F=="number"&&!isNaN(F)&&F<1/0&&F>-1/0}function pn(F){return F!=null}function Ni(F,c,m){let y,T=Tt(c)&&!pn(m),E=(k,I)=>{pn(k)?F.setAttribute(I,k):T?(y=F.getAttribute(I))||I!=="class"||(y=F.getAttribute(I+"Name")):F.removeAttribute(I)};return Tt(c)?E(m,c):xt(c,E),y}function ji(F){return Rt(F)?F:[F]}function An(F,c){let m;for(m in F||(F={}),c)F[m]=c[m];return F}function Hi(){let F=arguments,c=F.length;for(let m=0;m<c;m++){let y=F[m];if(y!=null)return y}}function Zn(F,c){An(F.style,c)}function wn(F){return Math.pow(10,Math.floor(Math.log(F)/Math.LN10))}function nt(F,c){return F>1e14?F:parseFloat(F.toPrecision(c||14))}(Qe||(Qe={})).messages=[],Math.easeInOutSine=function(F){return-.5*(Math.cos(Math.PI*F)-1)};let Mt=Array.prototype.find?function(F,c){return F.find(c)}:function(F,c){let m,y=F.length;for(m=0;m<y;m++)if(c(F[m],m))return F[m]};function xt(F,c,m){for(let y in F)Object.hasOwnProperty.call(F,y)&&c.call(m||F[y],F[y],y,F)}function jt(F,c,m){function y(k,I){let L=F.removeEventListener;L&&L.call(F,k,I,!1)}function T(k){let I,L;F.nodeName&&(c?(I={})[c]=!0:I=k,xt(I,function(B,W){if(k[W])for(L=k[W].length;L--;)y(W,k[W][L].fn)}))}let E=typeof F=="function"&&F.prototype||F;if(Object.hasOwnProperty.call(E,"hcEvents")){let k=E.hcEvents;if(c){let I=k[c]||[];m?(k[c]=I.filter(function(L){return m!==L.fn}),y(c,m)):(T(k),k[c]=[])}else T(k),delete E.hcEvents}}function ki(F,c,m,y){if(m=m||{},(Ne==null?void 0:Ne.createEvent)&&(F.dispatchEvent||F.fireEvent&&F!==ve)){let T=Ne.createEvent("Events");T.initEvent(c,!0,!0),m=An(T,m),F.dispatchEvent?F.dispatchEvent(m):F.fireEvent(c,m)}else if(F.hcEvents){m.target||An(m,{preventDefault:function(){m.defaultPrevented=!0},target:F,type:c});let T=[],E=F,k=!1;for(;E.hcEvents;)Object.hasOwnProperty.call(E,"hcEvents")&&E.hcEvents[c]&&(T.length&&(k=!0),T.unshift.apply(T,E.hcEvents[c])),E=Object.getPrototypeOf(E);k&&T.sort((I,L)=>I.order-L.order),T.forEach(I=>{I.fn.call(F,m)===!1&&m.preventDefault()})}y&&!m.defaultPrevented&&y.call(F,m)}let ai=function(){let F=Math.random().toString(36).substring(2,9)+"-",c=0;return function(){return"highcharts-"+(n?"":F)+c++}}();it.jQuery&&(it.jQuery.fn.highcharts=function(){let F=[].slice.call(arguments);if(this[0])return F[0]?(new ve[Tt(F[0])?F.shift():"Chart"](this[0],F[0],F[1]),this):Ue[Ni(this[0],"data-highcharts-chart")]});let Ee={addEvent:function(F,c,m,y={}){let T=typeof F=="function"&&F.prototype||F;Object.hasOwnProperty.call(T,"hcEvents")||(T.hcEvents={});let E=T.hcEvents;ve.Point&&F instanceof ve.Point&&F.series&&F.series.chart&&(F.series.chart.runTrackerClick=!0);let k=F.addEventListener;k&&k.call(F,c,m,!!ve.supportsPassiveEvents&&{passive:y.passive===void 0?c.indexOf("touch")!==-1:y.passive,capture:!1}),E[c]||(E[c]=[]);let I={fn:m,order:typeof y.order=="number"?y.order:1/0};return E[c].push(I),E[c].sort((L,B)=>L.order-B.order),function(){jt(F,c,m)}},arrayMax:function(F){let c=F.length,m=F[0];for(;c--;)F[c]>m&&(m=F[c]);return m},arrayMin:function(F){let c=F.length,m=F[0];for(;c--;)F[c]<m&&(m=F[c]);return m},attr:Ni,clamp:function(F,c,m){return F>c?F<m?F:m:c},clearTimeout:function(F){pn(F)&&clearTimeout(F)},correctFloat:nt,createElement:function(F,c,m,y,T){let E=Ne.createElement(F);return c&&An(E,c),T&&Zn(E,{padding:"0",border:"none",margin:"0"}),m&&Zn(E,m),y&&y.appendChild(E),E},crisp:function(F,c=0,m){let y=c%2/2,T=m?-1:1;return(Math.round(F*T-y)+y)*T},css:Zn,defined:pn,destroyObjectProperties:function(F,c,m){xt(F,function(y,T){y!==c&&(y!=null&&y.destroy)&&y.destroy(),(y!=null&&y.destroy||!m)&&delete F[T]})},diffObjects:function(F,c,m,y){let T={};return function E(k,I,L,B){let W=m?I:k;xt(k,function(N,H){if(!B&&y&&y.indexOf(H)>-1&&I[H]){N=ji(N),L[H]=[];for(let K=0;K<Math.max(N.length,I[H].length);K++)I[H][K]&&(N[K]===void 0?L[H][K]=I[H][K]:(L[H][K]={},E(N[K],I[H][K],L[H][K],B+1)))}else St(N,!0)&&!N.nodeType?(L[H]=Rt(N)?[]:{},E(N,I[H]||{},L[H],B+1),Object.keys(L[H]).length===0&&(H!=="colorAxis"||B!==0)&&delete L[H]):(k[H]!==I[H]||H in k&&!(H in I))&&H!=="__proto__"&&H!=="constructor"&&(L[H]=W[H])})}(F,c,T,0),T},discardElement:function(F){var c;(c=F==null?void 0:F.parentElement)==null||c.removeChild(F)},erase:function(F,c){let m=F.length;for(;m--;)if(F[m]===c){F.splice(m,1);break}},error:Qe,extend:An,extendClass:function(F,c){let m=function(){};return m.prototype=new F,An(m.prototype,c),m},find:Mt,fireEvent:ki,getAlignFactor:(F="")=>({center:.5,right:1,middle:.5,bottom:1})[F]||0,getClosestDistance:function(F,c){let m,y,T,E=!c;return F.forEach(k=>{if(k.length>1)for(T=k.length-1;T>0;T--)(y=k[T]-k[T-1])<0&&!E?(c==null||c(),c=void 0):y&&(m===void 0||y<m)&&(m=y)}),m},getMagnitude:wn,getNestedProperty:function(F,c){let m=F.split(".");for(;m.length&&pn(c);){let y=m.shift();if(y===void 0||y==="__proto__")return;if(y==="this"){let E;return St(c)&&(E=c["@this"]),E??c}let T=c[y.replace(/[\\'"]/g,"")];if(!pn(T)||typeof T=="function"||typeof T.nodeType=="number"||T===it)return;c=T}return c},getStyle:function F(c,m,y){var k;let T;if(m==="width"){let I=Math.min(c.offsetWidth,c.scrollWidth),L=(k=c.getBoundingClientRect)==null?void 0:k.call(c).width;return L<I&&L>=I-1&&(I=Math.floor(L)),Math.max(0,I-(F(c,"padding-left",!0)||0)-(F(c,"padding-right",!0)||0))}if(m==="height")return Math.max(0,Math.min(c.offsetHeight,c.scrollHeight)-(F(c,"padding-top",!0)||0)-(F(c,"padding-bottom",!0)||0));let E=it.getComputedStyle(c,void 0);return E&&(T=E.getPropertyValue(m),Hi(y,m!=="opacity")&&(T=Xe(T))),T},insertItem:function(F,c){let m,y=F.options.index,T=c.length;for(m=F.options.isInternal?T:0;m<T+1;m++)if(!c[m]||ci(y)&&y<Hi(c[m].options.index,c[m]._i)||c[m].options.isInternal){c.splice(m,0,F);break}return m},isArray:Rt,isClass:oi,isDOMElement:Pt,isFunction:function(F){return typeof F=="function"},isNumber:ci,isObject:St,isString:Tt,merge:function(F,...c){let m,y=[F,...c],T={},E=function(I,L){return typeof I!="object"&&(I={}),xt(L,function(B,W){W!=="__proto__"&&W!=="constructor"&&(!St(B,!0)||oi(B)||Pt(B)?I[W]=L[W]:I[W]=E(I[W]||{},B))}),I};F===!0&&(T=y[1],y=Array.prototype.slice.call(y,2));let k=y.length;for(m=0;m<k;m++)T=E(T,y[m]);return T},normalizeTickInterval:function(F,c,m,y,T){let E,k=F;m=Hi(m,wn(F));let I=F/m;for(!c&&(c=T?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],y===!1&&(m===1?c=c.filter(function(L){return L%1==0}):m<=.1&&(c=[1/m]))),E=0;E<c.length&&(k=c[E],(!T||!(k*m>=F))&&(T||!(I<=(c[E]+(c[E+1]||c[E]))/2)));E++);return nt(k*m,-Math.round(Math.log(.001)/Math.LN10))},objectEach:xt,offset:function(F){let c=Ne.documentElement,m=F.parentElement||F.parentNode?F.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:m.top+(it.pageYOffset||c.scrollTop)-(c.clientTop||0),left:m.left+(it.pageXOffset||c.scrollLeft)-(c.clientLeft||0),width:m.width,height:m.height}},pad:function(F,c,m){return Array((c||2)+1-String(F).replace("-","").length).join(m||"0")+F},pick:Hi,pInt:Xe,pushUnique:function(F,c){return 0>F.indexOf(c)&&!!F.push(c)},relativeLength:function(F,c,m){return/%$/.test(F)?c*parseFloat(F)/100+(m||0):parseFloat(F)},removeEvent:jt,replaceNested:function(F,...c){let m,y;do for(y of(m=F,c))F=F.replace(y[0],y[1]);while(F!==m);return F},splat:ji,stableSort:function(F,c){let m,y,T=F.length;for(y=0;y<T;y++)F[y].safeI=y;for(F.sort(function(E,k){return(m=c(E,k))===0?E.safeI-k.safeI:m}),y=0;y<T;y++)delete F[y].safeI},syncTimeout:function(F,c,m){return c>0?setTimeout(F,c,m):(F.call(0,m),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(F){return Tt(F)?F.substring(0,1).toUpperCase()+F.substring(1):String(F)},uniqueKey:ai,useSerialIds:function(F){return n=Hi(F,n)},wrap:function(F,c,m){let y=F[c];F[c]=function(){let T=arguments,E=this;return m.apply(this,[function(){return y.apply(E,arguments.length?arguments:T)}].concat([].slice.call(arguments)))}}},{pageLang:Ce,win:ct}=ve,{defined:Bt,error:Dt,extend:ei,isNumber:di,isObject:Ie,isString:Oe,merge:rt,objectEach:Zt,pad:Yt,splat:ti,timeUnits:mt,ucfirst:zt}=Ee,Ii=ve.isSafari&&ct.Intl&&!ct.Intl.DateTimeFormat.prototype.formatRange,Oi=F=>F.main===void 0,Kn=class{constructor(F,c){this.options={timezone:"UTC"},this.variableTimezone=!1,this.Date=ct.Date,this.update(F),this.lang=c}update(F={}){this.dTLCache={},this.options=F=rt(!0,this.options,F);let{timezoneOffset:c,useUTC:m}=F;this.Date=F.Date||ct.Date||Date;let y=F.timezone;Bt(m)&&(y=m?"UTC":void 0),c&&c%60==0&&(y="Etc/GMT"+(c>0?"+":"")+c/60),this.variableTimezone=y!=="UTC"&&(y==null?void 0:y.indexOf("Etc/GMT"))!==0,this.timezone=y,["months","shortMonths","weekdays","shortWeekdays"].forEach(T=>{let E=/months/i.test(T),k=/short/.test(T),I={timeZone:"UTC"};I[E?"month":"weekday"]=k?"short":"long",this[T]=(E?[0,1,2,3,4,5,6,7,8,9,10,11]:[3,4,5,6,7,8,9]).map(L=>this.dateFormat(I,(E?31:1)*24*36e5*L))})}toParts(F){let[c,m,y,T,E,k,I]=this.dateTimeFormat({weekday:"narrow",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},F,"es").split(/(?:, | |\/|:)/g);return[T,+y-1,m,E,k,I,Math.floor(Number(F)||0)%1e3,"DLMXJVS".indexOf(c)].map(Number)}dateTimeFormat(F,c,m=this.options.locale||Ce){let y=JSON.stringify(F)+m;Oe(F)&&(F=this.str2dtf(F));let T=this.dTLCache[y];if(!T){F.timeZone??(F.timeZone=this.timezone);try{T=new Intl.DateTimeFormat(m,F)}catch(E){/Invalid time zone/i.test(E.message)?(Dt(34),F.timeZone="UTC",T=new Intl.DateTimeFormat(m,F)):Dt(E.message,!1)}}return this.dTLCache[y]=T,(T==null?void 0:T.format(c))||""}str2dtf(F,c={}){let m={L:{fractionalSecondDigits:3},S:{second:"2-digit"},M:{minute:"numeric"},H:{hour:"2-digit"},k:{hour:"numeric"},E:{weekday:"narrow"},a:{weekday:"short"},A:{weekday:"long"},d:{day:"2-digit"},e:{day:"numeric"},b:{month:"short"},B:{month:"long"},m:{month:"2-digit"},o:{month:"numeric"},y:{year:"2-digit"},Y:{year:"numeric"}};return Object.keys(m).forEach(y=>{F.indexOf(y)!==-1&&ei(c,m[y])}),c}makeTime(F,c,m=1,y=0,T,E,k){let I=this.Date.UTC(F,c,m,y,T||0,E||0,k||0);if(this.timezone!=="UTC"){let L=this.getTimezoneOffset(I);if(I+=L,[2,3,8,9,10,11].indexOf(c)!==-1&&(y<5||y>20)){let B=this.getTimezoneOffset(I);L!==B?I+=B-L:L-36e5!==this.getTimezoneOffset(I-36e5)||Ii||(I-=36e5)}}return I}parse(F){if(!Oe(F))return F??void 0;let c=(F=F.replace(/\//g,"-").replace(/(GMT|UTC)/,"")).indexOf("Z")>-1||/([+-][0-9]{2}):?[0-9]{2}$/.test(F),m=/^[0-9]{4}-[0-9]{2}(-[0-9]{2}|)$/.test(F);c||m||(F+="Z");let y=Date.parse(F);if(di(y))return y+(!c||m?this.getTimezoneOffset(y):0)}getTimezoneOffset(F){if(this.timezone!=="UTC"){let[c,m,y,T,E=0]=this.dateTimeFormat({timeZoneName:"shortOffset"},F,"en").split(/(GMT|:)/).map(Number),k=-(36e5*(y+E/60));if(di(k))return k}return 0}dateFormat(F,c,m){let y=this.lang;if(!Bt(c)||isNaN(c))return(y==null?void 0:y.invalidDate)||"";if(Oe(F=F??"%Y-%m-%d %H:%M:%S")){let T,E=/%\[([a-zA-Z]+)\]/g;for(;T=E.exec(F);)F=F.replace(T[0],this.dateTimeFormat(T[1],c,y==null?void 0:y.locale))}if(Oe(F)&&F.indexOf("%")!==-1){let T=this,[E,k,I,L,B,W,N,H]=this.toParts(c),K=(y==null?void 0:y.weekdays)||this.weekdays,te=(y==null?void 0:y.shortWeekdays)||this.shortWeekdays,ce=(y==null?void 0:y.months)||this.months,le=(y==null?void 0:y.shortMonths)||this.shortMonths;Zt(ei({a:te?te[H]:K[H].substr(0,3),A:K[H],d:Yt(I),e:Yt(I,2," "),w:H,v:(y==null?void 0:y.weekFrom)??"",b:le[k],B:ce[k],m:Yt(k+1),o:k+1,y:E.toString().substr(2,2),Y:E,H:Yt(L),k:L,I:Yt(L%12||12),l:L%12||12,M:Yt(B),p:L<12?"AM":"PM",P:L<12?"am":"pm",S:Yt(W),L:Yt(N,3)},ve.dateFormats),function(oe,me){if(Oe(F))for(;F.indexOf("%"+me)!==-1;)F=F.replace("%"+me,typeof oe=="function"?oe.call(T,c):oe)})}else if(Ie(F)){let T=(this.getTimezoneOffset(c)||0)/36e5,E=this.timezone||"Etc/GMT"+(T>=0?"+":"")+T,{prefix:k="",suffix:I=""}=F;F=k+this.dateTimeFormat(ei({timeZone:E},F),c)+I}return m?zt(F):F}resolveDTLFormat(F){return Ie(F,!0)?Ie(F,!0)&&Oi(F)?{main:F}:F:{main:(F=ti(F))[0],from:F[1],to:F[2]}}getDateFormat(F,c,m,y){let T=this.dateFormat("%m-%d %H:%M:%S.%L",c),E="01-01 00:00:00.000",k={millisecond:15,second:12,minute:9,hour:6,day:3},I="millisecond",L=I;for(I in mt){if(F&&F===mt.week&&+this.dateFormat("%w",c)===m&&T.substr(6)===E.substr(6)){I="week";break}if(F&&mt[I]>F){I=L;break}if(k[I]&&T.substr(k[I])!==E.substr(k[I]))break;I!=="week"&&(L=I)}return this.resolveDTLFormat(y[I]).main}},{defined:qn,extend:_s,timeUnits:un}=Ee,vr=class extends Kn{getTimeTicks(F,c,m,y){let T=this,E=[],k={},{count:I=1,unitRange:L}=F,[B,W,N,H,K,te]=T.toParts(c),ce=(c||0)%1e3,le;if(y??(y=1),qn(c)){if(ce=L>=un.second?0:I*Math.floor(ce/I),L>=un.second&&(te=L>=un.minute?0:I*Math.floor(te/I)),L>=un.minute&&(K=L>=un.hour?0:I*Math.floor(K/I)),L>=un.hour&&(H=L>=un.day?0:I*Math.floor(H/I)),L>=un.day&&(N=L>=un.month?1:Math.max(1,I*Math.floor(N/I))),L>=un.month&&(W=L>=un.year?0:I*Math.floor(W/I)),L>=un.year&&(B-=B%I),L===un.week){I&&(c=T.makeTime(B,W,N,H,K,te,ce));let xe=this.dateTimeFormat({timeZone:this.timezone,weekday:"narrow"},c,"es"),et="DLMXJVS".indexOf(xe);N+=-et+y+(et<y?-7:0)}c=T.makeTime(B,W,N,H,K,te,ce),T.variableTimezone&&qn(m)&&(le=m-c>4*un.month||T.getTimezoneOffset(c)!==T.getTimezoneOffset(m));let oe=c,me=1;for(;oe<m;)E.push(oe),L===un.year?oe=T.makeTime(B+me*I,0):L===un.month?oe=T.makeTime(B,W+me*I):le&&(L===un.day||L===un.week)?oe=T.makeTime(B,W,N+me*I*(L===un.day?1:7)):le&&L===un.hour&&I>1?oe=T.makeTime(B,W,N,H+me*I):oe+=L*I,me++;E.push(oe),L<=un.hour&&E.length<1e4&&E.forEach(xe=>{xe%18e5==0&&T.dateFormat("%H%M%S%L",xe)==="000000000"&&(k[xe]="day")})}return E.info=_s(F,{higherRanks:k,totalRange:L*I}),E}},{isTouchDevice:Oo}=ve,{fireEvent:js,merge:or}=Ee,pr={colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{weekFrom:"week from",chartTitle:"Chart title",locale:void 0,loading:"Loading...",months:void 0,seriesName:"Series {add index 1}",shortMonths:void 0,weekdays:void 0,numericSymbols:["k","M","G","T","P","E"],pieSliceName:"Slice",resetZoom:"Reset zoom",yAxisTitle:"Values",resetZoomTitle:"Reset zoom level 1:1"},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,timezone:"UTC",timezoneOffset:0,useUTC:void 0},chart:{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",margin:15,minScale:.67},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:""},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:F=>Math.sqrt(1-Math.pow(F-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%[AebHMSL]",second:"%[AebHMS]",minute:"%[AebHM]",hour:"%[AebHM]",day:"%[AebY]",week:"%v %[AebY]",month:"%[BY]",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,position:{x:0,y:3},shared:!1,snap:Oo?25:10,headerFormat:'<span style="font-size: 0.8em">{ucfirst point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}},fc=new vr(pr.time,pr.lang),Fe={defaultOptions:pr,defaultTime:fc,getOptions:function(){return pr},setOptions:function(F){var c;return js(ve,"setOptions",{options:F}),or(!0,pr,F),F.time&&fc.update(pr.time),F.lang&&"locale"in F.lang&&fc.update({locale:F.lang.locale}),(c=F.lang)!=null&&c.chartTitle&&(pr.title={...pr.title,text:F.lang.chartTitle}),pr}},{win:ue}=ve,{isNumber:pe,isString:Be,merge:qe,pInt:Je,defined:ft}=Ee,ut=(F,c,m)=>`color-mix(in srgb,${F},${c} ${100*m}%)`,st=F=>Be(F)&&!!F&&F!=="none";class ht{static parse(c){return c?new ht(c):ht.None}constructor(c){let m,y,T,E;this.rgba=[NaN,NaN,NaN,NaN],this.input=c;let k=ve.Color;if(k&&k!==ht)return new k(c);if(typeof c=="object"&&c.stops!==void 0)this.stops=c.stops.map(I=>new ht(I[1]));else if(typeof c=="string")for(this.input=c=ht.names[c.toLowerCase()]||c,T=ht.parsers.length;T--&&!y;)(m=(E=ht.parsers[T]).regex.exec(c))&&(y=E.parse(m));y&&(this.rgba=y)}get(c){let m=this.input,y=this.rgba;if(this.output)return this.output;if(typeof m=="object"&&this.stops!==void 0){let T=qe(m);return T.stops=[].slice.call(T.stops),this.stops.forEach((E,k)=>{T.stops[k]=[T.stops[k][0],E.get(c)]}),T}return y&&pe(y[0])?c!=="rgb"&&(c||y[3]!==1)?c==="a"?`${y[3]}`:"rgba("+y.join(",")+")":"rgb("+y[0]+","+y[1]+","+y[2]+")":m}brighten(c){let m=this.rgba;if(this.stops)this.stops.forEach(function(y){y.brighten(c)});else if(pe(c)&&c!==0)if(pe(m[0]))for(let y=0;y<3;y++)m[y]+=Je(255*c),m[y]<0&&(m[y]=0),m[y]>255&&(m[y]=255);else ht.useColorMix&&st(this.input)&&(this.output=ut(this.input,c>0?"white":"black",Math.abs(c)));return this}setOpacity(c){return this.rgba[3]=c,this}tweenTo(c,m){let y=this.rgba,T=c.rgba;if(!pe(y[0])||!pe(T[0]))return ht.useColorMix&&st(this.input)&&st(c.input)&&m<.99?ut(this.input,c.input,m):c.input||"none";let E=T[3]!==1||y[3]!==1,k=(L,B)=>L+(y[B]-L)*(1-m),I=T.slice(0,3).map(k).map(Math.round);return E&&I.push(k(T[3],3)),(E?"rgba(":"rgb(")+I.join(",")+")"}}ht.names={white:"#ffffff",black:"#000000"},ht.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(F){return[Je(F[1]),Je(F[2]),Je(F[3]),parseFloat(F[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(F){return[Je(F[1]),Je(F[2]),Je(F[3]),1]}},{regex:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?$/i,parse:function(F){return[Je(F[1]+F[1],16),Je(F[2]+F[2],16),Je(F[3]+F[3],16),ft(F[4])?Je(F[4]+F[4],16)/255:1]}},{regex:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?$/i,parse:function(F){return[Je(F[1],16),Je(F[2],16),Je(F[3],16),ft(F[4])?Je(F[4],16)/255:1]}}],ht.useColorMix=(__=ue.CSS)==null?void 0:__.supports("color","color-mix(in srgb,red,blue 9%)"),ht.None=new ht("");let{parse:ni}=ht,{win:hi}=ve,{isNumber:Kt,objectEach:qi}=Ee;class zi{constructor(c,m,y){this.pos=NaN,this.options=m,this.elem=c,this.prop=y}dSetter(){let c=this.paths,m=c==null?void 0:c[0],y=c==null?void 0:c[1],T=this.now||0,E=[];if(T!==1&&m&&y)if(m.length===y.length&&T<1)for(let k=0;k<y.length;k++){let I=m[k],L=y[k],B=[];for(let W=0;W<L.length;W++){let N=I[W],H=L[W];Kt(N)&&Kt(H)&&(L[0]!=="A"||W!==4&&W!==5)?B[W]=N+T*(H-N):B[W]=H}E.push(B)}else E=y;else E=this.toD||[];this.elem.attr("d",E,void 0,!0)}update(){let c=this.elem,m=this.prop,y=this.now,T=this.options.step;this[m+"Setter"]?this[m+"Setter"]():c.attr?c.element&&c.attr(m,y,null,!0):c.style[m]=y+this.unit,T&&T.call(c,y,this)}run(c,m,y){let T=this,E=T.options,k=function(B){return!k.stopped&&T.step(B)},I=hi.requestAnimationFrame||function(B){setTimeout(B,13)},L=function(){for(let B=0;B<zi.timers.length;B++)zi.timers[B]()||zi.timers.splice(B--,1);zi.timers.length&&I(L)};c!==m||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=c,this.end=m,this.unit=y,this.now=this.start,this.pos=0,k.elem=this.elem,k.prop=this.prop,k()&&zi.timers.push(k)===1&&I(L)):(delete E.curAnim[this.prop],E.complete&&Object.keys(E.curAnim).length===0&&E.complete.call(this.elem))}step(c){let m,y,T=+new Date,E=this.options,k=this.elem,I=E.complete,L=E.duration,B=E.curAnim;return k.attr&&!k.element?m=!1:c||T>=L+this.startTime?(this.now=this.end,this.pos=1,this.update(),B[this.prop]=!0,y=!0,qi(B,function(W){W!==!0&&(y=!1)}),y&&I&&I.call(k),m=!1):(this.pos=E.easing((T-this.startTime)/L),this.now=this.start+(this.end-this.start)*this.pos,this.update(),m=!0),m}initPath(c,m,y){let T=c.startX,E=c.endX,k=y.slice(),I=c.isArea,L=I?2:1,B=m&&y.length>m.length&&y.hasStackedCliffs,W,N,H,K,te=m==null?void 0:m.slice();if(!te||B)return[k,k];function ce(oe,me){for(;oe.length<N;){let xe=oe[0],et=me[N-oe.length];if(et&&xe[0]==="M"&&(et[0]==="C"?oe[0]=["C",xe[1],xe[2],xe[1],xe[2],xe[1],xe[2]]:oe[0]=["L",xe[1],xe[2]]),oe.unshift(xe),I){let Ge=oe.pop();oe.push(oe[oe.length-1],Ge)}}}function le(oe){for(;oe.length<N;){let me=oe[Math.floor(oe.length/L)-1].slice();if(me[0]==="C"&&(me[1]=me[5],me[2]=me[6]),I){let xe=oe[Math.floor(oe.length/L)].slice();oe.splice(oe.length/2,0,me,xe)}else oe.push(me)}}if(T&&E&&E.length){for(H=0;H<T.length;H++){if(T[H]===E[0]){W=H;break}if(T[0]===E[E.length-T.length+H]){W=H,K=!0;break}if(T[T.length-1]===E[E.length-T.length+H]){W=T.length-H;break}}W===void 0&&(te=[])}return te.length&&Kt(W)&&(N=k.length+W*L,K?(ce(te,k),le(k)):(ce(k,te),le(te))),[te,k]}fillSetter(){zi.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,ni(this.start).tweenTo(ni(this.end),this.pos),void 0,!0)}}zi.timers=[];let{defined:Xi,getStyle:cn,isArray:mn,isNumber:ys,isObject:Cs,merge:mr,objectEach:Ys,pick:na}=Ee;function Ks(F){return Cs(F)?mr({duration:500,defer:0},F):{duration:500*!!F,defer:0}}function br(F,c){let m=zi.timers.length;for(;m--;)zi.timers[m].elem!==F||c&&c!==zi.timers[m].prop||(zi.timers[m].stopped=!0)}let Ds={animate:function(F,c,m){let y,T="",E,k,I;Cs(m)||(I=arguments,m={duration:I[2],easing:I[3],complete:I[4]}),ys(m.duration)||(m.duration=400),m.easing=typeof m.easing=="function"?m.easing:Math[m.easing]||Math.easeInOutSine,m.curAnim=mr(c),Ys(c,function(L,B){br(F,B),k=new zi(F,m,B),E=void 0,B==="d"&&mn(c.d)?(k.paths=k.initPath(F,F.pathArray,c.d),k.toD=c.d,y=0,E=1):F.attr?y=F.attr(B):(y=parseFloat(cn(F,B))||0,B!=="opacity"&&(T="px")),E||(E=L),typeof E=="string"&&E.match("px")&&(E=E.replace(/px/g,"")),k.run(y,E,T)})},animObject:Ks,getDeferredAnimation:function(F,c,m){let y=Ks(c),T=m?[m]:F.series,E=0,k=0;return T.forEach(I=>{let L=Ks(I.options.animation);E=Cs(c)&&Xi(c.defer)?y.defer:Math.max(E,L.duration+L.defer),k=Math.min(y.duration,L.duration)}),F.renderer.forExport&&(E=0),{defer:Math.max(0,E-k),duration:Math.min(E,k)}},setAnimation:function(F,c){c.renderer.globalAnimation=na(F,c.options.chart.animation,!0)},stop:br},{SVG_NS:Bp,win:Fp}=ve,{attr:kn,createElement:jd,css:hh,error:fu,isFunction:pu,isString:Ro,objectEach:sa,splat:$d}=Ee,{trustedTypes:uh}=Fp,ra=uh&&pu(uh.createPolicy)&&uh.createPolicy("highcharts",{createHTML:F=>F}),Ia=ra?ra.createHTML(""):"";class Yn{static filterUserAttributes(c){return sa(c,(m,y)=>{let T=!0;Yn.allowedAttributes.indexOf(y)===-1&&(T=!1),["background","dynsrc","href","lowsrc","src"].indexOf(y)!==-1&&(T=Ro(m)&&Yn.allowedReferences.some(E=>m.indexOf(E)===0)),T||(fu(33,!1,void 0,{"Invalid attribute in config":`${y}`}),delete c[y]),Ro(m)&&c[y]&&(c[y]=m.replace(/</g,"&lt;"))}),c}static parseStyle(c){return c.split(";").reduce((m,y)=>{let T=y.split(":").map(k=>k.trim()),E=T.shift();return E&&T.length&&(m[E.replace(/-([a-z])/g,k=>k[1].toUpperCase())]=T.join(":")),m},{})}static setElementHTML(c,m){c.innerHTML=Yn.emptyHTML,m&&new Yn(m).addToDOM(c)}constructor(c){this.nodes=typeof c=="string"?this.parseMarkup(c):c}addToDOM(c){return function m(y,T){let E;return $d(y).forEach(function(k){let I,L=k.tagName,B=k.textContent?ve.doc.createTextNode(k.textContent):void 0,W=Yn.bypassHTMLFiltering;if(L)if(L==="#text")I=B;else if(Yn.allowedTags.indexOf(L)!==-1||W){let N=L==="svg"?Bp:T.namespaceURI||Bp,H=ve.doc.createElementNS(N,L),K=k.attributes||{};sa(k,function(te,ce){ce!=="tagName"&&ce!=="attributes"&&ce!=="children"&&ce!=="style"&&ce!=="textContent"&&(K[ce]=te)}),kn(H,W?K:Yn.filterUserAttributes(K)),k.style&&hh(H,k.style),B&&H.appendChild(B),m(k.children||[],H),I=H}else fu(33,!1,void 0,{"Invalid tagName in config":L});I&&T.appendChild(I),E=I}),E}(this.nodes,c)}parseMarkup(c){let m,y=[];c=c.trim().replace(/ style=(["'])/g," data-style=$1");try{m=new DOMParser().parseFromString(ra?ra.createHTML(c):c,"text/html")}catch{}if(!m){let E=jd("div");E.innerHTML=c,m={body:E}}let T=(E,k)=>{let I=E.nodeName.toLowerCase(),L={tagName:I};I==="#text"&&(L.textContent=E.textContent||"");let B=E.attributes;if(B){let W={};[].forEach.call(B,N=>{N.name==="data-style"?L.style=Yn.parseStyle(N.value):W[N.name]=N.value}),L.attributes=W}if(E.childNodes.length){let W=[];[].forEach.call(E.childNodes,N=>{T(N,W)}),W.length&&(L.children=W)}k.push(L)};return[].forEach.call(m.body.childNodes,E=>T(E,y)),y}}Yn.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],Yn.allowedReferences=["https://","http://","mailto:","/","../","./","#"],Yn.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],Yn.emptyHTML=Ia,Yn.bypassHTMLFiltering=!1;let{defaultOptions:Ct,defaultTime:oa}=Fe,{pageLang:$s}=ve,{extend:ar,getNestedProperty:Np,isArray:aa,isNumber:mu,isObject:Up,isString:pc,pick:mi,ucfirst:dn}=Ee,tn={add:(F,c)=>F+c,divide:(F,c)=>c!==0?F/c:"",eq:(F,c)=>F==c,each:function(F){let c=arguments[arguments.length-1];return!!aa(F)&&F.map((m,y)=>nn(c.body,ar(Up(m)?m:{"@this":m},{"@index":y,"@first":y===0,"@last":y===F.length-1}))).join("")},ge:(F,c)=>F>=c,gt:(F,c)=>F>c,if:F=>!!F,le:(F,c)=>F<=c,lt:(F,c)=>F<c,multiply:(F,c)=>F*c,ne:(F,c)=>F!=c,subtract:(F,c)=>F-c,ucfirst:dn,unless:F=>!F},$r={},co=F=>/^["'].+["']$/.test(F);function nn(F="",c,m){var le;let y=/\{([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= #\(\)]+)\}/g,T=/\(([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= ]+)\)/g,E=[],k=/f$/,I=/\.(\d)/,L=((le=m==null?void 0:m.options)==null?void 0:le.lang)||Ct.lang,B=(m==null?void 0:m.time)||oa,W=(m==null?void 0:m.numberFormatter)||Wr,N=(oe="")=>{let me;return oe==="true"||oe!=="false"&&((me=Number(oe)).toString()===oe?me:co(oe)?oe.slice(1,-1):Np(oe,c))},H,K,te=0,ce;for(;(H=y.exec(F))!==null;){let oe=H,me=T.exec(H[1]);me&&(H=me,ce=!0),K!=null&&K.isBlock||(K={ctx:c,expression:H[1],find:H[0],isBlock:H[1].charAt(0)==="#",start:H.index,startInner:H.index+H[0].length,length:H[0].length});let xe=(K.isBlock?oe:H)[1].split(" ")[0].replace("#","");tn[xe]&&(K.isBlock&&xe===K.fn&&te++,K.fn||(K.fn=xe));let et=H[1]==="else";if(K.isBlock&&K.fn&&(H[1]===`/${K.fn}`||et))if(te)!et&&te--;else{let Ge=K.startInner,Ze=F.substr(Ge,H.index-Ge);K.body===void 0?(K.body=Ze,K.startInner=H.index+H[0].length):K.elseBody=Ze,K.find+=Ze+H[0],et||(E.push(K),K=void 0)}else K.isBlock||E.push(K);if(me&&!(K!=null&&K.isBlock))break}return E.forEach(oe=>{let me,xe,{body:et,elseBody:Ge,expression:Ze,fn:yt}=oe;if(yt){let at=[oe],vt=[],Vt=Ze.length,ii=0,li;for(xe=0;xe<=Vt;xe++){let $t=Ze.charAt(xe);li||$t!=='"'&&$t!=="'"?li===$t&&(li=""):li=$t,li||$t!==" "&&xe!==Vt||(vt.push(Ze.substr(ii,xe-ii)),ii=xe+1)}for(xe=tn[yt].length;xe--;)at.unshift(N(vt[xe+1]));me=tn[yt].apply(c,at),oe.isBlock&&typeof me=="boolean"&&(me=nn(me?et:Ge,c,m))}else{let at=co(Ze)?[Ze]:Ze.split(":");if(me=N(at.shift()||""),at.length&&typeof me=="number"){let vt=at.join(":");if(k.test(vt)){let Vt=parseInt((vt.match(I)||["","-1"])[1],10);me!==null&&(me=W(me,Vt,L.decimalPoint,vt.indexOf(",")>-1?L.thousandsSep:""))}else me=B.dateFormat(vt,me)}T.lastIndex=0,T.test(oe.find)&&pc(me)&&(me=`"${me}"`)}F=F.replace(oe.find,mi(me,""))}),ce?nn(F,c,m):F}function Wr(F,c,m,y){var ce;c*=1;let T,E,[k,I]=(F=+F||0).toString().split("e").map(Number),L=((ce=this==null?void 0:this.options)==null?void 0:ce.lang)||Ct.lang,B=(F.toString().split(".")[1]||"").split("e")[0].length,W=c,N={};m??(m=L.decimalPoint),y??(y=L.thousandsSep),c===-1?c=Math.min(B,20):mu(c)?c&&I<0&&((E=c+I)>=0?(k=+k.toExponential(E).split("e")[0],c=E):(k=Math.floor(k),F=c<20?+(k*Math.pow(10,I)).toFixed(c):0,I=0)):c=2,I&&(c??(c=2),F=k),mu(c)&&c>=0&&(N.minimumFractionDigits=c,N.maximumFractionDigits=c),y===""&&(N.useGrouping=!1);let H=y||m,K=H?"en":(this==null?void 0:this.locale)||L.locale||$s,te=JSON.stringify(N)+K;return T=($r[te]??($r[te]=new Intl.NumberFormat(K,N))).format(F),H&&(T=T.replace(/([,\.])/g,"_$1").replace(/_\,/g,y??",").replace("_.",m??".")),(c||+T!=0)&&(!(I<0)||W)||(T="0"),I&&+T!=0&&(T+="e"+(I<0?"":"+")+I),T}let wr={dateFormat:function(F,c,m){return oa.dateFormat(F,c,m)},format:nn,helpers:tn,numberFormat:Wr};(function(F){let c;F.rendererTypes={},F.getRendererType=function(m=c){return F.rendererTypes[m]||F.rendererTypes[c]},F.registerRendererType=function(m,y,T){F.rendererTypes[m]=y,(!c||T)&&(c=m,ve.Renderer=y)}})(d||(d={}));let zo=d,{clamp:ho,pick:us,pushUnique:Vp,stableSort:Bo}=Ee;(g||(g={})).distribute=function F(c,m,y){let T=c,E=T.reducedLen||m,k=(xe,et)=>xe.target-et.target,I=[],L=c.length,B=[],W=I.push,N,H,K,te=!0,ce,le,oe=0,me;for(N=L;N--;)oe+=c[N].size;if(oe>E){for(Bo(c,(xe,et)=>(et.rank||0)-(xe.rank||0)),K=(me=c[0].rank===c[c.length-1].rank)?L/2:-1,H=me?K:L-1;K&&oe>E;)ce=c[N=Math.floor(H)],Vp(B,N)&&(oe-=ce.size),H+=K,me&&H>=c.length&&(K/=2,H=K);B.sort((xe,et)=>et-xe).forEach(xe=>W.apply(I,c.splice(xe,1)))}for(Bo(c,k),c=c.map(xe=>({size:xe.size,targets:[xe.target],align:us(xe.align,.5)}));te;){for(N=c.length;N--;)ce=c[N],le=(Math.min.apply(0,ce.targets)+Math.max.apply(0,ce.targets))/2,ce.pos=ho(le-ce.size*ce.align,0,m-ce.size);for(N=c.length,te=!1;N--;)N>0&&c[N-1].pos+c[N-1].size>c[N].pos&&(c[N-1].size+=c[N].size,c[N-1].targets=c[N-1].targets.concat(c[N].targets),c[N-1].align=.5,c[N-1].pos+c[N-1].size>m&&(c[N-1].pos=m-c[N-1].size),c.splice(N,1),te=!0)}return W.apply(T,I),N=0,c.some(xe=>{let et=0;return(xe.targets||[]).some(()=>(T[N].pos=xe.pos+et,y!==void 0&&Math.abs(T[N].pos-T[N].target)>y?(T.slice(0,N+1).forEach(Ge=>delete Ge.pos),T.reducedLen=(T.reducedLen||m)-.1*m,T.reducedLen>.1*m&&F(T,m,y),!0):(et+=T[N].size,N++,!1)))}),Bo(T,k),T};let sl=g,{animate:dh,animObject:Wd,stop:Gd}=Ds,{deg2rad:mc,doc:la,svg:gu,SVG_NS:Pa,win:Gr,isFirefox:Os}=ve,{addEvent:Hd,attr:fh,createElement:Hr,crisp:Or,css:qd,defined:qr,erase:As,extend:La,fireEvent:ph,getAlignFactor:Da,isArray:lr,isFunction:_u,isNumber:Xd,isObject:Oa,isString:Ra,merge:gc,objectEach:_c,pick:Fo,pInt:za,pushUnique:ca,replaceNested:Zd,syncTimeout:Al,uniqueKey:ha}=Ee;class ks{_defaultGetter(c){let m=Fo(this[c+"Value"],this[c],this.element?this.element.getAttribute(c):null,0);return/^-?[\d\.]+$/.test(m)&&(m=parseFloat(m)),m}_defaultSetter(c,m,y){y.setAttribute(m,c)}add(c){let m,y=this.renderer,T=this.element;return c&&(this.parentGroup=c),this.textStr!==void 0&&this.element.nodeName==="text"&&y.buildText(this),this.added=!0,(!c||c.handleZ||this.zIndex)&&(m=this.zIndexSetter()),m||(c?c.element:y.box).appendChild(T),this.onAdd&&this.onAdd(),this}addClass(c,m){let y=m?"":this.attr("class")||"";return(c=(c||"").split(/ /g).reduce(function(T,E){return y.indexOf(E)===-1&&T.push(E),T},y?[y]:[]).join(" "))!==y&&this.attr("class",c),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(c,m,y,T=!0){let E=this.renderer,k=E.alignedObjects,I=!!c;c?(this.alignOptions=c,this.alignByTranslate=m,this.alignTo=y):(c=this.alignOptions||{},m=this.alignByTranslate,y=this.alignTo);let L=!y||Ra(y)?y||"renderer":void 0;L&&(I&&ca(k,this),y=void 0);let B=Fo(y,E[L],E),W=(B.x||0)+(c.x||0)+((B.width||0)-(c.width||0))*Da(c.align),N=(B.y||0)+(c.y||0)+((B.height||0)-(c.height||0))*Da(c.verticalAlign),H={"text-align":c==null?void 0:c.align};return H[m?"translateX":"x"]=Math.round(W),H[m?"translateY":"y"]=Math.round(N),T&&(this[this.placed?"animate":"attr"](H),this.placed=!0),this.alignAttr=H,this}alignSetter(c){let m={left:"start",center:"middle",right:"end"};m[c]&&(this.alignValue=c,this.element.setAttribute("text-anchor",m[c]))}animate(c,m,y){let T=Wd(Fo(m,this.renderer.globalAnimation,!0)),E=T.defer;return la.hidden&&(T.duration=0),T.duration!==0?(y&&(T.complete=y),Al(()=>{this.element&&dh(this,c,T)},E)):(this.attr(c,void 0,y||T.complete),_c(c,function(k,I){T.step&&T.step.call(this,k,{prop:I,pos:1,elem:this})},this)),this}applyTextOutline(c){let m=this.element;c.indexOf("contrast")!==-1&&(c=c.replace(/contrast/g,this.renderer.getContrast(m.style.fill)));let y=c.indexOf(" "),T=c.substring(y+1),E=c.substring(0,y);if(E&&E!=="none"&&ve.svg){this.fakeTS=!0,E=E.replace(/(^[\d\.]+)(.*?)$/g,function(W,N,H){return 2*Number(N)+H}),this.removeTextOutline();let k=la.createElementNS(Pa,"tspan");fh(k,{class:"highcharts-text-outline",fill:T,stroke:T,"stroke-width":E,"stroke-linejoin":"round"});let I=m.querySelector("textPath")||m;[].forEach.call(I.childNodes,W=>{let N=W.cloneNode(!0);N.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(H=>N.removeAttribute(H)),k.appendChild(N)});let L=0;[].forEach.call(I.querySelectorAll("text tspan"),W=>{L+=Number(W.getAttribute("dy"))});let B=la.createElementNS(Pa,"tspan");B.textContent="",fh(B,{x:Number(m.getAttribute("x")),dy:-L}),k.appendChild(B),I.insertBefore(k,I.firstChild)}}attr(c,m,y,T){let{element:E}=this,k=ks.symbolCustomAttribs,I,L,B=this,W;return typeof c=="string"&&m!==void 0&&(I=c,(c={})[I]=m),typeof c=="string"?B=(this[c+"Getter"]||this._defaultGetter).call(this,c,E):(_c(c,function(N,H){W=!1,T||Gd(this,H),this.symbolName&&k.indexOf(H)!==-1&&(L||(this.symbolAttr(c),L=!0),W=!0),this.rotation&&(H==="x"||H==="y")&&(this.doTransform=!0),W||(this[H+"Setter"]||this._defaultSetter).call(this,N,H,E)},this),this.afterSetters()),y&&y.call(this),B}clip(c){if(c&&!c.clipPath){let m=ha()+"-",y=this.renderer.createElement("clipPath").attr({id:m}).add(this.renderer.defs);La(c,{clipPath:y,id:m,count:0}),c.add(y)}return this.attr("clip-path",c?`url(${this.renderer.url}#${c.id})`:"none")}crisp(c,m){m=Math.round(m||c.strokeWidth||0);let y=c.x||this.x||0,T=c.y||this.y||0,E=(c.width||this.width||0)+y,k=(c.height||this.height||0)+T,I=Or(y,m),L=Or(T,m);return La(c,{x:I,y:L,width:Or(E,m)-I,height:Or(k,m)-L}),qr(c.strokeWidth)&&(c.strokeWidth=m),c}complexColor(c,m,y){let T=this.renderer,E,k,I,L,B,W,N,H,K,te,ce=[],le;ph(this.renderer,"complexColor",{args:arguments},function(){if(c.radialGradient?k="radialGradient":c.linearGradient&&(k="linearGradient"),k){if(I=c[k],B=T.gradients,W=c.stops,K=y.radialReference,lr(I)&&(c[k]=I={x1:I[0],y1:I[1],x2:I[2],y2:I[3],gradientUnits:"userSpaceOnUse"}),k==="radialGradient"&&K&&!qr(I.gradientUnits)&&(L=I,I=gc(I,T.getRadialAttr(K,L),{gradientUnits:"userSpaceOnUse"})),_c(I,function(oe,me){me!=="id"&&ce.push(me,oe)}),_c(W,function(oe){ce.push(oe)}),B[ce=ce.join(",")])te=B[ce].attr("id");else{I.id=te=ha();let oe=B[ce]=T.createElement(k).attr(I).add(T.defs);oe.radAttr=L,oe.stops=[],W.forEach(function(me){me[1].indexOf("rgba")===0?(N=(E=ht.parse(me[1])).get("rgb"),H=E.get("a")):(N=me[1],H=1);let xe=T.createElement("stop").attr({offset:me[0],"stop-color":N,"stop-opacity":H}).add(oe);oe.stops.push(xe)})}le="url("+T.url+"#"+te+")",y.setAttribute(m,le),y.gradient=ce,c.toString=function(){return le}}})}css(c){let m=this.styles,y={},T=this.element,E,k=!m;if(m&&_c(c,function(I,L){m&&m[L]!==I&&(y[L]=I,k=!0)}),k){m&&(c=La(m,y)),c.width===null||c.width==="auto"?delete this.textWidth:T.nodeName.toLowerCase()==="text"&&c.width&&(E=this.textWidth=za(c.width)),La(this.styles,c),E&&!gu&&this.renderer.forExport&&delete c.width;let I=Os&&c.fontSize||null;I&&(Xd(I)||/^\d+$/.test(I))&&(c.fontSize+="px");let L=gc(c);T.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","whiteSpace","width"].forEach(B=>L&&delete L[B]),L.color&&(L.fill=L.color,delete L.color)),qd(T,L)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),c.textOutline&&this.applyTextOutline(c.textOutline)),this}dashstyleSetter(c){let m,y=this["stroke-width"];if(y==="inherit"&&(y=1),c){let T=(c=c.toLowerCase()).replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(m=T.length;m--;)T[m]=""+za(T[m])*Fo(y,NaN);c=T.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",c)}}destroy(){let c=this,m=c.element||{},y=c.renderer,T=m.ownerSVGElement,E=m.nodeName==="SPAN"&&c.parentGroup||void 0,k,I;if(m.onclick=m.onmouseout=m.onmouseover=m.onmousemove=m.point=null,Gd(c),c.clipPath&&T){let L=c.clipPath;[].forEach.call(T.querySelectorAll("[clip-path],[CLIP-PATH]"),function(B){B.getAttribute("clip-path").indexOf(L.element.id)>-1&&B.removeAttribute("clip-path")}),c.clipPath=L.destroy()}if(c.stops){for(I=0;I<c.stops.length;I++)c.stops[I].destroy();c.stops.length=0,c.stops=void 0}for(c.safeRemoveChild(m);E!=null&&E.div&&E.div.childNodes.length===0;)k=E.parentGroup,c.safeRemoveChild(E.div),delete E.div,E=k;c.alignOptions&&As(y.alignedObjects,c),_c(c,(L,B)=>{var W,N,H;(((W=c[B])==null?void 0:W.parentGroup)===c||["connector","foreignObject"].indexOf(B)!==-1)&&((H=(N=c[B])==null?void 0:N.destroy)==null||H.call(N)),delete c[B]})}dSetter(c,m,y){lr(c)&&(typeof c[0]=="string"&&(c=this.renderer.pathToSegments(c)),this.pathArray=c,c=c.reduce((T,E,k)=>E!=null&&E.join?(k?T+" ":"")+E.join(" "):(E||"").toString(),"")),/(NaN| {2}|^$)/.test(c)&&(c="M 0 0"),this[m]!==c&&(y.setAttribute(m,c),this[m]=c)}fillSetter(c,m,y){typeof c=="string"?y.setAttribute(m,c):c&&this.complexColor(c,m,y)}hrefSetter(c,m,y){y.setAttributeNS("http://www.w3.org/1999/xlink",m,c)}getBBox(c,m){let y,T,E,k,{alignValue:I,element:L,renderer:B,styles:W,textStr:N}=this,{cache:H,cacheKeys:K}=B,te=L.namespaceURI===this.SVG_NS,ce=Fo(m,this.rotation,0),le=B.styledMode?L&&ks.prototype.getStyle.call(L,"font-size"):W.fontSize;if(qr(N)&&((k=N.toString()).indexOf("<")===-1&&(k=k.replace(/\d/g,"0")),k+=["",B.rootFontSize,le,ce,this.textWidth,I,W.lineClamp,W.textOverflow,W.fontWeight].join(",")),k&&!c&&(y=H[k]),!y||y.polygon){if(te||B.forExport){try{E=this.fakeTS&&function(me){let xe=L.querySelector(".highcharts-text-outline");xe&&qd(xe,{display:me})},_u(E)&&E("none"),y=L.getBBox?La({},L.getBBox()):{width:L.offsetWidth,height:L.offsetHeight,x:0,y:0},_u(E)&&E("")}catch{}(!y||y.width<0)&&(y={x:0,y:0,width:0,height:0})}else y=this.htmlGetBBox();T=y.height,te&&(y.height=T={"11px,17":14,"13px,20":16}[`${le||""},${Math.round(T)}`]||T),ce&&(y=this.getRotatedBox(y,ce));let oe={bBox:y};ph(this,"afterGetBBox",oe),y=oe.bBox}if(k&&(N===""||y.height>0)){for(;K.length>250;)delete H[K.shift()];H[k]||K.push(k),H[k]=y}return y}getRotatedBox(c,m){let{x:y,y:T,width:E,height:k}=c,{alignValue:I,translateY:L,rotationOriginX:B=0,rotationOriginY:W=0}=this,N=Da(I),H=Number(this.element.getAttribute("y")||0)-(L?0:T),K=m*mc,te=(m-90)*mc,ce=Math.cos(K),le=Math.sin(K),oe=E*ce,me=E*le,xe=Math.cos(te),et=Math.sin(te),[[Ge,Ze],[yt,at]]=[B,W].map(En=>[En-En*ce,En*le]),vt=y+N*(E-oe)+Ge+at+H*xe,Vt=vt+oe,ii=Vt-k*xe,li=ii-oe,$t=T+H-N*me-Ze+yt+H*et,gi=$t+me,vi=gi-k*et,Wi=vi-me,Ti=Math.min(vt,Vt,ii,li),Gi=Math.min($t,gi,vi,Wi),xn=Math.max(vt,Vt,ii,li)-Ti,hn=Math.max($t,gi,vi,Wi)-Gi;return{x:Ti,y:Gi,width:xn,height:hn,polygon:[[vt,$t],[Vt,gi],[ii,vi],[li,Wi]]}}getStyle(c){return Gr.getComputedStyle(this.element||this,"").getPropertyValue(c)}hasClass(c){return(""+this.attr("class")).split(" ").indexOf(c)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(c,m){this.onEvents={},this.opacity=1,this.SVG_NS=Pa,this.element=m==="span"||m==="body"?Hr(m):la.createElementNS(this.SVG_NS,m),this.renderer=c,this.styles={},ph(this,"afterInit")}on(c,m){let{onEvents:y}=this;return y[c]&&y[c](),y[c]=Hd(this.element,c,m),this}opacitySetter(c,m,y){let T=Number(Number(c).toFixed(3));this.opacity=T,y.setAttribute(m,T)}reAlign(){var c;(c=this.alignOptions)!=null&&c.width&&this.alignOptions.align!=="left"&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(c){return this.attr("class",(""+this.attr("class")).replace(Ra(c)?RegExp(`(^| )${c}( |$)`):c," ").replace(/ +/g," ").trim())}removeTextOutline(){let c=this.element.querySelector("tspan.highcharts-text-outline");c&&this.safeRemoveChild(c)}safeRemoveChild(c){let m=c.parentNode;m&&m.removeChild(c)}setRadialReference(c){let m=this.element.gradient&&this.renderer.gradients[this.element.gradient]||void 0;return this.element.radialReference=c,m!=null&&m.radAttr&&m.animate(this.renderer.getRadialAttr(c,m.radAttr)),this}shadow(c){var E;let{renderer:m}=this,y=gc(((E=this.parentGroup)==null?void 0:E.rotation)===90?{offsetX:-1,offsetY:-1}:{},Oa(c)?c:{}),T=m.shadowDefinition(y);return this.attr({filter:c?`url(${m.url}#${T})`:"none"})}show(c=!0){return this.attr({visibility:c?"inherit":"visible"})}"stroke-widthSetter"(c,m,y){this[m]=c,y.setAttribute(m,c)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let c=this.getStyle("stroke-width"),m=0,y;return/px$/.test(c)?m=za(c):c!==""&&(fh(y=la.createElementNS(Pa,"rect"),{width:c,"stroke-width":0}),this.element.parentNode.appendChild(y),m=y.getBBox().width,y.parentNode.removeChild(y)),m}symbolAttr(c){let m=this;ks.symbolCustomAttribs.forEach(function(y){m[y]=Fo(c[y],m[y])}),m.attr({d:m.renderer.symbols[m.symbolName](m.x,m.y,m.width,m.height,m)})}textSetter(c){c!==this.textStr&&(delete this.textPxLength,this.textStr=c,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(c){let m=this.element,y=m.getElementsByTagName("title")[0]||la.createElementNS(this.SVG_NS,"title");m.insertBefore?m.insertBefore(y,m.firstChild):m.appendChild(y),y.textContent=Zd(Fo(c,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let c=this.element;return c.parentNode.appendChild(c),this}translate(c,m){return this.attr({translateX:c,translateY:m})}updateTransform(c="transform"){let{element:m,foreignObject:y,matrix:T,padding:E,rotation:k=0,rotationOriginX:I,rotationOriginY:L,scaleX:B,scaleY:W,text:N,translateX:H=0,translateY:K=0}=this,te=["translate("+H+","+K+")"];qr(T)&&te.push("matrix("+T.join(",")+")"),k&&(te.push("rotate("+k+" "+(I??m.getAttribute("x")??this.x??0)+" "+(L??m.getAttribute("y")??this.y??0)+")"),(N==null?void 0:N.element.tagName)!=="SPAN"||N!=null&&N.foreignObject||N.attr({rotation:k,rotationOriginX:(I||0)-E,rotationOriginY:(L||0)-E})),(qr(B)||qr(W))&&te.push("scale("+Fo(B,1)+" "+Fo(W,1)+")"),te.length&&!(N||this).textPath&&((y==null?void 0:y.element)||m).setAttribute(c,te.join(" "))}visibilitySetter(c,m,y){c==="inherit"?y.removeAttribute(m):this[m]!==c&&y.setAttribute(m,c),this[m]=c}xGetter(c){return this.element.nodeName==="circle"&&(c==="x"?c="cx":c==="y"&&(c="cy")),this._defaultGetter(c)}zIndexSetter(c,m){let y=this.renderer,T=this.parentGroup,E=(T||y).element||y.box,k=this.element,I=E===y.box,L,B,W,N=!1,H,K=this.added,te;if(qr(c)?(k.setAttribute("data-z-index",c),c*=1,this[m]===c&&(K=!1)):qr(this[m])&&k.removeAttribute("data-z-index"),this[m]=c,K){for((c=this.zIndex)&&T&&(T.handleZ=!0),te=(L=E.childNodes).length-1;te>=0&&!N;te--)H=!qr(W=(B=L[te]).getAttribute("data-z-index")),B!==k&&(c<0&&H&&!I&&!te?(E.insertBefore(k,L[te]),N=!0):(za(W)<=c||H&&(!qr(c)||c>=0))&&(E.insertBefore(k,L[te+1]),N=!0));N||(E.insertBefore(k,L[3*!!I]),N=!0)}return N}}ks.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],ks.prototype.strokeSetter=ks.prototype.fillSetter,ks.prototype.yGetter=ks.prototype.xGetter,ks.prototype.matrixSetter=ks.prototype.rotationOriginXSetter=ks.prototype.rotationOriginYSetter=ks.prototype.rotationSetter=ks.prototype.scaleXSetter=ks.prototype.scaleYSetter=ks.prototype.translateXSetter=ks.prototype.translateYSetter=ks.prototype.verticalAlignSetter=function(F,c){this[c]=F,this.doTransform=!0};let cr=ks,{defined:mh,extend:yc,getAlignFactor:xc,isNumber:vc,merge:yu,pick:bc,removeEvent:xu}=Ee;class uo extends cr{constructor(c,m,y,T,E,k,I,L,B,W){let N;super(c,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=m,this.x=y,this.y=T,this.anchorX=k,this.anchorY=I,this.baseline=B,this.className=W,this.addClass(W==="button"?"highcharts-no-tooltip":"highcharts-label"),W&&this.addClass("highcharts-"+W),this.text=c.text(void 0,0,0,L).attr({zIndex:1}),typeof E=="string"&&((N=/^url\((.*?)\)$/.test(E))||this.renderer.symbols[E])&&(this.symbolKey=E),this.bBox=uo.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=c.styledMode||N,this.deferredAttr={},this.alignFactor=0}alignSetter(c){let m=xc(c);this.textAlign=c,m!==this.alignFactor&&(this.alignFactor=m,this.bBox&&vc(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(c,m){this.anchorX=c,this.boxAttr(m,Math.round(c)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(c,m){this.anchorY=c,this.boxAttr(m,c-this.ySetting)}boxAttr(c,m){this.box?this.box.attr(c,m):this.deferredAttr[c]=m}css(c){if(c){let m={};c=yu(c),uo.textProps.forEach(y=>{c[y]!==void 0&&(m[y]=c[y],delete c[y])}),this.text.css(m),"fontSize"in m||"fontWeight"in m?this.updateTextPadding():("width"in m||"textOverflow"in m)&&this.updateBoxSize()}return cr.prototype.css.call(this,c)}destroy(){xu(this.element,"mouseenter"),xu(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),cr.prototype.destroy.call(this)}fillSetter(c,m){c&&(this.needsBox=!0),this.fill=c,this.boxAttr(m,c)}getBBox(c,m){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let{padding:y,height:T=0,translateX:E=0,translateY:k=0,width:I=0}=this,L=bc(this.paddingLeft,y),B=m??(this.rotation||0),W={width:I,height:T,x:E+this.bBox.x-L,y:k+this.bBox.y-y+this.baselineOffset};return B&&(W=this.getRotatedBox(W,B)),W}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(c){this.heightSetting=c,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:bc(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&mh(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(c,m){vc(c)?c!==this[m]&&(this[m]=c,this.updateTextPadding()):this[m]=void 0}rSetter(c,m){this.boxAttr(m,c)}strokeSetter(c,m){this.stroke=c,this.boxAttr(m,c)}"stroke-widthSetter"(c,m){c&&(this.needsBox=!0),this["stroke-width"]=c,this.boxAttr(m,c)}"text-alignSetter"(c){this.textAlign=this["text-align"]=c,this.updateTextPadding()}textSetter(c){c!==void 0&&this.text.attr({text:c}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let c,m=this.text,y={},T=this.padding,E=this.bBox=(!vc(this.widthSetting)||!vc(this.heightSetting)||this.textAlign)&&mh(m.textStr)?m.getBBox(void 0,0):uo.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||E.height||0)+2*T;let k=this.renderer.fontMetrics(m);if(this.baselineOffset=T+Math.min((this.text.firstLineMetrics||k).b,E.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-k.h)/2),this.needsBox&&!m.textPath){if(!this.box){let I=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();I.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),I.add(this)}y.x=c=this.getCrispAdjust(),y.y=(this.baseline?-this.baselineOffset:0)+c,y.width=Math.round(this.width),y.height=Math.round(this.height),this.box.attr(yc(y,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let c=this.text,m=c.styles.textAlign||this.textAlign;if(!c.textPath){this.updateBoxSize();let y=this.baseline?0:this.baselineOffset,T=(this.paddingLeft??this.padding)+xc(m)*(this.widthSetting??this.bBox.width);(T!==c.x||y!==c.y)&&(c.attr({align:m,x:T}),y!==void 0&&c.attr("y",y)),c.x=T,c.y=y}}widthSetter(c){this.widthSetting=vc(c)?c:void 0,this.doUpdate=!0}getPaddedWidth(){let c=this.padding,m=bc(this.paddingLeft,c),y=bc(this.paddingRight,c);return(this.widthSetting||this.bBox.width||0)+m+y}xSetter(c){this.x=c,this.alignFactor&&(c-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(c),this.attr("translateX",this.xSetting)}ySetter(c){this.ySetting=this.y=Math.round(c),this.attr("translateY",this.ySetting)}}uo.emptyBBox={width:0,height:0,x:0,y:0},uo.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineClamp","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"];let{defined:Cn,isNumber:Ig,pick:kl}=Ee;function Yd(F,c,m,y,T){let E=[];if(T){let k=T.start||0,I=T.end||0,L=kl(T.r,m),B=kl(T.r,y||m),W=2e-4/(T.borderRadius?1:Math.max(L,1)),N=Math.abs(I-k-2*Math.PI)<W;N&&(k=Math.PI/2,I=2.5*Math.PI-W);let H=T.innerR,K=kl(T.open,N),te=Math.cos(k),ce=Math.sin(k),le=Math.cos(I),oe=Math.sin(I),me=kl(T.longArc,I-k-Math.PI<W?0:1),xe=["A",L,B,0,me,kl(T.clockwise,1),F+L*le,c+B*oe];xe.params={start:k,end:I,cx:F,cy:c},E.push(["M",F+L*te,c+B*ce],xe),Cn(H)&&((xe=["A",H,H,0,me,Cn(T.clockwise)?1-T.clockwise:0,F+H*te,c+H*ce]).params={start:I,end:k,cx:F,cy:c},E.push(K?["M",F+H*le,c+H*oe]:["L",F+H*le,c+H*oe],xe)),K||E.push(["Z"])}return E}function vu(F,c,m,y,T){return T!=null&&T.r?bu(F,c,m,y,T):[["M",F,c],["L",F+m,c],["L",F+m,c+y],["L",F,c+y],["Z"]]}function bu(F,c,m,y,T){let E=(T==null?void 0:T.r)||0;return[["M",F+E,c],["L",F+m-E,c],["A",E,E,0,0,1,F+m,c+E],["L",F+m,c+y-E],["A",E,E,0,0,1,F+m-E,c+y],["L",F+E,c+y],["A",E,E,0,0,1,F,c+y-E],["L",F,c+E],["A",E,E,0,0,1,F+E,c],["Z"]]}let wu={arc:Yd,callout:function(F,c,m,y,T){let E=Math.min((T==null?void 0:T.r)||0,m,y),k=E+6,I=T==null?void 0:T.anchorX,L=(T==null?void 0:T.anchorY)||0,B=bu(F,c,m,y,{r:E});if(!Ig(I)||I<m&&I>0&&L<y&&L>0)return B;if(F+I>m-k)if(L>c+k&&L<c+y-k)B.splice(3,1,["L",F+m,L-6],["L",F+m+6,L],["L",F+m,L+6],["L",F+m,c+y-E]);else if(I<m){let W=L<c+k,N=W?c:c+y;B.splice(W?2:5,0,["L",I,L],["L",F+m-E,N])}else B.splice(3,1,["L",F+m,y/2],["L",I,L],["L",F+m,y/2],["L",F+m,c+y-E]);else if(F+I<k)if(L>c+k&&L<c+y-k)B.splice(7,1,["L",F,L+6],["L",F-6,L],["L",F,L-6],["L",F,c+E]);else if(I>0){let W=L<c+k,N=W?c:c+y;B.splice(W?1:6,0,["L",I,L],["L",F+E,N])}else B.splice(7,1,["L",F,y/2],["L",I,L],["L",F,y/2],["L",F,c+E]);else L>y&&I<m-k?B.splice(5,1,["L",I+6,c+y],["L",I,c+y+6],["L",I-6,c+y],["L",F+E,c+y]):L<0&&I>k&&B.splice(1,1,["L",I-6,c],["L",I,c-6],["L",I+6,c],["L",m-E,c]);return B},circle:function(F,c,m,y){return Yd(F+m/2,c+y/2,m/2,y/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(F,c,m,y){return[["M",F+m/2,c],["L",F+m,c+y/2],["L",F+m/2,c+y],["L",F,c+y/2],["Z"]]},rect:vu,roundedRect:bu,square:vu,triangle:function(F,c,m,y){return[["M",F+m/2,c],["L",F+m,c+y],["L",F,c+y],["Z"]]},"triangle-down":function(F,c,m,y){return[["M",F,c],["L",F+m,c],["L",F+m/2,c+y],["Z"]]}},{doc:rl,SVG_NS:Tu,win:Il}=ve,{attr:No,extend:Pl,fireEvent:Eu,isString:jp,objectEach:gh,pick:Kd}=Ee,_h=(F,c)=>F.substring(0,c)+"",Su=class{constructor(F){let c=F.styles;this.renderer=F.renderer,this.svgElement=F,this.width=F.textWidth,this.textLineHeight=c==null?void 0:c.lineHeight,this.textOutline=c==null?void 0:c.textOutline,this.ellipsis=(c==null?void 0:c.textOverflow)==="ellipsis",this.lineClamp=c==null?void 0:c.lineClamp,this.noWrap=(c==null?void 0:c.whiteSpace)==="nowrap"}buildSVG(){let F=this.svgElement,c=F.element,m=F.renderer,y=Kd(F.textStr,"").toString(),T=y.indexOf("<")!==-1,E=c.childNodes,k=!F.added&&m.box,I=[y,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,F.getStyle("font-size"),F.styles.lineClamp,this.width].join(",");if(I!==F.textCache){F.textCache=I,delete F.actualWidth;for(let L=E.length;L--;)c.removeChild(E[L]);if(T||this.ellipsis||this.width||F.textPath||y.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(y))){if(y!==""){k&&k.appendChild(c);let L=new Yn(y);this.modifyTree(L.nodes),L.addToDOM(c),this.modifyDOM(),this.ellipsis&&(c.textContent||"").indexOf("")!==-1&&F.attr("title",this.unescapeEntities(F.textStr||"",["&lt;","&gt;"])),k&&k.removeChild(c)}}else c.appendChild(rl.createTextNode(this.unescapeEntities(y)));jp(this.textOutline)&&F.applyTextOutline&&F.applyTextOutline(this.textOutline)}}modifyDOM(){let F,c=this.svgElement,m=No(c.element,"x");for(c.firstLineMetrics=void 0;(F=c.element.firstChild)&&/^[\s\u200B]*$/.test(F.textContent||" ");)c.element.removeChild(F);[].forEach.call(c.element.querySelectorAll("tspan.highcharts-br"),(k,I)=>{k.nextSibling&&k.previousSibling&&(I===0&&k.previousSibling.nodeType===1&&(c.firstLineMetrics=c.renderer.fontMetrics(k.previousSibling)),No(k,{dy:this.getLineHeight(k.nextSibling),x:m}))});let y=this.width||0;if(!y)return;let T=(k,I)=>{var ce;let L=k.textContent||"",B=L.replace(/([^\^])-/g,"$1- ").split(" "),W=!this.noWrap&&(B.length>1||c.element.childNodes.length>1),N=this.getLineHeight(I),H=Math.max(0,y-.8*N),K=0,te=c.actualWidth;if(W){let le=[],oe=[];for(;I.firstChild&&I.firstChild!==k;)oe.push(I.firstChild),I.removeChild(I.firstChild);for(;B.length;)if(B.length&&!this.noWrap&&K>0&&(le.push(k.textContent||""),k.textContent=B.join(" ").replace(/- /g,"-")),this.truncate(k,void 0,B,K===0&&te||0,y,H,(me,xe)=>B.slice(0,xe).join(" ").replace(/- /g,"-")),te=c.actualWidth,K++,this.lineClamp&&K>=this.lineClamp){B.length&&(this.truncate(k,k.textContent||"",void 0,0,y,H,_h),k.textContent=((ce=k.textContent)==null?void 0:ce.replace("",""))+"");break}oe.forEach(me=>{I.insertBefore(me,k)}),le.forEach(me=>{I.insertBefore(rl.createTextNode(me),k);let xe=rl.createElementNS(Tu,"tspan");xe.textContent="",No(xe,{dy:N,x:m}),I.insertBefore(xe,k)})}else this.ellipsis&&L&&this.truncate(k,L,void 0,0,y,H,_h)},E=k=>{[].slice.call(k.childNodes).forEach(I=>{I.nodeType===Il.Node.TEXT_NODE?T(I,k):(I.className.baseVal.indexOf("highcharts-br")!==-1&&(c.actualWidth=0),E(I))})};E(c.element)}getLineHeight(F){let c=F.nodeType===Il.Node.TEXT_NODE?F.parentElement:F;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(c||this.svgElement.element).h}modifyTree(F){let c=(m,y)=>{let{attributes:T={},children:E,style:k={},tagName:I}=m,L=this.renderer.styledMode;if(I==="b"||I==="strong"?L?T.class="highcharts-strong":k.fontWeight="bold":(I==="i"||I==="em")&&(L?T.class="highcharts-emphasized":k.fontStyle="italic"),k!=null&&k.color&&(k.fill=k.color),I==="br"){T.class="highcharts-br",m.textContent="";let B=F[y+1];B!=null&&B.textContent&&(B.textContent=B.textContent.replace(/^ +/gm,""))}else I==="a"&&E&&E.some(B=>B.tagName==="#text")&&(m.children=[{children:E,tagName:"tspan"}]);I!=="#text"&&I!=="a"&&(m.tagName="tspan"),Pl(m,{attributes:T,style:k}),E&&E.filter(B=>B.tagName!=="#text").forEach(c)};F.forEach(c),Eu(this.svgElement,"afterModifyTree",{nodes:F})}truncate(F,c,m,y,T,E,k){let I,L,B=this.svgElement,{rotation:W}=B,N=[],H=m&&!y?1:0,K=(c||m||"").length,te=K;m||(T=E);let ce=function(le,oe){let me=oe||le,xe=F.parentNode;if(xe&&N[me]===void 0&&xe.getSubStringLength)try{N[me]=y+xe.getSubStringLength(0,m?me+1:me)}catch{}return N[me]};if(B.rotation=0,y+(L=ce(F.textContent.length))>T){for(;H<=K;)te=Math.ceil((H+K)/2),m&&(I=k(m,te)),L=ce(te,I&&I.length-1),H===K?H=K+1:L>T?K=te-1:H=te;K===0?F.textContent="":c&&K===c.length-1||(F.textContent=I||k(c||m,te)),this.ellipsis&&L>T&&this.truncate(F,F.textContent||"",void 0,0,T,E,_h)}m&&m.splice(0,te),B.actualWidth=L,B.rotation=W}unescapeEntities(F,c){return gh(this.renderer.escapes,function(m,y){c&&c.indexOf(m)!==-1||(F=F.toString().replace(RegExp(m,"g"),y))}),F}},{defaultOptions:Mu}=Fe,{charts:Jd,deg2rad:_n,doc:ua,isFirefox:Qd,isMS:Cu,isWebKit:$p,noop:Ll,SVG_NS:ef,symbolSizes:tf,win:nf}=ve,{addEvent:Au,attr:wc,createElement:sf,crisp:ku,css:Dl,defined:ol,destroyObjectProperties:Wp,extend:Ol,isArray:yh,isNumber:Uo,isObject:Rl,isString:xh,merge:vh,pick:fo,pInt:Iu,replaceNested:rf,uniqueKey:Pu}=Ee;class bh{constructor(c,m,y,T,E,k,I){let L,B;this.x=0,this.y=0;let W=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),N=W.element;I||W.css(this.getStyle(T||{})),c.appendChild(N),wc(c,"dir","ltr"),c.innerHTML.indexOf("xmlns")===-1&&wc(N,"xmlns",this.SVG_NS),this.box=N,this.boxWrapper=W,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(ua.createTextNode("Created with Highcharts 12.2.0")),this.defs=this.createElement("defs").add(),this.allowHTML=k,this.forExport=E,this.styledMode=I,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=W.getStyle("font-size"),this.setSize(m,y,!1),Qd&&c.getBoundingClientRect&&((L=function(){Dl(c,{left:0,top:0}),B=c.getBoundingClientRect(),Dl(c,{left:Math.ceil(B.left)-B.left+"px",top:Math.ceil(B.top)-B.top+"px"})})(),this.unSubPixelFix=Au(nf,"resize",L))}definition(c){return new Yn([c]).addToDOM(this.defs.element)}getReferenceURL(){if((Qd||$p)&&ua.getElementsByTagName("base").length){if(!ol(l)){let c=Pu(),m=new Yn([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:c},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${c})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(ua.body);Dl(m,{position:"fixed",top:0,left:0,zIndex:9e5});let y=ua.elementFromPoint(6,6);l=(y==null?void 0:y.id)==="hitme",ua.body.removeChild(m)}if(l)return rf(nf.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(c){return this.style=Ol({fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif',fontSize:"1rem"},c),this.style}setStyle(c){this.boxWrapper.css(this.getStyle(c))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let c=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),Wp(this.gradients||{}),this.gradients=null,this.defs=c.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(c){return new this.Element(this,c)}getRadialAttr(c,m){return{cx:c[0]-c[2]/2+(m.cx||0)*c[2],cy:c[1]-c[2]/2+(m.cy||0)*c[2],r:(m.r||0)*c[2]}}shadowDefinition(c){let m=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(c).map(T=>`${T}-${c[T]}`)].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),y=vh({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},c);return this.defs.element.querySelector(`#${m}`)||this.definition({tagName:"filter",attributes:{id:m,filterUnits:y.filterUnits},children:this.getShadowFilterContent(y)}),m}getShadowFilterContent(c){return[{tagName:"feDropShadow",attributes:{dx:c.offsetX,dy:c.offsetY,"flood-color":c.color,"flood-opacity":Math.min(5*c.opacity,1),stdDeviation:c.width/2}}]}buildText(c){new Su(c).buildSVG()}getContrast(c){let m=ht.parse(c).rgba,y=" clamp(0,calc(9e9*(0.5 - (0.2126*r + 0.7152*g + 0.0722*b))),1)";if(Uo(m[0])||!ht.useColorMix){let T=m.map(k=>{let I=k/255;return I<=.04?I/12.92:Math.pow((I+.055)/1.055,2.4)}),E=.2126*T[0]+.7152*T[1]+.0722*T[2];return 1.05/(E+.05)>(E+.05)/.05?"#FFFFFF":"#000000"}return"color(from "+c+" srgb"+y+y+y+")"}button(c,m,y,T,E={},k,I,L,B,W){let N=this.label(c,m,y,B,void 0,void 0,W,void 0,"button"),H=this.styledMode,K=arguments,te=0;E=vh(Mu.global.buttonTheme,E),H&&(delete E.fill,delete E.stroke,delete E["stroke-width"]);let ce=E.states||{},le=E.style||{};delete E.states,delete E.style;let oe=[Yn.filterUserAttributes(E)],me=[le];return H||["hover","select","disabled"].forEach((xe,et)=>{oe.push(vh(oe[0],Yn.filterUserAttributes(K[et+5]||ce[xe]||{}))),me.push(oe[et+1].style),delete oe[et+1].style}),Au(N.element,Cu?"mouseover":"mouseenter",function(){te!==3&&N.setState(1)}),Au(N.element,Cu?"mouseout":"mouseleave",function(){te!==3&&N.setState(te)}),N.setState=(xe=0)=>{if(xe!==1&&(N.state=te=xe),N.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][xe]),!H){N.attr(oe[xe]);let et=me[xe];Rl(et)&&N.css(et)}},N.attr(oe[0]),!H&&(N.css(Ol({cursor:"default"},le)),W&&N.text.css({pointerEvents:"none"})),N.on("touchstart",xe=>xe.stopPropagation()).on("click",function(xe){te!==3&&(T==null||T.call(N,xe))})}crispLine(c,m){let[y,T]=c;return ol(y[1])&&y[1]===T[1]&&(y[1]=T[1]=ku(y[1],m)),ol(y[2])&&y[2]===T[2]&&(y[2]=T[2]=ku(y[2],m)),c}path(c){let m=this.styledMode?{}:{fill:"none"};return yh(c)?m.d=c:Rl(c)&&Ol(m,c),this.createElement("path").attr(m)}circle(c,m,y){let T=Rl(c)?c:c===void 0?{}:{x:c,y:m,r:y},E=this.createElement("circle");return E.xSetter=E.ySetter=function(k,I,L){L.setAttribute("c"+I,k)},E.attr(T)}arc(c,m,y,T,E,k){let I;Rl(c)?(m=(I=c).y,y=I.r,T=I.innerR,E=I.start,k=I.end,c=I.x):I={innerR:T,start:E,end:k};let L=this.symbol("arc",c,m,y,y,I);return L.r=y,L}rect(c,m,y,T,E,k){let I=Rl(c)?c:c===void 0?{}:{x:c,y:m,r:E,width:Math.max(y||0,0),height:Math.max(T||0,0)},L=this.createElement("rect");return this.styledMode||(k!==void 0&&(I["stroke-width"]=k,Ol(I,L.crisp(I))),I.fill="none"),L.rSetter=function(B,W,N){L.r=B,wc(N,{rx:B,ry:B})},L.rGetter=function(){return L.r||0},L.attr(I)}roundedRect(c){return this.symbol("roundedRect").attr(c)}setSize(c,m,y){this.width=c,this.height=m,this.boxWrapper.animate({width:c,height:m},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:fo(y,!0)?void 0:0}),this.alignElements()}g(c){let m=this.createElement("g");return c?m.attr({class:"highcharts-"+c}):m}image(c,m,y,T,E,k){let I={preserveAspectRatio:"none"};Uo(m)&&(I.x=m),Uo(y)&&(I.y=y),Uo(T)&&(I.width=T),Uo(E)&&(I.height=E);let L=this.createElement("image").attr(I),B=function(W){L.attr({href:c}),k.call(L,W)};if(k){L.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let W=new nf.Image;Au(W,"load",B),W.src=c,W.complete&&B({})}else L.attr({href:c});return L}symbol(c,m,y,T,E,k){var le,oe;let I,L,B,W,N=this,H=/^url\((.*?)\)$/,K=H.test(c),te=!K&&(this.symbols[c]?c:"circle"),ce=te&&this.symbols[te];if(ce)typeof m=="number"&&(L=ce.call(this.symbols,m||0,y||0,T||0,E||0,k)),I=this.path(L),N.styledMode||I.attr("fill","none"),Ol(I,{symbolName:te||void 0,x:m,y,width:T,height:E}),k&&Ol(I,k);else if(K){B=c.match(H)[1];let me=I=this.image(B);me.imgwidth=fo(k==null?void 0:k.width,(le=tf[B])==null?void 0:le.width),me.imgheight=fo(k==null?void 0:k.height,(oe=tf[B])==null?void 0:oe.height),W=xe=>xe.attr({width:xe.width,height:xe.height}),["width","height"].forEach(xe=>{me[`${xe}Setter`]=function(et,Ge){this[Ge]=et;let{alignByTranslate:Ze,element:yt,width:at,height:vt,imgwidth:Vt,imgheight:ii}=this,li=Ge==="width"?Vt:ii,$t=1;k&&k.backgroundSize==="within"&&at&&vt&&Vt&&ii?($t=Math.min(at/Vt,vt/ii),wc(yt,{width:Math.round(Vt*$t),height:Math.round(ii*$t)})):yt&&li&&yt.setAttribute(Ge,li),!Ze&&Vt&&ii&&this.translate(((at||0)-Vt*$t)/2,((vt||0)-ii*$t)/2)}}),ol(m)&&me.attr({x:m,y}),me.isImg=!0,me.symbolUrl=c,ol(me.imgwidth)&&ol(me.imgheight)?W(me):(me.attr({width:0,height:0}),sf("img",{onload:function(){let xe=Jd[N.chartIndex];this.width===0&&(Dl(this,{position:"absolute",top:"-999em"}),ua.body.appendChild(this)),tf[B]={width:this.width,height:this.height},me.imgwidth=this.width,me.imgheight=this.height,me.element&&W(me),this.parentNode&&this.parentNode.removeChild(this),N.imgCount--,N.imgCount||!xe||xe.hasLoaded||xe.onload()},src:B}),this.imgCount++)}return I}clipRect(c,m,y,T){return this.rect(c,m,y,T,0)}text(c,m,y,T){let E={};if(T&&(this.allowHTML||!this.forExport))return this.html(c,m,y);E.x=Math.round(m||0),y&&(E.y=Math.round(y)),ol(c)&&(E.text=c);let k=this.createElement("text").attr(E);return T&&(!this.forExport||this.allowHTML)||(k.xSetter=function(I,L,B){let W=B.getElementsByTagName("tspan"),N=B.getAttribute(L);for(let H=0,K;H<W.length;H++)(K=W[H]).getAttribute(L)===N&&K.setAttribute(L,I);B.setAttribute(L,I)}),k}fontMetrics(c){let m=Iu(cr.prototype.getStyle.call(c,"font-size")||0),y=m<24?m+3:Math.round(1.2*m),T=Math.round(.8*y);return{h:y,b:T,f:m}}rotCorr(c,m,y){let T=c;return m&&y&&(T=Math.max(T*Math.cos(m*_n),4)),{x:-c/3*Math.sin(m*_n),y:T}}pathToSegments(c){let m=[],y=[],T={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let E=0;E<c.length;E++)xh(y[0])&&Uo(c[E])&&y.length===T[y[0].toUpperCase()]&&c.splice(E,0,y[0].replace("M","L").replace("m","l")),typeof c[E]=="string"&&(y.length&&m.push(y.slice(0)),y.length=0),y.push(c[E]);return m.push(y.slice(0)),m}label(c,m,y,T,E,k,I,L,B){return new uo(this,c,m,y,T,E,k,I,L,B)}alignElements(){this.alignedObjects.forEach(c=>c.align())}}Ol(bh.prototype,{Element:cr,SVG_NS:ef,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:wu,draw:Ll}),zo.registerRendererType("svg",bh,!0);let{composed:of,isFirefox:Pg}=ve,{attr:af,css:Vo,createElement:wh,defined:lf,extend:cf,getAlignFactor:Lg,isNumber:Tc,pInt:Gp,pushUnique:Th}=Ee;function hf(F,c,m){var T;let y=((T=this.div)==null?void 0:T.style)||m.style;cr.prototype[`${c}Setter`].call(this,F,c,m),y&&(y[c]=F)}let Lu=(F,c)=>{var m;if(!F.div){let y=af(F.element,"class"),T=F.css,E=wh("div",y?{className:y}:void 0,{position:"absolute",left:`${F.translateX||0}px`,top:`${F.translateY||0}px`,...F.styles,display:F.display,opacity:F.opacity,visibility:F.visibility},((m=F.parentGroup)==null?void 0:m.div)||c);F.classSetter=(k,I,L)=>{L.setAttribute("class",k),E.className=k},F.translateXSetter=F.translateYSetter=(k,I)=>{F[I]=k,E.style[I==="translateX"?"left":"top"]=`${k}px`,F.doTransform=!0},F.opacitySetter=F.visibilitySetter=hf,F.css=k=>(T.call(F,k),k.cursor&&(E.style.cursor=k.cursor),k.pointerEvents&&(E.style.pointerEvents=k.pointerEvents),F),F.on=function(){return cr.prototype.on.apply({element:E,onEvents:F.onEvents},arguments),F},F.div=E}return F.div};class zl extends cr{static compose(c){Th(of,this.compose)&&(c.prototype.html=function(m,y,T){return new zl(this,"span").attr({text:m,x:Math.round(y),y:Math.round(T)})})}constructor(c,m){super(c,m),zl.useForeignObject?this.foreignObject=c.createElement("foreignObject").attr({zIndex:2}):this.css({position:"absolute",...c.styledMode?{}:{fontFamily:c.style.fontFamily,fontSize:c.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(c,m,y){this.xCorr=-c*y,this.yCorr=-m}css(c){let m,{element:y}=this,T=y.tagName==="SPAN"&&c&&"width"in c,E=T&&c.width;return T&&(delete c.width,this.textWidth=Gp(E)||void 0,m=!0),(c==null?void 0:c.textOverflow)==="ellipsis"&&(c.overflow="hidden",c.whiteSpace="nowrap"),c!=null&&c.lineClamp&&(c.display="-webkit-box",c.WebkitLineClamp=c.lineClamp,c.WebkitBoxOrient="vertical",c.overflow="hidden"),Tc(Number(c==null?void 0:c.fontSize))&&(c.fontSize+="px"),cf(this.styles,c),Vo(y,c),m&&this.updateTransform(),this}htmlGetBBox(){let{element:c}=this;return{x:c.offsetLeft,y:c.offsetTop,width:c.offsetWidth,height:c.offsetHeight}}updateTransform(){var me;if(!this.added){this.alignOnAdd=!0;return}let{element:c,foreignObject:m,oldTextWidth:y,renderer:T,rotation:E,rotationOriginX:k,rotationOriginY:I,scaleX:L,scaleY:B,styles:{display:W="inline-block",whiteSpace:N},textAlign:H="left",textWidth:K,translateX:te=0,translateY:ce=0,x:le=0,y:oe=0}=this;if(m||Vo(c,{marginLeft:`${te}px`,marginTop:`${ce}px`}),c.tagName==="SPAN"){let xe,et=[E,H,c.innerHTML,K,this.textAlign].join(","),Ge=-(((me=this.parentGroup)==null?void 0:me.padding)*1)||0;if(K!==y){let vt=this.textPxLength?this.textPxLength:(Vo(c,{width:"",whiteSpace:N||"nowrap"}),c.offsetWidth),Vt=K||0,ii=c.style.textOverflow===""&&c.style.webkitLineClamp;(Vt>y||vt>Vt||ii)&&(/[\-\s\u00AD]/.test(c.textContent||c.innerText)||c.style.textOverflow==="ellipsis")&&(Vo(c,{width:(E||L||vt>Vt||ii)&&Tc(K)?K+"px":"auto",display:W,whiteSpace:N||"normal"}),this.oldTextWidth=K)}m&&(Vo(c,{display:"inline-block",verticalAlign:"top"}),m.attr({width:T.width,height:T.height})),et!==this.cTT&&(xe=T.fontMetrics(c).b,lf(E)&&!m&&(E!==(this.oldRotation||0)||H!==this.oldAlign)&&Vo(c,{transform:`rotate(${E}deg)`,transformOrigin:`${Ge}% ${Ge}px`}),this.getSpanCorrection(!lf(E)&&!this.textWidth&&this.textPxLength||c.offsetWidth,xe,Lg(H)));let{xCorr:Ze=0,yCorr:yt=0}=this,at={left:`${le+Ze}px`,top:`${oe+yt}px`,textAlign:H,transformOrigin:`${(k??le)-Ze-le-Ge}px ${(I??oe)-yt-oe-Ge}px`};(L||B)&&(at.transform=`scale(${L??1},${B??1})`),m?(super.updateTransform(),Tc(le)&&Tc(oe)?(m.attr({x:le+Ze,y:oe+yt,width:c.offsetWidth+3,height:c.offsetHeight,"transform-origin":c.getAttribute("transform-origin")||"0 0"}),Vo(c,{display:W,textAlign:H})):Pg&&m.attr({width:0,height:0})):Vo(c,at),this.cTT=et,this.oldRotation=E,this.oldAlign=H}}add(c){let{foreignObject:m,renderer:y}=this,T=y.box.parentNode,E=[];if(m)m.add(c),super.add(y.createElement("body").attr({xmlns:"http://www.w3.org/1999/xhtml"}).css({background:"transparent",margin:"0 3px 0 0"}).add(m));else{let k;if(this.parentGroup=c,c&&!(k=c.div)){let I=c;for(;I;)E.push(I),I=I.parentGroup;for(let L of E.reverse())k=Lu(L,T)}(k||T).appendChild(this.element)}return this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(c){c!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,Yn.setElementHTML(this.element,c??""),this.textStr=c,this.doTransform=!0)}alignSetter(c){this.alignValue=this.textAlign=c,this.doTransform=!0}xSetter(c,m){this[m]=c,this.doTransform=!0}}let po=zl.prototype;po.visibilitySetter=po.opacitySetter=hf,po.ySetter=po.rotationSetter=po.rotationOriginXSetter=po.rotationOriginYSetter=po.xSetter,function(F){F.xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%[HMSL]",range:!1},second:{main:"%[HMS]",range:!1},minute:{main:"%[HM]",range:!1},hour:{main:"%[HM]",range:!1},day:{main:"%[eb]"},week:{main:"%[eb]"},month:{main:"%[bY]"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em",textOverflow:"ellipsis"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},F.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:c}=this.axis.chart;return c(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0}}(b||(b={}));let Dg=b,{addEvent:Og,isFunction:Rg,objectEach:zg,removeEvent:Bg}=Ee;(r||(r={})).registerEventOptions=function(F,c){F.eventOptions=F.eventOptions||{},zg(c.events,function(m,y){F.eventOptions[y]!==m&&(F.eventOptions[y]&&(Bg(F,y,F.eventOptions[y]),delete F.eventOptions[y]),Rg(m)&&(F.eventOptions[y]=m,Og(F,y,m,{order:0})))})};let Eh=r,{deg2rad:Ec}=ve,{clamp:Sc,correctFloat:Sh,defined:Du,destroyObjectProperties:Ba,extend:Mh,fireEvent:Tr,getAlignFactor:Ch,isNumber:Ah,merge:Bl,objectEach:Mc,pick:io}=Ee,Fa=class{constructor(F,c,m,y,T){this.isNew=!0,this.isNewLabel=!0,this.axis=F,this.pos=c,this.type=m||"",this.parameters=T||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,Tr(this,"init"),m||y||this.addLabel()}addLabel(){var yt;let F=this,c=F.axis,m=c.options,y=c.chart,T=c.categories,E=c.logarithmic,k=c.names,I=F.pos,L=io((yt=F.options)==null?void 0:yt.labels,m.labels),B=c.tickPositions,W=I===B[0],N=I===B[B.length-1],H=(!L.step||L.step===1)&&c.tickInterval===1,K=B.info,te=F.label,ce,le,oe,me=this.parameters.category||(T?io(T[I],k[I],I):I);E&&Ah(me)&&(me=Sh(E.lin2log(me))),c.dateTime&&(K?ce=(le=y.time.resolveDTLFormat(m.dateTimeLabelFormats[!m.grid&&K.higherRanks[I]||K.unitName])).main:Ah(me)&&(ce=c.dateTime.getXDateFormat(me,m.dateTimeLabelFormats||{}))),F.isFirst=W,F.isLast=N;let xe={axis:c,chart:y,dateTimeLabelFormat:ce,isFirst:W,isLast:N,pos:I,tick:F,tickPositionInfo:K,value:me};Tr(this,"labelFormat",xe);let et=at=>L.formatter?L.formatter.call(at,at):L.format?(at.text=c.defaultLabelFormatter.call(at),wr.format(L.format,at,y)):c.defaultLabelFormatter.call(at),Ge=et.call(xe,xe),Ze=le==null?void 0:le.list;Ze?F.shortenLabel=function(){for(oe=0;oe<Ze.length;oe++)if(Mh(xe,{dateTimeLabelFormat:Ze[oe]}),te.attr({text:et.call(xe,xe)}),te.getBBox().width<c.getSlotWidth(F)-2*(L.padding||0))return;te.attr({text:""})}:F.shortenLabel=void 0,H&&c._addedPlotLB&&F.moveLabel(Ge,L),Du(te)||F.movedLabel?te&&te.textStr!==Ge&&!H&&(!te.textWidth||L.style.width||te.styles.width||te.css({width:null}),te.attr({text:Ge}),te.textPxLength=te.getBBox().width):(F.label=te=F.createLabel(Ge,L),F.rotation=0)}createLabel(F,c,m){let y=this.axis,{renderer:T,styledMode:E}=y.chart,k=c.style.whiteSpace,I=Du(F)&&c.enabled?T.text(F,m==null?void 0:m.x,m==null?void 0:m.y,c.useHTML).add(y.labelGroup):void 0;return I&&(E||I.css(Bl(c.style)),I.textPxLength=I.getBBox().width,!E&&k&&I.css({whiteSpace:k})),I}destroy(){Ba(this,this.axis)}getPosition(F,c,m,y){let T=this.axis,E=T.chart,k=y&&E.oldChartHeight||E.chartHeight,I={x:F?Sh(T.translate(c+m,void 0,void 0,y)+T.transB):T.left+T.offset+(T.opposite?(y&&E.oldChartWidth||E.chartWidth)-T.right-T.left:0),y:F?k-T.bottom+T.offset-(T.opposite?T.height:0):Sh(k-T.translate(c+m,void 0,void 0,y)-T.transB)};return I.y=Sc(I.y,-1e9,1e9),Tr(this,"afterGetPosition",{pos:I}),I}getLabelPosition(F,c,m,y,T,E,k,I){let L,B,W=this.axis,N=W.transA,H=W.isLinked&&W.linkedParent?W.linkedParent.reversed:W.reversed,K=W.staggerLines,te=W.tickRotCorr||{x:0,y:0},ce=y||W.reserveSpaceDefault?0:-W.labelOffset*(W.labelAlign==="center"?.5:1),le=T.distance,oe={};return L=W.side===0?m.rotation?-le:-m.getBBox().height:W.side===2?te.y+le:Math.cos(m.rotation*Ec)*(te.y-m.getBBox(!1,0).height/2),Du(T.y)&&(L=W.side===0&&W.horiz?T.y+L:T.y),F=F+io(T.x,[0,1,0,-1][W.side]*le)+ce+te.x-(E&&y?E*N*(H?-1:1):0),c=c+L-(E&&!y?E*N*(H?1:-1):0),K&&(B=k/(I||1)%K,W.opposite&&(B=K-B-1),c+=B*(W.labelOffset/K)),oe.x=F,oe.y=Math.round(c),Tr(this,"afterGetLabelPosition",{pos:oe,tickmarkOffset:E,index:k}),oe}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(F,c,m,y,T=!1,E){return E.crispLine([["M",F,c],["L",F+(T?0:-m),c+(T?m:0)]],y)}handleOverflow(F){var le;let c=this.axis,m=c.options.labels,y=F.x,T=c.chart.chartWidth,E=c.chart.spacing,k=io(c.labelLeft,Math.min(c.pos,E[3])),I=io(c.labelRight,Math.max(c.isRadial?0:c.pos+c.len,T-E[1])),L=this.label,B=this.rotation,W=Ch(c.labelAlign||L.attr("align")),N=L.getBBox().width,H=c.getSlotWidth(this),K=H,te=1,ce;B||m.overflow!=="justify"?B<0&&y-W*N<k?ce=Math.round(y/Math.cos(B*Ec)-k):B>0&&y+W*N>I&&(ce=Math.round((T-y)/Math.cos(B*Ec))):(y-W*N<k?K=F.x+K*(1-W)-k:y+(1-W)*N>I&&(K=I-F.x+K*W,te=-1),(K=Math.min(H,K))<H&&c.labelAlign==="center"&&(F.x+=te*(H-K-W*(H-Math.min(N,K)))),(N>K||c.autoRotation&&((le=L==null?void 0:L.styles)!=null&&le.width))&&(ce=K)),ce&&L&&(this.shortenLabel?this.shortenLabel():L.css(Mh({},{width:Math.floor(ce)+"px",lineClamp:+!c.isRadial})))}moveLabel(F,c){let m=this,y=m.label,T=m.axis,E=!1,k;y&&y.textStr===F?(m.movedLabel=y,E=!0,delete m.label):Mc(T.ticks,function(I){E||I.isNew||I===m||!I.label||I.label.textStr!==F||(m.movedLabel=I.label,E=!0,I.labelPos=m.movedLabel.xy,delete I.label)}),!E&&(m.labelPos||y)&&(k=m.labelPos||y.xy,m.movedLabel=m.createLabel(F,c,k),m.movedLabel&&m.movedLabel.attr({opacity:0}))}render(F,c,m){var te;let y=this.axis,T=y.horiz,E=this.pos,k=io(this.tickmarkOffset,y.tickmarkOffset),I=this.getPosition(T,E,k,c),L=I.x,B=I.y,W=y.pos,N=W+y.len,H=T?L:B,K=io(m,(te=this.label)==null?void 0:te.newOpacity,1);!y.chart.polar&&(Sh(H)<W||H>N)&&(m=0),m??(m=1),this.isActive=!0,this.renderGridLine(c,m),this.renderMark(I,m),this.renderLabel(I,c,K,F),this.isNew=!1,Tr(this,"afterRender")}renderGridLine(F,c){let m=this.axis,y=m.options,T={},E=this.pos,k=this.type,I=io(this.tickmarkOffset,m.tickmarkOffset),L=m.chart.renderer,B=this.gridLine,W,N=y.gridLineWidth,H=y.gridLineColor,K=y.gridLineDashStyle;this.type==="minor"&&(N=y.minorGridLineWidth,H=y.minorGridLineColor,K=y.minorGridLineDashStyle),B||(m.chart.styledMode||(T.stroke=H,T["stroke-width"]=N||0,T.dashstyle=K),k||(T.zIndex=1),F&&(c=0),this.gridLine=B=L.path().attr(T).addClass("highcharts-"+(k?k+"-":"")+"grid-line").add(m.gridGroup)),B&&(W=m.getPlotLinePath({value:E+I,lineWidth:B.strokeWidth(),force:"pass",old:F,acrossPanes:!1}))&&B[F||this.isNew?"attr":"animate"]({d:W,opacity:c})}renderMark(F,c){let m=this.axis,y=m.options,T=m.chart.renderer,E=this.type,k=m.tickSize(E?E+"Tick":"tick"),I=F.x,L=F.y,B=io(y[E!=="minor"?"tickWidth":"minorTickWidth"],!E&&m.isXAxis?1:0),W=y[E!=="minor"?"tickColor":"minorTickColor"],N=this.mark,H=!N;k&&(m.opposite&&(k[0]=-k[0]),N||(this.mark=N=T.path().addClass("highcharts-"+(E?E+"-":"")+"tick").add(m.axisGroup),m.chart.styledMode||N.attr({stroke:W,"stroke-width":B})),N[H?"attr":"animate"]({d:this.getMarkPath(I,L,k[0],N.strokeWidth(),m.horiz,T),opacity:c}))}renderLabel(F,c,m,y){let T=this.axis,E=T.horiz,k=T.options,I=this.label,L=k.labels,B=L.step,W=io(this.tickmarkOffset,T.tickmarkOffset),N=F.x,H=F.y,K=!0;I&&Ah(N)&&(I.xy=F=this.getLabelPosition(N,H,I,E,L,W,y,B),(!this.isFirst||this.isLast||k.showFirstLabel)&&(!this.isLast||this.isFirst||k.showLastLabel)?!E||L.step||L.rotation||c||m===0||this.handleOverflow(F):K=!1,B&&y%B&&(K=!1),K&&Ah(F.y)?(F.opacity=m,I[this.isNewLabel?"attr":"animate"](F).show(!0),this.isNewLabel=!1):(I.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let F=this.label,c=this.axis;F&&!this.isNew&&(F.animate({opacity:0},void 0,F.destroy),delete this.label),c.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}},{animObject:Tn}=Ds,{xAxis:Cc,yAxis:Hp}=Dg,{defaultOptions:Ac}=Fe,{registerEventOptions:kc}=Eh,{deg2rad:qp}=ve,{arrayMax:kh,arrayMin:Na,clamp:Ou,correctFloat:Er,defined:On,destroyObjectProperties:Ic,erase:Ru,error:Fl,extend:al,fireEvent:is,getClosestDistance:Ih,insertItem:yi,isArray:mo,isNumber:Ui,isString:Pc,merge:ll,normalizeTickInterval:hr,objectEach:cl,pick:an,relativeLength:Lc,removeEvent:zu,splat:Xp,syncTimeout:Bu}=Ee,Nl=(F,c)=>hr(c,void 0,void 0,an(F.options.allowDecimals,c<.5||F.tickAmount!==void 0),!!F.tickAmount);al(Ac,{xAxis:Cc,yAxis:ll(Cc,Hp)});class hl{constructor(c,m,y){this.init(c,m,y)}init(c,m,y=this.coll){let T=y==="xAxis",E=this.isZAxis||(c.inverted?!T:T);this.chart=c,this.horiz=E,this.isXAxis=T,this.coll=y,is(this,"init",{userOptions:m}),this.opposite=an(m.opposite,this.opposite),this.side=an(m.side,this.side,E?2*!this.opposite:this.opposite?1:3),this.setOptions(m);let k=this.options,I=k.labels;this.type??(this.type=k.type||"linear"),this.uniqueNames??(this.uniqueNames=k.uniqueNames??!0),is(this,"afterSetType"),this.userOptions=m,this.minPixelPadding=0,this.reversed=an(k.reversed,this.reversed),this.visible=k.visible,this.zoomEnabled=k.zoomEnabled,this.hasNames=this.type==="category"||k.categories===!0,this.categories=mo(k.categories)&&k.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=On(k.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=k.minRange||k.maxZoom,this.range=k.range,this.offset=k.offset||0,this.max=void 0,this.min=void 0;let L=an(k.crosshair,Xp(c.options.tooltip.crosshairs)[+!T]);this.crosshair=L===!0?{}:L,c.axes.indexOf(this)===-1&&(T?c.axes.splice(c.xAxis.length,0,this):c.axes.push(this),yi(this,c[this.coll])),c.orderItems(this.coll),this.series=this.series||[],c.inverted&&!this.isZAxis&&T&&!On(this.reversed)&&(this.reversed=!0),this.labelRotation=Ui(I.rotation)?I.rotation:void 0,kc(this,k),is(this,"afterInit")}setOptions(c){let m=this.horiz?{labels:{autoRotation:[-45],padding:3},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=ll(m,this.coll==="yAxis"?{title:{text:this.chart.options.lang.yAxisTitle}}:{},Ac[this.coll],c),is(this,"afterSetOptions",{userOptions:c})}defaultLabelFormatter(){let c=this.axis,{numberFormatter:m}=this.chart,y=Ui(this.value)?this.value:NaN,T=c.chart.time,E=c.categories,k=this.dateTimeLabelFormat,I=Ac.lang,L=I.numericSymbols,B=I.numericSymbolMagnitude||1e3,W=c.logarithmic?Math.abs(y):c.tickInterval,N=L==null?void 0:L.length,H,K;if(E)K=`${this.value}`;else if(k)K=T.dateFormat(k,y,!0);else if(N&&L&&W>=1e3)for(;N--&&K===void 0;)W>=(H=Math.pow(B,N+1))&&10*y%H==0&&L[N]!==null&&y!==0&&(K=m(y/H,-1)+L[N]);return K===void 0&&(K=Math.abs(y)>=1e4?m(y,-1):m(y,-1,void 0,"")),K}getSeriesExtremes(){let c,m=this;is(this,"getSeriesExtremes",null,function(){m.hasVisibleSeries=!1,m.dataMin=m.dataMax=m.threshold=void 0,m.softThreshold=!m.isXAxis,m.series.forEach(y=>{if(y.reserveSpace()){let T=y.options,E,k=T.threshold,I,L;if(m.hasVisibleSeries=!0,m.positiveValuesOnly&&0>=(k||0)&&(k=void 0),m.isXAxis)(E=y.getColumn("x")).length&&(E=m.logarithmic?E.filter(B=>B>0):E,I=(c=y.getXExtremes(E)).min,L=c.max,Ui(I)||I instanceof Date||(E=E.filter(Ui),I=(c=y.getXExtremes(E)).min,L=c.max),E.length&&(m.dataMin=Math.min(an(m.dataMin,I),I),m.dataMax=Math.max(an(m.dataMax,L),L)));else{let B=y.applyExtremes();Ui(B.dataMin)&&(I=B.dataMin,m.dataMin=Math.min(an(m.dataMin,I),I)),Ui(B.dataMax)&&(L=B.dataMax,m.dataMax=Math.max(an(m.dataMax,L),L)),On(k)&&(m.threshold=k),(!T.softThreshold||m.positiveValuesOnly)&&(m.softThreshold=!1)}}})}),is(this,"afterGetSeriesExtremes")}translate(c,m,y,T,E,k){var ce;let I=this.linkedParent||this,L=T&&I.old?I.old.min:I.min;if(!Ui(L))return NaN;let B=I.minPixelPadding,W=(I.isOrdinal||((ce=I.brokenAxis)==null?void 0:ce.hasBreaks)||I.logarithmic&&E)&&I.lin2val,N=1,H=0,K=T&&I.old?I.old.transA:I.transA,te=0;return K||(K=I.transA),y&&(N*=-1,H=I.len),I.reversed&&(N*=-1,H-=N*(I.sector||I.len)),m?(te=(c=c*N+H-B)/K+L,W&&(te=I.lin2val(te))):(W&&(c=I.val2lin(c)),te=N*(c-L)*K+H+N*B+(Ui(k)?K*k:0),I.isRadial||(te=Er(te))),te}toPixels(c,m){var y;return this.translate(((y=this.chart)==null?void 0:y.time.parse(c))??NaN,!1,!this.horiz,void 0,!0)+(m?0:this.pos)}toValue(c,m){return this.translate(c-(m?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(c){let m=this,y=m.chart,T=m.left,E=m.top,k=c.old,I=c.value,L=c.lineWidth,B=k&&y.oldChartHeight||y.chartHeight,W=k&&y.oldChartWidth||y.chartWidth,N=m.transB,H=c.translatedValue,K=c.force,te,ce,le,oe,me;function xe(Ge,Ze,yt){return K!=="pass"&&(Ge<Ze||Ge>yt)&&(K?Ge=Ou(Ge,Ze,yt):me=!0),Ge}let et={value:I,lineWidth:L,old:k,force:K,acrossPanes:c.acrossPanes,translatedValue:H};return is(this,"getPlotLinePath",et,function(Ge){te=le=(H=Ou(H=an(H,m.translate(I,void 0,void 0,k)),-1e9,1e9))+N,ce=oe=B-H-N,Ui(H)?m.horiz?(ce=E,oe=B-m.bottom+(m.options.isInternal?0:y.scrollablePixelsY||0),te=le=xe(te,T,T+m.width)):(te=T,le=W-m.right+(y.scrollablePixelsX||0),ce=oe=xe(ce,E,E+m.height)):(me=!0,K=!1),Ge.path=me&&!K?void 0:y.renderer.crispLine([["M",te,ce],["L",le,oe]],L||1)}),et.path}getLinearTickPositions(c,m,y){let T,E,k,I=Er(Math.floor(m/c)*c),L=Er(Math.ceil(y/c)*c),B=[];if(Er(I+c)===I&&(k=20),this.single)return[m];for(T=I;T<=L&&(B.push(T),(T=Er(T+c,k))!==E);)E=T;return B}getMinorTickInterval(){let{minorTicks:c,minorTickInterval:m}=this.options;return c===!0?an(m,"auto"):c!==!1?m:void 0}getMinorTickPositions(){var W;let c=this.options,m=this.tickPositions,y=this.minorTickInterval,T=this.pointRangePadding||0,E=(this.min||0)-T,k=(this.max||0)+T,I=(W=this.brokenAxis)!=null&&W.hasBreaks?this.brokenAxis.unitLength:k-E,L=[],B;if(I&&I/y<this.len/3){let N=this.logarithmic;if(N)this.paddedTicks.forEach(function(H,K,te){K&&L.push.apply(L,N.getLogTickPositions(y,te[K-1],te[K],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")L=L.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(y),E,k,c.startOfWeek));else for(B=E+(m[0]-E)%y;B<=k&&B!==L[0];B+=y)L.push(B)}return L.length!==0&&this.trimTicks(L),L}adjustForMinRange(){let c=this.options,m=this.logarithmic,y=this.chart.time,{max:T,min:E,minRange:k}=this,I,L,B,W;this.isXAxis&&k===void 0&&!m&&(k=On(c.min)||On(c.max)||On(c.floor)||On(c.ceiling)?null:Math.min(5*(Ih(this.series.map(N=>{let H=N.getColumn("x");return N.xIncrement?H.slice(0,2):H}))||0),this.dataMax-this.dataMin)),Ui(T)&&Ui(E)&&Ui(k)&&T-E<k&&(L=this.dataMax-this.dataMin>=k,I=(k-T+E)/2,B=[E-I,y.parse(c.min)??E-I],L&&(B[2]=m?m.log2lin(this.dataMin):this.dataMin),W=[(E=kh(B))+k,y.parse(c.max)??E+k],L&&(W[2]=m?m.log2lin(this.dataMax):this.dataMax),(T=Na(W))-E<k&&(B[0]=T-k,B[1]=y.parse(c.min)??T-k,E=kh(B))),this.minRange=k,this.min=E,this.max=T}getClosest(){let c,m;if(this.categories)m=1;else{let y=[];this.series.forEach(function(T){let E=T.closestPointRange,k=T.getColumn("x");k.length===1?y.push(k[0]):T.sorted&&On(E)&&T.reserveSpace()&&(m=On(m)?Math.min(m,E):E)}),y.length&&(y.sort((T,E)=>T-E),c=Ih([y]))}return c&&m?Math.min(c,m):c||m}nameToX(c){let m=mo(this.options.categories),y=m?this.categories:this.names,T=c.options.x,E;return c.series.requireSorting=!1,On(T)||(T=this.uniqueNames&&y?m?y.indexOf(c.name):an(y.keys[c.name],-1):c.series.autoIncrement()),T===-1?!m&&y&&(E=y.length):Ui(T)&&(E=T),E!==void 0?(this.names[E]=c.name,this.names.keys[c.name]=E):c.x&&(E=c.x),E}updateNames(){let c=this,m=this.names;m.length>0&&(Object.keys(m.keys).forEach(function(y){delete m.keys[y]}),m.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(y=>{y.xIncrement=null,(!y.points||y.isDirtyData)&&(c.max=Math.max(c.max||0,y.dataTable.rowCount-1),y.processData(),y.generatePoints());let T=y.getColumn("x").slice();y.data.forEach((E,k)=>{let I=T[k];E!=null&&E.options&&E.name!==void 0&&(I=c.nameToX(E))!==void 0&&I!==E.x&&(T[k]=E.x=I)}),y.dataTable.setColumn("x",T)}))}setAxisTranslation(){var H;let c=this,m=c.max-c.min,y=c.linkedParent,T=!!c.categories,E=c.isXAxis,k=c.axisPointRange||0,I,L=0,B=0,W,N=c.transA;(E||T||k)&&(I=c.getClosest(),y?(L=y.minPointOffset,B=y.pointRangePadding):c.series.forEach(function(K){let te=T?1:E?an(K.options.pointRange,I,0):c.axisPointRange||0,ce=K.options.pointPlacement;if(k=Math.max(k,te),!c.single||T){let le=K.is("xrange")?!E:E;L=Math.max(L,le&&Pc(ce)?0:te/2),B=Math.max(B,le&&ce==="on"?0:te)}}),W=(H=c.ordinal)!=null&&H.slope&&I?c.ordinal.slope/I:1,c.minPointOffset=L*=W,c.pointRangePadding=B*=W,c.pointRange=Math.min(k,c.single&&T?1:m),E&&(c.closestPointRange=I)),c.translationSlope=c.transA=N=c.staticScale||c.len/(m+B||1),c.transB=c.horiz?c.left:c.bottom,c.minPixelPadding=N*L,is(this,"afterSetAxisTranslation")}minFromRange(){let{max:c,min:m}=this;return Ui(c)&&Ui(m)&&c-m||void 0}setTickInterval(c){var vi,Wi,Ti,Gi;let{categories:m,chart:y,dataMax:T,dataMin:E,dateTime:k,isXAxis:I,logarithmic:L,options:B,softThreshold:W}=this,N=y.time,H=Ui(this.threshold)?this.threshold:void 0,K=this.minRange||0,{ceiling:te,floor:ce,linkedTo:le,softMax:oe,softMin:me}=B,xe=Ui(le)&&((vi=y[this.coll])==null?void 0:vi[le]),et=B.tickPixelInterval,Ge=B.maxPadding,Ze=B.minPadding,yt=0,at,vt=Ui(B.tickInterval)&&B.tickInterval>=0?B.tickInterval:void 0,Vt,ii,li,$t;if(k||m||xe||this.getTickAmount(),li=an(this.userMin,N.parse(B.min)),$t=an(this.userMax,N.parse(B.max)),xe?(this.linkedParent=xe,at=xe.getExtremes(),this.min=an(at.min,at.dataMin),this.max=an(at.max,at.dataMax),this.type!==xe.type&&Fl(11,!0,y)):(W&&On(H)&&Ui(T)&&Ui(E)&&(E>=H?(Vt=H,Ze=0):T<=H&&(ii=H,Ge=0)),this.min=an(li,Vt,E),this.max=an($t,ii,T)),Ui(this.max)&&Ui(this.min)&&(L&&(this.positiveValuesOnly&&!c&&0>=Math.min(this.min,an(E,this.min))&&Fl(10,!0,y),this.min=Er(L.log2lin(this.min),16),this.max=Er(L.log2lin(this.max),16)),this.range&&Ui(E)&&(this.userMin=this.min=li=Math.max(E,this.minFromRange()||0),this.userMax=$t=this.max,this.range=void 0)),is(this,"foundExtremes"),this.adjustForMinRange(),Ui(this.min)&&Ui(this.max)){if(!Ui(this.userMin)&&Ui(me)&&me<this.min&&(this.min=li=me),!Ui(this.userMax)&&Ui(oe)&&oe>this.max&&(this.max=$t=oe),m||this.axisPointRange||(Wi=this.stacking)!=null&&Wi.usePercentage||xe||!(yt=this.max-this.min)||(!On(li)&&Ze&&(this.min-=yt*Ze),On($t)||!Ge||(this.max+=yt*Ge)),!Ui(this.userMin)&&Ui(ce)&&(this.min=Math.max(this.min,ce)),!Ui(this.userMax)&&Ui(te)&&(this.max=Math.min(this.max,te)),W&&Ui(E)&&Ui(T)){let xn=H||0;!On(li)&&this.min<xn&&E>=xn?this.min=B.minRange?Math.min(xn,this.max-K):xn:!On($t)&&this.max>xn&&T<=xn&&(this.max=B.minRange?Math.max(xn,this.min+K):xn)}!y.polar&&this.min>this.max&&(On(B.min)?this.max=this.min:On(B.max)&&(this.min=this.max)),yt=this.max-this.min}if(this.min!==this.max&&Ui(this.min)&&Ui(this.max)?xe&&!vt&&et===xe.options.tickPixelInterval?this.tickInterval=vt=xe.tickInterval:this.tickInterval=an(vt,this.tickAmount?yt/Math.max(this.tickAmount-1,1):void 0,m?1:yt*et/Math.max(this.len,et)):this.tickInterval=1,I&&!c){let xn=this.min!==((Ti=this.old)==null?void 0:Ti.min)||this.max!==((Gi=this.old)==null?void 0:Gi.max);this.series.forEach(function(hn){var En;hn.forceCrop=(En=hn.forceCropping)==null?void 0:En.call(hn),hn.processData(xn)}),is(this,"postProcessData",{hasExtremesChanged:xn})}this.setAxisTranslation(),is(this,"initialAxisTranslation"),this.pointRange&&!vt&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let gi=an(B.minTickInterval,k&&!this.series.some(xn=>!xn.sorted)?this.closestPointRange:0);!vt&&gi&&this.tickInterval<gi&&(this.tickInterval=gi),k||L||vt||(this.tickInterval=Nl(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){var W,N;let c=this.options,m=c.tickPositions,y=c.tickPositioner,T=this.getMinorTickInterval(),E=!this.isPanning,k=E&&c.startOnTick,I=E&&c.endOnTick,L=[],B;if(this.tickmarkOffset=this.categories&&c.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.single=this.min===this.max&&On(this.min)&&!this.tickAmount&&(this.min%1==0||c.allowDecimals!==!1),m)L=m.slice();else if(Ui(this.min)&&Ui(this.max)){if(!((W=this.ordinal)!=null&&W.positions)&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))L=[this.min,this.max],Fl(19,!1,this.chart);else if(this.dateTime)L=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,c.units),this.min,this.max,c.startOfWeek,(N=this.ordinal)==null?void 0:N.positions,this.closestPointRange,!0);else if(this.logarithmic)L=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let H=this.tickInterval,K=H;for(;K<=2*H&&(L=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&L.length>this.tickAmount);)this.tickInterval=Nl(this,K*=1.1)}L.length>this.len&&(L=[L[0],L[L.length-1]])[0]===L[1]&&(L.length=1),y&&(this.tickPositions=L,(B=y.apply(this,[this.min,this.max]))&&(L=B))}this.tickPositions=L,this.minorTickInterval=T==="auto"&&this.tickInterval?this.tickInterval/c.minorTicksPerMajor:T,this.paddedTicks=L.slice(0),this.trimTicks(L,k,I),!this.isLinked&&Ui(this.min)&&Ui(this.max)&&(this.single&&L.length<2&&!this.categories&&!this.series.some(H=>H.is("heatmap")&&H.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),m||B||this.adjustTickAmount()),is(this,"afterSetTickPositions")}trimTicks(c,m,y){let T=c[0],E=c[c.length-1],k=!this.isOrdinal&&this.minPointOffset||0;if(is(this,"trimTicks"),!this.isLinked||!this.grid){if(m&&T!==-1/0)this.min=T;else for(;this.min-k>c[0];)c.shift();if(y)this.max=E;else for(;this.max+k<c[c.length-1];)c.pop();c.length===0&&On(T)&&!this.options.tickPositions&&c.push((E+T)/2)}}alignToOthers(){let c,m=this,y=m.chart,T=[this],E=m.options,k=y.options.chart,I=this.coll==="yAxis"&&k.alignThresholds,L=[];if(m.thresholdAlignment=void 0,(k.alignTicks!==!1&&E.alignTicks||I)&&E.startOnTick!==!1&&E.endOnTick!==!1&&!m.logarithmic){let B=N=>{let{horiz:H,options:K}=N;return[H?K.left:K.top,K.width,K.height,K.pane].join(",")},W=B(this);y[this.coll].forEach(function(N){let{series:H}=N;H.length&&H.some(K=>K.visible)&&N!==m&&B(N)===W&&(c=!0,T.push(N))})}if(c&&I){T.forEach(W=>{let N=W.getThresholdAlignment(m);Ui(N)&&L.push(N)});let B=L.length>1?L.reduce((W,N)=>W+=N,0)/L.length:void 0;T.forEach(W=>{W.thresholdAlignment=B})}return c}getThresholdAlignment(c){if((!Ui(this.dataMin)||this!==c&&this.series.some(m=>m.isDirty||m.isDirtyData))&&this.getSeriesExtremes(),Ui(this.threshold)){let m=Ou((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(m=1-m),m}}getTickAmount(){let c=this.options,m=c.tickPixelInterval,y=c.tickAmount;On(c.tickInterval)||y||!(this.len<m)||this.isRadial||this.logarithmic||!c.startOnTick||!c.endOnTick||(y=2),!y&&this.alignToOthers()&&(y=Math.ceil(this.len/m)+1),y<4&&(this.finalTickAmt=y,y=5),this.tickAmount=y}adjustTickAmount(){let c=this,{finalTickAmt:m,max:y,min:T,options:E,tickPositions:k,tickAmount:I,thresholdAlignment:L}=c,B=k==null?void 0:k.length,W=an(c.threshold,c.softThreshold?0:null),N,H,K=c.tickInterval,te,ce=()=>k.push(Er(k[k.length-1]+K)),le=()=>k.unshift(Er(k[0]-K));if(Ui(L)&&(te=L<.5?Math.ceil(L*(I-1)):Math.floor(L*(I-1)),E.reversed&&(te=I-1-te)),c.hasData()&&Ui(T)&&Ui(y)){let oe=()=>{c.transA*=(B-1)/(I-1),c.min=E.startOnTick?k[0]:Math.min(T,k[0]),c.max=E.endOnTick?k[k.length-1]:Math.max(y,k[k.length-1])};if(Ui(te)&&Ui(c.threshold)){for(;k[te]!==W||k.length!==I||k[0]>T||k[k.length-1]<y;){for(k.length=0,k.push(c.threshold);k.length<I;)k[te]===void 0||k[te]>c.threshold?le():ce();if(K>8*c.tickInterval)break;K*=2}oe()}else if(B<I){for(;k.length<I;)k.length%2||T===W?ce():le();oe()}if(On(m)){for(H=N=k.length;H--;)(m===3&&H%2==1||m<=2&&H>0&&H<N-1)&&k.splice(H,1);c.finalTickAmt=void 0}}}setScale(){var k,I,L,B,W;let{coll:c,stacking:m}=this,y=!1,T=!1;this.series.forEach(N=>{var H;y=y||N.isDirtyData||N.isDirty,T=T||((H=N.xAxis)==null?void 0:H.isDirty)||!1}),this.setAxisSize();let E=this.len!==((k=this.old)==null?void 0:k.len);E||y||T||this.isLinked||this.forceRedraw||this.userMin!==((I=this.old)==null?void 0:I.userMin)||this.userMax!==((L=this.old)==null?void 0:L.userMax)||this.alignToOthers()?(m&&c==="yAxis"&&m.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),m&&c==="xAxis"&&m.buildStacks(),this.isDirty||(this.isDirty=E||this.min!==((B=this.old)==null?void 0:B.min)||this.max!==((W=this.old)==null?void 0:W.max))):m&&m.cleanStacks(),y&&delete this.allExtremes,is(this,"afterSetScale")}setExtremes(c,m,y=!0,T,E){let k=this.chart;this.series.forEach(I=>{delete I.kdTree}),c=k.time.parse(c),m=k.time.parse(m),is(this,"setExtremes",E=al(E,{min:c,max:m}),I=>{this.userMin=I.min,this.userMax=I.max,this.eventArgs=I,y&&k.redraw(T)})}setAxisSize(){let c=this.chart,m=this.options,y=m.offsets||[0,0,0,0],T=this.horiz,E=this.width=Math.round(Lc(an(m.width,c.plotWidth-y[3]+y[1]),c.plotWidth)),k=this.height=Math.round(Lc(an(m.height,c.plotHeight-y[0]+y[2]),c.plotHeight)),I=this.top=Math.round(Lc(an(m.top,c.plotTop+y[0]),c.plotHeight,c.plotTop)),L=this.left=Math.round(Lc(an(m.left,c.plotLeft+y[3]),c.plotWidth,c.plotLeft));this.bottom=c.chartHeight-k-I,this.right=c.chartWidth-E-L,this.len=Math.max(T?E:k,0),this.pos=T?L:I}getExtremes(){let c=this.logarithmic;return{min:c?Er(c.lin2log(this.min)):this.min,max:c?Er(c.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(c){let m=this.logarithmic,y=m?m.lin2log(this.min):this.min,T=m?m.lin2log(this.max):this.max;return c===null||c===-1/0?c=y:c===1/0?c=T:y>c?c=y:T<c&&(c=T),this.translate(c,0,1,0,1)}autoLabelAlign(c){let m=(an(c,0)-90*this.side+720)%360,y={align:"center"};return is(this,"autoLabelAlign",y,function(T){m>15&&m<165?T.align="right":m>195&&m<345&&(T.align="left")}),y.align}tickSize(c){let m=this.options,y=an(m[c==="tick"?"tickWidth":"minorTickWidth"],c==="tick"&&this.isXAxis&&!this.categories?1:0),T=m[c==="tick"?"tickLength":"minorTickLength"],E;y&&T&&(m[c+"Position"]==="inside"&&(T=-T),E=[T,y]);let k={tickSize:E};return is(this,"afterTickSize",k),k.tickSize}labelMetrics(){let c=this.chart.renderer,m=this.ticks,y=m[Object.keys(m)[0]]||{};return this.chart.renderer.fontMetrics(y.label||y.movedLabel||c.box)}unsquish(){let c=this.options.labels,m=c.padding||0,y=this.horiz,T=this.tickInterval,E=this.len/((+!!this.categories+this.max-this.min)/T),k=c.rotation,I=Er(.8*this.labelMetrics().h),L=Math.max(this.max-this.min,0),B=function(te){let ce=(te+2*m)/(E||1);return(ce=ce>1?Math.ceil(ce):1)*T>L&&te!==1/0&&E!==1/0&&L&&(ce=Math.ceil(L/T)),Er(ce*T)},W=T,N,H=Number.MAX_VALUE,K;if(y){if(!c.staggerLines&&(Ui(k)?K=[k]:E<c.autoRotationLimit&&(K=c.autoRotation)),K){let te,ce;for(let le of K)(le===k||le&&le>=-90&&le<=90)&&(ce=(te=B(Math.abs(I/Math.sin(qp*le))))+Math.abs(le/360))<H&&(H=ce,N=le,W=te)}}else W=B(.75*I);return this.autoRotation=K,this.labelRotation=an(N,Ui(k)?k:0),c.step?T:W}getSlotWidth(c){let m=this.chart,y=this.horiz,T=this.options.labels,E=Math.max(this.tickPositions.length-+!this.categories,1),k=m.margin[3];if(c&&Ui(c.slotWidth))return c.slotWidth;if(y&&T.step<2&&!this.isRadial)return T.rotation?0:(this.staggerLines||1)*this.len/E;if(!y){let I=T.style.width;if(I!==void 0)return parseInt(String(I),10);if(k)return k-m.spacing[3]}return .33*m.chartWidth}renderUnsquish(){let c=this.chart,m=c.renderer,y=this.tickPositions,T=this.ticks,E=this.options.labels,k=E.style,I=this.horiz,L=this.getSlotWidth(),B=Math.max(1,Math.round(L-(I?2*(E.padding||0):E.distance||0))),W={},N=this.labelMetrics(),H=k.lineClamp,K,te=H??(Math.floor(this.len/(y.length*N.h))||1),ce=0;Pc(E.rotation)||(W.rotation=E.rotation||0),y.forEach(function(le){var xe;let oe=T[le];oe.movedLabel&&oe.replaceMovedLabel();let me=((xe=oe.label)==null?void 0:xe.textPxLength)||0;me>ce&&(ce=me)}),this.maxLabelLength=ce,this.autoRotation?ce>B&&ce>N.h?W.rotation=this.labelRotation:this.labelRotation=0:L&&(K=B),W.rotation&&(K=ce>.5*c.chartHeight?.33*c.chartHeight:ce,H||(te=1)),this.labelAlign=E.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(W.align=this.labelAlign),y.forEach(function(le){let oe=T[le],me=oe==null?void 0:oe.label,xe=k.width,et={};me&&(me.attr(W),oe.shortenLabel?oe.shortenLabel():K&&!xe&&k.whiteSpace!=="nowrap"&&(K<(me.textPxLength||0)||me.element.tagName==="SPAN")?me.css(al(et,{width:`${K}px`,lineClamp:te})):!me.styles.width||et.width||xe||me.css({width:"auto"}),oe.rotation=W.rotation)},this),this.tickRotCorr=m.rotCorr(N.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(c){return c.hasData()})||this.options.showEmpty&&On(this.min)&&On(this.max)}addTitle(c){let m,y=this.chart.renderer,T=this.horiz,E=this.opposite,k=this.options.title,I=this.chart.styledMode;this.axisTitle||((m=k.textAlign)||(m=(T?{low:"left",middle:"center",high:"right"}:{low:E?"right":"left",middle:"center",high:E?"left":"right"})[k.align]),this.axisTitle=y.text(k.text||"",0,0,k.useHTML).attr({zIndex:7,rotation:k.rotation||0,align:m}).addClass("highcharts-axis-title"),I||this.axisTitle.css(ll(k.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),I||k.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[c?"show":"hide"](c)}generateTick(c){let m=this.ticks;m[c]?m[c].addLabel():m[c]=new Fa(this,c)}createGroups(){let{axisParent:c,chart:m,coll:y,options:T}=this,E=m.renderer,k=(I,L,B)=>E.g(I).attr({zIndex:B}).addClass(`highcharts-${y.toLowerCase()}${L} `+(this.isRadial?`highcharts-radial-axis${L} `:"")+(T.className||"")).add(c);this.axisGroup||(this.gridGroup=k("grid","-grid",T.gridZIndex),this.axisGroup=k("axis","",T.zIndex),this.labelGroup=k("axis-labels","-labels",T.labels.zIndex))}getOffset(){let c=this,{chart:m,horiz:y,options:T,side:E,ticks:k,tickPositions:I,coll:L}=c,B=m.inverted&&!c.isZAxis?[1,0,3,2][E]:E,W=c.hasData(),N=T.title,H=T.labels,K=Ui(T.crossing),te=m.axisOffset,ce=m.clipOffset,le=[-1,1,1,-1][E],oe,me=0,xe,et=0,Ge=0,Ze,yt;if(c.showAxis=oe=W||T.showEmpty,c.staggerLines=c.horiz&&H.staggerLines||void 0,c.createGroups(),W||c.isLinked?(I.forEach(function(at){c.generateTick(at)}),c.renderUnsquish(),c.reserveSpaceDefault=E===0||E===2||{1:"left",3:"right"}[E]===c.labelAlign,an(H.reserveSpace,!K&&null,c.labelAlign==="center"||null,c.reserveSpaceDefault)&&I.forEach(function(at){Ge=Math.max(k[at].getLabelSize(),Ge)}),c.staggerLines&&(Ge*=c.staggerLines),c.labelOffset=Ge*(c.opposite?-1:1)):cl(k,function(at,vt){at.destroy(),delete k[vt]}),N!=null&&N.text&&N.enabled!==!1&&(c.addTitle(oe),oe&&!K&&N.reserveSpace!==!1&&(c.titleOffset=me=c.axisTitle.getBBox()[y?"height":"width"],et=On(xe=N.offset)?0:an(N.margin,y?5:10))),c.renderLine(),c.offset=le*an(T.offset,te[E]?te[E]+(T.margin||0):0),c.tickRotCorr=c.tickRotCorr||{x:0,y:0},yt=E===0?-c.labelMetrics().h:E===2?c.tickRotCorr.y:0,Ze=Math.abs(Ge)+et,Ge&&(Ze-=yt,Ze+=le*(y?an(H.y,c.tickRotCorr.y+le*H.distance):an(H.x,le*H.distance))),c.axisTitleMargin=an(xe,Ze),c.getMaxLabelDimensions&&(c.maxLabelDimensions=c.getMaxLabelDimensions(k,I)),L!=="colorAxis"&&ce){let at=this.tickSize("tick");te[E]=Math.max(te[E],(c.axisTitleMargin||0)+me+le*c.offset,Ze,I!=null&&I.length&&at?at[0]+le*c.offset:0);let vt=!c.axisLine||T.offset?0:c.axisLine.strokeWidth()/2;ce[B]=Math.max(ce[B],vt)}is(this,"afterGetOffset")}getLinePath(c){let m=this.chart,y=this.opposite,T=this.offset,E=this.horiz,k=this.left+(y?this.width:0)+T,I=m.chartHeight-this.bottom-(y?this.height:0)+T;return y&&(c*=-1),m.renderer.crispLine([["M",E?this.left:k,E?I:this.top],["L",E?m.chartWidth-this.right:k,E?I:m.chartHeight-this.bottom]],c)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(c){let m=this.horiz,y=this.left,T=this.top,E=this.len,k=this.options.title,I=m?y:T,L=this.opposite,B=this.offset,W=k.x,N=k.y,H=this.chart.renderer.fontMetrics(c),K=c?Math.max(c.getBBox(!1,0).height-H.h-1,0):0,te={low:I+(m?0:E),middle:I+E/2,high:I+(m?E:0)}[k.align],ce=(m?T+this.height:y)+(m?1:-1)*(L?-1:1)*(this.axisTitleMargin||0)+[-K,K,H.f,-K][this.side],le={x:m?te+W:ce+(L?this.width:0)+B+W,y:m?ce+N-(L?this.height:0)+B:te+N};return is(this,"afterGetTitlePosition",{titlePosition:le}),le}renderMinorTick(c,m){let y=this.minorTicks;y[c]||(y[c]=new Fa(this,c,"minor")),m&&y[c].isNew&&y[c].render(null,!0),y[c].render(null,!1,1)}renderTick(c,m,y){var k;let T=this.isLinked,E=this.ticks;(!T||c>=this.min&&c<=this.max||(k=this.grid)!=null&&k.isColumn)&&(E[c]||(E[c]=new Fa(this,c)),y&&E[c].isNew&&E[c].render(m,!0,-1),E[c].render(m))}render(){let c,m,y=this,T=y.chart,E=y.logarithmic,k=T.renderer,I=y.options,L=y.isLinked,B=y.tickPositions,W=y.axisTitle,N=y.ticks,H=y.minorTicks,K=y.alternateBands,te=I.stackLabels,ce=I.alternateGridColor,le=I.crossing,oe=y.tickmarkOffset,me=y.axisLine,xe=y.showAxis,et=Tn(k.globalAnimation);if(y.labelEdge.length=0,y.overlap=!1,[N,H,K].forEach(function(Ge){cl(Ge,function(Ze){Ze.isActive=!1})}),Ui(le)){let Ge=this.isXAxis?T.yAxis[0]:T.xAxis[0],Ze=[1,-1,-1,1][this.side];if(Ge){let yt=Ge.toPixels(le,!0);y.horiz&&(yt=Ge.len-yt),y.offset=Ze*yt}}if(y.hasData()||L){let Ge=y.chart.hasRendered&&y.old&&Ui(y.old.min);y.minorTickInterval&&!y.categories&&y.getMinorTickPositions().forEach(function(Ze){y.renderMinorTick(Ze,Ge)}),B.length&&(B.forEach(function(Ze,yt){y.renderTick(Ze,yt,Ge)}),oe&&(y.min===0||y.single)&&(N[-1]||(N[-1]=new Fa(y,-1,null,!0)),N[-1].render(-1))),ce&&B.forEach(function(Ze,yt){m=B[yt+1]!==void 0?B[yt+1]+oe:y.max-oe,yt%2==0&&Ze<y.max&&m<=y.max+(T.polar?-oe:oe)&&(K[Ze]||(K[Ze]=new ve.PlotLineOrBand(y,{})),c=Ze+oe,K[Ze].options={from:E?E.lin2log(c):c,to:E?E.lin2log(m):m,color:ce,className:"highcharts-alternate-grid"},K[Ze].render(),K[Ze].isActive=!0)}),y._addedPlotLB||(y._addedPlotLB=!0,(I.plotLines||[]).concat(I.plotBands||[]).forEach(function(Ze){y.addPlotBandOrLine(Ze)}))}[N,H,K].forEach(function(Ge){let Ze=[],yt=et.duration;cl(Ge,function(at,vt){at.isActive||(at.render(vt,!1,0),at.isActive=!1,Ze.push(vt))}),Bu(function(){let at=Ze.length;for(;at--;)Ge[Ze[at]]&&!Ge[Ze[at]].isActive&&(Ge[Ze[at]].destroy(),delete Ge[Ze[at]])},Ge!==K&&T.hasRendered&&yt?yt:0)}),me&&(me[me.isPlaced?"animate":"attr"]({d:this.getLinePath(me.strokeWidth())}),me.isPlaced=!0,me[xe?"show":"hide"](xe)),W&&xe&&(W[W.isNew?"attr":"animate"](y.getTitlePosition(W)),W.isNew=!1),te!=null&&te.enabled&&y.stacking&&y.stacking.renderStackTotals(),y.old={len:y.len,max:y.max,min:y.min,transA:y.transA,userMax:y.userMax,userMin:y.userMin},y.isDirty=!1,is(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(c){c.render()})),this.series.forEach(function(c){c.isDirty=!0})}getKeepProps(){return this.keepProps||hl.keepProps}destroy(c){let m=this,y=m.plotLinesAndBands,T=this.eventOptions;if(is(this,"destroy",{keepEvents:c}),c||zu(m),[m.ticks,m.minorTicks,m.alternateBands].forEach(function(E){Ic(E)}),y){let E=y.length;for(;E--;)y[E].destroy()}for(let E in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(k){m[k]&&(m[k]=m[k].destroy())}),m.plotLinesAndBandsGroups)m.plotLinesAndBandsGroups[E]=m.plotLinesAndBandsGroups[E].destroy();cl(m,function(E,k){m.getKeepProps().indexOf(k)===-1&&delete m[k]}),this.eventOptions=T}drawCrosshair(c,m){var N;let y=this.crosshair,T=(y==null?void 0:y.snap)??!0,E=this.chart,k,I,L,B=this.cross,W;if(is(this,"drawCrosshair",{e:c,point:m}),c||(c=(N=this.cross)==null?void 0:N.e),y&&(On(m)||!T)!==!1){if(T?On(m)&&(I=an(this.coll!=="colorAxis"?m.crosshairPos:null,this.isXAxis?m.plotX:this.len-m.plotY)):I=c&&(this.horiz?c.chartX-this.pos:this.len-c.chartY+this.pos),On(I)&&(W={value:m&&(this.isXAxis?m.x:an(m.stackY,m.y)),translatedValue:I},E.polar&&al(W,{isCrosshair:!0,chartX:c==null?void 0:c.chartX,chartY:c==null?void 0:c.chartY,point:m}),k=this.getPlotLinePath(W)||null),!On(k)){this.hideCrosshair();return}L=this.categories&&!this.isRadial,B||(this.cross=B=E.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(L?"category ":"thin ")+(y.className||"")).attr({zIndex:an(y.zIndex,2)}).add(),!E.styledMode&&(B.attr({stroke:y.color||(L?ht.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":an(y.width,1)}).css({"pointer-events":"none"}),y.dashStyle&&B.attr({dashstyle:y.dashStyle}))),B.show().attr({d:k}),L&&!y.width&&B.attr({"stroke-width":this.transA}),this.cross.e=c}else this.hideCrosshair();is(this,"afterDrawCrosshair",{e:c,point:m})}hideCrosshair(){this.cross&&this.cross.hide(),is(this,"afterHideCrosshair")}update(c,m){let y=this.chart;c=ll(this.userOptions,c),this.destroy(!0),this.init(y,c),y.isDirtyBox=!0,an(m,!0)&&y.redraw()}remove(c){let m=this.chart,y=this.coll,T=this.series,E=T.length;for(;E--;)T[E]&&T[E].remove(!1);Ru(m.axes,this),Ru(m[y]||[],this),m.orderItems(y),this.destroy(),m.isDirtyBox=!0,an(c,!0)&&m.redraw()}setTitle(c,m){this.update({title:c},m)}setCategories(c,m){this.update({categories:c},m)}}hl.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"];let{addEvent:Fg,getMagnitude:Zp,normalizeTickInterval:Dc,timeUnits:Oc}=Ee;(function(F){function c(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function m(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new y(this))}F.compose=function(T){return T.keepProps.includes("dateTime")||(T.keepProps.push("dateTime"),T.prototype.getTimeTicks=c,Fg(T,"afterSetType",m)),T};class y{constructor(E){this.axis=E}normalizeTimeTickInterval(E,k){let I=k||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],L=I[I.length-1],B=Oc[L[0]],W=L[1],N;for(N=0;N<I.length&&(B=Oc[(L=I[N])[0]],W=L[1],!I[N+1]||!(E<=(B*W[W.length-1]+Oc[I[N+1][0]])/2));N++);B===Oc.year&&E<5*B&&(W=[1,2,5]);let H=Dc(E/B,W,L[0]==="year"?Math.max(Zp(E/B),1):1);return{unitRange:B,count:H,unitName:L[0]}}getXDateFormat(E,k){let{axis:I}=this,L=I.chart.time;return I.closestPointRange?L.getDateFormat(I.closestPointRange,E,I.options.startOfWeek,k)||L.resolveDTLFormat(k.year).main:L.resolveDTLFormat(k.day).main}}F.Additions=y})(C||(C={}));let uf=C,{addEvent:Fu,normalizeTickInterval:Nu,pick:Ph}=Ee;(function(F){function c(){this.type!=="logarithmic"?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new y(this))}function m(){let T=this.logarithmic;T&&(this.lin2val=function(E){return T.lin2log(E)},this.val2lin=function(E){return T.log2lin(E)})}F.compose=function(T){return T.keepProps.includes("logarithmic")||(T.keepProps.push("logarithmic"),Fu(T,"afterSetType",c),Fu(T,"afterInit",m)),T};class y{constructor(E){this.axis=E}getLogTickPositions(E,k,I,L){let B=this.axis,W=B.len,N=B.options,H=[];if(L||(this.minorAutoInterval=void 0),E>=.5)E=Math.round(E),H=B.getLinearTickPositions(E,k,I);else if(E>=.08){let K,te,ce,le,oe,me,xe,et=Math.floor(k);for(K=E>.3?[1,2,4]:E>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],te=et;te<I+1&&!xe;te++)for(ce=0,le=K.length;ce<le&&!xe;ce++)(oe=this.log2lin(this.lin2log(te)*K[ce]))>k&&(!L||me<=I)&&me!==void 0&&H.push(me),me>I&&(xe=!0),me=oe}else{let K=this.lin2log(k),te=this.lin2log(I),ce=L?B.getMinorTickInterval():N.tickInterval,le=N.tickPixelInterval/(L?5:1),oe=L?W/B.tickPositions.length:W;E=Nu(E=Ph(ce==="auto"?null:ce,this.minorAutoInterval,(te-K)*le/(oe||1))),H=B.getLinearTickPositions(E,K,te).map(this.log2lin),L||(this.minorAutoInterval=E/5)}return L||(B.tickInterval=E),H}lin2log(E){return Math.pow(10,E)}log2lin(E){return Math.log(E)/Math.LN10}}F.Additions=y})(O||(O={}));let Lh=O,{erase:df,extend:Yp,isNumber:Uu}=Ee;(function(F){let c;function m(B){return this.addPlotBandOrLine(B,"plotBands")}function y(B,W){let N=this.userOptions,H=new c(this,B);if(this.visible&&(H=H.render()),H){if(this._addedPlotLB||(this._addedPlotLB=!0,(N.plotLines||[]).concat(N.plotBands||[]).forEach(K=>{this.addPlotBandOrLine(K)})),W){let K=N[W]||[];K.push(B),N[W]=K}this.plotLinesAndBands.push(H)}return H}function T(B){return this.addPlotBandOrLine(B,"plotLines")}function E(B,W,N){N=N||this.options;let H=this.getPlotLinePath({value:W,force:!0,acrossPanes:N.acrossPanes}),K=[],te=this.horiz,ce=!Uu(this.min)||!Uu(this.max)||B<this.min&&W<this.min||B>this.max&&W>this.max,le=this.getPlotLinePath({value:B,force:!0,acrossPanes:N.acrossPanes}),oe,me=1,xe;if(le&&H)for(ce&&(xe=le.toString()===H.toString(),me=0),oe=0;oe<le.length;oe+=2){let et=le[oe],Ge=le[oe+1],Ze=H[oe],yt=H[oe+1];(et[0]==="M"||et[0]==="L")&&(Ge[0]==="M"||Ge[0]==="L")&&(Ze[0]==="M"||Ze[0]==="L")&&(yt[0]==="M"||yt[0]==="L")&&(te&&Ze[1]===et[1]?(Ze[1]+=me,yt[1]+=me):te||Ze[2]!==et[2]||(Ze[2]+=me,yt[2]+=me),K.push(["M",et[1],et[2]],["L",Ge[1],Ge[2]],["L",yt[1],yt[2]],["L",Ze[1],Ze[2]],["Z"])),K.isFlat=xe}return K}function k(B){this.removePlotBandOrLine(B)}function I(B){let W=this.plotLinesAndBands,N=this.options,H=this.userOptions;if(W){let K=W.length;for(;K--;)W[K].id===B&&W[K].destroy();[N.plotLines||[],H.plotLines||[],N.plotBands||[],H.plotBands||[]].forEach(function(te){var ce;for(K=te.length;K--;)((ce=te[K])==null?void 0:ce.id)===B&&df(te,te[K])})}}function L(B){this.removePlotBandOrLine(B)}F.compose=function(B,W){let N=W.prototype;return N.addPlotBand||(c=B,Yp(N,{addPlotBand:m,addPlotLine:T,addPlotBandOrLine:y,getPlotBandPath:E,removePlotBand:k,removePlotLine:L,removePlotBandOrLine:I})),W}})(U||(U={}));let Kp=U,{addEvent:ul,arrayMax:ff,arrayMin:pf,defined:da,destroyObjectProperties:Jp,erase:mf,fireEvent:Qp,merge:gf,objectEach:Sr,pick:Ng}=Ee;class Dh{static compose(c,m){return ul(c,"afterInit",function(){this.labelCollectors.push(()=>{var T;let y=[];for(let E of this.axes)for(let{label:k,options:I}of E.plotLinesAndBands)k&&!((T=I==null?void 0:I.label)!=null&&T.allowOverlap)&&y.push(k);return y})}),Kp.compose(Dh,m)}constructor(c,m){this.axis=c,this.options=m,this.id=m.id}render(){Qp(this,"render");let{axis:c,options:m}=this,{horiz:y,logarithmic:T}=c,{color:E,events:k,zIndex:I=0}=m,{renderer:L,time:B}=c.chart,W={},N=B.parse(m.to),H=B.parse(m.from),K=B.parse(m.value),te=m.borderWidth,ce=m.label,{label:le,svgElem:oe}=this,me=[],xe,et=da(H)&&da(N),Ge=da(K),Ze=!oe,yt={class:"highcharts-plot-"+(et?"band ":"line ")+(m.className||"")},at=et?"bands":"lines";if(!c.chart.styledMode&&(Ge?(yt.stroke=E||"#999999",yt["stroke-width"]=Ng(m.width,1),m.dashStyle&&(yt.dashstyle=m.dashStyle)):et&&(yt.fill=E||"#e6e9ff",te&&(yt.stroke=m.borderColor,yt["stroke-width"]=te))),W.zIndex=I,at+="-"+I,(xe=c.plotLinesAndBandsGroups[at])||(c.plotLinesAndBandsGroups[at]=xe=L.g("plot-"+at).attr(W).add()),oe||(this.svgElem=oe=L.path().attr(yt).add(xe)),da(K))me=c.getPlotLinePath({value:(T==null?void 0:T.log2lin(K))??K,lineWidth:oe.strokeWidth(),acrossPanes:m.acrossPanes});else{if(!(da(H)&&da(N)))return;me=c.getPlotBandPath((T==null?void 0:T.log2lin(H))??H,(T==null?void 0:T.log2lin(N))??N,m)}return!this.eventsAdded&&k&&(Sr(k,(vt,Vt)=>{oe==null||oe.on(Vt,ii=>{k[Vt].apply(this,[ii])})}),this.eventsAdded=!0),(Ze||!oe.d)&&(me!=null&&me.length)?oe.attr({d:me}):oe&&(me?(oe.show(),oe.animate({d:me})):oe.d&&(oe.hide(),le&&(this.label=le=le.destroy()))),ce&&(da(ce.text)||da(ce.formatter))&&(me!=null&&me.length)&&c.width>0&&c.height>0&&!me.isFlat?(ce=gf({align:y&&et?"center":void 0,x:y?!et&&4:10,verticalAlign:!y&&et?"middle":void 0,y:y?et?16:10:et?6:-4,rotation:y&&!et?90:0,...et?{inside:!0}:{}},ce),this.renderLabel(ce,me,et,I)):le&&le.hide(),this}renderLabel(c,m,y,T){var te;let E=this.axis,k=E.chart.renderer,I=c.inside,L=this.label;L||(this.label=L=k.text(this.getLabelText(c),0,0,c.useHTML).attr({align:c.textAlign||c.align,rotation:c.rotation,class:"highcharts-plot-"+(y?"band":"line")+"-label "+(c.className||""),zIndex:T}),E.chart.styledMode||L.css(gf({fontSize:"0.8em",textOverflow:y&&!I?"":"ellipsis"},c.style)),L.add());let B=m.xBounds||[m[0][1],m[1][1],y?m[2][1]:m[0][1]],W=m.yBounds||[m[0][2],m[1][2],y?m[2][2]:m[0][2]],N=pf(B),H=pf(W),K=ff(B)-N;L.align(c,!1,{x:N,y:H,width:K,height:ff(W)-H}),L.alignAttr.y-=k.fontMetrics(L).b,(!L.alignValue||L.alignValue==="left"||da(I))&&L.css({width:(((te=c.style)==null?void 0:te.width)||(y&&I?K:L.rotation===90?E.height-(L.alignAttr.y-E.top):(c.clip?E.width:E.chart.chartWidth)-(L.alignAttr.x-E.left)))+"px"}),L.show(!0)}getLabelText(c){return da(c.formatter)?c.formatter.call(this):c.text}destroy(){mf(this.axis.plotLinesAndBands,this),delete this.axis,Jp(this)}}let{animObject:Ug}=Ds,{format:em}=wr,{composed:go,dateFormats:tm,doc:im,isSafari:jo}=ve,{distribute:fa}=sl,{addEvent:Ul,clamp:Ua,css:bi,discardElement:_f,extend:yf,fireEvent:Vl,getAlignFactor:dl,isArray:pi,isNumber:xf,isObject:Vg,isString:Vu,merge:vf,pick:jl,pushUnique:nm,splat:bf,syncTimeout:jg}=Ee;class Oh{constructor(c,m,y){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=c,this.init(c,m),this.pointer=y}bodyFormatter(c){return c.map(m=>{let y=m.series.tooltipOptions,T=m.formatPrefix||"point";return(y[T+"Formatter"]||m.tooltipFormatter).call(m,y[T+"Format"]||"")})}cleanSplit(c){this.chart.series.forEach(function(m){let y=m==null?void 0:m.tt;y&&(!y.isActive||c?m.tt=y.destroy():y.isActive=!1)})}defaultFormatter(c){let m,y=this.points||bf(this);return(m=(m=[c.headerFooterFormatter(y[0])]).concat(c.bodyFormatter(y))).push(c.headerFooterFormatter(y[0],!0)),m}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),_f(this.container)),Ee.clearTimeout(this.hideTimer)}getAnchor(c,m){var B;let y,{chart:T,pointer:E}=this,k=T.inverted,I=T.plotTop,L=T.plotLeft;if(c=bf(c),(B=c[0].series)!=null&&B.yAxis&&!c[0].series.yAxis.options.reversedStacks&&(c=c.slice().reverse()),this.followPointer&&m)m.chartX===void 0&&(m=E.normalize(m)),y=[m.chartX-L,m.chartY-I];else if(c[0].tooltipPos)y=c[0].tooltipPos;else{let W=0,N=0;c.forEach(function(H){let K=H.pos(!0);K&&(W+=K[0],N+=K[1])}),W/=c.length,N/=c.length,this.shared&&c.length>1&&m&&(k?W=m.chartX:N=m.chartY),y=[W-L,N-I]}return y.map(Math.round)}getClassName(c,m,y){let T=this.options,E=c.series,k=E.options;return[T.className,"highcharts-label",y&&"highcharts-tooltip-header",m?"highcharts-tooltip-box":"highcharts-tooltip",!y&&"highcharts-color-"+jl(c.colorIndex,E.colorIndex),k==null?void 0:k.className].filter(Vu).join(" ")}getLabel({anchorX:c,anchorY:m}={anchorX:0,anchorY:0}){let y=this,T=this.chart.styledMode,E=this.options,k=this.split&&this.allowShared,I=this.container,L=this.chart.renderer;if(this.label){let B=!this.label.hasClass("highcharts-label");(!k&&B||k&&!B)&&this.destroy()}if(!this.label){if(this.outside){let B=this.chart,W=B.options.chart.style,N=zo.getRendererType();this.container=I=ve.doc.createElement("div"),I.className="highcharts-tooltip-container "+(B.renderTo.className.match(/(highcharts[a-zA-Z0-9-]+)\s?/gm)||""),bi(I,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,((W==null?void 0:W.zIndex)||0)+3)}),this.renderer=L=new N(I,0,0,W,void 0,void 0,L.styledMode)}if(k?this.label=L.g("tooltip"):(this.label=L.label("",c,m,E.shape||"callout",void 0,void 0,E.useHTML,void 0,"tooltip").attr({padding:E.padding,r:E.borderRadius}),T||this.label.attr({fill:E.backgroundColor,"stroke-width":E.borderWidth||0}).css(E.style).css({pointerEvents:E.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),y.outside){let B=this.label;[B.xSetter,B.ySetter].forEach((W,N)=>{B[N?"ySetter":"xSetter"]=H=>{W.call(B,y.distance),B[N?"y":"x"]=H,I&&(I.style[N?"top":"left"]=`${H}px`)}})}this.label.attr({zIndex:8}).shadow(E.shadow??!E.fixed).add()}return I&&!I.parentElement&&ve.doc.body.appendChild(I),this.label}getPlayingField(){let{body:c,documentElement:m}=im,{chart:y,distance:T,outside:E}=this;return{width:E?Math.max(c.scrollWidth,m.scrollWidth,c.offsetWidth,m.offsetWidth,m.clientWidth)-2*T-2:y.chartWidth,height:E?Math.max(c.scrollHeight,m.scrollHeight,c.offsetHeight,m.offsetHeight,m.clientHeight):y.chartHeight}}getPosition(c,m,y){var vi,Wi;let{distance:T,chart:E,outside:k,pointer:I}=this,{inverted:L,plotLeft:B,plotTop:W,polar:N}=E,{plotX:H=0,plotY:K=0}=y,te={},ce=L&&y.h||0,{height:le,width:oe}=this.getPlayingField(),me=I.getChartPosition(),xe=Ti=>Ti*me.scaleX,et=Ti=>Ti*me.scaleY,Ge=Ti=>{let Gi=Ti==="x";return[Ti,Gi?oe:le,Gi?c:m].concat(k?[Gi?xe(c):et(m),Gi?me.left-T+xe(H+B):me.top-T+et(K+W),0,Gi?oe:le]:[Gi?c:m,Gi?H+B:K+W,Gi?B:W,Gi?B+E.plotWidth:W+E.plotHeight])},Ze=Ge("y"),yt=Ge("x"),at,vt=!!y.negative;!N&&((Wi=(vi=E.hoverSeries)==null?void 0:vi.yAxis)!=null&&Wi.reversed)&&(vt=!vt);let Vt=!this.followPointer&&jl(y.ttBelow,!N&&!L===vt),ii=function(Ti,Gi,xn,hn,En,zr,vn){let Wn=k?Ti==="y"?et(T):xe(T):T,Ki=(xn-hn)/2,xi=hn<En-T,Bs=En+T+hn<Gi,Gn=En-Wn-xn+Ki,rs=En+Wn-Ki;if(Vt&&Bs)te[Ti]=rs;else if(!Vt&&xi)te[Ti]=Gn;else if(xi)te[Ti]=Math.min(vn-hn,Gn-ce<0?Gn:Gn-ce);else{if(!Bs)return te[Ti]=0,!1;te[Ti]=Math.max(zr,rs+ce+xn>Gi?rs:rs+ce)}},li=function(Ti,Gi,xn,hn,En){if(En<T||En>Gi-T)return!1;En<xn/2?te[Ti]=1:En>Gi-hn/2?te[Ti]=Gi-hn-2:te[Ti]=En-xn/2},$t=function(Ti){[Ze,yt]=[yt,Ze],at=Ti},gi=()=>{ii.apply(0,Ze)!==!1?li.apply(0,yt)!==!1||at||($t(!0),gi()):at?te.x=te.y=0:($t(!0),gi())};return(L&&!N||this.len>1)&&$t(),gi(),te}getFixedPosition(c,m,y){var H;let T=y.series,{chart:E,options:k,split:I}=this,L=k.position,B=L.relativeTo,W=k.shared||(H=T==null?void 0:T.yAxis)!=null&&H.isRadial&&(B==="pane"||!B)?"plotBox":B,N=W==="chart"?E.renderer:E[W]||E.getClipBox(T,!0);return{x:N.x+(N.width-c)*dl(L.align)+L.x,y:N.y+(N.height-m)*dl(L.verticalAlign)+(!I&&L.y||0)}}hide(c){let m=this;Ee.clearTimeout(this.hideTimer),c=jl(c,this.options.hideDelay),this.isHidden||(this.hideTimer=jg(function(){let y=m.getLabel();m.getLabel().animate({opacity:0},{duration:c&&150,complete:()=>{y.hide(),m.container&&m.container.remove()}}),m.isHidden=!0},c))}init(c,m){this.chart=c,this.options=m,this.crosshairs=[],this.isHidden=!0,this.split=m.split&&!c.inverted&&!c.polar,this.shared=m.shared||this.split,this.outside=jl(m.outside,!!(c.scrollablePixelsX||c.scrollablePixelsY))}shouldStickOnContact(c){return!!(!this.followPointer&&this.options.stickOnContact&&(!c||this.pointer.inClass(c.target,"highcharts-tooltip")))}move(c,m,y,T){let{followPointer:E,options:k}=this,I=Ug(!E&&!this.isHidden&&!k.fixed&&k.animation),L=E||(this.len||0)>1,B={x:c,y:m};L?B.anchorX=B.anchorY=NaN:(B.anchorX=y,B.anchorY=T),I.step=()=>this.drawTracker(),this.getLabel().animate(B,I)}refresh(c,m){let{chart:y,options:T,pointer:E,shared:k}=this,I=bf(c),L=I[0],B=T.format,W=T.formatter||this.defaultFormatter,N=y.styledMode,H=this.allowShared;if(!T.enabled||!L.series)return;Ee.clearTimeout(this.hideTimer),this.allowShared=!(!pi(c)&&c.series&&c.series.noSharedTooltip),H=H&&!this.allowShared,this.followPointer=!this.split&&L.series.tooltipOptions.followPointer;let K=this.getAnchor(c,m),te=K[0],ce=K[1];k&&this.allowShared&&(E.applyInactiveState(I),I.forEach(me=>me.setState("hover")),L.points=I),this.len=I.length;let le=Vu(B)?em(B,L,y):W.call(L,this);L.points=void 0;let oe=L.series;if(this.distance=jl(oe.tooltipOptions.distance,16),le===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(le,I);else{let me=te,xe=ce;if(m&&E.isDirectTouch&&(me=m.chartX-y.plotLeft,xe=m.chartY-y.plotTop),y.polar||oe.options.clip===!1||I.some(et=>E.isDirectTouch||et.series.shouldShowTooltip(me,xe))){let et=this.getLabel(H&&this.tt||{});(!T.style.width||N)&&et.css({width:(this.outside?this.getPlayingField():y.spacingBox).width+"px"}),et.attr({class:this.getClassName(L),text:le&&le.join?le.join(""):le}),this.outside&&et.attr({x:Ua(et.x||0,0,this.getPlayingField().width-(et.width||0)-1)}),N||et.attr({stroke:T.borderColor||L.color||oe.color||"#666666"}),this.updatePosition({plotX:te,plotY:ce,negative:L.negative,ttBelow:L.ttBelow,series:oe,h:K[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}Vl(this,"refresh")}renderSplit(c,m){var En,zr;let y=this,{chart:T,chart:{chartWidth:E,chartHeight:k,plotHeight:I,plotLeft:L,plotTop:B,scrollablePixelsY:W=0,scrollablePixelsX:N,styledMode:H},distance:K,options:te,options:{fixed:ce,position:le,positioner:oe},pointer:me}=y,{scrollLeft:xe=0,scrollTop:et=0}=((En=T.scrollablePlotArea)==null?void 0:En.scrollingContainer)||{},Ge=y.outside&&typeof N!="number"?im.documentElement.getBoundingClientRect():{left:xe,right:xe+E},Ze=y.getLabel(),yt=this.renderer||T.renderer,at=!!((zr=T.xAxis[0])!=null&&zr.opposite),{left:vt,top:Vt}=me.getChartPosition(),ii=oe||ce,li=B+et,$t=0,gi=I-W,vi=function(vn,Wn,Ki,xi=[0,0],Bs=!0){let Gn,rs;if(Ki.isHeader)rs=at?0:gi,Gn=Ua(xi[0]-vn/2,Ge.left,Ge.right-vn-(y.outside?vt:0));else if(ce&&Ki){let ds=y.getFixedPosition(vn,Wn,Ki);Gn=ds.x,rs=ds.y-li}else rs=xi[1]-li,Gn=Ua(Gn=Bs?xi[0]-vn-K:xi[0]+K,Bs?Gn:Ge.left,Ge.right);return{x:Gn,y:rs}};Vu(c)&&(c=[!1,c]);let Wi=c.slice(0,m.length+1).reduce(function(vn,Wn,Ki){if(Wn!==!1&&Wn!==""){let xi=m[Ki-1]||{isHeader:!0,plotX:m[0].plotX,plotY:I,series:{}},Bs=xi.isHeader,Gn=Bs?y:xi.series,rs=Gn.tt=function(ro,er,tp){let Hc=ro,{isHeader:$h,series:ip}=er,Ya=ip.tooltipOptions||te;if(!Hc){let od={padding:Ya.padding,r:Ya.borderRadius};H||(od.fill=Ya.backgroundColor,od["stroke-width"]=Ya.borderWidth??(ce&&!$h?0:1)),Hc=yt.label("",0,0,Ya[$h?"headerShape":"shape"]||(ce&&!$h?"rect":"callout"),void 0,void 0,Ya.useHTML).addClass(y.getClassName(er,!0,$h)).attr(od).add(Ze)}return Hc.isActive=!0,Hc.attr({text:tp}),H||Hc.css(Ya.style).attr({stroke:Ya.borderColor||er.color||ip.color||"#333333"}),Hc}(Gn.tt,xi,Wn.toString()),ds=rs.getBBox(),wo=ds.width+rs.strokeWidth();Bs&&($t=ds.height,gi+=$t,at&&(li-=$t));let{anchorX:Xo,anchorY:xa}=function(ro){let er,tp,{isHeader:Hc,plotX:$h=0,plotY:ip=0,series:Ya}=ro;if(Hc)er=Math.max(L+$h,L),tp=B+I/2;else{let{xAxis:od,yAxis:np}=Ya;er=od.pos+Ua($h,-K,od.len+K),Ya.shouldShowTooltip(0,np.pos-B+ip,{ignoreX:!0})&&(tp=np.pos+ip)}return{anchorX:er=Ua(er,Ge.left-K,Ge.right+K),anchorY:tp}}(xi);if(typeof xa=="number"){let ro=ds.height+1,er=(oe||vi).call(y,wo,ro,xi,[Xo,xa]);vn.push({align:ii?0:void 0,anchorX:Xo,anchorY:xa,boxWidth:wo,point:xi,rank:jl(er.rank,+!!Bs),size:ro,target:er.y,tt:rs,x:er.x})}else rs.isActive=!1}return vn},[]);!ii&&Wi.some(vn=>{let{outside:Wn}=y,Ki=(Wn?vt:0)+vn.anchorX;return Ki<Ge.left&&Ki+vn.boxWidth<Ge.right||Ki<vt-Ge.left+vn.boxWidth&&Ge.right-Ki>Ki})&&(Wi=Wi.map(vn=>{let{x:Wn,y:Ki}=vi.call(this,vn.boxWidth,vn.size,vn.point,[vn.anchorX,vn.anchorY],!1);return yf(vn,{target:Ki,x:Wn})})),y.cleanSplit(),fa(Wi,gi);let Ti={left:vt,right:vt};Wi.forEach(function(vn){let{x:Wn,boxWidth:Ki,isHeader:xi}=vn;!xi&&(y.outside&&vt+Wn<Ti.left&&(Ti.left=vt+Wn),!xi&&y.outside&&Ti.left+Ki>Ti.right&&(Ti.right=vt+Wn))}),Wi.forEach(function(vn){let{x:Wn,anchorX:Ki,anchorY:xi,pos:Bs,point:{isHeader:Gn}}=vn,rs={visibility:Bs===void 0?"hidden":"inherit",x:Wn,y:(Bs||0)+li+(ce&&le.y||0),anchorX:Ki,anchorY:xi};if(y.outside&&Wn<Ki){let ds=vt-Ti.left;ds>0&&(Gn||(rs.x=Wn+ds,rs.anchorX=Ki+ds),Gn&&(rs.x=(Ti.right-Ti.left)/2,rs.anchorX=Ki+ds))}vn.tt.attr(rs)});let{container:Gi,outside:xn,renderer:hn}=y;if(xn&&Gi&&hn){let{width:vn,height:Wn,x:Ki,y:xi}=Ze.getBBox();hn.setSize(vn+Ki,Wn+xi,!1),Gi.style.left=Ti.left+"px",Gi.style.top=Vt+"px"}jo&&Ze.attr({opacity:Ze.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let c=this.chart,m=this.label,y=this.shared?c.hoverPoints:c.hoverPoint;if(!m||!y)return;let T={x:0,y:0,width:0,height:0},E=this.getAnchor(y),k=m.getBBox();E[0]+=c.plotLeft-(m.translateX||0),E[1]+=c.plotTop-(m.translateY||0),T.x=Math.min(0,E[0]),T.y=Math.min(0,E[1]),T.width=E[0]<0?Math.max(Math.abs(E[0]),k.width-E[0]):Math.max(Math.abs(E[0]),k.width),T.height=E[1]<0?Math.max(Math.abs(E[1]),k.height-Math.abs(E[1])):Math.max(Math.abs(E[1]),k.height),this.tracker?this.tracker.attr(T):(this.tracker=m.renderer.rect(T).addClass("highcharts-tracker").add(m),c.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(c){return c.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}headerFooterFormatter(c,m){let y=c.series,T=y.tooltipOptions,E=y.xAxis,k=E==null?void 0:E.dateTime,I={isFooter:m,point:c},L=T.xDateFormat||"",B=T[m?"footerFormat":"headerFormat"];return Vl(this,"headerFormatter",I,function(W){if(k&&!L&&xf(c.key)&&(L=k.getXDateFormat(c.key,T.dateTimeLabelFormats)),k&&L){if(Vg(L)){let N=L;tm[0]=H=>y.chart.time.dateFormat(N,H),L="%0"}(c.tooltipDateKeys||["key"]).forEach(N=>{B=B.replace(RegExp("point\\."+N+"([ \\)}])"),`(point.${N}:${L})$1`)})}y.chart.styledMode&&(B=this.styledModeFormat(B)),W.text=em(B,c,this.chart)}),I.text||""}update(c){this.destroy(),this.init(this.chart,vf(!0,this.options,c))}updatePosition(c){var Ge;let{chart:m,container:y,distance:T,options:E,pointer:k,renderer:I}=this,{height:L=0,width:B=0}=this.getLabel(),{fixed:W,positioner:N}=E,{left:H,top:K,scaleX:te,scaleY:ce}=k.getChartPosition(),le=(N||W&&this.getFixedPosition||this.getPosition).call(this,B,L,c),oe=ve.doc,me=(c.plotX||0)+m.plotLeft,xe=(c.plotY||0)+m.plotTop,et;if(I&&y){if(N||W){let{scrollLeft:Ze=0,scrollTop:yt=0}=((Ge=m.scrollablePlotArea)==null?void 0:Ge.scrollingContainer)||{};le.x+=Ze+H-T,le.y+=yt+K-T}et=(E.borderWidth||0)+2*T+2,I.setSize(Ua(B+et,0,oe.documentElement.clientWidth)-1,L+et,!1),(te!==1||ce!==1)&&(bi(y,{transform:`scale(${te}, ${ce})`}),me*=te,xe*=ce),me+=H-le.x,xe+=K-le.y}this.move(Math.round(le.x),Math.round(le.y||0),me,xe)}}(function(F){F.compose=function(c){nm(go,"Core.Tooltip")&&Ul(c,"afterInit",function(){let m=this.chart;m.options.tooltip&&(m.tooltip=new F(m,m.options.tooltip,this))})}})(Oh||(Oh={}));let ju=Oh,{animObject:wf}=Ds,{defaultOptions:Rc}=Fe,{format:_}=wr,{addEvent:a,crisp:f,erase:v,extend:S,fireEvent:A,getNestedProperty:R,isArray:z,isFunction:j,isNumber:Z,isObject:Y,merge:ne,pick:ge,syncTimeout:Te,removeEvent:Ae,uniqueKey:Se}=Ee;class ke{animateBeforeDestroy(){let c=this,m={x:c.startXPos,opacity:0},y=c.getGraphicalProps();y.singular.forEach(function(T){c[T]=c[T].animate(T==="dataLabel"?{x:c[T].startXPos,y:c[T].startYPos,opacity:0}:m)}),y.plural.forEach(function(T){c[T].forEach(function(E){E.element&&E.animate(S({x:c.startXPos},E.startYPos?{x:E.startXPos,y:E.startYPos}:{}))})})}applyOptions(c,m){let y=this.series,T=y.options.pointValKey||y.pointValKey;return S(this,c=ke.prototype.optionsToObject.call(this,c)),this.options=this.options?S(this.options,c):c,c.group&&delete this.group,c.dataLabels&&delete this.dataLabels,T&&(this.y=ke.prototype.getNestedProperty.call(this,T)),this.selected&&(this.state="select"),"name"in this&&m===void 0&&y.xAxis&&y.xAxis.hasNames&&(this.x=y.xAxis.nameToX(this)),this.x===void 0&&y?this.x=m??y.autoIncrement():Z(c.x)&&y.options.relativeXValue?this.x=y.autoIncrement(c.x):typeof this.x=="string"&&(m??(m=y.chart.time.parse(this.x)),Z(m)&&(this.x=m)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let c=this,m=c.series,y=m.chart,T=m.options.dataSorting,E=y.hoverPoints,k=wf(c.series.chart.renderer.globalAnimation),I=()=>{for(let L in(c.graphic||c.graphics||c.dataLabel||c.dataLabels)&&(Ae(c),c.destroyElements()),c)delete c[L]};c.legendItem&&y.legend.destroyItem(c),E&&(c.setState(),v(E,c),E.length||(y.hoverPoints=null)),c===y.hoverPoint&&c.onMouseOut(),T!=null&&T.enabled?(this.animateBeforeDestroy(),Te(I,k.duration)):I(),y.pointCount--}this.destroyed=!0}destroyElements(c){let m=this,y=m.getGraphicalProps(c);y.singular.forEach(function(T){m[T]=m[T].destroy()}),y.plural.forEach(function(T){m[T].forEach(function(E){E!=null&&E.element&&E.destroy()}),delete m[T]})}firePointEvent(c,m,y){let T=this,E=this.series.options;T.manageEvent(c),c==="click"&&E.allowPointSelect&&(y=function(k){!T.destroyed&&T.select&&T.select(null,k.ctrlKey||k.metaKey||k.shiftKey)}),A(T,c,m,y)}getClassName(){var c;return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+((c=this.zone)!=null&&c.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(c){let m,y,T=this,E=[],k={singular:[],plural:[]};for((c=c||{graphic:1,dataLabel:1}).graphic&&E.push("graphic","connector"),c.dataLabel&&E.push("dataLabel","dataLabelPath","dataLabelUpper"),y=E.length;y--;)T[m=E[y]]&&k.singular.push(m);return["graphic","dataLabel"].forEach(function(I){let L=I+"s";c[I]&&T[L]&&k.plural.push(L)}),k}getNestedProperty(c){return c?c.indexOf("custom.")===0?R(c,this.options):this[c]:void 0}getZone(){let c=this.series,m=c.zones,y=c.zoneAxis||"y",T,E=0;for(T=m[0];this[y]>=T.value;)T=m[++E];return this.nonZonedColor||(this.nonZonedColor=this.color),T!=null&&T.color&&!this.options.color?this.color=T.color:this.color=this.nonZonedColor,T}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(c,m,y){this.formatPrefix="point",this.visible=!0,this.point=this,this.series=c,this.applyOptions(m,y),this.id??(this.id=Se()),this.resolveColor(),this.dataLabelOnNull??(this.dataLabelOnNull=c.options.nullInteraction),c.chart.pointCount++,A(this,"afterInit")}isValid(){return(Z(this.x)||this.x instanceof Date)&&Z(this.y)}optionsToObject(c){var W;let m=this.series,y=m.options.keys,T=y||m.pointArrayMap||["y"],E=T.length,k={},I,L=0,B=0;if(Z(c)||c===null)k[T[0]]=c;else if(z(c))for(!y&&c.length>E&&((I=typeof c[0])=="string"?(W=m.xAxis)!=null&&W.dateTime?k.x=m.chart.time.parse(c[0]):k.name=c[0]:I==="number"&&(k.x=c[0]),L++);B<E;)y&&c[L]===void 0||(T[B].indexOf(".")>0?ke.prototype.setNestedProperty(k,c[L],T[B]):k[T[B]]=c[L]),L++,B++;else typeof c=="object"&&(k=c,c.dataLabels&&(m.hasDataLabels=()=>!0),c.marker&&(m._hasPointMarkers=!0));return k}pos(c,m=this.plotY){if(!this.destroyed){let{plotX:y,series:T}=this,{chart:E,xAxis:k,yAxis:I}=T,L=0,B=0;if(Z(y)&&Z(m))return c&&(L=k?k.pos:E.plotLeft,B=I?I.pos:E.plotTop),E.inverted&&k&&I?[I.len-m+B,k.len-y+L]:[y+L,m+B]}}resolveColor(){let c=this.series,m=c.chart.options.chart,y=c.chart.styledMode,T,E,k=m.colorCount,I;delete this.nonZonedColor,c.options.colorByPoint?(y||(T=(E=c.options.colors||c.chart.options.colors)[c.colorCounter],k=E.length),I=c.colorCounter,c.colorCounter++,c.colorCounter===k&&(c.colorCounter=0)):(y||(T=c.color),I=c.colorIndex),this.colorIndex=ge(this.options.colorIndex,I),this.color=ge(this.options.color,T)}setNestedProperty(c,m,y){return y.split(".").reduce(function(T,E,k,I){let L=I.length-1===k;return T[E]=L?m:Y(T[E],!0)?T[E]:{},T[E]},c),c}shouldDraw(){return!this.isNull}tooltipFormatter(c){var L;let{chart:m,pointArrayMap:y=["y"],tooltipOptions:T}=this.series,{valueDecimals:E="",valuePrefix:k="",valueSuffix:I=""}=T;return m.styledMode&&(c=((L=m.tooltip)==null?void 0:L.styledModeFormat(c))||c),y.forEach(B=>{B="{point."+B,(k||I)&&(c=c.replace(RegExp(B+"}","g"),k+B+"}"+I)),c=c.replace(RegExp(B+"}","g"),B+":,."+E+"f}")}),_(c,this,m)}update(c,m,y,T){let E,k=this,I=k.series,L=k.graphic,B=I.chart,W=I.options;function N(){k.applyOptions(c);let H=L&&k.hasMockGraphic,K=k.y===null?!H:H;L&&K&&(k.graphic=L.destroy(),delete k.hasMockGraphic),Y(c,!0)&&(L!=null&&L.element&&c&&c.marker&&c.marker.symbol!==void 0&&(k.graphic=L.destroy()),c!=null&&c.dataLabels&&k.dataLabel&&(k.dataLabel=k.dataLabel.destroy())),E=k.index;let te={};for(let ce of I.dataColumnKeys())te[ce]=k[ce];I.dataTable.setRow(te,E),W.data[E]=Y(W.data[E],!0)||Y(c,!0)?k.options:ge(c,W.data[E]),I.isDirty=I.isDirtyData=!0,!I.fixedBox&&I.hasCartesianSeries&&(B.isDirtyBox=!0),W.legendType==="point"&&(B.isDirtyLegend=!0),m&&B.redraw(y)}m=ge(m,!0),T===!1?N():k.firePointEvent("update",{options:c},N)}remove(c,m){this.series.removePoint(this.series.data.indexOf(this),c,m)}select(c,m){let y=this,T=y.series,E=T.chart;c=ge(c,!y.selected),this.selectedStaging=c,y.firePointEvent(c?"select":"unselect",{accumulate:m},function(){y.selected=y.options.selected=c,T.options.data[T.data.indexOf(y)]=y.options,y.setState(c&&"select"),m||E.getSelectedPoints().forEach(function(k){let I=k.series;k.selected&&k!==y&&(k.selected=k.options.selected=!1,I.options.data[I.data.indexOf(k)]=k.options,k.setState(E.hoverPoints&&I.options.inactiveOtherPoints?"inactive":""),k.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(c){let{inverted:m,pointer:y}=this.series.chart;y&&(c=c?y.normalize(c):y.getChartCoordinatesFromPoint(this,m),y.runPointActions(c,this))}onMouseOut(){let c=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(c.hoverPoints||[]).forEach(function(m){m.setState()}),c.hoverPoints=c.hoverPoint=null}manageEvent(c){var T,E,k,I,L,B,W;let m=ne(this.series.options.point,this.options),y=(T=m.events)==null?void 0:T[c];j(y)&&(!((E=this.hcEvents)!=null&&E[c])||((I=(k=this.hcEvents)==null?void 0:k[c])==null?void 0:I.map(N=>N.fn).indexOf(y))===-1)?((L=this.importedUserEvent)==null||L.call(this),this.importedUserEvent=a(this,c,y),this.hcEvents&&(this.hcEvents[c].userEvent=!0)):this.importedUserEvent&&!y&&((B=this.hcEvents)!=null&&B[c])&&((W=this.hcEvents)!=null&&W[c].userEvent)&&(Ae(this,c),delete this.hcEvents[c],Object.keys(this.hcEvents)||delete this.importedUserEvent)}setState(c,m){var Ze,yt;let y=this.series,T=this.state,E=y.options.states[c||"normal"]||{},k=Rc.plotOptions[y.type].marker&&y.options.marker,I=k&&k.enabled===!1,L=((Ze=k==null?void 0:k.states)==null?void 0:Ze[c||"normal"])||{},B=L.enabled===!1,W=this.marker||{},N=y.chart,H=k&&y.markerAttribs,K=y.halo,te,ce,le,oe=y.stateMarkerGraphic,me;if((c=c||"")===this.state&&!m||this.selected&&c!=="select"||E.enabled===!1||c&&(B||I&&L.enabled===!1)||c&&W.states&&W.states[c]&&W.states[c].enabled===!1)return;if(this.state=c,H&&(te=y.markerAttribs(this,c)),this.graphic&&!this.hasMockGraphic){if(T&&this.graphic.removeClass("highcharts-point-"+T),c&&this.graphic.addClass("highcharts-point-"+c),!N.styledMode){ce=y.pointAttribs(this,c),le=ge(N.options.chart.animation,E.animation);let at=ce.opacity;y.options.inactiveOtherPoints&&Z(at)&&(this.dataLabels||[]).forEach(function(vt){vt&&!vt.hasClass("highcharts-data-label-hidden")&&(vt.animate({opacity:at},le),vt.connector&&vt.connector.animate({opacity:at},le))}),this.graphic.animate(ce,le)}te&&this.graphic.animate(te,ge(N.options.chart.animation,L.animation,k.animation)),oe&&oe.hide()}else c&&L&&(me=W.symbol||y.symbol,oe&&oe.currentSymbol!==me&&(oe=oe.destroy()),te&&(oe?oe[m?"animate":"attr"]({x:te.x,y:te.y}):me&&(y.stateMarkerGraphic=oe=N.renderer.symbol(me,te.x,te.y,te.width,te.height,ne(k,L)).add(y.markerGroup),oe.currentSymbol=me)),!N.styledMode&&oe&&this.state!=="inactive"&&oe.attr(y.pointAttribs(this,c))),oe&&(oe[c&&this.isInside?"show":"hide"](),oe.element.point=this,oe.addClass(this.getClassName(),!0));let xe=E.halo,et=this.graphic||oe,Ge=(et==null?void 0:et.visibility)||"inherit";xe!=null&&xe.size&&et&&Ge!=="hidden"&&!this.isCluster?(K||(y.halo=K=N.renderer.path().add(et.parentGroup)),K.show()[m?"animate":"attr"]({d:this.haloPath(xe.size)}),K.attr({class:"highcharts-halo highcharts-color-"+ge(this.colorIndex,y.colorIndex)+(this.className?" "+this.className:""),visibility:Ge,zIndex:-1}),K.point=this,N.styledMode||K.attr(S({fill:this.color||y.color,"fill-opacity":xe.opacity},Yn.filterUserAttributes(xe.attributes||{})))):(yt=K==null?void 0:K.point)!=null&&yt.haloPath&&!K.point.destroyed&&K.animate({d:K.point.haloPath(0)},null,K.hide),A(this,"afterSetState",{state:c})}haloPath(c){let m=this.pos();return m?this.series.chart.renderer.symbols.circle(f(m[0],1)-c,m[1]-c,2*c,2*c):[]}}let re=ke,{parse:we}=ht,{charts:De,composed:Re,isTouchDevice:Ye}=ve,{addEvent:We,attr:Ke,css:lt,extend:ot,find:_t,fireEvent:Wt,isNumber:pt,isObject:Lt,objectEach:wt,offset:qt,pick:dt,pushUnique:Ot,splat:Xt}=Ee;class kt{applyInactiveState(c=[]){let m=[];c.forEach(y=>{let T=y.series;m.push(T),T.linkedParent&&m.push(T.linkedParent),T.linkedSeries&&m.push.apply(m,T.linkedSeries),T.navigatorSeries&&m.push(T.navigatorSeries),T.boosted&&T.markerGroup&&m.push.apply(m,this.chart.series.filter(E=>E.markerGroup===T.markerGroup))}),this.chart.series.forEach(y=>{m.indexOf(y)===-1?y.setState("inactive",!0):y.options.inactiveOtherPoints&&y.setAllPointsToState("inactive")})}destroy(){let c=this;this.eventsToUnbind.forEach(m=>m()),this.eventsToUnbind=[],!ve.chartCount&&(kt.unbindDocumentMouseUp.forEach(m=>m.unbind()),kt.unbindDocumentMouseUp.length=0,kt.unbindDocumentTouchEnd&&(kt.unbindDocumentTouchEnd=kt.unbindDocumentTouchEnd())),clearInterval(c.tooltipTimeout),wt(c,function(m,y){c[y]=void 0})}getSelectionMarkerAttrs(c,m){let y={args:{chartX:c,chartY:m},attrs:{},shapeType:"rect"};return Wt(this,"getSelectionMarkerAttrs",y,T=>{let E,{chart:k,zoomHor:I,zoomVert:L}=this,{mouseDownX:B=0,mouseDownY:W=0}=k,N=T.attrs;N.x=k.plotLeft,N.y=k.plotTop,N.width=I?1:k.plotWidth,N.height=L?1:k.plotHeight,I&&(N.width=Math.max(1,Math.abs(E=c-B)),N.x=(E>0?0:E)+B),L&&(N.height=Math.max(1,Math.abs(E=m-W)),N.y=(E>0?0:E)+W)}),y}drag(c){let{chart:m}=this,{mouseDownX:y=0,mouseDownY:T=0}=m,{panning:E,panKey:k,selectionMarkerFill:I}=m.options.chart,L=m.plotLeft,B=m.plotTop,W=m.plotWidth,N=m.plotHeight,H=Lt(E)?E.enabled:E,K=k&&c[`${k}Key`],te=c.chartX,ce=c.chartY,le,oe=this.selectionMarker;if((!oe||!oe.touch)&&(te<L?te=L:te>L+W&&(te=L+W),ce<B?ce=B:ce>B+N&&(ce=B+N),this.hasDragged=Math.sqrt(Math.pow(y-te,2)+Math.pow(T-ce,2)),this.hasDragged>10)){le=m.isInsidePlot(y-L,T-B,{visiblePlotOnly:!0});let{shapeType:me,attrs:xe}=this.getSelectionMarkerAttrs(te,ce);(m.hasCartesianSeries||m.mapView)&&this.hasZoom&&le&&!K&&!oe&&(this.selectionMarker=oe=m.renderer[me](),oe.attr({class:"highcharts-selection-marker",zIndex:7}).add(),m.styledMode||oe.attr({fill:I||we("#334eff").setOpacity(.25).get()})),oe&&oe.attr(xe),le&&!oe&&H&&m.pan(c,E)}}dragStart(c){let m=this.chart;m.mouseIsDown=c.type,m.cancelClick=!1,m.mouseDownX=c.chartX,m.mouseDownY=c.chartY}getSelectionBox(c){let m={args:{marker:c},result:c.getBBox()};return Wt(this,"getSelectionBox",m),m.result}drop(c){let m,{chart:y,selectionMarker:T}=this;for(let E of y.axes)E.isPanning&&(E.isPanning=!1,(E.options.startOnTick||E.options.endOnTick||E.series.some(k=>k.boosted))&&(E.forceRedraw=!0,E.setExtremes(E.userMin,E.userMax,!1),m=!0));if(m&&y.redraw(),T&&c){if(this.hasDragged){let E=this.getSelectionBox(T);y.transform({axes:y.axes.filter(k=>k.zoomEnabled&&(k.coll==="xAxis"&&this.zoomX||k.coll==="yAxis"&&this.zoomY)),selection:{originalEvent:c,xAxis:[],yAxis:[],...E},from:E})}pt(y.index)&&(this.selectionMarker=T.destroy())}y&&pt(y.index)&&(lt(y.container,{cursor:y._cursor}),y.cancelClick=this.hasDragged>10,y.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(c,m,y){let T;return c.forEach(function(E){let k=!(E.noSharedTooltip&&m)&&0>E.options.findNearestPointBy.indexOf("y"),I=E.searchPoint(y,k);Lt(I,!0)&&I.series&&(!Lt(T,!0)||function(L,B){var K,te;let W=L.distX-B.distX,N=L.dist-B.dist,H=((K=B.series.group)==null?void 0:K.zIndex)-((te=L.series.group)==null?void 0:te.zIndex);return W!==0&&m?W:N!==0?N:H!==0?H:L.series.index>B.series.index?-1:1}(T,I)>0)&&(T=I)}),T}getChartCoordinatesFromPoint(c,m){let{xAxis:y,yAxis:T}=c.series,E=c.shapeArgs;if(y&&T){let k=c.clientX??c.plotX??0,I=c.plotY||0;return c.isNode&&E&&pt(E.x)&&pt(E.y)&&(k=E.x,I=E.y),m?{chartX:T.len+T.pos-I,chartY:y.len+y.pos-k}:{chartX:k+y.pos,chartY:I+T.pos}}if(E!=null&&E.x&&E.y)return{chartX:E.x,chartY:E.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:c}=this.chart,m=qt(c);this.chartPosition={left:m.left,top:m.top,scaleX:1,scaleY:1};let{offsetHeight:y,offsetWidth:T}=c;return T>2&&y>2&&(this.chartPosition.scaleX=m.width/T,this.chartPosition.scaleY=m.height/y),this.chartPosition}getCoordinates(c){let m={xAxis:[],yAxis:[]};for(let y of this.chart.axes)m[y.isXAxis?"xAxis":"yAxis"].push({axis:y,value:y.toValue(c[y.horiz?"chartX":"chartY"])});return m}getHoverData(c,m,y,T,E,k){let I=[],L=function(K){return K.visible&&!(!E&&K.directTouch)&&dt(K.options.enableMouseTracking,!0)},B=m,W,N={chartX:k?k.chartX:void 0,chartY:k?k.chartY:void 0,shared:E};Wt(this,"beforeGetHoverData",N),W=B&&!B.stickyTracking?[B]:y.filter(K=>K.stickyTracking&&(N.filter||L)(K));let H=T&&c||!k?c:this.findNearestKDPoint(W,E,k);return B=H==null?void 0:H.series,H&&(E&&!B.noSharedTooltip?(W=y.filter(function(K){return N.filter?N.filter(K):L(K)&&!K.noSharedTooltip})).forEach(function(K){var le;let te=(le=K.options)==null?void 0:le.nullInteraction,ce=_t(K.points,function(oe){return oe.x===H.x&&(!oe.isNull||!!te)});Lt(ce)&&(K.boosted&&K.boost&&(ce=K.boost.getPoint(ce)),I.push(ce))}):I.push(H)),Wt(this,"afterGetHoverData",N={hoverPoint:H}),{hoverPoint:N.hoverPoint,hoverSeries:B,hoverPoints:I}}getPointFromEvent(c){let m=c.target,y;for(;m&&!y;)y=m.point,m=m.parentNode;return y}onTrackerMouseOut(c){let m=this.chart,y=c.relatedTarget,T=m.hoverSeries;this.isDirectTouch=!1,!T||!y||T.stickyTracking||this.inClass(y,"highcharts-tooltip")||this.inClass(y,"highcharts-series-"+T.index)&&this.inClass(y,"highcharts-tracker")||T.onMouseOut()}inClass(c,m){let y=c,T;for(;y;){if(T=Ke(y,"class")){if(T.indexOf(m)!==-1)return!0;if(T.indexOf("highcharts-container")!==-1)return!1}y=y.parentElement}}constructor(c,m){var y;this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=m,this.chart=c,this.runChartClick=!!((y=m.chart.events)!=null&&y.click),this.pinchDown=[],this.setDOMEvents(),Wt(this,"afterInit")}normalize(c,m){let y=c.touches,T=y?y.length?y.item(0):dt(y.changedTouches,c.changedTouches)[0]:c;m||(m=this.getChartPosition());let E=T.pageX-m.left,k=T.pageY-m.top;return ot(c,{chartX:Math.round(E/=m.scaleX),chartY:Math.round(k/=m.scaleY)})}onContainerClick(c){let m=this.chart,y=m.hoverPoint,T=this.normalize(c),E=m.plotLeft,k=m.plotTop;!m.cancelClick&&(y&&this.inClass(T.target,"highcharts-tracker")?(Wt(y.series,"click",ot(T,{point:y})),m.hoverPoint&&y.firePointEvent("click",T)):(ot(T,this.getCoordinates(T)),m.isInsidePlot(T.chartX-E,T.chartY-k,{visiblePlotOnly:!0})&&Wt(m,"click",T)))}onContainerMouseDown(c){var y;let m=(1&(c.buttons||c.button))==1;c=this.normalize(c),ve.isFirefox&&c.button!==0&&this.onContainerMouseMove(c),(c.button===void 0||m)&&(this.zoomOption(c),m&&((y=c.preventDefault)==null||y.call(c)),this.dragStart(c))}onContainerMouseLeave(c){let{pointer:m}=De[dt(kt.hoverChartIndex,-1)]||{};c=this.normalize(c),this.onContainerMouseMove(c),m&&!this.inClass(c.relatedTarget,"highcharts-tooltip")&&(m.reset(),m.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(c){let m=this.chart,y=m.tooltip,T=this.normalize(c);this.setHoverChartIndex(c),(m.mouseIsDown==="mousedown"||this.touchSelect(T))&&this.drag(T),!m.openMenu&&(this.inClass(T.target,"highcharts-tracker")||m.isInsidePlot(T.chartX-m.plotLeft,T.chartY-m.plotTop,{visiblePlotOnly:!0}))&&!(y!=null&&y.shouldStickOnContact(T))&&(this.inClass(T.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(T))}onDocumentTouchEnd(c){this.onDocumentMouseUp(c)}onContainerTouchMove(c){this.touchSelect(c)?this.onContainerMouseMove(c):this.touch(c)}onContainerTouchStart(c){this.touchSelect(c)?this.onContainerMouseDown(c):(this.zoomOption(c),this.touch(c,!0))}onDocumentMouseMove(c){let m=this.chart,y=m.tooltip,T=this.chartPosition,E=this.normalize(c,T);!T||m.isInsidePlot(E.chartX-m.plotLeft,E.chartY-m.plotTop,{visiblePlotOnly:!0})||y!=null&&y.shouldStickOnContact(E)||E.target!==m.container.ownerDocument&&this.inClass(E.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(c){var m,y;(y=(m=De[dt(kt.hoverChartIndex,-1)])==null?void 0:m.pointer)==null||y.drop(c)}pinch(c){let m=this,{chart:y,hasZoom:T,lastTouches:E}=m,k=[].map.call(c.touches||[],N=>m.normalize(N)),I=k.length,L=I===1&&(m.inClass(c.target,"highcharts-tracker")&&y.runTrackerClick||m.runChartClick),B=y.tooltip,W=I===1&&dt(B==null?void 0:B.options.followTouchMove,!0);I>1?m.initiated=!0:W&&(m.initiated=!1),T&&m.initiated&&!L&&c.cancelable!==!1&&c.preventDefault(),c.type==="touchstart"?(m.pinchDown=k,m.res=!0,y.mouseDownX=c.chartX):W?this.runPointActions(m.normalize(c)):E&&(Wt(y,"touchpan",{originalEvent:c,touches:k},()=>{let N=H=>{let K=H[0],te=H[1]||K;return{x:K.chartX,y:K.chartY,width:te.chartX-K.chartX,height:te.chartY-K.chartY}};y.transform({axes:y.axes.filter(H=>H.zoomEnabled&&(this.zoomHor&&H.horiz||this.zoomVert&&!H.horiz)),to:N(k),from:N(E),trigger:c.type})}),m.res&&(m.res=!1,this.reset(!1,0))),m.lastTouches=k}reset(c,m){let y=this.chart,T=y.hoverSeries,E=y.hoverPoint,k=y.hoverPoints,I=y.tooltip,L=I!=null&&I.shared?k:E;c&&L&&Xt(L).forEach(function(B){B.series.isCartesian&&B.plotX===void 0&&(c=!1)}),c?I&&L&&Xt(L).length&&(I.refresh(L),I.shared&&k?k.forEach(function(B){B.setState(B.state,!0),B.series.isCartesian&&(B.series.xAxis.crosshair&&B.series.xAxis.drawCrosshair(null,B),B.series.yAxis.crosshair&&B.series.yAxis.drawCrosshair(null,B))}):E&&(E.setState(E.state,!0),y.axes.forEach(function(B){B.crosshair&&E.series[B.coll]===B&&B.drawCrosshair(null,E)}))):(E&&E.onMouseOut(),k&&k.forEach(function(B){B.setState()}),T&&T.onMouseOut(),I&&I.hide(m),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),y.axes.forEach(function(B){B.hideCrosshair()}),y.hoverPoints=y.hoverPoint=void 0)}runPointActions(c,m,y){var ce;let T=this.chart,E=T.series,k=(ce=T.tooltip)!=null&&ce.options.enabled?T.tooltip:void 0,I=!!k&&k.shared,L=m||T.hoverPoint,B=(L==null?void 0:L.series)||T.hoverSeries,W=(!c||c.type!=="touchmove")&&(!!m||(B==null?void 0:B.directTouch)&&this.isDirectTouch),N=this.getHoverData(L,B,E,W,I,c);L=N.hoverPoint,B=N.hoverSeries;let H=N.hoverPoints,K=(B==null?void 0:B.tooltipOptions.followPointer)&&!B.tooltipOptions.split,te=I&&B&&!B.noSharedTooltip;if(L&&(y||L!==T.hoverPoint||k!=null&&k.isHidden)){if((T.hoverPoints||[]).forEach(function(le){H.indexOf(le)===-1&&le.setState()}),T.hoverSeries!==B&&B.onMouseOver(),this.applyInactiveState(H),(H||[]).forEach(function(le){le.setState("hover")}),T.hoverPoint&&T.hoverPoint.firePointEvent("mouseOut"),!L.series)return;T.hoverPoints=H,T.hoverPoint=L,L.firePointEvent("mouseOver",void 0,()=>{k&&L&&k.refresh(te?H:L,c)})}else if(K&&k&&!k.isHidden){let le=k.getAnchor([{}],c);T.isInsidePlot(le[0],le[1],{visiblePlotOnly:!0})&&k.updatePosition({plotX:le[0],plotY:le[1]})}this.unDocMouseMove||(this.unDocMouseMove=We(T.container.ownerDocument,"mousemove",le=>{var oe,me;return(me=(oe=De[kt.hoverChartIndex??-1])==null?void 0:oe.pointer)==null?void 0:me.onDocumentMouseMove(le)}),this.eventsToUnbind.push(this.unDocMouseMove)),T.axes.forEach(function(le){var xe;let oe,me=((xe=le.crosshair)==null?void 0:xe.snap)??!0;!me||(oe=T.hoverPoint)&&oe.series[le.coll]===le||(oe=_t(H,et=>{var Ge;return((Ge=et.series)==null?void 0:Ge[le.coll])===le})),oe||!me?le.drawCrosshair(c,oe):le.hideCrosshair()})}setDOMEvents(){let c=this.chart.container,m=c.ownerDocument;c.onmousedown=this.onContainerMouseDown.bind(this),c.onmousemove=this.onContainerMouseMove.bind(this),c.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(We(c,"mouseenter",this.onContainerMouseEnter.bind(this)),We(c,"mouseleave",this.onContainerMouseLeave.bind(this))),kt.unbindDocumentMouseUp.some(T=>T.doc===m)||kt.unbindDocumentMouseUp.push({doc:m,unbind:We(m,"mouseup",this.onDocumentMouseUp.bind(this))});let y=this.chart.renderTo.parentElement;for(;y&&y.tagName!=="BODY";)this.eventsToUnbind.push(We(y,"scroll",()=>{delete this.chartPosition})),y=y.parentElement;this.eventsToUnbind.push(We(c,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),We(c,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),kt.unbindDocumentTouchEnd||(kt.unbindDocumentTouchEnd=We(m,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),We(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){var E,k;if(!Ye)return;let c=this.pointerCaptureEventsToUnbind,m=this.chart,y=m.container,T=dt((E=m.options.tooltip)==null?void 0:E.followTouchMove,!0)&&m.series.some(I=>I.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&T?(c.push(We(y,"pointerdown",I=>{var L,B;(L=I.target)!=null&&L.hasPointerCapture(I.pointerId)&&((B=I.target)==null||B.releasePointerCapture(I.pointerId))}),We(y,"pointermove",I=>{var L,B;(B=(L=m.pointer)==null?void 0:L.getPointFromEvent(I))==null||B.onMouseOver(I)})),m.styledMode||lt(y,{"touch-action":"none"}),y.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!T&&(c.forEach(I=>I()),c.length=0,m.styledMode||lt(y,{"touch-action":dt((k=m.options.chart.style)==null?void 0:k["touch-action"],"manipulation")}),y.className=y.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(c){var T;let m=this.chart,y=ve.charts[dt(kt.hoverChartIndex,-1)];if(y&&y!==m){let E={relatedTarget:m.container};c&&!(c!=null&&c.relatedTarget)&&Object.assign({},c,E),(T=y.pointer)==null||T.onContainerMouseLeave(c||E)}y!=null&&y.mouseIsDown||(kt.hoverChartIndex=m.index)}touch(c,m){let y,{chart:T,pinchDown:E=[]}=this;this.setHoverChartIndex(),(c=this.normalize(c)).touches.length===1?T.isInsidePlot(c.chartX-T.plotLeft,c.chartY-T.plotTop,{visiblePlotOnly:!0})&&!T.openMenu?(m&&this.runPointActions(c),c.type==="touchmove"&&(y=!!E[0]&&Math.pow(E[0].chartX-c.chartX,2)+Math.pow(E[0].chartY-c.chartY,2)>=16),dt(y,!0)&&this.pinch(c)):m&&this.reset():c.touches.length===2&&this.pinch(c)}touchSelect(c){return!!(this.chart.zooming.singleTouch&&c.touches&&c.touches.length===1)}zoomOption(c){let m=this.chart,y=m.inverted,T=m.zooming.type||"",E,k;/touch/.test(c.type)&&(T=dt(m.zooming.pinchType,T)),this.zoomX=E=/x/.test(T),this.zoomY=k=/y/.test(T),this.zoomHor=E&&!y||k&&y,this.zoomVert=k&&!y||E&&y,this.hasZoom=E||k}}kt.unbindDocumentMouseUp=[],function(F){F.compose=function(c){Ot(Re,"Core.Pointer")&&We(c,"beforeRender",function(){this.pointer=new F(this,this.options)})}}(kt||(kt={}));let Jt=kt;(function(F){F.setLength=function(c,m,y){return Array.isArray(c)?(c.length=m,c):c[y?"subarray":"slice"](0,m)},F.splice=function(c,m,y,T,E=[]){if(Array.isArray(c))return Array.isArray(E)||(E=Array.from(E)),{removed:c.splice(m,y,...E),array:c};let k=Object.getPrototypeOf(c).constructor,I=c[T?"subarray":"slice"](m,m+y),L=new k(c.length-y+E.length);return L.set(c.subarray(0,m),0),L.set(E,m),L.set(c.subarray(m+y),m+E.length),{removed:I,array:L}}})($||($={}));let{setLength:Pi,splice:$i}=$,{fireEvent:wi,objectEach:Li,uniqueKey:Zi}=Ee,Yi=class{constructor(F={}){this.autoId=!F.id,this.columns={},this.id=F.id||Zi(),this.modified=this,this.rowCount=0,this.versionTag=Zi();let c=0;Li(F.columns||{},(m,y)=>{this.columns[y]=m.slice(),c=Math.max(c,m.length)}),this.applyRowCount(c)}applyRowCount(F){this.rowCount=F,Li(this.columns,(c,m)=>{c.length!==F&&(this.columns[m]=Pi(c,F))})}deleteRows(F,c=1){if(c>0&&F<this.rowCount){let m=0;Li(this.columns,(y,T)=>{this.columns[T]=$i(y,F,c).array,m=y.length}),this.rowCount=m}wi(this,"afterDeleteRows",{rowIndex:F,rowCount:c}),this.versionTag=Zi()}getColumn(F,c){return this.columns[F]}getColumns(F,c){return(F||Object.keys(this.columns)).reduce((m,y)=>(m[y]=this.columns[y],m),{})}getRow(F,c){return(c||Object.keys(this.columns)).map(m=>{var y;return(y=this.columns[m])==null?void 0:y[F]})}setColumn(F,c=[],m=0,y){this.setColumns({[F]:c},m,y)}setColumns(F,c,m){let y=this.rowCount;Li(F,(T,E)=>{this.columns[E]=T.slice(),y=T.length}),this.applyRowCount(y),m!=null&&m.silent||(wi(this,"afterSetColumns"),this.versionTag=Zi())}setRow(F,c=this.rowCount,m,y){let{columns:T}=this,E=m?this.rowCount+1:c+1;Li(F,(k,I)=>{let L=T[I]||(y==null?void 0:y.addColumns)!==!1&&Array(E);L&&(m?L=$i(L,c,0,!0,[k]).array:L[c]=k,T[I]=L)}),E>this.rowCount&&this.applyRowCount(E),y!=null&&y.silent||(wi(this,"afterSetRows"),this.versionTag=Zi())}},{extend:Ci,merge:Rn,pick:Un}=Ee;(function(F){function c(m,y,T){var et,Ge;let E=this.legendItem=this.legendItem||{},{chart:k,options:I}=this,{baseline:L=0,symbolWidth:B,symbolHeight:W}=m,N=this.symbol||"circle",H=W/2,K=k.renderer,te=E.group,ce=L-Math.round((((et=m.fontMetrics)==null?void 0:et.b)||W)*(T?.4:.3)),le={},oe,me=I.marker,xe=0;if(k.styledMode||(le["stroke-width"]=Math.min(I.lineWidth||0,24),I.dashStyle?le.dashstyle=I.dashStyle:I.linecap==="square"||(le["stroke-linecap"]="round")),E.line=K.path().addClass("highcharts-graph").attr(le).add(te),T&&(E.area=K.path().addClass("highcharts-area").add(te)),le["stroke-linecap"]&&(xe=Math.min(E.line.strokeWidth(),B)/2),B){let Ze=[["M",xe,ce],["L",B-xe,ce]];E.line.attr({d:Ze}),(Ge=E.area)==null||Ge.attr({d:[...Ze,["L",B-xe,L],["L",xe,L]]})}if(me&&me.enabled!==!1&&B){let Ze=Math.min(Un(me.radius,H),H);N.indexOf("url")===0&&(me=Rn(me,{width:W,height:W}),Ze=0),E.symbol=oe=K.symbol(N,B/2-Ze,ce-Ze,2*Ze,2*Ze,Ci({context:"legend"},me)).addClass("highcharts-point").add(te),oe.isMarker=!0}}F.areaMarker=function(m,y){c.call(this,m,y,!0)},F.lineMarker=c,F.rectangle=function(m,y){let T=y.legendItem||{},E=m.options,k=m.symbolHeight,I=E.squareSymbol,L=I?k:m.symbolWidth;T.symbol=this.chart.renderer.rect(I?(m.symbolWidth-k)/2:0,m.baseline-k+1,L,k,Un(m.options.symbolRadius,k/2)).addClass("highcharts-point").attr({zIndex:3}).add(T.group)}})(q||(q={}));let Vn=q,{defaultOptions:jn}=Fe,{extend:Mr,extendClass:ur,merge:_o}=Ee;(function(F){function c(m,y){let T=jn.plotOptions||{},E=y.defaultOptions,k=y.prototype;return k.type=m,k.pointClass||(k.pointClass=re),!F.seriesTypes[m]&&(E&&(T[m]=E),F.seriesTypes[m]=y,!0)}F.seriesTypes=ve.seriesTypes,F.registerSeriesType=c,F.seriesType=function(m,y,T,E,k){let I=jn.plotOptions||{};if(y=y||"",I[m]=_o(I[y],T),delete F.seriesTypes[m],c(m,ur(F.seriesTypes[y]||function(){},E)),F.seriesTypes[m].prototype.type=m,k){class L extends re{}Mr(L.prototype,k),F.seriesTypes[m].prototype.pointClass=L}return F.seriesTypes[m]}})(ee||(ee={}));let Bn=ee,{animObject:ns,setAnimation:Xn}=Ds,{defaultOptions:yn}=Fe,{registerEventOptions:Ws}=Eh,{svg:Rr,win:ss}=ve,{seriesTypes:Qs}=Bn,{format:$u}=wr,{arrayMax:Va,arrayMin:zc,clamp:pa,correctFloat:ja,crisp:$l,defined:Is,destroyObjectProperties:Rh,diffObjects:Tf,erase:$g,error:Ef,extend:Wu,find:Wg,fireEvent:Ts,getClosestDistance:qy,getNestedProperty:sm,insertItem:Sf,isArray:fl,isNumber:Js,isString:Xy,merge:Gu,objectEach:Gg,pick:Rs,removeEvent:sb,syncTimeout:rm}=Ee;class no{constructor(){this.zoneAxis="y"}init(c,m){var L,B,W;let y;Ts(this,"init",{options:m}),this.dataTable??(this.dataTable=new Yi);let T=c.series;this.eventsToUnbind=[],this.chart=c,this.options=this.setOptions(m);let E=this.options,k=E.visible!==!1;this.linkedSeries=[],this.bindAxes(),Wu(this,{name:E.name,state:"",visible:k,selected:E.selected===!0}),Ws(this,E);let I=E.events;(I!=null&&I.click||(B=(L=E.point)==null?void 0:L.events)!=null&&B.click||E.allowPointSelect)&&(c.runTrackerClick=!0),this.getColor(),this.getSymbol(),this.isCartesian&&(c.hasCartesianSeries=!0),T.length&&(y=T[T.length-1]),this._i=Rs(y==null?void 0:y._i,-1)+1,this.opacity=this.options.opacity,c.orderItems("series",Sf(this,T)),(W=E.dataSorting)!=null&&W.enabled?this.setDataSortingOptions():this.points||this.data||this.setData(E.data,!1),Ts(this,"afterInit")}is(c){return Qs[c]&&this instanceof Qs[c]}bindAxes(){let c,m=this,y=m.options,T=m.chart;Ts(this,"bindAxes",null,function(){(m.axisTypes||[]).forEach(function(E){(T[E]||[]).forEach(function(k){c=k.options,(Rs(y[E],0)===k.index||y[E]!==void 0&&y[E]===c.id)&&(Sf(m,k.series),m[E]=k,k.isDirty=!0)}),m[E]||m.optionalAxis===E||Ef(18,!0,T)})}),Ts(this,"afterBindAxes")}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.dataTable.rowCount>0}hasMarkerChanged(c,m){let y=c.marker,T=m.marker||{};return y&&(T.enabled&&!y.enabled||T.symbol!==y.symbol||T.height!==y.height||T.width!==y.width)}autoIncrement(c){let m,y=this.options,{pointIntervalUnit:T,relativeXValue:E}=this.options,k=this.chart.time,I=this.xIncrement??k.parse(y.pointStart)??0;if(this.pointInterval=m=Rs(this.pointInterval,y.pointInterval,1),E&&Js(c)&&(m*=c),T){let L=k.toParts(I);T==="day"?L[2]+=m:T==="month"?L[1]+=m:T==="year"&&(L[0]+=m),m=k.makeTime.apply(k,L)-I}return E&&Js(c)?I+m:(this.xIncrement=I+m,I)}setDataSortingOptions(){let c=this.options;Wu(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),Is(c.pointRange)||(c.pointRange=1)}setOptions(c){var le,oe;let m,y=this.chart,T=y.options.plotOptions,E=y.userOptions||{},k=Gu(c),I=y.styledMode,L={plotOptions:T,userOptions:k};Ts(this,"setOptions",L);let B=L.plotOptions[this.type],W=E.plotOptions||{},N=W.series||{},H=yn.plotOptions[this.type]||{},K=W[this.type]||{};B.dataLabels=this.mergeArrays(H.dataLabels,B.dataLabels),this.userOptions=L.userOptions;let te=Gu(B,T.series,K,k);this.tooltipOptions=Gu(yn.tooltip,(le=yn.plotOptions.series)==null?void 0:le.tooltip,H==null?void 0:H.tooltip,y.userOptions.tooltip,(oe=W.series)==null?void 0:oe.tooltip,K.tooltip,k.tooltip),this.stickyTracking=Rs(k.stickyTracking,K.stickyTracking,N.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||te.stickyTracking),B.marker===null&&delete te.marker,this.zoneAxis=te.zoneAxis||"y";let ce=this.zones=(te.zones||[]).map(me=>({...me}));return(te.negativeColor||te.negativeFillColor)&&!te.zones&&(m={value:te[this.zoneAxis+"Threshold"]||te.threshold||0,className:"highcharts-negative"},I||(m.color=te.negativeColor,m.fillColor=te.negativeFillColor),ce.push(m)),ce.length&&Is(ce[ce.length-1].value)&&ce.push(I?{}:{color:this.color,fillColor:this.fillColor}),Ts(this,"afterSetOptions",{options:te}),te}getName(){return this.options.name??$u(this.chart.options.lang.seriesName,this,this.chart)}getCyclic(c,m,y){let T,E,k=this.chart,I=`${c}Index`,L=`${c}Counter`,B=(y==null?void 0:y.length)||k.options.chart.colorCount;!m&&(Is(E=Rs(c==="color"?this.options.colorIndex:void 0,this[I]))?T=E:(k.series.length||(k[L]=0),T=k[L]%B,k[L]+=1),y&&(m=y[T])),T!==void 0&&(this[I]=T),this[c]=m}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||yn.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let c=this.options.marker;this.getCyclic("symbol",c.symbol,this.chart.options.symbols)}getColumn(c,m){return(m?this.dataTable.modified:this.dataTable).getColumn(c,!0)||[]}findPointIndex(c,m){var N;let y,T,E,{id:k,x:I}=c,L=this.points,B=this.options.dataSorting,W=this.cropStart||0;if(k){let H=this.chart.get(k);H instanceof re&&(y=H)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let H=K=>!K.touched&&K.index===c.index;if(B!=null&&B.matchByName?H=K=>!K.touched&&K.name===c.name:this.options.relativeXValue&&(H=K=>!K.touched&&K.options.x===c.x),!(y=Wg(L,H)))return}return y&&(E=y==null?void 0:y.index)!==void 0&&(T=!0),E===void 0&&Js(I)&&(E=this.getColumn("x").indexOf(I,m)),E!==-1&&E!==void 0&&this.cropped&&(E=E>=W?E-W:E),!T&&Js(E)&&((N=L[E])!=null&&N.touched)&&(E=void 0),E}updateData(c,m){var ce;let{options:y,requireSorting:T}=this,E=y.dataSorting,k=this.points,I=[],L=c.length===k.length,B,W,N,H,K=!0;if(this.xIncrement=null,c.forEach((le,oe)=>{var Ze;let me,xe=Is(le)&&this.pointClass.prototype.optionsToObject.call({series:this},le)||{},{id:et,x:Ge}=xe;et||Js(Ge)?((me=this.findPointIndex(xe,H))===-1||me===void 0?I.push(le):k[me]&&le!==((Ze=y.data)==null?void 0:Ze[me])?(k[me].update(le,!1,void 0,!1),k[me].touched=!0,T&&(H=me+1)):k[me]&&(k[me].touched=!0),(!L||oe!==me||E!=null&&E.enabled||this.hasDerivedData)&&(B=!0)):I.push(le)},this),B)for(W=k.length;W--;)(N=k[W])&&!N.touched&&((ce=N.remove)==null||ce.call(N,!1,m));else L&&!(E!=null&&E.enabled)?(c.forEach((le,oe)=>{le===k[oe].y||k[oe].destroyed||k[oe].update(le,!1,void 0,!1)}),I.length=0):K=!1;if(k.forEach(le=>{le&&(le.touched=!1)}),!K)return!1;I.forEach(le=>{this.addPoint(le,!1,void 0,void 0,!1)},this);let te=this.getColumn("x");return this.xIncrement===null&&te.length&&(this.xIncrement=Va(te),this.autoIncrement()),!0}dataColumnKeys(){return["x",...this.pointArrayMap||["y"]]}setData(c,m=!0,y,T){var yt,at;let E=this.points,k=(E==null?void 0:E.length)||0,I=this.options,L=this.chart,B=I.dataSorting,W=this.xAxis,N=I.turboThreshold,H=this.dataTable,K=this.dataColumnKeys(),te=this.pointValKey||"y",ce=(this.pointArrayMap||[]).length,le=I.keys,oe,me,xe=0,et=1,Ge;L.options.chart.allowMutatingData||(I.data&&delete this.options.data,this.userOptions.data&&delete this.userOptions.data,Ge=Gu(!0,c));let Ze=(c=Ge||c||[]).length;if(B!=null&&B.enabled&&(c=this.sortData(c)),L.options.chart.allowMutatingData&&T!==!1&&Ze&&k&&!this.cropped&&!this.hasGroupedData&&this.visible&&!this.boosted&&(me=this.updateData(c,y)),!me){this.xIncrement=null,this.colorCounter=0;let vt=N&&Ze>N;if(vt){let Vt=this.getFirstValidPoint(c),ii=this.getFirstValidPoint(c,Ze-1,-1),li=$t=>!!(fl($t)&&(le||Js($t[0])));if(Js(Vt)&&Js(ii)){let $t=[],gi=[];for(let vi of c)$t.push(this.autoIncrement()),gi.push(vi);H.setColumns({x:$t,[te]:gi})}else if(li(Vt)&&li(ii))if(ce){let $t=+(Vt.length===ce),gi=Array(K.length).fill(0).map(()=>[]);for(let vi of c){$t&&gi[0].push(this.autoIncrement());for(let Wi=$t;Wi<=ce;Wi++)(yt=gi[Wi])==null||yt.push(vi[Wi-$t])}H.setColumns(K.reduce((vi,Wi,Ti)=>(vi[Wi]=gi[Ti],vi),{}))}else{le&&(xe=le.indexOf("x"),et=le.indexOf("y"),xe=xe>=0?xe:0,et=et>=0?et:1),Vt.length===1&&(et=0);let $t=[],gi=[];if(xe===et)for(let vi of c)$t.push(this.autoIncrement()),gi.push(vi[et]);else for(let vi of c)$t.push(vi[xe]),gi.push(vi[et]);H.setColumns({x:$t,[te]:gi})}else vt=!1}if(!vt){let Vt=K.reduce((ii,li)=>(ii[li]=[],ii),{});for(oe=0;oe<Ze;oe++){let ii=this.pointClass.prototype.applyOptions.apply({series:this},[c[oe]]);for(let li of K)Vt[li][oe]=ii[li]}H.setColumns(Vt)}for(Xy(this.getColumn("y")[0])&&Ef(14,!0,L),this.data=[],this.options.data=this.userOptions.data=c,oe=k;oe--;)(at=E[oe])==null||at.destroy();W&&(W.minRange=W.userMinRange),this.isDirty=L.isDirtyBox=!0,this.isDirtyData=!!E,y=!1}I.legendType==="point"&&(this.processData(),this.generatePoints()),m&&L.redraw(y)}sortData(c){let m=this,y=m.options.dataSorting.sortKey||"y",T=function(E,k){return Is(k)&&E.pointClass.prototype.optionsToObject.call({series:E},k)||{}};return c.forEach(function(E,k){c[k]=T(m,E),c[k].index=k},this),c.concat().sort((E,k)=>{let I=sm(y,E),L=sm(y,k);return L<I?-1:+(L>I)}).forEach(function(E,k){E.x=k},this),m.linkedSeries&&m.linkedSeries.forEach(function(E){var L;let k=E.options,I=k.data;!((L=k.dataSorting)!=null&&L.enabled)&&I&&(I.forEach(function(B,W){I[W]=T(E,B),c[W]&&(I[W].x=c[W].x,I[W].index=W)}),E.setData(I,!1))}),c}getProcessedData(c){let m=this,{dataTable:y,isCartesian:T,options:E,xAxis:k}=m,I=E.cropThreshold,L=c||m.getExtremesFromAll,B=k==null?void 0:k.logarithmic,W=y.rowCount,N,H,K=0,te,ce,le,oe=m.getColumn("x"),me=y,xe=!1;return k&&(ce=(te=k.getExtremes()).min,le=te.max,xe=!!(k.categories&&!k.names.length),T&&m.sorted&&!L&&(!I||W>I||m.forceCrop)&&(oe[W-1]<ce||oe[0]>le?me=new Yi:m.getColumn(m.pointValKey||"y").length&&(oe[0]<ce||oe[W-1]>le)&&(me=(N=this.cropData(y,ce,le)).modified,K=N.start,H=!0))),oe=me.getColumn("x")||[],{modified:me,cropped:H,cropStart:K,closestPointRange:qy([B?oe.map(B.log2lin):oe],()=>m.requireSorting&&!xe&&Ef(15,!1,m.chart))}}processData(c){let m=this.xAxis,y=this.dataTable;if(this.isCartesian&&!this.isDirty&&!m.isDirty&&!this.yAxis.isDirty&&!c)return!1;let T=this.getProcessedData();y.modified=T.modified,this.cropped=T.cropped,this.cropStart=T.cropStart,this.closestPointRange=this.basePointRange=T.closestPointRange,Ts(this,"afterProcessData")}cropData(c,m,y){let T=c.getColumn("x",!0)||[],E=T.length,k={},I,L,B=0,W=E;for(I=0;I<E;I++)if(T[I]>=m){B=Math.max(0,I-1);break}for(L=I;L<E;L++)if(T[L]>y){W=L+1;break}for(let N of this.dataColumnKeys()){let H=c.getColumn(N,!0);H&&(k[N]=H.slice(B,W))}return{modified:new Yi({columns:k}),start:B,end:W}}generatePoints(){var Ge,Ze,yt;let c=this.options,m=this.processedData||c.data,y=this.dataTable.modified,T=this.getColumn("x",!0),E=this.pointClass,k=y.rowCount,I=this.cropStart||0,L=this.hasGroupedData,B=c.keys,W=[],N=(Ge=c.dataGrouping)!=null&&Ge.groupAll?I:0,H=(Ze=this.xAxis)==null?void 0:Ze.categories,K=this.pointArrayMap||["y"],te=this.dataColumnKeys(),ce,le,oe,me,xe=this.data,et;if(!xe&&!L){let at=[];at.length=(m==null?void 0:m.length)||0,xe=this.data=at}for(B&&L&&(this.options.keys=!1),me=0;me<k;me++)le=I+me,L?((oe=new E(this,y.getRow(me,te)||[])).dataGroup=this.groupMap[N+me],(yt=oe.dataGroup)!=null&&yt.options&&(oe.options=oe.dataGroup.options,Wu(oe,oe.dataGroup.options),delete oe.dataLabels)):(oe=xe[le],et=m?m[le]:y.getRow(me,K),oe||et===void 0||(xe[le]=oe=new E(this,et,T[me]))),oe&&(oe.index=L?N+me:le,W[me]=oe,oe.category=(H==null?void 0:H[oe.x])??oe.x,oe.key=oe.name??oe.category);if(this.options.keys=B,xe&&(k!==(ce=xe.length)||L))for(me=0;me<ce;me++)me!==I||L||(me+=k),xe[me]&&(xe[me].destroyElements(),xe[me].plotX=void 0);this.data=xe,this.points=W,Ts(this,"afterGeneratePoints")}getXExtremes(c){return{min:zc(c),max:Va(c)}}getExtremes(c,m){var Ge;let{xAxis:y,yAxis:T}=this,E=m||this.getExtremesFromAll||this.options.getExtremesFromAll,k=E&&this.cropped?this.dataTable:this.dataTable.modified,I=k.rowCount,L=c||this.stackedYData,B=L?[L]:((Ge=this.keysAffectYAxis||this.pointArrayMap||["y"])==null?void 0:Ge.map(Ze=>k.getColumn(Ze,!0)||[]))||[],W=this.getColumn("x",!0),N=[],H=this.requireSorting&&!this.is("column")?1:0,K=!!T&&T.positiveValuesOnly,te=E||this.cropped||!y,ce,le,oe,me=0,xe=0;for(y&&(me=(ce=y.getExtremes()).min,xe=ce.max),oe=0;oe<I;oe++)if(le=W[oe],te||(W[oe+H]||le)>=me&&(W[oe-H]||le)<=xe)for(let Ze of B){let yt=Ze[oe];Js(yt)&&(yt>0||!K)&&N.push(yt)}let et={activeYData:N,dataMin:zc(N),dataMax:Va(N)};return Ts(this,"afterGetExtremes",{dataExtremes:et}),et}applyExtremes(){let c=this.getExtremes();return this.dataMin=c.dataMin,this.dataMax=c.dataMax,c}getFirstValidPoint(c,m=0,y=1){let T=c.length,E=m;for(;E>=0&&E<T;){if(Is(c[E]))return c[E];E+=y}}translate(){var xe;this.generatePoints();let c=this.options,m=c.stacking,y=this.xAxis,T=this.enabledDataSorting,E=this.yAxis,k=this.points,I=k.length,L=this.pointPlacementToXValue(),B=!!L,W=c.threshold,N=c.startFromThreshold?W:0,H=(c==null?void 0:c.nullInteraction)&&E.len,K,te,ce,le,oe=Number.MAX_VALUE;function me(et){return pa(et,-1e9,1e9)}for(K=0;K<I;K++){let et,Ge=k[K],Ze=Ge.x,yt,at,vt=Ge.y,Vt=Ge.low,ii=m&&((xe=E.stacking)==null?void 0:xe.stacks[(this.negStacks&&vt<(N?0:W)?"-":"")+this.stackKey]);Ge.plotX=Js(te=y.translate(Ze,!1,!1,!1,!0,L))?ja(me(te)):void 0,m&&this.visible&&ii&&ii[Ze]&&(le=this.getStackIndicator(le,Ze,this.index),!Ge.isNull&&le.key&&(at=(yt=ii[Ze]).points[le.key]),yt&&fl(at)&&(Vt=at[0],vt=at[1],Vt===N&&le.key===ii[Ze].base&&(Vt=Rs(Js(W)?W:E.min)),E.positiveValuesOnly&&Is(Vt)&&Vt<=0&&(Vt=void 0),Ge.total=Ge.stackTotal=Rs(yt.total),Ge.percentage=Is(Ge.y)&&yt.total?Ge.y/yt.total*100:void 0,Ge.stackY=vt,this.irregularWidths||yt.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),Ge.yBottom=Is(Vt)?me(E.translate(Vt,!1,!0,!1,!0)):void 0,this.dataModify&&(vt=this.dataModify.modifyValue(vt,K)),Js(vt)&&Ge.plotX!==void 0?et=Js(et=E.translate(vt,!1,!0,!1,!0))?me(et):void 0:!Js(vt)&&H&&(et=H),Ge.plotY=et,Ge.isInside=this.isPointInside(Ge),Ge.clientX=B?ja(y.translate(Ze,!1,!1,!1,!0,L)):te,Ge.negative=(Ge.y||0)<(W||0),Ge.isNull||Ge.visible===!1||(ce!==void 0&&(oe=Math.min(oe,Math.abs(te-ce))),ce=te),Ge.zone=this.zones.length?Ge.getZone():void 0,!Ge.graphic&&this.group&&T&&(Ge.isNew=!0)}this.closestPointRangePx=oe,Ts(this,"afterTranslate")}getValidPoints(c,m,y){let T=this.chart;return(c||this.points||[]).filter(function(E){let{plotX:k,plotY:I}=E;return!!((y||!E.isNull&&Js(I))&&(!m||T.isInsidePlot(k,I,{inverted:T.inverted})))&&E.visible!==!1})}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:c,group:m,markerGroup:y}=this,T=c.sharedClips,E=c.renderer,k=c.getClipBox(this),I=this.getSharedClipKey(),L=T[I];L?L.animate(k):T[I]=L=E.clipRect(k),m&&m.clip(this.options.clip===!1?void 0:L),y&&y.clip()}animate(c){let{chart:m,group:y,markerGroup:T}=this,E=m.inverted,k=ns(this.options.animation),I=[this.getSharedClipKey(),k.duration,k.easing,k.defer].join(","),L=m.sharedClips[I],B=m.sharedClips[I+"m"];if(c&&y){let W=m.getClipBox(this);if(L)L.attr("height",W.height);else{W.width=0,E&&(W.x=m.plotHeight),L=m.renderer.clipRect(W),m.sharedClips[I]=L;let N={x:-99,y:-99,width:E?m.plotWidth+199:99,height:E?99:m.plotHeight+199};B=m.renderer.clipRect(N),m.sharedClips[I+"m"]=B}y.clip(L),T==null||T.clip(B)}else if(L&&!L.hasClass("highcharts-animating")){let W=m.getClipBox(this),N=k.step;(T!=null&&T.element.childNodes.length||m.series.length>1)&&(k.step=function(H,K){N&&N.apply(K,arguments),K.prop==="width"&&(B!=null&&B.element)&&B.attr(E?"height":"width",H+99)}),L.addClass("highcharts-animating").animate(W,k)}}afterAnimate(){this.setClip(),Gg(this.chart.sharedClips,(c,m,y)=>{c&&!this.chart.container.querySelector(`[clip-path="url(#${c.id})"]`)&&(c.destroy(),delete y[m])}),this.finishedAnimating=!0,Ts(this,"afterAnimate")}drawPoints(c=this.points){let m,y,T,E,k,I,L,B=this.chart,W=B.styledMode,{colorAxis:N,options:H}=this,K=H.marker,te=H.nullInteraction,ce=this[this.specialGroup||"markerGroup"],le=this.xAxis,oe=Rs(K.enabled,!le||!!le.isRadial||null,this.closestPointRangePx>=K.enabledThreshold*K.radius);if(K.enabled!==!1||this._hasPointMarkers)for(m=0;m<c.length;m++){E=(T=(y=c[m]).graphic)?"animate":"attr",k=y.marker||{},I=!!y.marker;let me=y.isNull;if((oe&&!Is(k.enabled)||k.enabled)&&(!me||te)&&y.visible!==!1){let xe=Rs(k.symbol,this.symbol,"rect");L=this.markerAttribs(y,y.selected&&"select"),this.enabledDataSorting&&(y.startXPos=le.reversed?-(L.width||0):le.width);let et=y.isInside!==!1;if(!T&&et&&((L.width||0)>0||y.hasImage)&&(y.graphic=T=B.renderer.symbol(xe,L.x,L.y,L.width,L.height,I?k:K).add(ce),this.enabledDataSorting&&B.hasRendered&&(T.attr({x:y.startXPos}),E="animate")),T&&E==="animate"&&T[et?"show":"hide"](et).animate(L),T){let Ge=this.pointAttribs(y,W||!y.selected?void 0:"select");W?N&&T.css({fill:Ge.fill}):T[E](Ge)}T&&T.addClass(y.getClassName(),!0)}else T&&(y.graphic=T.destroy())}}markerAttribs(c,m){let y=this.options,T=y.marker,E=c.marker||{},k=E.symbol||T.symbol,I={},L,B,W=Rs(E.radius,T==null?void 0:T.radius);m&&(L=T.states[m],B=E.states&&E.states[m],W=Rs(B==null?void 0:B.radius,L==null?void 0:L.radius,W&&W+((L==null?void 0:L.radiusPlus)||0))),c.hasImage=k&&k.indexOf("url")===0,c.hasImage&&(W=0);let N=c.pos();return Js(W)&&N&&(y.crisp&&(N[0]=$l(N[0],c.hasImage?0:k==="rect"?(T==null?void 0:T.lineWidth)||0:1)),I.x=N[0]-W,I.y=N[1]-W),W&&(I.width=I.height=2*W),I}pointAttribs(c,m){var oe;let y=this.options,T=y.marker,E=c==null?void 0:c.options,k=(E==null?void 0:E.marker)||{},I=E==null?void 0:E.color,L=c==null?void 0:c.color,B=(oe=c==null?void 0:c.zone)==null?void 0:oe.color,W,N,H=this.color,K,te,ce=Rs(k.lineWidth,T.lineWidth),le=c!=null&&c.isNull&&y.nullInteraction?0:1;return H=I||B||L||H,K=k.fillColor||T.fillColor||H,te=k.lineColor||T.lineColor||H,m=m||"normal",W=T.states[m]||{},ce=Rs((N=k.states&&k.states[m]||{}).lineWidth,W.lineWidth,ce+Rs(N.lineWidthPlus,W.lineWidthPlus,0)),K=N.fillColor||W.fillColor||K,te=N.lineColor||W.lineColor||te,{stroke:te,"stroke-width":ce,fill:K,opacity:le=Rs(N.opacity,W.opacity,le)}}destroy(c){var L,B;let m,y,T=this,E=T.chart,k=/AppleWebKit\/533/.test(ss.navigator.userAgent),I=T.data||[];for(Ts(T,"destroy",{keepEventsForUpdate:c}),this.removeEvents(c),(T.axisTypes||[]).forEach(function(W){y=T[W],y!=null&&y.series&&($g(y.series,T),y.isDirty=y.forceRedraw=!0)}),T.legendItem&&T.chart.legend.destroyItem(T),m=I.length;m--;)(B=(L=I[m])==null?void 0:L.destroy)==null||B.call(L);for(let W of T.zones)Rh(W,void 0,!0);Ee.clearTimeout(T.animationTimeout),Gg(T,function(W,N){W instanceof cr&&!W.survive&&W[k&&N==="group"?"hide":"destroy"]()}),E.hoverSeries===T&&(E.hoverSeries=void 0),$g(E.series,T),E.orderItems("series"),Gg(T,function(W,N){c&&N==="hcEvents"||delete T[N]})}applyZones(){let{area:c,chart:m,graph:y,zones:T,points:E,xAxis:k,yAxis:I,zoneAxis:L}=this,{inverted:B,renderer:W}=m,N=this[`${L}Axis`],{isXAxis:H,len:K=0,minPointOffset:te=0}=N||{},ce=((y==null?void 0:y.strokeWidth())||0)/2+1,le=(oe,me=0,xe=0)=>{B&&(xe=K-xe);let{translated:et=0,lineClip:Ge}=oe,Ze=xe-et;Ge==null||Ge.push(["L",me,Math.abs(Ze)<ce?xe-ce*(Ze<=0?-1:1):et])};if(T.length&&(y||c)&&N&&Js(N.min)){let oe=N.getExtremes().max+te,me=Ge=>{Ge.forEach((Ze,yt)=>{(Ze[0]==="M"||Ze[0]==="L")&&(Ge[yt]=[Ze[0],H?K-Ze[1]:Ze[1],H?Ze[2]:K-Ze[2]])})};if(T.forEach(Ge=>{Ge.lineClip=[],Ge.translated=pa(N.toPixels(Rs(Ge.value,oe),!0)||0,0,K)}),y&&!this.showLine&&y.hide(),c&&c.hide(),L==="y"&&E.length<k.len)for(let Ge of E){let{plotX:Ze,plotY:yt,zone:at}=Ge,vt=at&&T[T.indexOf(at)-1];at&&le(at,Ze,yt),vt&&le(vt,Ze,yt)}let xe=[],et=N.toPixels(N.getExtremes().min-te,!0);T.forEach(Ge=>{var Wi,Ti;let Ze=Ge.lineClip||[],yt=Math.round(Ge.translated||0);k.reversed&&Ze.reverse();let{clip:at,simpleClip:vt}=Ge,Vt=0,ii=0,li=k.len,$t=I.len;H?(Vt=yt,li=et):(ii=yt,$t=et);let gi=[["M",Vt,ii],["L",li,ii],["L",li,$t],["L",Vt,$t],["Z"]],vi=[gi[0],...Ze,gi[1],gi[2],...xe,gi[3],gi[4]];xe=Ze.reverse(),et=yt,B&&(me(vi),c&&me(gi)),at?(at.animate({d:vi}),vt==null||vt.animate({d:gi})):(at=Ge.clip=W.path(vi),c&&(vt=Ge.simpleClip=W.path(gi))),y&&((Wi=Ge.graph)==null||Wi.clip(at)),c&&((Ti=Ge.area)==null||Ti.clip(vt))})}else this.visible&&(y&&y.show(),c&&c.show())}plotGroup(c,m,y,T,E){let k=this[c],I=!k,L={visibility:y,zIndex:T||.1};return Is(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(L.opacity=this.opacity),k||(this[c]=k=this.chart.renderer.g().add(E)),k.addClass("highcharts-"+m+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(Is(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(k.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),k.attr(L)[I?"attr":"animate"](this.getPlotBox(m)),k}getPlotBox(c){let m=this.xAxis,y=this.yAxis,T=this.chart,E=T.inverted&&!T.polar&&m&&this.invertible&&c==="series";return T.inverted&&(m=y,y=this.xAxis),{translateX:m?m.left:T.plotLeft,translateY:y?y.top:T.plotTop,rotation:90*!!E,rotationOriginX:E?(m.len-y.len)/2:0,rotationOriginY:E?(m.len+y.len)/2:0,scaleX:E?-1:1,scaleY:1}}removeEvents(c){let{eventsToUnbind:m}=this;c||sb(this),m.length&&(m.forEach(y=>{y()}),m.length=0)}render(){var W,N,H,K,te;let c=this,{chart:m,options:y,hasRendered:T}=c,E=ns(y.animation),k=c.visible?"inherit":"hidden",I=y.zIndex,L=m.seriesGroup,B=c.finishedAnimating?0:E.duration;Ts(this,"render"),c.plotGroup("group","series",k,I,L),c.markerGroup=c.plotGroup("markerGroup","markers",k,I,L),y.clip!==!1&&c.setClip(),B&&((W=c.animate)==null||W.call(c,!0)),c.drawGraph&&(c.drawGraph(),c.applyZones()),c.visible&&c.drawPoints(),(N=c.drawDataLabels)==null||N.call(c),(H=c.redrawPoints)==null||H.call(c),y.enableMouseTracking&&((K=c.drawTracker)==null||K.call(c)),B&&((te=c.animate)==null||te.call(c)),T||(B&&E.defer&&(B+=E.defer),c.animationTimeout=rm(()=>{c.afterAnimate()},B||0)),c.isDirty=!1,c.hasRendered=!0,Ts(c,"afterRender")}redraw(){let c=this.isDirty||this.isDirtyData;this.translate(),this.render(),c&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(c,m){let{xAxis:y,yAxis:T}=this,E=this.chart.inverted;return this.searchKDTree({clientX:E?y.len-c.chartY+y.pos:c.chartX-y.pos,plotY:E?T.len-c.chartX+T.pos:c.chartY-T.pos},m,c)}buildKDTree(c){this.buildingKdTree=!0;let m=this,y=m.options,T=y.findNearestPointBy.indexOf("y")>-1?2:1;delete m.kdTree,rm(function(){m.kdTree=function E(k,I,L){let B,W,N=k==null?void 0:k.length;if(N)return B=m.kdAxisArray[I%L],k.sort((H,K)=>(H[B]||0)-(K[B]||0)),{point:k[W=Math.floor(N/2)],left:E(k.slice(0,W),I+1,L),right:E(k.slice(W+1),I+1,L)}}(m.getValidPoints(void 0,!m.directTouch,y==null?void 0:y.nullInteraction),T,T),m.buildingKdTree=!1},y.kdNow||(c==null?void 0:c.type)==="touchstart"?0:1)}searchKDTree(c,m,y,T,E){let k=this,[I,L]=this.kdAxisArray,B=m?"distX":"dist",W=(k.options.findNearestPointBy||"").indexOf("y")>-1?2:1,N=!!k.isBubble,H=T||((te,ce,le)=>{let oe=te[le]||0,me=ce[le]||0;return[oe===me&&te.index>ce.index||oe<me?te:ce,!1]}),K=E||((te,ce)=>te<ce);if(this.kdTree||this.buildingKdTree||this.buildKDTree(y),this.kdTree)return function te(ce,le,oe,me){var Vt;let xe=le.point,et=k.kdAxisArray[oe%me],Ge=xe,Ze=!1;(function(ii,li){var hn;let $t=ii[I],gi=li[I],vi=Is($t)&&Is(gi)?$t-gi:null,Wi=ii[L],Ti=li[L],Gi=Is(Wi)&&Is(Ti)?Wi-Ti:0,xn=N&&((hn=li.marker)==null?void 0:hn.radius)||0;li.dist=Math.sqrt((vi&&vi*vi||0)+Gi*Gi)-xn,li.distX=Is(vi)?Math.abs(vi)-xn:Number.MAX_VALUE})(ce,xe);let yt=(ce[et]||0)-(xe[et]||0)+(N&&((Vt=xe.marker)==null?void 0:Vt.radius)||0),at=yt<0?"left":"right",vt=yt<0?"right":"left";return le[at]&&([Ge,Ze]=H(xe,te(ce,le[at],oe+1,me),B)),le[vt]&&K(Math.sqrt(yt*yt),Ge[B],Ze)&&(Ge=H(Ge,te(ce,le[vt],oe+1,me),B)[0]),Ge}(c,this.kdTree,W,W)}pointPlacementToXValue(){let{options:c,xAxis:m}=this,y=c.pointPlacement;return y==="between"&&(y=m.reversed?-.5:.5),Js(y)?y*(c.pointRange||m.pointRange):0}isPointInside(c){let{chart:m,xAxis:y,yAxis:T}=this,{plotX:E=-1,plotY:k=-1}=c;return k>=0&&k<=(T?T.len:m.plotHeight)&&E>=0&&E<=(y?y.len:m.plotWidth)}drawTracker(){var H;let c=this,m=c.options,y=m.trackByArea,T=[].concat((y?c.areaPath:c.graphPath)||[]),E=c.chart,k=E.pointer,I=E.renderer,L=((H=E.options.tooltip)==null?void 0:H.snap)||0,B=()=>{m.enableMouseTracking&&E.hoverSeries!==c&&c.onMouseOver()},W="rgba(192,192,192,"+(Rr?1e-4:.002)+")",N=c.tracker;N?N.attr({d:T}):c.graph&&(c.tracker=N=I.path(T).attr({visibility:c.visible?"inherit":"hidden",zIndex:2}).addClass(y?"highcharts-tracker-area":"highcharts-tracker-line").add(c.group),E.styledMode||N.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:W,fill:y?W:"none","stroke-width":c.graph.strokeWidth()+(y?0:2*L)}),[c.tracker,c.markerGroup,c.dataLabelsGroup].forEach(K=>{K&&(K.addClass("highcharts-tracker").on("mouseover",B).on("mouseout",te=>{k==null||k.onTrackerMouseOut(te)}),m.cursor&&!E.styledMode&&K.css({cursor:m.cursor}),K.on("touchstart",B))})),Ts(this,"afterDrawTracker")}addPoint(c,m,y,T,E){let k,I,L=this.options,{chart:B,data:W,dataTable:N,xAxis:H}=this,K=(H==null?void 0:H.hasNames)&&H.names,te=L.data,ce=this.getColumn("x");m=Rs(m,!0);let le={series:this};this.pointClass.prototype.applyOptions.apply(le,[c]);let oe=le.x;if(I=ce.length,this.requireSorting&&oe<ce[I-1])for(k=!0;I&&ce[I-1]>oe;)I--;N.setRow(le,I,!0,{addColumns:!1}),K&&le.name&&(K[oe]=le.name),te==null||te.splice(I,0,c),(k||this.processedData)&&(this.data.splice(I,0,null),this.processData()),L.legendType==="point"&&this.generatePoints(),y&&(W[0]&&W[0].remove?W[0].remove(!1):([W,te].filter(Is).forEach(me=>{me.shift()}),N.deleteRows(0))),E!==!1&&Ts(this,"addPoint",{point:le}),this.isDirty=!0,this.isDirtyData=!0,m&&B.redraw(T)}removePoint(c,m,y){let T=this,{chart:E,data:k,points:I,dataTable:L}=T,B=k[c],W=function(){[(I==null?void 0:I.length)===k.length?I:void 0,k,T.options.data].filter(Is).forEach(N=>{N.splice(c,1)}),L.deleteRows(c),B==null||B.destroy(),T.isDirty=!0,T.isDirtyData=!0,m&&E.redraw()};Xn(y,E),m=Rs(m,!0),B?B.firePointEvent("remove",null,W):W()}remove(c,m,y,T){let E=this,k=E.chart;function I(){E.destroy(T),k.isDirtyLegend=k.isDirtyBox=!0,k.linkSeries(T),Rs(c,!0)&&k.redraw(m)}y!==!1?Ts(E,"remove",null,I):I()}update(c,m){var oe,me;Ts(this,"update",{options:c=Tf(c,this.userOptions)});let y=this,T=y.chart,E=y.userOptions,k=y.initialType||y.type,I=T.options.plotOptions,L=Qs[k].prototype,B=y.finishedAnimating&&{animation:!1},W={},N,H,K=no.keepProps.slice(),te=c.type||E.type||T.options.chart.type,ce=!(this.hasDerivedData||te&&te!==this.type||c.keys!==void 0||c.pointStart!==void 0||c.pointInterval!==void 0||c.relativeXValue!==void 0||c.joinBy||c.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(xe=>y.hasOptionChanged(xe)));te=te||k,ce?(K.push.apply(K,no.keepPropsForPoints),c.visible!==!1&&K.push("area","graph"),y.parallelArrays.forEach(function(xe){K.push(xe+"Data")}),c.data&&(c.dataSorting&&Wu(y.options.dataSorting,c.dataSorting),this.setData(c.data,!1))):this.dataTable.modified=this.dataTable,c=Gu(E,{index:E.index===void 0?y.index:E.index,pointStart:((oe=I==null?void 0:I.series)==null?void 0:oe.pointStart)??E.pointStart??y.getColumn("x")[0]},!ce&&{data:y.options.data},c,B),ce&&c.data&&(c.data=y.options.data),(K=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(K)).forEach(function(xe){K[xe]=y[xe],delete y[xe]});let le=!1;if(Qs[te]){if(le=te!==y.type,y.remove(!1,!1,!1,!0),le)if(T.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(y,Qs[te].prototype);else{let xe=Object.hasOwnProperty.call(y,"hcEvents")&&y.hcEvents;for(H in L)y[H]=void 0;Wu(y,Qs[te].prototype),xe?y.hcEvents=xe:delete y.hcEvents}}else Ef(17,!0,T,{missingModuleFor:te});if(K.forEach(function(xe){y[xe]=K[xe]}),y.init(T,c),ce&&this.points)for(let xe of((N=y.options).visible===!1?(W.graphic=1,W.dataLabel=1):(this.hasMarkerChanged(N,E)&&(W.graphic=1),(me=y.hasDataLabels)!=null&&me.call(y)||(W.dataLabel=1)),this.points))xe!=null&&xe.series&&(xe.resolveColor(),Object.keys(W).length&&xe.destroyElements(W),N.showInLegend===!1&&xe.legendItem&&T.legend.destroyItem(xe));y.initialType=k,T.linkSeries(),T.setSortedData(),le&&y.linkedSeries.length&&(y.isDirtyData=!0),Ts(this,"afterUpdate"),Rs(m,!0)&&T.redraw(!!ce&&void 0)}setName(c){this.name=this.options.name=this.userOptions.name=c,this.chart.isDirtyLegend=!0}hasOptionChanged(c){var I,L;let m=this.chart,y=this.options[c],T=m.options.plotOptions,E=this.userOptions[c],k=Rs((I=T==null?void 0:T[this.type])==null?void 0:I[c],(L=T==null?void 0:T.series)==null?void 0:L[c]);return E&&!Is(k)?y!==E:y!==Rs(k,y)}onMouseOver(){let c=this.chart,m=c.hoverSeries,y=c.pointer;y==null||y.setHoverChartIndex(),m&&m!==this&&m.onMouseOut(),this.options.events.mouseOver&&Ts(this,"mouseOver"),this.setState("hover"),c.hoverSeries=this}onMouseOut(){let c=this.options,m=this.chart,y=m.tooltip,T=m.hoverPoint;m.hoverSeries=null,T&&T.onMouseOut(),this&&c.events.mouseOut&&Ts(this,"mouseOut"),y&&!this.stickyTracking&&(!y.shared||this.noSharedTooltip)&&y.hide(),m.series.forEach(function(E){E.setState("",!0)})}setState(c,m){let y=this,T=y.options,E=y.graph,k=T.inactiveOtherPoints,I=T.states,L=Rs(I[c||"normal"]&&I[c||"normal"].animation,y.chart.options.chart.animation),B=T.lineWidth,W=T.opacity;if(c=c||"",y.state!==c&&([y.group,y.markerGroup,y.dataLabelsGroup].forEach(function(N){N&&(y.state&&N.removeClass("highcharts-series-"+y.state),c&&N.addClass("highcharts-series-"+c))}),y.state=c,!y.chart.styledMode)){if(I[c]&&I[c].enabled===!1)return;if(c&&(B=I[c].lineWidth||B+(I[c].lineWidthPlus||0),W=Rs(I[c].opacity,W)),E&&!E.dashstyle&&Js(B))for(let N of[E,...this.zones.map(H=>H.graph)])N==null||N.animate({"stroke-width":B},L);k||[y.group,y.markerGroup,y.dataLabelsGroup,y.labelBySeries].forEach(function(N){N&&N.animate({opacity:W},L)})}m&&k&&y.points&&y.setAllPointsToState(c||void 0)}setAllPointsToState(c){this.points.forEach(function(m){m.setState&&m.setState(c)})}setVisible(c,m){var L;let y=this,T=y.chart,E=T.options.chart.ignoreHiddenSeries,k=y.visible;y.visible=c=y.options.visible=y.userOptions.visible=c===void 0?!k:c;let I=c?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(B=>{var W;(W=y[B])==null||W[I]()}),(T.hoverSeries===y||((L=T.hoverPoint)==null?void 0:L.series)===y)&&y.onMouseOut(),y.legendItem&&T.legend.colorizeItem(y,c),y.isDirty=!0,y.options.stacking&&T.series.forEach(B=>{B.options.stacking&&B.visible&&(B.isDirty=!0)}),y.linkedSeries.forEach(B=>{B.setVisible(c,!1)}),E&&(T.isDirtyBox=!0),Ts(y,I),m!==!1&&T.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(c){this.selected=c=this.options.selected=c===void 0?!this.selected:c,this.checkbox&&(this.checkbox.checked=c),Ts(this,c?"select":"unselect")}shouldShowTooltip(c,m,y={}){return y.series=this,y.visiblePlotOnly=!0,this.chart.isInsidePlot(c,m,y)}drawLegendSymbol(c,m){var y;(y=Vn[this.options.legendSymbol||"rectangle"])==null||y.call(this,c,m)}}no.defaultOptions={lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:F}=this.series.chart;return typeof this.y!="number"?"":F(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},no.types=Bn.seriesTypes,no.registerType=Bn.registerSeriesType,no.keepProps=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],no.keepPropsForPoints=["data","isDirtyData","isDirtyCanvas","points","dataTable","processedData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"],Wu(no.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:re,requireSorting:!0,sorted:!0}),Bn.series=no;let Cr=no,{animObject:Wl,setAnimation:$a}=Ds,{registerEventOptions:Gl}=Eh,{composed:Bc,marginNames:Fc}=ve,{distribute:rb}=sl,{format:ob}=wr,{addEvent:om,createElement:ab,css:Zy,defined:am,discardElement:Wa,find:lb,fireEvent:Hl,isNumber:zs,merge:Ai,pick:gr,pushUnique:lm,relativeLength:yo,stableSort:Yy,syncTimeout:Ky}=Ee;class $o{constructor(c,m){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=c,this.setOptions(m),m.enabled&&(this.render(),Gl(this,m),om(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),om(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(c){let m=gr(c.padding,8);this.options=c,this.chart.styledMode||(this.itemStyle=c.itemStyle,this.itemHiddenStyle=Ai(this.itemStyle,c.itemHiddenStyle)),this.itemMarginTop=c.itemMarginTop,this.itemMarginBottom=c.itemMarginBottom,this.padding=m,this.initialItemY=m-5,this.symbolWidth=gr(c.symbolWidth,16),this.pages=[],this.proximate=c.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(c,m){let y=this.chart;this.setOptions(Ai(!0,this.options,c)),"events"in this.options&&Gl(this,this.options),this.destroy(),y.isDirtyLegend=y.isDirtyBox=!0,gr(m,!0)&&y.redraw(),Hl(this,"afterUpdate",{redraw:m})}colorizeItem(c,m){var B;let y=c.color,{area:T,group:E,label:k,line:I,symbol:L}=c.legendItem||{};if((c instanceof Cr||c instanceof re)&&(c.color=((B=c.options)==null?void 0:B.legendSymbolColor)||y),E==null||E[m?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:W={}}=this,N=W.color,{fillColor:H,fillOpacity:K,lineColor:te,marker:ce}=c.options,le=oe=>(!m&&(oe.fill&&(oe.fill=N),oe.stroke&&(oe.stroke=N)),oe);k==null||k.css(Ai(m?this.itemStyle:W)),I==null||I.attr(le({stroke:te||c.color})),L&&L.attr(le(ce&&L.isMarker?c.pointAttribs():{fill:c.color})),T==null||T.attr(le({fill:H||c.color,"fill-opacity":H?1:K??.75}))}c.color=y,Hl(this,"afterColorizeItem",{item:c,visible:m})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(c){let{group:m,x:y=0,y:T=0}=c.legendItem||{},E=this.options,k=E.symbolPadding,I=!E.rtl,L=c.checkbox;if(m!=null&&m.element){let B={translateX:I?y:this.legendWidth-y-2*k-4,translateY:T};m[am(m.translateY)?"animate":"attr"](B,void 0,()=>{Hl(this,"afterPositionItem",{item:c})})}L&&(L.x=y,L.y=T)}destroyItem(c){let m=c.checkbox,y=c.legendItem||{};for(let T of["group","label","line","symbol"])y[T]&&(y[T]=y[T].destroy());m&&Wa(m),c.legendItem=void 0}destroy(){for(let c of this.getAllItems())this.destroyItem(c);for(let c of["clipRect","up","down","pager","nav","box","title","group"])this[c]&&(this[c]=this[c].destroy());this.display=null}positionCheckboxes(){var E;let c,m=(E=this.group)==null?void 0:E.alignAttr,y=this.clipHeight||this.legendHeight,T=this.titleHeight;m&&(c=m.translateY,this.allItems.forEach(function(k){let I,L=k.checkbox;L&&(I=c+T+L.y+(this.scrollOffset||0)+3,Zy(L,{left:m.translateX+k.checkboxOffset+L.x-20+"px",top:I+"px",display:this.proximate||I>c-6&&I<c+y-6?"":"none"}))},this))}renderTitle(){let c=this.options,m=this.padding,y=c.title,T,E=0;y.text&&(this.title||(this.title=this.chart.renderer.label(y.text,m-3,m-4,void 0,void 0,void 0,c.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(y.style),this.title.add(this.group)),y.width||this.title.css({width:this.maxLegendWidth+"px"}),E=(T=this.title.getBBox()).height,this.offsetWidth=T.width,this.contentGroup.attr({translateY:E})),this.titleHeight=E}setText(c){let m=this.options;c.legendItem.label.attr({text:m.labelFormat?ob(m.labelFormat,c,this.chart):m.labelFormatter.call(c)})}renderItem(c){var yt;let m=c.legendItem=c.legendItem||{},y=this.chart,T=y.renderer,E=this.options,k=E.layout==="horizontal",I=this.symbolWidth,L=E.symbolPadding||0,B=this.itemStyle,W=this.itemHiddenStyle,N=k?gr(E.itemDistance,20):0,H=!E.rtl,K=!c.series,te=!K&&c.series.drawLegendSymbol?c.series:c,ce=te.options,le=!!this.createCheckboxForItem&&ce&&ce.showCheckbox,oe=E.useHTML,me=c.options.className,xe=m.label,et=I+L+N+20*!!le;!xe&&(m.group=T.g("legend-item").addClass("highcharts-"+te.type+"-series highcharts-color-"+c.colorIndex+(me?" "+me:"")+(K?" highcharts-series-"+c.index:"")).attr({zIndex:1}).add(this.scrollGroup),m.label=xe=T.text("",H?I+L:-L,this.baseline||0,oe),y.styledMode||xe.css(Ai(c.visible?B:W)),xe.attr({align:H?"left":"right",zIndex:2}).add(m.group),!this.baseline&&(this.fontMetrics=T.fontMetrics(xe),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,xe.attr("y",this.baseline),this.symbolHeight=gr(E.symbolHeight,this.fontMetrics.f),E.squareSymbol&&(this.symbolWidth=gr(E.symbolWidth,Math.max(this.symbolHeight,16)),et=this.symbolWidth+L+N+20*!!le,H&&xe.attr("x",this.symbolWidth+L))),te.drawLegendSymbol(this,c),this.setItemEvents&&this.setItemEvents(c,xe,oe)),le&&!c.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(c),this.colorizeItem(c,c.visible),(y.styledMode||!B.width)&&xe.css({width:(E.itemWidth||this.widthOption||y.spacingBox.width)-et+"px"}),this.setText(c);let Ge=xe.getBBox(),Ze=((yt=this.fontMetrics)==null?void 0:yt.h)||0;c.itemWidth=c.checkboxOffset=E.itemWidth||m.labelWidth||Ge.width+et,this.maxItemWidth=Math.max(this.maxItemWidth,c.itemWidth),this.totalItemWidth+=c.itemWidth,this.itemHeight=c.itemHeight=Math.round(m.labelHeight||(Ge.height>1.5*Ze?Ge.height:Ze))}layoutItem(c){let m=this.options,y=this.padding,T=m.layout==="horizontal",E=c.itemHeight,k=this.itemMarginBottom,I=this.itemMarginTop,L=T?gr(m.itemDistance,20):0,B=this.maxLegendWidth,W=m.alignColumns&&this.totalItemWidth>B?this.maxItemWidth:c.itemWidth,N=c.legendItem||{};T&&this.itemX-y+W>B&&(this.itemX=y,this.lastLineHeight&&(this.itemY+=I+this.lastLineHeight+k),this.lastLineHeight=0),this.lastItemY=I+this.itemY+k,this.lastLineHeight=Math.max(E,this.lastLineHeight),N.x=this.itemX,N.y=this.itemY,T?this.itemX+=W:(this.itemY+=I+E+k,this.lastLineHeight=E),this.offsetWidth=this.widthOption||Math.max((T?this.itemX-y-(c.checkbox?0:L):W)+y,this.offsetWidth)}getAllItems(){let c=[];return this.chart.series.forEach(function(m){var T;let y=m==null?void 0:m.options;m&&gr(y.showInLegend,!am(y.linkedTo)&&void 0,!0)&&(c=c.concat(((T=m.legendItem)==null?void 0:T.labels)||(y.legendType==="point"?m.data:m)))}),Hl(this,"afterGetAllItems",{allItems:c}),c}getAlignment(){let c=this.options;return this.proximate?c.align.charAt(0)+"tv":c.floating?"":c.align.charAt(0)+c.verticalAlign.charAt(0)+c.layout.charAt(0)}adjustMargins(c,m){let y=this.chart,T=this.options,E=this.getAlignment();E&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(k,I){k.test(E)&&!am(c[I])&&(y[Fc[I]]=Math.max(y[Fc[I]],y.legend[(I+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][I]*T[I%2?"x":"y"]+gr(T.margin,12)+m[I]+(y.titleOffset[I]||0)))})}proximatePositions(){let c,m=this.chart,y=[],T=this.options.align==="left";for(let E of(this.allItems.forEach(function(k){let I,L,B=T,W,N;k.yAxis&&(k.xAxis.options.reversed&&(B=!B),k.points&&(I=lb(B?k.points:k.points.slice(0).reverse(),function(H){return zs(H.plotY)})),L=this.itemMarginTop+k.legendItem.label.getBBox().height+this.itemMarginBottom,N=k.yAxis.top-m.plotTop,W=k.visible?(I?I.plotY:k.yAxis.height)+(N-.3*L):N+k.yAxis.height,y.push({target:W,size:L,item:k}))},this),rb(y,m.plotHeight)))c=E.item.legendItem||{},zs(E.pos)&&(c.y=m.plotTop-m.spacing[0]+E.pos)}render(){let c=this.chart,m=c.renderer,y=this.options,T=this.padding,E=this.getAllItems(),k,I,L,B=this.group,W,N=this.box;this.itemX=T,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=yo(y.width,c.spacingBox.width-T),W=c.spacingBox.width-2*T-y.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(W/=2),this.maxLegendWidth=this.widthOption||W,B||(this.group=B=m.g("legend").addClass(y.className||"").attr({zIndex:7}).add(),this.contentGroup=m.g().attr({zIndex:1}).add(B),this.scrollGroup=m.g().add(this.contentGroup)),this.renderTitle(),Yy(E,(H,K)=>{var te,ce;return(((te=H.options)==null?void 0:te.legendIndex)||0)-(((ce=K.options)==null?void 0:ce.legendIndex)||0)}),y.reversed&&E.reverse(),this.allItems=E,this.display=k=!!E.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,E.forEach(this.renderItem,this),E.forEach(this.layoutItem,this),I=(this.widthOption||this.offsetWidth)+T,L=this.lastItemY+this.lastLineHeight+this.titleHeight,L=this.handleOverflow(L)+T,N||(this.box=N=m.rect().addClass("highcharts-legend-box").attr({r:y.borderRadius}).add(B)),c.styledMode||N.attr({stroke:y.borderColor,"stroke-width":y.borderWidth||0,fill:y.backgroundColor||"none"}).shadow(y.shadow),I>0&&L>0&&N[N.placed?"animate":"attr"](N.crisp.call({},{x:0,y:0,width:I,height:L},N.strokeWidth())),B[k?"show":"hide"](),c.styledMode&&B.getStyle("display")==="none"&&(I=L=0),this.legendWidth=I,this.legendHeight=L,k&&this.align(),this.proximate||this.positionItems(),Hl(this,"afterRender")}align(c=this.chart.spacingBox){let m=this.chart,y=this.options,T=c.y;/(lth|ct|rth)/.test(this.getAlignment())&&m.titleOffset[0]>0?T+=m.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&m.titleOffset[2]>0&&(T-=m.titleOffset[2]),T!==c.y&&(c=Ai(c,{y:T})),m.hasRendered||(this.group.placed=!1),this.group.align(Ai(y,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":y.verticalAlign}),!0,c)}handleOverflow(c){let m=this,y=this.chart,T=y.renderer,E=this.options,k=E.y,I=E.verticalAlign==="top",L=this.padding,B=E.maxHeight,W=E.navigation,N=gr(W.animation,!0),H=W.arrowSize||12,K=this.pages,te=this.allItems,ce=function(at){typeof at=="number"?yt.attr({height:at}):yt&&(m.clipRect=yt.destroy(),m.contentGroup.clip()),m.contentGroup.div&&(m.contentGroup.div.style.clip=at?"rect("+L+"px,9999px,"+(L+at)+"px,0)":"auto")},le=function(at){return m[at]=T.circle(0,0,1.3*H).translate(H/2,H/2).add(Ze),y.styledMode||m[at].attr("fill","rgba(0,0,0,0.0001)"),m[at]},oe,me,xe,et,Ge=y.spacingBox.height+(I?-k:k)-L,Ze=this.nav,yt=this.clipRect;return E.layout!=="horizontal"||E.verticalAlign==="middle"||E.floating||(Ge/=2),B&&(Ge=Math.min(Ge,B)),K.length=0,c&&Ge>0&&c>Ge&&W.enabled!==!1?(this.clipHeight=oe=Math.max(Ge-20-this.titleHeight-L,0),this.currentPage=gr(this.currentPage,1),this.fullHeight=c,te.forEach((at,vt)=>{let Vt=(xe=at.legendItem||{}).y||0,ii=Math.round(xe.label.getBBox().height),li=K.length;(!li||Vt-K[li-1]>oe&&(me||Vt)!==K[li-1])&&(K.push(me||Vt),li++),xe.pageIx=li-1,me&&et&&(et.pageIx=li-1),vt===te.length-1&&Vt+ii-K[li-1]>oe&&Vt>K[li-1]&&(K.push(Vt),xe.pageIx=li),Vt!==me&&(me=Vt),et=xe}),yt||(yt=m.clipRect=T.clipRect(0,L-2,9999,0),m.contentGroup.clip(yt)),ce(oe),Ze||(this.nav=Ze=T.g().attr({zIndex:1}).add(this.group),this.up=T.symbol("triangle",0,0,H,H).add(Ze),le("upTracker").on("click",function(){m.scroll(-1,N)}),this.pager=T.text("",15,10).addClass("highcharts-legend-navigation"),!y.styledMode&&W.style&&this.pager.css(W.style),this.pager.add(Ze),this.down=T.symbol("triangle-down",0,0,H,H).add(Ze),le("downTracker").on("click",function(){m.scroll(1,N)})),m.scroll(0),c=Ge):Ze&&(ce(),this.nav=Ze.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),c}scroll(c,m){let y=this.chart,T=this.pages,E=T.length,k=this.clipHeight,I=this.options.navigation,L=this.pager,B=this.padding,W=this.currentPage+c;W>E&&(W=E),W>0&&(m!==void 0&&$a(m,y),this.nav.attr({translateX:B,translateY:k+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(N){N.attr({class:W===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),L.attr({text:W+"/"+E}),[this.down,this.downTracker].forEach(function(N){N.attr({x:18+this.pager.getBBox().width,class:W===E?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),y.styledMode||(this.up.attr({fill:W===1?I.inactiveColor:I.activeColor}),this.upTracker.css({cursor:W===1?"default":"pointer"}),this.down.attr({fill:W===E?I.inactiveColor:I.activeColor}),this.downTracker.css({cursor:W===E?"default":"pointer"})),this.scrollOffset=-T[W-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=W,this.positionCheckboxes(),Ky(()=>{Hl(this,"afterScroll",{currentPage:W})},Wl(gr(m,y.renderer.globalAnimation,!0)).duration))}setItemEvents(c,m,y){let T=this,E=c.legendItem||{},k=T.chart.renderer.boxWrapper,I=c instanceof re,L=c instanceof Cr,B="highcharts-legend-"+(I?"point":"series")+"-active",W=T.chart.styledMode,N=y?[m,E.symbol]:[E.group],H=K=>{T.allItems.forEach(te=>{c!==te&&[te].concat(te.linkedSeries||[]).forEach(ce=>{ce.setState(K,!I)})})};for(let K of N)K&&K.on("mouseover",function(){c.visible&&H("inactive"),c.setState("hover"),c.visible&&k.addClass(B),W||m.css(T.options.itemHoverStyle)}).on("mouseout",function(){T.chart.styledMode||m.css(Ai(c.visible?T.itemStyle:T.itemHiddenStyle)),H(""),k.removeClass(B),c.setState()}).on("click",function(te){let ce=function(){c.setVisible&&c.setVisible(),H(c.visible?"inactive":"")};k.removeClass(B),Hl(T,"itemClick",{browserEvent:te,legendItem:c},ce),I?c.firePointEvent("legendItemClick",{browserEvent:te}):L&&Hl(c,"legendItemClick",{browserEvent:te})})}createCheckboxForItem(c){c.checkbox=ab("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:c.selected,defaultChecked:c.selected},this.options.itemCheckboxStyle,this.chart.container),om(c.checkbox,"click",function(m){let y=m.target;Hl(c.series||c,"checkboxClick",{checked:y.checked,item:c},function(){c.select()})})}}(function(F){F.compose=function(c){lm(Bc,"Core.Legend")&&om(c,"beforeMargins",function(){this.legend=new F(this,this.options.legend)})}})($o||($o={}));let cm=$o,{animate:ql,animObject:Mf,setAnimation:Xl}=Ds,{defaultOptions:Cf}=Fe,{numberFormat:hm}=wr,{registerEventOptions:Hg}=Eh,{charts:Nc,doc:Af,marginNames:um,svg:Jy,win:Hu}=ve,{seriesTypes:Uc}=Bn,{addEvent:Ga,attr:dm,createElement:fm,css:so,defined:ma,diffObjects:xo,discardElement:kf,erase:Xr,error:vo,extend:pl,find:Es,fireEvent:In,getAlignFactor:If,getStyle:Wo,isArray:cb,isNumber:qu,isObject:Qy,isString:Pf,merge:Zr,objectEach:pm,pick:Ar,pInt:ex,relativeLength:qg,removeEvent:tx,splat:mm,syncTimeout:ix,uniqueKey:nx}=Ee;class ga{static chart(c,m,y){return new ga(c,m,y)}constructor(c,m,y){this.sharedClips={};let T=[...arguments];(Pf(c)||c.nodeName)&&(this.renderTo=T.shift()),this.init(T[0],T[1])}setZoomOptions(){let c=this.options.chart,m=c.zooming;this.zooming={...m,type:Ar(c.zoomType,m.type),key:Ar(c.zoomKey,m.key),pinchType:Ar(c.pinchType,m.pinchType),singleTouch:Ar(c.zoomBySingleTouch,m.singleTouch,!1),resetButton:Zr(m.resetButton,c.resetZoomButton)}}init(c,m){In(this,"init",{args:arguments},function(){var k;let y=Zr(Cf,c),T=y.chart,E=this.renderTo||T.renderTo;this.userOptions=pl({},c),(this.renderTo=Pf(E)?Af.getElementById(E):E)||vo(13,!0,this),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=m,this.isResizing=0,this.options=y,this.axes=[],this.series=[],this.locale=y.lang.locale??((k=this.renderTo.closest("[lang]"))==null?void 0:k.lang),this.time=new vr(pl(y.time||{},{locale:this.locale}),y.lang),y.time=this.time.options,this.numberFormatter=(T.numberFormatter||hm).bind(this),this.styledMode=T.styledMode,this.hasCartesianSeries=T.showAxes,this.index=Nc.length,Nc.push(this),ve.chartCount++,Hg(this,T),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),In(this,"afterInit"),this.firstRender()})}initSeries(c){let m=this.options.chart,y=c.type||m.type,T=Uc[y];T||vo(17,!0,this,{missingModuleFor:y});let E=new T;return typeof E.init=="function"&&E.init(this,c),E}setSortedData(){this.getSeriesOrderByLinks().forEach(function(c){c.points||c.data||!c.enabledDataSorting||c.setData(c.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(c,m){return c.linkedSeries.length||m.linkedSeries.length?m.linkedSeries.length-c.linkedSeries.length:0})}orderItems(c,m=0){let y=this[c],T=this.options[c]=mm(this.options[c]).slice(),E=this.userOptions[c]=this.userOptions[c]?mm(this.userOptions[c]).slice():[];if(this.hasRendered&&(T.splice(m),E.splice(m)),y)for(let k=m,I=y.length;k<I;++k){let L=y[k];L&&(L.index=k,L instanceof Cr&&(L.name=L.getName()),L.options.isInternal||(T[k]=L.options,E[k]=L.userOptions))}}getClipBox(c,m){var W,N;let y=this.inverted,{xAxis:T,yAxis:E}=c||{},{x:k,y:I,width:L,height:B}=Zr(this.clipBox);return c&&(T&&T.len!==this.plotSizeX&&(L=T.len),E&&E.len!==this.plotSizeY&&(B=E.len),y&&!c.invertible&&([L,B]=[B,L])),m&&(k+=((W=y?E:T)==null?void 0:W.pos)??this.plotLeft,I+=((N=y?T:E)==null?void 0:N.pos)??this.plotTop),{x:k,y:I,width:L,height:B}}isInsidePlot(c,m,y={}){var le;let{inverted:T,plotBox:E,plotLeft:k,plotTop:I,scrollablePlotBox:L}=this,{scrollLeft:B=0,scrollTop:W=0}=y.visiblePlotOnly&&((le=this.scrollablePlotArea)==null?void 0:le.scrollingContainer)||{},N=y.series,H=y.visiblePlotOnly&&L||E,K=y.inverted?m:c,te=y.inverted?c:m,ce={x:K,y:te,isInsidePlot:!0,options:y};if(!y.ignoreX){let oe=N&&(T&&!this.polar?N.yAxis:N.xAxis)||{pos:k,len:1/0},me=y.paneCoordinates?oe.pos+K:k+K;me>=Math.max(B+k,oe.pos)&&me<=Math.min(B+k+H.width,oe.pos+oe.len)||(ce.isInsidePlot=!1)}if(!y.ignoreY&&ce.isInsidePlot){let oe=!T&&y.axis&&!y.axis.isXAxis&&y.axis||N&&(T?N.xAxis:N.yAxis)||{pos:I,len:1/0},me=y.paneCoordinates?oe.pos+te:I+te;me>=Math.max(W+I,oe.pos)&&me<=Math.min(W+I+H.height,oe.pos+oe.len)||(ce.isInsidePlot=!1)}return In(this,"afterIsInsidePlot",ce),ce.isInsidePlot}redraw(c){In(this,"beforeRedraw");let m=this.hasCartesianSeries?this.axes:this.colorAxis||[],y=this.series,T=this.pointer,E=this.legend,k=this.userOptions.legend,I=this.renderer,L=I.isHidden(),B=[],W,N,H,K=this.isDirtyBox,te=this.isDirtyLegend,ce;for(I.rootFontSize=I.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),Xl(!!this.hasRendered&&c,this),L&&this.temporaryDisplay(),this.layOutTitles(!1),H=y.length;H--;)if(((ce=y[H]).options.stacking||ce.options.centerInCategory)&&(N=!0,ce.isDirty)){W=!0;break}if(W)for(H=y.length;H--;)(ce=y[H]).options.stacking&&(ce.isDirty=!0);y.forEach(function(le){le.isDirty&&(le.options.legendType==="point"?(typeof le.updateTotals=="function"&&le.updateTotals(),te=!0):k&&(k.labelFormatter||k.labelFormat)&&(te=!0)),le.isDirtyData&&In(le,"updatedData")}),te&&E&&E.options.enabled&&(E.render(),this.isDirtyLegend=!1),N&&this.getStacks(),m.forEach(function(le){le.updateNames(),le.setScale()}),this.getMargins(),m.forEach(function(le){le.isDirty&&(K=!0)}),m.forEach(function(le){let oe=le.min+","+le.max;le.extKey!==oe&&(le.extKey=oe,B.push(function(){In(le,"afterSetExtremes",pl(le.eventArgs,le.getExtremes())),delete le.eventArgs})),(K||N)&&le.redraw()}),K&&this.drawChartBox(),In(this,"predraw"),y.forEach(function(le){(K||le.isDirty)&&le.visible&&le.redraw(),le.isDirtyData=!1}),T&&T.reset(!0),I.draw(),In(this,"redraw"),In(this,"render"),L&&this.temporaryDisplay(!0),B.forEach(function(le){le.call()})}get(c){let m=this.series;function y(E){return E.id===c||E.options&&E.options.id===c}let T=Es(this.axes,y)||Es(this.series,y);for(let E=0;!T&&E<m.length;E++)T=Es(m[E].points||[],y);return T}createAxes(){let c=this.userOptions;for(let m of(In(this,"createAxes"),["xAxis","yAxis"]))for(let y of c[m]=mm(c[m]||{}))new hl(this,y,m);In(this,"afterCreateAxes")}getSelectedPoints(){return this.series.reduce((c,m)=>(m.getPointsCollection().forEach(y=>{Ar(y.selectedStaging,y.selected)&&c.push(y)}),c),[])}getSelectedSeries(){return this.series.filter(c=>c.selected)}setTitle(c,m,y){this.applyDescription("title",c),this.applyDescription("subtitle",m),this.applyDescription("caption",void 0),this.layOutTitles(y)}applyDescription(c,m){var k;let y=this,T=this.options[c]=Zr(this.options[c],m),E=this[c];E&&m&&(this[c]=E=E.destroy()),T&&!E&&((E=this.renderer.text(T.text,0,0,T.useHTML).attr({align:T.align,class:"highcharts-"+c,zIndex:T.zIndex||4}).css({textOverflow:"ellipsis",whiteSpace:"nowrap"}).add()).update=function(I,L){y.applyDescription(c,I),y.layOutTitles(L)},this.styledMode||E.css(pl(c==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},T.style)),E.textPxLength=E.getBBox().width,E.css({whiteSpace:(k=T.style)==null?void 0:k.whiteSpace}),this[c]=E)}layOutTitles(c=!0){var I,L,B,W;let m=[0,0,0],{options:y,renderer:T,spacingBox:E}=this;["title","subtitle","caption"].forEach(N=>{var le;let H=this[N],K=this.options[N],te=Zr(E),ce=(H==null?void 0:H.textPxLength)||0;if(H&&K){In(this,"layOutTitle",{alignTo:te,key:N,textPxLength:ce});let oe=T.fontMetrics(H),me=oe.b,xe=oe.h,et=K.verticalAlign||"top",Ge=et==="top",Ze=Ge&&K.minScale||1,yt=N==="title"?Ge?-3:0:Ge?m[0]+2:0,at=Math.min(te.width/ce,1),vt=Math.max(Ze,at),Vt=Zr({y:et==="bottom"?me:yt+me},{align:N==="title"?at<Ze?"left":"center":(le=this.title)==null?void 0:le.alignValue},K),ii=(K.width||(at>Ze?this.chartWidth:te.width)/vt)+"px";H.alignValue!==Vt.align&&(H.placed=!1);let li=Math.round(H.css({width:ii}).getBBox(K.useHTML).height);if(Vt.height=li,H.align(Vt,!1,te).attr({align:Vt.align,scaleX:vt,scaleY:vt,"transform-origin":`${te.x+ce*vt*If(Vt.align)} ${xe}`}),!K.floating){let $t=li*(li<1.2*xe?1:vt);et==="top"?m[0]=Math.ceil(m[0]+$t):et==="bottom"&&(m[2]=Math.ceil(m[2]+$t))}}},this),m[0]&&(((I=y.title)==null?void 0:I.verticalAlign)||"top")==="top"&&(m[0]+=((L=y.title)==null?void 0:L.margin)||0),m[2]&&((B=y.caption)==null?void 0:B.verticalAlign)==="bottom"&&(m[2]+=((W=y.caption)==null?void 0:W.margin)||0);let k=!this.titleOffset||this.titleOffset.join(",")!==m.join(",");this.titleOffset=m,In(this,"afterLayOutTitles"),!this.isDirtyBox&&k&&(this.isDirtyBox=this.isDirtyLegend=k,this.hasRendered&&c&&this.isDirtyBox&&this.redraw())}getContainerBox(){let c=[].map.call(this.renderTo.children,y=>{if(y!==this.container){let T=y.style.display;return y.style.display="none",[y,T]}}),m={width:Wo(this.renderTo,"width",!0)||0,height:Wo(this.renderTo,"height",!0)||0};return c.filter(Boolean).forEach(([y,T])=>{y.style.display=T}),m}getChartSize(){var k;let c=this.options.chart,m=c.width,y=c.height,T=this.getContainerBox(),E=T.height<=1||!((k=this.renderTo.parentElement)!=null&&k.style.height)&&this.renderTo.style.height==="100%";this.chartWidth=Math.max(0,m||T.width||600),this.chartHeight=Math.max(0,qg(y,this.chartWidth)||(E?400:T.height)),this.containerBox=T}temporaryDisplay(c){let m=this.renderTo,y;if(c)for(;m!=null&&m.style;)m.hcOrigStyle&&(so(m,m.hcOrigStyle),delete m.hcOrigStyle),m.hcOrigDetached&&(Af.body.removeChild(m),m.hcOrigDetached=!1),m=m.parentNode;else for(;m!=null&&m.style&&(Af.body.contains(m)||m.parentNode||(m.hcOrigDetached=!0,Af.body.appendChild(m)),(Wo(m,"display",!1)==="none"||m.hcOricDetached)&&(m.hcOrigStyle={display:m.style.display,height:m.style.height,overflow:m.style.overflow},y={display:"block",overflow:"hidden"},m!==this.renderTo&&(y.height=0),so(m,y),m.offsetWidth||m.style.setProperty("display","block","important")),(m=m.parentNode)!==Af.body););}setClassName(c){this.container.className="highcharts-container "+(c||"")}getContainer(){var H,K;let c,m=this.options,y=m.chart,T="data-highcharts-chart",E=nx(),k=this.renderTo,I=ex(dm(k,T));qu(I)&&Nc[I]&&Nc[I].hasRendered&&Nc[I].destroy(),dm(k,T,this.index),k.innerHTML=Yn.emptyHTML,y.skipClone||k.offsetWidth||this.temporaryDisplay(),this.getChartSize();let L=this.chartHeight,B=this.chartWidth;so(k,{overflow:"hidden"}),this.styledMode||(c=pl({position:"relative",overflow:"hidden",width:B+"px",height:L+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},y.style||{}));let W=fm("div",{id:E},c,k);this.container=W,this.getChartSize(),B===this.chartWidth||(B=this.chartWidth,this.styledMode||so(W,{width:Ar((H=y.style)==null?void 0:H.width,B+"px")})),this.containerBox=this.getContainerBox(),this._cursor=W.style.cursor;let N=y.renderer||!Jy?zo.getRendererType(y.renderer):bh;if(this.renderer=new N(W,B,L,void 0,y.forExport,(K=m.exporting)==null?void 0:K.allowHTML,this.styledMode),Xl(void 0,this),this.setClassName(y.className),this.styledMode)for(let te in m.defs)this.renderer.definition(m.defs[te]);else this.renderer.setStyle(y.style);this.renderer.chartIndex=this.index,In(this,"afterGetContainer")}getMargins(c){var E;let{spacing:m,margin:y,titleOffset:T}=this;this.resetMargins(),T[0]&&!ma(y[0])&&(this.plotTop=Math.max(this.plotTop,T[0]+m[0])),T[2]&&!ma(y[2])&&(this.marginBottom=Math.max(this.marginBottom,T[2]+m[2])),(E=this.legend)!=null&&E.display&&this.legend.adjustMargins(y,m),In(this,"getMargins"),c||this.getAxisMargins()}getAxisMargins(){let c=this,m=c.axisOffset=[0,0,0,0],y=c.colorAxis,T=c.margin,E=function(k){k.forEach(function(I){I.visible&&I.getOffset()})};c.hasCartesianSeries?E(c.axes):y!=null&&y.length&&E(y),um.forEach(function(k,I){ma(T[I])||(c[k]+=m[I])}),c.setChartSize()}getOptions(){return xo(this.userOptions,Cf)}reflow(c){var E;let m=this,y=m.containerBox,T=m.getContainerBox();(E=m.pointer)==null||delete E.chartPosition,!m.isPrinting&&!m.isResizing&&y&&T.width&&((T.width!==y.width||T.height!==y.height)&&(Ee.clearTimeout(m.reflowTimeout),m.reflowTimeout=ix(function(){m.container&&m.setSize(void 0,void 0,!1)},100*!!c)),m.containerBox=T)}setReflow(){let c=this,m=y=>{var T;(T=c.options)!=null&&T.chart.reflow&&c.hasLoaded&&c.reflow(y)};if(typeof ResizeObserver=="function")new ResizeObserver(m).observe(c.renderTo);else{let y=Ga(Hu,"resize",m);Ga(this,"destroy",y)}}setSize(c,m,y){let T=this,E=T.renderer;T.isResizing+=1,Xl(y,T);let k=E.globalAnimation;T.oldChartHeight=T.chartHeight,T.oldChartWidth=T.chartWidth,c!==void 0&&(T.options.chart.width=c),m!==void 0&&(T.options.chart.height=m),T.getChartSize();let{chartWidth:I,chartHeight:L,scrollablePixelsX:B=0,scrollablePixelsY:W=0}=T;(T.isDirtyBox||I!==T.oldChartWidth||L!==T.oldChartHeight)&&(T.styledMode||(k?ql:so)(T.container,{width:`${I+B}px`,height:`${L+W}px`},k),T.setChartSize(!0),E.setSize(I,L,k),T.axes.forEach(function(N){N.isDirty=!0,N.setScale()}),T.isDirtyLegend=!0,T.isDirtyBox=!0,T.layOutTitles(),T.getMargins(),T.redraw(k),T.oldChartHeight=void 0,In(T,"resize"),setTimeout(()=>{T&&In(T,"endResize")},Mf(k).duration)),T.isResizing-=1}setChartSize(c){let m,y,T,E,{chartHeight:k,chartWidth:I,inverted:L,spacing:B,renderer:W}=this,N=this.clipOffset,H=Math[L?"floor":"round"];this.plotLeft=m=Math.round(this.plotLeft),this.plotTop=y=Math.round(this.plotTop),this.plotWidth=T=Math.max(0,Math.round(I-m-(this.marginRight??0))),this.plotHeight=E=Math.max(0,Math.round(k-y-(this.marginBottom??0))),this.plotSizeX=L?E:T,this.plotSizeY=L?T:E,this.spacingBox=W.spacingBox={x:B[3],y:B[0],width:I-B[3]-B[1],height:k-B[0]-B[2]},this.plotBox=W.plotBox={x:m,y,width:T,height:E},N&&(this.clipBox={x:H(N[3]),y:H(N[0]),width:H(this.plotSizeX-N[1]-N[3]),height:H(this.plotSizeY-N[0]-N[2])}),c||(this.axes.forEach(function(K){K.setAxisSize(),K.setAxisTranslation()}),W.alignElements()),In(this,"afterSetChartSize",{skipAxes:c})}resetMargins(){In(this,"resetMargins");let c=this,m=c.options.chart,y=m.plotBorderWidth||0,T=Math.round(y)/2;["margin","spacing"].forEach(function(E){let k=m[E],I=Qy(k)?k:[k,k,k,k];["Top","Right","Bottom","Left"].forEach(function(L,B){c[E][B]=Ar(m[E+L],I[B])})}),um.forEach(function(E,k){c[E]=Ar(c.margin[k],c.spacing[k])}),c.axisOffset=[0,0,0,0],c.clipOffset=[T,T,T,T],c.plotBorderWidth=y}drawChartBox(){let c=this.options.chart,m=this.renderer,y=this.chartWidth,T=this.chartHeight,E=this.styledMode,k=this.plotBGImage,I=c.backgroundColor,L=c.plotBackgroundColor,B=c.plotBackgroundImage,W=this.plotLeft,N=this.plotTop,H=this.plotWidth,K=this.plotHeight,te=this.plotBox,ce=this.clipRect,le=this.clipBox,oe=this.chartBackground,me=this.plotBackground,xe=this.plotBorder,et,Ge,Ze,yt="animate";oe||(this.chartBackground=oe=m.rect().addClass("highcharts-background").add(),yt="attr"),E?et=Ge=oe.strokeWidth():(Ge=(et=c.borderWidth||0)+8*!!c.shadow,Ze={fill:I||"none"},(et||oe["stroke-width"])&&(Ze.stroke=c.borderColor,Ze["stroke-width"]=et),oe.attr(Ze).shadow(c.shadow)),oe[yt]({x:Ge/2,y:Ge/2,width:y-Ge-et%2,height:T-Ge-et%2,r:c.borderRadius}),yt="animate",me||(yt="attr",this.plotBackground=me=m.rect().addClass("highcharts-plot-background").add()),me[yt](te),!E&&(me.attr({fill:L||"none"}).shadow(c.plotShadow),B&&(k?(B!==k.attr("href")&&k.attr("href",B),k.animate(te)):this.plotBGImage=m.image(B,W,N,H,K).add())),ce?ce.animate({width:le.width,height:le.height}):this.clipRect=m.clipRect(le),yt="animate",xe||(yt="attr",this.plotBorder=xe=m.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),E||xe.attr({stroke:c.plotBorderColor,"stroke-width":c.plotBorderWidth||0,fill:"none"}),xe[yt](xe.crisp(te,-xe.strokeWidth())),this.isDirtyBox=!1,In(this,"afterDrawChartBox")}propFromSeries(){let c,m,y,T=this,E=T.options.chart,k=T.options.series;["inverted","angular","polar"].forEach(function(I){for(m=Uc[E.type],y=E[I]||m&&m.prototype[I],c=k==null?void 0:k.length;!y&&c--;)(m=Uc[k[c].type])&&m.prototype[I]&&(y=!0);T[I]=y})}linkSeries(c){let m=this,y=m.series;y.forEach(function(T){T.linkedSeries.length=0}),y.forEach(function(T){let{linkedTo:E}=T.options;if(Pf(E)){let k;(k=E===":previous"?m.series[T.index-1]:m.get(E))&&k.linkedParent!==T&&(k.linkedSeries.push(T),T.linkedParent=k,k.enabledDataSorting&&T.setDataSortingOptions(),T.visible=Ar(T.options.visible,k.options.visible,T.visible))}}),In(this,"afterLinkSeries",{isUpdating:c})}renderSeries(){this.series.forEach(function(c){c.translate(),c.render()})}render(){var W;let c=this.axes,m=this.colorAxis,y=this.renderer,T=this.options.chart.axisLayoutRuns||2,E=N=>{N.forEach(H=>{H.visible&&H.render()})},k=0,I=!0,L,B=0;for(let N of(this.setTitle(),In(this,"beforeMargins"),(W=this.getStacks)==null||W.call(this),this.getMargins(!0),this.setChartSize(),c)){let{options:H}=N,{labels:K}=H;if(this.hasCartesianSeries&&N.horiz&&N.visible&&K.enabled&&N.series.length&&N.coll!=="colorAxis"&&!this.polar){k=H.tickLength,N.createGroups();let te=new Fa(N,0,"",!0),ce=te.createLabel("x",K);if(te.destroy(),ce&&Ar(K.reserveSpace,!qu(H.crossing))&&(k=ce.getBBox().height+K.distance+Math.max(H.offset||0,0)),k){ce==null||ce.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-k,0);(I||L||T>1)&&B<T;){let N=this.plotWidth,H=this.plotHeight;for(let K of c)B===0?K.setScale():(K.horiz&&I||!K.horiz&&L)&&K.setTickInterval(!0);B===0?this.getAxisMargins():this.getMargins(),I=N/this.plotWidth>(B?1:1.1),L=H/this.plotHeight>(B?1:1.05),B++}this.drawChartBox(),this.hasCartesianSeries?E(c):m!=null&&m.length&&E(m),this.seriesGroup||(this.seriesGroup=y.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(c){let m=this,y=Zr(!0,this.options.credits,c);y.enabled&&!this.credits&&(this.credits=this.renderer.text(y.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){y.href&&(Hu.location.href=y.href)}).attr({align:y.position.align,zIndex:8}),m.styledMode||this.credits.css(y.style),this.credits.add().align(y.position),this.credits.update=function(T){m.credits=m.credits.destroy(),m.addCredits(T)})}destroy(){var I,L;let c,m=this,y=m.axes,T=m.series,E=m.container,k=E==null?void 0:E.parentNode;for(In(m,"destroy"),m.renderer.forExport?Xr(Nc,m):Nc[m.index]=void 0,ve.chartCount--,m.renderTo.removeAttribute("data-highcharts-chart"),tx(m),c=y.length;c--;)y[c]=y[c].destroy();for((L=(I=this.scroller)==null?void 0:I.destroy)==null||L.call(I),c=T.length;c--;)T[c]=T[c].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(B=>{var W,N;m[B]=(N=(W=m[B])==null?void 0:W.destroy)==null?void 0:N.call(W)}),E&&(E.innerHTML=Yn.emptyHTML,tx(E),k&&kf(E)),pm(m,function(B,W){delete m[W]})}firstRender(){var T;let c=this,m=c.options;c.getContainer(),c.resetMargins(),c.setChartSize(),c.propFromSeries(),c.createAxes();let y=cb(m.series)?m.series:[];m.series=[],y.forEach(function(E){c.initSeries(E)}),c.linkSeries(),c.setSortedData(),In(c,"beforeRender"),c.render(),(T=c.pointer)==null||T.getChartPosition(),c.renderer.imgCount||c.hasLoaded||c.onload(),c.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(c){c&&this.index!==void 0&&c.apply(this,[this])},this),In(this,"load"),In(this,"render"),ma(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:c,title:m}=this;!c||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":((m==null?void 0:m.element.textContent)||"").replace(/</g,"&lt;")}),c.accessibility&&c.accessibility.enabled===!1||vo('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(c,m,y){let T,E=this;return c&&(m=Ar(m,!0),In(E,"addSeries",{options:c},function(){T=E.initSeries(c),E.isDirtyLegend=!0,E.linkSeries(),T.enabledDataSorting&&T.setData(c.data,!1),In(E,"afterAddSeries",{series:T}),m&&E.redraw(y)})),T}addAxis(c,m,y,T){return this.createAxis(m?"xAxis":"yAxis",{axis:c,redraw:y,animation:T})}addColorAxis(c,m,y){return this.createAxis("colorAxis",{axis:c,redraw:m,animation:y})}createAxis(c,m){let y=new hl(this,m.axis,c);return Ar(m.redraw,!0)&&this.redraw(m.animation),y}showLoading(c){let m=this,y=m.options,T=y.loading,E=function(){k&&so(k,{left:m.plotLeft+"px",top:m.plotTop+"px",width:m.plotWidth+"px",height:m.plotHeight+"px"})},k=m.loadingDiv,I=m.loadingSpan;k||(m.loadingDiv=k=fm("div",{className:"highcharts-loading highcharts-loading-hidden"},null,m.container)),I||(m.loadingSpan=I=fm("span",{className:"highcharts-loading-inner"},null,k),Ga(m,"redraw",E)),k.className="highcharts-loading",Yn.setElementHTML(I,Ar(c,y.lang.loading,"")),m.styledMode||(so(k,pl(T.style,{zIndex:10})),so(I,T.labelStyle),m.loadingShown||(so(k,{opacity:0,display:""}),ql(k,{opacity:T.style.opacity||.5},{duration:T.showDuration||0}))),m.loadingShown=!0,E()}hideLoading(){let c=this.options,m=this.loadingDiv;m&&(m.className="highcharts-loading highcharts-loading-hidden",this.styledMode||ql(m,{opacity:0},{duration:c.loading.hideDuration||100,complete:function(){so(m,{display:"none"})}})),this.loadingShown=!1}update(c,m,y,T){let E,k,I,L=this,B={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},W=c.isResponsiveOptions,N=[];In(L,"update",{options:c}),W||L.setResponsive(!1,!0),c=xo(c,L.options),L.userOptions=Zr(L.userOptions,c);let H=c.chart;H&&(Zr(!0,L.options.chart,H),this.setZoomOptions(),"className"in H&&L.setClassName(H.className),("inverted"in H||"polar"in H||"type"in H)&&(L.propFromSeries(),E=!0),"alignTicks"in H&&(E=!0),"events"in H&&Hg(this,H),pm(H,function(ce,le){L.propsRequireUpdateSeries.indexOf("chart."+le)!==-1&&(k=!0),L.propsRequireDirtyBox.indexOf(le)!==-1&&(L.isDirtyBox=!0),L.propsRequireReflow.indexOf(le)===-1||(L.isDirtyBox=!0,W||(I=!0))}),!L.styledMode&&H.style&&L.renderer.setStyle(L.options.chart.style||{})),!L.styledMode&&c.colors&&(this.options.colors=c.colors),pm(c,function(ce,le){L[le]&&typeof L[le].update=="function"?L[le].update(ce,!1):typeof L[B[le]]=="function"?L[B[le]](ce):le!=="colors"&&L.collectionsWithUpdate.indexOf(le)===-1&&Zr(!0,L.options[le],c[le]),le!=="chart"&&L.propsRequireUpdateSeries.indexOf(le)!==-1&&(k=!0)}),this.collectionsWithUpdate.forEach(function(ce){c[ce]&&(mm(c[ce]).forEach(function(le,oe){let me,xe=ma(le.id);xe&&(me=L.get(le.id)),!me&&L[ce]&&(me=L[ce][Ar(le.index,oe)])&&(xe&&ma(me.options.id)||me.options.isInternal)&&(me=void 0),me&&me.coll===ce&&(me.update(le,!1),y&&(me.touched=!0)),!me&&y&&L.collectionsWithInit[ce]&&(L.collectionsWithInit[ce][0].apply(L,[le].concat(L.collectionsWithInit[ce][1]||[]).concat([!1])).touched=!0)}),y&&L[ce].forEach(function(le){le.touched||le.options.isInternal?delete le.touched:N.push(le)}))}),N.forEach(function(ce){ce.chart&&ce.remove&&ce.remove(!1)}),E&&L.axes.forEach(function(ce){ce.update({},!1)}),k&&L.getSeriesOrderByLinks().forEach(function(ce){ce.chart&&ce.update({},!1)},this);let K=H==null?void 0:H.width,te=H&&(Pf(H.height)?qg(H.height,K||L.chartWidth):H.height);I||qu(K)&&K!==L.chartWidth||qu(te)&&te!==L.chartHeight?L.setSize(K,te,T):Ar(m,!0)&&L.redraw(T),In(L,"afterUpdate",{options:c,redraw:m,animation:T})}setSubtitle(c,m){this.applyDescription("subtitle",c),this.layOutTitles(m)}setCaption(c,m){this.applyDescription("caption",c),this.layOutTitles(m)}showResetZoom(){let c=this,m=Cf.lang,y=c.zooming.resetButton,T=y.theme,E=y.relativeTo==="chart"||y.relativeTo==="spacingBox"?null:"plotBox";function k(){c.zoomOut()}In(this,"beforeShowResetZoom",null,function(){c.resetZoomButton=c.renderer.button(m.resetZoom,null,null,k,T).attr({align:y.position.align,title:m.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(y.position,!1,E)}),In(this,"afterShowResetZoom")}zoomOut(){In(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(c,m){let y=this,T=typeof m=="object"?m:{enabled:m,type:"x"},E=T.type,k=E&&y[{x:"xAxis",xy:"axes",y:"yAxis"}[E]].filter(L=>L.options.panningEnabled&&!L.options.isInternal),I=y.options.chart;I!=null&&I.panning&&(I.panning=T),In(this,"pan",{originalEvent:c},()=>{y.transform({axes:k,event:c,to:{x:c.chartX-(y.mouseDownX||0),y:c.chartY-(y.mouseDownY||0)},trigger:"pan"}),so(y.container,{cursor:"move"})})}transform(c){var te;let{axes:m=this.axes,event:y,from:T={},reset:E,selection:k,to:I={},trigger:L}=c,{inverted:B,time:W}=this,N=!1,H,K;for(let ce of((te=this.hoverPoints)==null||te.forEach(le=>le.setState()),m)){let{horiz:le,len:oe,minPointOffset:me=0,options:xe,reversed:et}=ce,Ge=le?"width":"height",Ze=le?"x":"y",yt=Ar(I[Ge],ce.len),at=Ar(T[Ge],ce.len),vt=10>Math.abs(yt)?1:yt/at,Vt=(T[Ze]||0)+at/2-ce.pos,ii=Vt-((I[Ze]??ce.pos)+yt/2-ce.pos)/vt,li=et&&!B||!et&&B?-1:1;if(!E&&(Vt<0||Vt>ce.len))continue;let $t=ce.toValue(ii,!0)+(k||ce.isOrdinal?0:me*li),gi=ce.toValue(ii+oe/vt,!0)-(k||ce.isOrdinal?0:me*li||0),vi=ce.allExtremes;if($t>gi&&([$t,gi]=[gi,$t]),vt===1&&!E&&ce.coll==="yAxis"&&!vi){for(let wo of ce.series){let Xo=wo.getExtremes(wo.getProcessedData(!0).modified.getColumn("y")||[],!0);vi??(vi={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),qu(Xo.dataMin)&&qu(Xo.dataMax)&&(vi.dataMin=Math.min(Xo.dataMin,vi.dataMin),vi.dataMax=Math.max(Xo.dataMax,vi.dataMax))}ce.allExtremes=vi}let{dataMin:Wi,dataMax:Ti,min:Gi,max:xn}=pl(ce.getExtremes(),vi||{}),hn=W.parse(xe.min),En=W.parse(xe.max),zr=Wi??hn,vn=Ti??En,Wn=gi-$t,Ki=ce.categories?0:Math.min(Wn,vn-zr),xi=zr-Ki*(ma(hn)?0:xe.minPadding),Bs=vn+Ki*(ma(En)?0:xe.maxPadding),Gn=ce.allowZoomOutside||vt===1||L!=="zoom"&&vt>1,rs=Math.min(hn??xi,xi,Gn?Gi:xi),ds=Math.max(En??Bs,Bs,Gn?xn:Bs);(!ce.isOrdinal||ce.options.overscroll||vt!==1||E)&&($t<rs&&($t=rs,vt>=1&&(gi=$t+Wn)),gi>ds&&(gi=ds,vt>=1&&($t=gi-Wn)),(E||ce.series.length&&($t!==Gi||gi!==xn)&&$t>=rs&&gi<=ds)&&(k?k[ce.coll].push({axis:ce,min:$t,max:gi}):(ce.isPanning=L!=="zoom",ce.isPanning&&(K=!0),ce.setExtremes(E?void 0:$t,E?void 0:gi,!1,!1,{move:ii,trigger:L,scale:vt}),!E&&($t>rs||gi<ds)&&L!=="mousewheel"&&(H=!0)),N=!0),y&&(this[le?"mouseDownX":"mouseDownY"]=y[le?"chartX":"chartY"]))}return N&&(k?In(this,"selection",k,()=>{delete c.selection,c.trigger="zoom",this.transform(c)}):(!H||K||this.resetZoomButton?!H&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw(L==="zoom"&&(this.options.chart.animation??this.pointCount<100)))),N}}pl(ga.prototype,{callbacks:[],collectionsWithInit:{xAxis:[ga.prototype.addAxis,[!0]],yAxis:[ga.prototype.addAxis,[!1]],series:[ga.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});let{stop:Xg}=Ds,{composed:Zg}=ve,{addEvent:ml,createElement:_r,css:Lf,defined:gm,erase:gl,merge:sx,pushUnique:Vc}=Ee;function Df(){let F=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!F&&(this.scrollablePlotArea=F=new Yr(this)),F==null||F.applyFixed()}function Go(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class Yr{static compose(c,m,y){Vc(Zg,this.compose)&&(ml(c,"afterInit",Go),ml(m,"afterSetChartSize",T=>this.afterSetSize(T.target,T)),ml(m,"render",Df),ml(y,"show",Go))}static afterSetSize(c,m){let y,T,E,{minWidth:k,minHeight:I}=c.options.chart.scrollablePlotArea||{},{clipBox:L,plotBox:B,inverted:W,renderer:N}=c;if(!N.forExport&&(k?(c.scrollablePixelsX=y=Math.max(0,k-c.chartWidth),y&&(c.scrollablePlotBox=sx(c.plotBox),B.width=c.plotWidth+=y,L[W?"height":"width"]+=y,E=!0)):I&&(c.scrollablePixelsY=T=Math.max(0,I-c.chartHeight),gm(T)&&(c.scrollablePlotBox=sx(c.plotBox),B.height=c.plotHeight+=T,L[W?"width":"height"]+=T,E=!1)),gm(E)&&!m.skipAxes))for(let H of c.axes)(H.horiz===E||c.hasParallelCoordinates&&H.coll==="yAxis")&&(H.setAxisSize(),H.setAxisTranslation())}constructor(c){var K;let m,y=c.options.chart,T=zo.getRendererType(),E=y.scrollablePlotArea||{},k=this.moveFixedElements.bind(this),I={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};c.scrollablePixelsX&&(I.overflowX="auto"),c.scrollablePixelsY&&(I.overflowY="auto"),this.chart=c;let L=this.parentDiv=_r("div",{className:"highcharts-scrolling-parent"},{position:"relative"},c.renderTo),B=this.scrollingContainer=_r("div",{className:"highcharts-scrolling"},I,L),W=this.innerContainer=_r("div",{className:"highcharts-inner-container"},void 0,B),N=this.fixedDiv=_r("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(((K=y.style)==null?void 0:K.zIndex)||0)+2,top:0},void 0,!0),H=this.fixedRenderer=new T(N,c.chartWidth,c.chartHeight,y.style);this.mask=H.path().attr({fill:y.backgroundColor||"#fff","fill-opacity":E.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),B.parentNode.insertBefore(N,B),Lf(c.renderTo,{overflow:"visible"}),ml(c,"afterShowResetZoom",k),ml(c,"afterApplyDrilldown",k),ml(c,"afterLayOutTitles",k),ml(B,"scroll",()=>{let{pointer:te,hoverPoint:ce}=c;te&&(delete te.chartPosition,ce&&(m=ce),te.runPointActions(void 0,m,!0))}),W.appendChild(c.container)}applyFixed(){var Vt;let{chart:c,fixedRenderer:m,isDirty:y,scrollingContainer:T}=this,{axisOffset:E,chartWidth:k,chartHeight:I,container:L,plotHeight:B,plotLeft:W,plotTop:N,plotWidth:H,scrollablePixelsX:K=0,scrollablePixelsY:te=0}=c,{scrollPositionX:ce=0,scrollPositionY:le=0}=c.options.chart.scrollablePlotArea||{},oe=k+K,me=I+te;m.setSize(k,I),(y??!0)&&(this.isDirty=!1,this.moveFixedElements()),Xg(c.container),Lf(L,{width:`${oe}px`,height:`${me}px`}),c.renderer.boxWrapper.attr({width:oe,height:me,viewBox:[0,0,oe,me].join(" ")}),(Vt=c.chartBackground)==null||Vt.attr({width:oe,height:me}),Lf(T,{width:`${k}px`,height:`${I}px`}),gm(y)||(T.scrollLeft=K*ce,T.scrollTop=te*le);let xe=N-E[0]-1,et=W-E[3]-1,Ge=N+B+E[2]+1,Ze=W+H+E[1]+1,yt=W+H-K,at=N+B-te,vt=[["M",0,0]];K?vt=[["M",0,xe],["L",W-1,xe],["L",W-1,Ge],["L",0,Ge],["Z"],["M",yt,xe],["L",k,xe],["L",k,Ge],["L",yt,Ge],["Z"]]:te&&(vt=[["M",et,0],["L",et,N-1],["L",Ze,N-1],["L",Ze,0],["Z"],["M",et,at],["L",et,I],["L",Ze,I],["L",Ze,at],["Z"]]),c.redrawTrigger!=="adjustHeight"&&this.mask.attr({d:vt})}moveFixedElements(){let c,{container:m,inverted:y,scrollablePixelsX:T,scrollablePixelsY:E}=this.chart,k=this.fixedRenderer,I=Yr.fixedSelectors;if(T&&!y?c=".highcharts-yaxis":T&&y||E&&!y?c=".highcharts-xaxis":E&&y&&(c=".highcharts-yaxis"),c&&!(this.chart.hasParallelCoordinates&&c===".highcharts-yaxis"))for(let L of[`${c}:not(.highcharts-radial-axis)`,`${c}-labels:not(.highcharts-radial-axis-labels)`])Vc(I,L);else for(let L of[".highcharts-xaxis",".highcharts-yaxis"])for(let B of[`${L}:not(.highcharts-radial-axis)`,`${L}-labels:not(.highcharts-radial-axis-labels)`])gl(I,B);for(let L of I)[].forEach.call(m.querySelectorAll(L),B=>{(B.namespaceURI===k.SVG_NS?k.box:k.box.parentNode).appendChild(B),B.style.pointerEvents="auto"})}}Yr.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];let{format:hb}=wr,{series:_m}=Bn,{destroyObjectProperties:rx,fireEvent:ox,getAlignFactor:Of,isNumber:_a,pick:Ha}=Ee,Yg=class{constructor(F,c,m,y,T){let E=F.chart.inverted,k=F.reversed;this.axis=F;let I=this.isNegative=!!m!=!!k;this.options=c=c||{},this.x=y,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=T,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:c.align||(E?I?"left":"right":"center"),verticalAlign:c.verticalAlign||(E?"middle":I?"bottom":"top"),y:c.y,x:c.x},this.textAlign=c.textAlign||(E?I?"right":"left":"center")}destroy(){rx(this,this.axis)}render(F){let c=this.axis.chart,m=this.options,y=m.format,T=y?hb(y,this,c):m.formatter.call(this);if(this.label)this.label.attr({text:T,visibility:"hidden"});else{this.label=c.renderer.label(T,null,void 0,m.shape,void 0,void 0,m.useHTML,!1,"stack-labels");let E={r:m.borderRadius||0,text:T,padding:Ha(m.padding,5),visibility:"hidden"};c.styledMode||(E.fill=m.backgroundColor,E.stroke=m.borderColor,E["stroke-width"]=m.borderWidth,this.label.css(m.style||{})),this.label.attr(E),this.label.added||this.label.add(F)}this.label.labelrank=c.plotSizeY,ox(this,"afterRender")}setOffset(F,c,m,y,T,E){let{alignOptions:k,axis:I,label:L,options:B,textAlign:W}=this,N=I.chart,H=this.getStackBox({xOffset:F,width:c,boxBottom:m,boxTop:y,defaultX:T,xAxis:E}),{verticalAlign:K}=k;if(L&&H){let te=L.getBBox(void 0,0),ce=L.padding,le=Ha(B.overflow,"justify")==="justify",oe;k.x=B.x||0,k.y=B.y||0;let{x:me,y:xe}=this.adjustStackPosition({labelBox:te,verticalAlign:K,textAlign:W});H.x-=me,H.y-=xe,L.align(k,!1,H),(oe=N.isInsidePlot(L.alignAttr.x+k.x+me,L.alignAttr.y+k.y+xe))||(le=!1),le&&_m.prototype.justifyDataLabel.call(I,L,k,L.alignAttr,te,H),L.attr({x:L.alignAttr.x,y:L.alignAttr.y,rotation:B.rotation,rotationOriginX:te.width*Of(B.textAlign||"center"),rotationOriginY:te.height/2}),Ha(!le&&B.crop,!0)&&(oe=_a(L.x)&&_a(L.y)&&N.isInsidePlot(L.x-ce+(L.width||0),L.y)&&N.isInsidePlot(L.x+ce,L.y)),L[oe?"show":"hide"]()}ox(this,"afterSetOffset",{xOffset:F,width:c})}adjustStackPosition({labelBox:F,verticalAlign:c,textAlign:m}){return{x:F.width/2+F.width/2*(2*Of(m)-1),y:F.height/2*2*(1-Of(c))}}getStackBox(F){let c=this.axis,m=c.chart,{boxTop:y,defaultX:T,xOffset:E,width:k,boxBottom:I}=F,L=c.stacking.usePercentage?100:Ha(y,this.total,0),B=c.toPixels(L),W=F.xAxis||m.xAxis[0],N=Ha(T,W.translate(this.x))+E,H=Math.abs(B-c.toPixels(I||_a(c.min)&&c.logarithmic&&c.logarithmic.lin2log(c.min)||0)),K=m.inverted,te=this.isNegative;return K?{x:(te?B:B-H)-m.plotLeft,y:W.height-N-k+W.top-m.plotTop,width:H,height:k}:{x:N+W.transB-m.plotLeft,y:(te?B-H:B)-m.plotTop,width:k,height:H}}},{getDeferredAnimation:ax}=Ds,{series:{prototype:ub}}=Bn,{addEvent:Rf,correctFloat:zh,defined:Bh,destroyObjectProperties:Xu,fireEvent:zf,isNumber:Zu,objectEach:jc,pick:Fh}=Ee;function Kg(){let F=this.inverted;this.axes.forEach(c=>{var m;(m=c.stacking)!=null&&m.stacks&&c.hasVisibleSeries&&(c.stacking.oldStacks=c.stacking.stacks)}),this.series.forEach(c=>{var y;let m=((y=c.xAxis)==null?void 0:y.options)||{};c.options.stacking&&c.reserveSpace()&&(c.stackKey=[c.type,Fh(c.options.stack,""),F?m.top:m.left,F?m.height:m.width].join(","))})}function lx(){var c;let F=this.stacking;if(F){let m=F.stacks;jc(m,(y,T)=>{Xu(y),delete m[T]}),(c=F.stackTotalGroup)==null||c.destroy()}}function Yu(){this.stacking||(this.stacking=new Bf(this))}function cx(F,c,m,y){return!Bh(F)||F.x!==c||y&&F.stackKey!==y?F={x:c,index:0,key:y,stackKey:y}:F.index++,F.key=[m,c,F.index].join(","),F}function Jg(){let F,c=this,m=c.yAxis,y=c.stackKey||"",T=m.stacking.stacks,E=c.getColumn("x",!0),k=c.options.stacking,I=c[k+"Stacker"];I&&[y,"-"+y].forEach(L=>{var K;let B=E.length,W,N,H;for(;B--;)W=E[B],F=c.getStackIndicator(F,W,c.index,L),N=(K=T[L])==null?void 0:K[W],(H=N==null?void 0:N.points[F.key||""])&&I.call(c,H,N,B)})}function hx(F,c,m){let y=c.total?100/c.total:0;F[0]=zh(F[0]*y),F[1]=zh(F[1]*y),this.stackedYData[m]=F[1]}function db(F){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&this.chart.series.length>1?ub.setStackedPoints.call(this,F,"group"):F.stacking.resetStacks())}function fb(F,c){var at,vt;let m,y,T,E,k,I,L,B=c||this.options.stacking;if(!B||!this.reserveSpace()||({group:"xAxis"}[B]||"yAxis")!==F.coll)return;let W=this.getColumn("x",!0),N=this.getColumn(this.pointValKey||"y",!0),H=[],K=N.length,te=this.options,ce=te.threshold||0,le=te.startFromThreshold?ce:0,oe=te.stack,me=c?`${this.type},${B}`:this.stackKey||"",xe="-"+me,et=this.negStacks,Ge=F.stacking,Ze=Ge.stacks,yt=Ge.oldStacks;for(Ge.stacksTouched+=1,L=0;L<K;L++){let Vt=W[L]||0,ii=N[L],li=Zu(ii)&&ii||0;I=(m=this.getStackIndicator(m,Vt,this.index)).key||"",Ze[k=(y=et&&li<(le?0:ce))?xe:me]||(Ze[k]={}),Ze[k][Vt]||((at=yt[k])!=null&&at[Vt]?(Ze[k][Vt]=yt[k][Vt],Ze[k][Vt].total=null):Ze[k][Vt]=new Yg(F,F.options.stackLabels,!!y,Vt,oe)),T=Ze[k][Vt],ii!==null?(T.points[I]=T.points[this.index]=[Fh(T.cumulative,le)],Bh(T.cumulative)||(T.base=I),T.touched=Ge.stacksTouched,m.index>0&&this.singleStacks===!1&&(T.points[I][0]=T.points[this.index+","+Vt+",0"][0])):(delete T.points[I],delete T.points[this.index]);let $t=T.total||0;B==="percent"?(E=y?me:xe,$t=et&&((vt=Ze[E])!=null&&vt[Vt])?(E=Ze[E][Vt]).total=Math.max(E.total||0,$t)+Math.abs(li):zh($t+Math.abs(li))):B==="group"?Zu(ii)&&$t++:$t=zh($t+li),B==="group"?T.cumulative=($t||1)-1:T.cumulative=zh(Fh(T.cumulative,le)+li),T.total=$t,ii!==null&&(T.points[I].push(T.cumulative),H[L]=T.cumulative,T.hasValidPoints=!0)}B==="percent"&&(Ge.usePercentage=!0),B!=="group"&&(this.stackedYData=H),Ge.oldStacks={}}class Bf{constructor(c){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=c}buildStacks(){let c,m,y=this.axis,T=y.series,E=y.coll==="xAxis",k=y.options.reversedStacks,I=T.length;for(this.resetStacks(),this.usePercentage=!1,m=I;m--;)c=T[k?m:I-m-1],E&&c.setGroupedPoints(y),c.setStackedPoints(y);if(!E)for(m=0;m<I;m++)T[m].modifyStacks();zf(y,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,jc(this.stacks,c=>{jc(c,m=>{m.cumulative=m.total})}))}resetStacks(){jc(this.stacks,c=>{jc(c,(m,y)=>{Zu(m.touched)&&m.touched<this.stacksTouched?(m.destroy(),delete c[y]):(m.total=null,m.cumulative=null)})})}renderStackTotals(){var I;let c=this.axis,m=c.chart,y=m.renderer,T=this.stacks,E=ax(m,((I=c.options.stackLabels)==null?void 0:I.animation)||!1),k=this.stackTotalGroup=this.stackTotalGroup||y.g("stack-labels").attr({zIndex:6,opacity:0}).add();k.translate(m.plotLeft,m.plotTop),jc(T,L=>{jc(L,B=>{B.render(k)})}),k.animate({opacity:1},E)}}(ie||(ie={})).compose=function(F,c,m){let y=c.prototype,T=m.prototype;y.getStacks||(Rf(F,"init",Yu),Rf(F,"destroy",lx),y.getStacks=Kg,T.getStackIndicator=cx,T.modifyStacks=Jg,T.percentStacker=hx,T.setGroupedPoints=db,T.setStackedPoints=fb)};let ux=ie,{defined:$c,merge:$n,isObject:Qg}=Ee;class qa extends Cr{drawGraph(){let c=this.options,m=(this.gappedPath||this.getGraphPath).call(this),y=this.chart.styledMode;[this,...this.zones].forEach((T,E)=>{let k,I=T.graph,L=I?"animate":"attr",B=T.dashStyle||c.dashStyle;I?(I.endX=this.preventGraphAnimation?null:m.xMap,I.animate({d:m})):m.length&&(T.graph=I=this.chart.renderer.path(m).addClass("highcharts-graph"+(E?` highcharts-zone-graph-${E-1} `:" ")+(E&&T.className||"")).attr({zIndex:1}).add(this.group)),I&&!y&&(k={stroke:!E&&c.lineColor||T.color||this.color||"#cccccc","stroke-width":c.lineWidth||0,fill:this.fillGraph&&this.color||"none"},B?k.dashstyle=B:c.linecap!=="square"&&(k["stroke-linecap"]=k["stroke-linejoin"]="round"),I[L](k).shadow(c.shadow&&$n({filterUnits:"userSpaceOnUse"},Qg(c.shadow)?c.shadow:{}))),I&&(I.startX=m.xMap,I.isArea=m.isArea)})}getGraphPath(c,m,y){let T=this,E=T.options,k=[],I=[],L,B=E.step,W=(c=c||T.points).reversed;return W&&c.reverse(),(B={right:1,center:2}[B]||B&&3)&&W&&(B=4-B),(c=this.getValidPoints(c,!1,E.nullInteraction||!(E.connectNulls&&!m&&!y))).forEach(function(N,H){let K,te=N.plotX,ce=N.plotY,le=c[H-1],oe=N.isNull||typeof ce!="number";(N.leftCliff||le!=null&&le.rightCliff)&&!y&&(L=!0),oe&&!$c(m)&&H>0?L=!E.connectNulls:oe&&!m?L=!0:(H===0||L?K=[["M",N.plotX,N.plotY]]:T.getPointSpline?K=[T.getPointSpline(c,N,H)]:B?(K=B===1?[["L",le.plotX,ce]]:B===2?[["L",(le.plotX+te)/2,le.plotY],["L",(le.plotX+te)/2,ce]]:[["L",te,le.plotY]]).push(["L",te,ce]):K=[["L",te,ce]],I.push(N.x),B&&(I.push(N.x),B===2&&I.push(N.x)),k.push.apply(k,K),L=!1)}),k.xMap=I,T.graphPath=k,k}}qa.defaultOptions=$n(Cr.defaultOptions,{legendSymbol:"lineMarker"}),Bn.registerSeriesType("line",qa);let{seriesTypes:{line:ya}}=Bn,{extend:Xa,merge:Ho,objectEach:kr,pick:Ff}=Ee;class qo extends ya{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:c,options:m}=this;[this,...this.zones].forEach((y,T)=>{let E={},k=y.fillColor||m.fillColor,I=y.area,L=I?"animate":"attr";I?(I.endX=this.preventGraphAnimation?null:c.xMap,I.animate({d:c})):(E.zIndex=0,(I=y.area=this.chart.renderer.path(c).addClass("highcharts-area"+(T?` highcharts-zone-area-${T-1} `:" ")+(T&&y.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(E.fill=k||y.color||this.color,E["fill-opacity"]=k?1:m.fillOpacity??.75,I.css({pointerEvents:this.stickyTracking?"none":"auto"})),I[L](E),I.startX=c.xMap,I.shiftUnit=m.step?2:1})}getGraphPath(c){let m,y,T,E=ya.prototype.getGraphPath,k=this.options,I=k.stacking,L=this.yAxis,B=[],W=[],N=this.index,H=L.stacking.stacks[this.stackKey],K=k.threshold,te=Math.round(L.getThreshold(k.threshold)),ce=Ff(k.connectNulls,I==="percent"),le=function(Ze,yt,at){let vt=c[Ze],Vt=I&&H[vt.x].points[N],ii=vt[at+"Null"]||0,li=vt[at+"Cliff"]||0,$t,gi,vi=!0;li||ii?($t=(ii?Vt[0]:Vt[1])+li,gi=Vt[0]+li,vi=!!ii):!I&&c[yt]&&c[yt].isNull&&($t=gi=K),$t!==void 0&&(W.push({plotX:m,plotY:$t===null?te:L.getThreshold($t),isNull:vi,isCliff:!0}),B.push({plotX:m,plotY:gi===null?te:L.getThreshold(gi),doCurve:!1}))};c=c||this.points,I&&(c=this.getStackPoints(c));for(let Ze=0,yt=c.length;Ze<yt;++Ze)I||(c[Ze].leftCliff=c[Ze].rightCliff=c[Ze].leftNull=c[Ze].rightNull=void 0),y=c[Ze].isNull,m=Ff(c[Ze].rectPlotX,c[Ze].plotX),T=I?Ff(c[Ze].yBottom,te):te,y&&!ce||(ce||le(Ze,Ze-1,"left"),y&&!I&&ce||(W.push(c[Ze]),B.push({x:Ze,plotX:m,plotY:T})),ce||le(Ze,Ze+1,"right"));let oe=E.call(this,W,!0,!0);B.reversed=!0;let me=E.call(this,B,!0,!0),xe=me[0];xe&&xe[0]==="M"&&(me[0]=["L",xe[1],xe[2]]);let et=oe.concat(me);et.length&&et.push(["Z"]);let Ge=E.call(this,W,!1,ce);return this.chart.series.length>1&&I&&W.some(Ze=>Ze.isCliff)&&(et.hasStackedCliffs=Ge.hasStackedCliffs=!0),et.xMap=oe.xMap,this.areaPath=et,Ge}getStackPoints(c){let m=this,y=[],T=[],E=this.xAxis,k=this.yAxis,I=k.stacking.stacks[this.stackKey],L={},B=k.series,W=B.length,N=k.options.reversedStacks?1:-1,H=B.indexOf(m);if(c=c||this.points,this.options.stacking){for(let te=0;te<c.length;te++)c[te].leftNull=c[te].rightNull=void 0,L[c[te].x]=c[te];kr(I,function(te,ce){te.total!==null&&T.push(ce)}),T.sort(function(te,ce){return te-ce});let K=B.map(te=>te.visible);T.forEach(function(te,ce){let le=0,oe,me;if(L[te]&&!L[te].isNull)y.push(L[te]),[-1,1].forEach(function(xe){let et=xe===1?"rightNull":"leftNull",Ge=I[T[ce+xe]],Ze=0;if(Ge){let yt=H;for(;yt>=0&&yt<W;){let at=B[yt].index;!(oe=Ge.points[at])&&(at===m.index?L[te][et]=!0:K[yt]&&(me=I[te].points[at])&&(Ze-=me[1]-me[0])),yt+=N}}L[te][xe===1?"rightCliff":"leftCliff"]=Ze});else{let xe=H;for(;xe>=0&&xe<W;){let et=B[xe].index;if(oe=I[te].points[et]){le=oe[1];break}xe+=N}le=Ff(le,0),le=k.translate(le,0,1,0,1),y.push({isNull:!0,plotX:E.translate(te,0,0,0,1),x:te,plotY:le,yBottom:le})}})}return y}}qo.defaultOptions=Ho(ya.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),Xa(qo.prototype,{singleStacks:!1}),Bn.registerSeriesType("area",qo);let{line:e_}=Bn.seriesTypes,{merge:Ku,pick:Ju}=Ee;class ym extends e_{getPointSpline(c,m,y){let T,E,k,I,L=m.plotX||0,B=m.plotY||0,W=c[y-1],N=c[y+1];function H(te){return te&&!te.isNull&&te.doCurve!==!1&&!m.isCliff}if(H(W)&&H(N)){let te=W.plotX||0,ce=W.plotY||0,le=N.plotX||0,oe=N.plotY||0,me=0;T=(1.5*L+te)/2.5,E=(1.5*B+ce)/2.5,k=(1.5*L+le)/2.5,I=(1.5*B+oe)/2.5,k!==T&&(me=(I-E)*(k-L)/(k-T)+B-I),E+=me,I+=me,E>ce&&E>B?(E=Math.max(ce,B),I=2*B-E):E<ce&&E<B&&(E=Math.min(ce,B),I=2*B-E),I>oe&&I>B?(I=Math.max(oe,B),E=2*B-I):I<oe&&I<B&&(I=Math.min(oe,B),E=2*B-I),m.rightContX=k,m.rightContY=I,m.controlPoints={low:[T,E],high:[k,I]}}let K=["C",Ju(W.rightContX,W.plotX,0),Ju(W.rightContY,W.plotY,0),Ju(T,L,0),Ju(E,B,0),L,B];return W.rightContX=W.rightContY=void 0,K}}ym.defaultOptions=Ku(e_.defaultOptions),Bn.registerSeriesType("spline",ym);let xm=ym,{area:pb,area:{prototype:Nf}}=Bn.seriesTypes,{extend:dx,merge:mb}=Ee;class Za extends xm{}Za.defaultOptions=mb(xm.defaultOptions,pb.defaultOptions),dx(Za.prototype,{getGraphPath:Nf.getGraphPath,getStackPoints:Nf.getStackPoints,drawGraph:Nf.drawGraph}),Bn.registerSeriesType("areaspline",Za);let{animObject:Nh}=Ds,{parse:vm}=ht,{noop:bm}=ve,{clamp:Qu,crisp:Uf,defined:fx,extend:t_,fireEvent:px,isArray:wm,isNumber:Tm,merge:Vf,pick:ed,objectEach:mx}=Ee;class _l extends Cr{animate(c){let m,y,T=this,E=this.yAxis,k=E.pos,I=E.reversed,L=T.options,{clipOffset:B,inverted:W}=this.chart,N={},H=W?"translateX":"translateY";c&&B?(N.scaleY=.001,y=Qu(E.toPixels(L.threshold||0),k,k+E.len),W?N.translateX=(y+=I?-Math.floor(B[0]):Math.ceil(B[2]))-E.len:N.translateY=y+=I?Math.ceil(B[0]):-Math.floor(B[2]),T.clipBox&&T.setClip(),T.group.attr(N)):(m=Number(T.group.attr(H)),T.group.animate({scaleY:1},t_(Nh(T.options.animation),{step:function(K,te){T.group&&(N[H]=m+te.pos*(k-m),T.group.attr(N))}})))}init(c,m){super.init.apply(this,arguments);let y=this;(c=y.chart).hasRendered&&c.series.forEach(function(T){T.type===y.type&&(T.isDirty=!0)})}getColumnMetrics(){var ce,le;let c=this,m=c.options,y=c.xAxis,T=c.yAxis,E=y.options.reversedStacks,k=y.reversed&&!E||!y.reversed&&E,I={},L,B=0;m.grouping===!1?B=1:c.chart.series.forEach(function(oe){let me,xe=oe.yAxis,et=oe.options;oe.type===c.type&&oe.reserveSpace()&&T.len===xe.len&&T.pos===xe.pos&&(et.stacking&&et.stacking!=="group"?(I[L=oe.stackKey]===void 0&&(I[L]=B++),me=I[L]):et.grouping!==!1&&(me=B++),oe.columnIndex=me)});let W=Math.min(Math.abs(y.transA)*(!((ce=y.brokenAxis)!=null&&ce.hasBreaks)&&((le=y.ordinal)==null?void 0:le.slope)||m.pointRange||y.closestPointRange||y.tickInterval||1),y.len),N=W*m.groupPadding,H=(W-2*N)/(B||1),K=Math.min(m.maxPointWidth||y.len,ed(m.pointWidth,H*(1-2*m.pointPadding))),te=(c.columnIndex||0)+ +!!k;return c.columnMetrics={width:K,offset:(H-K)/2+(N+te*H-W/2)*(k?-1:1),paddedWidth:H,columnCount:B},c.columnMetrics}crispCol(c,m,y,T){let E=this.borderWidth,k=this.chart.inverted;return T=Uf(m+T,E,k)-(m=Uf(m,E,k)),this.options.crisp&&(y=Uf(c+y,E)-(c=Uf(c,E))),{x:c,y:m,width:y,height:T}}adjustForMissingColumns(c,m,y,T){var E;if(!y.isNull&&T.columnCount>1){let k=this.xAxis.series.filter(W=>W.visible).map(W=>W.index),I=0,L=0;mx((E=this.xAxis.stacking)==null?void 0:E.stacks,W=>{var te;let N=typeof y.x=="number"?(te=W[y.x.toString()])==null?void 0:te.points:void 0,H=N==null?void 0:N[this.index],K={};if(N&&wm(H)){let ce=this.index,le=Object.keys(N).filter(oe=>!oe.match(",")&&N[oe]&&N[oe].length>1).map(parseFloat).filter(oe=>k.indexOf(oe)!==-1).filter(oe=>{let me=this.chart.series[oe].options,xe=me.stacking&&me.stack;if(fx(xe)){if(Tm(K[xe]))return ce===oe&&(ce=K[xe]),!1;K[xe]=oe}return!0}).sort((oe,me)=>me-oe);I=le.indexOf(ce),L=le.length}}),I=this.xAxis.reversed?L-1-I:I;let B=(L-1)*T.paddedWidth+m;c=(y.plotX||0)+B/2-m-I*T.paddedWidth}return c}translate(){let c=this,m=c.chart,y=c.options,T=c.dense=c.closestPointRange*c.xAxis.transA<2,E=c.borderWidth=ed(y.borderWidth,+!T),k=c.xAxis,I=c.yAxis,L=y.threshold,B=ed(y.minPointLength,5),W=c.getColumnMetrics(),N=W.width,H=c.pointXOffset=W.offset,K=c.dataMin,te=c.dataMax,ce=c.translatedThreshold=I.getThreshold(L),le=c.barW=Math.max(N,1+2*E);y.pointPadding&&y.crisp&&(le=Math.ceil(le)),Cr.prototype.translate.apply(c),c.points.forEach(function(oe){let me=ed(oe.yBottom,ce),xe=999+Math.abs(me),et=oe.plotX||0,Ge=Qu(oe.plotY,-xe,I.len+xe),Ze,yt=Math.min(Ge,me),at=Math.max(Ge,me)-yt,vt=N,Vt=et+H,ii=le;B&&Math.abs(at)<B&&(at=B,Ze=!I.reversed&&!oe.negative||I.reversed&&oe.negative,Tm(L)&&Tm(te)&&oe.y===L&&te<=L&&(I.min||0)<L&&(K!==te||(I.max||0)<=L)&&(Ze=!Ze,oe.negative=!oe.negative),yt=Math.abs(yt-ce)>B?me-B:ce-(Ze?B:0)),fx(oe.options.pointWidth)&&(Vt-=Math.round(((vt=ii=Math.ceil(oe.options.pointWidth))-N)/2)),y.centerInCategory&&(Vt=c.adjustForMissingColumns(Vt,vt,oe,W)),oe.barX=Vt,oe.pointWidth=vt,oe.tooltipPos=m.inverted?[Qu(I.len+I.pos-m.plotLeft-Ge,I.pos-m.plotLeft,I.len+I.pos-m.plotLeft),k.len+k.pos-m.plotTop-Vt-ii/2,at]:[k.left-m.plotLeft+Vt+ii/2,Qu(Ge+I.pos-m.plotTop,I.pos-m.plotTop,I.len+I.pos-m.plotTop),at],oe.shapeType=c.pointClass.prototype.shapeType||"roundedRect",oe.shapeArgs=c.crispCol(Vt,yt,ii,oe.isNull?0:at)}),px(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(c,m){let y=this.options,T=this.pointAttrToOptions||{},E=T.stroke||"borderColor",k=T["stroke-width"]||"borderWidth",I,L,B,W=c&&c.color||this.color,N=c&&c[E]||y[E]||W,H=c&&c.options.dashStyle||y.dashStyle,K=c&&c[k]||y[k]||this[k]||0,te=c!=null&&c.isNull&&y.nullInteraction?0:(c==null?void 0:c.opacity)??y.opacity??1;c&&this.zones.length&&(L=c.getZone(),W=c.options.color||L&&(L.color||c.nonZonedColor)||this.color,L&&(N=L.borderColor||N,H=L.dashStyle||H,K=L.borderWidth||K)),m&&c&&(B=(I=Vf(y.states[m],c.options.states&&c.options.states[m]||{})).brightness,W=I.color||B!==void 0&&vm(W).brighten(I.brightness).get()||W,N=I[E]||N,K=I[k]||K,H=I.dashStyle||H,te=ed(I.opacity,te));let ce={fill:W,stroke:N,"stroke-width":K,opacity:te};return H&&(ce.dashstyle=H),ce}drawPoints(c=this.points){let m,y=this,T=this.chart,E=y.options,k=E.nullInteraction,I=T.renderer,L=E.animationLimit||250;c.forEach(function(B){let W=B.plotY,N=B.graphic,H=!!N,K=N&&T.pointCount<L?"animate":"attr";Tm(W)&&(B.y!==null||k)?(m=B.shapeArgs,N&&B.hasNewShapeType()&&(N=N.destroy()),y.enabledDataSorting&&(B.startXPos=y.xAxis.reversed?-(m&&m.width||0):y.xAxis.width),!N&&(B.graphic=N=I[B.shapeType](m).add(B.group||y.group),N&&y.enabledDataSorting&&T.hasRendered&&T.pointCount<L&&(N.attr({x:B.startXPos}),H=!0,K="animate")),N&&H&&N[K](Vf(m)),T.styledMode||N[K](y.pointAttribs(B,B.selected&&"select")).shadow(B.allowShadow!==!1&&E.shadow),N&&(N.addClass(B.getClassName(),!0),N.attr({visibility:B.visible?"inherit":"hidden"}))):N&&(B.graphic=N.destroy())})}drawTracker(c=this.points){let m,y=this,T=y.chart,E=T.pointer,k=function(I){E==null||E.normalize(I);let L=E==null?void 0:E.getPointFromEvent(I);E&&L&&y.options.enableMouseTracking&&(T.isInsidePlot(I.chartX-T.plotLeft,I.chartY-T.plotTop,{visiblePlotOnly:!0})||E!=null&&E.inClass(I.target,"highcharts-data-label"))&&(E.isDirectTouch=!0,L.onMouseOver(I))};c.forEach(function(I){m=wm(I.dataLabels)?I.dataLabels:I.dataLabel?[I.dataLabel]:[],I.graphic&&(I.graphic.element.point=I),m.forEach(function(L){(L.div||L.element).point=I})}),y._hasTracking||(y.trackerGroups.forEach(function(I){y[I]&&(y[I].addClass("highcharts-tracker").on("mouseover",k).on("mouseout",function(L){E==null||E.onTrackerMouseOut(L)}).on("touchstart",k),!T.styledMode&&y.options.cursor&&y[I].css({cursor:y.options.cursor}))}),y._hasTracking=!0),px(this,"afterDrawTracker")}remove(){let c=this,m=c.chart;m.hasRendered&&m.series.forEach(function(y){y.type===c.type&&(y.isDirty=!0)}),Cr.prototype.remove.apply(c,arguments)}}_l.defaultOptions=Vf(Cr.defaultOptions,{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}),t_(_l.prototype,{directTouch:!0,getSymbol:bm,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),Bn.registerSeriesType("column",_l);let jf=_l,{getDeferredAnimation:gb}=Ds,{format:td}=wr,{defined:yl,extend:i_,fireEvent:Em,getAlignFactor:gx,isArray:Wc,isString:id,merge:$f,objectEach:_x,pick:Wf,pInt:_b,splat:n_}=Ee;(function(F){function c(){return L(this).some(W=>W==null?void 0:W.enabled)}function m(W,N,H,K,te){var Vt;let{chart:ce,enabledDataSorting:le}=this,oe=this.isCartesian&&ce.inverted,me=W.plotX,xe=W.plotY,et=H.rotation||0,Ge=yl(me)&&yl(xe)&&ce.isInsidePlot(me,Math.round(xe),{inverted:oe,paneCoordinates:!0,series:this}),Ze=et===0&&Wf(H.overflow,le?"none":"justify")==="justify",yt=this.visible&&W.visible!==!1&&yl(me)&&(W.series.forceDL||le&&!Ze||Ge||Wf(H.inside,!!this.options.stacking)&&K&&ce.isInsidePlot(me,oe?K.x+1:K.y+K.height-1,{inverted:oe,paneCoordinates:!0,series:this})),at=W.pos();if(yt&&at){var vt;let ii=N.getBBox(),li=N.getBBox(void 0,0);if(K=i_({x:at[0],y:Math.round(at[1]),width:0,height:0},K||{}),H.alignTo==="plotEdges"&&this.isCartesian&&(K[oe?"x":"y"]=0,K[oe?"width":"height"]=((Vt=this.yAxis)==null?void 0:Vt.len)||0),i_(H,{width:ii.width,height:ii.height}),vt=K,le&&this.xAxis&&!Ze&&this.setDataLabelStartPos(W,N,te,Ge,vt),N.align($f(H,{width:li.width,height:li.height}),!1,K,!1),N.alignAttr.x+=gx(H.align)*(li.width-ii.width),N.alignAttr.y+=gx(H.verticalAlign)*(li.height-ii.height),N[N.placed?"animate":"attr"]({"text-align":N.alignAttr["text-align"]||"center",x:N.alignAttr.x+(ii.width-li.width)/2,y:N.alignAttr.y+(ii.height-li.height)/2,rotationOriginX:(N.width||0)/2,rotationOriginY:(N.height||0)/2}),Ze&&K.height>=0)this.justifyDataLabel(N,H,N.alignAttr,ii,K,te);else if(Wf(H.crop,!0)){let{x:$t,y:gi}=N.alignAttr;yt=ce.isInsidePlot($t,gi,{paneCoordinates:!0,series:this})&&ce.isInsidePlot($t+ii.width-1,gi+ii.height-1,{paneCoordinates:!0,series:this})}H.shape&&!et&&N[te?"attr":"animate"]({anchorX:at[0],anchorY:at[1]})}te&&le&&(N.placed=!1),yt||le&&!Ze?(N.show(),N.placed=!0):(N.hide(),N.placed=!1)}function y(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function T(W){let N=this.hasRendered||0,H=this.initDataLabelsGroup().attr({opacity:+N});return!N&&H&&(this.visible&&H.show(),this.options.animation?H.animate({opacity:1},W):H.attr({opacity:1})),H}function E(W){var yt;let N;W=W||this.points;let H=this,K=H.chart,te=H.options,ce=K.renderer,{backgroundColor:le,plotBackgroundColor:oe}=K.options.chart,me=ce.getContrast(id(oe)&&oe||id(le)&&le||"#000000"),xe=L(H),{animation:et,defer:Ge}=xe[0],Ze=Ge?gb(K,et,H):{defer:0,duration:0};Em(this,"drawDataLabels"),(yt=H.hasDataLabels)!=null&&yt.call(H)&&(N=this.initDataLabels(Ze),W.forEach(at=>{var li,$t,gi;let vt=at.dataLabels||[],Vt=at.color||H.color;n_(I(xe,at.dlOptions||((li=at.options)==null?void 0:li.dataLabels))).forEach((vi,Wi)=>{var rs;let Ti=vi.enabled&&(at.visible||at.dataLabelOnHidden)&&(!at.isNull||at.dataLabelOnNull)&&function(ds,wo){let Xo=wo.filter;if(Xo){let xa=Xo.operator,ro=ds[Xo.property],er=Xo.value;return xa===">"&&ro>er||xa==="<"&&ro<er||xa===">="&&ro>=er||xa==="<="&&ro<=er||xa==="=="&&ro==er||xa==="==="&&ro===er||xa==="!="&&ro!=er||xa==="!=="&&ro!==er||!1}return!0}(at,vi),{backgroundColor:Gi,borderColor:xn,distance:hn,style:En={}}=vi,zr,vn,Wn,Ki={},xi=vt[Wi],Bs=!xi,Gn;Ti&&(vn=yl(zr=Wf(vi[at.formatPrefix+"Format"],vi.format))?td(zr,at,K):(vi[at.formatPrefix+"Formatter"]||vi.formatter).call(at,vi),Wn=vi.rotation,!K.styledMode&&(En.color=Wf(vi.color,En.color,id(H.color)?H.color:void 0,"#000000"),En.color==="contrast"?(Gi!=="none"&&(Gn=Gi),at.contrastColor=ce.getContrast(Gn!=="auto"&&id(Gn)&&Gn||(id(Vt)?Vt:"")),En.color=Gn||!yl(hn)&&vi.inside||0>_b(hn||0)||te.stacking?at.contrastColor:me):delete at.contrastColor,te.cursor&&(En.cursor=te.cursor)),Ki={r:vi.borderRadius||0,rotation:Wn,padding:vi.padding,zIndex:1},K.styledMode||(Ki.fill=Gi==="auto"?at.color:Gi,Ki.stroke=xn==="auto"?at.color:xn,Ki["stroke-width"]=vi.borderWidth),_x(Ki,(ds,wo)=>{ds===void 0&&delete Ki[wo]})),!xi||Ti&&yl(vn)&&!!(xi.div||(rs=xi.text)!=null&&rs.foreignObject)==!!vi.useHTML&&(xi.rotation&&vi.rotation||xi.rotation===vi.rotation)||(xi=void 0,Bs=!0),Ti&&yl(vn)&&(xi?Ki.text=vn:(xi=ce.label(vn,0,0,vi.shape,void 0,void 0,vi.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+at.colorIndex+" "+(vi.className||"")+(vi.useHTML?" highcharts-tracker":"")),xi&&(xi.options=vi,xi.attr(Ki),K.styledMode?En.width&&xi.css({width:En.width,textOverflow:En.textOverflow,whiteSpace:En.whiteSpace}):xi.css(En).shadow(vi.shadow),Em(xi,"beforeAddingDataLabel",{labelOptions:vi,point:at}),xi.added||xi.add(N),H.alignDataLabel(at,xi,vi,void 0,Bs),xi.isActive=!0,vt[Wi]&&vt[Wi]!==xi&&vt[Wi].destroy(),vt[Wi]=xi))});let ii=vt.length;for(;ii--;)($t=vt[ii])!=null&&$t.isActive?vt[ii].isActive=!1:((gi=vt[ii])==null||gi.destroy(),vt.splice(ii,1));at.dataLabel=vt[0],at.dataLabels=vt})),Em(this,"afterDrawDataLabels")}function k(W,N,H,K,te,ce){let le=this.chart,oe=N.align,me=N.verticalAlign,xe=W.box?0:W.padding||0,et=le.inverted?this.yAxis:this.xAxis,Ge=et?et.left-le.plotLeft:0,Ze=le.inverted?this.xAxis:this.yAxis,yt=Ze?Ze.top-le.plotTop:0,{x:at=0,y:vt=0}=N,Vt,ii;return(Vt=(H.x||0)+xe+Ge)<0&&(oe==="right"&&at>=0?(N.align="left",N.inside=!0):at-=Vt,ii=!0),(Vt=(H.x||0)+K.width-xe+Ge)>le.plotWidth&&(oe==="left"&&at<=0?(N.align="right",N.inside=!0):at+=le.plotWidth-Vt,ii=!0),(Vt=H.y+xe+yt)<0&&(me==="bottom"&&vt>=0?(N.verticalAlign="top",N.inside=!0):vt-=Vt,ii=!0),(Vt=(H.y||0)+K.height-xe+yt)>le.plotHeight&&(me==="top"&&vt<=0?(N.verticalAlign="bottom",N.inside=!0):vt+=le.plotHeight-Vt,ii=!0),ii&&(N.x=at,N.y=vt,W.placed=!ce,W.align(N,void 0,te)),ii}function I(W,N){let H=[],K;if(Wc(W)&&!Wc(N))H=W.map(function(te){return $f(te,N)});else if(Wc(N)&&!Wc(W))H=N.map(function(te){return $f(W,te)});else if(Wc(W)||Wc(N)){if(Wc(W)&&Wc(N))for(K=Math.max(W.length,N.length);K--;)H[K]=$f(W[K],N[K])}else H=$f(W,N);return H}function L(W){var H,K;let N=W.chart.options.plotOptions;return n_(I(I((H=N==null?void 0:N.series)==null?void 0:H.dataLabels,(K=N==null?void 0:N[W.type])==null?void 0:K.dataLabels),W.options.dataLabels))}function B(W,N,H,K,te){let ce=this.chart,le=ce.inverted,oe=this.xAxis,me=oe.reversed,xe=((le?N.height:N.width)||0)/2,et=W.pointWidth,Ge=et?et/2:0;N.startXPos=le?te.x:me?-xe-Ge:oe.width-xe+Ge,N.startYPos=le?me?this.yAxis.height-xe+Ge:-xe-Ge:te.y,K?N.visibility==="hidden"&&(N.show(),N.attr({opacity:0}).animate({opacity:1})):N.attr({opacity:1}).animate({opacity:0},void 0,N.hide),ce.hasRendered&&(H&&N.attr({x:N.startXPos,y:N.startYPos}),N.placed=!0)}F.compose=function(W){let N=W.prototype;N.initDataLabels||(N.initDataLabels=T,N.initDataLabelsGroup=y,N.alignDataLabel=m,N.drawDataLabels=E,N.justifyDataLabel=k,N.mergeArrays=I,N.setDataLabelStartPos=B,N.hasDataLabels=c)}})(de||(de={}));let Gf=de,{composed:yx}=ve,{series:Sm}=Bn,{merge:Zl,pushUnique:bo}=Ee;(function(F){function c(m,y,T,E,k){var ce,le;let{chart:I,options:L}=this,B=I.inverted,W=((ce=this.xAxis)==null?void 0:ce.len)||I.plotSizeX||0,N=((le=this.yAxis)==null?void 0:le.len)||I.plotSizeY||0,H=m.dlBox||m.shapeArgs,K=m.below??(m.plotY||0)>(this.translatedThreshold??N),te=T.inside??!!L.stacking;if(H){if(E=Zl(H),T.overflow!=="allow"||T.crop!==!1||L.clip!==!1){E.y<0&&(E.height+=E.y,E.y=0);let oe=E.y+E.height-N;oe>0&&oe<E.height-1&&(E.height-=oe)}B&&(E={x:N-E.y-E.height,y:W-E.x-E.width,width:E.height,height:E.width}),te||(B?(E.x+=K?0:E.width,E.width=0):(E.y+=K?E.height:0,E.height=0))}T.align??(T.align=!B||te?"center":K?"right":"left"),T.verticalAlign??(T.verticalAlign=B||te?"middle":K?"top":"bottom"),Sm.prototype.alignDataLabel.call(this,m,y,T,E,k),T.inside&&m.contrastColor&&y.css({color:m.contrastColor})}F.compose=function(m){Gf.compose(Sm),bo(yx,"ColumnDataLabel")&&(m.prototype.alignDataLabel=c)}})(ye||(ye={}));let yb=ye,{extend:s_,merge:xb}=Ee;class r_ extends jf{}r_.defaultOptions=xb(jf.defaultOptions,{}),s_(r_.prototype,{inverted:!0}),Bn.registerSeriesType("bar",r_);let{column:vb,line:Mm}=Bn.seriesTypes,{addEvent:Cm,extend:xx,merge:Uh}=Ee;class Gc extends Mm{applyJitter(){let c=this,m=this.options.jitter,y=this.points.length;m&&this.points.forEach(function(T,E){["x","y"].forEach(function(k,I){if(m[k]&&!T.isNull){let L=`plot${k.toUpperCase()}`,B=c[`${k}Axis`],W=m[k]*B.transA;if(B&&!B.logarithmic){let N=Math.max(0,(T[L]||0)-W),H=Math.min(B.len,(T[L]||0)+W);T[L]=N+(H-N)*function(K){let te=1e4*Math.sin(K);return te-Math.floor(te)}(E+I*y),k==="x"&&(T.clientX=T.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}Gc.defaultOptions=Uh(Mm.defaultOptions,{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}"></span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),xx(Gc.prototype,{drawTracker:vb.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),Cm(Gc,"afterTranslate",function(){this.applyJitter()}),Bn.registerSeriesType("scatter",Gc);let{deg2rad:vx}=ve,{fireEvent:bb,isNumber:o_,pick:Am,relativeLength:wb}=Ee;(function(F){F.getCenter=function(){let c=this.options,m=this.chart,y=2*(c.slicedOffset||0),T=m.plotWidth-2*y,E=m.plotHeight-2*y,k=c.center,I=Math.min(T,E),L=c.thickness,B,W=c.size,N=c.innerSize||0,H,K;typeof W=="string"&&(W=parseFloat(W)),typeof N=="string"&&(N=parseFloat(N));let te=[Am(k==null?void 0:k[0],"50%"),Am(k==null?void 0:k[1],"50%"),Am(W&&W<0?void 0:c.size,"100%"),Am(N&&N<0?void 0:c.innerSize||0,"0%")];for(!m.angular||this instanceof Cr||(te[3]=0),H=0;H<4;++H)K=te[H],B=H<2||H===2&&/%$/.test(K),te[H]=wb(K,[T,E,I,te[2]][H])+(B?y:0);return te[3]>te[2]&&(te[3]=te[2]),o_(L)&&2*L<te[2]&&L>0&&(te[3]=te[2]-2*L),bb(this,"afterGetCenter",{positions:te}),te},F.getStartAndEndRadians=function(c,m){let y=o_(c)?c:0,T=o_(m)&&m>y&&m-y<360?m:y+360;return{start:vx*(y+-90),end:vx*(T+-90)}}})(be||(be={}));let bx=be,{setAnimation:Tb}=Ds,{addEvent:km,defined:Eb,extend:nd,isNumber:Sb,pick:Gs,relativeLength:Im}=Ee;class a_ extends re{getConnectorPath(c){let m=c.dataLabelPosition,y=c.options||{},T=y.connectorShape,E=this.connectorShapes[T]||T;return m&&E.call(this,{...m.computed,alignment:m.alignment},m.connectorPosition,y)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(c){let m=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(m.x,m.y,m.r+c,m.r+c,{innerR:m.r-1,start:m.start,end:m.end,borderRadius:m.borderRadius})}constructor(c,m,y){super(c,m,y),this.half=0,this.name??(this.name=c.chart.options.lang.pieSliceName);let T=E=>{this.slice(E.type==="select")};km(this,"select",T),km(this,"unselect",T)}isValid(){return Sb(this.y)&&this.y>=0}setVisible(c,m=!0){c!==this.visible&&this.update({visible:c??!this.visible},m,void 0,!1)}slice(c,m,y){let T=this.series;Tb(y,T.chart),m=Gs(m,!0),this.sliced=this.options.sliced=c=Eb(c)?c:!this.sliced,T.options.data[T.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}nd(a_.prototype,{connectorShapes:{fixedOffset:function(F,c,m){let y=c.breakAt,T=c.touchingSliceAt,E=m.softConnector?["C",F.x+(F.alignment==="left"?-5:5),F.y,2*y.x-T.x,2*y.y-T.y,y.x,y.y]:["L",y.x,y.y];return[["M",F.x,F.y],E,["L",T.x,T.y]]},straight:function(F,c){let m=c.touchingSliceAt;return[["M",F.x,F.y],["L",m.x,m.y]]},crookedLine:function(F,c,m){let{angle:y=this.angle||0,breakAt:T,touchingSliceAt:E}=c,{series:k}=this,[I,L,B]=k.center,W=B/2,{plotLeft:N,plotWidth:H}=k.chart,K=F.alignment==="left",{x:te,y:ce}=F,le=T.x;if(m.crookDistance){let me=Im(m.crookDistance,1);le=K?I+W+(H+N-I-W)*(1-me):N+(I-W)*me}else le=I+(L-ce)*Math.tan(y-Math.PI/2);let oe=[["M",te,ce]];return(K?le<=te&&le>=T.x:le>=te&&le<=T.x)&&oe.push(["L",le,ce]),oe.push(["L",T.x,T.y],["L",E.x,E.y]),oe}}});let{getStartAndEndRadians:Pm}=bx,{noop:Hf}=ve,{clamp:qf,extend:wx,fireEvent:l_,merge:Vh,pick:c_}=Ee;class Xf extends Cr{animate(c){let m=this,y=m.points,T=m.startAngleRad;c||y.forEach(function(E){let k=E.graphic,I=E.shapeArgs;k&&I&&(k.attr({r:c_(E.startR,m.center&&m.center[3]/2),start:T,end:T}),k.animate({r:I.r,start:I.start,end:I.end},m.options.animation))})}drawEmpty(){let c,m,y=this.startAngleRad,T=this.endAngleRad,E=this.options;this.total===0&&this.center?(c=this.center[0],m=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(c,m,this.center[1]/2,0,y,T).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:wu.arc(c,m,this.center[2]/2,0,{start:y,end:T,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":E.borderWidth,fill:E.fillColor||"none",stroke:E.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let c=this.chart.renderer;this.points.forEach(function(m){m.graphic&&m.hasNewShapeType()&&(m.graphic=m.graphic.destroy()),m.graphic||(m.graphic=c[m.shapeType](m.shapeArgs).add(m.series.group),m.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(c,m,y,T){let E=this.center,k=this.radii?this.radii[y.index]||0:E[2]/2,I=T.dataLabelPosition,L=(I==null?void 0:I.distance)||0,B=Math.asin(qf((c-E[1])/(k+L),-1,1));return E[0]+Math.cos(B)*(k+L)*(m?-1:1)+(L>0?(m?-1:1)*(T.padding||0):0)}hasData(){return!!this.dataTable.rowCount}redrawPoints(){let c,m,y,T,E=this,k=E.chart;this.drawEmpty(),E.group&&!k.styledMode&&E.group.shadow(E.options.shadow),E.points.forEach(function(I){let L={};m=I.graphic,!I.isNull&&m?(T=I.shapeArgs,c=I.getTranslate(),k.styledMode||(y=E.pointAttribs(I,I.selected&&"select")),I.delayedRendering?(m.setRadialReference(E.center).attr(T).attr(c),k.styledMode||m.attr(y).attr({"stroke-linejoin":"round"}),I.delayedRendering=!1):(m.setRadialReference(E.center),k.styledMode||Vh(!0,L,y),Vh(!0,L,T,c),m.animate(L)),m.attr({visibility:I.visible?"inherit":"hidden"}),m.addClass(I.getClassName(),!0)):m&&(I.graphic=m.destroy())})}sortByAngle(c,m){c.sort(function(y,T){return y.angle!==void 0&&(T.angle-y.angle)*m})}translate(c){l_(this,"translate"),this.generatePoints();let m=this.options,y=m.slicedOffset,T=Pm(m.startAngle,m.endAngle),E=this.startAngleRad=T.start,k=(this.endAngleRad=T.end)-E,I=this.points,L=m.ignoreHiddenPoint,B=I.length,W,N,H,K,te,ce,le,oe=0;for(c||(this.center=c=this.getCenter()),ce=0;ce<B;ce++){le=I[ce],W=E+oe*k,le.isValid()&&(!L||le.visible)&&(oe+=le.percentage/100),N=E+oe*k;let me={x:c[0],y:c[1],r:c[2]/2,innerR:c[3]/2,start:Math.round(1e3*W)/1e3,end:Math.round(1e3*N)/1e3};le.shapeType="arc",le.shapeArgs=me,(H=(N+W)/2)>1.5*Math.PI?H-=2*Math.PI:H<-Math.PI/2&&(H+=2*Math.PI),le.slicedTranslation={translateX:Math.round(Math.cos(H)*y),translateY:Math.round(Math.sin(H)*y)},K=Math.cos(H)*c[2]/2,te=Math.sin(H)*c[2]/2,le.tooltipPos=[c[0]+.7*K,c[1]+.7*te],le.half=+(H<-Math.PI/2||H>Math.PI/2),le.angle=H}l_(this,"afterTranslate")}updateTotals(){let c=this.points,m=c.length,y=this.options.ignoreHiddenPoint,T,E,k=0;for(T=0;T<m;T++)(E=c[T]).isValid()&&(!y||E.visible)&&(k+=E.y);for(T=0,this.total=k;T<m;T++)(E=c[T]).percentage=k>0&&(E.visible||!y)?E.y/k*100:0,E.total=k}}Xf.defaultOptions=Vh(Cr.defaultOptions,{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.isNull?void 0:this.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}),wx(Xf.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:jf.prototype.drawTracker,getCenter:bx.getCenter,getSymbol:Hf,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:jf.prototype.pointAttribs,pointClass:a_,requireSorting:!1,searchPoint:Hf,trackerGroups:["group","dataLabelsGroup"]}),Bn.registerSeriesType("pie",Xf);let{composed:h_,noop:Mb}=ve,{distribute:Tx}=sl,{series:sd}=Bn,{arrayMax:Cb,clamp:Lm,defined:Ex,pick:u_,pushUnique:d_,relativeLength:Zf}=Ee;(function(F){let c={radialDistributionY:function(k,I){var L;return(((L=I.dataLabelPosition)==null?void 0:L.top)||0)+k.distributeBox.pos},radialDistributionX:function(k,I,L,B,W){let N=W.dataLabelPosition;return k.getX(L<((N==null?void 0:N.top)||0)+2||L>((N==null?void 0:N.bottom)||0)-2?B:L,I.half,I,W)},justify:function(k,I,L,B){var W;return B[0]+(k.half?-1:1)*(L+(((W=I.dataLabelPosition)==null?void 0:W.distance)||0))},alignToPlotEdges:function(k,I,L,B){let W=k.getBBox().width;return I?W+B:L-W-B},alignToConnectors:function(k,I,L,B){let W=0,N;return k.forEach(function(H){(N=H.dataLabel.getBBox().width)>W&&(W=N)}),I?W+B:L-W-B}};function m(k,I){let L=Math.PI/2,{start:B=0,end:W=0}=k.shapeArgs||{},N=k.angle||0;I>0&&B<L&&W>L&&N>L/2&&N<1.5*L&&(N=N<=L?Math.max(L/2,(B+L)/2):Math.min(1.5*L,(L+W)/2));let{center:H,options:K}=this,te=H[2]/2,ce=Math.cos(N),le=Math.sin(N),oe=H[0]+ce*te,me=H[1]+le*te,xe=Math.min((K.slicedOffset||0)+(K.borderWidth||0),I/5);return{natural:{x:oe+ce*I,y:me+le*I},computed:{},alignment:I<0?"center":k.half?"right":"left",connectorPosition:{angle:N,breakAt:{x:oe+ce*xe,y:me+le*xe},touchingSliceAt:{x:oe,y:me}},distance:I}}function y(){var yt;let k=this,I=k.points,L=k.chart,B=L.plotWidth,W=L.plotHeight,N=L.plotLeft,H=Math.round(L.chartWidth/3),K=k.center,te=K[2]/2,ce=K[1],le=[[],[]],oe=[0,0,0,0],me=k.dataLabelPositioners,xe,et,Ge,Ze=0;k.visible&&((yt=k.hasDataLabels)!=null&&yt.call(k))&&(I.forEach(at=>{(at.dataLabels||[]).forEach(vt=>{vt.shortened&&(vt.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),vt.shortened=!1)})}),sd.prototype.drawDataLabels.apply(k),I.forEach(at=>{(at.dataLabels||[]).forEach((vt,Vt)=>{var gi;let ii=K[2]/2,li=vt.options,$t=Zf((li==null?void 0:li.distance)||0,ii);Vt===0&&le[at.half].push(at),!Ex((gi=li==null?void 0:li.style)==null?void 0:gi.width)&&vt.getBBox().width>H&&(vt.css({width:Math.round(.7*H)+"px"}),vt.shortened=!0),vt.dataLabelPosition=this.getDataLabelPosition(at,$t),Ze=Math.max(Ze,$t)})}),le.forEach((at,vt)=>{let Vt=at.length,ii=[],li,$t,gi=0,vi;Vt&&(k.sortByAngle(at,vt-.5),Ze>0&&(li=Math.max(0,ce-te-Ze),$t=Math.min(ce+te+Ze,L.plotHeight),at.forEach(Wi=>{(Wi.dataLabels||[]).forEach(Ti=>{var xn;let Gi=Ti.dataLabelPosition;Gi&&Gi.distance>0&&(Gi.top=Math.max(0,ce-te-Gi.distance),Gi.bottom=Math.min(ce+te+Gi.distance,L.plotHeight),gi=Ti.getBBox().height||21,Ti.lineHeight=L.renderer.fontMetrics(Ti.text||Ti).h+2*Ti.padding,Wi.distributeBox={target:(((xn=Ti.dataLabelPosition)==null?void 0:xn.natural.y)||0)-Gi.top+Ti.lineHeight/2,size:gi,rank:Wi.y},ii.push(Wi.distributeBox))})}),Tx(ii,vi=$t+gi-li,vi/5)),at.forEach(Wi=>{(Wi.dataLabels||[]).forEach(Ti=>{let Gi=Ti.options||{},xn=Wi.distributeBox,hn=Ti.dataLabelPosition,En=(hn==null?void 0:hn.natural.y)||0,zr=Gi.connectorPadding||0,vn=Ti.lineHeight||21,Wn=(vn-Ti.getBBox().height)/2,Ki=0,xi=En,Bs="inherit";if(hn){if(ii&&Ex(xn)&&hn.distance>0&&(xn.pos===void 0?Bs="hidden":(Ge=xn.size,xi=me.radialDistributionY(Wi,Ti))),Gi.justify)Ki=me.justify(Wi,Ti,te,K);else switch(Gi.alignTo){case"connectors":Ki=me.alignToConnectors(at,vt,B,N);break;case"plotEdges":Ki=me.alignToPlotEdges(Ti,vt,B,N);break;default:Ki=me.radialDistributionX(k,Wi,xi-Wn,En,Ti)}if(hn.attribs={visibility:Bs,align:hn.alignment},hn.posAttribs={x:Ki+(Gi.x||0)+({left:zr,right:-zr}[hn.alignment]||0),y:xi+(Gi.y||0)-vn/2},hn.computed.x=Ki,hn.computed.y=xi-Wn,u_(Gi.crop,!0)){let Gn;Ki-(et=Ti.getBBox().width)<zr&&vt===1?(Gn=Math.round(et-Ki+zr),oe[3]=Math.max(Gn,oe[3])):Ki+et>B-zr&&vt===0&&(Gn=Math.round(Ki+et-B+zr),oe[1]=Math.max(Gn,oe[1])),xi-Ge/2<0?oe[0]=Math.max(Math.round(-xi+Ge/2),oe[0]):xi+Ge/2>W&&(oe[2]=Math.max(Math.round(xi+Ge/2-W),oe[2])),hn.sideOverflow=Gn}}})}))}),(Cb(oe)===0||this.verifyDataLabelOverflow(oe))&&(this.placeDataLabels(),this.points.forEach(at=>{(at.dataLabels||[]).forEach(vt=>{var $t;let{connectorColor:Vt,connectorWidth:ii=1}=vt.options||{},li=vt.dataLabelPosition;if(ii){let gi;xe=vt.connector,li&&li.distance>0?(gi=!xe,xe||(vt.connector=xe=L.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+at.colorIndex+(at.className?" "+at.className:"")).add(k.dataLabelsGroup)),L.styledMode||xe.attr({"stroke-width":ii,stroke:Vt||at.color||"#666666"}),xe[gi?"attr":"animate"]({d:at.getConnectorPath(vt)}),xe.attr({visibility:($t=li.attribs)==null?void 0:$t.visibility})):xe&&(vt.connector=xe.destroy())}})})))}function T(){this.points.forEach(k=>{(k.dataLabels||[]).forEach(I=>{var B,W;let L=I.dataLabelPosition;L?(L.sideOverflow&&(I.css({width:Math.max(I.getBBox().width-L.sideOverflow,0)+"px",textOverflow:((W=(B=I.options)==null?void 0:B.style)==null?void 0:W.textOverflow)||"ellipsis"}),I.shortened=!0),I.attr(L.attribs),I[I.moved?"animate":"attr"](L.posAttribs),I.moved=!0):I&&I.attr({y:-9999})}),delete k.distributeBox},this)}function E(k){let I=this.center,L=this.options,B=L.center,W=L.minSize||80,N=W,H=L.size!==null;return!H&&(B[0]!==null?N=Math.max(I[2]-Math.max(k[1],k[3]),W):(N=Math.max(I[2]-k[1]-k[3],W),I[0]+=(k[3]-k[1])/2),B[1]!==null?N=Lm(N,W,I[2]-Math.max(k[0],k[2])):(N=Lm(N,W,I[2]-k[0]-k[2]),I[1]+=(k[0]-k[2])/2),N<I[2]?(I[2]=N,I[3]=Math.min(L.thickness?Math.max(0,N-2*L.thickness):Math.max(0,Zf(L.innerSize||0,N)),N),this.translate(I),this.drawDataLabels&&this.drawDataLabels()):H=!0),H}F.compose=function(k){if(Gf.compose(sd),d_(h_,"PieDataLabel")){let I=k.prototype;I.dataLabelPositioners=c,I.alignDataLabel=Mb,I.drawDataLabels=y,I.getDataLabelPosition=m,I.placeDataLabels=T,I.verifyDataLabelOverflow=E}}})(se||(se={}));let Ab=se;(function(F){F.getCenterOfPoints=function(c){let m=c.reduce((y,T)=>(y.x+=T.x,y.y+=T.y,y),{x:0,y:0});return{x:m.x/c.length,y:m.y/c.length}},F.getDistanceBetweenPoints=function(c,m){return Math.sqrt(Math.pow(m.x-c.x,2)+Math.pow(m.y-c.y,2))},F.getAngleBetweenPoints=function(c,m){return Math.atan2(m.x-c.x,m.y-c.y)},F.pointInPolygon=function({x:c,y:m},y){let T=y.length,E,k,I=!1;for(E=0,k=T-1;E<T;k=E++){let[L,B]=y[E],[W,N]=y[k];B>m!=N>m&&c<(W-L)*(m-B)/(N-B)+L&&(I=!I)}return I}})(he||(he={}));let{pointInPolygon:kb}=he,{addEvent:Ib,getAlignFactor:Pb,fireEvent:Sx,objectEach:Mx,pick:Dm}=Ee;function Lb(F){let c=F.length,m=(W,N)=>!(N.x>=W.x+W.width||N.x+N.width<=W.x||N.y>=W.y+W.height||N.y+N.height<=W.y),y=(W,N)=>{for(let H of W)if(kb({x:H[0],y:H[1]},N))return!0;return!1},T,E,k,I,L,B=!1;for(let W=0;W<c;W++)(T=F[W])&&(T.oldOpacity=T.opacity,T.newOpacity=1,T.absoluteBox=function(N){var H,K;if(N&&(!N.alignAttr||N.placed)){let te=N.box?0:N.padding||0,ce=N.alignAttr||{x:N.attr("x"),y:N.attr("y")},{height:le,polygon:oe,width:me}=N.getBBox(),xe=Pb(N.alignValue)*me;return N.width=me,N.height=le,{x:ce.x+(((H=N.parentGroup)==null?void 0:H.translateX)||0)+te-xe,y:ce.y+(((K=N.parentGroup)==null?void 0:K.translateY)||0)+te,width:me-2*te,height:le-2*te,polygon:oe}}}(T));F.sort((W,N)=>(N.labelrank||0)-(W.labelrank||0));for(let W=0;W<c;++W){I=(E=F[W])&&E.absoluteBox;let N=I==null?void 0:I.polygon;for(let H=W+1;H<c;++H){L=(k=F[H])&&k.absoluteBox;let K=!1;if(I&&L&&E!==k&&E.newOpacity!==0&&k.newOpacity!==0&&E.visibility!=="hidden"&&k.visibility!=="hidden"){let te=L.polygon;if(N&&te&&N!==te?y(N,te)&&(K=!0):m(I,L)&&(K=!0),K){let ce=E.labelrank<k.labelrank?E:k,le=ce.text;ce.newOpacity=0,le!=null&&le.element.querySelector("textPath")&&le.hide()}}}}for(let W of F)f_(W,this)&&(B=!0);B&&Sx(this,"afterHideAllOverlappingLabels")}function f_(F,c){let m,y=!1;return F&&(m=F.newOpacity,F.oldOpacity!==m&&(F.hasClass("highcharts-data-label")?(F[m?"removeClass":"addClass"]("highcharts-data-label-hidden"),y=!0,F[F.isOld?"animate":"attr"]({opacity:m},void 0,function(){c.styledMode||F.css({pointerEvents:m?"auto":"none"})}),Sx(c,"afterHideOverlappingLabel")):F.attr({opacity:m})),F.isOld=!0),y}function rd(){var m;let F=this,c=[];for(let y of F.labelCollectors||[])c=c.concat(y());for(let y of F.yAxis||[])y.stacking&&y.options.stackLabels&&!y.options.stackLabels.allowOverlap&&Mx(y.stacking.stacks,T=>{Mx(T,E=>{E.label&&c.push(E.label)})});for(let y of F.series||[])if(y.visible&&((m=y.hasDataLabels)!=null&&m.call(y))){let T=E=>{for(let k of E)k.visible&&(k.dataLabels||[]).forEach(I=>{var B;let L=I.options||{};I.labelrank=Dm(L.labelrank,k.labelrank,(B=k.shapeArgs)==null?void 0:B.height),L.allowOverlap??Number(L.distance)>0?(I.oldOpacity=I.opacity,I.newOpacity=1,f_(I,F)):c.push(I)})};T(y.nodes||[]),T(y.points)}this.hideOverlappingLabels(c)}let Cx={compose:function(F){let c=F.prototype;c.hideOverlappingLabels||(c.hideOverlappingLabels=Lb,Ib(F,"render",rd))}},{defaultOptions:Db}=Fe,{noop:Ax}=ve,{addEvent:p_,extend:kx,isObject:Ix,merge:Ob,relativeLength:m_}=Ee,g_={radius:0,scope:"stack",where:void 0},Yf=Ax,Kf=Ax;function Rb(F,c,m,y,T={}){let E=Yf(F,c,m,y,T),{innerR:k=0,r:I=m,start:L=0,end:B=0}=T;if(T.open||!T.borderRadius)return E;let W=B-L,N=Math.sin(W/2),H=Math.max(Math.min(m_(T.borderRadius||0,I-k),(I-k)/2,I*N/(1+N)),0),K=Math.min(H,W/Math.PI*2*k),te=E.length-1;for(;te--;)(function(ce,le,oe){let me,xe,et,Ge=ce[le],Ze=ce[le+1];if(Ze[0]==="Z"&&(Ze=ce[0]),(Ge[0]==="M"||Ge[0]==="L")&&Ze[0]==="A"?(me=Ge,xe=Ze,et=!0):Ge[0]==="A"&&(Ze[0]==="M"||Ze[0]==="L")&&(me=Ze,xe=Ge),me&&xe&&xe.params){let yt=xe[1],at=xe[5],vt=xe.params,{start:Vt,end:ii,cx:li,cy:$t}=vt,gi=at?yt-oe:yt+oe,vi=gi?Math.asin(oe/gi):0,Wi=at?vi:-vi,Ti=Math.cos(vi)*gi;et?(vt.start=Vt+Wi,me[1]=li+Ti*Math.cos(Vt),me[2]=$t+Ti*Math.sin(Vt),ce.splice(le+1,0,["A",oe,oe,0,0,1,li+yt*Math.cos(vt.start),$t+yt*Math.sin(vt.start)])):(vt.end=ii-Wi,xe[6]=li+yt*Math.cos(vt.end),xe[7]=$t+yt*Math.sin(vt.end),ce.splice(le+1,0,["A",oe,oe,0,0,1,li+Ti*Math.cos(ii),$t+Ti*Math.sin(ii)])),xe[4]=Math.abs(vt.end-vt.start)<Math.PI?0:1}})(E,te,te>1?K:H);return E}function zb(){var F,c;if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:m,yAxis:y}=this,T=m.stacking==="percent",E=(c=(F=Db.plotOptions)==null?void 0:F[this.type])==null?void 0:c.borderRadius,k=jh(m.borderRadius,Ix(E)?E:{}),I=y.options.reversed;for(let L of this.points){let{shapeArgs:B}=L;if(L.shapeType==="roundedRect"&&B){let{width:W=0,height:N=0,y:H=0}=B,K=H,te=N;if(k.scope==="stack"&&L.stackTotal){let me=y.translate(T?100:L.stackTotal,!1,!0,!1,!0),xe=y.translate(m.threshold||0,!1,!0,!1,!0),et=this.crispCol(0,Math.min(me,xe),0,Math.abs(me-xe));K=et.y,te=et.height}let ce=(L.negative?-1:1)*(I?-1:1)==-1,le=k.where;!le&&this.is("waterfall")&&Math.abs((L.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(le="all"),le||(le="end");let oe=Math.min(m_(k.radius,W),W/2,le==="all"?N/2:1/0)||0;le==="end"&&(ce&&(K-=oe),te+=oe),kx(B,{brBoxHeight:te,brBoxY:K,r:oe})}}}}function jh(F,c){return Ix(F)||(F={radius:F||0}),Ob(g_,c,F)}function Jf(){let F=jh(this.options.borderRadius);for(let c of this.points){let m=c.shapeArgs;m&&(m.borderRadius=m_(F.radius,(m.r||0)-(m.innerR||0)))}}function Px(F,c,m,y,T={}){let E=Kf(F,c,m,y,T),{r:k=0,brBoxHeight:I=y,brBoxY:L=c}=T,B=c-L,W=L+I-(c+y),N=B-k>-.1?0:k,H=W-k>-.1?0:k,K=Math.max(N&&B,0),te=Math.max(H&&W,0),ce=[F+N,c],le=[F+m-N,c],oe=[F+m,c+N],me=[F+m,c+y-H],xe=[F+m-H,c+y],et=[F+H,c+y],Ge=[F,c+y-H],Ze=[F,c+N],yt=(at,vt)=>Math.sqrt(Math.pow(at,2)-Math.pow(vt,2));if(K){let at=yt(N,N-K);ce[0]-=at,le[0]+=at,oe[1]=Ze[1]=c+N-K}if(y<N-K){let at=yt(N,N-K-y);oe[0]=me[0]=F+m-N+at,xe[0]=Math.min(oe[0],xe[0]),et[0]=Math.max(me[0],et[0]),Ge[0]=Ze[0]=F+N-at,oe[1]=Ze[1]=c+y}if(te){let at=yt(H,H-te);xe[0]+=at,et[0]-=at,me[1]=Ge[1]=c+y-H+te}if(y<H-te){let at=yt(H,H-te-y);oe[0]=me[0]=F+m-H+at,le[0]=Math.min(oe[0],le[0]),ce[0]=Math.max(me[0],ce[0]),Ge[0]=Ze[0]=F+H-at,me[1]=Ge[1]=c}return E.length=0,E.push(["M",...ce],["L",...le],["A",N,N,0,0,1,...oe],["L",...me],["A",H,H,0,0,1,...xe],["L",...et],["A",H,H,0,0,1,...Ge],["L",...Ze],["A",N,N,0,0,1,...ce],["Z"]),E}let{diffObjects:Qf,extend:Lx,find:Bb,merge:Dx,pick:ep,uniqueKey:Ox}=Ee;(function(F){function c(y,T){let E=y.condition;(E.callback||function(){return this.chartWidth<=ep(E.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=ep(E.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=ep(E.minWidth,0)&&this.chartHeight>=ep(E.minHeight,0)}).call(this)&&T.push(y._id)}function m(y,T){let E=this.options.responsive,k=this.currentResponsive,I=[],L;!T&&E&&E.rules&&E.rules.forEach(N=>{N._id===void 0&&(N._id=Ox()),this.matchResponsiveRule(N,I)},this);let B=Dx(...I.map(N=>Bb((E==null?void 0:E.rules)||[],H=>H._id===N)).map(N=>N==null?void 0:N.chartOptions));B.isResponsiveOptions=!0,I=I.toString()||void 0;let W=k==null?void 0:k.ruleIds;I===W||(k&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(k.undoOptions,y,!0),this.updatingResponsive=!1),I?((L=Qf(B,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:I,mergedOptions:B,undoOptions:L},this.updatingResponsive||this.update(B,y,!0)):this.currentResponsive=void 0)}F.compose=function(y){let T=y.prototype;return T.matchResponsiveRule||Lx(T,{matchResponsiveRule:c,setResponsive:m}),y}})(fe||(fe={}));let Rx=fe;ve.AST=Yn,ve.Axis=hl,ve.Chart=ga,ve.Color=ht,ve.DataLabel=Gf,ve.DataTableCore=Yi,ve.Fx=zi,ve.HTMLElement=zl,ve.Legend=cm,ve.LegendSymbol=Vn,ve.OverlappingDataLabels=ve.OverlappingDataLabels||Cx,ve.PlotLineOrBand=Dh,ve.Point=re,ve.Pointer=Jt,ve.RendererRegistry=zo,ve.Series=Cr,ve.SeriesRegistry=Bn,ve.StackItem=Yg,ve.SVGElement=cr,ve.SVGRenderer=bh,ve.Templating=wr,ve.Tick=Fa,ve.Time=vr,ve.Tooltip=ju,ve.animate=Ds.animate,ve.animObject=Ds.animObject,ve.chart=ga.chart,ve.color=ht.parse,ve.dateFormat=wr.dateFormat,ve.defaultOptions=Fe.defaultOptions,ve.distribute=sl.distribute,ve.format=wr.format,ve.getDeferredAnimation=Ds.getDeferredAnimation,ve.getOptions=Fe.getOptions,ve.numberFormat=wr.numberFormat,ve.seriesType=Bn.seriesType,ve.setAnimation=Ds.setAnimation,ve.setOptions=Fe.setOptions,ve.stop=Ds.stop,ve.time=Fe.defaultTime,ve.timers=zi.timers,{compose:function(F,c,m){let y=F.types.pie;if(!c.symbolCustomAttribs.includes("borderRadius")){let T=m.prototype.symbols;p_(F,"afterColumnTranslate",zb,{order:9}),p_(y,"afterTranslate",Jf),c.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),Yf=T.arc,Kf=T.roundedRect,T.arc=Rb,T.roundedRect=Px}},optionsToObject:jh}.compose(ve.Series,ve.SVGElement,ve.SVGRenderer),yb.compose(ve.Series.types.column),Gf.compose(ve.Series),uf.compose(ve.Axis),zl.compose(ve.SVGRenderer),cm.compose(ve.Chart),Lh.compose(ve.Axis),Cx.compose(ve.Chart),Ab.compose(ve.Series.types.pie),Dh.compose(ve.Chart,ve.Axis),Jt.compose(ve.Chart),Rx.compose(ve.Chart),Yr.compose(ve.Axis,ve.Chart,ve.Series),ux.compose(ve.Axis,ve.Chart,ve.Series),ju.compose(ve.Pointer),Ee.extend(ve,Ee);let zx=ve;return ze.default})())}(Z1)),Z1.exports}const rq=cU(Y3);(function(e,t){(function(n,l){e.exports=l(sq(),rq)})(self,(n,l)=>(()=>{var h={879:r=>{r.exports=n},744:r=>{r.exports=l}},d={};function g(r){var C=d[r];if(C!==void 0)return C.exports;var O=d[r]={exports:{}};return h[r](O,O.exports,g),O.exports}g.n=r=>{var C=r&&r.__esModule?()=>r.default:()=>r;return g.d(C,{a:C}),C},g.d=(r,C)=>{for(var O in C)g.o(C,O)&&!g.o(r,O)&&Object.defineProperty(r,O,{enumerable:!0,get:C[O]})},g.o=(r,C)=>Object.prototype.hasOwnProperty.call(r,C),g.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var b={};return(()=>{g.r(b),g.d(b,{Chart:()=>ie,default:()=>de});var r=g(879),C=g.n(r),O=function ye(be,se){var he=C().isArray(be)?[]:{};function fe(Me,ze){!C().isObject(Me,!se)||C().isClass(Me)||C().isDOMElement(Me)?he[ze]=Me:he[ze]=ye(Me,se)}return C().isArray(be)?be.forEach(function(Me,ze){return fe(Me,ze)}):C().objectEach(be,fe),he},U=g(744);function $(ye){return function(be){if(Array.isArray(be))return q(be)}(ye)||function(be){if(typeof Symbol<"u"&&be[Symbol.iterator]!=null||be["@@iterator"]!=null)return Array.from(be)}(ye)||function(be,se){if(be){if(typeof be=="string")return q(be,se);var he=Object.prototype.toString.call(be).slice(8,-1);if(he==="Object"&&be.constructor&&(he=be.constructor.name),he==="Map"||he==="Set")return Array.from(be);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return q(be,se)}}(ye)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function q(ye,be){(be==null||be>ye.length)&&(be=ye.length);for(var se=0,he=new Array(be);se<be;se++)he[se]=ye[se];return he}const ee=function(ye){var be=this;return{render:function(){return(0,U.h)("div",{ref:"chart"})},beforeUnmount:function(){var se;return be==null||(se=be.chart)===null||se===void 0?void 0:se.destroy()},props:{constructorType:{type:String,default:"chart"},options:{type:Object,required:!0},callback:Function,updateArgs:{type:Array,default:function(){return[!0,!0]}},highcharts:{type:Object},deepCopyOnUpdate:{type:Boolean,default:!0}},watch:{options:{handler:function(se){var he;(he=this.chart).update.apply(he,[O(se,this.deepCopyOnUpdate)].concat($(this.updateArgs)))},deep:!0}},mounted:function(){var se=this.highcharts||ye;se[this.constructorType]?this.options?this.chart=se[this.constructorType](this.$refs.chart,O(this.options,!0),this.callback?this.callback:null):console.error('The "options" parameter was not passed.'):console.error("'".concat(this.constructorType,"' constructor-type is incorrect. Sometimes this error is caused by the fact, that the corresponding module wasn't imported."))}}};var ie=ee(C());function de(ye){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ye.component(be.tagName||"highcharts",ee(be.highcharts||C()))}})(),b})())})(dD);var oq=dD.exports;const aq=fL(oq),lq="Soil Values Geoportal",cq={home:"Home",map:"Map",meDashboard:"M&E Dashboard",catalog:"Catalog",about:"About",login:"Login",logout:"Logout",admin:"Admin Panel"},hq={en:"English",fr:"French",nl:"Dutch"},uq=" 2025 Soil Values Geoportal. All rights reserved.",dq={loading:"Loading",refresh:"Refresh",preview:"Preview",delete:"Delete"},fq={biophysical:{name:"Biophysical Monitoring",description:"Monitors key environmental variables including land cover, vegetation indices (NDVI, EVI), topography, and water availability. It offers a holistic view of the landscapes biophysical condition for better planning and resource management."},crop:{name:"Crop Monitoring",description:"This tool provides spatial insights into crop distribution, health, and seasonal performance using remote sensing data. It supports early detection of crop stress, tracking of growth stages, and estimation of yields to inform timely agricultural interventions."},degradation:{name:"Degradation Monitoring",description:"Tracks land degradation over time by analysing vegetation cover, erosion risk, and human impact. It helps identify hotspots of land degradation, supporting targeted land restoration and sustainable land management efforts."},drought:{name:"Drought Monitoring",description:"Detects and visualizes drought events using climatic and remote sensing indicators like rainfall anomalies, vegetation stress, and soil moisture. It supports early warning systems and helps stakeholders prepare and respond to climate risks."},fertility:{name:"Fertility Monitoring",description:"Assesses soil fertility dynamics through indicators such as organic carbon content, nutrient availability, and land use practices. The tool guides stakeholders in making data-informed decisions for improved soil health and productivity."},risk:{name:"Risk Monitoring",description:"Identify environmental risks by monitoring exposure to climate extremes, soil degradation, and water scarcity to prioritize resilience interventions."}},pq={title:"Map Legend",labels:{water:"Water",forest:"Forest",cropland:"Cropland",grassland:"Grassland",shrubland:"Shrubland",wetland:"Wetland",bareland:"Bareland",urban:"Urban",boundary:"Boundary Outline"}},mq={title:"Soil Values Geoportal",intro1:"Welcome to the Soil Values Geoportal, your gateway to dynamic, data-driven insights for landscape restoration and sustainable land management.",intro2:"Explore real-time maps and analytics on land cover, soil health, crops, and climate to inform impactful decisions across our intervention areas.",launch:"Launch"},gq={hero:{title:"Soil Values",subtitle:"Catalyzing Farm Productivity  Burkina Faso, Mali, Niger, Nigeria  Active"},description:{program:"Soil Values",intro:"is a 10-year program (20242034) financed by the Netherlands Directorate-General for International Cooperation (DGIS), aimed at sustainable soil fertility management across Burkina Faso, Mali, Northern Nigeria, and Niger.",impact:"The program targets 2 million hectares and 1.5 million farmersespecially womenfostering resilient, productive farming systems.",approach:"The strategy centers on Integrated Soil Fertility Management (ISFM) and participatory landscape planning to foster scalable, sustainable solutions."},outcomes:{title:"Expected Outcomes",item1:"1.5 million smallholder farmers, including 800,000 women, reduce the yield gap and build resilience to climate shocks.",item2:"40+ river basins and landscapes2 million hectaresare managed sustainably with equitable water use.",item3:"Soil fertility becomes a priority in agricultural programs, national policies, and civil society efforts.",item4:"Neighboring countries (Ghana and Cte dIvoire) engage in dialogue on fertilizer trade and food security."},partners:{title:"Implementing Partners",description1:"Soil Values is implemented by IFDC in collaboration with SNV and Wageningen University and Research (WUR), alongside knowledge partners such as AGRA, ICRAF, IITA, ISRIC, and IWMI.",note:"Supported by DGIS under Dutch development policy."},updates:{title:"Recent Updates"}},_q={title:"MEL Dashboard",description:`The MEL page serves as the central space for tracking project activities, progress, and performance across the Soil Values program. This page will feature an embedded interactive MEL dashboard developed by the IFDC M&E team, offering real-time insights into key indicators, outcomes, and learning milestones.

Users will visualize monitoring data geographically and thematically, supporting evidence-based decision-making and adaptive project management. The integration of this dashboard into the geoportal allows for a seamless link between spatial data and performance monitoring frameworks, promoting transparency, accountability, and learning across stakeholders.`},yq={title:"Data Catalogue",description:`The Data Catalogue page centralizes access to diverse datasets managed within the geoportal. It provides structured metadata descriptions, facilitating efficient search, discovery, and utilization of spatial and non-spatial data resources.

Users will explore detailed descriptions of datasets, preview data formats, and access download links or APIs for integration into analytical workflows. The page will promote data transparency, interoperability, and accessibility, supporting evidence-based decision-making and collaborative research initiatives across multiple stakeholders.`},xq={title:"Boundary Catalog",description:"Download boundary data in GeoJSON, Shapefile, KML, or CSV formats.",loading:"Loading boundaries...",empty:"No boundaries found.",id:"ID"},vq={title:"Biophysical Monitoring",description:"Toggle land cover and adjust visualization.",selectedArea:"Selected area",mapLayers:"Map layers",landcover:"Land cover",landcoverSub:"2020 / 2021, optional class filter",showLayer:"Show layer",lcTypeAll:"All classes",select:"Select"},bq={title:"Soil Fertility Monitoring",description:"Assesses soil fertility dynamics through indicators such as organic carbon content, nutrient availability, and land use practices. The tool guides stakeholders in making data-informed decisions for improved soil health and productivity.",baseline:"Baseline",current:"Current",changes:{positive:"+ Improved",neutral:"No Change"},indicators:{organicMatter:"Organic Matter",nutrientLevels:"Nutrient Levels",erosionRisk:"Erosion Risk",waterRetention:"Water Retention"}},wq={title:"Login",subtitle:"Access your account to manage and upload data",formTitle:"Sign In",email:"Email",password:"Password",loginButton:"Login",loggingIn:"Logging in...",invalidCredentials:"Invalid email or password",show:"Show",hide:"Hide"},Tq={loading:"Loading",refresh:"Refresh",panelTitle:"Admin Panel",uploadRaster:"Upload Raster",createUser:"Create User",generateSyntheticData:"Generate Synthetic Data",manageData:"Manage Data (Coming Soon)",uploadRasterLayer:"Upload Raster Layer",layerName:"Layer Name",category:"Category",year:"Year",description:"Description",geotiff:"GeoTIFF (.tif/.tiff)",sldOptional:"SLD (optional)",uploading:"Uploading...",upload:"Upload",uploadFailed:"Upload failed",layer:"Layer",wms:"WMS",mapLayerAdded:"Layer added to map.",mapNotAvailable:'Map instance not found. Dispatched "rasterUploaded" event.',rasterUploadedWithName:"Raster uploaded: {name}",manageLayers:"Manage Raster Layers",publishedLayers:"Published Layers",noPublished:"No published layers.",orphanStores:"Orphan Coverage Stores",deleteStore:"Delete store",noOrphans:"No orphan stores",loadLayersFailed:"Failed to load layers",deleteFailed:"Delete failed",confirmDeleteLayer:'Delete layer "{name}" and its store?',confirmDeleteStore:'Delete orphan store "{name}"?',createNewUser:"Create New User",email:"Email",password:"Password",role:"Role",selectRole:"Select Role",adminRole:"Admin",partnerRole:"Partner",analystRole:"Analyst",publicRole:"Public",createUserFailed:"Error creating user",generateSyntheticTitle:"Generate Synthetic Data",generateSyntheticDescription:"This will wipe existing synthetic tables, refill them with new fake data, and point all *_view tables to synthetic versions.",generateNow:"Generate Now",generating:"Generating...",insertedRowCounts:"Inserted Row Counts:",output:"Output:",syntheticFailed:"Error generating synthetic data",dataManagementPlaceholderTitle:"Data Management (Coming Soon)",dataManagementPlaceholderDescription:"Future tools for managing datasets, users, and configurations will appear here."},Eq={title:"Map Controls",basemap:"Basemap",basemapLight:"Light",basemapStreets:"Streets",basemapSatellite:"Satellite",basemapDark:"Dark",country:"Country",watershed:"Watershed",commune:"Commune",select:"Select",reset:"Reset"},Sq={title:"Toolbox",tools:{biophysical:{name:"Biophysical Monitoring",description:"Monitor land cover and key biophysical indicators."},crop:{name:"Crop Monitoring",description:"Track crop health and growth using satellite imagery and agricultural datasets to support farming decisions."},degradation:{name:"Land Degradation",description:"Assess soil erosion, deforestation, and land quality decline to inform sustainable land management."},drought:{name:"Drought Monitoring",description:"Monitor drought conditions and water stress using rainfall, temperature, and vegetation health indicators."},fertility:{name:"Soil Fertility",description:"Analyze soil nutrient levels, pH, and organic matter to guide agricultural productivity and soil management."},risk:{name:"Risk Assessment",description:"Evaluate environmental and agricultural risks, including floods, droughts, and other climate hazards."}}},Mq={title:lq,nav:cq,lang:hq,footer:uq,common:dq,tools:fq,legend:pq,home:mq,about:gq,monitoring:_q,catalog:yq,boundariesCatalog:xq,biophysical:vq,fertility:bq,login:wq,admin:Tq,mapControls:Eq,toolbox:Sq},Cq="Goportail Soil Values",Aq={home:"Accueil",map:"Carte",meDashboard:"Tableau de bord MEL",catalog:"Catalogue",about:" propos",login:"Connexion",logout:"Dconnexion",admin:"Panneau dadministration"},kq={en:"Anglais",fr:"Franais",nl:"Nerlandais"},Iq=" 2025 Goportail Soil Values. Tous droits rservs.",Pq={loading:"Chargement",refresh:"Actualiser",preview:"Aperu",delete:"Supprimer"},Lq={biophysical:{name:"Suivi biophysique",description:"Suit les variables environnementales cls, notamment loccupation du sol, les indices de vgtation (NDVI, EVI), la topographie et la disponibilit en eau. Offre une vue holistique de ltat biophysique du paysage pour une meilleure planification et gestion des ressources."},crop:{name:"Suivi des cultures",description:"Fournit des informations spatiales sur la rpartition des cultures, leur sant et leurs performances saisonnires  partir de donnes de tldtection. Permet la dtection prcoce du stress, le suivi des stades de croissance et lestimation des rendements."},degradation:{name:"Suivi de la dgradation",description:"Suit lvolution de la dgradation des terres en analysant la couverture vgtale, le risque drosion et limpact humain. Aide  identifier les zones critiques pour orienter la restauration et une gestion durable des terres."},drought:{name:"Suivi de la scheresse",description:"Dtecte et visualise les pisodes de scheresse  laide dindicateurs climatiques et satellitaires (anomalies de pluie, stress de la vgtation, humidit du sol). Appuie les systmes dalerte prcoce et la prparation aux risques."},fertility:{name:"Suivi de la fertilit des sols",description:"value la dynamique de la fertilit des sols via le carbone organique, la disponibilit des nutriments et les pratiques dutilisation des terres. Aide  des dcisions informes pour amliorer la sant et la productivit des sols."},risk:{name:"valuation des risques",description:"Identifie les risques environnementaux en surveillant lexposition aux extrmes climatiques,  la dgradation des sols et  la raret de leau pour hirarchiser les interventions de rsilience."}},Dq={title:"Lgende de la carte",labels:{water:"Eau",forest:"Fort",cropland:"Cultures",grassland:"Prairies",shrubland:"Arbustes",wetland:"Zone humide",bareland:"Sol nu",urban:"Urbain",boundary:"Contour de limite"}},Oq={title:"Goportail Soil Values",intro1:"Bienvenue sur le Goportail Soil Values, votre passerelle vers des informations dynamiques et fondes sur les donnes pour la restauration des paysages et la gestion durable des terres.",intro2:"Explorez des cartes et des analyses en temps rel sur loccupation du sol, la sant des sols, les cultures et le climat pour clairer les dcisions dans nos zones dintervention.",launch:"Lancer"},Rq={hero:{title:"Soil Values",subtitle:"Catalyser la productivit agricole  Burkina Faso, Mali, Niger, Nigeria  Actif"},description:{program:"Soil Values",intro:"est un programme de 10 ans (20242034) financ par la Direction gnrale de la coopration internationale des Pays-Bas (DGIS) et visant une gestion durable de la fertilit des sols au Burkina Faso, au Mali, dans le nord du Nigeria et au Niger.",impact:"Le programme cible 2 millions dhectares et 1,5 million dagriculteurs  en particulier des femmes  afin de renforcer la rsilience et la productivit.",approach:"La stratgie repose sur la Gestion intgre de la fertilit des sols (ISFM) et une planification paysagre participative pour des solutions durables et  lchelle."},outcomes:{title:"Rsultats attendus",item1:"1,5 million de petits exploitants, dont 800 000 femmes, rduisent lcart de rendement et renforcent leur rsilience face aux chocs climatiques.",item2:"Plus de 40 bassins et paysages  2 millions dhectares  sont grs durablement avec un usage quitable de leau.",item3:"La fertilit des sols devient prioritaire dans les programmes agricoles, les politiques nationales et les actions de la socit civile.",item4:"Les pays voisins (Ghana et Cte dIvoire) sengagent dans un dialogue sur le commerce des engrais et la scurit alimentaire."},partners:{title:"Partenaires de mise en uvre",description1:"Soil Values est mis en uvre par lIFDC avec le SNV et lUniversit et Recherche de Wageningen (WUR), aux cts de partenaires de connaissance tels quAGRA, ICRAF, IITA, ISRIC et IWMI.",note:"Soutenu par la DGIS dans le cadre de la politique nerlandaise de dveloppement."},updates:{title:"Actualits rcentes"}},zq={title:"Tableau de bord MEL",description:`La page MEL est lespace central pour suivre les activits, les progrs et la performance du programme Soil Values. Elle embarquera un tableau de bord MEL interactif dvelopp par lquipe Suivi-valuation dIFDC, offrant des informations en temps rel sur les indicateurs, rsultats et apprentissages.

Les utilisateurs visualiseront les donnes de suivi de manire gographique et thmatique, afin de soutenir la prise de dcision fonde sur des preuves et une gestion adaptative. Lintgration de ce tableau de bord dans le goportail relie de manire fluide les donnes spatiales et le cadre de performance, favorisant transparence, redevabilit et apprentissage entre parties prenantes.`},Bq={title:"Catalogue de donnes",description:`La page Catalogue centralise laccs aux jeux de donnes grs dans le goportail. Elle fournit des mtadonnes structures pour faciliter la recherche, la dcouverte et lutilisation de donnes spatiales et non spatiales.

Les utilisateurs consultent les descriptions, prvisualisent les formats et accdent aux liens de tlchargement ou aux API pour leurs analyses. La page promeut transparence, interoprabilit et accessibilit des donnes.`},Fq={title:"Catalogue des limites",description:"Tlchargez les donnes de limites en GeoJSON, Shapefile, KML ou CSV.",loading:"Chargement des limites",empty:"Aucune limite trouve.",id:"ID"},Nq={title:"Suivi biophysique",description:"Activer loccupation du sol et ajuster laffichage.",selectedArea:"Zone slectionne",mapLayers:"Couches de carte",landcover:"Occupation du sol",landcoverSub:"2020 / 2021, filtre de classe facultatif",showLayer:"Afficher la couche",lcTypeAll:"Toutes les classes",select:"Slectionner"},Uq={title:"Suivi de la fertilit des sols",description:"value la fertilit via le carbone organique, la disponibilit des nutriments et les pratiques dutilisation des terres, pour guider des dcisions claires.",baseline:"Rfrence",current:"Actuel",changes:{positive:"+ Amlioration",neutral:"Sans changement"},indicators:{organicMatter:"Matire organique",nutrientLevels:"Niveaux de nutriments",erosionRisk:"Risque drosion",waterRetention:"Rtention deau"}},Vq={title:"Connexion",subtitle:"Accdez  votre compte pour grer et tlverser des donnes",formTitle:"Se connecter",email:"E-mail",password:"Mot de passe",loginButton:"Se connecter",loggingIn:"Connexion",invalidCredentials:"E-mail ou mot de passe invalide",show:"Afficher",hide:"Masquer"},jq={loading:"Chargement",refresh:"Actualiser",panelTitle:"Panneau dadministration",uploadRaster:"Tlverser un raster",createUser:"Crer un utilisateur",generateSyntheticData:"Gnrer des donnes synthtiques",manageData:"Gestion des donnes (bientt)",uploadRasterLayer:"Tlverser une couche raster",layerName:"Nom de la couche",category:"Catgorie",year:"Anne",description:"Description",geotiff:"GeoTIFF (.tif/.tiff)",sldOptional:"SLD (optionnel)",uploading:"Tlversement",upload:"Tlverser",uploadFailed:"chec du tlversement",layer:"Couche",wms:"WMS",mapLayerAdded:"Couche ajoute  la carte.",mapNotAvailable:"Carte indisponible. vnement  rasterUploaded  mis.",rasterUploadedWithName:"Raster tlvers : {name}",manageLayers:"Grer les couches raster",publishedLayers:"Couches publies",noPublished:"Aucune couche publie.",orphanStores:"Magasins de couvertures orphelins",deleteStore:"Supprimer le magasin",noOrphans:" Aucun magasin orphelin",loadLayersFailed:"chec du chargement des couches",deleteFailed:"chec de la suppression",confirmDeleteLayer:"Supprimer la couche  {name}  ainsi que son magasin ?",confirmDeleteStore:"Supprimer le magasin orphelin  {name}  ?",createNewUser:"Crer un nouvel utilisateur",email:"E-mail",password:"Mot de passe",role:"Rle",selectRole:"Slectionner un rle",adminRole:"Admin",partnerRole:"Partenaire",analystRole:"Analyste",publicRole:"Public",createUserFailed:"Erreur lors de la cration de lutilisateur",generateSyntheticTitle:"Gnrer des donnes synthtiques",generateSyntheticDescription:"Cela efface les tables synthtiques existantes, les remplit  nouveau et oriente toutes les vues *_view vers les versions synthtiques.",generateNow:"Gnrer maintenant",generating:"Gnration",insertedRowCounts:"Lignes insres :",output:"Sortie :",syntheticFailed:"Erreur lors de la gnration de donnes synthtiques",dataManagementPlaceholderTitle:"Gestion des donnes (bientt)",dataManagementPlaceholderDescription:"De futurs outils pour grer jeux de donnes, utilisateurs et configurations apparatront ici."},$q={title:"Contrles de la carte",basemap:"Fond de carte",basemapLight:"Clair",basemapStreets:"Rues",basemapSatellite:"Satellite",basemapDark:"Sombre",country:"Pays",watershed:"Bassin versant",commune:"Commune",select:"Slectionner",reset:"Rinitialiser"},Wq={title:"Bote  outils",tools:{biophysical:{name:"Suivi biophysique",description:"Surveille loccupation du sol et les indicateurs biophysiques cls."},crop:{name:"Suivi des cultures",description:"Suivre la sant et la croissance des cultures via limagerie satellite et les donnes agricoles."},degradation:{name:"Dgradation des terres",description:"valuer lrosion des sols, la dforestation et la baisse de qualit des terres."},drought:{name:"Suivi de la scheresse",description:"Surveiller la scheresse et le stress hydrique (pluie, temprature, vgtation)."},fertility:{name:"Fertilit des sols",description:"Analyser nutriments, pH et matire organique pour guider la productivit."},risk:{name:"valuation des risques",description:"valuer les risques environnementaux et agricoles (crues, scheresse, alas climatiques)."}}},Gq={title:Cq,nav:Aq,lang:kq,footer:Iq,common:Pq,tools:Lq,legend:Dq,home:Oq,about:Rq,monitoring:zq,catalog:Bq,boundariesCatalog:Fq,biophysical:Nq,fertility:Uq,login:Vq,admin:jq,mapControls:$q,toolbox:Wq},Hq="Soil Values Geoportaal",qq={home:"Home",map:"Kaart",meDashboard:"MEL-dashboard",catalog:"Catalogus",about:"Over",login:"Inloggen",logout:"Uitloggen",admin:"Beheerpanelen"},Xq={en:"Engels",fr:"Frans",nl:"Nederlands"},Zq=" 2025 Soil Values Geoportaal. Alle rechten voorbehouden.",Yq={loading:"Laden",refresh:"Vernieuwen",preview:"Voorbeeld",delete:"Verwijderen"},Kq={biophysical:{name:"Biofysische monitoring",description:"Volgt sleutelvariabelen zoals landbedekking, vegetatie-indices (NDVI, EVI), topografie en watervoorraden. Biedt een holistisch beeld van de biofysische toestand voor betere planning en beheer."},crop:{name:"Gewasmonitoring",description:"Geeft ruimtelijk inzicht in gewasverdeling, gezondheid en seizoensprestaties met aardobservatie. Ondersteunt vroege detectie van stress, groeistadia en opbrengstschattingen."},degradation:{name:"Landdegradatie",description:"Volgt degradatie door vegetatiebedekking, erosierisico en menselijke druk te analyseren. Helpt hotspots te identificeren voor herstel en duurzaam landgebruik."},drought:{name:"Droogtemonitoring",description:"Detecteert en visualiseert droogte met klimaaten satellietindicatoren zoals neerslagafwijkingen, vegetatiestress en bodemvocht. Ondersteunt vroegtijdige waarschuwingen."},fertility:{name:"Bodemvruchtbaarheid",description:"Beoordeelt bodemvruchtbaarheid via organische koolstof, nutrintenbeschikbaarheid en landgebruik. Stuurt datagedreven besluiten voor gezonde, productieve bodems."},risk:{name:"Risicobeoordeling",description:"Brengt milieurisicos in kaart door blootstelling aan klimaatextremen, bodemdegradatie en waterschaarste te monitoren."}},Jq={title:"Kaartlegenda",labels:{water:"Water",forest:"Bos",cropland:"Akkerland",grassland:"Grasland",shrubland:"Struikgewas",wetland:"Moeras",bareland:"Onbegroeid",urban:"Stedelijk",boundary:"Grensomtrek"}},Qq={title:"Soil Values Geoportaal",intro1:"Welkom bij het Soil Values Geoportaal: uw toegang tot actuele, data-gedreven inzichten voor landschapsherstel en duurzaam landbeheer.",intro2:"Verken realtime kaarten en analyses over landbedekking, bodemgezondheid, gewassen en klimaat om beslissingen in onze interventiegebieden te ondersteunen.",launch:"Starten"},e9={hero:{title:"Soil Values",subtitle:"Stimuleren van landbouwproductiviteit  Burkina Faso, Mali, Niger, Nigeria  Actief"},description:{program:"Soil Values",intro:"is een 10-jarig programma (20242034), gefinancierd door de Nederlandse Directie-generaal Internationale Samenwerking (DGIS), gericht op duurzaam beheer van bodemvruchtbaarheid in Burkina Faso, Mali, Noord-Nigeria en Niger.",impact:"Het programma richt zich op 2 miljoen hectare en 1,5 miljoen boeren  met bijzondere aandacht voor vrouwen  om veerkracht en productiviteit te vergroten.",approach:"De aanpak draait om Gentegreerd beheer van bodemvruchtbaarheid (ISFM) en participatieve landschapsplanning voor schaalbare en duurzame oplossingen."},outcomes:{title:"Verwachte resultaten",item1:"1,5 miljoen kleinschalige boeren, waaronder 800.000 vrouwen, verkleinen de opbrengstkloof en versterken hun weerbaarheid tegen klimaatschokken.",item2:"Meer dan 40 stroomgebieden en landschappen  2 miljoen hectare  worden duurzaam beheerd met rechtvaardig watergebruik.",item3:"Bodemvruchtbaarheid krijgt prioriteit in landbouwprogrammas, nationaal beleid en maatschappelijke initiatieven.",item4:"Buurlanden (Ghana en Ivoorkust) gaan in dialoog over kunstmesthandel en voedselzekerheid."},partners:{title:"Uitvoerende partners",description1:"Soil Values wordt uitgevoerd door IFDC in samenwerking met SNV en Wageningen University & Research (WUR), met kennispartners zoals AGRA, ICRAF, IITA, ISRIC en IWMI.",note:"Gesteund door DGIS in het kader van het Nederlandse ontwikkelingsbeleid."},updates:{title:"Recente updates"}},t9={title:"MEL-dashboard",description:`De MEL-pagina is de centrale plek om activiteiten, voortgang en prestaties van Soil Values te volgen. Hier komt een interactief MEL-dashboard van het IFDC-team met realtime inzichten in kernindicatoren, uitkomsten en leerpunten.

Gebruikers visualiseren monitoringsdata geografisch en thematisch, wat besluitvorming en adaptief projectbeheer ondersteunt. Integratie in het geoportaal koppelt ruimtelijke data aan prestatiemonitoring en bevordert transparantie, verantwoording en leren.`},i9={title:"Datacatalogus",description:`De catalogus centraliseert toegang tot datasets binnen het geoportaal. Met gestructureerde metadata voor efficint zoeken, ontdekken en gebruiken van (niet-)ruimtelijke data.

Gebruikers bekijken beschrijvingen, voorbeeldweergaven en downloaden of koppelen via APIs. Dit bevordert transparantie, interoperabiliteit en toegankelijkheid van data.`},n9={title:"Grenscatalogus",description:"Download grensdata als GeoJSON, Shapefile, KML of CSV.",loading:"Grenzen laden",empty:"Geen grenzen gevonden.",id:"ID"},s9={title:"Biofysische monitoring",description:"Landbedekking schakelen en weergave aanpassen.",selectedArea:"Geselecteerd gebied",mapLayers:"Kaartlagen",landcover:"Landbedekking",landcoverSub:"2020 / 2021, optioneel klassefilter",showLayer:"Laag tonen",lcTypeAll:"Alle klassen",select:"Selecteren"},r9={title:"Bodemvruchtbaarheid",description:"Beoordeelt vruchtbaarheid via organische stof, nutrinten en landgebruik voor beter onderbouwde besluiten.",baseline:"Nulmeting",current:"Huidig",changes:{positive:"+ Verbeterd",neutral:"Geen verandering"},indicators:{organicMatter:"Organische stof",nutrientLevels:"Nutrintenniveaus",erosionRisk:"Erosierisico",waterRetention:"Waterbergend vermogen"}},o9={title:"Inloggen",subtitle:"Log in om gegevens te beheren en te uploaden",formTitle:"Aanmelden",email:"E-mail",password:"Wachtwoord",loginButton:"Inloggen",loggingIn:"Bezig met inloggen",invalidCredentials:"Ongeldig e-mailadres of wachtwoord",show:"Tonen",hide:"Verbergen"},a9={loading:"Laden",refresh:"Vernieuwen",panelTitle:"Beheerpanelen",uploadRaster:"Raster uploaden",createUser:"Gebruiker aanmaken",generateSyntheticData:"Synthetische data genereren",manageData:"Databeheer (binnenkort)",uploadRasterLayer:"Rasterlaag uploaden",layerName:"Laagnaam",category:"Categorie",year:"Jaar",description:"Beschrijving",geotiff:"GeoTIFF (.tif/.tiff)",sldOptional:"SLD (optioneel)",uploading:"Uploaden",upload:"Uploaden",uploadFailed:"Upload mislukt",layer:"Laag",wms:"WMS",mapLayerAdded:"Laag toegevoegd aan de kaart.",mapNotAvailable:"Kaart niet beschikbaar. rasterUploaded-event verzonden.",rasterUploadedWithName:"Raster gepload: {name}",manageLayers:"Rasterlagen beheren",publishedLayers:"Gepubliceerde lagen",noPublished:"Geen gepubliceerde lagen.",orphanStores:"Verweesde coverage stores",deleteStore:"Store verwijderen",noOrphans:" Geen verweesde stores",loadLayersFailed:"Laden van lagen mislukt",deleteFailed:"Verwijderen mislukt",confirmDeleteLayer:"Laag {name} en bijbehorende store verwijderen?",confirmDeleteStore:"Verweesde store {name} verwijderen?",createNewUser:"Nieuwe gebruiker aanmaken",email:"E-mail",password:"Wachtwoord",role:"Rol",selectRole:"Rol selecteren",adminRole:"Beheerder",partnerRole:"Partner",analystRole:"Analist",publicRole:"Publiek",createUserFailed:"Fout bij aanmaken gebruiker",generateSyntheticTitle:"Synthetische data genereren",generateSyntheticDescription:"Wis bestaande synthetische tabellen, vul ze opnieuw en laat alle *_view-tabellen naar synthetische versies verwijzen.",generateNow:"Nu genereren",generating:"Bezig",insertedRowCounts:"Aantal ingevoegde rijen:",output:"Uitvoer:",syntheticFailed:"Fout bij genereren van synthetische data",dataManagementPlaceholderTitle:"Databeheer (binnenkort)",dataManagementPlaceholderDescription:"Toekomstige tools voor datasets, gebruikers en configuraties verschijnen hier."},l9={title:"Kaartbediening",basemap:"Basiskaart",basemapLight:"Licht",basemapStreets:"Streets",basemapSatellite:"Satelliet",basemapDark:"Donker",country:"Land",watershed:"Stroomgebied",commune:"Gemeente",select:"Selecteren",reset:"Resetten"},c9={title:"Toolbox",tools:{biophysical:{name:"Biofysische monitoring",description:"Monitor landbedekking en kern-biofysische indicatoren."},crop:{name:"Gewasmonitoring",description:"Volg gewasgezondheid en groei met satellietbeelden en landbouwdata."},degradation:{name:"Landdegradatie",description:"Beoordeel erosie, ontbossing en kwaliteitsverlies van land."},drought:{name:"Droogtemonitoring",description:"Monitor droogte en waterstress met neerslag, temperatuur en vegetatie-indicatoren."},fertility:{name:"Bodemvruchtbaarheid",description:"Analyseer nutrinten, pH en organische stof voor beter beheer."},risk:{name:"Risicobeoordeling",description:"Beoordeel milieu- en landbouwrisicos zoals overstromingen en droogte."}}},h9={title:Hq,nav:qq,lang:Xq,footer:Zq,common:Yq,tools:Kq,legend:Jq,home:Qq,about:e9,monitoring:t9,catalog:i9,boundariesCatalog:n9,biophysical:s9,fertility:r9,login:o9,admin:a9,mapControls:l9,toolbox:c9},AA=["en","fr","nl"],kA=localStorage.getItem("lang")||"",IA=(navigator.language||"en").slice(0,2),u9=AA.includes(kA)?kA:AA.includes(IA)?IA:"en",d9=KN({legacy:!1,globalInjection:!0,locale:u9,fallbackLocale:"en",messages:{en:Mq,fr:Gq,nl:h9}});var f9=Object.defineProperty,PA=Object.getOwnPropertySymbols,p9=Object.prototype.hasOwnProperty,m9=Object.prototype.propertyIsEnumerable,LA=(e,t,n)=>t in e?f9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fD=(e,t)=>{for(var n in t||(t={}))p9.call(t,n)&&LA(e,n,t[n]);if(PA)for(var n of PA(t))m9.call(t,n)&&LA(e,n,t[n]);return e},ib=e=>typeof e=="function",nb=e=>typeof e=="string",pD=e=>nb(e)&&e.trim().length>0,g9=e=>typeof e=="number",vp=e=>typeof e>"u",Ry=e=>typeof e=="object"&&e!==null,_9=e=>lh(e,"tag")&&pD(e.tag),mD=e=>window.TouchEvent&&e instanceof TouchEvent,gD=e=>lh(e,"component")&&_D(e.component),y9=e=>ib(e)||Ry(e),_D=e=>!vp(e)&&(nb(e)||y9(e)||gD(e)),DA=e=>Ry(e)&&["height","width","right","left","top","bottom"].every(t=>g9(e[t])),lh=(e,t)=>(Ry(e)||ib(e))&&t in e,x9=(e=>()=>e++)(0);function Y1(e){return mD(e)?e.targetTouches[0].clientX:e.clientX}function OA(e){return mD(e)?e.targetTouches[0].clientY:e.clientY}var v9=e=>{vp(e.remove)?e.parentNode&&e.parentNode.removeChild(e):e.remove()},Hy=e=>gD(e)?Hy(e.component):_9(e)?gs({render(){return e}}):typeof e=="string"?e:Sn(hs(e)),b9=e=>{if(typeof e=="string")return e;const t=lh(e,"props")&&Ry(e.props)?e.props:{},n=lh(e,"listeners")&&Ry(e.listeners)?e.listeners:{};return{component:Hy(e),props:t,listeners:n}},w9=()=>typeof window<"u",nE=class{constructor(){this.allHandlers={}}getHandlers(e){return this.allHandlers[e]||[]}on(e,t){const n=this.getHandlers(e);n.push(t),this.allHandlers[e]=n}off(e,t){const n=this.getHandlers(e);n.splice(n.indexOf(t)>>>0,1)}emit(e,t){this.getHandlers(e).forEach(l=>l(t))}},T9=e=>["on","off","emit"].every(t=>lh(e,t)&&ib(e[t])),Qa;(function(e){e.SUCCESS="success",e.ERROR="error",e.WARNING="warning",e.INFO="info",e.DEFAULT="default"})(Qa||(Qa={}));var mv;(function(e){e.TOP_LEFT="top-left",e.TOP_CENTER="top-center",e.TOP_RIGHT="top-right",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_CENTER="bottom-center",e.BOTTOM_RIGHT="bottom-right"})(mv||(mv={}));var el;(function(e){e.ADD="add",e.DISMISS="dismiss",e.UPDATE="update",e.CLEAR="clear",e.UPDATE_DEFAULTS="update_defaults"})(el||(el={}));var oc="Vue-Toastification",ic={type:{type:String,default:Qa.DEFAULT},classNames:{type:[String,Array],default:()=>[]},trueBoolean:{type:Boolean,default:!0}},yD={type:ic.type,customIcon:{type:[String,Boolean,Object,Function],default:!0}},V0={component:{type:[String,Object,Function,Boolean],default:"button"},classNames:ic.classNames,showOnHover:{type:Boolean,default:!1},ariaLabel:{type:String,default:"close"}},Xw={timeout:{type:[Number,Boolean],default:5e3},hideProgressBar:{type:Boolean,default:!1},isRunning:{type:Boolean,default:!1}},xD={transition:{type:[Object,String],default:`${oc}__bounce`}},E9={position:{type:String,default:mv.TOP_RIGHT},draggable:ic.trueBoolean,draggablePercent:{type:Number,default:.6},pauseOnFocusLoss:ic.trueBoolean,pauseOnHover:ic.trueBoolean,closeOnClick:ic.trueBoolean,timeout:Xw.timeout,hideProgressBar:Xw.hideProgressBar,toastClassName:ic.classNames,bodyClassName:ic.classNames,icon:yD.customIcon,closeButton:V0.component,closeButtonClassName:V0.classNames,showCloseButtonOnHover:V0.showOnHover,accessibility:{type:Object,default:()=>({toastRole:"alert",closeButtonLabel:"close"})},rtl:{type:Boolean,default:!1},eventBus:{type:Object,required:!1,default:()=>new nE}},S9={id:{type:[String,Number],required:!0,default:0},type:ic.type,content:{type:[String,Object,Function],required:!0,default:""},onClick:{type:Function,default:void 0},onClose:{type:Function,default:void 0}},M9={container:{type:[Object,Function],default:()=>document.body},newestOnTop:ic.trueBoolean,maxToasts:{type:Number,default:20},transition:xD.transition,toastDefaults:Object,filterBeforeCreate:{type:Function,default:e=>e},filterToasts:{type:Function,default:e=>e},containerClassName:ic.classNames,onMounted:Function,shareAppContext:[Boolean,Object]},au={CORE_TOAST:E9,TOAST:S9,CONTAINER:M9,PROGRESS_BAR:Xw,ICON:yD,TRANSITION:xD,CLOSE_BUTTON:V0},vD=gs({name:"VtProgressBar",props:au.PROGRESS_BAR,data(){return{hasClass:!0}},computed:{style(){return{animationDuration:`${this.timeout}ms`,animationPlayState:this.isRunning?"running":"paused",opacity:this.hideProgressBar?0:1}},cpClass(){return this.hasClass?`${oc}__progress-bar`:""}},watch:{timeout(){this.hasClass=!1,this.$nextTick(()=>this.hasClass=!0)}},mounted(){this.$el.addEventListener("animationend",this.animationEnded)},beforeUnmount(){this.$el.removeEventListener("animationend",this.animationEnded)},methods:{animationEnded(){this.$emit("close-toast")}}});function C9(e,t){return ui(),Ei("div",{style:uc(e.style),class:Jr(e.cpClass)},null,6)}vD.render=C9;var A9=vD,bD=gs({name:"VtCloseButton",props:au.CLOSE_BUTTON,computed:{buttonComponent(){return this.component!==!1?Hy(this.component):"button"},classes(){const e=[`${oc}__close-button`];return this.showOnHover&&e.push("show-on-hover"),e.concat(this.classNames)}}}),k9=fr("  ");function I9(e,t){return ui(),Qr(Pv(e.buttonComponent),Uy({"aria-label":e.ariaLabel,class:e.classes},e.$attrs),{default:Kr(()=>[k9]),_:1},16,["aria-label","class"])}bD.render=I9;var P9=bD,wD={},L9={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"check-circle",class:"svg-inline--fa fa-check-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},D9=tt("path",{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},null,-1),O9=[D9];function R9(e,t){return ui(),Ei("svg",L9,O9)}wD.render=R9;var z9=wD,TD={},B9={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",class:"svg-inline--fa fa-info-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},F9=tt("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},null,-1),N9=[F9];function U9(e,t){return ui(),Ei("svg",B9,N9)}TD.render=U9;var RA=TD,ED={},V9={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-circle",class:"svg-inline--fa fa-exclamation-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},j9=tt("path",{fill:"currentColor",d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),$9=[j9];function W9(e,t){return ui(),Ei("svg",V9,$9)}ED.render=W9;var G9=ED,SD={},H9={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-triangle",class:"svg-inline--fa fa-exclamation-triangle fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},q9=tt("path",{fill:"currentColor",d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),X9=[q9];function Z9(e,t){return ui(),Ei("svg",H9,X9)}SD.render=Z9;var Y9=SD,MD=gs({name:"VtIcon",props:au.ICON,computed:{customIconChildren(){return lh(this.customIcon,"iconChildren")?this.trimValue(this.customIcon.iconChildren):""},customIconClass(){return nb(this.customIcon)?this.trimValue(this.customIcon):lh(this.customIcon,"iconClass")?this.trimValue(this.customIcon.iconClass):""},customIconTag(){return lh(this.customIcon,"iconTag")?this.trimValue(this.customIcon.iconTag,"i"):"i"},hasCustomIcon(){return this.customIconClass.length>0},component(){return this.hasCustomIcon?this.customIconTag:_D(this.customIcon)?Hy(this.customIcon):this.iconTypeComponent},iconTypeComponent(){return{[Qa.DEFAULT]:RA,[Qa.INFO]:RA,[Qa.SUCCESS]:z9,[Qa.ERROR]:Y9,[Qa.WARNING]:G9}[this.type]},iconClasses(){const e=[`${oc}__icon`];return this.hasCustomIcon?e.concat(this.customIconClass):e}},methods:{trimValue(e,t=""){return pD(e)?e.trim():t}}});function K9(e,t){return ui(),Qr(Pv(e.component),{class:Jr(e.iconClasses)},{default:Kr(()=>[fr(Ht(e.customIconChildren),1)]),_:1},8,["class"])}MD.render=K9;var J9=MD,CD=gs({name:"VtToast",components:{ProgressBar:A9,CloseButton:P9,Icon:J9},inheritAttrs:!1,props:Object.assign({},au.CORE_TOAST,au.TOAST),data(){return{isRunning:!0,disableTransitions:!1,beingDragged:!1,dragStart:0,dragPos:{x:0,y:0},dragRect:{}}},computed:{classes(){const e=[`${oc}__toast`,`${oc}__toast--${this.type}`,`${this.position}`].concat(this.toastClassName);return this.disableTransitions&&e.push("disable-transition"),this.rtl&&e.push(`${oc}__toast--rtl`),e},bodyClasses(){return[`${oc}__toast-${nb(this.content)?"body":"component-body"}`].concat(this.bodyClassName)},draggableStyle(){return this.dragStart===this.dragPos.x?{}:this.beingDragged?{transform:`translateX(${this.dragDelta}px)`,opacity:1-Math.abs(this.dragDelta/this.removalDistance)}:{transition:"transform 0.2s, opacity 0.2s",transform:"translateX(0)",opacity:1}},dragDelta(){return this.beingDragged?this.dragPos.x-this.dragStart:0},removalDistance(){return DA(this.dragRect)?(this.dragRect.right-this.dragRect.left)*this.draggablePercent:0}},mounted(){this.draggable&&this.draggableSetup(),this.pauseOnFocusLoss&&this.focusSetup()},beforeUnmount(){this.draggable&&this.draggableCleanup(),this.pauseOnFocusLoss&&this.focusCleanup()},methods:{hasProp:lh,getVueComponentFromObj:Hy,closeToast(){this.eventBus.emit(el.DISMISS,this.id)},clickHandler(){this.onClick&&this.onClick(this.closeToast),this.closeOnClick&&(!this.beingDragged||this.dragStart===this.dragPos.x)&&this.closeToast()},timeoutHandler(){this.closeToast()},hoverPause(){this.pauseOnHover&&(this.isRunning=!1)},hoverPlay(){this.pauseOnHover&&(this.isRunning=!0)},focusPause(){this.isRunning=!1},focusPlay(){this.isRunning=!0},focusSetup(){addEventListener("blur",this.focusPause),addEventListener("focus",this.focusPlay)},focusCleanup(){removeEventListener("blur",this.focusPause),removeEventListener("focus",this.focusPlay)},draggableSetup(){const e=this.$el;e.addEventListener("touchstart",this.onDragStart,{passive:!0}),e.addEventListener("mousedown",this.onDragStart),addEventListener("touchmove",this.onDragMove,{passive:!1}),addEventListener("mousemove",this.onDragMove),addEventListener("touchend",this.onDragEnd),addEventListener("mouseup",this.onDragEnd)},draggableCleanup(){const e=this.$el;e.removeEventListener("touchstart",this.onDragStart),e.removeEventListener("mousedown",this.onDragStart),removeEventListener("touchmove",this.onDragMove),removeEventListener("mousemove",this.onDragMove),removeEventListener("touchend",this.onDragEnd),removeEventListener("mouseup",this.onDragEnd)},onDragStart(e){this.beingDragged=!0,this.dragPos={x:Y1(e),y:OA(e)},this.dragStart=Y1(e),this.dragRect=this.$el.getBoundingClientRect()},onDragMove(e){this.beingDragged&&(e.preventDefault(),this.isRunning&&(this.isRunning=!1),this.dragPos={x:Y1(e),y:OA(e)})},onDragEnd(){this.beingDragged&&(Math.abs(this.dragDelta)>=this.removalDistance?(this.disableTransitions=!0,this.$nextTick(()=>this.closeToast())):setTimeout(()=>{this.beingDragged=!1,DA(this.dragRect)&&this.pauseOnHover&&this.dragRect.bottom>=this.dragPos.y&&this.dragPos.y>=this.dragRect.top&&this.dragRect.left<=this.dragPos.x&&this.dragPos.x<=this.dragRect.right?this.isRunning=!1:this.isRunning=!0}))}}}),Q9=["role"];function eX(e,t){const n=rh("Icon"),l=rh("CloseButton"),h=rh("ProgressBar");return ui(),Ei("div",{class:Jr(e.classes),style:uc(e.draggableStyle),onClick:t[0]||(t[0]=(...d)=>e.clickHandler&&e.clickHandler(...d)),onMouseenter:t[1]||(t[1]=(...d)=>e.hoverPause&&e.hoverPause(...d)),onMouseleave:t[2]||(t[2]=(...d)=>e.hoverPlay&&e.hoverPlay(...d))},[e.icon?(ui(),Qr(n,{key:0,"custom-icon":e.icon,type:e.type},null,8,["custom-icon","type"])):xs("v-if",!0),tt("div",{role:e.accessibility.toastRole||"alert",class:Jr(e.bodyClasses)},[typeof e.content=="string"?(ui(),Ei(Dn,{key:0},[fr(Ht(e.content),1)],2112)):(ui(),Qr(Pv(e.getVueComponentFromObj(e.content)),Uy({key:1,"toast-id":e.id},e.hasProp(e.content,"props")?e.content.props:{},Lk(e.hasProp(e.content,"listeners")?e.content.listeners:{}),{onCloseToast:e.closeToast}),null,16,["toast-id","onCloseToast"]))],10,Q9),e.closeButton?(ui(),Qr(l,{key:1,component:e.closeButton,"class-names":e.closeButtonClassName,"show-on-hover":e.showCloseButtonOnHover,"aria-label":e.accessibility.closeButtonLabel,onClick:xy(e.closeToast,["stop"])},null,8,["component","class-names","show-on-hover","aria-label","onClick"])):xs("v-if",!0),e.timeout?(ui(),Qr(h,{key:2,"is-running":e.isRunning,"hide-progress-bar":e.hideProgressBar,timeout:e.timeout,onCloseToast:e.timeoutHandler},null,8,["is-running","hide-progress-bar","timeout","onCloseToast"])):xs("v-if",!0)],38)}CD.render=eX;var tX=CD,AD=gs({name:"VtTransition",props:au.TRANSITION,emits:["leave"],methods:{hasProp:lh,leave(e){e instanceof HTMLElement&&(e.style.left=e.offsetLeft+"px",e.style.top=e.offsetTop+"px",e.style.width=getComputedStyle(e).width,e.style.position="absolute")}}});function iX(e,t){return ui(),Qr(CI,{tag:"div","enter-active-class":e.transition.enter?e.transition.enter:`${e.transition}-enter-active`,"move-class":e.transition.move?e.transition.move:`${e.transition}-move`,"leave-active-class":e.transition.leave?e.transition.leave:`${e.transition}-leave-active`,onLeave:e.leave},{default:Kr(()=>[Pk(e.$slots,"default")]),_:3},8,["enter-active-class","move-class","leave-active-class","onLeave"])}AD.render=iX;var nX=AD,kD=gs({name:"VueToastification",devtools:{hide:!0},components:{Toast:tX,VtTransition:nX},props:Object.assign({},au.CORE_TOAST,au.CONTAINER,au.TRANSITION),data(){return{count:0,positions:Object.values(mv),toasts:{},defaults:{}}},computed:{toastArray(){return Object.values(this.toasts)},filteredToasts(){return this.defaults.filterToasts(this.toastArray)}},beforeMount(){const e=this.eventBus;e.on(el.ADD,this.addToast),e.on(el.CLEAR,this.clearToasts),e.on(el.DISMISS,this.dismissToast),e.on(el.UPDATE,this.updateToast),e.on(el.UPDATE_DEFAULTS,this.updateDefaults),this.defaults=this.$props},mounted(){this.setup(this.container)},methods:{async setup(e){ib(e)&&(e=await e()),v9(this.$el),e.appendChild(this.$el)},setToast(e){vp(e.id)||(this.toasts[e.id]=e)},addToast(e){e.content=b9(e.content);const t=Object.assign({},this.defaults,e.type&&this.defaults.toastDefaults&&this.defaults.toastDefaults[e.type],e),n=this.defaults.filterBeforeCreate(t,this.toastArray);n&&this.setToast(n)},dismissToast(e){const t=this.toasts[e];!vp(t)&&!vp(t.onClose)&&t.onClose(),delete this.toasts[e]},clearToasts(){Object.keys(this.toasts).forEach(e=>{this.dismissToast(e)})},getPositionToasts(e){const t=this.filteredToasts.filter(n=>n.position===e).slice(0,this.defaults.maxToasts);return this.defaults.newestOnTop?t.reverse():t},updateDefaults(e){vp(e.container)||this.setup(e.container),this.defaults=Object.assign({},this.defaults,e)},updateToast({id:e,options:t,create:n}){this.toasts[e]?(t.timeout&&t.timeout===this.toasts[e].timeout&&t.timeout++,this.setToast(Object.assign({},this.toasts[e],t))):n&&this.addToast(Object.assign({},{id:e},t))},getClasses(e){return[`${oc}__container`,e].concat(this.defaults.containerClassName)}}});function sX(e,t){const n=rh("Toast"),l=rh("VtTransition");return ui(),Ei("div",null,[(ui(!0),Ei(Dn,null,ta(e.positions,h=>(ui(),Ei("div",{key:h},[gn(l,{transition:e.defaults.transition,class:Jr(e.getClasses(h))},{default:Kr(()=>[(ui(!0),Ei(Dn,null,ta(e.getPositionToasts(h),d=>(ui(),Qr(n,Uy({key:d.id},d),null,16))),128))]),_:2},1032,["transition","class"])]))),128))])}kD.render=sX;var rX=kD,zA=(e={},t=!0)=>{const n=e.eventBus=e.eventBus||new nE;t&&Fd(()=>{const d=vy(rX,fD({},e)),g=d.mount(document.createElement("div")),b=e.onMounted;if(vp(b)||b(g,d),e.shareAppContext){const r=e.shareAppContext;r===!0?console.warn(`[${oc}] App to share context with was not provided.`):(d._context.components=r._context.components,d._context.directives=r._context.directives,d._context.mixins=r._context.mixins,d._context.provides=r._context.provides,d.config.globalProperties=r.config.globalProperties)}});const l=(d,g)=>{const b=Object.assign({},{id:x9(),type:Qa.DEFAULT},g,{content:d});return n.emit(el.ADD,b),b.id};l.clear=()=>n.emit(el.CLEAR,void 0),l.updateDefaults=d=>{n.emit(el.UPDATE_DEFAULTS,d)},l.dismiss=d=>{n.emit(el.DISMISS,d)};function h(d,{content:g,options:b},r=!1){const C=Object.assign({},b,{content:g});n.emit(el.UPDATE,{id:d,options:C,create:r})}return l.update=h,l.success=(d,g)=>l(d,Object.assign({},g,{type:Qa.SUCCESS})),l.info=(d,g)=>l(d,Object.assign({},g,{type:Qa.INFO})),l.error=(d,g)=>l(d,Object.assign({},g,{type:Qa.ERROR})),l.warning=(d,g)=>l(d,Object.assign({},g,{type:Qa.WARNING})),l},oX=()=>{const e=()=>console.warn(`[${oc}] This plugin does not support SSR!`);return new Proxy(e,{get(){return e}})};function aX(e){return w9()?T9(e)?zA({eventBus:e},!1):zA(e,!0):oX()}var lX=Symbol("VueToastification"),cX=new nE,hX=(e,t)=>{(t==null?void 0:t.shareAppContext)===!0&&(t.shareAppContext=e);const n=aX(fD({eventBus:cX},t));e.provide(lX,n)},uX=hX;const kg=vy(iU),dX=c5();kg.use(dX);kg.use(d9);kg.use(aq);kg.use(uD);kg.use(uX,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnHover:!0,draggable:!0,hideProgressBar:!1});kg.mount("#app");
