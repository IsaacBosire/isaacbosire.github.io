(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))_(T);new MutationObserver(T=>{for(const C of T)if(C.type==="childList")for(const P of C.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&_(P)}).observe(document,{childList:!0,subtree:!0});function d(T){const C={};return T.integrity&&(C.integrity=T.integrity),T.referrerPolicy&&(C.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?C.credentials="include":T.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function _(T){if(T.ep)return;T.ep=!0;const C=d(T);fetch(T.href,C)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ux(t){const l=Object.create(null);for(const d of t.split(","))l[d]=1;return d=>d in l}const Nr={},Jp=[],sl=()=>{},oI=()=>!1,o_=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),db=t=>t.startsWith("onUpdate:"),Sn=Object.assign,fb=(t,l)=>{const d=t.indexOf(l);d>-1&&t.splice(d,1)},aI=Object.prototype.hasOwnProperty,rn=(t,l)=>aI.call(t,l),Ri=Array.isArray,Qp=t=>dm(t)==="[object Map]",Rf=t=>dm(t)==="[object Set]",aw=t=>dm(t)==="[object Date]",lI=t=>dm(t)==="[object RegExp]",tr=t=>typeof t=="function",Rn=t=>typeof t=="string",Vl=t=>typeof t=="symbol",yn=t=>t!==null&&typeof t=="object",pb=t=>(yn(t)||tr(t))&&tr(t.then)&&tr(t.catch),fE=Object.prototype.toString,dm=t=>fE.call(t),cI=t=>dm(t).slice(8,-1),dx=t=>dm(t)==="[object Object]",mb=t=>Rn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,em=ux(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),fx=t=>{const l=Object.create(null);return d=>l[d]||(l[d]=t(d))},hI=/-(\w)/g,Xs=fx(t=>t.replace(hI,(l,d)=>d?d.toUpperCase():"")),uI=/\B([A-Z])/g,la=fx(t=>t.replace(uI,"-$1").toLowerCase()),a_=fx(t=>t.charAt(0).toUpperCase()+t.slice(1)),Pg=fx(t=>t?`on${a_(t)}`:""),Bo=(t,l)=>!Object.is(t,l),tm=(t,...l)=>{for(let d=0;d<t.length;d++)t[d](...l)},pE=(t,l,d,_=!1)=>{Object.defineProperty(t,l,{configurable:!0,enumerable:!1,writable:_,value:d})},Wy=t=>{const l=parseFloat(t);return isNaN(l)?t:l},Hy=t=>{const l=Rn(t)?Number(t):NaN;return isNaN(l)?t:l};let lw;const px=()=>lw||(lw=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),dI="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",fI=ux(dI);function zc(t){if(Ri(t)){const l={};for(let d=0;d<t.length;d++){const _=t[d],T=Rn(_)?_I(_):zc(_);if(T)for(const C in T)l[C]=T[C]}return l}else if(Rn(t)||yn(t))return t}const pI=/;(?![^(]*\))/g,mI=/:([^]+)/,gI=/\/\*[^]*?\*\//g;function _I(t){const l={};return t.replace(gI,"").split(pI).forEach(d=>{if(d){const _=d.split(mI);_.length>1&&(l[_[0].trim()]=_[1].trim())}}),l}function Vs(t){let l="";if(Rn(t))l=t;else if(Ri(t))for(let d=0;d<t.length;d++){const _=Vs(t[d]);_&&(l+=_+" ")}else if(yn(t))for(const d in t)t[d]&&(l+=d+" ");return l.trim()}function yI(t){if(!t)return null;let{class:l,style:d}=t;return l&&!Rn(l)&&(t.class=Vs(l)),d&&(t.style=zc(d)),t}const xI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vI=ux(xI);function mE(t){return!!t||t===""}function bI(t,l){if(t.length!==l.length)return!1;let d=!0;for(let _=0;d&&_<t.length;_++)d=qu(t[_],l[_]);return d}function qu(t,l){if(t===l)return!0;let d=aw(t),_=aw(l);if(d||_)return d&&_?t.getTime()===l.getTime():!1;if(d=Vl(t),_=Vl(l),d||_)return t===l;if(d=Ri(t),_=Ri(l),d||_)return d&&_?bI(t,l):!1;if(d=yn(t),_=yn(l),d||_){if(!d||!_)return!1;const T=Object.keys(t).length,C=Object.keys(l).length;if(T!==C)return!1;for(const P in t){const V=t.hasOwnProperty(P),s=l.hasOwnProperty(P);if(V&&!s||!V&&s||!qu(t[P],l[P]))return!1}}return String(t)===String(l)}function mx(t,l){return t.findIndex(d=>qu(d,l))}const gE=t=>!!(t&&t.__v_isRef===!0),Vt=t=>Rn(t)?t:t==null?"":Ri(t)||yn(t)&&(t.toString===fE||!tr(t.toString))?gE(t)?Vt(t.value):JSON.stringify(t,_E,2):String(t),_E=(t,l)=>gE(l)?_E(t,l.value):Qp(l)?{[`Map(${l.size})`]:[...l.entries()].reduce((d,[_,T],C)=>(d[t0(_,C)+" =>"]=T,d),{})}:Rf(l)?{[`Set(${l.size})`]:[...l.values()].map(d=>t0(d))}:Vl(l)?t0(l):yn(l)&&!Ri(l)&&!dx(l)?String(l):l,t0=(t,l="")=>{var d;return Vl(t)?`Symbol(${(d=t.description)!=null?d:l})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zo;class gb{constructor(l=!1){this.detached=l,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=zo,!l&&zo&&(this.index=(zo.scopes||(zo.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let l,d;if(this.scopes)for(l=0,d=this.scopes.length;l<d;l++)this.scopes[l].pause();for(l=0,d=this.effects.length;l<d;l++)this.effects[l].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let l,d;if(this.scopes)for(l=0,d=this.scopes.length;l<d;l++)this.scopes[l].resume();for(l=0,d=this.effects.length;l<d;l++)this.effects[l].resume()}}run(l){if(this._active){const d=zo;try{return zo=this,l()}finally{zo=d}}}on(){zo=this}off(){zo=this.parent}stop(l){if(this._active){this._active=!1;let d,_;for(d=0,_=this.effects.length;d<_;d++)this.effects[d].stop();for(this.effects.length=0,d=0,_=this.cleanups.length;d<_;d++)this.cleanups[d]();if(this.cleanups.length=0,this.scopes){for(d=0,_=this.scopes.length;d<_;d++)this.scopes[d].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!l){const T=this.parent.scopes.pop();T&&T!==this&&(this.parent.scopes[this.index]=T,T.index=this.index)}this.parent=void 0}}}function gx(t){return new gb(t)}function _b(){return zo}function yE(t,l=!1){zo&&zo.cleanups.push(t)}let Ln;const i0=new WeakSet;class jg{constructor(l){this.fn=l,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,zo&&zo.active&&zo.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,i0.has(this)&&(i0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||vE(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cw(this),bE(this);const l=Ln,d=Nl;Ln=this,Nl=!0;try{return this.fn()}finally{wE(this),Ln=l,Nl=d,this.flags&=-3}}stop(){if(this.flags&1){for(let l=this.deps;l;l=l.nextDep)vb(l);this.deps=this.depsTail=void 0,cw(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?i0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){S0(this)&&this.run()}get dirty(){return S0(this)}}let xE=0,Lg,Dg;function vE(t,l=!1){if(t.flags|=8,l){t.next=Dg,Dg=t;return}t.next=Lg,Lg=t}function yb(){xE++}function xb(){if(--xE>0)return;if(Dg){let l=Dg;for(Dg=void 0;l;){const d=l.next;l.next=void 0,l.flags&=-9,l=d}}let t;for(;Lg;){let l=Lg;for(Lg=void 0;l;){const d=l.next;if(l.next=void 0,l.flags&=-9,l.flags&1)try{l.trigger()}catch(_){t||(t=_)}l=d}}if(t)throw t}function bE(t){for(let l=t.deps;l;l=l.nextDep)l.version=-1,l.prevActiveLink=l.dep.activeLink,l.dep.activeLink=l}function wE(t){let l,d=t.depsTail,_=d;for(;_;){const T=_.prevDep;_.version===-1?(_===d&&(d=T),vb(_),wI(_)):l=_,_.dep.activeLink=_.prevActiveLink,_.prevActiveLink=void 0,_=T}t.deps=l,t.depsTail=d}function S0(t){for(let l=t.deps;l;l=l.nextDep)if(l.dep.version!==l.version||l.dep.computed&&(TE(l.dep.computed)||l.dep.version!==l.version))return!0;return!!t._dirty}function TE(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===$g))return;t.globalVersion=$g;const l=t.dep;if(t.flags|=2,l.version>0&&!t.isSSR&&t.deps&&!S0(t)){t.flags&=-3;return}const d=Ln,_=Nl;Ln=t,Nl=!0;try{bE(t);const T=t.fn(t._value);(l.version===0||Bo(T,t._value))&&(t._value=T,l.version++)}catch(T){throw l.version++,T}finally{Ln=d,Nl=_,wE(t),t.flags&=-3}}function vb(t,l=!1){const{dep:d,prevSub:_,nextSub:T}=t;if(_&&(_.nextSub=T,t.prevSub=void 0),T&&(T.prevSub=_,t.nextSub=void 0),d.subs===t&&(d.subs=_,!_&&d.computed)){d.computed.flags&=-5;for(let C=d.computed.deps;C;C=C.nextDep)vb(C,!0)}!l&&!--d.sc&&d.map&&d.map.delete(d.key)}function wI(t){const{prevDep:l,nextDep:d}=t;l&&(l.nextDep=d,t.prevDep=void 0),d&&(d.prevDep=l,t.nextDep=void 0)}function TI(t,l){t.effect instanceof jg&&(t=t.effect.fn);const d=new jg(t);l&&Sn(d,l);try{d.run()}catch(T){throw d.stop(),T}const _=d.run.bind(d);return _.effect=d,_}function EI(t){t.effect.stop()}let Nl=!0;const EE=[];function Ku(){EE.push(Nl),Nl=!1}function Ju(){const t=EE.pop();Nl=t===void 0?!0:t}function cw(t){const{cleanup:l}=t;if(t.cleanup=void 0,l){const d=Ln;Ln=void 0;try{l()}finally{Ln=d}}}let $g=0;class SI{constructor(l,d){this.sub=l,this.dep=d,this.version=d.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class _x{constructor(l){this.computed=l,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(l){if(!Ln||!Nl||Ln===this.computed)return;let d=this.activeLink;if(d===void 0||d.sub!==Ln)d=this.activeLink=new SI(Ln,this),Ln.deps?(d.prevDep=Ln.depsTail,Ln.depsTail.nextDep=d,Ln.depsTail=d):Ln.deps=Ln.depsTail=d,SE(d);else if(d.version===-1&&(d.version=this.version,d.nextDep)){const _=d.nextDep;_.prevDep=d.prevDep,d.prevDep&&(d.prevDep.nextDep=_),d.prevDep=Ln.depsTail,d.nextDep=void 0,Ln.depsTail.nextDep=d,Ln.depsTail=d,Ln.deps===d&&(Ln.deps=_)}return d}trigger(l){this.version++,$g++,this.notify(l)}notify(l){yb();try{for(let d=this.subs;d;d=d.prevSub)d.sub.notify()&&d.sub.dep.notify()}finally{xb()}}}function SE(t){if(t.dep.sc++,t.sub.flags&4){const l=t.dep.computed;if(l&&!t.dep.subs){l.flags|=20;for(let _=l.deps;_;_=_.nextDep)SE(_)}const d=t.dep.subs;d!==t&&(t.prevSub=d,d&&(d.nextSub=t)),t.dep.subs=t}}const qy=new WeakMap,Mf=Symbol(""),C0=Symbol(""),Gg=Symbol("");function po(t,l,d){if(Nl&&Ln){let _=qy.get(t);_||qy.set(t,_=new Map);let T=_.get(d);T||(_.set(d,T=new _x),T.map=_,T.key=d),T.track()}}function Th(t,l,d,_,T,C){const P=qy.get(t);if(!P){$g++;return}const V=s=>{s&&s.trigger()};if(yb(),l==="clear")P.forEach(V);else{const s=Ri(t),$=s&&mb(d);if(s&&d==="length"){const Z=Number(_);P.forEach((J,ne)=>{(ne==="length"||ne===Gg||!Vl(ne)&&ne>=Z)&&V(J)})}else switch((d!==void 0||P.has(void 0))&&V(P.get(d)),$&&V(P.get(Gg)),l){case"add":s?$&&V(P.get("length")):(V(P.get(Mf)),Qp(t)&&V(P.get(C0)));break;case"delete":s||(V(P.get(Mf)),Qp(t)&&V(P.get(C0)));break;case"set":Qp(t)&&V(P.get(Mf));break}}xb()}function CI(t,l){const d=qy.get(t);return d&&d.get(l)}function $p(t){const l=kr(t);return l===t?l:(po(l,"iterate",Gg),Fa(t)?l:l.map(mo))}function yx(t){return po(t=kr(t),"iterate",Gg),t}const AI={__proto__:null,[Symbol.iterator](){return r0(this,Symbol.iterator,mo)},concat(...t){return $p(this).concat(...t.map(l=>Ri(l)?$p(l):l))},entries(){return r0(this,"entries",t=>(t[1]=mo(t[1]),t))},every(t,l){return yh(this,"every",t,l,void 0,arguments)},filter(t,l){return yh(this,"filter",t,l,d=>d.map(mo),arguments)},find(t,l){return yh(this,"find",t,l,mo,arguments)},findIndex(t,l){return yh(this,"findIndex",t,l,void 0,arguments)},findLast(t,l){return yh(this,"findLast",t,l,mo,arguments)},findLastIndex(t,l){return yh(this,"findLastIndex",t,l,void 0,arguments)},forEach(t,l){return yh(this,"forEach",t,l,void 0,arguments)},includes(...t){return n0(this,"includes",t)},indexOf(...t){return n0(this,"indexOf",t)},join(t){return $p(this).join(t)},lastIndexOf(...t){return n0(this,"lastIndexOf",t)},map(t,l){return yh(this,"map",t,l,void 0,arguments)},pop(){return Tg(this,"pop")},push(...t){return Tg(this,"push",t)},reduce(t,...l){return hw(this,"reduce",t,l)},reduceRight(t,...l){return hw(this,"reduceRight",t,l)},shift(){return Tg(this,"shift")},some(t,l){return yh(this,"some",t,l,void 0,arguments)},splice(...t){return Tg(this,"splice",t)},toReversed(){return $p(this).toReversed()},toSorted(t){return $p(this).toSorted(t)},toSpliced(...t){return $p(this).toSpliced(...t)},unshift(...t){return Tg(this,"unshift",t)},values(){return r0(this,"values",mo)}};function r0(t,l,d){const _=yx(t),T=_[l]();return _!==t&&!Fa(t)&&(T._next=T.next,T.next=()=>{const C=T._next();return C.value&&(C.value=d(C.value)),C}),T}const MI=Array.prototype;function yh(t,l,d,_,T,C){const P=yx(t),V=P!==t&&!Fa(t),s=P[l];if(s!==MI[l]){const J=s.apply(t,C);return V?mo(J):J}let $=d;P!==t&&(V?$=function(J,ne){return d.call(this,mo(J),ne,t)}:d.length>2&&($=function(J,ne){return d.call(this,J,ne,t)}));const Z=s.call(P,$,_);return V&&T?T(Z):Z}function hw(t,l,d,_){const T=yx(t);let C=d;return T!==t&&(Fa(t)?d.length>3&&(C=function(P,V,s){return d.call(this,P,V,s,t)}):C=function(P,V,s){return d.call(this,P,mo(V),s,t)}),T[l](C,..._)}function n0(t,l,d){const _=kr(t);po(_,"iterate",Gg);const T=_[l](...d);return(T===-1||T===!1)&&bx(d[0])?(d[0]=kr(d[0]),_[l](...d)):T}function Tg(t,l,d=[]){Ku(),yb();const _=kr(t)[l].apply(t,d);return xb(),Ju(),_}const II=ux("__proto__,__v_isRef,__isVue"),CE=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Vl));function kI(t){Vl(t)||(t=String(t));const l=kr(this);return po(l,"has",t),l.hasOwnProperty(t)}class AE{constructor(l=!1,d=!1){this._isReadonly=l,this._isShallow=d}get(l,d,_){if(d==="__v_skip")return l.__v_skip;const T=this._isReadonly,C=this._isShallow;if(d==="__v_isReactive")return!T;if(d==="__v_isReadonly")return T;if(d==="__v_isShallow")return C;if(d==="__v_raw")return _===(T?C?DE:LE:C?PE:kE).get(l)||Object.getPrototypeOf(l)===Object.getPrototypeOf(_)?l:void 0;const P=Ri(l);if(!T){let s;if(P&&(s=AI[d]))return s;if(d==="hasOwnProperty")return kI}const V=Reflect.get(l,d,On(l)?l:_);return(Vl(d)?CE.has(d):II(d))||(T||po(l,"get",d),C)?V:On(V)?P&&mb(d)?V:V.value:yn(V)?T?wb(V):fm(V):V}}class ME extends AE{constructor(l=!1){super(!1,l)}set(l,d,_,T){let C=l[d];if(!this._isShallow){const s=Xu(C);if(!Fa(_)&&!Xu(_)&&(C=kr(C),_=kr(_)),!Ri(l)&&On(C)&&!On(_))return s?!1:(C.value=_,!0)}const P=Ri(l)&&mb(d)?Number(d)<l.length:rn(l,d),V=Reflect.set(l,d,_,On(l)?l:T);return l===kr(T)&&(P?Bo(_,C)&&Th(l,"set",d,_):Th(l,"add",d,_)),V}deleteProperty(l,d){const _=rn(l,d);l[d];const T=Reflect.deleteProperty(l,d);return T&&_&&Th(l,"delete",d,void 0),T}has(l,d){const _=Reflect.has(l,d);return(!Vl(d)||!CE.has(d))&&po(l,"has",d),_}ownKeys(l){return po(l,"iterate",Ri(l)?"length":Mf),Reflect.ownKeys(l)}}class IE extends AE{constructor(l=!1){super(!0,l)}set(l,d){return!0}deleteProperty(l,d){return!0}}const PI=new ME,LI=new IE,DI=new ME(!0),OI=new IE(!0),A0=t=>t,Ty=t=>Reflect.getPrototypeOf(t);function RI(t,l,d){return function(..._){const T=this.__v_raw,C=kr(T),P=Qp(C),V=t==="entries"||t===Symbol.iterator&&P,s=t==="keys"&&P,$=T[t](..._),Z=d?A0:l?M0:mo;return!l&&po(C,"iterate",s?C0:Mf),{next(){const{value:J,done:ne}=$.next();return ne?{value:J,done:ne}:{value:V?[Z(J[0]),Z(J[1])]:Z(J),done:ne}},[Symbol.iterator](){return this}}}}function Ey(t){return function(...l){return t==="delete"?!1:t==="clear"?void 0:this}}function zI(t,l){const d={get(T){const C=this.__v_raw,P=kr(C),V=kr(T);t||(Bo(T,V)&&po(P,"get",T),po(P,"get",V));const{has:s}=Ty(P),$=l?A0:t?M0:mo;if(s.call(P,T))return $(C.get(T));if(s.call(P,V))return $(C.get(V));C!==P&&C.get(T)},get size(){const T=this.__v_raw;return!t&&po(kr(T),"iterate",Mf),Reflect.get(T,"size",T)},has(T){const C=this.__v_raw,P=kr(C),V=kr(T);return t||(Bo(T,V)&&po(P,"has",T),po(P,"has",V)),T===V?C.has(T):C.has(T)||C.has(V)},forEach(T,C){const P=this,V=P.__v_raw,s=kr(V),$=l?A0:t?M0:mo;return!t&&po(s,"iterate",Mf),V.forEach((Z,J)=>T.call(C,$(Z),$(J),P))}};return Sn(d,t?{add:Ey("add"),set:Ey("set"),delete:Ey("delete"),clear:Ey("clear")}:{add(T){!l&&!Fa(T)&&!Xu(T)&&(T=kr(T));const C=kr(this);return Ty(C).has.call(C,T)||(C.add(T),Th(C,"add",T,T)),this},set(T,C){!l&&!Fa(C)&&!Xu(C)&&(C=kr(C));const P=kr(this),{has:V,get:s}=Ty(P);let $=V.call(P,T);$||(T=kr(T),$=V.call(P,T));const Z=s.call(P,T);return P.set(T,C),$?Bo(C,Z)&&Th(P,"set",T,C):Th(P,"add",T,C),this},delete(T){const C=kr(this),{has:P,get:V}=Ty(C);let s=P.call(C,T);s||(T=kr(T),s=P.call(C,T)),V&&V.call(C,T);const $=C.delete(T);return s&&Th(C,"delete",T,void 0),$},clear(){const T=kr(this),C=T.size!==0,P=T.clear();return C&&Th(T,"clear",void 0,void 0),P}}),["keys","values","entries",Symbol.iterator].forEach(T=>{d[T]=RI(T,t,l)}),d}function xx(t,l){const d=zI(t,l);return(_,T,C)=>T==="__v_isReactive"?!t:T==="__v_isReadonly"?t:T==="__v_raw"?_:Reflect.get(rn(d,T)&&T in _?d:_,T,C)}const BI={get:xx(!1,!1)},FI={get:xx(!1,!0)},NI={get:xx(!0,!1)},UI={get:xx(!0,!0)},kE=new WeakMap,PE=new WeakMap,LE=new WeakMap,DE=new WeakMap;function VI(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jI(t){return t.__v_skip||!Object.isExtensible(t)?0:VI(cI(t))}function fm(t){return Xu(t)?t:vx(t,!1,PI,BI,kE)}function bb(t){return vx(t,!1,DI,FI,PE)}function wb(t){return vx(t,!0,LI,NI,LE)}function $I(t){return vx(t,!0,OI,UI,DE)}function vx(t,l,d,_,T){if(!yn(t)||t.__v_raw&&!(l&&t.__v_isReactive))return t;const C=T.get(t);if(C)return C;const P=jI(t);if(P===0)return t;const V=new Proxy(t,P===2?_:d);return T.set(t,V),V}function Ul(t){return Xu(t)?Ul(t.__v_raw):!!(t&&t.__v_isReactive)}function Xu(t){return!!(t&&t.__v_isReadonly)}function Fa(t){return!!(t&&t.__v_isShallow)}function bx(t){return t?!!t.__v_raw:!1}function kr(t){const l=t&&t.__v_raw;return l?kr(l):t}function wx(t){return!rn(t,"__v_skip")&&Object.isExtensible(t)&&pE(t,"__v_skip",!0),t}const mo=t=>yn(t)?fm(t):t,M0=t=>yn(t)?wb(t):t;function On(t){return t?t.__v_isRef===!0:!1}function Vi(t){return OE(t,!1)}function l_(t){return OE(t,!0)}function OE(t,l){return On(t)?t:new GI(t,l)}class GI{constructor(l,d){this.dep=new _x,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=d?l:kr(l),this._value=d?l:mo(l),this.__v_isShallow=d}get value(){return this.dep.track(),this._value}set value(l){const d=this._rawValue,_=this.__v_isShallow||Fa(l)||Xu(l);l=_?l:kr(l),Bo(l,d)&&(this._rawValue=l,this._value=_?l:mo(l),this.dep.trigger())}}function WI(t){t.dep&&t.dep.trigger()}function cn(t){return On(t)?t.value:t}function HI(t){return tr(t)?t():cn(t)}const qI={get:(t,l,d)=>l==="__v_raw"?t:cn(Reflect.get(t,l,d)),set:(t,l,d,_)=>{const T=t[l];return On(T)&&!On(d)?(T.value=d,!0):Reflect.set(t,l,d,_)}};function Tb(t){return Ul(t)?t:new Proxy(t,qI)}class XI{constructor(l){this.__v_isRef=!0,this._value=void 0;const d=this.dep=new _x,{get:_,set:T}=l(d.track.bind(d),d.trigger.bind(d));this._get=_,this._set=T}get value(){return this._value=this._get()}set value(l){this._set(l)}}function RE(t){return new XI(t)}function zE(t){const l=Ri(t)?new Array(t.length):{};for(const d in t)l[d]=FE(t,d);return l}class ZI{constructor(l,d,_){this._object=l,this._key=d,this._defaultValue=_,this.__v_isRef=!0,this._value=void 0}get value(){const l=this._object[this._key];return this._value=l===void 0?this._defaultValue:l}set value(l){this._object[this._key]=l}get dep(){return CI(kr(this._object),this._key)}}class YI{constructor(l){this._getter=l,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function BE(t,l,d){return On(t)?t:tr(t)?new YI(t):yn(t)&&arguments.length>1?FE(t,l,d):Vi(t)}function FE(t,l,d){const _=t[l];return On(_)?_:new ZI(t,l,d)}class KI{constructor(l,d,_){this.fn=l,this.setter=d,this._value=void 0,this.dep=new _x(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$g-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!d,this.isSSR=_}notify(){if(this.flags|=16,!(this.flags&8)&&Ln!==this)return vE(this,!0),!0}get value(){const l=this.dep.track();return TE(this),l&&(l.version=this.dep.version),this._value}set value(l){this.setter&&this.setter(l)}}function JI(t,l,d=!1){let _,T;return tr(t)?_=t:(_=t.get,T=t.set),new KI(_,T,d)}const QI={GET:"get",HAS:"has",ITERATE:"iterate"},ek={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},Sy={},Xy=new WeakMap;let Vu;function tk(){return Vu}function NE(t,l=!1,d=Vu){if(d){let _=Xy.get(d);_||Xy.set(d,_=[]),_.push(t)}}function ik(t,l,d=Nr){const{immediate:_,deep:T,once:C,scheduler:P,augmentJob:V,call:s}=d,$=ge=>T?ge:Fa(ge)||T===!1||T===0?Eh(ge,1):Eh(ge);let Z,J,ne,ue,we=!1,Me=!1;if(On(t)?(J=()=>t.value,we=Fa(t)):Ul(t)?(J=()=>$(t),we=!0):Ri(t)?(Me=!0,we=t.some(ge=>Ul(ge)||Fa(ge)),J=()=>t.map(ge=>{if(On(ge))return ge.value;if(Ul(ge))return $(ge);if(tr(ge))return s?s(ge,2):ge()})):tr(t)?l?J=s?()=>s(t,2):t:J=()=>{if(ne){Ku();try{ne()}finally{Ju()}}const ge=Vu;Vu=Z;try{return s?s(t,3,[ue]):t(ue)}finally{Vu=ge}}:J=sl,l&&T){const ge=J,Oe=T===!0?1/0:T;J=()=>Eh(ge(),Oe)}const Ye=_b(),Ze=()=>{Z.stop(),Ye&&Ye.active&&fb(Ye.effects,Z)};if(C&&l){const ge=l;l=(...Oe)=>{ge(...Oe),Ze()}}let je=Me?new Array(t.length).fill(Sy):Sy;const ae=ge=>{if(!(!(Z.flags&1)||!Z.dirty&&!ge))if(l){const Oe=Z.run();if(T||we||(Me?Oe.some((ze,rt)=>Bo(ze,je[rt])):Bo(Oe,je))){ne&&ne();const ze=Vu;Vu=Z;try{const rt=[Oe,je===Sy?void 0:Me&&je[0]===Sy?[]:je,ue];s?s(l,3,rt):l(...rt),je=Oe}finally{Vu=ze}}}else Z.run()};return V&&V(ae),Z=new jg(J),Z.scheduler=P?()=>P(ae,!1):ae,ue=ge=>NE(ge,!1,Z),ne=Z.onStop=()=>{const ge=Xy.get(Z);if(ge){if(s)s(ge,4);else for(const Oe of ge)Oe();Xy.delete(Z)}},l?_?ae(!0):je=Z.run():P?P(ae.bind(null,!0),!0):Z.run(),Ze.pause=Z.pause.bind(Z),Ze.resume=Z.resume.bind(Z),Ze.stop=Ze,Ze}function Eh(t,l=1/0,d){if(l<=0||!yn(t)||t.__v_skip||(d=d||new Set,d.has(t)))return t;if(d.add(t),l--,On(t))Eh(t.value,l,d);else if(Ri(t))for(let _=0;_<t.length;_++)Eh(t[_],l,d);else if(Rf(t)||Qp(t))t.forEach(_=>{Eh(_,l,d)});else if(dx(t)){for(const _ in t)Eh(t[_],l,d);for(const _ of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,_)&&Eh(t[_],l,d)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const UE=[];function rk(t){UE.push(t)}function nk(){UE.pop()}function sk(t,l){}const ok={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},ak={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function pm(t,l,d,_){try{return _?t(..._):t()}catch(T){zf(T,l,d)}}function al(t,l,d,_){if(tr(t)){const T=pm(t,l,d,_);return T&&pb(T)&&T.catch(C=>{zf(C,l,d)}),T}if(Ri(t)){const T=[];for(let C=0;C<t.length;C++)T.push(al(t[C],l,d,_));return T}}function zf(t,l,d,_=!0){const T=l?l.vnode:null,{errorHandler:C,throwUnhandledErrorInProduction:P}=l&&l.appContext.config||Nr;if(l){let V=l.parent;const s=l.proxy,$=`https://vuejs.org/error-reference/#runtime-${d}`;for(;V;){const Z=V.ec;if(Z){for(let J=0;J<Z.length;J++)if(Z[J](t,s,$)===!1)return}V=V.parent}if(C){Ku(),pm(C,null,10,[t,s,$]),Ju();return}}lk(t,d,T,_,P)}function lk(t,l,d,_=!0,T=!1){if(T)throw t;console.error(t)}const Fo=[];let kc=-1;const im=[];let ju=null,Hp=0;const VE=Promise.resolve();let Zy=null;function Bf(t){const l=Zy||VE;return t?l.then(this?t.bind(this):t):l}function ck(t){let l=kc+1,d=Fo.length;for(;l<d;){const _=l+d>>>1,T=Fo[_],C=Hg(T);C<t||C===t&&T.flags&2?l=_+1:d=_}return l}function Eb(t){if(!(t.flags&1)){const l=Hg(t),d=Fo[Fo.length-1];!d||!(t.flags&2)&&l>=Hg(d)?Fo.push(t):Fo.splice(ck(l),0,t),t.flags|=1,jE()}}function jE(){Zy||(Zy=VE.then($E))}function Wg(t){Ri(t)?im.push(...t):ju&&t.id===-1?ju.splice(Hp+1,0,t):t.flags&1||(im.push(t),t.flags|=1),jE()}function uw(t,l,d=kc+1){for(;d<Fo.length;d++){const _=Fo[d];if(_&&_.flags&2){if(t&&_.id!==t.uid)continue;Fo.splice(d,1),d--,_.flags&4&&(_.flags&=-2),_(),_.flags&4||(_.flags&=-2)}}}function Yy(t){if(im.length){const l=[...new Set(im)].sort((d,_)=>Hg(d)-Hg(_));if(im.length=0,ju){ju.push(...l);return}for(ju=l,Hp=0;Hp<ju.length;Hp++){const d=ju[Hp];d.flags&4&&(d.flags&=-2),d.flags&8||d(),d.flags&=-2}ju=null,Hp=0}}const Hg=t=>t.id==null?t.flags&2?-1:1/0:t.id;function $E(t){try{for(kc=0;kc<Fo.length;kc++){const l=Fo[kc];l&&!(l.flags&8)&&(l.flags&4&&(l.flags&=-2),pm(l,l.i,l.i?15:14),l.flags&4||(l.flags&=-2))}}finally{for(;kc<Fo.length;kc++){const l=Fo[kc];l&&(l.flags&=-2)}kc=-1,Fo.length=0,Yy(),Zy=null,(Fo.length||im.length)&&$E()}}let qp,Cy=[];function GE(t,l){var d,_;qp=t,qp?(qp.enabled=!0,Cy.forEach(({event:T,args:C})=>qp.emit(T,...C)),Cy=[]):typeof window<"u"&&window.HTMLElement&&!((_=(d=window.navigator)==null?void 0:d.userAgent)!=null&&_.includes("jsdom"))?((l.__VUE_DEVTOOLS_HOOK_REPLAY__=l.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(C=>{GE(C,l)}),setTimeout(()=>{qp||(l.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Cy=[])},3e3)):Cy=[]}let ks=null,Tx=null;function qg(t){const l=ks;return ks=t,Tx=t&&t.type.__scopeId||null,l}function hk(t){Tx=t}function uk(){Tx=null}const dk=t=>Us;function Us(t,l=ks,d){if(!l||t._n)return t;const _=(...T)=>{_._d&&z0(-1);const C=qg(l);let P;try{P=t(...T)}finally{qg(C),_._d&&z0(1)}return P};return _._n=!0,_._c=!0,_._d=!0,_}function fo(t,l){if(ks===null)return t;const d=f_(ks),_=t.dirs||(t.dirs=[]);for(let T=0;T<l.length;T++){let[C,P,V,s=Nr]=l[T];C&&(tr(C)&&(C={mounted:C,updated:C}),C.deep&&Eh(P),_.push({dir:C,instance:d,value:P,oldValue:void 0,arg:V,modifiers:s}))}return t}function Pc(t,l,d,_){const T=t.dirs,C=l&&l.dirs;for(let P=0;P<T.length;P++){const V=T[P];C&&(V.oldValue=C[P].value);let s=V.dir[_];s&&(Ku(),al(s,d,8,[t.el,V,t,l]),Ju())}}const WE=Symbol("_vte"),HE=t=>t.__isTeleport,Og=t=>t&&(t.disabled||t.disabled===""),dw=t=>t&&(t.defer||t.defer===""),fw=t=>typeof SVGElement<"u"&&t instanceof SVGElement,pw=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,I0=(t,l)=>{const d=t&&t.to;return Rn(d)?l?l(d):null:d},qE={name:"Teleport",__isTeleport:!0,process(t,l,d,_,T,C,P,V,s,$){const{mc:Z,pc:J,pbc:ne,o:{insert:ue,querySelector:we,createText:Me,createComment:Ye}}=$,Ze=Og(l.props);let{shapeFlag:je,children:ae,dynamicChildren:ge}=l;if(t==null){const Oe=l.el=Me(""),ze=l.anchor=Me("");ue(Oe,d,_),ue(ze,d,_);const rt=(Ke,He)=>{je&16&&(T&&T.isCE&&(T.ce._teleportTarget=Ke),Z(ae,Ke,He,T,C,P,V,s))},ke=()=>{const Ke=l.target=I0(l.props,we),He=XE(Ke,l,Me,ue);Ke&&(P!=="svg"&&fw(Ke)?P="svg":P!=="mathml"&&pw(Ke)&&(P="mathml"),Ze||(rt(Ke,He),Ry(l,!1)))};Ze&&(rt(d,ze),Ry(l,!0)),dw(l.props)?Ms(()=>{ke(),l.el.__isMounted=!0},C):ke()}else{if(dw(l.props)&&!t.el.__isMounted){Ms(()=>{qE.process(t,l,d,_,T,C,P,V,s,$),delete t.el.__isMounted},C);return}l.el=t.el,l.targetStart=t.targetStart;const Oe=l.anchor=t.anchor,ze=l.target=t.target,rt=l.targetAnchor=t.targetAnchor,ke=Og(t.props),Ke=ke?d:ze,He=ke?Oe:rt;if(P==="svg"||fw(ze)?P="svg":(P==="mathml"||pw(ze))&&(P="mathml"),ge?(ne(t.dynamicChildren,ge,Ke,T,C,P,V),Rb(t,l,!0)):s||J(t,l,Ke,He,T,C,P,V,!1),Ze)ke?l.props&&t.props&&l.props.to!==t.props.to&&(l.props.to=t.props.to):Ay(l,d,Oe,$,1);else if((l.props&&l.props.to)!==(t.props&&t.props.to)){const ri=l.target=I0(l.props,we);ri&&Ay(l,ri,null,$,0)}else ke&&Ay(l,ze,rt,$,1);Ry(l,Ze)}},remove(t,l,d,{um:_,o:{remove:T}},C){const{shapeFlag:P,children:V,anchor:s,targetStart:$,targetAnchor:Z,target:J,props:ne}=t;if(J&&(T($),T(Z)),C&&T(s),P&16){const ue=C||!Og(ne);for(let we=0;we<V.length;we++){const Me=V[we];_(Me,l,d,ue,!!Me.dynamicChildren)}}},move:Ay,hydrate:fk};function Ay(t,l,d,{o:{insert:_},m:T},C=2){C===0&&_(t.targetAnchor,l,d);const{el:P,anchor:V,shapeFlag:s,children:$,props:Z}=t,J=C===2;if(J&&_(P,l,d),(!J||Og(Z))&&s&16)for(let ne=0;ne<$.length;ne++)T($[ne],l,d,2);J&&_(V,l,d)}function fk(t,l,d,_,T,C,{o:{nextSibling:P,parentNode:V,querySelector:s,insert:$,createText:Z}},J){const ne=l.target=I0(l.props,s);if(ne){const ue=Og(l.props),we=ne._lpa||ne.firstChild;if(l.shapeFlag&16)if(ue)l.anchor=J(P(t),l,V(t),d,_,T,C),l.targetStart=we,l.targetAnchor=we&&P(we);else{l.anchor=P(t);let Me=we;for(;Me;){if(Me&&Me.nodeType===8){if(Me.data==="teleport start anchor")l.targetStart=Me;else if(Me.data==="teleport anchor"){l.targetAnchor=Me,ne._lpa=l.targetAnchor&&P(l.targetAnchor);break}}Me=P(Me)}l.targetAnchor||XE(ne,l,Z,$),J(we&&P(we),l,ne,d,_,T,C)}Ry(l,ue)}return l.anchor&&P(l.anchor)}const pk=qE;function Ry(t,l){const d=t.ctx;if(d&&d.ut){let _,T;for(l?(_=t.el,T=t.anchor):(_=t.targetStart,T=t.targetAnchor);_&&_!==T;)_.nodeType===1&&_.setAttribute("data-v-owner",d.uid),_=_.nextSibling;d.ut()}}function XE(t,l,d,_){const T=l.targetStart=d(""),C=l.targetAnchor=d("");return T[WE]=C,t&&(_(T,t),_(C,t)),C}const $u=Symbol("_leaveCb"),My=Symbol("_enterCb");function Sb(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Oh(()=>{t.isMounted=!0}),Ax(()=>{t.isUnmounting=!0}),t}const il=[Function,Array],Cb={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:il,onEnter:il,onAfterEnter:il,onEnterCancelled:il,onBeforeLeave:il,onLeave:il,onAfterLeave:il,onLeaveCancelled:il,onBeforeAppear:il,onAppear:il,onAfterAppear:il,onAppearCancelled:il},ZE=t=>{const l=t.subTree;return l.component?ZE(l.component):l},mk={name:"BaseTransition",props:Cb,setup(t,{slots:l}){const d=Ys(),_=Sb();return()=>{const T=l.default&&Ex(l.default(),!0);if(!T||!T.length)return;const C=YE(T),P=kr(t),{mode:V}=P;if(_.isLeaving)return s0(C);const s=mw(C);if(!s)return s0(C);let $=nm(s,P,_,d,J=>$=J);s.type!==Ts&&Ph(s,$);let Z=d.subTree&&mw(d.subTree);if(Z&&Z.type!==Ts&&!Rl(s,Z)&&ZE(d).type!==Ts){let J=nm(Z,P,_,d);if(Ph(Z,J),V==="out-in"&&s.type!==Ts)return _.isLeaving=!0,J.afterLeave=()=>{_.isLeaving=!1,d.job.flags&8||d.update(),delete J.afterLeave,Z=void 0},s0(C);V==="in-out"&&s.type!==Ts?J.delayLeave=(ne,ue,we)=>{const Me=JE(_,Z);Me[String(Z.key)]=Z,ne[$u]=()=>{ue(),ne[$u]=void 0,delete $.delayedLeave,Z=void 0},$.delayedLeave=()=>{we(),delete $.delayedLeave,Z=void 0}}:Z=void 0}else Z&&(Z=void 0);return C}}};function YE(t){let l=t[0];if(t.length>1){for(const d of t)if(d.type!==Ts){l=d;break}}return l}const KE=mk;function JE(t,l){const{leavingVNodes:d}=t;let _=d.get(l.type);return _||(_=Object.create(null),d.set(l.type,_)),_}function nm(t,l,d,_,T){const{appear:C,mode:P,persisted:V=!1,onBeforeEnter:s,onEnter:$,onAfterEnter:Z,onEnterCancelled:J,onBeforeLeave:ne,onLeave:ue,onAfterLeave:we,onLeaveCancelled:Me,onBeforeAppear:Ye,onAppear:Ze,onAfterAppear:je,onAppearCancelled:ae}=l,ge=String(t.key),Oe=JE(d,t),ze=(Ke,He)=>{Ke&&al(Ke,_,9,He)},rt=(Ke,He)=>{const ri=He[1];ze(Ke,He),Ri(Ke)?Ke.every(bt=>bt.length<=1)&&ri():Ke.length<=1&&ri()},ke={mode:P,persisted:V,beforeEnter(Ke){let He=s;if(!d.isMounted)if(C)He=Ye||s;else return;Ke[$u]&&Ke[$u](!0);const ri=Oe[ge];ri&&Rl(t,ri)&&ri.el[$u]&&ri.el[$u](),ze(He,[Ke])},enter(Ke){let He=$,ri=Z,bt=J;if(!d.isMounted)if(C)He=Ze||$,ri=je||Z,bt=ae||J;else return;let dt=!1;const kt=Ke[My]=Pt=>{dt||(dt=!0,Pt?ze(bt,[Ke]):ze(ri,[Ke]),ke.delayedLeave&&ke.delayedLeave(),Ke[My]=void 0)};He?rt(He,[Ke,kt]):kt()},leave(Ke,He){const ri=String(t.key);if(Ke[My]&&Ke[My](!0),d.isUnmounting)return He();ze(ne,[Ke]);let bt=!1;const dt=Ke[$u]=kt=>{bt||(bt=!0,He(),kt?ze(Me,[Ke]):ze(we,[Ke]),Ke[$u]=void 0,Oe[ri]===t&&delete Oe[ri])};Oe[ri]=t,ue?rt(ue,[Ke,dt]):dt()},clone(Ke){const He=nm(Ke,l,d,_,T);return T&&T(He),He}};return ke}function s0(t){if(c_(t))return t=Rc(t),t.children=null,t}function mw(t){if(!c_(t))return HE(t.type)&&t.children?YE(t.children):t;const{shapeFlag:l,children:d}=t;if(d){if(l&16)return d[0];if(l&32&&tr(d.default))return d.default()}}function Ph(t,l){t.shapeFlag&6&&t.component?(t.transition=l,Ph(t.component.subTree,l)):t.shapeFlag&128?(t.ssContent.transition=l.clone(t.ssContent),t.ssFallback.transition=l.clone(t.ssFallback)):t.transition=l}function Ex(t,l=!1,d){let _=[],T=0;for(let C=0;C<t.length;C++){let P=t[C];const V=d==null?P.key:String(d)+String(P.key!=null?P.key:C);P.type===$r?(P.patchFlag&128&&T++,_=_.concat(Ex(P.children,l,V))):(l||P.type!==Ts)&&_.push(V!=null?Rc(P,{key:V}):P)}if(T>1)for(let C=0;C<_.length;C++)_[C].patchFlag=-2;return _}/*! #__NO_SIDE_EFFECTS__ */function zn(t,l){return tr(t)?Sn({name:t.name},l,{setup:t}):t}function gk(){const t=Ys();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function Ab(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function _k(t){const l=Ys(),d=l_(null);if(l){const T=l.refs===Nr?l.refs={}:l.refs;Object.defineProperty(T,t,{enumerable:!0,get:()=>d.value,set:C=>d.value=C})}return d}function Xg(t,l,d,_,T=!1){if(Ri(t)){t.forEach((we,Me)=>Xg(we,l&&(Ri(l)?l[Me]:l),d,_,T));return}if(Hu(_)&&!T){_.shapeFlag&512&&_.type.__asyncResolved&&_.component.subTree.component&&Xg(t,l,d,_.component.subTree);return}const C=_.shapeFlag&4?f_(_.component):_.el,P=T?null:C,{i:V,r:s}=t,$=l&&l.r,Z=V.refs===Nr?V.refs={}:V.refs,J=V.setupState,ne=kr(J),ue=J===Nr?()=>!1:we=>rn(ne,we);if($!=null&&$!==s&&(Rn($)?(Z[$]=null,ue($)&&(J[$]=null)):On($)&&($.value=null)),tr(s))pm(s,V,12,[P,Z]);else{const we=Rn(s),Me=On(s);if(we||Me){const Ye=()=>{if(t.f){const Ze=we?ue(s)?J[s]:Z[s]:s.value;T?Ri(Ze)&&fb(Ze,C):Ri(Ze)?Ze.includes(C)||Ze.push(C):we?(Z[s]=[C],ue(s)&&(J[s]=Z[s])):(s.value=[C],t.k&&(Z[t.k]=s.value))}else we?(Z[s]=P,ue(s)&&(J[s]=P)):Me&&(s.value=P,t.k&&(Z[t.k]=P))};P?(Ye.id=-1,Ms(Ye,d)):Ye()}}}let gw=!1;const Gp=()=>{gw||(console.error("Hydration completed but contains mismatches."),gw=!0)},yk=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",xk=t=>t.namespaceURI.includes("MathML"),Iy=t=>{if(t.nodeType===1){if(yk(t))return"svg";if(xk(t))return"mathml"}},Yp=t=>t.nodeType===8;function vk(t){const{mt:l,p:d,o:{patchProp:_,createText:T,nextSibling:C,parentNode:P,remove:V,insert:s,createComment:$}}=t,Z=(ae,ge)=>{if(!ge.hasChildNodes()){d(null,ae,ge),Yy(),ge._vnode=ae;return}J(ge.firstChild,ae,null,null,null),Yy(),ge._vnode=ae},J=(ae,ge,Oe,ze,rt,ke=!1)=>{ke=ke||!!ge.dynamicChildren;const Ke=Yp(ae)&&ae.data==="[",He=()=>Me(ae,ge,Oe,ze,rt,Ke),{type:ri,ref:bt,shapeFlag:dt,patchFlag:kt}=ge;let Pt=ae.nodeType;ge.el=ae,kt===-2&&(ke=!1,ge.dynamicChildren=null);let vt=null;switch(ri){case Ih:Pt!==3?ge.children===""?(s(ge.el=T(""),P(ae),ae),vt=ae):vt=He():(ae.data!==ge.children&&(Gp(),ae.data=ge.children),vt=C(ae));break;case Ts:je(ae)?(vt=C(ae),Ze(ge.el=ae.content.firstChild,ae,Oe)):Pt!==8||Ke?vt=He():vt=C(ae);break;case kf:if(Ke&&(ae=C(ae),Pt=ae.nodeType),Pt===1||Pt===3){vt=ae;const ci=!ge.children.length;for(let xi=0;xi<ge.staticCount;xi++)ci&&(ge.children+=vt.nodeType===1?vt.outerHTML:vt.data),xi===ge.staticCount-1&&(ge.anchor=vt),vt=C(vt);return Ke?C(vt):vt}else He();break;case $r:Ke?vt=we(ae,ge,Oe,ze,rt,ke):vt=He();break;default:if(dt&1)(Pt!==1||ge.type.toLowerCase()!==ae.tagName.toLowerCase())&&!je(ae)?vt=He():vt=ne(ae,ge,Oe,ze,rt,ke);else if(dt&6){ge.slotScopeIds=rt;const ci=P(ae);if(Ke?vt=Ye(ae):Yp(ae)&&ae.data==="teleport start"?vt=Ye(ae,ae.data,"teleport end"):vt=C(ae),l(ge,ci,null,Oe,ze,Iy(ci),ke),Hu(ge)&&!ge.type.__asyncResolved){let xi;Ke?(xi=pr($r),xi.anchor=vt?vt.previousSibling:ci.lastChild):xi=ae.nodeType===3?js(""):pr("div"),xi.el=ae,ge.component.subTree=xi}}else dt&64?Pt!==8?vt=He():vt=ge.type.hydrate(ae,ge,Oe,ze,rt,ke,t,ue):dt&128&&(vt=ge.type.hydrate(ae,ge,Oe,ze,Iy(P(ae)),rt,ke,t,J))}return bt!=null&&Xg(bt,null,ze,ge),vt},ne=(ae,ge,Oe,ze,rt,ke)=>{ke=ke||!!ge.dynamicChildren;const{type:Ke,props:He,patchFlag:ri,shapeFlag:bt,dirs:dt,transition:kt}=ge,Pt=Ke==="input"||Ke==="option";if(Pt||ri!==-1){dt&&Pc(ge,null,Oe,"created");let vt=!1;if(je(ae)){vt=SS(null,kt)&&Oe&&Oe.vnode.props&&Oe.vnode.props.appear;const xi=ae.content.firstChild;vt&&kt.beforeEnter(xi),Ze(xi,ae,Oe),ge.el=ae=xi}if(bt&16&&!(He&&(He.innerHTML||He.textContent))){let xi=ue(ae.firstChild,ge,ae,Oe,ze,rt,ke);for(;xi;){ky(ae,1)||Gp();const vi=xi;xi=xi.nextSibling,V(vi)}}else if(bt&8){let xi=ge.children;xi[0]===`
`&&(ae.tagName==="PRE"||ae.tagName==="TEXTAREA")&&(xi=xi.slice(1)),ae.textContent!==xi&&(ky(ae,0)||Gp(),ae.textContent=ge.children)}if(He){if(Pt||!ke||ri&48){const xi=ae.tagName.includes("-");for(const vi in He)(Pt&&(vi.endsWith("value")||vi==="indeterminate")||o_(vi)&&!em(vi)||vi[0]==="."||xi)&&_(ae,vi,null,He[vi],void 0,Oe)}else if(He.onClick)_(ae,"onClick",null,He.onClick,void 0,Oe);else if(ri&4&&Ul(He.style))for(const xi in He.style)He.style[xi]}let ci;(ci=He&&He.onVnodeBeforeMount)&&oa(ci,Oe,ge),dt&&Pc(ge,null,Oe,"beforeMount"),((ci=He&&He.onVnodeMounted)||dt||vt)&&OS(()=>{ci&&oa(ci,Oe,ge),vt&&kt.enter(ae),dt&&Pc(ge,null,Oe,"mounted")},ze)}return ae.nextSibling},ue=(ae,ge,Oe,ze,rt,ke,Ke)=>{Ke=Ke||!!ge.dynamicChildren;const He=ge.children,ri=He.length;for(let bt=0;bt<ri;bt++){const dt=Ke?He[bt]:He[bt]=aa(He[bt]),kt=dt.type===Ih;ae?(kt&&!Ke&&bt+1<ri&&aa(He[bt+1]).type===Ih&&(s(T(ae.data.slice(dt.children.length)),Oe,C(ae)),ae.data=dt.children),ae=J(ae,dt,ze,rt,ke,Ke)):kt&&!dt.children?s(dt.el=T(""),Oe):(ky(Oe,1)||Gp(),d(null,dt,Oe,null,ze,rt,Iy(Oe),ke))}return ae},we=(ae,ge,Oe,ze,rt,ke)=>{const{slotScopeIds:Ke}=ge;Ke&&(rt=rt?rt.concat(Ke):Ke);const He=P(ae),ri=ue(C(ae),ge,He,Oe,ze,rt,ke);return ri&&Yp(ri)&&ri.data==="]"?C(ge.anchor=ri):(Gp(),s(ge.anchor=$("]"),He,ri),ri)},Me=(ae,ge,Oe,ze,rt,ke)=>{if(ky(ae.parentElement,1)||Gp(),ge.el=null,ke){const ri=Ye(ae);for(;;){const bt=C(ae);if(bt&&bt!==ri)V(bt);else break}}const Ke=C(ae),He=P(ae);return V(ae),d(null,ge,He,Ke,Oe,ze,Iy(He),rt),Oe&&(Oe.vnode.el=ge.el,kx(Oe,ge.el)),Ke},Ye=(ae,ge="[",Oe="]")=>{let ze=0;for(;ae;)if(ae=C(ae),ae&&Yp(ae)&&(ae.data===ge&&ze++,ae.data===Oe)){if(ze===0)return C(ae);ze--}return ae},Ze=(ae,ge,Oe)=>{const ze=ge.parentNode;ze&&ze.replaceChild(ae,ge);let rt=Oe;for(;rt;)rt.vnode.el===ge&&(rt.vnode.el=rt.subTree.el=ae),rt=rt.parent},je=ae=>ae.nodeType===1&&ae.tagName==="TEMPLATE";return[Z,J]}const _w="data-allow-mismatch",bk={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function ky(t,l){if(l===0||l===1)for(;t&&!t.hasAttribute(_w);)t=t.parentElement;const d=t&&t.getAttribute(_w);if(d==null)return!1;if(d==="")return!0;{const _=d.split(",");return l===0&&_.includes("children")?!0:d.split(",").includes(bk[l])}}const wk=px().requestIdleCallback||(t=>setTimeout(t,1)),Tk=px().cancelIdleCallback||(t=>clearTimeout(t)),Ek=(t=1e4)=>l=>{const d=wk(l,{timeout:t});return()=>Tk(d)};function Sk(t){const{top:l,left:d,bottom:_,right:T}=t.getBoundingClientRect(),{innerHeight:C,innerWidth:P}=window;return(l>0&&l<C||_>0&&_<C)&&(d>0&&d<P||T>0&&T<P)}const Ck=t=>(l,d)=>{const _=new IntersectionObserver(T=>{for(const C of T)if(C.isIntersecting){_.disconnect(),l();break}},t);return d(T=>{if(T instanceof Element){if(Sk(T))return l(),_.disconnect(),!1;_.observe(T)}}),()=>_.disconnect()},Ak=t=>l=>{if(t){const d=matchMedia(t);if(d.matches)l();else return d.addEventListener("change",l,{once:!0}),()=>d.removeEventListener("change",l)}},Mk=(t=[])=>(l,d)=>{Rn(t)&&(t=[t]);let _=!1;const T=P=>{_||(_=!0,C(),l(),P.target.dispatchEvent(new P.constructor(P.type,P)))},C=()=>{d(P=>{for(const V of t)P.removeEventListener(V,T)})};return d(P=>{for(const V of t)P.addEventListener(V,T,{once:!0})}),C};function Ik(t,l){if(Yp(t)&&t.data==="["){let d=1,_=t.nextSibling;for(;_;){if(_.nodeType===1){if(l(_)===!1)break}else if(Yp(_))if(_.data==="]"){if(--d===0)break}else _.data==="["&&d++;_=_.nextSibling}}else l(t)}const Hu=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function kk(t){tr(t)&&(t={loader:t});const{loader:l,loadingComponent:d,errorComponent:_,delay:T=200,hydrate:C,timeout:P,suspensible:V=!0,onError:s}=t;let $=null,Z,J=0;const ne=()=>(J++,$=null,ue()),ue=()=>{let we;return $||(we=$=l().catch(Me=>{if(Me=Me instanceof Error?Me:new Error(String(Me)),s)return new Promise((Ye,Ze)=>{s(Me,()=>Ye(ne()),()=>Ze(Me),J+1)});throw Me}).then(Me=>we!==$&&$?$:(Me&&(Me.__esModule||Me[Symbol.toStringTag]==="Module")&&(Me=Me.default),Z=Me,Me)))};return zn({name:"AsyncComponentWrapper",__asyncLoader:ue,__asyncHydrate(we,Me,Ye){const Ze=C?()=>{const je=C(Ye,ae=>Ik(we,ae));je&&(Me.bum||(Me.bum=[])).push(je)}:Ye;Z?Ze():ue().then(()=>!Me.isUnmounted&&Ze())},get __asyncResolved(){return Z},setup(){const we=Is;if(Ab(we),Z)return()=>o0(Z,we);const Me=ae=>{$=null,zf(ae,we,13,!_)};if(V&&we.suspense||sm)return ue().then(ae=>()=>o0(ae,we)).catch(ae=>(Me(ae),()=>_?pr(_,{error:ae}):null));const Ye=Vi(!1),Ze=Vi(),je=Vi(!!T);return T&&setTimeout(()=>{je.value=!1},T),P!=null&&setTimeout(()=>{if(!Ye.value&&!Ze.value){const ae=new Error(`Async component timed out after ${P}ms.`);Me(ae),Ze.value=ae}},P),ue().then(()=>{Ye.value=!0,we.parent&&c_(we.parent.vnode)&&we.parent.update()}).catch(ae=>{Me(ae),Ze.value=ae}),()=>{if(Ye.value&&Z)return o0(Z,we);if(Ze.value&&_)return pr(_,{error:Ze.value});if(d&&!je.value)return pr(d)}}})}function o0(t,l){const{ref:d,props:_,children:T,ce:C}=l.vnode,P=pr(t,_,T);return P.ref=d,P.ce=C,delete l.vnode.ce,P}const c_=t=>t.type.__isKeepAlive,Pk={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:l}){const d=Ys(),_=d.ctx;if(!_.renderer)return()=>{const je=l.default&&l.default();return je&&je.length===1?je[0]:je};const T=new Map,C=new Set;let P=null;const V=d.suspense,{renderer:{p:s,m:$,um:Z,o:{createElement:J}}}=_,ne=J("div");_.activate=(je,ae,ge,Oe,ze)=>{const rt=je.component;$(je,ae,ge,0,V),s(rt.vnode,je,ae,ge,rt,V,Oe,je.slotScopeIds,ze),Ms(()=>{rt.isDeactivated=!1,rt.a&&tm(rt.a);const ke=je.props&&je.props.onVnodeMounted;ke&&oa(ke,rt.parent,je)},V)},_.deactivate=je=>{const ae=je.component;Jy(ae.m),Jy(ae.a),$(je,ne,null,1,V),Ms(()=>{ae.da&&tm(ae.da);const ge=je.props&&je.props.onVnodeUnmounted;ge&&oa(ge,ae.parent,je),ae.isDeactivated=!0},V)};function ue(je){a0(je),Z(je,d,V,!0)}function we(je){T.forEach((ae,ge)=>{const Oe=V0(ae.type);Oe&&!je(Oe)&&Me(ge)})}function Me(je){const ae=T.get(je);ae&&(!P||!Rl(ae,P))?ue(ae):P&&a0(P),T.delete(je),C.delete(je)}ha(()=>[t.include,t.exclude],([je,ae])=>{je&&we(ge=>Ig(je,ge)),ae&&we(ge=>!Ig(ae,ge))},{flush:"post",deep:!0});let Ye=null;const Ze=()=>{Ye!=null&&(Qy(d.subTree.type)?Ms(()=>{T.set(Ye,Py(d.subTree))},d.subTree.suspense):T.set(Ye,Py(d.subTree)))};return Oh(Ze),Cx(Ze),Ax(()=>{T.forEach(je=>{const{subTree:ae,suspense:ge}=d,Oe=Py(ae);if(je.type===Oe.type&&je.key===Oe.key){a0(Oe);const ze=Oe.component.da;ze&&Ms(ze,ge);return}ue(je)})}),()=>{if(Ye=null,!l.default)return P=null;const je=l.default(),ae=je[0];if(je.length>1)return P=null,je;if(!Lh(ae)||!(ae.shapeFlag&4)&&!(ae.shapeFlag&128))return P=null,ae;let ge=Py(ae);if(ge.type===Ts)return P=null,ge;const Oe=ge.type,ze=V0(Hu(ge)?ge.type.__asyncResolved||{}:Oe),{include:rt,exclude:ke,max:Ke}=t;if(rt&&(!ze||!Ig(rt,ze))||ke&&ze&&Ig(ke,ze))return ge.shapeFlag&=-257,P=ge,ae;const He=ge.key==null?Oe:ge.key,ri=T.get(He);return ge.el&&(ge=Rc(ge),ae.shapeFlag&128&&(ae.ssContent=ge)),Ye=He,ri?(ge.el=ri.el,ge.component=ri.component,ge.transition&&Ph(ge,ge.transition),ge.shapeFlag|=512,C.delete(He),C.add(He)):(C.add(He),Ke&&C.size>parseInt(Ke,10)&&Me(C.values().next().value)),ge.shapeFlag|=256,P=ge,Qy(ae.type)?ae:ge}}},Lk=Pk;function Ig(t,l){return Ri(t)?t.some(d=>Ig(d,l)):Rn(t)?t.split(",").includes(l):lI(t)?(t.lastIndex=0,t.test(l)):!1}function QE(t,l){tS(t,"a",l)}function eS(t,l){tS(t,"da",l)}function tS(t,l,d=Is){const _=t.__wdc||(t.__wdc=()=>{let T=d;for(;T;){if(T.isDeactivated)return;T=T.parent}return t()});if(Sx(l,_,d),d){let T=d.parent;for(;T&&T.parent;)c_(T.parent.vnode)&&Dk(_,l,d,T),T=T.parent}}function Dk(t,l,d,_){const T=Sx(l,t,_,!0);h_(()=>{fb(_[l],T)},d)}function a0(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Py(t){return t.shapeFlag&128?t.ssContent:t}function Sx(t,l,d=Is,_=!1){if(d){const T=d[t]||(d[t]=[]),C=l.__weh||(l.__weh=(...P)=>{Ku();const V=Df(d),s=al(l,d,t,P);return V(),Ju(),s});return _?T.unshift(C):T.push(C),C}}const Dh=t=>(l,d=Is)=>{(!sm||t==="sp")&&Sx(t,(..._)=>l(..._),d)},Mb=Dh("bm"),Oh=Dh("m"),Ib=Dh("bu"),Cx=Dh("u"),Ax=Dh("bum"),h_=Dh("um"),iS=Dh("sp"),rS=Dh("rtg"),nS=Dh("rtc");function sS(t,l=Is){Sx("ec",t,l)}const kb="components",Ok="directives";function Mh(t,l){return Pb(kb,t,!0,l)||t}const oS=Symbol.for("v-ndc");function Mx(t){return Rn(t)?Pb(kb,t,!1)||t:t||oS}function Rk(t){return Pb(Ok,t)}function Pb(t,l,d=!0,_=!1){const T=ks||Is;if(T){const C=T.type;if(t===kb){const V=V0(C,!1);if(V&&(V===l||V===Xs(l)||V===a_(Xs(l))))return C}const P=yw(T[t]||C[t],l)||yw(T.appContext[t],l);return!P&&_?C:P}}function yw(t,l){return t&&(t[l]||t[Xs(l)]||t[a_(Xs(l))])}function Ba(t,l,d,_){let T;const C=d&&d[_],P=Ri(t);if(P||Rn(t)){const V=P&&Ul(t);let s=!1;V&&(s=!Fa(t),t=yx(t)),T=new Array(t.length);for(let $=0,Z=t.length;$<Z;$++)T[$]=l(s?mo(t[$]):t[$],$,void 0,C&&C[$])}else if(typeof t=="number"){T=new Array(t);for(let V=0;V<t;V++)T[V]=l(V+1,V,void 0,C&&C[V])}else if(yn(t))if(t[Symbol.iterator])T=Array.from(t,(V,s)=>l(V,s,void 0,C&&C[s]));else{const V=Object.keys(t);T=new Array(V.length);for(let s=0,$=V.length;s<$;s++){const Z=V[s];T[s]=l(t[Z],Z,s,C&&C[s])}}else T=[];return d&&(d[_]=T),T}function zk(t,l){for(let d=0;d<l.length;d++){const _=l[d];if(Ri(_))for(let T=0;T<_.length;T++)t[_[T].name]=_[T].fn;else _&&(t[_.name]=_.key?(...T)=>{const C=_.fn(...T);return C&&(C.key=_.key),C}:_.fn)}return t}function aS(t,l,d={},_,T){if(ks.ce||ks.parent&&Hu(ks.parent)&&ks.parent.ce)return l!=="default"&&(d.name=l),_i(),No($r,null,[pr("slot",d,_&&_())],64);let C=t[l];C&&C._c&&(C._d=!1),_i();const P=C&&Lb(C(d)),V=d.key||P&&P.key,s=No($r,{key:(V&&!Vl(V)?V:`_${l}`)+(!P&&_?"_fb":"")},P||(_?_():[]),P&&t._===1?64:-2);return!T&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),C&&C._c&&(C._d=!0),s}function Lb(t){return t.some(l=>Lh(l)?!(l.type===Ts||l.type===$r&&!Lb(l.children)):!0)?t:null}function lS(t,l){const d={};for(const _ in t)d[l&&/[A-Z]/.test(_)?`on:${_}`:Pg(_)]=t[_];return d}const k0=t=>t?US(t)?f_(t):k0(t.parent):null,Rg=Sn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>k0(t.parent),$root:t=>k0(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Db(t),$forceUpdate:t=>t.f||(t.f=()=>{Eb(t.update)}),$nextTick:t=>t.n||(t.n=Bf.bind(t.proxy)),$watch:t=>fP.bind(t)}),l0=(t,l)=>t!==Nr&&!t.__isScriptSetup&&rn(t,l),P0={get({_:t},l){if(l==="__v_skip")return!0;const{ctx:d,setupState:_,data:T,props:C,accessCache:P,type:V,appContext:s}=t;let $;if(l[0]!=="$"){const ue=P[l];if(ue!==void 0)switch(ue){case 1:return _[l];case 2:return T[l];case 4:return d[l];case 3:return C[l]}else{if(l0(_,l))return P[l]=1,_[l];if(T!==Nr&&rn(T,l))return P[l]=2,T[l];if(($=t.propsOptions[0])&&rn($,l))return P[l]=3,C[l];if(d!==Nr&&rn(d,l))return P[l]=4,d[l];L0&&(P[l]=0)}}const Z=Rg[l];let J,ne;if(Z)return l==="$attrs"&&po(t.attrs,"get",""),Z(t);if((J=V.__cssModules)&&(J=J[l]))return J;if(d!==Nr&&rn(d,l))return P[l]=4,d[l];if(ne=s.config.globalProperties,rn(ne,l))return ne[l]},set({_:t},l,d){const{data:_,setupState:T,ctx:C}=t;return l0(T,l)?(T[l]=d,!0):_!==Nr&&rn(_,l)?(_[l]=d,!0):rn(t.props,l)||l[0]==="$"&&l.slice(1)in t?!1:(C[l]=d,!0)},has({_:{data:t,setupState:l,accessCache:d,ctx:_,appContext:T,propsOptions:C}},P){let V;return!!d[P]||t!==Nr&&rn(t,P)||l0(l,P)||(V=C[0])&&rn(V,P)||rn(_,P)||rn(Rg,P)||rn(T.config.globalProperties,P)},defineProperty(t,l,d){return d.get!=null?t._.accessCache[l]=0:rn(d,"value")&&this.set(t,l,d.value,null),Reflect.defineProperty(t,l,d)}},Bk=Sn({},P0,{get(t,l){if(l!==Symbol.unscopables)return P0.get(t,l,t)},has(t,l){return l[0]!=="_"&&!fI(l)}});function Fk(){return null}function Nk(){return null}function Uk(t){}function Vk(t){}function jk(){return null}function $k(){}function Gk(t,l){return null}function Wk(){return cS().slots}function Hk(){return cS().attrs}function cS(){const t=Ys();return t.setupContext||(t.setupContext=$S(t))}function Zg(t){return Ri(t)?t.reduce((l,d)=>(l[d]=null,l),{}):t}function qk(t,l){const d=Zg(t);for(const _ in l){if(_.startsWith("__skip"))continue;let T=d[_];T?Ri(T)||tr(T)?T=d[_]={type:T,default:l[_]}:T.default=l[_]:T===null&&(T=d[_]={default:l[_]}),T&&l[`__skip_${_}`]&&(T.skipFactory=!0)}return d}function Xk(t,l){return!t||!l?t||l:Ri(t)&&Ri(l)?t.concat(l):Sn({},Zg(t),Zg(l))}function Zk(t,l){const d={};for(const _ in t)l.includes(_)||Object.defineProperty(d,_,{enumerable:!0,get:()=>t[_]});return d}function Yk(t){const l=Ys();let d=t();return F0(),pb(d)&&(d=d.catch(_=>{throw Df(l),_})),[d,()=>Df(l)]}let L0=!0;function Kk(t){const l=Db(t),d=t.proxy,_=t.ctx;L0=!1,l.beforeCreate&&xw(l.beforeCreate,t,"bc");const{data:T,computed:C,methods:P,watch:V,provide:s,inject:$,created:Z,beforeMount:J,mounted:ne,beforeUpdate:ue,updated:we,activated:Me,deactivated:Ye,beforeDestroy:Ze,beforeUnmount:je,destroyed:ae,unmounted:ge,render:Oe,renderTracked:ze,renderTriggered:rt,errorCaptured:ke,serverPrefetch:Ke,expose:He,inheritAttrs:ri,components:bt,directives:dt,filters:kt}=l;if($&&Jk($,_,null),P)for(const ci in P){const xi=P[ci];tr(xi)&&(_[ci]=xi.bind(d))}if(T){const ci=T.call(d,d);yn(ci)&&(t.data=fm(ci))}if(L0=!0,C)for(const ci in C){const xi=C[ci],vi=tr(xi)?xi.bind(d,d):tr(xi.get)?xi.get.bind(d,d):sl,Lr=!tr(xi)&&tr(xi.set)?xi.set.bind(d):sl,ir=fn({get:vi,set:Lr});Object.defineProperty(_,ci,{enumerable:!0,configurable:!0,get:()=>ir.value,set:sr=>ir.value=sr})}if(V)for(const ci in V)hS(V[ci],_,d,ci);if(s){const ci=tr(s)?s.call(d):s;Reflect.ownKeys(ci).forEach(xi=>{zg(xi,ci[xi])})}Z&&xw(Z,t,"c");function vt(ci,xi){Ri(xi)?xi.forEach(vi=>ci(vi.bind(d))):xi&&ci(xi.bind(d))}if(vt(Mb,J),vt(Oh,ne),vt(Ib,ue),vt(Cx,we),vt(QE,Me),vt(eS,Ye),vt(sS,ke),vt(nS,ze),vt(rS,rt),vt(Ax,je),vt(h_,ge),vt(iS,Ke),Ri(He))if(He.length){const ci=t.exposed||(t.exposed={});He.forEach(xi=>{Object.defineProperty(ci,xi,{get:()=>d[xi],set:vi=>d[xi]=vi})})}else t.exposed||(t.exposed={});Oe&&t.render===sl&&(t.render=Oe),ri!=null&&(t.inheritAttrs=ri),bt&&(t.components=bt),dt&&(t.directives=dt),Ke&&Ab(t)}function Jk(t,l,d=sl){Ri(t)&&(t=D0(t));for(const _ in t){const T=t[_];let C;yn(T)?"default"in T?C=ca(T.from||_,T.default,!0):C=ca(T.from||_):C=ca(T),On(C)?Object.defineProperty(l,_,{enumerable:!0,configurable:!0,get:()=>C.value,set:P=>C.value=P}):l[_]=C}}function xw(t,l,d){al(Ri(t)?t.map(_=>_.bind(l.proxy)):t.bind(l.proxy),l,d)}function hS(t,l,d,_){let T=_.includes(".")?kS(d,_):()=>d[_];if(Rn(t)){const C=l[t];tr(C)&&ha(T,C)}else if(tr(t))ha(T,t.bind(d));else if(yn(t))if(Ri(t))t.forEach(C=>hS(C,l,d,_));else{const C=tr(t.handler)?t.handler.bind(d):l[t.handler];tr(C)&&ha(T,C,t)}}function Db(t){const l=t.type,{mixins:d,extends:_}=l,{mixins:T,optionsCache:C,config:{optionMergeStrategies:P}}=t.appContext,V=C.get(l);let s;return V?s=V:!T.length&&!d&&!_?s=l:(s={},T.length&&T.forEach($=>Ky(s,$,P,!0)),Ky(s,l,P)),yn(l)&&C.set(l,s),s}function Ky(t,l,d,_=!1){const{mixins:T,extends:C}=l;C&&Ky(t,C,d,!0),T&&T.forEach(P=>Ky(t,P,d,!0));for(const P in l)if(!(_&&P==="expose")){const V=Qk[P]||d&&d[P];t[P]=V?V(t[P],l[P]):l[P]}return t}const Qk={data:vw,props:bw,emits:bw,methods:kg,computed:kg,beforeCreate:Oo,created:Oo,beforeMount:Oo,mounted:Oo,beforeUpdate:Oo,updated:Oo,beforeDestroy:Oo,beforeUnmount:Oo,destroyed:Oo,unmounted:Oo,activated:Oo,deactivated:Oo,errorCaptured:Oo,serverPrefetch:Oo,components:kg,directives:kg,watch:tP,provide:vw,inject:eP};function vw(t,l){return l?t?function(){return Sn(tr(t)?t.call(this,this):t,tr(l)?l.call(this,this):l)}:l:t}function eP(t,l){return kg(D0(t),D0(l))}function D0(t){if(Ri(t)){const l={};for(let d=0;d<t.length;d++)l[t[d]]=t[d];return l}return t}function Oo(t,l){return t?[...new Set([].concat(t,l))]:l}function kg(t,l){return t?Sn(Object.create(null),t,l):l}function bw(t,l){return t?Ri(t)&&Ri(l)?[...new Set([...t,...l])]:Sn(Object.create(null),Zg(t),Zg(l??{})):l}function tP(t,l){if(!t)return l;if(!l)return t;const d=Sn(Object.create(null),t);for(const _ in l)d[_]=Oo(t[_],l[_]);return d}function uS(){return{app:null,config:{isNativeTag:oI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let iP=0;function rP(t,l){return function(_,T=null){tr(_)||(_=Sn({},_)),T!=null&&!yn(T)&&(T=null);const C=uS(),P=new WeakSet,V=[];let s=!1;const $=C.app={_uid:iP++,_component:_,_props:T,_container:null,_context:C,_instance:null,version:WS,get config(){return C.config},set config(Z){},use(Z,...J){return P.has(Z)||(Z&&tr(Z.install)?(P.add(Z),Z.install($,...J)):tr(Z)&&(P.add(Z),Z($,...J))),$},mixin(Z){return C.mixins.includes(Z)||C.mixins.push(Z),$},component(Z,J){return J?(C.components[Z]=J,$):C.components[Z]},directive(Z,J){return J?(C.directives[Z]=J,$):C.directives[Z]},mount(Z,J,ne){if(!s){const ue=$._ceVNode||pr(_,T);return ue.appContext=C,ne===!0?ne="svg":ne===!1&&(ne=void 0),J&&l?l(ue,Z):t(ue,Z,ne),s=!0,$._container=Z,Z.__vue_app__=$,f_(ue.component)}},onUnmount(Z){V.push(Z)},unmount(){s&&(al(V,$._instance,16),t(null,$._container),delete $._container.__vue_app__)},provide(Z,J){return C.provides[Z]=J,$},runWithContext(Z){const J=If;If=$;try{return Z()}finally{If=J}}};return $}}let If=null;function zg(t,l){if(Is){let d=Is.provides;const _=Is.parent&&Is.parent.provides;_===d&&(d=Is.provides=Object.create(_)),d[t]=l}}function ca(t,l,d=!1){const _=Is||ks;if(_||If){const T=If?If._context.provides:_?_.parent==null?_.vnode.appContext&&_.vnode.appContext.provides:_.parent.provides:void 0;if(T&&t in T)return T[t];if(arguments.length>1)return d&&tr(l)?l.call(_&&_.proxy):l}}function dS(){return!!(Is||ks||If)}const fS={},pS=()=>Object.create(fS),mS=t=>Object.getPrototypeOf(t)===fS;function nP(t,l,d,_=!1){const T={},C=pS();t.propsDefaults=Object.create(null),gS(t,l,T,C);for(const P in t.propsOptions[0])P in T||(T[P]=void 0);d?t.props=_?T:bb(T):t.type.props?t.props=T:t.props=C,t.attrs=C}function sP(t,l,d,_){const{props:T,attrs:C,vnode:{patchFlag:P}}=t,V=kr(T),[s]=t.propsOptions;let $=!1;if((_||P>0)&&!(P&16)){if(P&8){const Z=t.vnode.dynamicProps;for(let J=0;J<Z.length;J++){let ne=Z[J];if(Ix(t.emitsOptions,ne))continue;const ue=l[ne];if(s)if(rn(C,ne))ue!==C[ne]&&(C[ne]=ue,$=!0);else{const we=Xs(ne);T[we]=O0(s,V,we,ue,t,!1)}else ue!==C[ne]&&(C[ne]=ue,$=!0)}}}else{gS(t,l,T,C)&&($=!0);let Z;for(const J in V)(!l||!rn(l,J)&&((Z=la(J))===J||!rn(l,Z)))&&(s?d&&(d[J]!==void 0||d[Z]!==void 0)&&(T[J]=O0(s,V,J,void 0,t,!0)):delete T[J]);if(C!==V)for(const J in C)(!l||!rn(l,J))&&(delete C[J],$=!0)}$&&Th(t.attrs,"set","")}function gS(t,l,d,_){const[T,C]=t.propsOptions;let P=!1,V;if(l)for(let s in l){if(em(s))continue;const $=l[s];let Z;T&&rn(T,Z=Xs(s))?!C||!C.includes(Z)?d[Z]=$:(V||(V={}))[Z]=$:Ix(t.emitsOptions,s)||(!(s in _)||$!==_[s])&&(_[s]=$,P=!0)}if(C){const s=kr(d),$=V||Nr;for(let Z=0;Z<C.length;Z++){const J=C[Z];d[J]=O0(T,s,J,$[J],t,!rn($,J))}}return P}function O0(t,l,d,_,T,C){const P=t[d];if(P!=null){const V=rn(P,"default");if(V&&_===void 0){const s=P.default;if(P.type!==Function&&!P.skipFactory&&tr(s)){const{propsDefaults:$}=T;if(d in $)_=$[d];else{const Z=Df(T);_=$[d]=s.call(null,l),Z()}}else _=s;T.ce&&T.ce._setProp(d,_)}P[0]&&(C&&!V?_=!1:P[1]&&(_===""||_===la(d))&&(_=!0))}return _}const oP=new WeakMap;function _S(t,l,d=!1){const _=d?oP:l.propsCache,T=_.get(t);if(T)return T;const C=t.props,P={},V=[];let s=!1;if(!tr(t)){const Z=J=>{s=!0;const[ne,ue]=_S(J,l,!0);Sn(P,ne),ue&&V.push(...ue)};!d&&l.mixins.length&&l.mixins.forEach(Z),t.extends&&Z(t.extends),t.mixins&&t.mixins.forEach(Z)}if(!C&&!s)return yn(t)&&_.set(t,Jp),Jp;if(Ri(C))for(let Z=0;Z<C.length;Z++){const J=Xs(C[Z]);ww(J)&&(P[J]=Nr)}else if(C)for(const Z in C){const J=Xs(Z);if(ww(J)){const ne=C[Z],ue=P[J]=Ri(ne)||tr(ne)?{type:ne}:Sn({},ne),we=ue.type;let Me=!1,Ye=!0;if(Ri(we))for(let Ze=0;Ze<we.length;++Ze){const je=we[Ze],ae=tr(je)&&je.name;if(ae==="Boolean"){Me=!0;break}else ae==="String"&&(Ye=!1)}else Me=tr(we)&&we.name==="Boolean";ue[0]=Me,ue[1]=Ye,(Me||rn(ue,"default"))&&V.push(J)}}const $=[P,V];return yn(t)&&_.set(t,$),$}function ww(t){return t[0]!=="$"&&!em(t)}const yS=t=>t[0]==="_"||t==="$stable",Ob=t=>Ri(t)?t.map(aa):[aa(t)],aP=(t,l,d)=>{if(l._n)return l;const _=Us((...T)=>Ob(l(...T)),d);return _._c=!1,_},xS=(t,l,d)=>{const _=t._ctx;for(const T in t){if(yS(T))continue;const C=t[T];if(tr(C))l[T]=aP(T,C,_);else if(C!=null){const P=Ob(C);l[T]=()=>P}}},vS=(t,l)=>{const d=Ob(l);t.slots.default=()=>d},bS=(t,l,d)=>{for(const _ in l)(d||_!=="_")&&(t[_]=l[_])},lP=(t,l,d)=>{const _=t.slots=pS();if(t.vnode.shapeFlag&32){const T=l._;T?(bS(_,l,d),d&&pE(_,"_",T,!0)):xS(l,_)}else l&&vS(t,l)},cP=(t,l,d)=>{const{vnode:_,slots:T}=t;let C=!0,P=Nr;if(_.shapeFlag&32){const V=l._;V?d&&V===1?C=!1:bS(T,l,d):(C=!l.$stable,xS(l,T)),P=l}else l&&(vS(t,l),P={default:1});if(C)for(const V in T)!yS(V)&&P[V]==null&&delete T[V]},Ms=OS;function wS(t){return ES(t)}function TS(t){return ES(t,vk)}function ES(t,l){const d=px();d.__VUE__=!0;const{insert:_,remove:T,patchProp:C,createElement:P,createText:V,createComment:s,setText:$,setElementText:Z,parentNode:J,nextSibling:ne,setScopeId:ue=sl,insertStaticContent:we}=t,Me=(xe,ve,nt,Lt=null,At=null,Yt=null,oi=void 0,Te=null,Ae=!!ve.dynamicChildren)=>{if(xe===ve)return;xe&&!Rl(xe,ve)&&(Lt=zt(xe),sr(xe,At,Yt,!0),xe=null),ve.patchFlag===-2&&(Ae=!1,ve.dynamicChildren=null);const{type:Qe,ref:Wt,shapeFlag:Ht}=ve;switch(Qe){case Ih:Ye(xe,ve,nt,Lt);break;case Ts:Ze(xe,ve,nt,Lt);break;case kf:xe==null&&je(ve,nt,Lt,oi);break;case $r:bt(xe,ve,nt,Lt,At,Yt,oi,Te,Ae);break;default:Ht&1?Oe(xe,ve,nt,Lt,At,Yt,oi,Te,Ae):Ht&6?dt(xe,ve,nt,Lt,At,Yt,oi,Te,Ae):(Ht&64||Ht&128)&&Qe.process(xe,ve,nt,Lt,At,Yt,oi,Te,Ae,Ei)}Wt!=null&&At&&Xg(Wt,xe&&xe.ref,Yt,ve||xe,!ve)},Ye=(xe,ve,nt,Lt)=>{if(xe==null)_(ve.el=V(ve.children),nt,Lt);else{const At=ve.el=xe.el;ve.children!==xe.children&&$(At,ve.children)}},Ze=(xe,ve,nt,Lt)=>{xe==null?_(ve.el=s(ve.children||""),nt,Lt):ve.el=xe.el},je=(xe,ve,nt,Lt)=>{[xe.el,xe.anchor]=we(xe.children,ve,nt,Lt,xe.el,xe.anchor)},ae=({el:xe,anchor:ve},nt,Lt)=>{let At;for(;xe&&xe!==ve;)At=ne(xe),_(xe,nt,Lt),xe=At;_(ve,nt,Lt)},ge=({el:xe,anchor:ve})=>{let nt;for(;xe&&xe!==ve;)nt=ne(xe),T(xe),xe=nt;T(ve)},Oe=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae)=>{ve.type==="svg"?oi="svg":ve.type==="math"&&(oi="mathml"),xe==null?ze(ve,nt,Lt,At,Yt,oi,Te,Ae):Ke(xe,ve,At,Yt,oi,Te,Ae)},ze=(xe,ve,nt,Lt,At,Yt,oi,Te)=>{let Ae,Qe;const{props:Wt,shapeFlag:Ht,transition:Kt,dirs:ut}=xe;if(Ae=xe.el=P(xe.type,Yt,Wt&&Wt.is,Wt),Ht&8?Z(Ae,xe.children):Ht&16&&ke(xe.children,Ae,null,Lt,At,c0(xe,Yt),oi,Te),ut&&Pc(xe,null,Lt,"created"),rt(Ae,xe,xe.scopeId,oi,Lt),Wt){for(const Ii in Wt)Ii!=="value"&&!em(Ii)&&C(Ae,Ii,null,Wt[Ii],Yt,Lt);"value"in Wt&&C(Ae,"value",null,Wt.value,Yt),(Qe=Wt.onVnodeBeforeMount)&&oa(Qe,Lt,xe)}ut&&Pc(xe,null,Lt,"beforeMount");const It=SS(At,Kt);It&&Kt.beforeEnter(Ae),_(Ae,ve,nt),((Qe=Wt&&Wt.onVnodeMounted)||It||ut)&&Ms(()=>{Qe&&oa(Qe,Lt,xe),It&&Kt.enter(Ae),ut&&Pc(xe,null,Lt,"mounted")},At)},rt=(xe,ve,nt,Lt,At)=>{if(nt&&ue(xe,nt),Lt)for(let Yt=0;Yt<Lt.length;Yt++)ue(xe,Lt[Yt]);if(At){let Yt=At.subTree;if(ve===Yt||Qy(Yt.type)&&(Yt.ssContent===ve||Yt.ssFallback===ve)){const oi=At.vnode;rt(xe,oi,oi.scopeId,oi.slotScopeIds,At.parent)}}},ke=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae=0)=>{for(let Qe=Ae;Qe<xe.length;Qe++){const Wt=xe[Qe]=Te?Gu(xe[Qe]):aa(xe[Qe]);Me(null,Wt,ve,nt,Lt,At,Yt,oi,Te)}},Ke=(xe,ve,nt,Lt,At,Yt,oi)=>{const Te=ve.el=xe.el;let{patchFlag:Ae,dynamicChildren:Qe,dirs:Wt}=ve;Ae|=xe.patchFlag&16;const Ht=xe.props||Nr,Kt=ve.props||Nr;let ut;if(nt&&wf(nt,!1),(ut=Kt.onVnodeBeforeUpdate)&&oa(ut,nt,ve,xe),Wt&&Pc(ve,xe,nt,"beforeUpdate"),nt&&wf(nt,!0),(Ht.innerHTML&&Kt.innerHTML==null||Ht.textContent&&Kt.textContent==null)&&Z(Te,""),Qe?He(xe.dynamicChildren,Qe,Te,nt,Lt,c0(ve,At),Yt):oi||xi(xe,ve,Te,null,nt,Lt,c0(ve,At),Yt,!1),Ae>0){if(Ae&16)ri(Te,Ht,Kt,nt,At);else if(Ae&2&&Ht.class!==Kt.class&&C(Te,"class",null,Kt.class,At),Ae&4&&C(Te,"style",Ht.style,Kt.style,At),Ae&8){const It=ve.dynamicProps;for(let Ii=0;Ii<It.length;Ii++){const Oi=It[Ii],Gr=Ht[Oi],Ur=Kt[Oi];(Ur!==Gr||Oi==="value")&&C(Te,Oi,Gr,Ur,At,nt)}}Ae&1&&xe.children!==ve.children&&Z(Te,ve.children)}else!oi&&Qe==null&&ri(Te,Ht,Kt,nt,At);((ut=Kt.onVnodeUpdated)||Wt)&&Ms(()=>{ut&&oa(ut,nt,ve,xe),Wt&&Pc(ve,xe,nt,"updated")},Lt)},He=(xe,ve,nt,Lt,At,Yt,oi)=>{for(let Te=0;Te<ve.length;Te++){const Ae=xe[Te],Qe=ve[Te],Wt=Ae.el&&(Ae.type===$r||!Rl(Ae,Qe)||Ae.shapeFlag&70)?J(Ae.el):nt;Me(Ae,Qe,Wt,null,Lt,At,Yt,oi,!0)}},ri=(xe,ve,nt,Lt,At)=>{if(ve!==nt){if(ve!==Nr)for(const Yt in ve)!em(Yt)&&!(Yt in nt)&&C(xe,Yt,ve[Yt],null,At,Lt);for(const Yt in nt){if(em(Yt))continue;const oi=nt[Yt],Te=ve[Yt];oi!==Te&&Yt!=="value"&&C(xe,Yt,Te,oi,At,Lt)}"value"in nt&&C(xe,"value",ve.value,nt.value,At)}},bt=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae)=>{const Qe=ve.el=xe?xe.el:V(""),Wt=ve.anchor=xe?xe.anchor:V("");let{patchFlag:Ht,dynamicChildren:Kt,slotScopeIds:ut}=ve;ut&&(Te=Te?Te.concat(ut):ut),xe==null?(_(Qe,nt,Lt),_(Wt,nt,Lt),ke(ve.children||[],nt,Wt,At,Yt,oi,Te,Ae)):Ht>0&&Ht&64&&Kt&&xe.dynamicChildren?(He(xe.dynamicChildren,Kt,nt,At,Yt,oi,Te),(ve.key!=null||At&&ve===At.subTree)&&Rb(xe,ve,!0)):xi(xe,ve,nt,Wt,At,Yt,oi,Te,Ae)},dt=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae)=>{ve.slotScopeIds=Te,xe==null?ve.shapeFlag&512?At.ctx.activate(ve,nt,Lt,oi,Ae):kt(ve,nt,Lt,At,Yt,oi,Ae):Pt(xe,ve,Ae)},kt=(xe,ve,nt,Lt,At,Yt,oi)=>{const Te=xe.component=NS(xe,Lt,At);if(c_(xe)&&(Te.ctx.renderer=Ei),VS(Te,!1,oi),Te.asyncDep){if(At&&At.registerDep(Te,vt,oi),!xe.el){const Ae=Te.subTree=pr(Ts);Ze(null,Ae,ve,nt)}}else vt(Te,xe,ve,nt,At,Yt,oi)},Pt=(xe,ve,nt)=>{const Lt=ve.component=xe.component;if(xP(xe,ve,nt))if(Lt.asyncDep&&!Lt.asyncResolved){ci(Lt,ve,nt);return}else Lt.next=ve,Lt.update();else ve.el=xe.el,Lt.vnode=ve},vt=(xe,ve,nt,Lt,At,Yt,oi)=>{const Te=()=>{if(xe.isMounted){let{next:Ht,bu:Kt,u:ut,parent:It,vnode:Ii}=xe;{const cr=CS(xe);if(cr){Ht&&(Ht.el=Ii.el,ci(xe,Ht,oi)),cr.asyncDep.then(()=>{xe.isUnmounted||Te()});return}}let Oi=Ht,Gr;wf(xe,!1),Ht?(Ht.el=Ii.el,ci(xe,Ht,oi)):Ht=Ii,Kt&&tm(Kt),(Gr=Ht.props&&Ht.props.onVnodeBeforeUpdate)&&oa(Gr,It,Ht,Ii),wf(xe,!0);const Ur=zy(xe),un=xe.subTree;xe.subTree=Ur,Me(un,Ur,J(un.el),zt(un),xe,At,Yt),Ht.el=Ur.el,Oi===null&&kx(xe,Ur.el),ut&&Ms(ut,At),(Gr=Ht.props&&Ht.props.onVnodeUpdated)&&Ms(()=>oa(Gr,It,Ht,Ii),At)}else{let Ht;const{el:Kt,props:ut}=ve,{bm:It,m:Ii,parent:Oi,root:Gr,type:Ur}=xe,un=Hu(ve);if(wf(xe,!1),It&&tm(It),!un&&(Ht=ut&&ut.onVnodeBeforeMount)&&oa(Ht,Oi,ve),wf(xe,!0),Kt&&Si){const cr=()=>{xe.subTree=zy(xe),Si(Kt,xe.subTree,xe,At,null)};un&&Ur.__asyncHydrate?Ur.__asyncHydrate(Kt,xe,cr):cr()}else{Gr.ce&&Gr.ce._injectChildStyle(Ur);const cr=xe.subTree=zy(xe);Me(null,cr,nt,Lt,xe,At,Yt),ve.el=cr.el}if(Ii&&Ms(Ii,At),!un&&(Ht=ut&&ut.onVnodeMounted)){const cr=ve;Ms(()=>oa(Ht,Oi,cr),At)}(ve.shapeFlag&256||Oi&&Hu(Oi.vnode)&&Oi.vnode.shapeFlag&256)&&xe.a&&Ms(xe.a,At),xe.isMounted=!0,ve=nt=Lt=null}};xe.scope.on();const Ae=xe.effect=new jg(Te);xe.scope.off();const Qe=xe.update=Ae.run.bind(Ae),Wt=xe.job=Ae.runIfDirty.bind(Ae);Wt.i=xe,Wt.id=xe.uid,Ae.scheduler=()=>Eb(Wt),wf(xe,!0),Qe()},ci=(xe,ve,nt)=>{ve.component=xe;const Lt=xe.vnode.props;xe.vnode=ve,xe.next=null,sP(xe,ve.props,Lt,nt),cP(xe,ve.children,nt),Ku(),uw(xe),Ju()},xi=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae=!1)=>{const Qe=xe&&xe.children,Wt=xe?xe.shapeFlag:0,Ht=ve.children,{patchFlag:Kt,shapeFlag:ut}=ve;if(Kt>0){if(Kt&128){Lr(Qe,Ht,nt,Lt,At,Yt,oi,Te,Ae);return}else if(Kt&256){vi(Qe,Ht,nt,Lt,At,Yt,oi,Te,Ae);return}}ut&8?(Wt&16&&sn(Qe,At,Yt),Ht!==Qe&&Z(nt,Ht)):Wt&16?ut&16?Lr(Qe,Ht,nt,Lt,At,Yt,oi,Te,Ae):sn(Qe,At,Yt,!0):(Wt&8&&Z(nt,""),ut&16&&ke(Ht,nt,Lt,At,Yt,oi,Te,Ae))},vi=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae)=>{xe=xe||Jp,ve=ve||Jp;const Qe=xe.length,Wt=ve.length,Ht=Math.min(Qe,Wt);let Kt;for(Kt=0;Kt<Ht;Kt++){const ut=ve[Kt]=Ae?Gu(ve[Kt]):aa(ve[Kt]);Me(xe[Kt],ut,nt,null,At,Yt,oi,Te,Ae)}Qe>Wt?sn(xe,At,Yt,!0,!1,Ht):ke(ve,nt,Lt,At,Yt,oi,Te,Ae,Ht)},Lr=(xe,ve,nt,Lt,At,Yt,oi,Te,Ae)=>{let Qe=0;const Wt=ve.length;let Ht=xe.length-1,Kt=Wt-1;for(;Qe<=Ht&&Qe<=Kt;){const ut=xe[Qe],It=ve[Qe]=Ae?Gu(ve[Qe]):aa(ve[Qe]);if(Rl(ut,It))Me(ut,It,nt,null,At,Yt,oi,Te,Ae);else break;Qe++}for(;Qe<=Ht&&Qe<=Kt;){const ut=xe[Ht],It=ve[Kt]=Ae?Gu(ve[Kt]):aa(ve[Kt]);if(Rl(ut,It))Me(ut,It,nt,null,At,Yt,oi,Te,Ae);else break;Ht--,Kt--}if(Qe>Ht){if(Qe<=Kt){const ut=Kt+1,It=ut<Wt?ve[ut].el:Lt;for(;Qe<=Kt;)Me(null,ve[Qe]=Ae?Gu(ve[Qe]):aa(ve[Qe]),nt,It,At,Yt,oi,Te,Ae),Qe++}}else if(Qe>Kt)for(;Qe<=Ht;)sr(xe[Qe],At,Yt,!0),Qe++;else{const ut=Qe,It=Qe,Ii=new Map;for(Qe=It;Qe<=Kt;Qe++){const Fn=ve[Qe]=Ae?Gu(ve[Qe]):aa(ve[Qe]);Fn.key!=null&&Ii.set(Fn.key,Qe)}let Oi,Gr=0;const Ur=Kt-It+1;let un=!1,cr=0;const us=new Array(Ur);for(Qe=0;Qe<Ur;Qe++)us[Qe]=0;for(Qe=ut;Qe<=Ht;Qe++){const Fn=xe[Qe];if(Gr>=Ur){sr(Fn,At,Yt,!0);continue}let Qn;if(Fn.key!=null)Qn=Ii.get(Fn.key);else for(Oi=It;Oi<=Kt;Oi++)if(us[Oi-It]===0&&Rl(Fn,ve[Oi])){Qn=Oi;break}Qn===void 0?sr(Fn,At,Yt,!0):(us[Qn-It]=Qe+1,Qn>=cr?cr=Qn:un=!0,Me(Fn,ve[Qn],nt,null,At,Yt,oi,Te,Ae),Gr++)}const yo=un?hP(us):Jp;for(Oi=yo.length-1,Qe=Ur-1;Qe>=0;Qe--){const Fn=It+Qe,Qn=ve[Fn],os=Fn+1<Wt?ve[Fn+1].el:Lt;us[Qe]===0?Me(null,Qn,nt,os,At,Yt,oi,Te,Ae):un&&(Oi<0||Qe!==yo[Oi]?ir(Qn,nt,os,2):Oi--)}}},ir=(xe,ve,nt,Lt,At=null)=>{const{el:Yt,type:oi,transition:Te,children:Ae,shapeFlag:Qe}=xe;if(Qe&6){ir(xe.component.subTree,ve,nt,Lt);return}if(Qe&128){xe.suspense.move(ve,nt,Lt);return}if(Qe&64){oi.move(xe,ve,nt,Ei);return}if(oi===$r){_(Yt,ve,nt);for(let Ht=0;Ht<Ae.length;Ht++)ir(Ae[Ht],ve,nt,Lt);_(xe.anchor,ve,nt);return}if(oi===kf){ae(xe,ve,nt);return}if(Lt!==2&&Qe&1&&Te)if(Lt===0)Te.beforeEnter(Yt),_(Yt,ve,nt),Ms(()=>Te.enter(Yt),At);else{const{leave:Ht,delayLeave:Kt,afterLeave:ut}=Te,It=()=>_(Yt,ve,nt),Ii=()=>{Ht(Yt,()=>{It(),ut&&ut()})};Kt?Kt(Yt,It,Ii):Ii()}else _(Yt,ve,nt)},sr=(xe,ve,nt,Lt=!1,At=!1)=>{const{type:Yt,props:oi,ref:Te,children:Ae,dynamicChildren:Qe,shapeFlag:Wt,patchFlag:Ht,dirs:Kt,cacheIndex:ut}=xe;if(Ht===-2&&(At=!1),Te!=null&&Xg(Te,null,nt,xe,!0),ut!=null&&(ve.renderCache[ut]=void 0),Wt&256){ve.ctx.deactivate(xe);return}const It=Wt&1&&Kt,Ii=!Hu(xe);let Oi;if(Ii&&(Oi=oi&&oi.onVnodeBeforeUnmount)&&oa(Oi,ve,xe),Wt&6)Bn(xe.component,nt,Lt);else{if(Wt&128){xe.suspense.unmount(nt,Lt);return}It&&Pc(xe,null,ve,"beforeUnmount"),Wt&64?xe.type.remove(xe,ve,nt,Ei,Lt):Qe&&!Qe.hasOnce&&(Yt!==$r||Ht>0&&Ht&64)?sn(Qe,ve,nt,!1,!0):(Yt===$r&&Ht&384||!At&&Wt&16)&&sn(Ae,ve,nt),Lt&&nn(xe)}(Ii&&(Oi=oi&&oi.onVnodeUnmounted)||It)&&Ms(()=>{Oi&&oa(Oi,ve,xe),It&&Pc(xe,null,ve,"unmounted")},nt)},nn=xe=>{const{type:ve,el:nt,anchor:Lt,transition:At}=xe;if(ve===$r){fr(nt,Lt);return}if(ve===kf){ge(xe);return}const Yt=()=>{T(nt),At&&!At.persisted&&At.afterLeave&&At.afterLeave()};if(xe.shapeFlag&1&&At&&!At.persisted){const{leave:oi,delayLeave:Te}=At,Ae=()=>oi(nt,Yt);Te?Te(xe.el,Yt,Ae):Ae()}else Yt()},fr=(xe,ve)=>{let nt;for(;xe!==ve;)nt=ne(xe),T(xe),xe=nt;T(ve)},Bn=(xe,ve,nt)=>{const{bum:Lt,scope:At,job:Yt,subTree:oi,um:Te,m:Ae,a:Qe}=xe;Jy(Ae),Jy(Qe),Lt&&tm(Lt),At.stop(),Yt&&(Yt.flags|=8,sr(oi,xe,ve,nt)),Te&&Ms(Te,ve),Ms(()=>{xe.isUnmounted=!0},ve),ve&&ve.pendingBranch&&!ve.isUnmounted&&xe.asyncDep&&!xe.asyncResolved&&xe.suspenseId===ve.pendingId&&(ve.deps--,ve.deps===0&&ve.resolve())},sn=(xe,ve,nt,Lt=!1,At=!1,Yt=0)=>{for(let oi=Yt;oi<xe.length;oi++)sr(xe[oi],ve,nt,Lt,At)},zt=xe=>{if(xe.shapeFlag&6)return zt(xe.component.subTree);if(xe.shapeFlag&128)return xe.suspense.next();const ve=ne(xe.anchor||xe.el),nt=ve&&ve[WE];return nt?ne(nt):ve};let mi=!1;const si=(xe,ve,nt)=>{xe==null?ve._vnode&&sr(ve._vnode,null,null,!0):Me(ve._vnode||null,xe,ve,null,null,null,nt),ve._vnode=xe,mi||(mi=!0,uw(),Yy(),mi=!1)},Ei={p:Me,um:sr,m:ir,r:nn,mt:kt,mc:ke,pc:xi,pbc:He,n:zt,o:t};let or,Si;return l&&([or,Si]=l(Ei)),{render:si,hydrate:or,createApp:rP(si,or)}}function c0({type:t,props:l},d){return d==="svg"&&t==="foreignObject"||d==="mathml"&&t==="annotation-xml"&&l&&l.encoding&&l.encoding.includes("html")?void 0:d}function wf({effect:t,job:l},d){d?(t.flags|=32,l.flags|=4):(t.flags&=-33,l.flags&=-5)}function SS(t,l){return(!t||t&&!t.pendingBranch)&&l&&!l.persisted}function Rb(t,l,d=!1){const _=t.children,T=l.children;if(Ri(_)&&Ri(T))for(let C=0;C<_.length;C++){const P=_[C];let V=T[C];V.shapeFlag&1&&!V.dynamicChildren&&((V.patchFlag<=0||V.patchFlag===32)&&(V=T[C]=Gu(T[C]),V.el=P.el),!d&&V.patchFlag!==-2&&Rb(P,V)),V.type===Ih&&(V.el=P.el)}}function hP(t){const l=t.slice(),d=[0];let _,T,C,P,V;const s=t.length;for(_=0;_<s;_++){const $=t[_];if($!==0){if(T=d[d.length-1],t[T]<$){l[_]=T,d.push(_);continue}for(C=0,P=d.length-1;C<P;)V=C+P>>1,t[d[V]]<$?C=V+1:P=V;$<t[d[C]]&&(C>0&&(l[_]=d[C-1]),d[C]=_)}}for(C=d.length,P=d[C-1];C-- >0;)d[C]=P,P=l[P];return d}function CS(t){const l=t.subTree.component;if(l)return l.asyncDep&&!l.asyncResolved?l:CS(l)}function Jy(t){if(t)for(let l=0;l<t.length;l++)t[l].flags|=8}const AS=Symbol.for("v-scx"),MS=()=>ca(AS);function uP(t,l){return u_(t,null,l)}function dP(t,l){return u_(t,null,{flush:"post"})}function IS(t,l){return u_(t,null,{flush:"sync"})}function ha(t,l,d){return u_(t,l,d)}function u_(t,l,d=Nr){const{immediate:_,deep:T,flush:C,once:P}=d,V=Sn({},d),s=l&&_||!l&&C!=="post";let $;if(sm){if(C==="sync"){const ue=MS();$=ue.__watcherHandles||(ue.__watcherHandles=[])}else if(!s){const ue=()=>{};return ue.stop=sl,ue.resume=sl,ue.pause=sl,ue}}const Z=Is;V.call=(ue,we,Me)=>al(ue,Z,we,Me);let J=!1;C==="post"?V.scheduler=ue=>{Ms(ue,Z&&Z.suspense)}:C!=="sync"&&(J=!0,V.scheduler=(ue,we)=>{we?ue():Eb(ue)}),V.augmentJob=ue=>{l&&(ue.flags|=4),J&&(ue.flags|=2,Z&&(ue.id=Z.uid,ue.i=Z))};const ne=ik(t,l,V);return sm&&($?$.push(ne):s&&ne()),ne}function fP(t,l,d){const _=this.proxy,T=Rn(t)?t.includes(".")?kS(_,t):()=>_[t]:t.bind(_,_);let C;tr(l)?C=l:(C=l.handler,d=l);const P=Df(this),V=u_(T,C.bind(_),d);return P(),V}function kS(t,l){const d=l.split(".");return()=>{let _=t;for(let T=0;T<d.length&&_;T++)_=_[d[T]];return _}}function pP(t,l,d=Nr){const _=Ys(),T=Xs(l),C=la(l),P=PS(t,T),V=RE((s,$)=>{let Z,J=Nr,ne;return IS(()=>{const ue=t[T];Bo(Z,ue)&&(Z=ue,$())}),{get(){return s(),d.get?d.get(Z):Z},set(ue){const we=d.set?d.set(ue):ue;if(!Bo(we,Z)&&!(J!==Nr&&Bo(ue,J)))return;const Me=_.vnode.props;Me&&(l in Me||T in Me||C in Me)&&(`onUpdate:${l}`in Me||`onUpdate:${T}`in Me||`onUpdate:${C}`in Me)||(Z=ue,$()),_.emit(`update:${l}`,we),Bo(ue,we)&&Bo(ue,J)&&!Bo(we,ne)&&$(),J=ue,ne=we}}});return V[Symbol.iterator]=()=>{let s=0;return{next(){return s<2?{value:s++?P||Nr:V,done:!1}:{done:!0}}}},V}const PS=(t,l)=>l==="modelValue"||l==="model-value"?t.modelModifiers:t[`${l}Modifiers`]||t[`${Xs(l)}Modifiers`]||t[`${la(l)}Modifiers`];function mP(t,l,...d){if(t.isUnmounted)return;const _=t.vnode.props||Nr;let T=d;const C=l.startsWith("update:"),P=C&&PS(_,l.slice(7));P&&(P.trim&&(T=d.map(Z=>Rn(Z)?Z.trim():Z)),P.number&&(T=d.map(Wy)));let V,s=_[V=Pg(l)]||_[V=Pg(Xs(l))];!s&&C&&(s=_[V=Pg(la(l))]),s&&al(s,t,6,T);const $=_[V+"Once"];if($){if(!t.emitted)t.emitted={};else if(t.emitted[V])return;t.emitted[V]=!0,al($,t,6,T)}}function LS(t,l,d=!1){const _=l.emitsCache,T=_.get(t);if(T!==void 0)return T;const C=t.emits;let P={},V=!1;if(!tr(t)){const s=$=>{const Z=LS($,l,!0);Z&&(V=!0,Sn(P,Z))};!d&&l.mixins.length&&l.mixins.forEach(s),t.extends&&s(t.extends),t.mixins&&t.mixins.forEach(s)}return!C&&!V?(yn(t)&&_.set(t,null),null):(Ri(C)?C.forEach(s=>P[s]=null):Sn(P,C),yn(t)&&_.set(t,P),P)}function Ix(t,l){return!t||!o_(l)?!1:(l=l.slice(2).replace(/Once$/,""),rn(t,l[0].toLowerCase()+l.slice(1))||rn(t,la(l))||rn(t,l))}function zy(t){const{type:l,vnode:d,proxy:_,withProxy:T,propsOptions:[C],slots:P,attrs:V,emit:s,render:$,renderCache:Z,props:J,data:ne,setupState:ue,ctx:we,inheritAttrs:Me}=t,Ye=qg(t);let Ze,je;try{if(d.shapeFlag&4){const ge=T||_,Oe=ge;Ze=aa($.call(Oe,ge,Z,J,ue,ne,we)),je=V}else{const ge=l;Ze=aa(ge.length>1?ge(J,{attrs:V,slots:P,emit:s}):ge(J,null)),je=l.props?V:_P(V)}}catch(ge){Bg.length=0,zf(ge,t,1),Ze=pr(Ts)}let ae=Ze;if(je&&Me!==!1){const ge=Object.keys(je),{shapeFlag:Oe}=ae;ge.length&&Oe&7&&(C&&ge.some(db)&&(je=yP(je,C)),ae=Rc(ae,je,!1,!0))}return d.dirs&&(ae=Rc(ae,null,!1,!0),ae.dirs=ae.dirs?ae.dirs.concat(d.dirs):d.dirs),d.transition&&Ph(ae,d.transition),Ze=ae,qg(Ye),Ze}function gP(t,l=!0){let d;for(let _=0;_<t.length;_++){const T=t[_];if(Lh(T)){if(T.type!==Ts||T.children==="v-if"){if(d)return;d=T}}else return}return d}const _P=t=>{let l;for(const d in t)(d==="class"||d==="style"||o_(d))&&((l||(l={}))[d]=t[d]);return l},yP=(t,l)=>{const d={};for(const _ in t)(!db(_)||!(_.slice(9)in l))&&(d[_]=t[_]);return d};function xP(t,l,d){const{props:_,children:T,component:C}=t,{props:P,children:V,patchFlag:s}=l,$=C.emitsOptions;if(l.dirs||l.transition)return!0;if(d&&s>=0){if(s&1024)return!0;if(s&16)return _?Tw(_,P,$):!!P;if(s&8){const Z=l.dynamicProps;for(let J=0;J<Z.length;J++){const ne=Z[J];if(P[ne]!==_[ne]&&!Ix($,ne))return!0}}}else return(T||V)&&(!V||!V.$stable)?!0:_===P?!1:_?P?Tw(_,P,$):!0:!!P;return!1}function Tw(t,l,d){const _=Object.keys(l);if(_.length!==Object.keys(t).length)return!0;for(let T=0;T<_.length;T++){const C=_[T];if(l[C]!==t[C]&&!Ix(d,C))return!0}return!1}function kx({vnode:t,parent:l},d){for(;l;){const _=l.subTree;if(_.suspense&&_.suspense.activeBranch===t&&(_.el=t.el),_===t)(t=l.vnode).el=d,l=l.parent;else break}}const Qy=t=>t.__isSuspense;let R0=0;const vP={name:"Suspense",__isSuspense:!0,process(t,l,d,_,T,C,P,V,s,$){if(t==null)wP(l,d,_,T,C,P,V,s,$);else{if(C&&C.deps>0&&!t.suspense.isInFallback){l.suspense=t.suspense,l.suspense.vnode=l,l.el=t.el;return}TP(t,l,d,_,T,P,V,s,$)}},hydrate:EP,normalize:SP},bP=vP;function Yg(t,l){const d=t.props&&t.props[l];tr(d)&&d()}function wP(t,l,d,_,T,C,P,V,s){const{p:$,o:{createElement:Z}}=s,J=Z("div"),ne=t.suspense=DS(t,T,_,l,J,d,C,P,V,s);$(null,ne.pendingBranch=t.ssContent,J,null,_,ne,C,P),ne.deps>0?(Yg(t,"onPending"),Yg(t,"onFallback"),$(null,t.ssFallback,l,d,_,null,C,P),rm(ne,t.ssFallback)):ne.resolve(!1,!0)}function TP(t,l,d,_,T,C,P,V,{p:s,um:$,o:{createElement:Z}}){const J=l.suspense=t.suspense;J.vnode=l,l.el=t.el;const ne=l.ssContent,ue=l.ssFallback,{activeBranch:we,pendingBranch:Me,isInFallback:Ye,isHydrating:Ze}=J;if(Me)J.pendingBranch=ne,Rl(ne,Me)?(s(Me,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0?J.resolve():Ye&&(Ze||(s(we,ue,d,_,T,null,C,P,V),rm(J,ue)))):(J.pendingId=R0++,Ze?(J.isHydrating=!1,J.activeBranch=Me):$(Me,T,J),J.deps=0,J.effects.length=0,J.hiddenContainer=Z("div"),Ye?(s(null,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0?J.resolve():(s(we,ue,d,_,T,null,C,P,V),rm(J,ue))):we&&Rl(ne,we)?(s(we,ne,d,_,T,J,C,P,V),J.resolve(!0)):(s(null,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0&&J.resolve()));else if(we&&Rl(ne,we))s(we,ne,d,_,T,J,C,P,V),rm(J,ne);else if(Yg(l,"onPending"),J.pendingBranch=ne,ne.shapeFlag&512?J.pendingId=ne.component.suspenseId:J.pendingId=R0++,s(null,ne,J.hiddenContainer,null,T,J,C,P,V),J.deps<=0)J.resolve();else{const{timeout:je,pendingId:ae}=J;je>0?setTimeout(()=>{J.pendingId===ae&&J.fallback(ue)},je):je===0&&J.fallback(ue)}}function DS(t,l,d,_,T,C,P,V,s,$,Z=!1){const{p:J,m:ne,um:ue,n:we,o:{parentNode:Me,remove:Ye}}=$;let Ze;const je=CP(t);je&&l&&l.pendingBranch&&(Ze=l.pendingId,l.deps++);const ae=t.props?Hy(t.props.timeout):void 0,ge=C,Oe={vnode:t,parent:l,parentComponent:d,namespace:P,container:_,hiddenContainer:T,deps:0,pendingId:R0++,timeout:typeof ae=="number"?ae:-1,activeBranch:null,pendingBranch:null,isInFallback:!Z,isHydrating:Z,isUnmounted:!1,effects:[],resolve(ze=!1,rt=!1){const{vnode:ke,activeBranch:Ke,pendingBranch:He,pendingId:ri,effects:bt,parentComponent:dt,container:kt}=Oe;let Pt=!1;Oe.isHydrating?Oe.isHydrating=!1:ze||(Pt=Ke&&He.transition&&He.transition.mode==="out-in",Pt&&(Ke.transition.afterLeave=()=>{ri===Oe.pendingId&&(ne(He,kt,C===ge?we(Ke):C,0),Wg(bt))}),Ke&&(Me(Ke.el)===kt&&(C=we(Ke)),ue(Ke,dt,Oe,!0)),Pt||ne(He,kt,C,0)),rm(Oe,He),Oe.pendingBranch=null,Oe.isInFallback=!1;let vt=Oe.parent,ci=!1;for(;vt;){if(vt.pendingBranch){vt.effects.push(...bt),ci=!0;break}vt=vt.parent}!ci&&!Pt&&Wg(bt),Oe.effects=[],je&&l&&l.pendingBranch&&Ze===l.pendingId&&(l.deps--,l.deps===0&&!rt&&l.resolve()),Yg(ke,"onResolve")},fallback(ze){if(!Oe.pendingBranch)return;const{vnode:rt,activeBranch:ke,parentComponent:Ke,container:He,namespace:ri}=Oe;Yg(rt,"onFallback");const bt=we(ke),dt=()=>{Oe.isInFallback&&(J(null,ze,He,bt,Ke,null,ri,V,s),rm(Oe,ze))},kt=ze.transition&&ze.transition.mode==="out-in";kt&&(ke.transition.afterLeave=dt),Oe.isInFallback=!0,ue(ke,Ke,null,!0),kt||dt()},move(ze,rt,ke){Oe.activeBranch&&ne(Oe.activeBranch,ze,rt,ke),Oe.container=ze},next(){return Oe.activeBranch&&we(Oe.activeBranch)},registerDep(ze,rt,ke){const Ke=!!Oe.pendingBranch;Ke&&Oe.deps++;const He=ze.vnode.el;ze.asyncDep.catch(ri=>{zf(ri,ze,0)}).then(ri=>{if(ze.isUnmounted||Oe.isUnmounted||Oe.pendingId!==ze.suspenseId)return;ze.asyncResolved=!0;const{vnode:bt}=ze;N0(ze,ri,!1),He&&(bt.el=He);const dt=!He&&ze.subTree.el;rt(ze,bt,Me(He||ze.subTree.el),He?null:we(ze.subTree),Oe,P,ke),dt&&Ye(dt),kx(ze,bt.el),Ke&&--Oe.deps===0&&Oe.resolve()})},unmount(ze,rt){Oe.isUnmounted=!0,Oe.activeBranch&&ue(Oe.activeBranch,d,ze,rt),Oe.pendingBranch&&ue(Oe.pendingBranch,d,ze,rt)}};return Oe}function EP(t,l,d,_,T,C,P,V,s){const $=l.suspense=DS(l,_,d,t.parentNode,document.createElement("div"),null,T,C,P,V,!0),Z=s(t,$.pendingBranch=l.ssContent,d,$,C,P);return $.deps===0&&$.resolve(!1,!0),Z}function SP(t){const{shapeFlag:l,children:d}=t,_=l&32;t.ssContent=Ew(_?d.default:d),t.ssFallback=_?Ew(d.fallback):pr(Ts)}function Ew(t){let l;if(tr(t)){const d=Lf&&t._c;d&&(t._d=!1,_i()),t=t(),d&&(t._d=!0,l=_o,RS())}return Ri(t)&&(t=gP(t)),t=aa(t),l&&!t.dynamicChildren&&(t.dynamicChildren=l.filter(d=>d!==t)),t}function OS(t,l){l&&l.pendingBranch?Ri(t)?l.effects.push(...t):l.effects.push(t):Wg(t)}function rm(t,l){t.activeBranch=l;const{vnode:d,parentComponent:_}=t;let T=l.el;for(;!T&&l.component;)l=l.component.subTree,T=l.el;d.el=T,_&&_.subTree===d&&(_.vnode.el=T,kx(_,T))}function CP(t){const l=t.props&&t.props.suspensible;return l!=null&&l!==!1}const $r=Symbol.for("v-fgt"),Ih=Symbol.for("v-txt"),Ts=Symbol.for("v-cmt"),kf=Symbol.for("v-stc"),Bg=[];let _o=null;function _i(t=!1){Bg.push(_o=t?null:[])}function RS(){Bg.pop(),_o=Bg[Bg.length-1]||null}let Lf=1;function z0(t,l=!1){Lf+=t,t<0&&_o&&l&&(_o.hasOnce=!0)}function zS(t){return t.dynamicChildren=Lf>0?_o||Jp:null,RS(),Lf>0&&_o&&_o.push(t),t}function Pi(t,l,d,_,T,C){return zS(lt(t,l,d,_,T,C,!0))}function No(t,l,d,_,T){return zS(pr(t,l,d,_,T,!0))}function Lh(t){return t?t.__v_isVNode===!0:!1}function Rl(t,l){return t.type===l.type&&t.key===l.key}function AP(t){}const BS=({key:t})=>t??null,By=({ref:t,ref_key:l,ref_for:d})=>(typeof t=="number"&&(t=""+t),t!=null?Rn(t)||On(t)||tr(t)?{i:ks,r:t,k:l,f:!!d}:t:null);function lt(t,l=null,d=null,_=0,T=null,C=t===$r?0:1,P=!1,V=!1){const s={__v_isVNode:!0,__v_skip:!0,type:t,props:l,key:l&&BS(l),ref:l&&By(l),scopeId:Tx,slotScopeIds:null,children:d,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:C,patchFlag:_,dynamicProps:T,dynamicChildren:null,appContext:null,ctx:ks};return V?(zb(s,d),C&128&&t.normalize(s)):d&&(s.shapeFlag|=Rn(d)?8:16),Lf>0&&!P&&_o&&(s.patchFlag>0||C&6)&&s.patchFlag!==32&&_o.push(s),s}const pr=MP;function MP(t,l=null,d=null,_=0,T=null,C=!1){if((!t||t===oS)&&(t=Ts),Lh(t)){const V=Rc(t,l,!0);return d&&zb(V,d),Lf>0&&!C&&_o&&(V.shapeFlag&6?_o[_o.indexOf(t)]=V:_o.push(V)),V.patchFlag=-2,V}if(RP(t)&&(t=t.__vccOpts),l){l=FS(l);let{class:V,style:s}=l;V&&!Rn(V)&&(l.class=Vs(V)),yn(s)&&(bx(s)&&!Ri(s)&&(s=Sn({},s)),l.style=zc(s))}const P=Rn(t)?1:Qy(t)?128:HE(t)?64:yn(t)?4:tr(t)?2:0;return lt(t,l,d,_,T,P,C,!0)}function FS(t){return t?bx(t)||mS(t)?Sn({},t):t:null}function Rc(t,l,d=!1,_=!1){const{props:T,ref:C,patchFlag:P,children:V,transition:s}=t,$=l?d_(T||{},l):T,Z={__v_isVNode:!0,__v_skip:!0,type:t.type,props:$,key:$&&BS($),ref:l&&l.ref?d&&C?Ri(C)?C.concat(By(l)):[C,By(l)]:By(l):C,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:V,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:l&&t.type!==$r?P===-1?16:P|16:P,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:s,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Rc(t.ssContent),ssFallback:t.ssFallback&&Rc(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return s&&_&&Ph(Z,s.clone(Z)),Z}function js(t=" ",l=0){return pr(Ih,null,t,l)}function ex(t,l){const d=pr(kf,null,t);return d.staticCount=l,d}function En(t="",l=!1){return l?(_i(),No(Ts,null,t)):pr(Ts,null,t)}function aa(t){return t==null||typeof t=="boolean"?pr(Ts):Ri(t)?pr($r,null,t.slice()):Lh(t)?Gu(t):pr(Ih,null,String(t))}function Gu(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Rc(t)}function zb(t,l){let d=0;const{shapeFlag:_}=t;if(l==null)l=null;else if(Ri(l))d=16;else if(typeof l=="object")if(_&65){const T=l.default;T&&(T._c&&(T._d=!1),zb(t,T()),T._c&&(T._d=!0));return}else{d=32;const T=l._;!T&&!mS(l)?l._ctx=ks:T===3&&ks&&(ks.slots._===1?l._=1:(l._=2,t.patchFlag|=1024))}else tr(l)?(l={default:l,_ctx:ks},d=32):(l=String(l),_&64?(d=16,l=[js(l)]):d=8);t.children=l,t.shapeFlag|=d}function d_(...t){const l={};for(let d=0;d<t.length;d++){const _=t[d];for(const T in _)if(T==="class")l.class!==_.class&&(l.class=Vs([l.class,_.class]));else if(T==="style")l.style=zc([l.style,_.style]);else if(o_(T)){const C=l[T],P=_[T];P&&C!==P&&!(Ri(C)&&C.includes(P))&&(l[T]=C?[].concat(C,P):P)}else T!==""&&(l[T]=_[T])}return l}function oa(t,l,d,_=null){al(t,l,7,[d,_])}const IP=uS();let kP=0;function NS(t,l,d){const _=t.type,T=(l?l.appContext:t.appContext)||IP,C={uid:kP++,vnode:t,type:_,parent:l,appContext:T,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new gb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:l?l.provides:Object.create(T.provides),ids:l?l.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_S(_,T),emitsOptions:LS(_,T),emit:null,emitted:null,propsDefaults:Nr,inheritAttrs:_.inheritAttrs,ctx:Nr,data:Nr,props:Nr,attrs:Nr,slots:Nr,refs:Nr,setupState:Nr,setupContext:null,suspense:d,suspenseId:d?d.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return C.ctx={_:C},C.root=l?l.root:C,C.emit=mP.bind(null,C),t.ce&&t.ce(C),C}let Is=null;const Ys=()=>Is||ks;let tx,B0;{const t=px(),l=(d,_)=>{let T;return(T=t[d])||(T=t[d]=[]),T.push(_),C=>{T.length>1?T.forEach(P=>P(C)):T[0](C)}};tx=l("__VUE_INSTANCE_SETTERS__",d=>Is=d),B0=l("__VUE_SSR_SETTERS__",d=>sm=d)}const Df=t=>{const l=Is;return tx(t),t.scope.on(),()=>{t.scope.off(),tx(l)}},F0=()=>{Is&&Is.scope.off(),tx(null)};function US(t){return t.vnode.shapeFlag&4}let sm=!1;function VS(t,l=!1,d=!1){l&&B0(l);const{props:_,children:T}=t.vnode,C=US(t);nP(t,_,C,l),lP(t,T,d);const P=C?PP(t,l):void 0;return l&&B0(!1),P}function PP(t,l){const d=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,P0);const{setup:_}=d;if(_){Ku();const T=t.setupContext=_.length>1?$S(t):null,C=Df(t),P=pm(_,t,0,[t.props,T]),V=pb(P);if(Ju(),C(),(V||t.sp)&&!Hu(t)&&Ab(t),V){if(P.then(F0,F0),l)return P.then(s=>{N0(t,s,l)}).catch(s=>{zf(s,t,0)});t.asyncDep=P}else N0(t,P,l)}else jS(t,l)}function N0(t,l,d){tr(l)?t.type.__ssrInlineRender?t.ssrRender=l:t.render=l:yn(l)&&(t.setupState=Tb(l)),jS(t,d)}let ix,U0;function LP(t){ix=t,U0=l=>{l.render._rc&&(l.withProxy=new Proxy(l.ctx,Bk))}}const DP=()=>!ix;function jS(t,l,d){const _=t.type;if(!t.render){if(!l&&ix&&!_.render){const T=_.template||Db(t).template;if(T){const{isCustomElement:C,compilerOptions:P}=t.appContext.config,{delimiters:V,compilerOptions:s}=_,$=Sn(Sn({isCustomElement:C,delimiters:V},P),s);_.render=ix(T,$)}}t.render=_.render||sl,U0&&U0(t)}{const T=Df(t);Ku();try{Kk(t)}finally{Ju(),T()}}}const OP={get(t,l){return po(t,"get",""),t[l]}};function $S(t){const l=d=>{t.exposed=d||{}};return{attrs:new Proxy(t.attrs,OP),slots:t.slots,emit:t.emit,expose:l}}function f_(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Tb(wx(t.exposed)),{get(l,d){if(d in l)return l[d];if(d in Rg)return Rg[d](t)},has(l,d){return d in l||d in Rg}})):t.proxy}function V0(t,l=!0){return tr(t)?t.displayName||t.name:t.name||l&&t.__name}function RP(t){return tr(t)&&"__vccOpts"in t}const fn=(t,l)=>JI(t,l,sm);function mm(t,l,d){const _=arguments.length;return _===2?yn(l)&&!Ri(l)?Lh(l)?pr(t,null,[l]):pr(t,l):pr(t,null,l):(_>3?d=Array.prototype.slice.call(arguments,2):_===3&&Lh(d)&&(d=[d]),pr(t,l,d))}function zP(){}function BP(t,l,d,_){const T=d[_];if(T&&GS(T,t))return T;const C=l();return C.memo=t.slice(),C.cacheIndex=_,d[_]=C}function GS(t,l){const d=t.memo;if(d.length!=l.length)return!1;for(let _=0;_<d.length;_++)if(Bo(d[_],l[_]))return!1;return Lf>0&&_o&&_o.push(t),!0}const WS="3.5.13",FP=sl,NP=ak,UP=qp,VP=GE,jP={createComponentInstance:NS,setupComponent:VS,renderComponentRoot:zy,setCurrentRenderingInstance:qg,isVNode:Lh,normalizeVNode:aa,getComponentPublicInstance:f_,ensureValidVNode:Lb,pushWarningContext:rk,popWarningContext:nk},$P=jP,GP=null,WP=null,HP=null;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let j0;const Sw=typeof window<"u"&&window.trustedTypes;if(Sw)try{j0=Sw.createPolicy("vue",{createHTML:t=>t})}catch{}const HS=j0?t=>j0.createHTML(t):t=>t,qP="http://www.w3.org/2000/svg",XP="http://www.w3.org/1998/Math/MathML",wh=typeof document<"u"?document:null,Cw=wh&&wh.createElement("template"),ZP={insert:(t,l,d)=>{l.insertBefore(t,d||null)},remove:t=>{const l=t.parentNode;l&&l.removeChild(t)},createElement:(t,l,d,_)=>{const T=l==="svg"?wh.createElementNS(qP,t):l==="mathml"?wh.createElementNS(XP,t):d?wh.createElement(t,{is:d}):wh.createElement(t);return t==="select"&&_&&_.multiple!=null&&T.setAttribute("multiple",_.multiple),T},createText:t=>wh.createTextNode(t),createComment:t=>wh.createComment(t),setText:(t,l)=>{t.nodeValue=l},setElementText:(t,l)=>{t.textContent=l},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>wh.querySelector(t),setScopeId(t,l){t.setAttribute(l,"")},insertStaticContent(t,l,d,_,T,C){const P=d?d.previousSibling:l.lastChild;if(T&&(T===C||T.nextSibling))for(;l.insertBefore(T.cloneNode(!0),d),!(T===C||!(T=T.nextSibling)););else{Cw.innerHTML=HS(_==="svg"?`<svg>${t}</svg>`:_==="mathml"?`<math>${t}</math>`:t);const V=Cw.content;if(_==="svg"||_==="mathml"){const s=V.firstChild;for(;s.firstChild;)V.appendChild(s.firstChild);V.removeChild(s)}l.insertBefore(V,d)}return[P?P.nextSibling:l.firstChild,d?d.previousSibling:l.lastChild]}},zu="transition",Eg="animation",om=Symbol("_vtc"),qS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},XS=Sn({},Cb,qS),YP=t=>(t.displayName="Transition",t.props=XS,t),Bb=YP((t,{slots:l})=>mm(KE,ZS(t),l)),Tf=(t,l=[])=>{Ri(t)?t.forEach(d=>d(...l)):t&&t(...l)},Aw=t=>t?Ri(t)?t.some(l=>l.length>1):t.length>1:!1;function ZS(t){const l={};for(const bt in t)bt in qS||(l[bt]=t[bt]);if(t.css===!1)return l;const{name:d="v",type:_,duration:T,enterFromClass:C=`${d}-enter-from`,enterActiveClass:P=`${d}-enter-active`,enterToClass:V=`${d}-enter-to`,appearFromClass:s=C,appearActiveClass:$=P,appearToClass:Z=V,leaveFromClass:J=`${d}-leave-from`,leaveActiveClass:ne=`${d}-leave-active`,leaveToClass:ue=`${d}-leave-to`}=t,we=KP(T),Me=we&&we[0],Ye=we&&we[1],{onBeforeEnter:Ze,onEnter:je,onEnterCancelled:ae,onLeave:ge,onLeaveCancelled:Oe,onBeforeAppear:ze=Ze,onAppear:rt=je,onAppearCancelled:ke=ae}=l,Ke=(bt,dt,kt,Pt)=>{bt._enterCancelled=Pt,Nu(bt,dt?Z:V),Nu(bt,dt?$:P),kt&&kt()},He=(bt,dt)=>{bt._isLeaving=!1,Nu(bt,J),Nu(bt,ue),Nu(bt,ne),dt&&dt()},ri=bt=>(dt,kt)=>{const Pt=bt?rt:je,vt=()=>Ke(dt,bt,kt);Tf(Pt,[dt,vt]),Mw(()=>{Nu(dt,bt?s:C),Ic(dt,bt?Z:V),Aw(Pt)||Iw(dt,_,Me,vt)})};return Sn(l,{onBeforeEnter(bt){Tf(Ze,[bt]),Ic(bt,C),Ic(bt,P)},onBeforeAppear(bt){Tf(ze,[bt]),Ic(bt,s),Ic(bt,$)},onEnter:ri(!1),onAppear:ri(!0),onLeave(bt,dt){bt._isLeaving=!0;const kt=()=>He(bt,dt);Ic(bt,J),bt._enterCancelled?(Ic(bt,ne),$0()):($0(),Ic(bt,ne)),Mw(()=>{bt._isLeaving&&(Nu(bt,J),Ic(bt,ue),Aw(ge)||Iw(bt,_,Ye,kt))}),Tf(ge,[bt,kt])},onEnterCancelled(bt){Ke(bt,!1,void 0,!0),Tf(ae,[bt])},onAppearCancelled(bt){Ke(bt,!0,void 0,!0),Tf(ke,[bt])},onLeaveCancelled(bt){He(bt),Tf(Oe,[bt])}})}function KP(t){if(t==null)return null;if(yn(t))return[h0(t.enter),h0(t.leave)];{const l=h0(t);return[l,l]}}function h0(t){return Hy(t)}function Ic(t,l){l.split(/\s+/).forEach(d=>d&&t.classList.add(d)),(t[om]||(t[om]=new Set)).add(l)}function Nu(t,l){l.split(/\s+/).forEach(_=>_&&t.classList.remove(_));const d=t[om];d&&(d.delete(l),d.size||(t[om]=void 0))}function Mw(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let JP=0;function Iw(t,l,d,_){const T=t._endId=++JP,C=()=>{T===t._endId&&_()};if(d!=null)return setTimeout(C,d);const{type:P,timeout:V,propCount:s}=YS(t,l);if(!P)return _();const $=P+"end";let Z=0;const J=()=>{t.removeEventListener($,ne),C()},ne=ue=>{ue.target===t&&++Z>=s&&J()};setTimeout(()=>{Z<s&&J()},V+1),t.addEventListener($,ne)}function YS(t,l){const d=window.getComputedStyle(t),_=we=>(d[we]||"").split(", "),T=_(`${zu}Delay`),C=_(`${zu}Duration`),P=kw(T,C),V=_(`${Eg}Delay`),s=_(`${Eg}Duration`),$=kw(V,s);let Z=null,J=0,ne=0;l===zu?P>0&&(Z=zu,J=P,ne=C.length):l===Eg?$>0&&(Z=Eg,J=$,ne=s.length):(J=Math.max(P,$),Z=J>0?P>$?zu:Eg:null,ne=Z?Z===zu?C.length:s.length:0);const ue=Z===zu&&/\b(transform|all)(,|$)/.test(_(`${zu}Property`).toString());return{type:Z,timeout:J,propCount:ne,hasTransform:ue}}function kw(t,l){for(;t.length<l.length;)t=t.concat(t);return Math.max(...l.map((d,_)=>Pw(d)+Pw(t[_])))}function Pw(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function $0(){return document.body.offsetHeight}function QP(t,l,d){const _=t[om];_&&(l=(l?[l,..._]:[..._]).join(" ")),l==null?t.removeAttribute("class"):d?t.setAttribute("class",l):t.className=l}const rx=Symbol("_vod"),KS=Symbol("_vsh"),JS={beforeMount(t,{value:l},{transition:d}){t[rx]=t.style.display==="none"?"":t.style.display,d&&l?d.beforeEnter(t):Sg(t,l)},mounted(t,{value:l},{transition:d}){d&&l&&d.enter(t)},updated(t,{value:l,oldValue:d},{transition:_}){!l!=!d&&(_?l?(_.beforeEnter(t),Sg(t,!0),_.enter(t)):_.leave(t,()=>{Sg(t,!1)}):Sg(t,l))},beforeUnmount(t,{value:l}){Sg(t,l)}};function Sg(t,l){t.style.display=l?t[rx]:"none",t[KS]=!l}function eL(){JS.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const QS=Symbol("");function tL(t){const l=Ys();if(!l)return;const d=l.ut=(T=t(l.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${l.uid}"]`)).forEach(C=>nx(C,T))},_=()=>{const T=t(l.proxy);l.ce?nx(l.ce,T):G0(l.subTree,T),d(T)};Ib(()=>{Wg(_)}),Oh(()=>{ha(_,sl,{flush:"post"});const T=new MutationObserver(_);T.observe(l.subTree.el.parentNode,{childList:!0}),h_(()=>T.disconnect())})}function G0(t,l){if(t.shapeFlag&128){const d=t.suspense;t=d.activeBranch,d.pendingBranch&&!d.isHydrating&&d.effects.push(()=>{G0(d.activeBranch,l)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)nx(t.el,l);else if(t.type===$r)t.children.forEach(d=>G0(d,l));else if(t.type===kf){let{el:d,anchor:_}=t;for(;d&&(nx(d,l),d!==_);)d=d.nextSibling}}function nx(t,l){if(t.nodeType===1){const d=t.style;let _="";for(const T in l)d.setProperty(`--${T}`,l[T]),_+=`--${T}: ${l[T]};`;d[QS]=_}}const iL=/(^|;)\s*display\s*:/;function rL(t,l,d){const _=t.style,T=Rn(d);let C=!1;if(d&&!T){if(l)if(Rn(l))for(const P of l.split(";")){const V=P.slice(0,P.indexOf(":")).trim();d[V]==null&&Fy(_,V,"")}else for(const P in l)d[P]==null&&Fy(_,P,"");for(const P in d)P==="display"&&(C=!0),Fy(_,P,d[P])}else if(T){if(l!==d){const P=_[QS];P&&(d+=";"+P),_.cssText=d,C=iL.test(d)}}else l&&t.removeAttribute("style");rx in t&&(t[rx]=C?_.display:"",t[KS]&&(_.display="none"))}const Lw=/\s*!important$/;function Fy(t,l,d){if(Ri(d))d.forEach(_=>Fy(t,l,_));else if(d==null&&(d=""),l.startsWith("--"))t.setProperty(l,d);else{const _=nL(t,l);Lw.test(d)?t.setProperty(la(_),d.replace(Lw,""),"important"):t[_]=d}}const Dw=["Webkit","Moz","ms"],u0={};function nL(t,l){const d=u0[l];if(d)return d;let _=Xs(l);if(_!=="filter"&&_ in t)return u0[l]=_;_=a_(_);for(let T=0;T<Dw.length;T++){const C=Dw[T]+_;if(C in t)return u0[l]=C}return l}const Ow="http://www.w3.org/1999/xlink";function Rw(t,l,d,_,T,C=vI(l)){_&&l.startsWith("xlink:")?d==null?t.removeAttributeNS(Ow,l.slice(6,l.length)):t.setAttributeNS(Ow,l,d):d==null||C&&!mE(d)?t.removeAttribute(l):t.setAttribute(l,C?"":Vl(d)?String(d):d)}function zw(t,l,d,_,T){if(l==="innerHTML"||l==="textContent"){d!=null&&(t[l]=l==="innerHTML"?HS(d):d);return}const C=t.tagName;if(l==="value"&&C!=="PROGRESS"&&!C.includes("-")){const V=C==="OPTION"?t.getAttribute("value")||"":t.value,s=d==null?t.type==="checkbox"?"on":"":String(d);(V!==s||!("_value"in t))&&(t.value=s),d==null&&t.removeAttribute(l),t._value=d;return}let P=!1;if(d===""||d==null){const V=typeof t[l];V==="boolean"?d=mE(d):d==null&&V==="string"?(d="",P=!0):V==="number"&&(d=0,P=!0)}try{t[l]=d}catch{}P&&t.removeAttribute(T||l)}function Sh(t,l,d,_){t.addEventListener(l,d,_)}function sL(t,l,d,_){t.removeEventListener(l,d,_)}const Bw=Symbol("_vei");function oL(t,l,d,_,T=null){const C=t[Bw]||(t[Bw]={}),P=C[l];if(_&&P)P.value=_;else{const[V,s]=aL(l);if(_){const $=C[l]=hL(_,T);Sh(t,V,$,s)}else P&&(sL(t,V,P,s),C[l]=void 0)}}const Fw=/(?:Once|Passive|Capture)$/;function aL(t){let l;if(Fw.test(t)){l={};let _;for(;_=t.match(Fw);)t=t.slice(0,t.length-_[0].length),l[_[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):la(t.slice(2)),l]}let d0=0;const lL=Promise.resolve(),cL=()=>d0||(lL.then(()=>d0=0),d0=Date.now());function hL(t,l){const d=_=>{if(!_._vts)_._vts=Date.now();else if(_._vts<=d.attached)return;al(uL(_,d.value),l,5,[_])};return d.value=t,d.attached=cL(),d}function uL(t,l){if(Ri(l)){const d=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{d.call(t),t._stopped=!0},l.map(_=>T=>!T._stopped&&_&&_(T))}else return l}const Nw=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,dL=(t,l,d,_,T,C)=>{const P=T==="svg";l==="class"?QP(t,_,P):l==="style"?rL(t,d,_):o_(l)?db(l)||oL(t,l,d,_,C):(l[0]==="."?(l=l.slice(1),!0):l[0]==="^"?(l=l.slice(1),!1):fL(t,l,_,P))?(zw(t,l,_),!t.tagName.includes("-")&&(l==="value"||l==="checked"||l==="selected")&&Rw(t,l,_,P,C,l!=="value")):t._isVueCE&&(/[A-Z]/.test(l)||!Rn(_))?zw(t,Xs(l),_,C,l):(l==="true-value"?t._trueValue=_:l==="false-value"&&(t._falseValue=_),Rw(t,l,_,P))};function fL(t,l,d,_){if(_)return!!(l==="innerHTML"||l==="textContent"||l in t&&Nw(l)&&tr(d));if(l==="spellcheck"||l==="draggable"||l==="translate"||l==="form"||l==="list"&&t.tagName==="INPUT"||l==="type"&&t.tagName==="TEXTAREA")return!1;if(l==="width"||l==="height"){const T=t.tagName;if(T==="IMG"||T==="VIDEO"||T==="CANVAS"||T==="SOURCE")return!1}return Nw(l)&&Rn(d)?!1:l in t}const Uw={};/*! #__NO_SIDE_EFFECTS__ */function eC(t,l,d){const _=zn(t,l);dx(_)&&Sn(_,l);class T extends Px{constructor(P){super(_,P,d)}}return T.def=_,T}/*! #__NO_SIDE_EFFECTS__ */const pL=(t,l)=>eC(t,l,dC),mL=typeof HTMLElement<"u"?HTMLElement:class{};class Px extends mL{constructor(l,d={},_=Jg){super(),this._def=l,this._props=d,this._createApp=_,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&_!==Jg?this._root=this.shadowRoot:l.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let l=this;for(;l=l&&(l.parentNode||l.host);)if(l instanceof Px){this._parent=l;break}this._instance||(this._resolved?(this._setParent(),this._update()):l&&l._pendingResolve?this._pendingResolve=l._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(l=this._parent){l&&(this._instance.parent=l._instance,this._instance.provides=l._instance.provides)}disconnectedCallback(){this._connected=!1,Bf(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let _=0;_<this.attributes.length;_++)this._setAttr(this.attributes[_].name);this._ob=new MutationObserver(_=>{for(const T of _)this._setAttr(T.attributeName)}),this._ob.observe(this,{attributes:!0});const l=(_,T=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:C,styles:P}=_;let V;if(C&&!Ri(C))for(const s in C){const $=C[s];($===Number||$&&$.type===Number)&&(s in this._props&&(this._props[s]=Hy(this._props[s])),(V||(V=Object.create(null)))[Xs(s)]=!0)}this._numberProps=V,T&&this._resolveProps(_),this.shadowRoot&&this._applyStyles(P),this._mount(_)},d=this._def.__asyncLoader;d?this._pendingResolve=d().then(_=>l(this._def=_,!0)):l(this._def)}_mount(l){this._app=this._createApp(l),l.configureApp&&l.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const d=this._instance&&this._instance.exposed;if(d)for(const _ in d)rn(this,_)||Object.defineProperty(this,_,{get:()=>cn(d[_])})}_resolveProps(l){const{props:d}=l,_=Ri(d)?d:Object.keys(d||{});for(const T of Object.keys(this))T[0]!=="_"&&_.includes(T)&&this._setProp(T,this[T]);for(const T of _.map(Xs))Object.defineProperty(this,T,{get(){return this._getProp(T)},set(C){this._setProp(T,C,!0,!0)}})}_setAttr(l){if(l.startsWith("data-v-"))return;const d=this.hasAttribute(l);let _=d?this.getAttribute(l):Uw;const T=Xs(l);d&&this._numberProps&&this._numberProps[T]&&(_=Hy(_)),this._setProp(T,_,!1,!0)}_getProp(l){return this._props[l]}_setProp(l,d,_=!0,T=!1){if(d!==this._props[l]&&(d===Uw?delete this._props[l]:(this._props[l]=d,l==="key"&&this._app&&(this._app._ceVNode.key=d)),T&&this._instance&&this._update(),_)){const C=this._ob;C&&C.disconnect(),d===!0?this.setAttribute(la(l),""):typeof d=="string"||typeof d=="number"?this.setAttribute(la(l),d+""):d||this.removeAttribute(la(l)),C&&C.observe(this,{attributes:!0})}}_update(){uC(this._createVNode(),this._root)}_createVNode(){const l={};this.shadowRoot||(l.onVnodeMounted=l.onVnodeUpdated=this._renderSlots.bind(this));const d=pr(this._def,Sn(l,this._props));return this._instance||(d.ce=_=>{this._instance=_,_.ce=this,_.isCE=!0;const T=(C,P)=>{this.dispatchEvent(new CustomEvent(C,dx(P[0])?Sn({detail:P},P[0]):{detail:P}))};_.emit=(C,...P)=>{T(C,P),la(C)!==C&&T(la(C),P)},this._setParent()}),d}_applyStyles(l,d){if(!l)return;if(d){if(d===this._def||this._styleChildren.has(d))return;this._styleChildren.add(d)}const _=this._nonce;for(let T=l.length-1;T>=0;T--){const C=document.createElement("style");_&&C.setAttribute("nonce",_),C.textContent=l[T],this.shadowRoot.prepend(C)}}_parseSlots(){const l=this._slots={};let d;for(;d=this.firstChild;){const _=d.nodeType===1&&d.getAttribute("slot")||"default";(l[_]||(l[_]=[])).push(d),this.removeChild(d)}}_renderSlots(){const l=(this._teleportTarget||this).querySelectorAll("slot"),d=this._instance.type.__scopeId;for(let _=0;_<l.length;_++){const T=l[_],C=T.getAttribute("name")||"default",P=this._slots[C],V=T.parentNode;if(P)for(const s of P){if(d&&s.nodeType===1){const $=d+"-s",Z=document.createTreeWalker(s,1);s.setAttribute($,"");let J;for(;J=Z.nextNode();)J.setAttribute($,"")}V.insertBefore(s,T)}else for(;T.firstChild;)V.insertBefore(T.firstChild,T);V.removeChild(T)}}_injectChildStyle(l){this._applyStyles(l.styles,l)}_removeChildStyle(l){}}function tC(t){const l=Ys(),d=l&&l.ce;return d||null}function gL(){const t=tC();return t&&t.shadowRoot}function _L(t="$style"){{const l=Ys();if(!l)return Nr;const d=l.type.__cssModules;if(!d)return Nr;const _=d[t];return _||Nr}}const iC=new WeakMap,rC=new WeakMap,sx=Symbol("_moveCb"),Vw=Symbol("_enterCb"),yL=t=>(delete t.props.mode,t),xL=yL({name:"TransitionGroup",props:Sn({},XS,{tag:String,moveClass:String}),setup(t,{slots:l}){const d=Ys(),_=Sb();let T,C;return Cx(()=>{if(!T.length)return;const P=t.moveClass||`${t.name||"v"}-move`;if(!TL(T[0].el,d.vnode.el,P))return;T.forEach(vL),T.forEach(bL);const V=T.filter(wL);$0(),V.forEach(s=>{const $=s.el,Z=$.style;Ic($,P),Z.transform=Z.webkitTransform=Z.transitionDuration="";const J=$[sx]=ne=>{ne&&ne.target!==$||(!ne||/transform$/.test(ne.propertyName))&&($.removeEventListener("transitionend",J),$[sx]=null,Nu($,P))};$.addEventListener("transitionend",J)})}),()=>{const P=kr(t),V=ZS(P);let s=P.tag||$r;if(T=[],C)for(let $=0;$<C.length;$++){const Z=C[$];Z.el&&Z.el instanceof Element&&(T.push(Z),Ph(Z,nm(Z,V,_,d)),iC.set(Z,Z.el.getBoundingClientRect()))}C=l.default?Ex(l.default()):[];for(let $=0;$<C.length;$++){const Z=C[$];Z.key!=null&&Ph(Z,nm(Z,V,_,d))}return pr(s,null,C)}}}),nC=xL;function vL(t){const l=t.el;l[sx]&&l[sx](),l[Vw]&&l[Vw]()}function bL(t){rC.set(t,t.el.getBoundingClientRect())}function wL(t){const l=iC.get(t),d=rC.get(t),_=l.left-d.left,T=l.top-d.top;if(_||T){const C=t.el.style;return C.transform=C.webkitTransform=`translate(${_}px,${T}px)`,C.transitionDuration="0s",t}}function TL(t,l,d){const _=t.cloneNode(),T=t[om];T&&T.forEach(V=>{V.split(/\s+/).forEach(s=>s&&_.classList.remove(s))}),d.split(/\s+/).forEach(V=>V&&_.classList.add(V)),_.style.display="none";const C=l.nodeType===1?l:l.parentNode;C.appendChild(_);const{hasTransform:P}=YS(_);return C.removeChild(_),P}const Zu=t=>{const l=t.props["onUpdate:modelValue"]||!1;return Ri(l)?d=>tm(l,d):l};function EL(t){t.target.composing=!0}function jw(t){const l=t.target;l.composing&&(l.composing=!1,l.dispatchEvent(new Event("input")))}const ol=Symbol("_assign"),rl={created(t,{modifiers:{lazy:l,trim:d,number:_}},T){t[ol]=Zu(T);const C=_||T.props&&T.props.type==="number";Sh(t,l?"change":"input",P=>{if(P.target.composing)return;let V=t.value;d&&(V=V.trim()),C&&(V=Wy(V)),t[ol](V)}),d&&Sh(t,"change",()=>{t.value=t.value.trim()}),l||(Sh(t,"compositionstart",EL),Sh(t,"compositionend",jw),Sh(t,"change",jw))},mounted(t,{value:l}){t.value=l??""},beforeUpdate(t,{value:l,oldValue:d,modifiers:{lazy:_,trim:T,number:C}},P){if(t[ol]=Zu(P),t.composing)return;const V=(C||t.type==="number")&&!/^0\d/.test(t.value)?Wy(t.value):t.value,s=l??"";V!==s&&(document.activeElement===t&&t.type!=="range"&&(_&&l===d||T&&t.value.trim()===s)||(t.value=s))}},Fb={deep:!0,created(t,l,d){t[ol]=Zu(d),Sh(t,"change",()=>{const _=t._modelValue,T=am(t),C=t.checked,P=t[ol];if(Ri(_)){const V=mx(_,T),s=V!==-1;if(C&&!s)P(_.concat(T));else if(!C&&s){const $=[..._];$.splice(V,1),P($)}}else if(Rf(_)){const V=new Set(_);C?V.add(T):V.delete(T),P(V)}else P(sC(t,C))})},mounted:$w,beforeUpdate(t,l,d){t[ol]=Zu(d),$w(t,l,d)}};function $w(t,{value:l,oldValue:d},_){t._modelValue=l;let T;if(Ri(l))T=mx(l,_.props.value)>-1;else if(Rf(l))T=l.has(_.props.value);else{if(l===d)return;T=qu(l,sC(t,!0))}t.checked!==T&&(t.checked=T)}const Nb={created(t,{value:l},d){t.checked=qu(l,d.props.value),t[ol]=Zu(d),Sh(t,"change",()=>{t[ol](am(t))})},beforeUpdate(t,{value:l,oldValue:d},_){t[ol]=Zu(_),l!==d&&(t.checked=qu(l,_.props.value))}},Ch={deep:!0,created(t,{value:l,modifiers:{number:d}},_){const T=Rf(l);Sh(t,"change",()=>{const C=Array.prototype.filter.call(t.options,P=>P.selected).map(P=>d?Wy(am(P)):am(P));t[ol](t.multiple?T?new Set(C):C:C[0]),t._assigning=!0,Bf(()=>{t._assigning=!1})}),t[ol]=Zu(_)},mounted(t,{value:l}){Gw(t,l)},beforeUpdate(t,l,d){t[ol]=Zu(d)},updated(t,{value:l}){t._assigning||Gw(t,l)}};function Gw(t,l){const d=t.multiple,_=Ri(l);if(!(d&&!_&&!Rf(l))){for(let T=0,C=t.options.length;T<C;T++){const P=t.options[T],V=am(P);if(d)if(_){const s=typeof V;s==="string"||s==="number"?P.selected=l.some($=>String($)===String(V)):P.selected=mx(l,V)>-1}else P.selected=l.has(V);else if(qu(am(P),l)){t.selectedIndex!==T&&(t.selectedIndex=T);return}}!d&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function am(t){return"_value"in t?t._value:t.value}function sC(t,l){const d=l?"_trueValue":"_falseValue";return d in t?t[d]:l}const oC={created(t,l,d){Ly(t,l,d,null,"created")},mounted(t,l,d){Ly(t,l,d,null,"mounted")},beforeUpdate(t,l,d,_){Ly(t,l,d,_,"beforeUpdate")},updated(t,l,d,_){Ly(t,l,d,_,"updated")}};function aC(t,l){switch(t){case"SELECT":return Ch;case"TEXTAREA":return rl;default:switch(l){case"checkbox":return Fb;case"radio":return Nb;default:return rl}}}function Ly(t,l,d,_,T){const P=aC(t.tagName,d.props&&d.props.type)[T];P&&P(t,l,d,_)}function SL(){rl.getSSRProps=({value:t})=>({value:t}),Nb.getSSRProps=({value:t},l)=>{if(l.props&&qu(l.props.value,t))return{checked:!0}},Fb.getSSRProps=({value:t},l)=>{if(Ri(t)){if(l.props&&mx(t,l.props.value)>-1)return{checked:!0}}else if(Rf(t)){if(l.props&&t.has(l.props.value))return{checked:!0}}else if(t)return{checked:!0}},oC.getSSRProps=(t,l)=>{if(typeof l.type!="string")return;const d=aC(l.type.toUpperCase(),l.props&&l.props.type);if(d.getSSRProps)return d.getSSRProps(t,l)}}const CL=["ctrl","shift","alt","meta"],AL={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,l)=>CL.some(d=>t[`${d}Key`]&&!l.includes(d))},Kg=(t,l)=>{const d=t._withMods||(t._withMods={}),_=l.join(".");return d[_]||(d[_]=(T,...C)=>{for(let P=0;P<l.length;P++){const V=AL[l[P]];if(V&&V(T,l))return}return t(T,...C)})},ML={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},IL=(t,l)=>{const d=t._withKeys||(t._withKeys={}),_=l.join(".");return d[_]||(d[_]=T=>{if(!("key"in T))return;const C=la(T.key);if(l.some(P=>P===C||ML[P]===C))return t(T)})},lC=Sn({patchProp:dL},ZP);let Fg,Ww=!1;function cC(){return Fg||(Fg=wS(lC))}function hC(){return Fg=Ww?Fg:TS(lC),Ww=!0,Fg}const uC=(...t)=>{cC().render(...t)},kL=(...t)=>{hC().hydrate(...t)},Jg=(...t)=>{const l=cC().createApp(...t),{mount:d}=l;return l.mount=_=>{const T=pC(_);if(!T)return;const C=l._component;!tr(C)&&!C.render&&!C.template&&(C.template=T.innerHTML),T.nodeType===1&&(T.textContent="");const P=d(T,!1,fC(T));return T instanceof Element&&(T.removeAttribute("v-cloak"),T.setAttribute("data-v-app","")),P},l},dC=(...t)=>{const l=hC().createApp(...t),{mount:d}=l;return l.mount=_=>{const T=pC(_);if(T)return d(T,!0,fC(T))},l};function fC(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function pC(t){return Rn(t)?document.querySelector(t):t}let Hw=!1;const PL=()=>{Hw||(Hw=!0,SL(),eL())};/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const LL=()=>{},DL=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:KE,BaseTransitionPropsValidators:Cb,Comment:Ts,DeprecationTypes:HP,EffectScope:gb,ErrorCodes:ok,ErrorTypeStrings:NP,Fragment:$r,KeepAlive:Lk,ReactiveEffect:jg,Static:kf,Suspense:bP,Teleport:pk,Text:Ih,TrackOpTypes:QI,Transition:Bb,TransitionGroup:nC,TriggerOpTypes:ek,VueElement:Px,assertNumber:sk,callWithAsyncErrorHandling:al,callWithErrorHandling:pm,camelize:Xs,capitalize:a_,cloneVNode:Rc,compatUtils:WP,compile:LL,computed:fn,createApp:Jg,createBlock:No,createCommentVNode:En,createElementBlock:Pi,createElementVNode:lt,createHydrationRenderer:TS,createPropsRestProxy:Zk,createRenderer:wS,createSSRApp:dC,createSlots:zk,createStaticVNode:ex,createTextVNode:js,createVNode:pr,customRef:RE,defineAsyncComponent:kk,defineComponent:zn,defineCustomElement:eC,defineEmits:Nk,defineExpose:Uk,defineModel:$k,defineOptions:Vk,defineProps:Fk,defineSSRCustomElement:pL,defineSlots:jk,devtools:UP,effect:TI,effectScope:gx,getCurrentInstance:Ys,getCurrentScope:_b,getCurrentWatcher:tk,getTransitionRawChildren:Ex,guardReactiveProps:FS,h:mm,handleError:zf,hasInjectionContext:dS,hydrate:kL,hydrateOnIdle:Ek,hydrateOnInteraction:Mk,hydrateOnMediaQuery:Ak,hydrateOnVisible:Ck,initCustomFormatter:zP,initDirectivesForSSR:PL,inject:ca,isMemoSame:GS,isProxy:bx,isReactive:Ul,isReadonly:Xu,isRef:On,isRuntimeOnly:DP,isShallow:Fa,isVNode:Lh,markRaw:wx,mergeDefaults:qk,mergeModels:Xk,mergeProps:d_,nextTick:Bf,normalizeClass:Vs,normalizeProps:yI,normalizeStyle:zc,onActivated:QE,onBeforeMount:Mb,onBeforeUnmount:Ax,onBeforeUpdate:Ib,onDeactivated:eS,onErrorCaptured:sS,onMounted:Oh,onRenderTracked:nS,onRenderTriggered:rS,onScopeDispose:yE,onServerPrefetch:iS,onUnmounted:h_,onUpdated:Cx,onWatcherCleanup:NE,openBlock:_i,popScopeId:uk,provide:zg,proxyRefs:Tb,pushScopeId:hk,queuePostFlushCb:Wg,reactive:fm,readonly:wb,ref:Vi,registerRuntimeCompiler:LP,render:uC,renderList:Ba,renderSlot:aS,resolveComponent:Mh,resolveDirective:Rk,resolveDynamicComponent:Mx,resolveFilter:GP,resolveTransitionHooks:nm,setBlockTracking:z0,setDevtoolsHook:VP,setTransitionHooks:Ph,shallowReactive:bb,shallowReadonly:$I,shallowRef:l_,ssrContextKey:AS,ssrUtils:$P,stop:EI,toDisplayString:Vt,toHandlerKey:Pg,toHandlers:lS,toRaw:kr,toRef:BE,toRefs:zE,toValue:HI,transformVNodeArgs:AP,triggerRef:WI,unref:cn,useAttrs:Hk,useCssModule:_L,useCssVars:tL,useHost:tC,useId:gk,useModel:pP,useSSRContext:MS,useShadowRoot:gL,useSlots:Wk,useTemplateRef:_k,useTransitionState:Sb,vModelCheckbox:Fb,vModelDynamic:oC,vModelRadio:Nb,vModelSelect:Ch,vModelText:rl,vShow:JS,version:WS,warn:FP,watch:ha,watchEffect:uP,watchPostEffect:dP,watchSyncEffect:IS,withAsyncContext:Yk,withCtx:Us,withDefaults:Gk,withDirectives:fo,withKeys:IL,withMemo:BP,withModifiers:Kg,withScopeId:dk},Symbol.toStringTag,{value:"Module"})),Ub="/projects/soil_values/assets/DGIS_logo-BMUz1Rxj.webp",mC="/projects/soil_values/assets/logo-CicDM-h9.png";/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Xp=typeof document<"u";function gC(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function OL(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&gC(t.default)}const hn=Object.assign;function f0(t,l){const d={};for(const _ in l){const T=l[_];d[_]=jl(T)?T.map(t):t(T)}return d}const Ng=()=>{},jl=Array.isArray,_C=/#/g,RL=/&/g,zL=/\//g,BL=/=/g,FL=/\?/g,yC=/\+/g,NL=/%5B/g,UL=/%5D/g,xC=/%5E/g,VL=/%60/g,vC=/%7B/g,jL=/%7C/g,bC=/%7D/g,$L=/%20/g;function Vb(t){return encodeURI(""+t).replace(jL,"|").replace(NL,"[").replace(UL,"]")}function GL(t){return Vb(t).replace(vC,"{").replace(bC,"}").replace(xC,"^")}function W0(t){return Vb(t).replace(yC,"%2B").replace($L,"+").replace(_C,"%23").replace(RL,"%26").replace(VL,"`").replace(vC,"{").replace(bC,"}").replace(xC,"^")}function WL(t){return W0(t).replace(BL,"%3D")}function HL(t){return Vb(t).replace(_C,"%23").replace(FL,"%3F")}function qL(t){return t==null?"":HL(t).replace(zL,"%2F")}function Qg(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const XL=/\/$/,ZL=t=>t.replace(XL,"");function p0(t,l,d="/"){let _,T={},C="",P="";const V=l.indexOf("#");let s=l.indexOf("?");return V<s&&V>=0&&(s=-1),s>-1&&(_=l.slice(0,s),C=l.slice(s+1,V>-1?V:l.length),T=t(C)),V>-1&&(_=_||l.slice(0,V),P=l.slice(V,l.length)),_=QL(_??l,d),{fullPath:_+(C&&"?")+C+P,path:_,query:T,hash:Qg(P)}}function YL(t,l){const d=l.query?t(l.query):"";return l.path+(d&&"?")+d+(l.hash||"")}function qw(t,l){return!l||!t.toLowerCase().startsWith(l.toLowerCase())?t:t.slice(l.length)||"/"}function KL(t,l,d){const _=l.matched.length-1,T=d.matched.length-1;return _>-1&&_===T&&lm(l.matched[_],d.matched[T])&&wC(l.params,d.params)&&t(l.query)===t(d.query)&&l.hash===d.hash}function lm(t,l){return(t.aliasOf||t)===(l.aliasOf||l)}function wC(t,l){if(Object.keys(t).length!==Object.keys(l).length)return!1;for(const d in t)if(!JL(t[d],l[d]))return!1;return!0}function JL(t,l){return jl(t)?Xw(t,l):jl(l)?Xw(l,t):t===l}function Xw(t,l){return jl(l)?t.length===l.length&&t.every((d,_)=>d===l[_]):t.length===1&&t[0]===l}function QL(t,l){if(t.startsWith("/"))return t;if(!t)return l;const d=l.split("/"),_=t.split("/"),T=_[_.length-1];(T===".."||T===".")&&_.push("");let C=d.length-1,P,V;for(P=0;P<_.length;P++)if(V=_[P],V!==".")if(V==="..")C>1&&C--;else break;return d.slice(0,C).join("/")+"/"+_.slice(P).join("/")}const Bu={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var e_;(function(t){t.pop="pop",t.push="push"})(e_||(e_={}));var Ug;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Ug||(Ug={}));function eD(t){if(!t)if(Xp){const l=document.querySelector("base");t=l&&l.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),ZL(t)}const tD=/^[^#]+#/;function iD(t,l){return t.replace(tD,"#")+l}function rD(t,l){const d=document.documentElement.getBoundingClientRect(),_=t.getBoundingClientRect();return{behavior:l.behavior,left:_.left-d.left-(l.left||0),top:_.top-d.top-(l.top||0)}}const Lx=()=>({left:window.scrollX,top:window.scrollY});function nD(t){let l;if("el"in t){const d=t.el,_=typeof d=="string"&&d.startsWith("#"),T=typeof d=="string"?_?document.getElementById(d.slice(1)):document.querySelector(d):d;if(!T)return;l=rD(T,t)}else l=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(l):window.scrollTo(l.left!=null?l.left:window.scrollX,l.top!=null?l.top:window.scrollY)}function Zw(t,l){return(history.state?history.state.position-l:-1)+t}const H0=new Map;function sD(t,l){H0.set(t,l)}function oD(t){const l=H0.get(t);return H0.delete(t),l}let aD=()=>location.protocol+"//"+location.host;function TC(t,l){const{pathname:d,search:_,hash:T}=l,C=t.indexOf("#");if(C>-1){let V=T.includes(t.slice(C))?t.slice(C).length:1,s=T.slice(V);return s[0]!=="/"&&(s="/"+s),qw(s,"")}return qw(d,t)+_+T}function lD(t,l,d,_){let T=[],C=[],P=null;const V=({state:ne})=>{const ue=TC(t,location),we=d.value,Me=l.value;let Ye=0;if(ne){if(d.value=ue,l.value=ne,P&&P===we){P=null;return}Ye=Me?ne.position-Me.position:0}else _(ue);T.forEach(Ze=>{Ze(d.value,we,{delta:Ye,type:e_.pop,direction:Ye?Ye>0?Ug.forward:Ug.back:Ug.unknown})})};function s(){P=d.value}function $(ne){T.push(ne);const ue=()=>{const we=T.indexOf(ne);we>-1&&T.splice(we,1)};return C.push(ue),ue}function Z(){const{history:ne}=window;ne.state&&ne.replaceState(hn({},ne.state,{scroll:Lx()}),"")}function J(){for(const ne of C)ne();C=[],window.removeEventListener("popstate",V),window.removeEventListener("beforeunload",Z)}return window.addEventListener("popstate",V),window.addEventListener("beforeunload",Z,{passive:!0}),{pauseListeners:s,listen:$,destroy:J}}function Yw(t,l,d,_=!1,T=!1){return{back:t,current:l,forward:d,replaced:_,position:window.history.length,scroll:T?Lx():null}}function cD(t){const{history:l,location:d}=window,_={value:TC(t,d)},T={value:l.state};T.value||C(_.value,{back:null,current:_.value,forward:null,position:l.length-1,replaced:!0,scroll:null},!0);function C(s,$,Z){const J=t.indexOf("#"),ne=J>-1?(d.host&&document.querySelector("base")?t:t.slice(J))+s:aD()+t+s;try{l[Z?"replaceState":"pushState"]($,"",ne),T.value=$}catch(ue){console.error(ue),d[Z?"replace":"assign"](ne)}}function P(s,$){const Z=hn({},l.state,Yw(T.value.back,s,T.value.forward,!0),$,{position:T.value.position});C(s,Z,!0),_.value=s}function V(s,$){const Z=hn({},T.value,l.state,{forward:s,scroll:Lx()});C(Z.current,Z,!0);const J=hn({},Yw(_.value,s,null),{position:Z.position+1},$);C(s,J,!1),_.value=s}return{location:_,state:T,push:V,replace:P}}function hD(t){t=eD(t);const l=cD(t),d=lD(t,l.state,l.location,l.replace);function _(C,P=!0){P||d.pauseListeners(),history.go(C)}const T=hn({location:"",base:t,go:_,createHref:iD.bind(null,t)},l,d);return Object.defineProperty(T,"location",{enumerable:!0,get:()=>l.location.value}),Object.defineProperty(T,"state",{enumerable:!0,get:()=>l.state.value}),T}function uD(t){return typeof t=="string"||t&&typeof t=="object"}function EC(t){return typeof t=="string"||typeof t=="symbol"}const SC=Symbol("");var Kw;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Kw||(Kw={}));function cm(t,l){return hn(new Error,{type:t,[SC]:!0},l)}function xh(t,l){return t instanceof Error&&SC in t&&(l==null||!!(t.type&l))}const Jw="[^/]+?",dD={sensitive:!1,strict:!1,start:!0,end:!0},fD=/[.+*?^${}()[\]/\\]/g;function pD(t,l){const d=hn({},dD,l),_=[];let T=d.start?"^":"";const C=[];for(const $ of t){const Z=$.length?[]:[90];d.strict&&!$.length&&(T+="/");for(let J=0;J<$.length;J++){const ne=$[J];let ue=40+(d.sensitive?.25:0);if(ne.type===0)J||(T+="/"),T+=ne.value.replace(fD,"\\$&"),ue+=40;else if(ne.type===1){const{value:we,repeatable:Me,optional:Ye,regexp:Ze}=ne;C.push({name:we,repeatable:Me,optional:Ye});const je=Ze||Jw;if(je!==Jw){ue+=10;try{new RegExp(`(${je})`)}catch(ge){throw new Error(`Invalid custom RegExp for param "${we}" (${je}): `+ge.message)}}let ae=Me?`((?:${je})(?:/(?:${je}))*)`:`(${je})`;J||(ae=Ye&&$.length<2?`(?:/${ae})`:"/"+ae),Ye&&(ae+="?"),T+=ae,ue+=20,Ye&&(ue+=-8),Me&&(ue+=-20),je===".*"&&(ue+=-50)}Z.push(ue)}_.push(Z)}if(d.strict&&d.end){const $=_.length-1;_[$][_[$].length-1]+=.7000000000000001}d.strict||(T+="/?"),d.end?T+="$":d.strict&&!T.endsWith("/")&&(T+="(?:/|$)");const P=new RegExp(T,d.sensitive?"":"i");function V($){const Z=$.match(P),J={};if(!Z)return null;for(let ne=1;ne<Z.length;ne++){const ue=Z[ne]||"",we=C[ne-1];J[we.name]=ue&&we.repeatable?ue.split("/"):ue}return J}function s($){let Z="",J=!1;for(const ne of t){(!J||!Z.endsWith("/"))&&(Z+="/"),J=!1;for(const ue of ne)if(ue.type===0)Z+=ue.value;else if(ue.type===1){const{value:we,repeatable:Me,optional:Ye}=ue,Ze=we in $?$[we]:"";if(jl(Ze)&&!Me)throw new Error(`Provided param "${we}" is an array but it is not repeatable (* or + modifiers)`);const je=jl(Ze)?Ze.join("/"):Ze;if(!je)if(Ye)ne.length<2&&(Z.endsWith("/")?Z=Z.slice(0,-1):J=!0);else throw new Error(`Missing required param "${we}"`);Z+=je}}return Z||"/"}return{re:P,score:_,keys:C,parse:V,stringify:s}}function mD(t,l){let d=0;for(;d<t.length&&d<l.length;){const _=l[d]-t[d];if(_)return _;d++}return t.length<l.length?t.length===1&&t[0]===80?-1:1:t.length>l.length?l.length===1&&l[0]===80?1:-1:0}function CC(t,l){let d=0;const _=t.score,T=l.score;for(;d<_.length&&d<T.length;){const C=mD(_[d],T[d]);if(C)return C;d++}if(Math.abs(T.length-_.length)===1){if(Qw(_))return 1;if(Qw(T))return-1}return T.length-_.length}function Qw(t){const l=t[t.length-1];return t.length>0&&l[l.length-1]<0}const gD={type:0,value:""},_D=/[a-zA-Z0-9_]/;function yD(t){if(!t)return[[]];if(t==="/")return[[gD]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function l(ue){throw new Error(`ERR (${d})/"${$}": ${ue}`)}let d=0,_=d;const T=[];let C;function P(){C&&T.push(C),C=[]}let V=0,s,$="",Z="";function J(){$&&(d===0?C.push({type:0,value:$}):d===1||d===2||d===3?(C.length>1&&(s==="*"||s==="+")&&l(`A repeatable param (${$}) must be alone in its segment. eg: '/:ids+.`),C.push({type:1,value:$,regexp:Z,repeatable:s==="*"||s==="+",optional:s==="*"||s==="?"})):l("Invalid state to consume buffer"),$="")}function ne(){$+=s}for(;V<t.length;){if(s=t[V++],s==="\\"&&d!==2){_=d,d=4;continue}switch(d){case 0:s==="/"?($&&J(),P()):s===":"?(J(),d=1):ne();break;case 4:ne(),d=_;break;case 1:s==="("?d=2:_D.test(s)?ne():(J(),d=0,s!=="*"&&s!=="?"&&s!=="+"&&V--);break;case 2:s===")"?Z[Z.length-1]=="\\"?Z=Z.slice(0,-1)+s:d=3:Z+=s;break;case 3:J(),d=0,s!=="*"&&s!=="?"&&s!=="+"&&V--,Z="";break;default:l("Unknown state");break}}return d===2&&l(`Unfinished custom RegExp for param "${$}"`),J(),P(),T}function xD(t,l,d){const _=pD(yD(t.path),d),T=hn(_,{record:t,parent:l,children:[],alias:[]});return l&&!T.record.aliasOf==!l.record.aliasOf&&l.children.push(T),T}function vD(t,l){const d=[],_=new Map;l=rT({strict:!1,end:!0,sensitive:!1},l);function T(J){return _.get(J)}function C(J,ne,ue){const we=!ue,Me=tT(J);Me.aliasOf=ue&&ue.record;const Ye=rT(l,J),Ze=[Me];if("alias"in J){const ge=typeof J.alias=="string"?[J.alias]:J.alias;for(const Oe of ge)Ze.push(tT(hn({},Me,{components:ue?ue.record.components:Me.components,path:Oe,aliasOf:ue?ue.record:Me})))}let je,ae;for(const ge of Ze){const{path:Oe}=ge;if(ne&&Oe[0]!=="/"){const ze=ne.record.path,rt=ze[ze.length-1]==="/"?"":"/";ge.path=ne.record.path+(Oe&&rt+Oe)}if(je=xD(ge,ne,Ye),ue?ue.alias.push(je):(ae=ae||je,ae!==je&&ae.alias.push(je),we&&J.name&&!iT(je)&&P(J.name)),AC(je)&&s(je),Me.children){const ze=Me.children;for(let rt=0;rt<ze.length;rt++)C(ze[rt],je,ue&&ue.children[rt])}ue=ue||je}return ae?()=>{P(ae)}:Ng}function P(J){if(EC(J)){const ne=_.get(J);ne&&(_.delete(J),d.splice(d.indexOf(ne),1),ne.children.forEach(P),ne.alias.forEach(P))}else{const ne=d.indexOf(J);ne>-1&&(d.splice(ne,1),J.record.name&&_.delete(J.record.name),J.children.forEach(P),J.alias.forEach(P))}}function V(){return d}function s(J){const ne=TD(J,d);d.splice(ne,0,J),J.record.name&&!iT(J)&&_.set(J.record.name,J)}function $(J,ne){let ue,we={},Me,Ye;if("name"in J&&J.name){if(ue=_.get(J.name),!ue)throw cm(1,{location:J});Ye=ue.record.name,we=hn(eT(ne.params,ue.keys.filter(ae=>!ae.optional).concat(ue.parent?ue.parent.keys.filter(ae=>ae.optional):[]).map(ae=>ae.name)),J.params&&eT(J.params,ue.keys.map(ae=>ae.name))),Me=ue.stringify(we)}else if(J.path!=null)Me=J.path,ue=d.find(ae=>ae.re.test(Me)),ue&&(we=ue.parse(Me),Ye=ue.record.name);else{if(ue=ne.name?_.get(ne.name):d.find(ae=>ae.re.test(ne.path)),!ue)throw cm(1,{location:J,currentLocation:ne});Ye=ue.record.name,we=hn({},ne.params,J.params),Me=ue.stringify(we)}const Ze=[];let je=ue;for(;je;)Ze.unshift(je.record),je=je.parent;return{name:Ye,path:Me,params:we,matched:Ze,meta:wD(Ze)}}t.forEach(J=>C(J));function Z(){d.length=0,_.clear()}return{addRoute:C,resolve:$,removeRoute:P,clearRoutes:Z,getRoutes:V,getRecordMatcher:T}}function eT(t,l){const d={};for(const _ of l)_ in t&&(d[_]=t[_]);return d}function tT(t){const l={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:bD(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(l,"mods",{value:{}}),l}function bD(t){const l={},d=t.props||!1;if("component"in t)l.default=d;else for(const _ in t.components)l[_]=typeof d=="object"?d[_]:d;return l}function iT(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function wD(t){return t.reduce((l,d)=>hn(l,d.meta),{})}function rT(t,l){const d={};for(const _ in t)d[_]=_ in l?l[_]:t[_];return d}function TD(t,l){let d=0,_=l.length;for(;d!==_;){const C=d+_>>1;CC(t,l[C])<0?_=C:d=C+1}const T=ED(t);return T&&(_=l.lastIndexOf(T,_-1)),_}function ED(t){let l=t;for(;l=l.parent;)if(AC(l)&&CC(t,l)===0)return l}function AC({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function SD(t){const l={};if(t===""||t==="?")return l;const _=(t[0]==="?"?t.slice(1):t).split("&");for(let T=0;T<_.length;++T){const C=_[T].replace(yC," "),P=C.indexOf("="),V=Qg(P<0?C:C.slice(0,P)),s=P<0?null:Qg(C.slice(P+1));if(V in l){let $=l[V];jl($)||($=l[V]=[$]),$.push(s)}else l[V]=s}return l}function nT(t){let l="";for(let d in t){const _=t[d];if(d=WL(d),_==null){_!==void 0&&(l+=(l.length?"&":"")+d);continue}(jl(_)?_.map(C=>C&&W0(C)):[_&&W0(_)]).forEach(C=>{C!==void 0&&(l+=(l.length?"&":"")+d,C!=null&&(l+="="+C))})}return l}function CD(t){const l={};for(const d in t){const _=t[d];_!==void 0&&(l[d]=jl(_)?_.map(T=>T==null?null:""+T):_==null?_:""+_)}return l}const AD=Symbol(""),sT=Symbol(""),Dx=Symbol(""),jb=Symbol(""),q0=Symbol("");function Cg(){let t=[];function l(_){return t.push(_),()=>{const T=t.indexOf(_);T>-1&&t.splice(T,1)}}function d(){t=[]}return{add:l,list:()=>t.slice(),reset:d}}function Wu(t,l,d,_,T,C=P=>P()){const P=_&&(_.enterCallbacks[T]=_.enterCallbacks[T]||[]);return()=>new Promise((V,s)=>{const $=ne=>{ne===!1?s(cm(4,{from:d,to:l})):ne instanceof Error?s(ne):uD(ne)?s(cm(2,{from:l,to:ne})):(P&&_.enterCallbacks[T]===P&&typeof ne=="function"&&P.push(ne),V())},Z=C(()=>t.call(_&&_.instances[T],l,d,$));let J=Promise.resolve(Z);t.length<3&&(J=J.then($)),J.catch(ne=>s(ne))})}function m0(t,l,d,_,T=C=>C()){const C=[];for(const P of t)for(const V in P.components){let s=P.components[V];if(!(l!=="beforeRouteEnter"&&!P.instances[V]))if(gC(s)){const Z=(s.__vccOpts||s)[l];Z&&C.push(Wu(Z,d,_,P,V,T))}else{let $=s();C.push(()=>$.then(Z=>{if(!Z)throw new Error(`Couldn't resolve component "${V}" at "${P.path}"`);const J=OL(Z)?Z.default:Z;P.mods[V]=Z,P.components[V]=J;const ue=(J.__vccOpts||J)[l];return ue&&Wu(ue,d,_,P,V,T)()}))}}return C}function oT(t){const l=ca(Dx),d=ca(jb),_=fn(()=>{const s=cn(t.to);return l.resolve(s)}),T=fn(()=>{const{matched:s}=_.value,{length:$}=s,Z=s[$-1],J=d.matched;if(!Z||!J.length)return-1;const ne=J.findIndex(lm.bind(null,Z));if(ne>-1)return ne;const ue=aT(s[$-2]);return $>1&&aT(Z)===ue&&J[J.length-1].path!==ue?J.findIndex(lm.bind(null,s[$-2])):ne}),C=fn(()=>T.value>-1&&LD(d.params,_.value.params)),P=fn(()=>T.value>-1&&T.value===d.matched.length-1&&wC(d.params,_.value.params));function V(s={}){if(PD(s)){const $=l[cn(t.replace)?"replace":"push"](cn(t.to)).catch(Ng);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>$),$}return Promise.resolve()}return{route:_,href:fn(()=>_.value.href),isActive:C,isExactActive:P,navigate:V}}function MD(t){return t.length===1?t[0]:t}const ID=zn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:oT,setup(t,{slots:l}){const d=fm(oT(t)),{options:_}=ca(Dx),T=fn(()=>({[lT(t.activeClass,_.linkActiveClass,"router-link-active")]:d.isActive,[lT(t.exactActiveClass,_.linkExactActiveClass,"router-link-exact-active")]:d.isExactActive}));return()=>{const C=l.default&&MD(l.default(d));return t.custom?C:mm("a",{"aria-current":d.isExactActive?t.ariaCurrentValue:null,href:d.href,onClick:d.navigate,class:T.value},C)}}}),kD=ID;function PD(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const l=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(l))return}return t.preventDefault&&t.preventDefault(),!0}}function LD(t,l){for(const d in l){const _=l[d],T=t[d];if(typeof _=="string"){if(_!==T)return!1}else if(!jl(T)||T.length!==_.length||_.some((C,P)=>C!==T[P]))return!1}return!0}function aT(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const lT=(t,l,d)=>t??l??d,DD=zn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:l,slots:d}){const _=ca(q0),T=fn(()=>t.route||_.value),C=ca(sT,0),P=fn(()=>{let $=cn(C);const{matched:Z}=T.value;let J;for(;(J=Z[$])&&!J.components;)$++;return $}),V=fn(()=>T.value.matched[P.value]);zg(sT,fn(()=>P.value+1)),zg(AD,V),zg(q0,T);const s=Vi();return ha(()=>[s.value,V.value,t.name],([$,Z,J],[ne,ue,we])=>{Z&&(Z.instances[J]=$,ue&&ue!==Z&&$&&$===ne&&(Z.leaveGuards.size||(Z.leaveGuards=ue.leaveGuards),Z.updateGuards.size||(Z.updateGuards=ue.updateGuards))),$&&Z&&(!ue||!lm(Z,ue)||!ne)&&(Z.enterCallbacks[J]||[]).forEach(Me=>Me($))},{flush:"post"}),()=>{const $=T.value,Z=t.name,J=V.value,ne=J&&J.components[Z];if(!ne)return cT(d.default,{Component:ne,route:$});const ue=J.props[Z],we=ue?ue===!0?$.params:typeof ue=="function"?ue($):ue:null,Ye=mm(ne,hn({},we,l,{onVnodeUnmounted:Ze=>{Ze.component.isUnmounted&&(J.instances[Z]=null)},ref:s}));return cT(d.default,{Component:Ye,route:$})||Ye}}});function cT(t,l){if(!t)return null;const d=t(l);return d.length===1?d[0]:d}const OD=DD;function RD(t){const l=vD(t.routes,t),d=t.parseQuery||SD,_=t.stringifyQuery||nT,T=t.history,C=Cg(),P=Cg(),V=Cg(),s=l_(Bu);let $=Bu;Xp&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const Z=f0.bind(null,zt=>""+zt),J=f0.bind(null,qL),ne=f0.bind(null,Qg);function ue(zt,mi){let si,Ei;return EC(zt)?(si=l.getRecordMatcher(zt),Ei=mi):Ei=zt,l.addRoute(Ei,si)}function we(zt){const mi=l.getRecordMatcher(zt);mi&&l.removeRoute(mi)}function Me(){return l.getRoutes().map(zt=>zt.record)}function Ye(zt){return!!l.getRecordMatcher(zt)}function Ze(zt,mi){if(mi=hn({},mi||s.value),typeof zt=="string"){const ve=p0(d,zt,mi.path),nt=l.resolve({path:ve.path},mi),Lt=T.createHref(ve.fullPath);return hn(ve,nt,{params:ne(nt.params),hash:Qg(ve.hash),redirectedFrom:void 0,href:Lt})}let si;if(zt.path!=null)si=hn({},zt,{path:p0(d,zt.path,mi.path).path});else{const ve=hn({},zt.params);for(const nt in ve)ve[nt]==null&&delete ve[nt];si=hn({},zt,{params:J(ve)}),mi.params=J(mi.params)}const Ei=l.resolve(si,mi),or=zt.hash||"";Ei.params=Z(ne(Ei.params));const Si=YL(_,hn({},zt,{hash:GL(or),path:Ei.path})),xe=T.createHref(Si);return hn({fullPath:Si,hash:or,query:_===nT?CD(zt.query):zt.query||{}},Ei,{redirectedFrom:void 0,href:xe})}function je(zt){return typeof zt=="string"?p0(d,zt,s.value.path):hn({},zt)}function ae(zt,mi){if($!==zt)return cm(8,{from:mi,to:zt})}function ge(zt){return rt(zt)}function Oe(zt){return ge(hn(je(zt),{replace:!0}))}function ze(zt){const mi=zt.matched[zt.matched.length-1];if(mi&&mi.redirect){const{redirect:si}=mi;let Ei=typeof si=="function"?si(zt):si;return typeof Ei=="string"&&(Ei=Ei.includes("?")||Ei.includes("#")?Ei=je(Ei):{path:Ei},Ei.params={}),hn({query:zt.query,hash:zt.hash,params:Ei.path!=null?{}:zt.params},Ei)}}function rt(zt,mi){const si=$=Ze(zt),Ei=s.value,or=zt.state,Si=zt.force,xe=zt.replace===!0,ve=ze(si);if(ve)return rt(hn(je(ve),{state:typeof ve=="object"?hn({},or,ve.state):or,force:Si,replace:xe}),mi||si);const nt=si;nt.redirectedFrom=mi;let Lt;return!Si&&KL(_,Ei,si)&&(Lt=cm(16,{to:nt,from:Ei}),ir(Ei,Ei,!0,!1)),(Lt?Promise.resolve(Lt):He(nt,Ei)).catch(At=>xh(At)?xh(At,2)?At:Lr(At):xi(At,nt,Ei)).then(At=>{if(At){if(xh(At,2))return rt(hn({replace:xe},je(At.to),{state:typeof At.to=="object"?hn({},or,At.to.state):or,force:Si}),mi||nt)}else At=bt(nt,Ei,!0,xe,or);return ri(nt,Ei,At),At})}function ke(zt,mi){const si=ae(zt,mi);return si?Promise.reject(si):Promise.resolve()}function Ke(zt){const mi=fr.values().next().value;return mi&&typeof mi.runWithContext=="function"?mi.runWithContext(zt):zt()}function He(zt,mi){let si;const[Ei,or,Si]=zD(zt,mi);si=m0(Ei.reverse(),"beforeRouteLeave",zt,mi);for(const ve of Ei)ve.leaveGuards.forEach(nt=>{si.push(Wu(nt,zt,mi))});const xe=ke.bind(null,zt,mi);return si.push(xe),sn(si).then(()=>{si=[];for(const ve of C.list())si.push(Wu(ve,zt,mi));return si.push(xe),sn(si)}).then(()=>{si=m0(or,"beforeRouteUpdate",zt,mi);for(const ve of or)ve.updateGuards.forEach(nt=>{si.push(Wu(nt,zt,mi))});return si.push(xe),sn(si)}).then(()=>{si=[];for(const ve of Si)if(ve.beforeEnter)if(jl(ve.beforeEnter))for(const nt of ve.beforeEnter)si.push(Wu(nt,zt,mi));else si.push(Wu(ve.beforeEnter,zt,mi));return si.push(xe),sn(si)}).then(()=>(zt.matched.forEach(ve=>ve.enterCallbacks={}),si=m0(Si,"beforeRouteEnter",zt,mi,Ke),si.push(xe),sn(si))).then(()=>{si=[];for(const ve of P.list())si.push(Wu(ve,zt,mi));return si.push(xe),sn(si)}).catch(ve=>xh(ve,8)?ve:Promise.reject(ve))}function ri(zt,mi,si){V.list().forEach(Ei=>Ke(()=>Ei(zt,mi,si)))}function bt(zt,mi,si,Ei,or){const Si=ae(zt,mi);if(Si)return Si;const xe=mi===Bu,ve=Xp?history.state:{};si&&(Ei||xe?T.replace(zt.fullPath,hn({scroll:xe&&ve&&ve.scroll},or)):T.push(zt.fullPath,or)),s.value=zt,ir(zt,mi,si,xe),Lr()}let dt;function kt(){dt||(dt=T.listen((zt,mi,si)=>{if(!Bn.listening)return;const Ei=Ze(zt),or=ze(Ei);if(or){rt(hn(or,{replace:!0,force:!0}),Ei).catch(Ng);return}$=Ei;const Si=s.value;Xp&&sD(Zw(Si.fullPath,si.delta),Lx()),He(Ei,Si).catch(xe=>xh(xe,12)?xe:xh(xe,2)?(rt(hn(je(xe.to),{force:!0}),Ei).then(ve=>{xh(ve,20)&&!si.delta&&si.type===e_.pop&&T.go(-1,!1)}).catch(Ng),Promise.reject()):(si.delta&&T.go(-si.delta,!1),xi(xe,Ei,Si))).then(xe=>{xe=xe||bt(Ei,Si,!1),xe&&(si.delta&&!xh(xe,8)?T.go(-si.delta,!1):si.type===e_.pop&&xh(xe,20)&&T.go(-1,!1)),ri(Ei,Si,xe)}).catch(Ng)}))}let Pt=Cg(),vt=Cg(),ci;function xi(zt,mi,si){Lr(zt);const Ei=vt.list();return Ei.length?Ei.forEach(or=>or(zt,mi,si)):console.error(zt),Promise.reject(zt)}function vi(){return ci&&s.value!==Bu?Promise.resolve():new Promise((zt,mi)=>{Pt.add([zt,mi])})}function Lr(zt){return ci||(ci=!zt,kt(),Pt.list().forEach(([mi,si])=>zt?si(zt):mi()),Pt.reset()),zt}function ir(zt,mi,si,Ei){const{scrollBehavior:or}=t;if(!Xp||!or)return Promise.resolve();const Si=!si&&oD(Zw(zt.fullPath,0))||(Ei||!si)&&history.state&&history.state.scroll||null;return Bf().then(()=>or(zt,mi,Si)).then(xe=>xe&&nD(xe)).catch(xe=>xi(xe,zt,mi))}const sr=zt=>T.go(zt);let nn;const fr=new Set,Bn={currentRoute:s,listening:!0,addRoute:ue,removeRoute:we,clearRoutes:l.clearRoutes,hasRoute:Ye,getRoutes:Me,resolve:Ze,options:t,push:ge,replace:Oe,go:sr,back:()=>sr(-1),forward:()=>sr(1),beforeEach:C.add,beforeResolve:P.add,afterEach:V.add,onError:vt.add,isReady:vi,install(zt){const mi=this;zt.component("RouterLink",kD),zt.component("RouterView",OD),zt.config.globalProperties.$router=mi,Object.defineProperty(zt.config.globalProperties,"$route",{enumerable:!0,get:()=>cn(s)}),Xp&&!nn&&s.value===Bu&&(nn=!0,ge(T.location).catch(or=>{}));const si={};for(const or in Bu)Object.defineProperty(si,or,{get:()=>s.value[or],enumerable:!0});zt.provide(Dx,mi),zt.provide(jb,bb(si)),zt.provide(q0,s);const Ei=zt.unmount;fr.add(zt),zt.unmount=function(){fr.delete(zt),fr.size<1&&($=Bu,dt&&dt(),dt=null,s.value=Bu,nn=!1,ci=!1),Ei()}}};function sn(zt){return zt.reduce((mi,si)=>mi.then(()=>Ke(si)),Promise.resolve())}return Bn}function zD(t,l){const d=[],_=[],T=[],C=Math.max(l.matched.length,t.matched.length);for(let P=0;P<C;P++){const V=l.matched[P];V&&(t.matched.find($=>lm($,V))?_.push(V):d.push(V));const s=t.matched[P];s&&(l.matched.find($=>lm($,s))||T.push(s))}return[d,_,T]}function MC(){return ca(Dx)}function BD(t){return ca(jb)}/*!
  * shared v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function FD(t,l){typeof console<"u"&&(console.warn("[intlify] "+t),l&&console.warn(l.stack))}const ox=typeof window<"u",Qu=(t,l=!1)=>l?Symbol.for(t):Symbol(t),ND=(t,l,d)=>UD({l:t,k:l,s:d}),UD=t=>JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),hs=t=>typeof t=="number"&&isFinite(t),VD=t=>kC(t)==="[object Date]",Yu=t=>kC(t)==="[object RegExp]",Ox=t=>ur(t)&&Object.keys(t).length===0,Zs=Object.assign,jD=Object.create,gn=(t=null)=>jD(t);let hT;const Ah=()=>hT||(hT=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:gn());function uT(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2F;").replace(/=/g,"&#x3D;")}function dT(t){return t.replace(/&(?![a-zA-Z0-9#]{2,6};)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function $D(t){return t=t.replace(/(\w+)\s*=\s*"([^"]*)"/g,(_,T,C)=>`${T}="${dT(C)}"`),t=t.replace(/(\w+)\s*=\s*'([^']*)'/g,(_,T,C)=>`${T}='${dT(C)}'`),/\s*on\w+\s*=\s*["']?[^"'>]+["']?/gi.test(t)&&(t=t.replace(/(\s+)(on)(\w+\s*=)/gi,"$1&#111;n$3")),[/(\s+(?:href|src|action|formaction)\s*=\s*["']?)\s*javascript:/gi,/(style\s*=\s*["'][^"']*url\s*\(\s*)javascript:/gi].forEach(_=>{t=t.replace(_,"$1javascript&#58;")}),t}const GD=Object.prototype.hasOwnProperty;function zl(t,l){return GD.call(t,l)}const $n=Array.isArray,Dn=t=>typeof t=="function",Ci=t=>typeof t=="string",Cr=t=>typeof t=="boolean",Xr=t=>t!==null&&typeof t=="object",WD=t=>Xr(t)&&Dn(t.then)&&Dn(t.catch),IC=Object.prototype.toString,kC=t=>IC.call(t),ur=t=>{if(!Xr(t))return!1;const l=Object.getPrototypeOf(t);return l===null||l.constructor===Object},HD=t=>t==null?"":$n(t)||ur(t)&&t.toString===IC?JSON.stringify(t,null,2):String(t);function qD(t,l=""){return t.reduce((d,_,T)=>T===0?d+_:d+l+_,"")}function Rx(t){let l=t;return()=>++l}const Dy=t=>!Xr(t)||$n(t);function Ny(t,l){if(Dy(t)||Dy(l))throw new Error("Invalid value");const d=[{src:t,des:l}];for(;d.length;){const{src:_,des:T}=d.pop();Object.keys(_).forEach(C=>{C!=="__proto__"&&(Xr(_[C])&&!Xr(T[C])&&(T[C]=Array.isArray(_[C])?[]:gn()),Dy(T[C])||Dy(_[C])?T[C]=_[C]:d.push({src:_[C],des:T[C]}))})}}/*!
  * message-compiler v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function XD(t,l,d){return{line:t,column:l,offset:d}}function ax(t,l,d){return{start:t,end:l}}const ZD=/\{([0-9a-zA-Z]+)\}/g;function PC(t,...l){return l.length===1&&YD(l[0])&&(l=l[0]),(!l||!l.hasOwnProperty)&&(l={}),t.replace(ZD,(d,_)=>l.hasOwnProperty(_)?l[_]:"")}const LC=Object.assign,fT=t=>typeof t=="string",YD=t=>t!==null&&typeof t=="object";function DC(t,l=""){return t.reduce((d,_,T)=>T===0?d+_:d+l+_,"")}const $b={USE_MODULO_SYNTAX:1,__EXTEND_POINT__:2},KD={[$b.USE_MODULO_SYNTAX]:"Use modulo before '{{0}}'."};function JD(t,l,...d){const _=PC(KD[t],...d||[]),T={message:String(_),code:t};return l&&(T.location=l),T}const nr={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,UNHANDLED_CODEGEN_NODE_TYPE:15,UNHANDLED_MINIFIER_NODE_TYPE:16,__EXTEND_POINT__:17},QD={[nr.EXPECTED_TOKEN]:"Expected token: '{0}'",[nr.INVALID_TOKEN_IN_PLACEHOLDER]:"Invalid token in placeholder: '{0}'",[nr.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER]:"Unterminated single quote in placeholder",[nr.UNKNOWN_ESCAPE_SEQUENCE]:"Unknown escape sequence: \\{0}",[nr.INVALID_UNICODE_ESCAPE_SEQUENCE]:"Invalid unicode escape sequence: {0}",[nr.UNBALANCED_CLOSING_BRACE]:"Unbalanced closing brace",[nr.UNTERMINATED_CLOSING_BRACE]:"Unterminated closing brace",[nr.EMPTY_PLACEHOLDER]:"Empty placeholder",[nr.NOT_ALLOW_NEST_PLACEHOLDER]:"Not allowed nest placeholder",[nr.INVALID_LINKED_FORMAT]:"Invalid linked format",[nr.MUST_HAVE_MESSAGES_IN_PLURAL]:"Plural must have messages",[nr.UNEXPECTED_EMPTY_LINKED_MODIFIER]:"Unexpected empty linked modifier",[nr.UNEXPECTED_EMPTY_LINKED_KEY]:"Unexpected empty linked key",[nr.UNEXPECTED_LEXICAL_ANALYSIS]:"Unexpected lexical analysis in token: '{0}'",[nr.UNHANDLED_CODEGEN_NODE_TYPE]:"unhandled codegen node type: '{0}'",[nr.UNHANDLED_MINIFIER_NODE_TYPE]:"unhandled mimifier node type: '{0}'"};function gm(t,l,d={}){const{domain:_,messages:T,args:C}=d,P=PC((T||QD)[t]||"",...C||[]),V=new SyntaxError(String(P));return V.code=t,l&&(V.location=l),V.domain=_,V}function eO(t){throw t}const vh=" ",tO="\r",Ro=`
`,iO="\u2028",rO="\u2029";function nO(t){const l=t;let d=0,_=1,T=1,C=0;const P=rt=>l[rt]===tO&&l[rt+1]===Ro,V=rt=>l[rt]===Ro,s=rt=>l[rt]===rO,$=rt=>l[rt]===iO,Z=rt=>P(rt)||V(rt)||s(rt)||$(rt),J=()=>d,ne=()=>_,ue=()=>T,we=()=>C,Me=rt=>P(rt)||s(rt)||$(rt)?Ro:l[rt],Ye=()=>Me(d),Ze=()=>Me(d+C);function je(){return C=0,Z(d)&&(_++,T=0),P(d)&&d++,d++,T++,l[d]}function ae(){return P(d+C)&&C++,C++,l[d+C]}function ge(){d=0,_=1,T=1,C=0}function Oe(rt=0){C=rt}function ze(){const rt=d+C;for(;rt!==d;)je();C=0}return{index:J,line:ne,column:ue,peekOffset:we,charAt:Me,currentChar:Ye,currentPeek:Ze,next:je,peek:ae,reset:ge,resetPeek:Oe,skipToPeek:ze}}const Fu=void 0,sO=".",pT="'",oO="tokenizer";function aO(t,l={}){const d=l.location!==!1,_=nO(t),T=()=>_.index(),C=()=>XD(_.line(),_.column(),_.index()),P=C(),V=T(),s={currentType:14,offset:V,startLoc:P,endLoc:P,lastType:14,lastOffset:V,lastStartLoc:P,lastEndLoc:P,braceNest:0,inLinked:!1,text:""},$=()=>s,{onError:Z}=l;function J(Te,Ae,Qe,...Wt){const Ht=$();if(Ae.column+=Qe,Ae.offset+=Qe,Z){const Kt=d?ax(Ht.startLoc,Ae):null,ut=gm(Te,Kt,{domain:oO,args:Wt});Z(ut)}}function ne(Te,Ae,Qe){Te.endLoc=C(),Te.currentType=Ae;const Wt={type:Ae};return d&&(Wt.loc=ax(Te.startLoc,Te.endLoc)),Qe!=null&&(Wt.value=Qe),Wt}const ue=Te=>ne(Te,14);function we(Te,Ae){return Te.currentChar()===Ae?(Te.next(),Ae):(J(nr.EXPECTED_TOKEN,C(),0,Ae),"")}function Me(Te){let Ae="";for(;Te.currentPeek()===vh||Te.currentPeek()===Ro;)Ae+=Te.currentPeek(),Te.peek();return Ae}function Ye(Te){const Ae=Me(Te);return Te.skipToPeek(),Ae}function Ze(Te){if(Te===Fu)return!1;const Ae=Te.charCodeAt(0);return Ae>=97&&Ae<=122||Ae>=65&&Ae<=90||Ae===95}function je(Te){if(Te===Fu)return!1;const Ae=Te.charCodeAt(0);return Ae>=48&&Ae<=57}function ae(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==2)return!1;Me(Te);const Wt=Ze(Te.currentPeek());return Te.resetPeek(),Wt}function ge(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==2)return!1;Me(Te);const Wt=Te.currentPeek()==="-"?Te.peek():Te.currentPeek(),Ht=je(Wt);return Te.resetPeek(),Ht}function Oe(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==2)return!1;Me(Te);const Wt=Te.currentPeek()===pT;return Te.resetPeek(),Wt}function ze(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==8)return!1;Me(Te);const Wt=Te.currentPeek()===".";return Te.resetPeek(),Wt}function rt(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==9)return!1;Me(Te);const Wt=Ze(Te.currentPeek());return Te.resetPeek(),Wt}function ke(Te,Ae){const{currentType:Qe}=Ae;if(!(Qe===8||Qe===12))return!1;Me(Te);const Wt=Te.currentPeek()===":";return Te.resetPeek(),Wt}function Ke(Te,Ae){const{currentType:Qe}=Ae;if(Qe!==10)return!1;const Wt=()=>{const Kt=Te.currentPeek();return Kt==="{"?Ze(Te.peek()):Kt==="@"||Kt==="%"||Kt==="|"||Kt===":"||Kt==="."||Kt===vh||!Kt?!1:Kt===Ro?(Te.peek(),Wt()):bt(Te,!1)},Ht=Wt();return Te.resetPeek(),Ht}function He(Te){Me(Te);const Ae=Te.currentPeek()==="|";return Te.resetPeek(),Ae}function ri(Te){const Ae=Me(Te),Qe=Te.currentPeek()==="%"&&Te.peek()==="{";return Te.resetPeek(),{isModulo:Qe,hasSpace:Ae.length>0}}function bt(Te,Ae=!0){const Qe=(Ht=!1,Kt="",ut=!1)=>{const It=Te.currentPeek();return It==="{"?Kt==="%"?!1:Ht:It==="@"||!It?Kt==="%"?!0:Ht:It==="%"?(Te.peek(),Qe(Ht,"%",!0)):It==="|"?Kt==="%"||ut?!0:!(Kt===vh||Kt===Ro):It===vh?(Te.peek(),Qe(!0,vh,ut)):It===Ro?(Te.peek(),Qe(!0,Ro,ut)):!0},Wt=Qe();return Ae&&Te.resetPeek(),Wt}function dt(Te,Ae){const Qe=Te.currentChar();return Qe===Fu?Fu:Ae(Qe)?(Te.next(),Qe):null}function kt(Te){const Ae=Te.charCodeAt(0);return Ae>=97&&Ae<=122||Ae>=65&&Ae<=90||Ae>=48&&Ae<=57||Ae===95||Ae===36}function Pt(Te){return dt(Te,kt)}function vt(Te){const Ae=Te.charCodeAt(0);return Ae>=97&&Ae<=122||Ae>=65&&Ae<=90||Ae>=48&&Ae<=57||Ae===95||Ae===36||Ae===45}function ci(Te){return dt(Te,vt)}function xi(Te){const Ae=Te.charCodeAt(0);return Ae>=48&&Ae<=57}function vi(Te){return dt(Te,xi)}function Lr(Te){const Ae=Te.charCodeAt(0);return Ae>=48&&Ae<=57||Ae>=65&&Ae<=70||Ae>=97&&Ae<=102}function ir(Te){return dt(Te,Lr)}function sr(Te){let Ae="",Qe="";for(;Ae=vi(Te);)Qe+=Ae;return Qe}function nn(Te){Ye(Te);const Ae=Te.currentChar();return Ae!=="%"&&J(nr.EXPECTED_TOKEN,C(),0,Ae),Te.next(),"%"}function fr(Te){let Ae="";for(;;){const Qe=Te.currentChar();if(Qe==="{"||Qe==="}"||Qe==="@"||Qe==="|"||!Qe)break;if(Qe==="%")if(bt(Te))Ae+=Qe,Te.next();else break;else if(Qe===vh||Qe===Ro)if(bt(Te))Ae+=Qe,Te.next();else{if(He(Te))break;Ae+=Qe,Te.next()}else Ae+=Qe,Te.next()}return Ae}function Bn(Te){Ye(Te);let Ae="",Qe="";for(;Ae=ci(Te);)Qe+=Ae;return Te.currentChar()===Fu&&J(nr.UNTERMINATED_CLOSING_BRACE,C(),0),Qe}function sn(Te){Ye(Te);let Ae="";return Te.currentChar()==="-"?(Te.next(),Ae+=`-${sr(Te)}`):Ae+=sr(Te),Te.currentChar()===Fu&&J(nr.UNTERMINATED_CLOSING_BRACE,C(),0),Ae}function zt(Te){return Te!==pT&&Te!==Ro}function mi(Te){Ye(Te),we(Te,"'");let Ae="",Qe="";for(;Ae=dt(Te,zt);)Ae==="\\"?Qe+=si(Te):Qe+=Ae;const Wt=Te.currentChar();return Wt===Ro||Wt===Fu?(J(nr.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,C(),0),Wt===Ro&&(Te.next(),we(Te,"'")),Qe):(we(Te,"'"),Qe)}function si(Te){const Ae=Te.currentChar();switch(Ae){case"\\":case"'":return Te.next(),`\\${Ae}`;case"u":return Ei(Te,Ae,4);case"U":return Ei(Te,Ae,6);default:return J(nr.UNKNOWN_ESCAPE_SEQUENCE,C(),0,Ae),""}}function Ei(Te,Ae,Qe){we(Te,Ae);let Wt="";for(let Ht=0;Ht<Qe;Ht++){const Kt=ir(Te);if(!Kt){J(nr.INVALID_UNICODE_ESCAPE_SEQUENCE,C(),0,`\\${Ae}${Wt}${Te.currentChar()}`);break}Wt+=Kt}return`\\${Ae}${Wt}`}function or(Te){return Te!=="{"&&Te!=="}"&&Te!==vh&&Te!==Ro}function Si(Te){Ye(Te);let Ae="",Qe="";for(;Ae=dt(Te,or);)Qe+=Ae;return Qe}function xe(Te){let Ae="",Qe="";for(;Ae=Pt(Te);)Qe+=Ae;return Qe}function ve(Te){const Ae=Qe=>{const Wt=Te.currentChar();return Wt==="{"||Wt==="%"||Wt==="@"||Wt==="|"||Wt==="("||Wt===")"||!Wt||Wt===vh?Qe:(Qe+=Wt,Te.next(),Ae(Qe))};return Ae("")}function nt(Te){Ye(Te);const Ae=we(Te,"|");return Ye(Te),Ae}function Lt(Te,Ae){let Qe=null;switch(Te.currentChar()){case"{":return Ae.braceNest>=1&&J(nr.NOT_ALLOW_NEST_PLACEHOLDER,C(),0),Te.next(),Qe=ne(Ae,2,"{"),Ye(Te),Ae.braceNest++,Qe;case"}":return Ae.braceNest>0&&Ae.currentType===2&&J(nr.EMPTY_PLACEHOLDER,C(),0),Te.next(),Qe=ne(Ae,3,"}"),Ae.braceNest--,Ae.braceNest>0&&Ye(Te),Ae.inLinked&&Ae.braceNest===0&&(Ae.inLinked=!1),Qe;case"@":return Ae.braceNest>0&&J(nr.UNTERMINATED_CLOSING_BRACE,C(),0),Qe=At(Te,Ae)||ue(Ae),Ae.braceNest=0,Qe;default:{let Ht=!0,Kt=!0,ut=!0;if(He(Te))return Ae.braceNest>0&&J(nr.UNTERMINATED_CLOSING_BRACE,C(),0),Qe=ne(Ae,1,nt(Te)),Ae.braceNest=0,Ae.inLinked=!1,Qe;if(Ae.braceNest>0&&(Ae.currentType===5||Ae.currentType===6||Ae.currentType===7))return J(nr.UNTERMINATED_CLOSING_BRACE,C(),0),Ae.braceNest=0,Yt(Te,Ae);if(Ht=ae(Te,Ae))return Qe=ne(Ae,5,Bn(Te)),Ye(Te),Qe;if(Kt=ge(Te,Ae))return Qe=ne(Ae,6,sn(Te)),Ye(Te),Qe;if(ut=Oe(Te,Ae))return Qe=ne(Ae,7,mi(Te)),Ye(Te),Qe;if(!Ht&&!Kt&&!ut)return Qe=ne(Ae,13,Si(Te)),J(nr.INVALID_TOKEN_IN_PLACEHOLDER,C(),0,Qe.value),Ye(Te),Qe;break}}return Qe}function At(Te,Ae){const{currentType:Qe}=Ae;let Wt=null;const Ht=Te.currentChar();switch((Qe===8||Qe===9||Qe===12||Qe===10)&&(Ht===Ro||Ht===vh)&&J(nr.INVALID_LINKED_FORMAT,C(),0),Ht){case"@":return Te.next(),Wt=ne(Ae,8,"@"),Ae.inLinked=!0,Wt;case".":return Ye(Te),Te.next(),ne(Ae,9,".");case":":return Ye(Te),Te.next(),ne(Ae,10,":");default:return He(Te)?(Wt=ne(Ae,1,nt(Te)),Ae.braceNest=0,Ae.inLinked=!1,Wt):ze(Te,Ae)||ke(Te,Ae)?(Ye(Te),At(Te,Ae)):rt(Te,Ae)?(Ye(Te),ne(Ae,12,xe(Te))):Ke(Te,Ae)?(Ye(Te),Ht==="{"?Lt(Te,Ae)||Wt:ne(Ae,11,ve(Te))):(Qe===8&&J(nr.INVALID_LINKED_FORMAT,C(),0),Ae.braceNest=0,Ae.inLinked=!1,Yt(Te,Ae))}}function Yt(Te,Ae){let Qe={type:14};if(Ae.braceNest>0)return Lt(Te,Ae)||ue(Ae);if(Ae.inLinked)return At(Te,Ae)||ue(Ae);switch(Te.currentChar()){case"{":return Lt(Te,Ae)||ue(Ae);case"}":return J(nr.UNBALANCED_CLOSING_BRACE,C(),0),Te.next(),ne(Ae,3,"}");case"@":return At(Te,Ae)||ue(Ae);default:{if(He(Te))return Qe=ne(Ae,1,nt(Te)),Ae.braceNest=0,Ae.inLinked=!1,Qe;const{isModulo:Ht,hasSpace:Kt}=ri(Te);if(Ht)return Kt?ne(Ae,0,fr(Te)):ne(Ae,4,nn(Te));if(bt(Te))return ne(Ae,0,fr(Te));break}}return Qe}function oi(){const{currentType:Te,offset:Ae,startLoc:Qe,endLoc:Wt}=s;return s.lastType=Te,s.lastOffset=Ae,s.lastStartLoc=Qe,s.lastEndLoc=Wt,s.offset=T(),s.startLoc=C(),_.currentChar()===Fu?ne(s,14):Yt(_,s)}return{nextToken:oi,currentOffset:T,currentPosition:C,context:$}}const lO="parser",cO=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function hO(t,l,d){switch(t){case"\\\\":return"\\";case"\\'":return"'";default:{const _=parseInt(l||d,16);return _<=55295||_>=57344?String.fromCodePoint(_):""}}}function uO(t={}){const l=t.location!==!1,{onError:d,onWarn:_}=t;function T(ae,ge,Oe,ze,...rt){const ke=ae.currentPosition();if(ke.offset+=ze,ke.column+=ze,d){const Ke=l?ax(Oe,ke):null,He=gm(ge,Ke,{domain:lO,args:rt});d(He)}}function C(ae,ge,Oe,ze,...rt){const ke=ae.currentPosition();if(ke.offset+=ze,ke.column+=ze,_){const Ke=l?ax(Oe,ke):null;_(JD(ge,Ke,rt))}}function P(ae,ge,Oe){const ze={type:ae};return l&&(ze.start=ge,ze.end=ge,ze.loc={start:Oe,end:Oe}),ze}function V(ae,ge,Oe,ze){l&&(ae.end=ge,ae.loc&&(ae.loc.end=Oe))}function s(ae,ge){const Oe=ae.context(),ze=P(3,Oe.offset,Oe.startLoc);return ze.value=ge,V(ze,ae.currentOffset(),ae.currentPosition()),ze}function $(ae,ge){const Oe=ae.context(),{lastOffset:ze,lastStartLoc:rt}=Oe,ke=P(5,ze,rt);return ke.index=parseInt(ge,10),ae.nextToken(),V(ke,ae.currentOffset(),ae.currentPosition()),ke}function Z(ae,ge,Oe){const ze=ae.context(),{lastOffset:rt,lastStartLoc:ke}=ze,Ke=P(4,rt,ke);return Ke.key=ge,Oe===!0&&(Ke.modulo=!0),ae.nextToken(),V(Ke,ae.currentOffset(),ae.currentPosition()),Ke}function J(ae,ge){const Oe=ae.context(),{lastOffset:ze,lastStartLoc:rt}=Oe,ke=P(9,ze,rt);return ke.value=ge.replace(cO,hO),ae.nextToken(),V(ke,ae.currentOffset(),ae.currentPosition()),ke}function ne(ae){const ge=ae.nextToken(),Oe=ae.context(),{lastOffset:ze,lastStartLoc:rt}=Oe,ke=P(8,ze,rt);return ge.type!==12?(T(ae,nr.UNEXPECTED_EMPTY_LINKED_MODIFIER,Oe.lastStartLoc,0),ke.value="",V(ke,ze,rt),{nextConsumeToken:ge,node:ke}):(ge.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,Oe.lastStartLoc,0,Dl(ge)),ke.value=ge.value||"",V(ke,ae.currentOffset(),ae.currentPosition()),{node:ke})}function ue(ae,ge){const Oe=ae.context(),ze=P(7,Oe.offset,Oe.startLoc);return ze.value=ge,V(ze,ae.currentOffset(),ae.currentPosition()),ze}function we(ae){const ge=ae.context(),Oe=P(6,ge.offset,ge.startLoc);let ze=ae.nextToken();if(ze.type===9){const rt=ne(ae);Oe.modifier=rt.node,ze=rt.nextConsumeToken||ae.nextToken()}switch(ze.type!==10&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(ze)),ze=ae.nextToken(),ze.type===2&&(ze=ae.nextToken()),ze.type){case 11:ze.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(ze)),Oe.key=ue(ae,ze.value||"");break;case 5:ze.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(ze)),Oe.key=Z(ae,ze.value||"");break;case 6:ze.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(ze)),Oe.key=$(ae,ze.value||"");break;case 7:ze.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(ze)),Oe.key=J(ae,ze.value||"");break;default:{T(ae,nr.UNEXPECTED_EMPTY_LINKED_KEY,ge.lastStartLoc,0);const rt=ae.context(),ke=P(7,rt.offset,rt.startLoc);return ke.value="",V(ke,rt.offset,rt.startLoc),Oe.key=ke,V(Oe,rt.offset,rt.startLoc),{nextConsumeToken:ze,node:Oe}}}return V(Oe,ae.currentOffset(),ae.currentPosition()),{node:Oe}}function Me(ae){const ge=ae.context(),Oe=ge.currentType===1?ae.currentOffset():ge.offset,ze=ge.currentType===1?ge.endLoc:ge.startLoc,rt=P(2,Oe,ze);rt.items=[];let ke=null,Ke=null;do{const bt=ke||ae.nextToken();switch(ke=null,bt.type){case 0:bt.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(bt)),rt.items.push(s(ae,bt.value||""));break;case 6:bt.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(bt)),rt.items.push($(ae,bt.value||""));break;case 4:Ke=!0;break;case 5:bt.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(bt)),rt.items.push(Z(ae,bt.value||"",!!Ke)),Ke&&(C(ae,$b.USE_MODULO_SYNTAX,ge.lastStartLoc,0,Dl(bt)),Ke=null);break;case 7:bt.value==null&&T(ae,nr.UNEXPECTED_LEXICAL_ANALYSIS,ge.lastStartLoc,0,Dl(bt)),rt.items.push(J(ae,bt.value||""));break;case 8:{const dt=we(ae);rt.items.push(dt.node),ke=dt.nextConsumeToken||null;break}}}while(ge.currentType!==14&&ge.currentType!==1);const He=ge.currentType===1?ge.lastOffset:ae.currentOffset(),ri=ge.currentType===1?ge.lastEndLoc:ae.currentPosition();return V(rt,He,ri),rt}function Ye(ae,ge,Oe,ze){const rt=ae.context();let ke=ze.items.length===0;const Ke=P(1,ge,Oe);Ke.cases=[],Ke.cases.push(ze);do{const He=Me(ae);ke||(ke=He.items.length===0),Ke.cases.push(He)}while(rt.currentType!==14);return ke&&T(ae,nr.MUST_HAVE_MESSAGES_IN_PLURAL,Oe,0),V(Ke,ae.currentOffset(),ae.currentPosition()),Ke}function Ze(ae){const ge=ae.context(),{offset:Oe,startLoc:ze}=ge,rt=Me(ae);return ge.currentType===14?rt:Ye(ae,Oe,ze,rt)}function je(ae){const ge=aO(ae,LC({},t)),Oe=ge.context(),ze=P(0,Oe.offset,Oe.startLoc);return l&&ze.loc&&(ze.loc.source=ae),ze.body=Ze(ge),t.onCacheKey&&(ze.cacheKey=t.onCacheKey(ae)),Oe.currentType!==14&&T(ge,nr.UNEXPECTED_LEXICAL_ANALYSIS,Oe.lastStartLoc,0,ae[Oe.offset]||""),V(ze,ge.currentOffset(),ge.currentPosition()),ze}return{parse:je}}function Dl(t){if(t.type===14)return"EOF";const l=(t.value||"").replace(/\r?\n/gu,"\\n");return l.length>10?l.slice(0,9)+"":l}function dO(t,l={}){const d={ast:t,helpers:new Set};return{context:()=>d,helper:C=>(d.helpers.add(C),C)}}function mT(t,l){for(let d=0;d<t.length;d++)Gb(t[d],l)}function Gb(t,l){switch(t.type){case 1:mT(t.cases,l),l.helper("plural");break;case 2:mT(t.items,l);break;case 6:{Gb(t.key,l),l.helper("linked"),l.helper("type");break}case 5:l.helper("interpolate"),l.helper("list");break;case 4:l.helper("interpolate"),l.helper("named");break}}function fO(t,l={}){const d=dO(t);d.helper("normalize"),t.body&&Gb(t.body,d);const _=d.context();t.helpers=Array.from(_.helpers)}function pO(t){const l=t.body;return l.type===2?gT(l):l.cases.forEach(d=>gT(d)),t}function gT(t){if(t.items.length===1){const l=t.items[0];(l.type===3||l.type===9)&&(t.static=l.value,delete l.value)}else{const l=[];for(let d=0;d<t.items.length;d++){const _=t.items[d];if(!(_.type===3||_.type===9)||_.value==null)break;l.push(_.value)}if(l.length===t.items.length){t.static=DC(l);for(let d=0;d<t.items.length;d++){const _=t.items[d];(_.type===3||_.type===9)&&delete _.value}}}}const mO="minifier";function Zp(t){switch(t.t=t.type,t.type){case 0:{const l=t;Zp(l.body),l.b=l.body,delete l.body;break}case 1:{const l=t,d=l.cases;for(let _=0;_<d.length;_++)Zp(d[_]);l.c=d,delete l.cases;break}case 2:{const l=t,d=l.items;for(let _=0;_<d.length;_++)Zp(d[_]);l.i=d,delete l.items,l.static&&(l.s=l.static,delete l.static);break}case 3:case 9:case 8:case 7:{const l=t;l.value&&(l.v=l.value,delete l.value);break}case 6:{const l=t;Zp(l.key),l.k=l.key,delete l.key,l.modifier&&(Zp(l.modifier),l.m=l.modifier,delete l.modifier);break}case 5:{const l=t;l.i=l.index,delete l.index;break}case 4:{const l=t;l.k=l.key,delete l.key;break}default:throw gm(nr.UNHANDLED_MINIFIER_NODE_TYPE,null,{domain:mO,args:[t.type]})}delete t.type}const gO="parser";function _O(t,l){const{filename:d,breakLineCode:_,needIndent:T}=l,C=l.location!==!1,P={filename:d,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:_,needIndent:T,indentLevel:0};C&&t.loc&&(P.source=t.loc.source);const V=()=>P;function s(Me,Ye){P.code+=Me}function $(Me,Ye=!0){const Ze=Ye?_:"";s(T?Ze+"  ".repeat(Me):Ze)}function Z(Me=!0){const Ye=++P.indentLevel;Me&&$(Ye)}function J(Me=!0){const Ye=--P.indentLevel;Me&&$(Ye)}function ne(){$(P.indentLevel)}return{context:V,push:s,indent:Z,deindent:J,newline:ne,helper:Me=>`_${Me}`,needIndent:()=>P.needIndent}}function yO(t,l){const{helper:d}=t;t.push(`${d("linked")}(`),hm(t,l.key),l.modifier?(t.push(", "),hm(t,l.modifier),t.push(", _type")):t.push(", undefined, _type"),t.push(")")}function xO(t,l){const{helper:d,needIndent:_}=t;t.push(`${d("normalize")}([`),t.indent(_());const T=l.items.length;for(let C=0;C<T&&(hm(t,l.items[C]),C!==T-1);C++)t.push(", ");t.deindent(_()),t.push("])")}function vO(t,l){const{helper:d,needIndent:_}=t;if(l.cases.length>1){t.push(`${d("plural")}([`),t.indent(_());const T=l.cases.length;for(let C=0;C<T&&(hm(t,l.cases[C]),C!==T-1);C++)t.push(", ");t.deindent(_()),t.push("])")}}function bO(t,l){l.body?hm(t,l.body):t.push("null")}function hm(t,l){const{helper:d}=t;switch(l.type){case 0:bO(t,l);break;case 1:vO(t,l);break;case 2:xO(t,l);break;case 6:yO(t,l);break;case 8:t.push(JSON.stringify(l.value),l);break;case 7:t.push(JSON.stringify(l.value),l);break;case 5:t.push(`${d("interpolate")}(${d("list")}(${l.index}))`,l);break;case 4:t.push(`${d("interpolate")}(${d("named")}(${JSON.stringify(l.key)}))`,l);break;case 9:t.push(JSON.stringify(l.value),l);break;case 3:t.push(JSON.stringify(l.value),l);break;default:throw gm(nr.UNHANDLED_CODEGEN_NODE_TYPE,null,{domain:gO,args:[l.type]})}}const wO=(t,l={})=>{const d=fT(l.mode)?l.mode:"normal",_=fT(l.filename)?l.filename:"message.intl";l.sourceMap;const T=l.breakLineCode!=null?l.breakLineCode:d==="arrow"?";":`
`,C=l.needIndent?l.needIndent:d!=="arrow",P=t.helpers||[],V=_O(t,{filename:_,breakLineCode:T,needIndent:C});V.push(d==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),V.indent(C),P.length>0&&(V.push(`const { ${DC(P.map(Z=>`${Z}: _${Z}`),", ")} } = ctx`),V.newline()),V.push("return "),hm(V,t),V.deindent(C),V.push("}"),delete t.helpers;const{code:s,map:$}=V.context();return{ast:t,code:s,map:$?$.toJSON():void 0}};function TO(t,l={}){const d=LC({},l),_=!!d.jit,T=!!d.minify,C=d.optimize==null?!0:d.optimize,V=uO(d).parse(t);return _?(C&&pO(V),T&&Zp(V),{ast:V,code:""}):(fO(V,d),wO(V,d))}/*!
  * core-base v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function EO(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(Ah().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(Ah().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(Ah().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}function Dc(t){return Xr(t)&&Wb(t)===0&&(zl(t,"b")||zl(t,"body"))}const OC=["b","body"];function SO(t){return ed(t,OC)}const RC=["c","cases"];function CO(t){return ed(t,RC,[])}const zC=["s","static"];function AO(t){return ed(t,zC)}const BC=["i","items"];function MO(t){return ed(t,BC,[])}const FC=["t","type"];function Wb(t){return ed(t,FC)}const NC=["v","value"];function Oy(t,l){const d=ed(t,NC);if(d!=null)return d;throw t_(l)}const UC=["m","modifier"];function IO(t){return ed(t,UC)}const VC=["k","key"];function kO(t){const l=ed(t,VC);if(l)return l;throw t_(6)}function ed(t,l,d){for(let _=0;_<l.length;_++){const T=l[_];if(zl(t,T)&&t[T]!=null)return t[T]}return d}const jC=[...OC,...RC,...zC,...BC,...VC,...UC,...NC,...FC];function t_(t){return new Error(`unhandled node type: ${t}`)}const td=[];td[0]={w:[0],i:[3,0],"[":[4],o:[7]};td[1]={w:[1],".":[2],"[":[4],o:[7]};td[2]={w:[2],i:[3,0],0:[3,0]};td[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};td[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};td[5]={"'":[4,0],o:8,l:[5,0]};td[6]={'"':[4,0],o:8,l:[6,0]};const PO=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function LO(t){return PO.test(t)}function DO(t){const l=t.charCodeAt(0),d=t.charCodeAt(t.length-1);return l===d&&(l===34||l===39)?t.slice(1,-1):t}function OO(t){if(t==null)return"o";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function RO(t){const l=t.trim();return t.charAt(0)==="0"&&isNaN(parseInt(t))?!1:LO(l)?DO(l):"*"+l}function zO(t){const l=[];let d=-1,_=0,T=0,C,P,V,s,$,Z,J;const ne=[];ne[0]=()=>{P===void 0?P=V:P+=V},ne[1]=()=>{P!==void 0&&(l.push(P),P=void 0)},ne[2]=()=>{ne[0](),T++},ne[3]=()=>{if(T>0)T--,_=4,ne[0]();else{if(T=0,P===void 0||(P=RO(P),P===!1))return!1;ne[1]()}};function ue(){const we=t[d+1];if(_===5&&we==="'"||_===6&&we==='"')return d++,V="\\"+we,ne[0](),!0}for(;_!==null;)if(d++,C=t[d],!(C==="\\"&&ue())){if(s=OO(C),J=td[_],$=J[s]||J.l||8,$===8||(_=$[0],$[1]!==void 0&&(Z=ne[$[1]],Z&&(V=C,Z()===!1))))return;if(_===7)return l}}const _T=new Map;function BO(t,l){return Xr(t)?t[l]:null}function FO(t,l){if(!Xr(t))return null;let d=_T.get(l);if(d||(d=zO(l),d&&_T.set(l,d)),!d)return null;const _=d.length;let T=t,C=0;for(;C<_;){const P=d[C];if(jC.includes(P)&&Dc(T))return null;const V=T[P];if(V===void 0||Dn(T))return null;T=V,C++}return T}const NO=t=>t,UO=t=>"",VO="text",jO=t=>t.length===0?"":qD(t),$O=HD;function yT(t,l){return t=Math.abs(t),l===2?t?t>1?1:0:1:t?Math.min(t,2):0}function GO(t){const l=hs(t.pluralIndex)?t.pluralIndex:-1;return t.named&&(hs(t.named.count)||hs(t.named.n))?hs(t.named.count)?t.named.count:hs(t.named.n)?t.named.n:l:l}function WO(t,l){l.count||(l.count=t),l.n||(l.n=t)}function HO(t={}){const l=t.locale,d=GO(t),_=Xr(t.pluralRules)&&Ci(l)&&Dn(t.pluralRules[l])?t.pluralRules[l]:yT,T=Xr(t.pluralRules)&&Ci(l)&&Dn(t.pluralRules[l])?yT:void 0,C=Ze=>Ze[_(d,Ze.length,T)],P=t.list||[],V=Ze=>P[Ze],s=t.named||gn();hs(t.pluralIndex)&&WO(d,s);const $=Ze=>s[Ze];function Z(Ze){const je=Dn(t.messages)?t.messages(Ze):Xr(t.messages)?t.messages[Ze]:!1;return je||(t.parent?t.parent.message(Ze):UO)}const J=Ze=>t.modifiers?t.modifiers[Ze]:NO,ne=ur(t.processor)&&Dn(t.processor.normalize)?t.processor.normalize:jO,ue=ur(t.processor)&&Dn(t.processor.interpolate)?t.processor.interpolate:$O,we=ur(t.processor)&&Ci(t.processor.type)?t.processor.type:VO,Ye={list:V,named:$,plural:C,linked:(Ze,...je)=>{const[ae,ge]=je;let Oe="text",ze="";je.length===1?Xr(ae)?(ze=ae.modifier||ze,Oe=ae.type||Oe):Ci(ae)&&(ze=ae||ze):je.length===2&&(Ci(ae)&&(ze=ae||ze),Ci(ge)&&(Oe=ge||Oe));const rt=Z(Ze)(Ye),ke=Oe==="vnode"&&$n(rt)&&ze?rt[0]:rt;return ze?J(ze)(ke,Oe):ke},message:Z,type:we,interpolate:ue,normalize:ne,values:Zs(gn(),P,s)};return Ye}let i_=null;function qO(t){i_=t}function XO(t,l,d){i_&&i_.emit("i18n:init",{timestamp:Date.now(),i18n:t,version:l,meta:d})}const ZO=YO("function:translate");function YO(t){return l=>i_&&i_.emit(t,l)}const KO=$b.__EXTEND_POINT__,Ef=Rx(KO),JO={FALLBACK_TO_TRANSLATE:Ef(),CANNOT_FORMAT_NUMBER:Ef(),FALLBACK_TO_NUMBER_FORMAT:Ef(),CANNOT_FORMAT_DATE:Ef(),FALLBACK_TO_DATE_FORMAT:Ef(),EXPERIMENTAL_CUSTOM_MESSAGE_COMPILER:Ef(),__EXTEND_POINT__:Ef()},$C=nr.__EXTEND_POINT__,Sf=Rx($C),Bl={INVALID_ARGUMENT:$C,INVALID_DATE_ARGUMENT:Sf(),INVALID_ISO_DATE_ARGUMENT:Sf(),NOT_SUPPORT_NON_STRING_MESSAGE:Sf(),NOT_SUPPORT_LOCALE_PROMISE_VALUE:Sf(),NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:Sf(),NOT_SUPPORT_LOCALE_TYPE:Sf(),__EXTEND_POINT__:Sf()};function Lc(t){return gm(t,null,void 0)}function Hb(t,l){return l.locale!=null?xT(l.locale):xT(t.locale)}let g0;function xT(t){if(Ci(t))return t;if(Dn(t)){if(t.resolvedOnce&&g0!=null)return g0;if(t.constructor.name==="Function"){const l=t();if(WD(l))throw Lc(Bl.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return g0=l}else throw Lc(Bl.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw Lc(Bl.NOT_SUPPORT_LOCALE_TYPE)}function QO(t,l,d){return[...new Set([d,...$n(l)?l:Xr(l)?Object.keys(l):Ci(l)?[l]:[d]])]}function GC(t,l,d){const _=Ci(d)?d:um,T=t;T.__localeChainCache||(T.__localeChainCache=new Map);let C=T.__localeChainCache.get(_);if(!C){C=[];let P=[d];for(;$n(P);)P=vT(C,P,l);const V=$n(l)||!ur(l)?l:l.default?l.default:null;P=Ci(V)?[V]:V,$n(P)&&vT(C,P,!1),T.__localeChainCache.set(_,C)}return C}function vT(t,l,d){let _=!0;for(let T=0;T<l.length&&Cr(_);T++){const C=l[T];Ci(C)&&(_=eR(t,l[T],d))}return _}function eR(t,l,d){let _;const T=l.split("-");do{const C=T.join("-");_=tR(t,C,d),T.splice(-1,1)}while(T.length&&_===!0);return _}function tR(t,l,d){let _=!1;if(!t.includes(l)&&(_=!0,l)){_=l[l.length-1]!=="!";const T=l.replace(/!/g,"");t.push(T),($n(d)||ur(d))&&d[T]&&(_=d[T])}return _}const iR="9.14.5",zx=-1,um="en-US",bT="",wT=t=>`${t.charAt(0).toLocaleUpperCase()}${t.substr(1)}`;function rR(){return{upper:(t,l)=>l==="text"&&Ci(t)?t.toUpperCase():l==="vnode"&&Xr(t)&&"__v_isVNode"in t?t.children.toUpperCase():t,lower:(t,l)=>l==="text"&&Ci(t)?t.toLowerCase():l==="vnode"&&Xr(t)&&"__v_isVNode"in t?t.children.toLowerCase():t,capitalize:(t,l)=>l==="text"&&Ci(t)?wT(t):l==="vnode"&&Xr(t)&&"__v_isVNode"in t?wT(t.children):t}}let WC;function TT(t){WC=t}let HC;function nR(t){HC=t}let qC;function sR(t){qC=t}let XC=null;const oR=t=>{XC=t},aR=()=>XC;let ZC=null;const ET=t=>{ZC=t},lR=()=>ZC;let ST=0;function cR(t={}){const l=Dn(t.onWarn)?t.onWarn:FD,d=Ci(t.version)?t.version:iR,_=Ci(t.locale)||Dn(t.locale)?t.locale:um,T=Dn(_)?um:_,C=$n(t.fallbackLocale)||ur(t.fallbackLocale)||Ci(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:T,P=ur(t.messages)?t.messages:_0(T),V=ur(t.datetimeFormats)?t.datetimeFormats:_0(T),s=ur(t.numberFormats)?t.numberFormats:_0(T),$=Zs(gn(),t.modifiers,rR()),Z=t.pluralRules||gn(),J=Dn(t.missing)?t.missing:null,ne=Cr(t.missingWarn)||Yu(t.missingWarn)?t.missingWarn:!0,ue=Cr(t.fallbackWarn)||Yu(t.fallbackWarn)?t.fallbackWarn:!0,we=!!t.fallbackFormat,Me=!!t.unresolving,Ye=Dn(t.postTranslation)?t.postTranslation:null,Ze=ur(t.processor)?t.processor:null,je=Cr(t.warnHtmlMessage)?t.warnHtmlMessage:!0,ae=!!t.escapeParameter,ge=Dn(t.messageCompiler)?t.messageCompiler:WC,Oe=Dn(t.messageResolver)?t.messageResolver:HC||BO,ze=Dn(t.localeFallbacker)?t.localeFallbacker:qC||QO,rt=Xr(t.fallbackContext)?t.fallbackContext:void 0,ke=t,Ke=Xr(ke.__datetimeFormatters)?ke.__datetimeFormatters:new Map,He=Xr(ke.__numberFormatters)?ke.__numberFormatters:new Map,ri=Xr(ke.__meta)?ke.__meta:{};ST++;const bt={version:d,cid:ST,locale:_,fallbackLocale:C,messages:P,modifiers:$,pluralRules:Z,missing:J,missingWarn:ne,fallbackWarn:ue,fallbackFormat:we,unresolving:Me,postTranslation:Ye,processor:Ze,warnHtmlMessage:je,escapeParameter:ae,messageCompiler:ge,messageResolver:Oe,localeFallbacker:ze,fallbackContext:rt,onWarn:l,__meta:ri};return bt.datetimeFormats=V,bt.numberFormats=s,bt.__datetimeFormatters=Ke,bt.__numberFormatters=He,__INTLIFY_PROD_DEVTOOLS__&&XO(bt,d,ri),bt}const _0=t=>({[t]:gn()});function qb(t,l,d,_,T){const{missing:C,onWarn:P}=t;if(C!==null){const V=C(t,d,l,T);return Ci(V)?V:l}else return l}function Ag(t,l,d){const _=t;_.__localeChainCache=new Map,t.localeFallbacker(t,d,l)}function hR(t,l){return t===l?!1:t.split("-")[0]===l.split("-")[0]}function uR(t,l){const d=l.indexOf(t);if(d===-1)return!1;for(let _=d+1;_<l.length;_++)if(hR(t,l[_]))return!0;return!1}function y0(t){return d=>dR(d,t)}function dR(t,l){const d=SO(l);if(d==null)throw t_(0);if(Wb(d)===1){const C=CO(d);return t.plural(C.reduce((P,V)=>[...P,CT(t,V)],[]))}else return CT(t,d)}function CT(t,l){const d=AO(l);if(d!=null)return t.type==="text"?d:t.normalize([d]);{const _=MO(l).reduce((T,C)=>[...T,X0(t,C)],[]);return t.normalize(_)}}function X0(t,l){const d=Wb(l);switch(d){case 3:return Oy(l,d);case 9:return Oy(l,d);case 4:{const _=l;if(zl(_,"k")&&_.k)return t.interpolate(t.named(_.k));if(zl(_,"key")&&_.key)return t.interpolate(t.named(_.key));throw t_(d)}case 5:{const _=l;if(zl(_,"i")&&hs(_.i))return t.interpolate(t.list(_.i));if(zl(_,"index")&&hs(_.index))return t.interpolate(t.list(_.index));throw t_(d)}case 6:{const _=l,T=IO(_),C=kO(_);return t.linked(X0(t,C),T?X0(t,T):void 0,t.type)}case 7:return Oy(l,d);case 8:return Oy(l,d);default:throw new Error(`unhandled node on format message part: ${d}`)}}const YC=t=>t;let Kp=gn();function KC(t,l={}){let d=!1;const _=l.onError||eO;return l.onError=T=>{d=!0,_(T)},{...TO(t,l),detectError:d}}const fR=(t,l)=>{if(!Ci(t))throw Lc(Bl.NOT_SUPPORT_NON_STRING_MESSAGE);{Cr(l.warnHtmlMessage)&&l.warnHtmlMessage;const _=(l.onCacheKey||YC)(t),T=Kp[_];if(T)return T;const{code:C,detectError:P}=KC(t,l),V=new Function(`return ${C}`)();return P?V:Kp[_]=V}};function pR(t,l){if(__INTLIFY_JIT_COMPILATION__&&!__INTLIFY_DROP_MESSAGE_COMPILER__&&Ci(t)){Cr(l.warnHtmlMessage)&&l.warnHtmlMessage;const _=(l.onCacheKey||YC)(t),T=Kp[_];if(T)return T;const{ast:C,detectError:P}=KC(t,{...l,location:!1,jit:!0}),V=y0(C);return P?V:Kp[_]=V}else{const d=t.cacheKey;if(d){const _=Kp[d];return _||(Kp[d]=y0(t))}else return y0(t)}}const AT=()=>"",nl=t=>Dn(t);function MT(t,...l){const{fallbackFormat:d,postTranslation:_,unresolving:T,messageCompiler:C,fallbackLocale:P,messages:V}=t,[s,$]=Z0(...l),Z=Cr($.missingWarn)?$.missingWarn:t.missingWarn,J=Cr($.fallbackWarn)?$.fallbackWarn:t.fallbackWarn,ne=Cr($.escapeParameter)?$.escapeParameter:t.escapeParameter,ue=!!$.resolvedMessage,we=Ci($.default)||Cr($.default)?Cr($.default)?C?s:()=>s:$.default:d?C?s:()=>s:"",Me=d||we!=="",Ye=Hb(t,$);ne&&mR($);let[Ze,je,ae]=ue?[s,Ye,V[Ye]||gn()]:JC(t,s,Ye,P,J,Z),ge=Ze,Oe=s;if(!ue&&!(Ci(ge)||Dc(ge)||nl(ge))&&Me&&(ge=we,Oe=ge),!ue&&(!(Ci(ge)||Dc(ge)||nl(ge))||!Ci(je)))return T?zx:s;let ze=!1;const rt=()=>{ze=!0},ke=nl(ge)?ge:QC(t,s,je,ge,Oe,rt);if(ze)return ge;const Ke=yR(t,je,ae,$),He=HO(Ke),ri=gR(t,ke,He);let bt=_?_(ri,s):ri;if(ne&&Ci(bt)&&(bt=$D(bt)),__INTLIFY_PROD_DEVTOOLS__){const dt={timestamp:Date.now(),key:Ci(s)?s:nl(ge)?ge.key:"",locale:je||(nl(ge)?ge.locale:""),format:Ci(ge)?ge:nl(ge)?ge.source:"",message:bt};dt.meta=Zs({},t.__meta,aR()||{}),ZO(dt)}return bt}function mR(t){$n(t.list)?t.list=t.list.map(l=>Ci(l)?uT(l):l):Xr(t.named)&&Object.keys(t.named).forEach(l=>{Ci(t.named[l])&&(t.named[l]=uT(t.named[l]))})}function JC(t,l,d,_,T,C){const{messages:P,onWarn:V,messageResolver:s,localeFallbacker:$}=t,Z=$(t,_,d);let J=gn(),ne,ue=null;const we="translate";for(let Me=0;Me<Z.length&&(ne=Z[Me],J=P[ne]||gn(),(ue=s(J,l))===null&&(ue=J[l]),!(Ci(ue)||Dc(ue)||nl(ue)));Me++)if(!uR(ne,Z)){const Ye=qb(t,l,ne,C,we);Ye!==l&&(ue=Ye)}return[ue,ne,J]}function QC(t,l,d,_,T,C){const{messageCompiler:P,warnHtmlMessage:V}=t;if(nl(_)){const $=_;return $.locale=$.locale||d,$.key=$.key||l,$}if(P==null){const $=()=>_;return $.locale=d,$.key=l,$}const s=P(_,_R(t,d,T,_,V,C));return s.locale=d,s.key=l,s.source=_,s}function gR(t,l,d){return l(d)}function Z0(...t){const[l,d,_]=t,T=gn();if(!Ci(l)&&!hs(l)&&!nl(l)&&!Dc(l))throw Lc(Bl.INVALID_ARGUMENT);const C=hs(l)?String(l):(nl(l),l);return hs(d)?T.plural=d:Ci(d)?T.default=d:ur(d)&&!Ox(d)?T.named=d:$n(d)&&(T.list=d),hs(_)?T.plural=_:Ci(_)?T.default=_:ur(_)&&Zs(T,_),[C,T]}function _R(t,l,d,_,T,C){return{locale:l,key:d,warnHtmlMessage:T,onError:P=>{throw C&&C(P),P},onCacheKey:P=>ND(l,d,P)}}function yR(t,l,d,_){const{modifiers:T,pluralRules:C,messageResolver:P,fallbackLocale:V,fallbackWarn:s,missingWarn:$,fallbackContext:Z}=t,ne={locale:l,modifiers:T,pluralRules:C,messages:ue=>{let we=P(d,ue);if(we==null&&Z){const[,,Me]=JC(Z,ue,l,V,s,$);we=P(Me,ue)}if(Ci(we)||Dc(we)){let Me=!1;const Ze=QC(t,ue,l,we,ue,()=>{Me=!0});return Me?AT:Ze}else return nl(we)?we:AT}};return t.processor&&(ne.processor=t.processor),_.list&&(ne.list=_.list),_.named&&(ne.named=_.named),hs(_.plural)&&(ne.pluralIndex=_.plural),ne}function IT(t,...l){const{datetimeFormats:d,unresolving:_,fallbackLocale:T,onWarn:C,localeFallbacker:P}=t,{__datetimeFormatters:V}=t,[s,$,Z,J]=Y0(...l),ne=Cr(Z.missingWarn)?Z.missingWarn:t.missingWarn;Cr(Z.fallbackWarn)?Z.fallbackWarn:t.fallbackWarn;const ue=!!Z.part,we=Hb(t,Z),Me=P(t,T,we);if(!Ci(s)||s==="")return new Intl.DateTimeFormat(we,J).format($);let Ye={},Ze,je=null;const ae="datetime format";for(let ze=0;ze<Me.length&&(Ze=Me[ze],Ye=d[Ze]||{},je=Ye[s],!ur(je));ze++)qb(t,s,Ze,ne,ae);if(!ur(je)||!Ci(Ze))return _?zx:s;let ge=`${Ze}__${s}`;Ox(J)||(ge=`${ge}__${JSON.stringify(J)}`);let Oe=V.get(ge);return Oe||(Oe=new Intl.DateTimeFormat(Ze,Zs({},je,J)),V.set(ge,Oe)),ue?Oe.formatToParts($):Oe.format($)}const eA=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function Y0(...t){const[l,d,_,T]=t,C=gn();let P=gn(),V;if(Ci(l)){const s=l.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!s)throw Lc(Bl.INVALID_ISO_DATE_ARGUMENT);const $=s[3]?s[3].trim().startsWith("T")?`${s[1].trim()}${s[3].trim()}`:`${s[1].trim()}T${s[3].trim()}`:s[1].trim();V=new Date($);try{V.toISOString()}catch{throw Lc(Bl.INVALID_ISO_DATE_ARGUMENT)}}else if(VD(l)){if(isNaN(l.getTime()))throw Lc(Bl.INVALID_DATE_ARGUMENT);V=l}else if(hs(l))V=l;else throw Lc(Bl.INVALID_ARGUMENT);return Ci(d)?C.key=d:ur(d)&&Object.keys(d).forEach(s=>{eA.includes(s)?P[s]=d[s]:C[s]=d[s]}),Ci(_)?C.locale=_:ur(_)&&(P=_),ur(T)&&(P=T),[C.key||"",V,C,P]}function kT(t,l,d){const _=t;for(const T in d){const C=`${l}__${T}`;_.__datetimeFormatters.has(C)&&_.__datetimeFormatters.delete(C)}}function PT(t,...l){const{numberFormats:d,unresolving:_,fallbackLocale:T,onWarn:C,localeFallbacker:P}=t,{__numberFormatters:V}=t,[s,$,Z,J]=K0(...l),ne=Cr(Z.missingWarn)?Z.missingWarn:t.missingWarn;Cr(Z.fallbackWarn)?Z.fallbackWarn:t.fallbackWarn;const ue=!!Z.part,we=Hb(t,Z),Me=P(t,T,we);if(!Ci(s)||s==="")return new Intl.NumberFormat(we,J).format($);let Ye={},Ze,je=null;const ae="number format";for(let ze=0;ze<Me.length&&(Ze=Me[ze],Ye=d[Ze]||{},je=Ye[s],!ur(je));ze++)qb(t,s,Ze,ne,ae);if(!ur(je)||!Ci(Ze))return _?zx:s;let ge=`${Ze}__${s}`;Ox(J)||(ge=`${ge}__${JSON.stringify(J)}`);let Oe=V.get(ge);return Oe||(Oe=new Intl.NumberFormat(Ze,Zs({},je,J)),V.set(ge,Oe)),ue?Oe.formatToParts($):Oe.format($)}const tA=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function K0(...t){const[l,d,_,T]=t,C=gn();let P=gn();if(!hs(l))throw Lc(Bl.INVALID_ARGUMENT);const V=l;return Ci(d)?C.key=d:ur(d)&&Object.keys(d).forEach(s=>{tA.includes(s)?P[s]=d[s]:C[s]=d[s]}),Ci(_)?C.locale=_:ur(_)&&(P=_),ur(T)&&(P=T),[C.key||"",V,C,P]}function LT(t,l,d){const _=t;for(const T in d){const C=`${l}__${T}`;_.__numberFormatters.has(C)&&_.__numberFormatters.delete(C)}}EO();/*!
  * vue-i18n v9.14.5
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */const xR="9.14.5";function vR(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&(Ah().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&(Ah().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(Ah().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(Ah().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(Ah().__INTLIFY_PROD_DEVTOOLS__=!1)}const bR=JO.__EXTEND_POINT__,bh=Rx(bR);bh(),bh(),bh(),bh(),bh(),bh(),bh(),bh(),bh();const iA=Bl.__EXTEND_POINT__,sa=Rx(iA),Ps={UNEXPECTED_RETURN_TYPE:iA,INVALID_ARGUMENT:sa(),MUST_BE_CALL_SETUP_TOP:sa(),NOT_INSTALLED:sa(),NOT_AVAILABLE_IN_LEGACY_MODE:sa(),REQUIRED_VALUE:sa(),INVALID_VALUE:sa(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:sa(),NOT_INSTALLED_WITH_PROVIDE:sa(),UNEXPECTED_ERROR:sa(),NOT_COMPATIBLE_LEGACY_VUE_I18N:sa(),BRIDGE_SUPPORT_VUE_2_ONLY:sa(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:sa(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:sa(),__EXTEND_POINT__:sa()};function $s(t,...l){return gm(t,null,void 0)}const J0=Qu("__translateVNode"),Q0=Qu("__datetimeParts"),eb=Qu("__numberParts"),rA=Qu("__setPluralRules"),nA=Qu("__injectWithOption"),tb=Qu("__dispose");function r_(t){if(!Xr(t)||Dc(t))return t;for(const l in t)if(zl(t,l))if(!l.includes("."))Xr(t[l])&&r_(t[l]);else{const d=l.split("."),_=d.length-1;let T=t,C=!1;for(let P=0;P<_;P++){if(d[P]==="__proto__")throw new Error(`unsafe key: ${d[P]}`);if(d[P]in T||(T[d[P]]=gn()),!Xr(T[d[P]])){C=!0;break}T=T[d[P]]}if(C||(Dc(T)?jC.includes(d[_])||delete t[l]:(T[d[_]]=t[l],delete t[l])),!Dc(T)){const P=T[d[_]];Xr(P)&&r_(P)}}return t}function Bx(t,l){const{messages:d,__i18n:_,messageResolver:T,flatJson:C}=l,P=ur(d)?d:$n(_)?gn():{[t]:gn()};if($n(_)&&_.forEach(V=>{if("locale"in V&&"resource"in V){const{locale:s,resource:$}=V;s?(P[s]=P[s]||gn(),Ny($,P[s])):Ny($,P)}else Ci(V)&&Ny(JSON.parse(V),P)}),T==null&&C)for(const V in P)zl(P,V)&&r_(P[V]);return P}function sA(t){return t.type}function oA(t,l,d){let _=Xr(l.messages)?l.messages:gn();"__i18nGlobal"in d&&(_=Bx(t.locale.value,{messages:_,__i18n:d.__i18nGlobal}));const T=Object.keys(_);T.length&&T.forEach(C=>{t.mergeLocaleMessage(C,_[C])});{if(Xr(l.datetimeFormats)){const C=Object.keys(l.datetimeFormats);C.length&&C.forEach(P=>{t.mergeDateTimeFormat(P,l.datetimeFormats[P])})}if(Xr(l.numberFormats)){const C=Object.keys(l.numberFormats);C.length&&C.forEach(P=>{t.mergeNumberFormat(P,l.numberFormats[P])})}}}function DT(t){return pr(Ih,null,t,0)}const OT="__INTLIFY_META__",RT=()=>[],wR=()=>!1;let zT=0;function BT(t){return(l,d,_,T)=>t(d,_,Ys()||void 0,T)}const TR=()=>{const t=Ys();let l=null;return t&&(l=sA(t)[OT])?{[OT]:l}:null};function Xb(t={},l){const{__root:d,__injectWithOption:_}=t,T=d===void 0,C=t.flatJson,P=ox?Vi:l_,V=!!t.translateExistCompatible;let s=Cr(t.inheritLocale)?t.inheritLocale:!0;const $=P(d&&s?d.locale.value:Ci(t.locale)?t.locale:um),Z=P(d&&s?d.fallbackLocale.value:Ci(t.fallbackLocale)||$n(t.fallbackLocale)||ur(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:$.value),J=P(Bx($.value,t)),ne=P(ur(t.datetimeFormats)?t.datetimeFormats:{[$.value]:{}}),ue=P(ur(t.numberFormats)?t.numberFormats:{[$.value]:{}});let we=d?d.missingWarn:Cr(t.missingWarn)||Yu(t.missingWarn)?t.missingWarn:!0,Me=d?d.fallbackWarn:Cr(t.fallbackWarn)||Yu(t.fallbackWarn)?t.fallbackWarn:!0,Ye=d?d.fallbackRoot:Cr(t.fallbackRoot)?t.fallbackRoot:!0,Ze=!!t.fallbackFormat,je=Dn(t.missing)?t.missing:null,ae=Dn(t.missing)?BT(t.missing):null,ge=Dn(t.postTranslation)?t.postTranslation:null,Oe=d?d.warnHtmlMessage:Cr(t.warnHtmlMessage)?t.warnHtmlMessage:!0,ze=!!t.escapeParameter;const rt=d?d.modifiers:ur(t.modifiers)?t.modifiers:{};let ke=t.pluralRules||d&&d.pluralRules,Ke;Ke=(()=>{T&&ET(null);const ut={version:xR,locale:$.value,fallbackLocale:Z.value,messages:J.value,modifiers:rt,pluralRules:ke,missing:ae===null?void 0:ae,missingWarn:we,fallbackWarn:Me,fallbackFormat:Ze,unresolving:!0,postTranslation:ge===null?void 0:ge,warnHtmlMessage:Oe,escapeParameter:ze,messageResolver:t.messageResolver,messageCompiler:t.messageCompiler,__meta:{framework:"vue"}};ut.datetimeFormats=ne.value,ut.numberFormats=ue.value,ut.__datetimeFormatters=ur(Ke)?Ke.__datetimeFormatters:void 0,ut.__numberFormatters=ur(Ke)?Ke.__numberFormatters:void 0;const It=cR(ut);return T&&ET(It),It})(),Ag(Ke,$.value,Z.value);function ri(){return[$.value,Z.value,J.value,ne.value,ue.value]}const bt=fn({get:()=>$.value,set:ut=>{$.value=ut,Ke.locale=$.value}}),dt=fn({get:()=>Z.value,set:ut=>{Z.value=ut,Ke.fallbackLocale=Z.value,Ag(Ke,$.value,ut)}}),kt=fn(()=>J.value),Pt=fn(()=>ne.value),vt=fn(()=>ue.value);function ci(){return Dn(ge)?ge:null}function xi(ut){ge=ut,Ke.postTranslation=ut}function vi(){return je}function Lr(ut){ut!==null&&(ae=BT(ut)),je=ut,Ke.missing=ae}const ir=(ut,It,Ii,Oi,Gr,Ur)=>{ri();let un;try{__INTLIFY_PROD_DEVTOOLS__,T||(Ke.fallbackContext=d?lR():void 0),un=ut(Ke)}finally{__INTLIFY_PROD_DEVTOOLS__,T||(Ke.fallbackContext=void 0)}if(Ii!=="translate exists"&&hs(un)&&un===zx||Ii==="translate exists"&&!un){const[cr,us]=It();return d&&Ye?Oi(d):Gr(cr)}else{if(Ur(un))return un;throw $s(Ps.UNEXPECTED_RETURN_TYPE)}};function sr(...ut){return ir(It=>Reflect.apply(MT,null,[It,...ut]),()=>Z0(...ut),"translate",It=>Reflect.apply(It.t,It,[...ut]),It=>It,It=>Ci(It))}function nn(...ut){const[It,Ii,Oi]=ut;if(Oi&&!Xr(Oi))throw $s(Ps.INVALID_ARGUMENT);return sr(It,Ii,Zs({resolvedMessage:!0},Oi||{}))}function fr(...ut){return ir(It=>Reflect.apply(IT,null,[It,...ut]),()=>Y0(...ut),"datetime format",It=>Reflect.apply(It.d,It,[...ut]),()=>bT,It=>Ci(It))}function Bn(...ut){return ir(It=>Reflect.apply(PT,null,[It,...ut]),()=>K0(...ut),"number format",It=>Reflect.apply(It.n,It,[...ut]),()=>bT,It=>Ci(It))}function sn(ut){return ut.map(It=>Ci(It)||hs(It)||Cr(It)?DT(String(It)):It)}const mi={normalize:sn,interpolate:ut=>ut,type:"vnode"};function si(...ut){return ir(It=>{let Ii;const Oi=It;try{Oi.processor=mi,Ii=Reflect.apply(MT,null,[Oi,...ut])}finally{Oi.processor=null}return Ii},()=>Z0(...ut),"translate",It=>It[J0](...ut),It=>[DT(It)],It=>$n(It))}function Ei(...ut){return ir(It=>Reflect.apply(PT,null,[It,...ut]),()=>K0(...ut),"number format",It=>It[eb](...ut),RT,It=>Ci(It)||$n(It))}function or(...ut){return ir(It=>Reflect.apply(IT,null,[It,...ut]),()=>Y0(...ut),"datetime format",It=>It[Q0](...ut),RT,It=>Ci(It)||$n(It))}function Si(ut){ke=ut,Ke.pluralRules=ke}function xe(ut,It){return ir(()=>{if(!ut)return!1;const Ii=Ci(It)?It:$.value,Oi=Lt(Ii),Gr=Ke.messageResolver(Oi,ut);return V?Gr!=null:Dc(Gr)||nl(Gr)||Ci(Gr)},()=>[ut],"translate exists",Ii=>Reflect.apply(Ii.te,Ii,[ut,It]),wR,Ii=>Cr(Ii))}function ve(ut){let It=null;const Ii=GC(Ke,Z.value,$.value);for(let Oi=0;Oi<Ii.length;Oi++){const Gr=J.value[Ii[Oi]]||{},Ur=Ke.messageResolver(Gr,ut);if(Ur!=null){It=Ur;break}}return It}function nt(ut){const It=ve(ut);return It??(d?d.tm(ut)||{}:{})}function Lt(ut){return J.value[ut]||{}}function At(ut,It){if(C){const Ii={[ut]:It};for(const Oi in Ii)zl(Ii,Oi)&&r_(Ii[Oi]);It=Ii[ut]}J.value[ut]=It,Ke.messages=J.value}function Yt(ut,It){J.value[ut]=J.value[ut]||{};const Ii={[ut]:It};if(C)for(const Oi in Ii)zl(Ii,Oi)&&r_(Ii[Oi]);It=Ii[ut],Ny(It,J.value[ut]),Ke.messages=J.value}function oi(ut){return ne.value[ut]||{}}function Te(ut,It){ne.value[ut]=It,Ke.datetimeFormats=ne.value,kT(Ke,ut,It)}function Ae(ut,It){ne.value[ut]=Zs(ne.value[ut]||{},It),Ke.datetimeFormats=ne.value,kT(Ke,ut,It)}function Qe(ut){return ue.value[ut]||{}}function Wt(ut,It){ue.value[ut]=It,Ke.numberFormats=ue.value,LT(Ke,ut,It)}function Ht(ut,It){ue.value[ut]=Zs(ue.value[ut]||{},It),Ke.numberFormats=ue.value,LT(Ke,ut,It)}zT++,d&&ox&&(ha(d.locale,ut=>{s&&($.value=ut,Ke.locale=ut,Ag(Ke,$.value,Z.value))}),ha(d.fallbackLocale,ut=>{s&&(Z.value=ut,Ke.fallbackLocale=ut,Ag(Ke,$.value,Z.value))}));const Kt={id:zT,locale:bt,fallbackLocale:dt,get inheritLocale(){return s},set inheritLocale(ut){s=ut,ut&&d&&($.value=d.locale.value,Z.value=d.fallbackLocale.value,Ag(Ke,$.value,Z.value))},get availableLocales(){return Object.keys(J.value).sort()},messages:kt,get modifiers(){return rt},get pluralRules(){return ke||{}},get isGlobal(){return T},get missingWarn(){return we},set missingWarn(ut){we=ut,Ke.missingWarn=we},get fallbackWarn(){return Me},set fallbackWarn(ut){Me=ut,Ke.fallbackWarn=Me},get fallbackRoot(){return Ye},set fallbackRoot(ut){Ye=ut},get fallbackFormat(){return Ze},set fallbackFormat(ut){Ze=ut,Ke.fallbackFormat=Ze},get warnHtmlMessage(){return Oe},set warnHtmlMessage(ut){Oe=ut,Ke.warnHtmlMessage=ut},get escapeParameter(){return ze},set escapeParameter(ut){ze=ut,Ke.escapeParameter=ut},t:sr,getLocaleMessage:Lt,setLocaleMessage:At,mergeLocaleMessage:Yt,getPostTranslationHandler:ci,setPostTranslationHandler:xi,getMissingHandler:vi,setMissingHandler:Lr,[rA]:Si};return Kt.datetimeFormats=Pt,Kt.numberFormats=vt,Kt.rt=nn,Kt.te=xe,Kt.tm=nt,Kt.d=fr,Kt.n=Bn,Kt.getDateTimeFormat=oi,Kt.setDateTimeFormat=Te,Kt.mergeDateTimeFormat=Ae,Kt.getNumberFormat=Qe,Kt.setNumberFormat=Wt,Kt.mergeNumberFormat=Ht,Kt[nA]=_,Kt[J0]=si,Kt[Q0]=or,Kt[eb]=Ei,Kt}function ER(t){const l=Ci(t.locale)?t.locale:um,d=Ci(t.fallbackLocale)||$n(t.fallbackLocale)||ur(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:l,_=Dn(t.missing)?t.missing:void 0,T=Cr(t.silentTranslationWarn)||Yu(t.silentTranslationWarn)?!t.silentTranslationWarn:!0,C=Cr(t.silentFallbackWarn)||Yu(t.silentFallbackWarn)?!t.silentFallbackWarn:!0,P=Cr(t.fallbackRoot)?t.fallbackRoot:!0,V=!!t.formatFallbackMessages,s=ur(t.modifiers)?t.modifiers:{},$=t.pluralizationRules,Z=Dn(t.postTranslation)?t.postTranslation:void 0,J=Ci(t.warnHtmlInMessage)?t.warnHtmlInMessage!=="off":!0,ne=!!t.escapeParameterHtml,ue=Cr(t.sync)?t.sync:!0;let we=t.messages;if(ur(t.sharedMessages)){const ze=t.sharedMessages;we=Object.keys(ze).reduce((ke,Ke)=>{const He=ke[Ke]||(ke[Ke]={});return Zs(He,ze[Ke]),ke},we||{})}const{__i18n:Me,__root:Ye,__injectWithOption:Ze}=t,je=t.datetimeFormats,ae=t.numberFormats,ge=t.flatJson,Oe=t.translateExistCompatible;return{locale:l,fallbackLocale:d,messages:we,flatJson:ge,datetimeFormats:je,numberFormats:ae,missing:_,missingWarn:T,fallbackWarn:C,fallbackRoot:P,fallbackFormat:V,modifiers:s,pluralRules:$,postTranslation:Z,warnHtmlMessage:J,escapeParameter:ne,messageResolver:t.messageResolver,inheritLocale:ue,translateExistCompatible:Oe,__i18n:Me,__root:Ye,__injectWithOption:Ze}}function ib(t={},l){{const d=Xb(ER(t)),{__extender:_}=t,T={id:d.id,get locale(){return d.locale.value},set locale(C){d.locale.value=C},get fallbackLocale(){return d.fallbackLocale.value},set fallbackLocale(C){d.fallbackLocale.value=C},get messages(){return d.messages.value},get datetimeFormats(){return d.datetimeFormats.value},get numberFormats(){return d.numberFormats.value},get availableLocales(){return d.availableLocales},get formatter(){return{interpolate(){return[]}}},set formatter(C){},get missing(){return d.getMissingHandler()},set missing(C){d.setMissingHandler(C)},get silentTranslationWarn(){return Cr(d.missingWarn)?!d.missingWarn:d.missingWarn},set silentTranslationWarn(C){d.missingWarn=Cr(C)?!C:C},get silentFallbackWarn(){return Cr(d.fallbackWarn)?!d.fallbackWarn:d.fallbackWarn},set silentFallbackWarn(C){d.fallbackWarn=Cr(C)?!C:C},get modifiers(){return d.modifiers},get formatFallbackMessages(){return d.fallbackFormat},set formatFallbackMessages(C){d.fallbackFormat=C},get postTranslation(){return d.getPostTranslationHandler()},set postTranslation(C){d.setPostTranslationHandler(C)},get sync(){return d.inheritLocale},set sync(C){d.inheritLocale=C},get warnHtmlInMessage(){return d.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(C){d.warnHtmlMessage=C!=="off"},get escapeParameterHtml(){return d.escapeParameter},set escapeParameterHtml(C){d.escapeParameter=C},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(C){},get pluralizationRules(){return d.pluralRules||{}},__composer:d,t(...C){const[P,V,s]=C,$={};let Z=null,J=null;if(!Ci(P))throw $s(Ps.INVALID_ARGUMENT);const ne=P;return Ci(V)?$.locale=V:$n(V)?Z=V:ur(V)&&(J=V),$n(s)?Z=s:ur(s)&&(J=s),Reflect.apply(d.t,d,[ne,Z||J||{},$])},rt(...C){return Reflect.apply(d.rt,d,[...C])},tc(...C){const[P,V,s]=C,$={plural:1};let Z=null,J=null;if(!Ci(P))throw $s(Ps.INVALID_ARGUMENT);const ne=P;return Ci(V)?$.locale=V:hs(V)?$.plural=V:$n(V)?Z=V:ur(V)&&(J=V),Ci(s)?$.locale=s:$n(s)?Z=s:ur(s)&&(J=s),Reflect.apply(d.t,d,[ne,Z||J||{},$])},te(C,P){return d.te(C,P)},tm(C){return d.tm(C)},getLocaleMessage(C){return d.getLocaleMessage(C)},setLocaleMessage(C,P){d.setLocaleMessage(C,P)},mergeLocaleMessage(C,P){d.mergeLocaleMessage(C,P)},d(...C){return Reflect.apply(d.d,d,[...C])},getDateTimeFormat(C){return d.getDateTimeFormat(C)},setDateTimeFormat(C,P){d.setDateTimeFormat(C,P)},mergeDateTimeFormat(C,P){d.mergeDateTimeFormat(C,P)},n(...C){return Reflect.apply(d.n,d,[...C])},getNumberFormat(C){return d.getNumberFormat(C)},setNumberFormat(C,P){d.setNumberFormat(C,P)},mergeNumberFormat(C,P){d.mergeNumberFormat(C,P)},getChoiceIndex(C,P){return-1}};return T.__extender=_,T}}const Zb={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:t=>t==="parent"||t==="global",default:"parent"},i18n:{type:Object}};function SR({slots:t},l){return l.length===1&&l[0]==="default"?(t.default?t.default():[]).reduce((_,T)=>[..._,...T.type===$r?T.children:[T]],[]):l.reduce((d,_)=>{const T=t[_];return T&&(d[_]=T()),d},gn())}function aA(t){return $r}const CR=zn({name:"i18n-t",props:Zs({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:t=>hs(t)||!isNaN(t)}},Zb),setup(t,l){const{slots:d,attrs:_}=l,T=t.i18n||_m({useScope:t.scope,__useComponent:!0});return()=>{const C=Object.keys(d).filter(J=>J!=="_"),P=gn();t.locale&&(P.locale=t.locale),t.plural!==void 0&&(P.plural=Ci(t.plural)?+t.plural:t.plural);const V=SR(l,C),s=T[J0](t.keypath,V,P),$=Zs(gn(),_),Z=Ci(t.tag)||Xr(t.tag)?t.tag:aA();return mm(Z,$,s)}}}),FT=CR;function AR(t){return $n(t)&&!Ci(t[0])}function lA(t,l,d,_){const{slots:T,attrs:C}=l;return()=>{const P={part:!0};let V=gn();t.locale&&(P.locale=t.locale),Ci(t.format)?P.key=t.format:Xr(t.format)&&(Ci(t.format.key)&&(P.key=t.format.key),V=Object.keys(t.format).reduce((ne,ue)=>d.includes(ue)?Zs(gn(),ne,{[ue]:t.format[ue]}):ne,gn()));const s=_(t.value,P,V);let $=[P.key];$n(s)?$=s.map((ne,ue)=>{const we=T[ne.type],Me=we?we({[ne.type]:ne.value,index:ue,parts:s}):[ne.value];return AR(Me)&&(Me[0].key=`${ne.type}-${ue}`),Me}):Ci(s)&&($=[s]);const Z=Zs(gn(),C),J=Ci(t.tag)||Xr(t.tag)?t.tag:aA();return mm(J,Z,$)}}const MR=zn({name:"i18n-n",props:Zs({value:{type:Number,required:!0},format:{type:[String,Object]}},Zb),setup(t,l){const d=t.i18n||_m({useScope:t.scope,__useComponent:!0});return lA(t,l,tA,(..._)=>d[eb](..._))}}),NT=MR,IR=zn({name:"i18n-d",props:Zs({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},Zb),setup(t,l){const d=t.i18n||_m({useScope:t.scope,__useComponent:!0});return lA(t,l,eA,(..._)=>d[Q0](..._))}}),UT=IR;function kR(t,l){const d=t;if(t.mode==="composition")return d.__getInstance(l)||t.global;{const _=d.__getInstance(l);return _!=null?_.__composer:t.global.__composer}}function PR(t){const l=P=>{const{instance:V,modifiers:s,value:$}=P;if(!V||!V.$)throw $s(Ps.UNEXPECTED_ERROR);const Z=kR(t,V.$),J=VT($);return[Reflect.apply(Z.t,Z,[...jT(J)]),Z]};return{created:(P,V)=>{const[s,$]=l(V);ox&&t.global===$&&(P.__i18nWatcher=ha($.locale,()=>{V.instance&&V.instance.$forceUpdate()})),P.__composer=$,P.textContent=s},unmounted:P=>{ox&&P.__i18nWatcher&&(P.__i18nWatcher(),P.__i18nWatcher=void 0,delete P.__i18nWatcher),P.__composer&&(P.__composer=void 0,delete P.__composer)},beforeUpdate:(P,{value:V})=>{if(P.__composer){const s=P.__composer,$=VT(V);P.textContent=Reflect.apply(s.t,s,[...jT($)])}},getSSRProps:P=>{const[V]=l(P);return{textContent:V}}}}function VT(t){if(Ci(t))return{path:t};if(ur(t)){if(!("path"in t))throw $s(Ps.REQUIRED_VALUE,"path");return t}else throw $s(Ps.INVALID_VALUE)}function jT(t){const{path:l,locale:d,args:_,choice:T,plural:C}=t,P={},V=_||{};return Ci(d)&&(P.locale=d),hs(T)&&(P.plural=T),hs(C)&&(P.plural=C),[l,V,P]}function LR(t,l,...d){const _=ur(d[0])?d[0]:{},T=!!_.useI18nComponentName;(Cr(_.globalInstall)?_.globalInstall:!0)&&([T?"i18n":FT.name,"I18nT"].forEach(P=>t.component(P,FT)),[NT.name,"I18nN"].forEach(P=>t.component(P,NT)),[UT.name,"I18nD"].forEach(P=>t.component(P,UT))),t.directive("t",PR(l))}function DR(t,l,d){return{beforeCreate(){const _=Ys();if(!_)throw $s(Ps.UNEXPECTED_ERROR);const T=this.$options;if(T.i18n){const C=T.i18n;if(T.__i18n&&(C.__i18n=T.__i18n),C.__root=l,this===this.$root)this.$i18n=$T(t,C);else{C.__injectWithOption=!0,C.__extender=d.__vueI18nExtend,this.$i18n=ib(C);const P=this.$i18n;P.__extender&&(P.__disposer=P.__extender(this.$i18n))}}else if(T.__i18n)if(this===this.$root)this.$i18n=$T(t,T);else{this.$i18n=ib({__i18n:T.__i18n,__injectWithOption:!0,__extender:d.__vueI18nExtend,__root:l});const C=this.$i18n;C.__extender&&(C.__disposer=C.__extender(this.$i18n))}else this.$i18n=t;T.__i18nGlobal&&oA(l,T,T),this.$t=(...C)=>this.$i18n.t(...C),this.$rt=(...C)=>this.$i18n.rt(...C),this.$tc=(...C)=>this.$i18n.tc(...C),this.$te=(C,P)=>this.$i18n.te(C,P),this.$d=(...C)=>this.$i18n.d(...C),this.$n=(...C)=>this.$i18n.n(...C),this.$tm=C=>this.$i18n.tm(C),d.__setInstance(_,this.$i18n)},mounted(){},unmounted(){const _=Ys();if(!_)throw $s(Ps.UNEXPECTED_ERROR);const T=this.$i18n;delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,T.__disposer&&(T.__disposer(),delete T.__disposer,delete T.__extender),d.__deleteInstance(_),delete this.$i18n}}}function $T(t,l){t.locale=l.locale||t.locale,t.fallbackLocale=l.fallbackLocale||t.fallbackLocale,t.missing=l.missing||t.missing,t.silentTranslationWarn=l.silentTranslationWarn||t.silentFallbackWarn,t.silentFallbackWarn=l.silentFallbackWarn||t.silentFallbackWarn,t.formatFallbackMessages=l.formatFallbackMessages||t.formatFallbackMessages,t.postTranslation=l.postTranslation||t.postTranslation,t.warnHtmlInMessage=l.warnHtmlInMessage||t.warnHtmlInMessage,t.escapeParameterHtml=l.escapeParameterHtml||t.escapeParameterHtml,t.sync=l.sync||t.sync,t.__composer[rA](l.pluralizationRules||t.pluralizationRules);const d=Bx(t.locale,{messages:l.messages,__i18n:l.__i18n});return Object.keys(d).forEach(_=>t.mergeLocaleMessage(_,d[_])),l.datetimeFormats&&Object.keys(l.datetimeFormats).forEach(_=>t.mergeDateTimeFormat(_,l.datetimeFormats[_])),l.numberFormats&&Object.keys(l.numberFormats).forEach(_=>t.mergeNumberFormat(_,l.numberFormats[_])),t}const OR=Qu("global-vue-i18n");function RR(t={},l){const d=__VUE_I18N_LEGACY_API__&&Cr(t.legacy)?t.legacy:__VUE_I18N_LEGACY_API__,_=Cr(t.globalInjection)?t.globalInjection:!0,T=__VUE_I18N_LEGACY_API__&&d?!!t.allowComposition:!0,C=new Map,[P,V]=zR(t,d),s=Qu("");function $(ne){return C.get(ne)||null}function Z(ne,ue){C.set(ne,ue)}function J(ne){C.delete(ne)}{const ne={get mode(){return __VUE_I18N_LEGACY_API__&&d?"legacy":"composition"},get allowComposition(){return T},async install(ue,...we){if(ue.__VUE_I18N_SYMBOL__=s,ue.provide(ue.__VUE_I18N_SYMBOL__,ne),ur(we[0])){const Ze=we[0];ne.__composerExtend=Ze.__composerExtend,ne.__vueI18nExtend=Ze.__vueI18nExtend}let Me=null;!d&&_&&(Me=WR(ue,ne.global)),__VUE_I18N_FULL_INSTALL__&&LR(ue,ne,...we),__VUE_I18N_LEGACY_API__&&d&&ue.mixin(DR(V,V.__composer,ne));const Ye=ue.unmount;ue.unmount=()=>{Me&&Me(),ne.dispose(),Ye()}},get global(){return V},dispose(){P.stop()},__instances:C,__getInstance:$,__setInstance:Z,__deleteInstance:J};return ne}}function _m(t={}){const l=Ys();if(l==null)throw $s(Ps.MUST_BE_CALL_SETUP_TOP);if(!l.isCE&&l.appContext.app!=null&&!l.appContext.app.__VUE_I18N_SYMBOL__)throw $s(Ps.NOT_INSTALLED);const d=BR(l),_=NR(d),T=sA(l),C=FR(t,T);if(__VUE_I18N_LEGACY_API__&&d.mode==="legacy"&&!t.__useComponent){if(!d.allowComposition)throw $s(Ps.NOT_AVAILABLE_IN_LEGACY_MODE);return $R(l,C,_,t)}if(C==="global")return oA(_,t,T),_;if(C==="parent"){let s=UR(d,l,t.__useComponent);return s==null&&(s=_),s}const P=d;let V=P.__getInstance(l);if(V==null){const s=Zs({},t);"__i18n"in T&&(s.__i18n=T.__i18n),_&&(s.__root=_),V=Xb(s),P.__composerExtend&&(V[tb]=P.__composerExtend(V)),jR(P,l,V),P.__setInstance(l,V)}return V}function zR(t,l,d){const _=gx();{const T=__VUE_I18N_LEGACY_API__&&l?_.run(()=>ib(t)):_.run(()=>Xb(t));if(T==null)throw $s(Ps.UNEXPECTED_ERROR);return[_,T]}}function BR(t){{const l=ca(t.isCE?OR:t.appContext.app.__VUE_I18N_SYMBOL__);if(!l)throw $s(t.isCE?Ps.NOT_INSTALLED_WITH_PROVIDE:Ps.UNEXPECTED_ERROR);return l}}function FR(t,l){return Ox(t)?"__i18n"in l?"local":"global":t.useScope?t.useScope:"local"}function NR(t){return t.mode==="composition"?t.global:t.global.__composer}function UR(t,l,d=!1){let _=null;const T=l.root;let C=VR(l,d);for(;C!=null;){const P=t;if(t.mode==="composition")_=P.__getInstance(C);else if(__VUE_I18N_LEGACY_API__){const V=P.__getInstance(C);V!=null&&(_=V.__composer,d&&_&&!_[nA]&&(_=null))}if(_!=null||T===C)break;C=C.parent}return _}function VR(t,l=!1){return t==null?null:l&&t.vnode.ctx||t.parent}function jR(t,l,d){Oh(()=>{},l),h_(()=>{const _=d;t.__deleteInstance(l);const T=_[tb];T&&(T(),delete _[tb])},l)}function $R(t,l,d,_={}){const T=l==="local",C=l_(null);if(T&&t.proxy&&!(t.proxy.$options.i18n||t.proxy.$options.__i18n))throw $s(Ps.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION);const P=Cr(_.inheritLocale)?_.inheritLocale:!Ci(_.locale),V=Vi(!T||P?d.locale.value:Ci(_.locale)?_.locale:um),s=Vi(!T||P?d.fallbackLocale.value:Ci(_.fallbackLocale)||$n(_.fallbackLocale)||ur(_.fallbackLocale)||_.fallbackLocale===!1?_.fallbackLocale:V.value),$=Vi(Bx(V.value,_)),Z=Vi(ur(_.datetimeFormats)?_.datetimeFormats:{[V.value]:{}}),J=Vi(ur(_.numberFormats)?_.numberFormats:{[V.value]:{}}),ne=T?d.missingWarn:Cr(_.missingWarn)||Yu(_.missingWarn)?_.missingWarn:!0,ue=T?d.fallbackWarn:Cr(_.fallbackWarn)||Yu(_.fallbackWarn)?_.fallbackWarn:!0,we=T?d.fallbackRoot:Cr(_.fallbackRoot)?_.fallbackRoot:!0,Me=!!_.fallbackFormat,Ye=Dn(_.missing)?_.missing:null,Ze=Dn(_.postTranslation)?_.postTranslation:null,je=T?d.warnHtmlMessage:Cr(_.warnHtmlMessage)?_.warnHtmlMessage:!0,ae=!!_.escapeParameter,ge=T?d.modifiers:ur(_.modifiers)?_.modifiers:{},Oe=_.pluralRules||T&&d.pluralRules;function ze(){return[V.value,s.value,$.value,Z.value,J.value]}const rt=fn({get:()=>C.value?C.value.locale.value:V.value,set:ve=>{C.value&&(C.value.locale.value=ve),V.value=ve}}),ke=fn({get:()=>C.value?C.value.fallbackLocale.value:s.value,set:ve=>{C.value&&(C.value.fallbackLocale.value=ve),s.value=ve}}),Ke=fn(()=>C.value?C.value.messages.value:$.value),He=fn(()=>Z.value),ri=fn(()=>J.value);function bt(){return C.value?C.value.getPostTranslationHandler():Ze}function dt(ve){C.value&&C.value.setPostTranslationHandler(ve)}function kt(){return C.value?C.value.getMissingHandler():Ye}function Pt(ve){C.value&&C.value.setMissingHandler(ve)}function vt(ve){return ze(),ve()}function ci(...ve){return C.value?vt(()=>Reflect.apply(C.value.t,null,[...ve])):vt(()=>"")}function xi(...ve){return C.value?Reflect.apply(C.value.rt,null,[...ve]):""}function vi(...ve){return C.value?vt(()=>Reflect.apply(C.value.d,null,[...ve])):vt(()=>"")}function Lr(...ve){return C.value?vt(()=>Reflect.apply(C.value.n,null,[...ve])):vt(()=>"")}function ir(ve){return C.value?C.value.tm(ve):{}}function sr(ve,nt){return C.value?C.value.te(ve,nt):!1}function nn(ve){return C.value?C.value.getLocaleMessage(ve):{}}function fr(ve,nt){C.value&&(C.value.setLocaleMessage(ve,nt),$.value[ve]=nt)}function Bn(ve,nt){C.value&&C.value.mergeLocaleMessage(ve,nt)}function sn(ve){return C.value?C.value.getDateTimeFormat(ve):{}}function zt(ve,nt){C.value&&(C.value.setDateTimeFormat(ve,nt),Z.value[ve]=nt)}function mi(ve,nt){C.value&&C.value.mergeDateTimeFormat(ve,nt)}function si(ve){return C.value?C.value.getNumberFormat(ve):{}}function Ei(ve,nt){C.value&&(C.value.setNumberFormat(ve,nt),J.value[ve]=nt)}function or(ve,nt){C.value&&C.value.mergeNumberFormat(ve,nt)}const Si={get id(){return C.value?C.value.id:-1},locale:rt,fallbackLocale:ke,messages:Ke,datetimeFormats:He,numberFormats:ri,get inheritLocale(){return C.value?C.value.inheritLocale:P},set inheritLocale(ve){C.value&&(C.value.inheritLocale=ve)},get availableLocales(){return C.value?C.value.availableLocales:Object.keys($.value)},get modifiers(){return C.value?C.value.modifiers:ge},get pluralRules(){return C.value?C.value.pluralRules:Oe},get isGlobal(){return C.value?C.value.isGlobal:!1},get missingWarn(){return C.value?C.value.missingWarn:ne},set missingWarn(ve){C.value&&(C.value.missingWarn=ve)},get fallbackWarn(){return C.value?C.value.fallbackWarn:ue},set fallbackWarn(ve){C.value&&(C.value.missingWarn=ve)},get fallbackRoot(){return C.value?C.value.fallbackRoot:we},set fallbackRoot(ve){C.value&&(C.value.fallbackRoot=ve)},get fallbackFormat(){return C.value?C.value.fallbackFormat:Me},set fallbackFormat(ve){C.value&&(C.value.fallbackFormat=ve)},get warnHtmlMessage(){return C.value?C.value.warnHtmlMessage:je},set warnHtmlMessage(ve){C.value&&(C.value.warnHtmlMessage=ve)},get escapeParameter(){return C.value?C.value.escapeParameter:ae},set escapeParameter(ve){C.value&&(C.value.escapeParameter=ve)},t:ci,getPostTranslationHandler:bt,setPostTranslationHandler:dt,getMissingHandler:kt,setMissingHandler:Pt,rt:xi,d:vi,n:Lr,tm:ir,te:sr,getLocaleMessage:nn,setLocaleMessage:fr,mergeLocaleMessage:Bn,getDateTimeFormat:sn,setDateTimeFormat:zt,mergeDateTimeFormat:mi,getNumberFormat:si,setNumberFormat:Ei,mergeNumberFormat:or};function xe(ve){ve.locale.value=V.value,ve.fallbackLocale.value=s.value,Object.keys($.value).forEach(nt=>{ve.mergeLocaleMessage(nt,$.value[nt])}),Object.keys(Z.value).forEach(nt=>{ve.mergeDateTimeFormat(nt,Z.value[nt])}),Object.keys(J.value).forEach(nt=>{ve.mergeNumberFormat(nt,J.value[nt])}),ve.escapeParameter=ae,ve.fallbackFormat=Me,ve.fallbackRoot=we,ve.fallbackWarn=ue,ve.missingWarn=ne,ve.warnHtmlMessage=je}return Mb(()=>{if(t.proxy==null||t.proxy.$i18n==null)throw $s(Ps.NOT_AVAILABLE_COMPOSITION_IN_LEGACY);const ve=C.value=t.proxy.$i18n.__composer;l==="global"?(V.value=ve.locale.value,s.value=ve.fallbackLocale.value,$.value=ve.messages.value,Z.value=ve.datetimeFormats.value,J.value=ve.numberFormats.value):T&&xe(ve)}),Si}const GR=["locale","fallbackLocale","availableLocales"],GT=["t","rt","d","n","tm","te"];function WR(t,l){const d=Object.create(null);return GR.forEach(T=>{const C=Object.getOwnPropertyDescriptor(l,T);if(!C)throw $s(Ps.UNEXPECTED_ERROR);const P=On(C.value)?{get(){return C.value.value},set(V){C.value.value=V}}:{get(){return C.get&&C.get()}};Object.defineProperty(d,T,P)}),t.config.globalProperties.$i18n=d,GT.forEach(T=>{const C=Object.getOwnPropertyDescriptor(l,T);if(!C||!C.value)throw $s(Ps.UNEXPECTED_ERROR);Object.defineProperty(t.config.globalProperties,`$${T}`,C)}),()=>{delete t.config.globalProperties.$i18n,GT.forEach(T=>{delete t.config.globalProperties[`$${T}`]})}}vR();__INTLIFY_JIT_COMPILATION__?TT(pR):TT(fR);nR(FO);sR(GC);if(__INTLIFY_PROD_DEVTOOLS__){const t=Ah();t.__INTLIFY__=!0,qO(t.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}/*!
 * pinia v3.0.2
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let cA;const Fx=t=>cA=t,hA=Symbol();function rb(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Vg;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Vg||(Vg={}));function HR(){const t=gx(!0),l=t.run(()=>Vi({}));let d=[],_=[];const T=wx({install(C){Fx(T),T._a=C,C.provide(hA,T),C.config.globalProperties.$pinia=T,_.forEach(P=>d.push(P)),_=[]},use(C){return this._a?d.push(C):_.push(C),this},_p:d,_a:null,_e:t,_s:new Map,state:l});return T}const uA=()=>{};function WT(t,l,d,_=uA){t.push(l);const T=()=>{const C=t.indexOf(l);C>-1&&(t.splice(C,1),_())};return!d&&_b()&&yE(T),T}function Wp(t,...l){t.slice().forEach(d=>{d(...l)})}const qR=t=>t(),HT=Symbol(),x0=Symbol();function nb(t,l){t instanceof Map&&l instanceof Map?l.forEach((d,_)=>t.set(_,d)):t instanceof Set&&l instanceof Set&&l.forEach(t.add,t);for(const d in l){if(!l.hasOwnProperty(d))continue;const _=l[d],T=t[d];rb(T)&&rb(_)&&t.hasOwnProperty(d)&&!On(_)&&!Ul(_)?t[d]=nb(T,_):t[d]=_}return t}const XR=Symbol();function ZR(t){return!rb(t)||!Object.prototype.hasOwnProperty.call(t,XR)}const{assign:Uu}=Object;function YR(t){return!!(On(t)&&t.effect)}function KR(t,l,d,_){const{state:T,actions:C,getters:P}=l,V=d.state.value[t];let s;function $(){V||(d.state.value[t]=T?T():{});const Z=zE(d.state.value[t]);return Uu(Z,C,Object.keys(P||{}).reduce((J,ne)=>(J[ne]=wx(fn(()=>{Fx(d);const ue=d._s.get(t);return P[ne].call(ue,ue)})),J),{}))}return s=dA(t,$,l,d,_,!0),s}function dA(t,l,d={},_,T,C){let P;const V=Uu({actions:{}},d),s={deep:!0};let $,Z,J=[],ne=[],ue;const we=_.state.value[t];!C&&!we&&(_.state.value[t]={}),Vi({});let Me;function Ye(ke){let Ke;$=Z=!1,typeof ke=="function"?(ke(_.state.value[t]),Ke={type:Vg.patchFunction,storeId:t,events:ue}):(nb(_.state.value[t],ke),Ke={type:Vg.patchObject,payload:ke,storeId:t,events:ue});const He=Me=Symbol();Bf().then(()=>{Me===He&&($=!0)}),Z=!0,Wp(J,Ke,_.state.value[t])}const Ze=C?function(){const{state:Ke}=d,He=Ke?Ke():{};this.$patch(ri=>{Uu(ri,He)})}:uA;function je(){P.stop(),J=[],ne=[],_._s.delete(t)}const ae=(ke,Ke="")=>{if(HT in ke)return ke[x0]=Ke,ke;const He=function(){Fx(_);const ri=Array.from(arguments),bt=[],dt=[];function kt(ci){bt.push(ci)}function Pt(ci){dt.push(ci)}Wp(ne,{args:ri,name:He[x0],store:Oe,after:kt,onError:Pt});let vt;try{vt=ke.apply(this&&this.$id===t?this:Oe,ri)}catch(ci){throw Wp(dt,ci),ci}return vt instanceof Promise?vt.then(ci=>(Wp(bt,ci),ci)).catch(ci=>(Wp(dt,ci),Promise.reject(ci))):(Wp(bt,vt),vt)};return He[HT]=!0,He[x0]=Ke,He},ge={_p:_,$id:t,$onAction:WT.bind(null,ne),$patch:Ye,$reset:Ze,$subscribe(ke,Ke={}){const He=WT(J,ke,Ke.detached,()=>ri()),ri=P.run(()=>ha(()=>_.state.value[t],bt=>{(Ke.flush==="sync"?Z:$)&&ke({storeId:t,type:Vg.direct,events:ue},bt)},Uu({},s,Ke)));return He},$dispose:je},Oe=fm(ge);_._s.set(t,Oe);const rt=(_._a&&_._a.runWithContext||qR)(()=>_._e.run(()=>(P=gx()).run(()=>l({action:ae}))));for(const ke in rt){const Ke=rt[ke];if(On(Ke)&&!YR(Ke)||Ul(Ke))C||(we&&ZR(Ke)&&(On(Ke)?Ke.value=we[ke]:nb(Ke,we[ke])),_.state.value[t][ke]=Ke);else if(typeof Ke=="function"){const He=ae(Ke,ke);rt[ke]=He,V.actions[ke]=Ke}}return Uu(Oe,rt),Uu(kr(Oe),rt),Object.defineProperty(Oe,"$state",{get:()=>_.state.value[t],set:ke=>{Ye(Ke=>{Uu(Ke,ke)})}}),_._p.forEach(ke=>{Uu(Oe,P.run(()=>ke({store:Oe,app:_._a,pinia:_,options:V})))}),we&&C&&d.hydrate&&d.hydrate(Oe.$state,we),$=!0,Z=!0,Oe}/*! #__NO_SIDE_EFFECTS__ */function fA(t,l,d){let _;const T=typeof l=="function";_=T?d:l;function C(P,V){const s=dS();return P=P||(s?ca(hA,null):null),P&&Fx(P),P=cA,P._s.has(t)||(T?dA(t,l,_,P):KR(t,_,P)),P._s.get(t)}return C.$id=t,C}function JR(t){const l=kr(t),d={};for(const _ in l){const T=l[_];T.effect?d[_]=fn({get:()=>t[_],set(C){t[_]=C}}):(On(T)||Ul(T))&&(d[_]=BE(t,_))}return d}function pA(t,l){return function(){return t.apply(l,arguments)}}const{toString:QR}=Object.prototype,{getPrototypeOf:Yb}=Object,Nx=(t=>l=>{const d=QR.call(l);return t[d]||(t[d]=d.slice(8,-1).toLowerCase())})(Object.create(null)),$l=t=>(t=t.toLowerCase(),l=>Nx(l)===t),Ux=t=>l=>typeof l===t,{isArray:ym}=Array,n_=Ux("undefined");function ez(t){return t!==null&&!n_(t)&&t.constructor!==null&&!n_(t.constructor)&&Na(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const mA=$l("ArrayBuffer");function tz(t){let l;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?l=ArrayBuffer.isView(t):l=t&&t.buffer&&mA(t.buffer),l}const iz=Ux("string"),Na=Ux("function"),gA=Ux("number"),Vx=t=>t!==null&&typeof t=="object",rz=t=>t===!0||t===!1,Uy=t=>{if(Nx(t)!=="object")return!1;const l=Yb(t);return(l===null||l===Object.prototype||Object.getPrototypeOf(l)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},nz=$l("Date"),sz=$l("File"),oz=$l("Blob"),az=$l("FileList"),lz=t=>Vx(t)&&Na(t.pipe),cz=t=>{let l;return t&&(typeof FormData=="function"&&t instanceof FormData||Na(t.append)&&((l=Nx(t))==="formdata"||l==="object"&&Na(t.toString)&&t.toString()==="[object FormData]"))},hz=$l("URLSearchParams"),[uz,dz,fz,pz]=["ReadableStream","Request","Response","Headers"].map($l),mz=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function p_(t,l,{allOwnKeys:d=!1}={}){if(t===null||typeof t>"u")return;let _,T;if(typeof t!="object"&&(t=[t]),ym(t))for(_=0,T=t.length;_<T;_++)l.call(null,t[_],_,t);else{const C=d?Object.getOwnPropertyNames(t):Object.keys(t),P=C.length;let V;for(_=0;_<P;_++)V=C[_],l.call(null,t[V],V,t)}}function _A(t,l){l=l.toLowerCase();const d=Object.keys(t);let _=d.length,T;for(;_-- >0;)if(T=d[_],l===T.toLowerCase())return T;return null}const Cf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,yA=t=>!n_(t)&&t!==Cf;function sb(){const{caseless:t}=yA(this)&&this||{},l={},d=(_,T)=>{const C=t&&_A(l,T)||T;Uy(l[C])&&Uy(_)?l[C]=sb(l[C],_):Uy(_)?l[C]=sb({},_):ym(_)?l[C]=_.slice():l[C]=_};for(let _=0,T=arguments.length;_<T;_++)arguments[_]&&p_(arguments[_],d);return l}const gz=(t,l,d,{allOwnKeys:_}={})=>(p_(l,(T,C)=>{d&&Na(T)?t[C]=pA(T,d):t[C]=T},{allOwnKeys:_}),t),_z=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),yz=(t,l,d,_)=>{t.prototype=Object.create(l.prototype,_),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:l.prototype}),d&&Object.assign(t.prototype,d)},xz=(t,l,d,_)=>{let T,C,P;const V={};if(l=l||{},t==null)return l;do{for(T=Object.getOwnPropertyNames(t),C=T.length;C-- >0;)P=T[C],(!_||_(P,t,l))&&!V[P]&&(l[P]=t[P],V[P]=!0);t=d!==!1&&Yb(t)}while(t&&(!d||d(t,l))&&t!==Object.prototype);return l},vz=(t,l,d)=>{t=String(t),(d===void 0||d>t.length)&&(d=t.length),d-=l.length;const _=t.indexOf(l,d);return _!==-1&&_===d},bz=t=>{if(!t)return null;if(ym(t))return t;let l=t.length;if(!gA(l))return null;const d=new Array(l);for(;l-- >0;)d[l]=t[l];return d},wz=(t=>l=>t&&l instanceof t)(typeof Uint8Array<"u"&&Yb(Uint8Array)),Tz=(t,l)=>{const _=(t&&t[Symbol.iterator]).call(t);let T;for(;(T=_.next())&&!T.done;){const C=T.value;l.call(t,C[0],C[1])}},Ez=(t,l)=>{let d;const _=[];for(;(d=t.exec(l))!==null;)_.push(d);return _},Sz=$l("HTMLFormElement"),Cz=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(d,_,T){return _.toUpperCase()+T}),qT=(({hasOwnProperty:t})=>(l,d)=>t.call(l,d))(Object.prototype),Az=$l("RegExp"),xA=(t,l)=>{const d=Object.getOwnPropertyDescriptors(t),_={};p_(d,(T,C)=>{let P;(P=l(T,C,t))!==!1&&(_[C]=P||T)}),Object.defineProperties(t,_)},Mz=t=>{xA(t,(l,d)=>{if(Na(t)&&["arguments","caller","callee"].indexOf(d)!==-1)return!1;const _=t[d];if(Na(_)){if(l.enumerable=!1,"writable"in l){l.writable=!1;return}l.set||(l.set=()=>{throw Error("Can not rewrite read-only method '"+d+"'")})}})},Iz=(t,l)=>{const d={},_=T=>{T.forEach(C=>{d[C]=!0})};return ym(t)?_(t):_(String(t).split(l)),d},kz=()=>{},Pz=(t,l)=>t!=null&&Number.isFinite(t=+t)?t:l;function Lz(t){return!!(t&&Na(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const Dz=t=>{const l=new Array(10),d=(_,T)=>{if(Vx(_)){if(l.indexOf(_)>=0)return;if(!("toJSON"in _)){l[T]=_;const C=ym(_)?[]:{};return p_(_,(P,V)=>{const s=d(P,T+1);!n_(s)&&(C[V]=s)}),l[T]=void 0,C}}return _};return d(t,0)},Oz=$l("AsyncFunction"),Rz=t=>t&&(Vx(t)||Na(t))&&Na(t.then)&&Na(t.catch),vA=((t,l)=>t?setImmediate:l?((d,_)=>(Cf.addEventListener("message",({source:T,data:C})=>{T===Cf&&C===d&&_.length&&_.shift()()},!1),T=>{_.push(T),Cf.postMessage(d,"*")}))(`axios@${Math.random()}`,[]):d=>setTimeout(d))(typeof setImmediate=="function",Na(Cf.postMessage)),zz=typeof queueMicrotask<"u"?queueMicrotask.bind(Cf):typeof process<"u"&&process.nextTick||vA,Dt={isArray:ym,isArrayBuffer:mA,isBuffer:ez,isFormData:cz,isArrayBufferView:tz,isString:iz,isNumber:gA,isBoolean:rz,isObject:Vx,isPlainObject:Uy,isReadableStream:uz,isRequest:dz,isResponse:fz,isHeaders:pz,isUndefined:n_,isDate:nz,isFile:sz,isBlob:oz,isRegExp:Az,isFunction:Na,isStream:lz,isURLSearchParams:hz,isTypedArray:wz,isFileList:az,forEach:p_,merge:sb,extend:gz,trim:mz,stripBOM:_z,inherits:yz,toFlatObject:xz,kindOf:Nx,kindOfTest:$l,endsWith:vz,toArray:bz,forEachEntry:Tz,matchAll:Ez,isHTMLForm:Sz,hasOwnProperty:qT,hasOwnProp:qT,reduceDescriptors:xA,freezeMethods:Mz,toObjectSet:Iz,toCamelCase:Cz,noop:kz,toFiniteNumber:Pz,findKey:_A,global:Cf,isContextDefined:yA,isSpecCompliantForm:Lz,toJSONObject:Dz,isAsyncFn:Oz,isThenable:Rz,setImmediate:vA,asap:zz};function xr(t,l,d,_,T){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",l&&(this.code=l),d&&(this.config=d),_&&(this.request=_),T&&(this.response=T,this.status=T.status?T.status:null)}Dt.inherits(xr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Dt.toJSONObject(this.config),code:this.code,status:this.status}}});const bA=xr.prototype,wA={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{wA[t]={value:t}});Object.defineProperties(xr,wA);Object.defineProperty(bA,"isAxiosError",{value:!0});xr.from=(t,l,d,_,T,C)=>{const P=Object.create(bA);return Dt.toFlatObject(t,P,function(s){return s!==Error.prototype},V=>V!=="isAxiosError"),xr.call(P,t.message,l,d,_,T),P.cause=t,P.name=t.name,C&&Object.assign(P,C),P};const Bz=null;function ob(t){return Dt.isPlainObject(t)||Dt.isArray(t)}function TA(t){return Dt.endsWith(t,"[]")?t.slice(0,-2):t}function XT(t,l,d){return t?t.concat(l).map(function(T,C){return T=TA(T),!d&&C?"["+T+"]":T}).join(d?".":""):l}function Fz(t){return Dt.isArray(t)&&!t.some(ob)}const Nz=Dt.toFlatObject(Dt,{},null,function(l){return/^is[A-Z]/.test(l)});function jx(t,l,d){if(!Dt.isObject(t))throw new TypeError("target must be an object");l=l||new FormData,d=Dt.toFlatObject(d,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Me,Ye){return!Dt.isUndefined(Ye[Me])});const _=d.metaTokens,T=d.visitor||Z,C=d.dots,P=d.indexes,s=(d.Blob||typeof Blob<"u"&&Blob)&&Dt.isSpecCompliantForm(l);if(!Dt.isFunction(T))throw new TypeError("visitor must be a function");function $(we){if(we===null)return"";if(Dt.isDate(we))return we.toISOString();if(!s&&Dt.isBlob(we))throw new xr("Blob is not supported. Use a Buffer instead.");return Dt.isArrayBuffer(we)||Dt.isTypedArray(we)?s&&typeof Blob=="function"?new Blob([we]):Buffer.from(we):we}function Z(we,Me,Ye){let Ze=we;if(we&&!Ye&&typeof we=="object"){if(Dt.endsWith(Me,"{}"))Me=_?Me:Me.slice(0,-2),we=JSON.stringify(we);else if(Dt.isArray(we)&&Fz(we)||(Dt.isFileList(we)||Dt.endsWith(Me,"[]"))&&(Ze=Dt.toArray(we)))return Me=TA(Me),Ze.forEach(function(ae,ge){!(Dt.isUndefined(ae)||ae===null)&&l.append(P===!0?XT([Me],ge,C):P===null?Me:Me+"[]",$(ae))}),!1}return ob(we)?!0:(l.append(XT(Ye,Me,C),$(we)),!1)}const J=[],ne=Object.assign(Nz,{defaultVisitor:Z,convertValue:$,isVisitable:ob});function ue(we,Me){if(!Dt.isUndefined(we)){if(J.indexOf(we)!==-1)throw Error("Circular reference detected in "+Me.join("."));J.push(we),Dt.forEach(we,function(Ze,je){(!(Dt.isUndefined(Ze)||Ze===null)&&T.call(l,Ze,Dt.isString(je)?je.trim():je,Me,ne))===!0&&ue(Ze,Me?Me.concat(je):[je])}),J.pop()}}if(!Dt.isObject(t))throw new TypeError("data must be an object");return ue(t),l}function ZT(t){const l={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(_){return l[_]})}function Kb(t,l){this._pairs=[],t&&jx(t,this,l)}const EA=Kb.prototype;EA.append=function(l,d){this._pairs.push([l,d])};EA.toString=function(l){const d=l?function(_){return l.call(this,_,ZT)}:ZT;return this._pairs.map(function(T){return d(T[0])+"="+d(T[1])},"").join("&")};function Uz(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function SA(t,l,d){if(!l)return t;const _=d&&d.encode||Uz;Dt.isFunction(d)&&(d={serialize:d});const T=d&&d.serialize;let C;if(T?C=T(l,d):C=Dt.isURLSearchParams(l)?l.toString():new Kb(l,d).toString(_),C){const P=t.indexOf("#");P!==-1&&(t=t.slice(0,P)),t+=(t.indexOf("?")===-1?"?":"&")+C}return t}class YT{constructor(){this.handlers=[]}use(l,d,_){return this.handlers.push({fulfilled:l,rejected:d,synchronous:_?_.synchronous:!1,runWhen:_?_.runWhen:null}),this.handlers.length-1}eject(l){this.handlers[l]&&(this.handlers[l]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(l){Dt.forEach(this.handlers,function(_){_!==null&&l(_)})}}const CA={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Vz=typeof URLSearchParams<"u"?URLSearchParams:Kb,jz=typeof FormData<"u"?FormData:null,$z=typeof Blob<"u"?Blob:null,Gz={isBrowser:!0,classes:{URLSearchParams:Vz,FormData:jz,Blob:$z},protocols:["http","https","file","blob","url","data"]},Jb=typeof window<"u"&&typeof document<"u",ab=typeof navigator=="object"&&navigator||void 0,Wz=Jb&&(!ab||["ReactNative","NativeScript","NS"].indexOf(ab.product)<0),Hz=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qz=Jb&&window.location.href||"http://localhost",Xz=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Jb,hasStandardBrowserEnv:Wz,hasStandardBrowserWebWorkerEnv:Hz,navigator:ab,origin:qz},Symbol.toStringTag,{value:"Module"})),go={...Xz,...Gz};function Zz(t,l){return jx(t,new go.classes.URLSearchParams,Object.assign({visitor:function(d,_,T,C){return go.isNode&&Dt.isBuffer(d)?(this.append(_,d.toString("base64")),!1):C.defaultVisitor.apply(this,arguments)}},l))}function Yz(t){return Dt.matchAll(/\w+|\[(\w*)]/g,t).map(l=>l[0]==="[]"?"":l[1]||l[0])}function Kz(t){const l={},d=Object.keys(t);let _;const T=d.length;let C;for(_=0;_<T;_++)C=d[_],l[C]=t[C];return l}function AA(t){function l(d,_,T,C){let P=d[C++];if(P==="__proto__")return!0;const V=Number.isFinite(+P),s=C>=d.length;return P=!P&&Dt.isArray(T)?T.length:P,s?(Dt.hasOwnProp(T,P)?T[P]=[T[P],_]:T[P]=_,!V):((!T[P]||!Dt.isObject(T[P]))&&(T[P]=[]),l(d,_,T[P],C)&&Dt.isArray(T[P])&&(T[P]=Kz(T[P])),!V)}if(Dt.isFormData(t)&&Dt.isFunction(t.entries)){const d={};return Dt.forEachEntry(t,(_,T)=>{l(Yz(_),T,d,0)}),d}return null}function Jz(t,l,d){if(Dt.isString(t))try{return(l||JSON.parse)(t),Dt.trim(t)}catch(_){if(_.name!=="SyntaxError")throw _}return(d||JSON.stringify)(t)}const m_={transitional:CA,adapter:["xhr","http","fetch"],transformRequest:[function(l,d){const _=d.getContentType()||"",T=_.indexOf("application/json")>-1,C=Dt.isObject(l);if(C&&Dt.isHTMLForm(l)&&(l=new FormData(l)),Dt.isFormData(l))return T?JSON.stringify(AA(l)):l;if(Dt.isArrayBuffer(l)||Dt.isBuffer(l)||Dt.isStream(l)||Dt.isFile(l)||Dt.isBlob(l)||Dt.isReadableStream(l))return l;if(Dt.isArrayBufferView(l))return l.buffer;if(Dt.isURLSearchParams(l))return d.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),l.toString();let V;if(C){if(_.indexOf("application/x-www-form-urlencoded")>-1)return Zz(l,this.formSerializer).toString();if((V=Dt.isFileList(l))||_.indexOf("multipart/form-data")>-1){const s=this.env&&this.env.FormData;return jx(V?{"files[]":l}:l,s&&new s,this.formSerializer)}}return C||T?(d.setContentType("application/json",!1),Jz(l)):l}],transformResponse:[function(l){const d=this.transitional||m_.transitional,_=d&&d.forcedJSONParsing,T=this.responseType==="json";if(Dt.isResponse(l)||Dt.isReadableStream(l))return l;if(l&&Dt.isString(l)&&(_&&!this.responseType||T)){const P=!(d&&d.silentJSONParsing)&&T;try{return JSON.parse(l)}catch(V){if(P)throw V.name==="SyntaxError"?xr.from(V,xr.ERR_BAD_RESPONSE,this,null,this.response):V}}return l}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:go.classes.FormData,Blob:go.classes.Blob},validateStatus:function(l){return l>=200&&l<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Dt.forEach(["delete","get","head","post","put","patch"],t=>{m_.headers[t]={}});const Qz=Dt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),e3=t=>{const l={};let d,_,T;return t&&t.split(`
`).forEach(function(P){T=P.indexOf(":"),d=P.substring(0,T).trim().toLowerCase(),_=P.substring(T+1).trim(),!(!d||l[d]&&Qz[d])&&(d==="set-cookie"?l[d]?l[d].push(_):l[d]=[_]:l[d]=l[d]?l[d]+", "+_:_)}),l},KT=Symbol("internals");function Mg(t){return t&&String(t).trim().toLowerCase()}function Vy(t){return t===!1||t==null?t:Dt.isArray(t)?t.map(Vy):String(t)}function t3(t){const l=Object.create(null),d=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _;for(;_=d.exec(t);)l[_[1]]=_[2];return l}const i3=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function v0(t,l,d,_,T){if(Dt.isFunction(_))return _.call(this,l,d);if(T&&(l=d),!!Dt.isString(l)){if(Dt.isString(_))return l.indexOf(_)!==-1;if(Dt.isRegExp(_))return _.test(l)}}function r3(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(l,d,_)=>d.toUpperCase()+_)}function n3(t,l){const d=Dt.toCamelCase(" "+l);["get","set","has"].forEach(_=>{Object.defineProperty(t,_+d,{value:function(T,C,P){return this[_].call(this,l,T,C,P)},configurable:!0})})}let ua=class{constructor(l){l&&this.set(l)}set(l,d,_){const T=this;function C(V,s,$){const Z=Mg(s);if(!Z)throw new Error("header name must be a non-empty string");const J=Dt.findKey(T,Z);(!J||T[J]===void 0||$===!0||$===void 0&&T[J]!==!1)&&(T[J||s]=Vy(V))}const P=(V,s)=>Dt.forEach(V,($,Z)=>C($,Z,s));if(Dt.isPlainObject(l)||l instanceof this.constructor)P(l,d);else if(Dt.isString(l)&&(l=l.trim())&&!i3(l))P(e3(l),d);else if(Dt.isHeaders(l))for(const[V,s]of l.entries())C(s,V,_);else l!=null&&C(d,l,_);return this}get(l,d){if(l=Mg(l),l){const _=Dt.findKey(this,l);if(_){const T=this[_];if(!d)return T;if(d===!0)return t3(T);if(Dt.isFunction(d))return d.call(this,T,_);if(Dt.isRegExp(d))return d.exec(T);throw new TypeError("parser must be boolean|regexp|function")}}}has(l,d){if(l=Mg(l),l){const _=Dt.findKey(this,l);return!!(_&&this[_]!==void 0&&(!d||v0(this,this[_],_,d)))}return!1}delete(l,d){const _=this;let T=!1;function C(P){if(P=Mg(P),P){const V=Dt.findKey(_,P);V&&(!d||v0(_,_[V],V,d))&&(delete _[V],T=!0)}}return Dt.isArray(l)?l.forEach(C):C(l),T}clear(l){const d=Object.keys(this);let _=d.length,T=!1;for(;_--;){const C=d[_];(!l||v0(this,this[C],C,l,!0))&&(delete this[C],T=!0)}return T}normalize(l){const d=this,_={};return Dt.forEach(this,(T,C)=>{const P=Dt.findKey(_,C);if(P){d[P]=Vy(T),delete d[C];return}const V=l?r3(C):String(C).trim();V!==C&&delete d[C],d[V]=Vy(T),_[V]=!0}),this}concat(...l){return this.constructor.concat(this,...l)}toJSON(l){const d=Object.create(null);return Dt.forEach(this,(_,T)=>{_!=null&&_!==!1&&(d[T]=l&&Dt.isArray(_)?_.join(", "):_)}),d}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([l,d])=>l+": "+d).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(l){return l instanceof this?l:new this(l)}static concat(l,...d){const _=new this(l);return d.forEach(T=>_.set(T)),_}static accessor(l){const _=(this[KT]=this[KT]={accessors:{}}).accessors,T=this.prototype;function C(P){const V=Mg(P);_[V]||(n3(T,P),_[V]=!0)}return Dt.isArray(l)?l.forEach(C):C(l),this}};ua.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Dt.reduceDescriptors(ua.prototype,({value:t},l)=>{let d=l[0].toUpperCase()+l.slice(1);return{get:()=>t,set(_){this[d]=_}}});Dt.freezeMethods(ua);function b0(t,l){const d=this||m_,_=l||d,T=ua.from(_.headers);let C=_.data;return Dt.forEach(t,function(V){C=V.call(d,C,T.normalize(),l?l.status:void 0)}),T.normalize(),C}function MA(t){return!!(t&&t.__CANCEL__)}function xm(t,l,d){xr.call(this,t??"canceled",xr.ERR_CANCELED,l,d),this.name="CanceledError"}Dt.inherits(xm,xr,{__CANCEL__:!0});function IA(t,l,d){const _=d.config.validateStatus;!d.status||!_||_(d.status)?t(d):l(new xr("Request failed with status code "+d.status,[xr.ERR_BAD_REQUEST,xr.ERR_BAD_RESPONSE][Math.floor(d.status/100)-4],d.config,d.request,d))}function s3(t){const l=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return l&&l[1]||""}function o3(t,l){t=t||10;const d=new Array(t),_=new Array(t);let T=0,C=0,P;return l=l!==void 0?l:1e3,function(s){const $=Date.now(),Z=_[C];P||(P=$),d[T]=s,_[T]=$;let J=C,ne=0;for(;J!==T;)ne+=d[J++],J=J%t;if(T=(T+1)%t,T===C&&(C=(C+1)%t),$-P<l)return;const ue=Z&&$-Z;return ue?Math.round(ne*1e3/ue):void 0}}function a3(t,l){let d=0,_=1e3/l,T,C;const P=($,Z=Date.now())=>{d=Z,T=null,C&&(clearTimeout(C),C=null),t.apply(null,$)};return[(...$)=>{const Z=Date.now(),J=Z-d;J>=_?P($,Z):(T=$,C||(C=setTimeout(()=>{C=null,P(T)},_-J)))},()=>T&&P(T)]}const lx=(t,l,d=3)=>{let _=0;const T=o3(50,250);return a3(C=>{const P=C.loaded,V=C.lengthComputable?C.total:void 0,s=P-_,$=T(s),Z=P<=V;_=P;const J={loaded:P,total:V,progress:V?P/V:void 0,bytes:s,rate:$||void 0,estimated:$&&V&&Z?(V-P)/$:void 0,event:C,lengthComputable:V!=null,[l?"download":"upload"]:!0};t(J)},d)},JT=(t,l)=>{const d=t!=null;return[_=>l[0]({lengthComputable:d,total:t,loaded:_}),l[1]]},QT=t=>(...l)=>Dt.asap(()=>t(...l)),l3=go.hasStandardBrowserEnv?((t,l)=>d=>(d=new URL(d,go.origin),t.protocol===d.protocol&&t.host===d.host&&(l||t.port===d.port)))(new URL(go.origin),go.navigator&&/(msie|trident)/i.test(go.navigator.userAgent)):()=>!0,c3=go.hasStandardBrowserEnv?{write(t,l,d,_,T,C){const P=[t+"="+encodeURIComponent(l)];Dt.isNumber(d)&&P.push("expires="+new Date(d).toGMTString()),Dt.isString(_)&&P.push("path="+_),Dt.isString(T)&&P.push("domain="+T),C===!0&&P.push("secure"),document.cookie=P.join("; ")},read(t){const l=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return l?decodeURIComponent(l[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function h3(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function u3(t,l){return l?t.replace(/\/?\/$/,"")+"/"+l.replace(/^\/+/,""):t}function kA(t,l,d){let _=!h3(l);return t&&(_||d==!1)?u3(t,l):l}const eE=t=>t instanceof ua?{...t}:t;function Of(t,l){l=l||{};const d={};function _($,Z,J,ne){return Dt.isPlainObject($)&&Dt.isPlainObject(Z)?Dt.merge.call({caseless:ne},$,Z):Dt.isPlainObject(Z)?Dt.merge({},Z):Dt.isArray(Z)?Z.slice():Z}function T($,Z,J,ne){if(Dt.isUndefined(Z)){if(!Dt.isUndefined($))return _(void 0,$,J,ne)}else return _($,Z,J,ne)}function C($,Z){if(!Dt.isUndefined(Z))return _(void 0,Z)}function P($,Z){if(Dt.isUndefined(Z)){if(!Dt.isUndefined($))return _(void 0,$)}else return _(void 0,Z)}function V($,Z,J){if(J in l)return _($,Z);if(J in t)return _(void 0,$)}const s={url:C,method:C,data:C,baseURL:P,transformRequest:P,transformResponse:P,paramsSerializer:P,timeout:P,timeoutMessage:P,withCredentials:P,withXSRFToken:P,adapter:P,responseType:P,xsrfCookieName:P,xsrfHeaderName:P,onUploadProgress:P,onDownloadProgress:P,decompress:P,maxContentLength:P,maxBodyLength:P,beforeRedirect:P,transport:P,httpAgent:P,httpsAgent:P,cancelToken:P,socketPath:P,responseEncoding:P,validateStatus:V,headers:($,Z,J)=>T(eE($),eE(Z),J,!0)};return Dt.forEach(Object.keys(Object.assign({},t,l)),function(Z){const J=s[Z]||T,ne=J(t[Z],l[Z],Z);Dt.isUndefined(ne)&&J!==V||(d[Z]=ne)}),d}const PA=t=>{const l=Of({},t);let{data:d,withXSRFToken:_,xsrfHeaderName:T,xsrfCookieName:C,headers:P,auth:V}=l;l.headers=P=ua.from(P),l.url=SA(kA(l.baseURL,l.url,l.allowAbsoluteUrls),t.params,t.paramsSerializer),V&&P.set("Authorization","Basic "+btoa((V.username||"")+":"+(V.password?unescape(encodeURIComponent(V.password)):"")));let s;if(Dt.isFormData(d)){if(go.hasStandardBrowserEnv||go.hasStandardBrowserWebWorkerEnv)P.setContentType(void 0);else if((s=P.getContentType())!==!1){const[$,...Z]=s?s.split(";").map(J=>J.trim()).filter(Boolean):[];P.setContentType([$||"multipart/form-data",...Z].join("; "))}}if(go.hasStandardBrowserEnv&&(_&&Dt.isFunction(_)&&(_=_(l)),_||_!==!1&&l3(l.url))){const $=T&&C&&c3.read(C);$&&P.set(T,$)}return l},d3=typeof XMLHttpRequest<"u",f3=d3&&function(t){return new Promise(function(d,_){const T=PA(t);let C=T.data;const P=ua.from(T.headers).normalize();let{responseType:V,onUploadProgress:s,onDownloadProgress:$}=T,Z,J,ne,ue,we;function Me(){ue&&ue(),we&&we(),T.cancelToken&&T.cancelToken.unsubscribe(Z),T.signal&&T.signal.removeEventListener("abort",Z)}let Ye=new XMLHttpRequest;Ye.open(T.method.toUpperCase(),T.url,!0),Ye.timeout=T.timeout;function Ze(){if(!Ye)return;const ae=ua.from("getAllResponseHeaders"in Ye&&Ye.getAllResponseHeaders()),Oe={data:!V||V==="text"||V==="json"?Ye.responseText:Ye.response,status:Ye.status,statusText:Ye.statusText,headers:ae,config:t,request:Ye};IA(function(rt){d(rt),Me()},function(rt){_(rt),Me()},Oe),Ye=null}"onloadend"in Ye?Ye.onloadend=Ze:Ye.onreadystatechange=function(){!Ye||Ye.readyState!==4||Ye.status===0&&!(Ye.responseURL&&Ye.responseURL.indexOf("file:")===0)||setTimeout(Ze)},Ye.onabort=function(){Ye&&(_(new xr("Request aborted",xr.ECONNABORTED,t,Ye)),Ye=null)},Ye.onerror=function(){_(new xr("Network Error",xr.ERR_NETWORK,t,Ye)),Ye=null},Ye.ontimeout=function(){let ge=T.timeout?"timeout of "+T.timeout+"ms exceeded":"timeout exceeded";const Oe=T.transitional||CA;T.timeoutErrorMessage&&(ge=T.timeoutErrorMessage),_(new xr(ge,Oe.clarifyTimeoutError?xr.ETIMEDOUT:xr.ECONNABORTED,t,Ye)),Ye=null},C===void 0&&P.setContentType(null),"setRequestHeader"in Ye&&Dt.forEach(P.toJSON(),function(ge,Oe){Ye.setRequestHeader(Oe,ge)}),Dt.isUndefined(T.withCredentials)||(Ye.withCredentials=!!T.withCredentials),V&&V!=="json"&&(Ye.responseType=T.responseType),$&&([ne,we]=lx($,!0),Ye.addEventListener("progress",ne)),s&&Ye.upload&&([J,ue]=lx(s),Ye.upload.addEventListener("progress",J),Ye.upload.addEventListener("loadend",ue)),(T.cancelToken||T.signal)&&(Z=ae=>{Ye&&(_(!ae||ae.type?new xm(null,t,Ye):ae),Ye.abort(),Ye=null)},T.cancelToken&&T.cancelToken.subscribe(Z),T.signal&&(T.signal.aborted?Z():T.signal.addEventListener("abort",Z)));const je=s3(T.url);if(je&&go.protocols.indexOf(je)===-1){_(new xr("Unsupported protocol "+je+":",xr.ERR_BAD_REQUEST,t));return}Ye.send(C||null)})},p3=(t,l)=>{const{length:d}=t=t?t.filter(Boolean):[];if(l||d){let _=new AbortController,T;const C=function($){if(!T){T=!0,V();const Z=$ instanceof Error?$:this.reason;_.abort(Z instanceof xr?Z:new xm(Z instanceof Error?Z.message:Z))}};let P=l&&setTimeout(()=>{P=null,C(new xr(`timeout ${l} of ms exceeded`,xr.ETIMEDOUT))},l);const V=()=>{t&&(P&&clearTimeout(P),P=null,t.forEach($=>{$.unsubscribe?$.unsubscribe(C):$.removeEventListener("abort",C)}),t=null)};t.forEach($=>$.addEventListener("abort",C));const{signal:s}=_;return s.unsubscribe=()=>Dt.asap(V),s}},m3=function*(t,l){let d=t.byteLength;if(d<l){yield t;return}let _=0,T;for(;_<d;)T=_+l,yield t.slice(_,T),_=T},g3=async function*(t,l){for await(const d of _3(t))yield*m3(d,l)},_3=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const l=t.getReader();try{for(;;){const{done:d,value:_}=await l.read();if(d)break;yield _}}finally{await l.cancel()}},tE=(t,l,d,_)=>{const T=g3(t,l);let C=0,P,V=s=>{P||(P=!0,_&&_(s))};return new ReadableStream({async pull(s){try{const{done:$,value:Z}=await T.next();if($){V(),s.close();return}let J=Z.byteLength;if(d){let ne=C+=J;d(ne)}s.enqueue(new Uint8Array(Z))}catch($){throw V($),$}},cancel(s){return V(s),T.return()}},{highWaterMark:2})},$x=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",LA=$x&&typeof ReadableStream=="function",y3=$x&&(typeof TextEncoder=="function"?(t=>l=>t.encode(l))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),DA=(t,...l)=>{try{return!!t(...l)}catch{return!1}},x3=LA&&DA(()=>{let t=!1;const l=new Request(go.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!l}),iE=64*1024,lb=LA&&DA(()=>Dt.isReadableStream(new Response("").body)),cx={stream:lb&&(t=>t.body)};$x&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(l=>{!cx[l]&&(cx[l]=Dt.isFunction(t[l])?d=>d[l]():(d,_)=>{throw new xr(`Response type '${l}' is not supported`,xr.ERR_NOT_SUPPORT,_)})})})(new Response);const v3=async t=>{if(t==null)return 0;if(Dt.isBlob(t))return t.size;if(Dt.isSpecCompliantForm(t))return(await new Request(go.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Dt.isArrayBufferView(t)||Dt.isArrayBuffer(t))return t.byteLength;if(Dt.isURLSearchParams(t)&&(t=t+""),Dt.isString(t))return(await y3(t)).byteLength},b3=async(t,l)=>{const d=Dt.toFiniteNumber(t.getContentLength());return d??v3(l)},w3=$x&&(async t=>{let{url:l,method:d,data:_,signal:T,cancelToken:C,timeout:P,onDownloadProgress:V,onUploadProgress:s,responseType:$,headers:Z,withCredentials:J="same-origin",fetchOptions:ne}=PA(t);$=$?($+"").toLowerCase():"text";let ue=p3([T,C&&C.toAbortSignal()],P),we;const Me=ue&&ue.unsubscribe&&(()=>{ue.unsubscribe()});let Ye;try{if(s&&x3&&d!=="get"&&d!=="head"&&(Ye=await b3(Z,_))!==0){let Oe=new Request(l,{method:"POST",body:_,duplex:"half"}),ze;if(Dt.isFormData(_)&&(ze=Oe.headers.get("content-type"))&&Z.setContentType(ze),Oe.body){const[rt,ke]=JT(Ye,lx(QT(s)));_=tE(Oe.body,iE,rt,ke)}}Dt.isString(J)||(J=J?"include":"omit");const Ze="credentials"in Request.prototype;we=new Request(l,{...ne,signal:ue,method:d.toUpperCase(),headers:Z.normalize().toJSON(),body:_,duplex:"half",credentials:Ze?J:void 0});let je=await fetch(we);const ae=lb&&($==="stream"||$==="response");if(lb&&(V||ae&&Me)){const Oe={};["status","statusText","headers"].forEach(Ke=>{Oe[Ke]=je[Ke]});const ze=Dt.toFiniteNumber(je.headers.get("content-length")),[rt,ke]=V&&JT(ze,lx(QT(V),!0))||[];je=new Response(tE(je.body,iE,rt,()=>{ke&&ke(),Me&&Me()}),Oe)}$=$||"text";let ge=await cx[Dt.findKey(cx,$)||"text"](je,t);return!ae&&Me&&Me(),await new Promise((Oe,ze)=>{IA(Oe,ze,{data:ge,headers:ua.from(je.headers),status:je.status,statusText:je.statusText,config:t,request:we})})}catch(Ze){throw Me&&Me(),Ze&&Ze.name==="TypeError"&&/fetch/i.test(Ze.message)?Object.assign(new xr("Network Error",xr.ERR_NETWORK,t,we),{cause:Ze.cause||Ze}):xr.from(Ze,Ze&&Ze.code,t,we)}}),cb={http:Bz,xhr:f3,fetch:w3};Dt.forEach(cb,(t,l)=>{if(t){try{Object.defineProperty(t,"name",{value:l})}catch{}Object.defineProperty(t,"adapterName",{value:l})}});const rE=t=>`- ${t}`,T3=t=>Dt.isFunction(t)||t===null||t===!1,OA={getAdapter:t=>{t=Dt.isArray(t)?t:[t];const{length:l}=t;let d,_;const T={};for(let C=0;C<l;C++){d=t[C];let P;if(_=d,!T3(d)&&(_=cb[(P=String(d)).toLowerCase()],_===void 0))throw new xr(`Unknown adapter '${P}'`);if(_)break;T[P||"#"+C]=_}if(!_){const C=Object.entries(T).map(([V,s])=>`adapter ${V} `+(s===!1?"is not supported by the environment":"is not available in the build"));let P=l?C.length>1?`since :
`+C.map(rE).join(`
`):" "+rE(C[0]):"as no adapter specified";throw new xr("There is no suitable adapter to dispatch the request "+P,"ERR_NOT_SUPPORT")}return _},adapters:cb};function w0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new xm(null,t)}function nE(t){return w0(t),t.headers=ua.from(t.headers),t.data=b0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),OA.getAdapter(t.adapter||m_.adapter)(t).then(function(_){return w0(t),_.data=b0.call(t,t.transformResponse,_),_.headers=ua.from(_.headers),_},function(_){return MA(_)||(w0(t),_&&_.response&&(_.response.data=b0.call(t,t.transformResponse,_.response),_.response.headers=ua.from(_.response.headers))),Promise.reject(_)})}const RA="1.8.4",Gx={};["object","boolean","number","function","string","symbol"].forEach((t,l)=>{Gx[t]=function(_){return typeof _===t||"a"+(l<1?"n ":" ")+t}});const sE={};Gx.transitional=function(l,d,_){function T(C,P){return"[Axios v"+RA+"] Transitional option '"+C+"'"+P+(_?". "+_:"")}return(C,P,V)=>{if(l===!1)throw new xr(T(P," has been removed"+(d?" in "+d:"")),xr.ERR_DEPRECATED);return d&&!sE[P]&&(sE[P]=!0,console.warn(T(P," has been deprecated since v"+d+" and will be removed in the near future"))),l?l(C,P,V):!0}};Gx.spelling=function(l){return(d,_)=>(console.warn(`${_} is likely a misspelling of ${l}`),!0)};function E3(t,l,d){if(typeof t!="object")throw new xr("options must be an object",xr.ERR_BAD_OPTION_VALUE);const _=Object.keys(t);let T=_.length;for(;T-- >0;){const C=_[T],P=l[C];if(P){const V=t[C],s=V===void 0||P(V,C,t);if(s!==!0)throw new xr("option "+C+" must be "+s,xr.ERR_BAD_OPTION_VALUE);continue}if(d!==!0)throw new xr("Unknown option "+C,xr.ERR_BAD_OPTION)}}const jy={assertOptions:E3,validators:Gx},Mc=jy.validators;let Pf=class{constructor(l){this.defaults=l,this.interceptors={request:new YT,response:new YT}}async request(l,d){try{return await this._request(l,d)}catch(_){if(_ instanceof Error){let T={};Error.captureStackTrace?Error.captureStackTrace(T):T=new Error;const C=T.stack?T.stack.replace(/^.+\n/,""):"";try{_.stack?C&&!String(_.stack).endsWith(C.replace(/^.+\n.+\n/,""))&&(_.stack+=`
`+C):_.stack=C}catch{}}throw _}}_request(l,d){typeof l=="string"?(d=d||{},d.url=l):d=l||{},d=Of(this.defaults,d);const{transitional:_,paramsSerializer:T,headers:C}=d;_!==void 0&&jy.assertOptions(_,{silentJSONParsing:Mc.transitional(Mc.boolean),forcedJSONParsing:Mc.transitional(Mc.boolean),clarifyTimeoutError:Mc.transitional(Mc.boolean)},!1),T!=null&&(Dt.isFunction(T)?d.paramsSerializer={serialize:T}:jy.assertOptions(T,{encode:Mc.function,serialize:Mc.function},!0)),d.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?d.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:d.allowAbsoluteUrls=!0),jy.assertOptions(d,{baseUrl:Mc.spelling("baseURL"),withXsrfToken:Mc.spelling("withXSRFToken")},!0),d.method=(d.method||this.defaults.method||"get").toLowerCase();let P=C&&Dt.merge(C.common,C[d.method]);C&&Dt.forEach(["delete","get","head","post","put","patch","common"],we=>{delete C[we]}),d.headers=ua.concat(P,C);const V=[];let s=!0;this.interceptors.request.forEach(function(Me){typeof Me.runWhen=="function"&&Me.runWhen(d)===!1||(s=s&&Me.synchronous,V.unshift(Me.fulfilled,Me.rejected))});const $=[];this.interceptors.response.forEach(function(Me){$.push(Me.fulfilled,Me.rejected)});let Z,J=0,ne;if(!s){const we=[nE.bind(this),void 0];for(we.unshift.apply(we,V),we.push.apply(we,$),ne=we.length,Z=Promise.resolve(d);J<ne;)Z=Z.then(we[J++],we[J++]);return Z}ne=V.length;let ue=d;for(J=0;J<ne;){const we=V[J++],Me=V[J++];try{ue=we(ue)}catch(Ye){Me.call(this,Ye);break}}try{Z=nE.call(this,ue)}catch(we){return Promise.reject(we)}for(J=0,ne=$.length;J<ne;)Z=Z.then($[J++],$[J++]);return Z}getUri(l){l=Of(this.defaults,l);const d=kA(l.baseURL,l.url,l.allowAbsoluteUrls);return SA(d,l.params,l.paramsSerializer)}};Dt.forEach(["delete","get","head","options"],function(l){Pf.prototype[l]=function(d,_){return this.request(Of(_||{},{method:l,url:d,data:(_||{}).data}))}});Dt.forEach(["post","put","patch"],function(l){function d(_){return function(C,P,V){return this.request(Of(V||{},{method:l,headers:_?{"Content-Type":"multipart/form-data"}:{},url:C,data:P}))}}Pf.prototype[l]=d(),Pf.prototype[l+"Form"]=d(!0)});let S3=class zA{constructor(l){if(typeof l!="function")throw new TypeError("executor must be a function.");let d;this.promise=new Promise(function(C){d=C});const _=this;this.promise.then(T=>{if(!_._listeners)return;let C=_._listeners.length;for(;C-- >0;)_._listeners[C](T);_._listeners=null}),this.promise.then=T=>{let C;const P=new Promise(V=>{_.subscribe(V),C=V}).then(T);return P.cancel=function(){_.unsubscribe(C)},P},l(function(C,P,V){_.reason||(_.reason=new xm(C,P,V),d(_.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(l){if(this.reason){l(this.reason);return}this._listeners?this._listeners.push(l):this._listeners=[l]}unsubscribe(l){if(!this._listeners)return;const d=this._listeners.indexOf(l);d!==-1&&this._listeners.splice(d,1)}toAbortSignal(){const l=new AbortController,d=_=>{l.abort(_)};return this.subscribe(d),l.signal.unsubscribe=()=>this.unsubscribe(d),l.signal}static source(){let l;return{token:new zA(function(T){l=T}),cancel:l}}};function C3(t){return function(d){return t.apply(null,d)}}function A3(t){return Dt.isObject(t)&&t.isAxiosError===!0}const hb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hb).forEach(([t,l])=>{hb[l]=t});function BA(t){const l=new Pf(t),d=pA(Pf.prototype.request,l);return Dt.extend(d,Pf.prototype,l,{allOwnKeys:!0}),Dt.extend(d,l,null,{allOwnKeys:!0}),d.create=function(T){return BA(Of(t,T))},d}const _n=BA(m_);_n.Axios=Pf;_n.CanceledError=xm;_n.CancelToken=S3;_n.isCancel=MA;_n.VERSION=RA;_n.toFormData=jx;_n.AxiosError=xr;_n.Cancel=_n.CanceledError;_n.all=function(l){return Promise.all(l)};_n.spread=C3;_n.isAxiosError=A3;_n.mergeConfig=Of;_n.AxiosHeaders=ua;_n.formToJSON=t=>AA(Dt.isHTMLForm(t)?new FormData(t):t);_n.getAdapter=OA.getAdapter;_n.HttpStatusCode=hb;_n.default=_n;const{Axios:U4,AxiosError:V4,CanceledError:j4,isCancel:$4,CancelToken:G4,VERSION:W4,all:H4,Cancel:q4,isAxiosError:X4,spread:Z4,toFormData:Y4,AxiosHeaders:K4,HttpStatusCode:J4,formToJSON:Q4,getAdapter:eU,mergeConfig:tU}=_n,vm=fA("user",{state:()=>({token:localStorage.getItem("token"),role:localStorage.getItem("role"),email:localStorage.getItem("email")}),actions:{setToken(t,l,d){this.token=t,this.role=l,this.email=d,localStorage.setItem("token",t),localStorage.setItem("role",l),localStorage.setItem("email",d),_n.defaults.headers.common.Authorization=`Bearer ${t}`},async login(t,l){try{const d=await _n.post("http://127.0.0.1:8000/api/v1/auth/login",{email:t,password:l});return this.setToken(d.data.access_token,d.data.role,d.data.email),!0}catch(d){return console.error("Login failed:",d),!1}},logout(){this.token=null,this.role=null,this.email=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("email"),delete _n.defaults.headers.common.Authorization}}}),M3={class:"app-container"},I3={class:"navbar"},k3={key:0,class:"geoportal-title"},P3={class:"navbar-controls"},L3={class:"navbar-links"},D3={class:"language-switcher"},O3={value:"en"},R3={value:"fr"},z3={key:0,class:"auth-controls"},B3={class:"user-email"},F3={key:1},N3={class:"view-container"},U3={class:"footer"},V3=zn({__name:"Layout",setup(t){const l=BD(),d=MC(),{locale:_}=_m(),T=Z=>{_.value=Z,localStorage.setItem("lang",Z)},C=fn(()=>l.path!=="/"),P=vm(),V=fn(()=>!!P.token),s=fn(()=>P.email||""),$=()=>{P.logout(),d.push("/login")};return(Z,J)=>{const ne=Mh("router-link"),ue=Mh("router-view");return _i(),Pi("div",M3,[lt("nav",I3,[pr(ne,{to:"/",class:"logo-group","aria-label":"Home"},{default:Us(()=>[J[2]||(J[2]=lt("img",{src:Ub,alt:"Donor Logo",class:"logo-dgis"},null,-1)),J[3]||(J[3]=lt("img",{src:mC,alt:"Soil Values Logo",class:"logo-sv"},null,-1)),C.value?(_i(),Pi("span",k3,Vt(Z.$t("title")),1)):En("",!0)]),_:1}),lt("div",P3,[lt("div",L3,[pr(ne,{to:"/",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.home")),1)]),_:1}),pr(ne,{to:"/dashboard",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.map")),1)]),_:1}),pr(ne,{to:"/monitoring",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.mne")),1)]),_:1}),pr(ne,{to:"/catalog",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.catalog")),1)]),_:1}),pr(ne,{to:"/about",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.about")),1)]),_:1}),pr(ne,{to:"/admin-panel",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.adminPanel")),1)]),_:1})]),lt("div",D3,[fo(lt("select",{"onUpdate:modelValue":J[0]||(J[0]=we=>On(_)?_.value=we:null),onChange:J[1]||(J[1]=we=>T(cn(_)))},[lt("option",O3,Vt(Z.$t("lang.en")),1),lt("option",R3,Vt(Z.$t("lang.fr")),1)],544),[[Ch,cn(_)]])]),V.value?(_i(),Pi("div",z3,[lt("span",B3,Vt(s.value),1),lt("button",{onClick:$,class:"logout-btn"},Vt(Z.$t("nav.logout")),1)])):(_i(),Pi("div",F3,[pr(ne,{to:"/login",class:"nav-link"},{default:Us(()=>[js(Vt(Z.$t("nav.login")),1)]),_:1})]))])]),lt("div",N3,[pr(ue)]),lt("footer",U3,[lt("p",null,Vt(Z.$t("footer")),1)])])}}}),da=(t,l)=>{const d=t.__vccOpts||t;for(const[_,T]of l)d[_]=T;return d},j3=da(V3,[["__scopeId","data-v-e0f07052"]]),$3={id:"app"},G3=zn({__name:"App",setup(t){return(l,d)=>(_i(),Pi("div",$3,[pr(j3)]))}}),FA="/projects/soil_values/assets/ifdc_logo-C0Phf9Dr.png",NA="/projects/soil_values/assets/WUR_logo-Ds7IIsIR.png",UA="/projects/soil_values/assets/SNV_logo_2-LRpPKBkz.png",VA="/projects/soil_values/assets/AGRA_logo-BuD40XdR.webp",jA="/projects/soil_values/assets/IITA_logo-DW09z6CA.png",$A="/projects/soil_values/assets/IWMI_logo-B-LuUFd5.jpg",GA="/projects/soil_values/assets/ISRIC_logo-Cx1mKsJo.webp",WA="/projects/soil_values/assets/CIFOR-ICRAF-logo-CA2wt9fE.webp",W3={class:"home-container"},H3={class:"landing-content"},q3={class:"fade-slide"},X3={class:"landing-text fade-slide",style:{"animation-delay":"0.3s"}},Z3=zn({__name:"HomeView",setup(t){return(l,d)=>{const _=Mh("router-link");return _i(),Pi("div",W3,[lt("div",H3,[d[0]||(d[0]=ex('<div class="top-logos fade-slide" data-v-effe8000><a href="https://www.government.nl/ministries/ministry-of-foreign-affairs" target="_blank" rel="noopener" data-v-effe8000><img src="'+Ub+'" alt="DGIS Logo" class="logo donor-logo" data-v-effe8000></a><a href="https://ifdc.org/soil-values" target="_blank" rel="noopener" data-v-effe8000><img src="'+mC+'" alt="Soil Values Logo" class="logo main-logo" data-v-effe8000></a></div>',1)),lt("h1",q3,Vt(l.$t("home.title")),1),lt("div",X3,[lt("p",null,Vt(l.$t("home.intro1")),1),lt("p",null,Vt(l.$t("home.intro2")),1)]),d[1]||(d[1]=ex('<div class="logos-grid" data-v-effe8000><div class="logo-row fade-slide" style="animation-delay:0.6s;" data-v-effe8000><a href="https://ifdc.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+FA+'" alt="IFDC" data-v-effe8000></a><a href="https://wur.nl" target="_blank" rel="noopener" data-v-effe8000><img src="'+NA+'" alt="WUR" data-v-effe8000></a><a href="https://snv.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+UA+'" alt="SNV" data-v-effe8000></a></div><div class="logo-row fade-slide" style="animation-delay:0.9s;" data-v-effe8000><a href="https://agra.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+VA+'" alt="AGRA" data-v-effe8000></a><a href="https://www.iita.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+jA+'" alt="IITA" data-v-effe8000></a><a href="https://www.iwmi.cgiar.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+$A+'" alt="IWMI" class="logo-iwmi" data-v-effe8000></a><a href="https://www.isric.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+GA+'" alt="ISRIC" data-v-effe8000></a><a href="https://www.cifor-icraf.org" target="_blank" rel="noopener" data-v-effe8000><img src="'+WA+'" alt="CIFOR-ICRAF" data-v-effe8000></a></div></div>',1)),pr(_,{to:"/dashboard",class:"launch-btn fade-slide",style:{"animation-delay":"1.2s"}},{default:Us(()=>[js(Vt(l.$t("home.launch")),1)]),_:1})])])}}}),Y3=da(Z3,[["__scopeId","data-v-effe8000"]]);var HA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function K3(t){if(t.__esModule)return t;var l=t.default;if(typeof l=="function"){var d=function _(){return this instanceof _?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};d.prototype=l.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(t).forEach(function(_){var T=Object.getOwnPropertyDescriptor(t,_);Object.defineProperty(d,_,T.get?T:{enumerable:!0,get:function(){return t[_]}})}),d}var XA={exports:{}};(function(t,l){var d={};(function(_,T){t.exports=T()})(HA,function(){var _,T,C;function P(s,$){if(!_)_=$;else if(!T)T=$;else{var Z="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+_+")(sharedChunk); ("+T+")(sharedChunk); self.onerror = null;",J={};_(J),C=$(J),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(C.workerUrl=window.URL.createObjectURL(new Blob([Z],{type:"text/javascript"})))}}P(["exports"],function(s){var $=typeof self<"u"?self:{},Z="2.15.0";let J;const ne={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(J==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{J=d.API_URL_REGEX!=null?new RegExp(d.API_URL_REGEX):i}catch{J=i}}return J},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ne.API_URL)return null;try{const i=new URL(ne.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ue={supported:!1,testSupport:function(i){!Ye&&Me&&(Ze?je(i):we=i)}};let we,Me,Ye=!1,Ze=!1;function je(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Me),i.isContextLost())return;ue.supported=!0}catch{}i.deleteTexture(e),Ye=!0}$.document&&(Me=$.document.createElement("img"),Me.onload=function(){we&&je(we),we=null,Ze=!0},Me.onerror=function(){Ye=!0,we=null},Me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ae="01";function ge(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Oe=ze;function ze(i,e,r,a){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=r,this.p2y=a}ze.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,a=0;a<8;a++){var h=this.sampleCurveX(r)-i;if(Math.abs(h)<e)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=h/m}var y=0,w=1;for(r=i,a=0;a<20&&(h=this.sampleCurveX(r),!(Math.abs(h-i)<e));a++)i>h?y=r:w=r,r=.5*(w-y)+y;return r},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var rt=ge(Oe),ke=Ke;function Ke(i,e){this.x=i,this.y=e}Ke.prototype={clone:function(){return new Ke(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,r=i.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),r=Math.sin(i),a=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=a,this},_rotateAround:function(i,e){var r=Math.cos(i),a=Math.sin(i),h=e.y+a*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ke.convert=function(i){return i instanceof Ke?i:Array.isArray(i)?new Ke(i[0],i[1]):i};var He=ge(ke);const ri=Math.PI/180,bt=180/Math.PI;function dt(i){return i*ri}function kt(i){return i*bt}const Pt=[[0,0],[1,0],[1,1],[0,1]];function vt(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,r=e*i;return 4*(i<.5?r:3*(i-e)+r-.75)}function ci(i,e,r,a){const h=new rt(i,e,r,a);return function(m){return h.solve(m)}}const xi=ci(.25,.1,.25,1);function vi(i,e,r){return Math.min(r,Math.max(e,i))}function Lr(i,e,r){return(r=vi((r-i)/(e-i),0,1))*r*(3-2*r)}function ir(i,e,r){const a=r-e,h=((i-e)%a+a)%a+e;return h===e?r:h}function sr(i,e,r){if(!i.length)return r(null,[]);let a=i.length;const h=new Array(i.length);let m=null;i.forEach((y,w)=>{e(y,(M,k)=>{M&&(m=M),h[w]=k,--a==0&&r(m,h)})})}function nn(i){const e=[];for(const r in i)e.push(i[r]);return e}function fr(i,...e){for(const r of e)for(const a in r)i[a]=r[a];return i}let Bn=1;function sn(){return Bn++}function zt(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function mi(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function si(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function Ei(i,e){i.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function or(i,e){return i.indexOf(e,i.length-e.length)!==-1}function Si(i,e,r){const a={};for(const h in i)a[h]=e.call(this,i[h],h,i);return a}function xe(i,e,r){const a={};for(const h in i)e.call(r||this,i[h],h,i)&&(a[h]=i[h]);return a}function ve(i){return Array.isArray(i)?i.map(ve):typeof i=="object"&&i?Si(i,ve):i}const nt={};function Lt(i){nt[i]||(typeof console<"u"&&console.warn(i),nt[i]=!0)}function At(i,e,r){return(r.y-i.y)*(e.x-i.x)>(e.y-i.y)*(r.x-i.x)}function Yt(i){let e=0;for(let r,a,h=0,m=i.length,y=m-1;h<m;y=h++)r=i[h],a=i[y],e+=(a.x-r.x)*(r.y+a.y);return e}function oi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Te(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,a,h,m)=>{const y=h||m;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let Ae=null;function Qe(i){if(Ae==null){const e=i.navigator?i.navigator.userAgent:null;Ae=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ae}function Wt(i){try{const e=$[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ht(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}const Kt="mapbox-tiles";let ut=500,It=50,Ii,Oi;function Gr(){try{return $.caches}catch{}}function Ur(){Gr()&&!Ii&&(Ii=$.caches.open(Kt))}function un(i){const e=i.indexOf("?");if(e<0)return i;const r=function(h){const m=h.indexOf("?");return m>0?h.slice(m+1).split("&"):[]}(i),a=r.filter(h=>{const m=h.split("=");return m[0]==="language"||m[0]==="worldview"});return a.length?`${i.slice(0,e)}?${a.join("&")}`:i.slice(0,e)}let cr=1/0;const us={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(us);class yo extends Error{constructor(e,r,a){r===401&&ct(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Fn=oi()?()=>self.worker&&self.worker.referrer:()=>($.location.protocol==="blob:"?$.parent:$).location.href,Qn=function(i,e){if(!(/^file:/.test(r=i.url)||/^file:/.test(Fn())&&!/^\w+:/.test(r))){if($.fetch&&$.Request&&$.AbortController&&$.Request.prototype.hasOwnProperty("signal"))return function(a,h){const m=new $.AbortController,y=new $.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:Fn(),referrerPolicy:a.referrerPolicy,signal:m.signal});let w=!1,M=!1;const k=(B=y.url).indexOf("sku=")>0&&ct(B);var B;a.type==="json"&&y.headers.set("Accept","application/json");const U=(X,Y,ie)=>{if(M)return;if(X&&X.message!=="SecurityError"&&Lt(X.toString()),Y&&ie)return G(Y);const de=Date.now();$.fetch(y).then(Ee=>{if(Ee.ok){const Re=k?Ee.clone():null;return G(Ee,Re,de)}return h(new yo(Ee.statusText,Ee.status,a.url))}).catch(Ee=>{Ee.name!=="AbortError"&&h(new Error(`${Ee.message} ${a.url}`))})},G=(X,Y,ie)=>{(a.type==="arrayBuffer"?X.arrayBuffer():a.type==="json"?X.json():X.text()).then(de=>{M||(Y&&ie&&function(Ee,Re,Se){if(Ur(),!Ii)return;const De={status:Re.status,statusText:Re.statusText,headers:new $.Headers};Re.headers.forEach((_t,ft)=>De.headers.set(ft,_t));const Ue=Te(Re.headers.get("Cache-Control")||"");if(Ue["no-store"])return;Ue["max-age"]&&De.headers.set("Expires",new Date(Se+1e3*Ue["max-age"]).toUTCString());const Be=De.headers.get("Expires");Be&&(new Date(Be).getTime()-Se<42e4||function(_t,ft){if(Oi===void 0)try{new Response(new ReadableStream),Oi=!0}catch{Oi=!1}Oi?ft(_t.body):_t.blob().then(ft)}(Re,_t=>{const ft=new $.Response(_t,De);Ur(),Ii&&Ii.then(St=>St.put(un(Ee.url),ft)).catch(St=>Lt(St.message))}))}(y,Y,ie),w=!0,h(null,de,X.headers.get("Cache-Control"),X.headers.get("Expires")))}).catch(de=>{M||h(new Error(de.message))})};return k?function(X,Y){if(Ur(),!Ii)return Y(null);const ie=un(X.url);Ii.then(de=>{de.match(ie).then(Ee=>{const Re=function(Se){if(!Se)return!1;const De=new Date(Se.headers.get("Expires")||0),Ue=Te(Se.headers.get("Cache-Control")||"");return De>Date.now()&&!Ue["no-cache"]}(Ee);de.delete(ie),Re&&de.put(ie,Ee.clone()),Y(null,Ee,Re)}).catch(Y)}).catch(Y)}(y,U):U(null,null),{cancel:()=>{M=!0,w||m.abort()}}}(i,e);if(oi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var r;return function(a,h){const m=new $.XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const y in a.headers)m.setRequestHeader(y,a.headers[y]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(a.type==="json")try{y=JSON.parse(m.response)}catch(w){return h(w)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new yo(m.statusText,m.status,a.url))},m.send(a.body),{cancel:()=>m.abort()}}(i,e)},os=function(i,e){return Qn(fr(i,{type:"arrayBuffer"}),e)};function Gl(i){const e=$.document.createElement("a");return e.href=i,e.protocol===$.document.location.protocol&&e.host===$.document.location.host}const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let oe,le;oe=[],le=0;const Pe=function(i,e){if(ue.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),le>=ne.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return oe.push(m),m}le++;let r=!1;const a=()=>{if(!r)for(r=!0,le--;oe.length&&le<ne.MAX_PARALLEL_IMAGE_REQUESTS;){const m=oe.shift(),{requestParameters:y,callback:w,cancelled:M}=m;M||(m.cancel=Pe(y,w).cancel)}},h=os(i,(m,y,w,M)=>{a(),m?e(m):y&&($.createImageBitmap?function(k,B){const U=new $.Blob([new Uint8Array(k)],{type:"image/png"});$.createImageBitmap(U).then(G=>{B(null,G)}).catch(G=>{B(new Error(`Could not load image because of ${G.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(k,B)=>e(k,B,w,M)):function(k,B){const U=new $.Image,G=$.URL;U.onload=()=>{B(null,U),G.revokeObjectURL(U.src),U.onload=null,$.requestAnimationFrame(()=>{U.src=Le})},U.onerror=()=>B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const X=new $.Blob([new Uint8Array(k)],{type:"image/png"});U.src=k.byteLength?G.createObjectURL(X):Le}(y,(k,B)=>e(k,B,w,M)))});return{cancel:()=>{h.cancel(),a()}}},Ve="NO_ACCESS_TOKEN";function qe(i){return i.indexOf("mapbox:")===0}function ct(i){return ne.API_URL_REGEX.test(i)}function ot(i){return ne.API_CDN_URL_REGEX.test(i)}function Je(i){return ne.API_STYLE_REGEX.test(i)&&!st(i)}function st(i){return ne.API_SPRITE_REGEX.test(i)}const Qt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ni(i){const e=i.match(Qt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function qt(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}const $i="mapbox.eventData";function zi(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent($.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Gi{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=zi(ne.ACCESS_TOKEN);let a="";return a=r&&r.u?$.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(h,m)=>String.fromCharCode(+("0x"+m)))):ne.ACCESS_TOKEN||"",e?`${$i}.${e}:${a}`:`${$i}:${a}`}fetchEventData(){const e=Wt("localStorage"),r=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const h=$.localStorage.getItem(r);h&&(this.eventData=JSON.parse(h));const m=$.localStorage.getItem(a);m&&(this.anonId=m)}catch{Lt("Unable to read from LocalStorage")}}saveEventData(){const e=Wt("localStorage"),r=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{$.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&$.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{Lt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,a,h){if(!ne.EVENTS_URL)return;const m=ni(ne.EVENTS_URL);m.params.push(`access_token=${h||ne.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(e).toISOString()},w=r?fr(y,r):y,M={url:qt(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=function(k,B){return Qn(fr(k,{method:"POST"}),B)}(M,k=>{this.pendingRequest=null,a(k),this.saveEventData(),this.processRequests(h)})}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const ar=new class extends Gi{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){ne.EVENTS_URL&&ne.ACCESS_TOKEN&&Array.isArray(i)&&i.some(r=>qe(r)||ct(r))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=zi(ne.ACCESS_TOKEN),r=e?e.u:ne.ACCESS_TOKEN;let a=r!==this.eventData.tokenU;si(this.anonId)||(this.anonId=zt(),a=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),y=new Date(h),w=(h-this.eventData.lastSuccess)/864e5;a=a||w>=1||w<-1||m.getDate()!==y.getDate()}else a=!0;a?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Z,skuId:ae,"enabled.telemetry":!1,userId:this.anonId},m=>{m||(this.eventData.lastSuccess=h,this.eventData.tokenU=r)},i):this.processRequests()}},dr=ar.postTurnstileEvent.bind(ar),dn=new class extends Gi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,r,a){this.skuToken=e,this.errorCb=a,ne.EVENTS_URL&&(r||ne.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(Ve)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),si(this.anonId)||(this.anonId=zt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Z,skuId:ae,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},i))}},xn=dn.postMapLoadEvent.bind(dn),as=new class extends Gi{constructor(){super("gljs.performance")}postPerformanceEvent(i,e){ne.EVENTS_URL&&(i||ne.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:r}=this.queue.shift(),a=function(h){const m=$.performance.getEntriesByType("resource"),y=$.performance.getEntriesByType("mark"),w=function(G){const X={};if(G){for(const Y in G)if(Y!=="other")for(const ie of G[Y]){const de=`${Y}ResolveRangeMin`,Ee=`${Y}ResolveRangeMax`,Re=`${Y}RequestCount`,Se=`${Y}RequestCachedCount`;X[de]=Math.min(X[de]||1/0,ie.startTime),X[Ee]=Math.max(X[Ee]||-1/0,ie.responseEnd);const De=Ue=>{X[Ue]===void 0&&(X[Ue]=0),++X[Ue]};ie.transferSize!==void 0&&ie.transferSize===0&&De(Se),De(Re)}}return X}(function(G,X){const Y={};if(G)for(const ie of G){const de=X(ie);Y[de]===void 0&&(Y[de]=[]),Y[de].push(ie)}return Y}(m,Nf)),M=$.devicePixelRatio,k=$.navigator.connection||$.navigator.mozConnection||$.navigator.webkitConnection,B={counters:[],metadata:[],attributes:[]},U=(G,X,Y)=>{Y!=null&&G.push({name:X,value:Y.toString()})};for(const G in w)U(B.counters,G,w[G]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(U(B.counters,"interactionRangeMin",h.interactionRange[0]),U(B.counters,"interactionRangeMax",h.interactionRange[1])),y)for(const G of Object.keys(Cn)){const X=Cn[G],Y=y.find(ie=>ie.name===X);Y&&U(B.counters,X,Y.startTime)}return U(B.counters,"visibilityHidden",h.visibilityHidden),U(B.attributes,"style",function(G){if(G)for(const X of G){const Y=X.name.split("?")[0];if(Je(Y)){const ie=Y.split("/").slice(-2);if(ie.length===2)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(m)),U(B.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),U(B.attributes,"fogEnabled",h.fogEnabled?"true":"false"),U(B.attributes,"projection",h.projection),U(B.attributes,"zoom",h.zoom),U(B.metadata,"devicePixelRatio",M),U(B.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),U(B.metadata,"navigatorUserAgent",$.navigator.userAgent),U(B.metadata,"screenWidth",$.screen.width),U(B.metadata,"screenHeight",$.screen.height),U(B.metadata,"windowWidth",$.innerWidth),U(B.metadata,"windowHeight",$.innerHeight),U(B.metadata,"mapWidth",h.width/M),U(B.metadata,"mapHeight",h.height/M),U(B.metadata,"webglRenderer",h.renderer),U(B.metadata,"webglVendor",h.vendor),U(B.metadata,"sdkVersion",Z),U(B.metadata,"sdkIdentifier","mapbox-gl-js"),B}(r);for(const h of a.metadata);for(const h of a.counters);for(const h of a.attributes);this.postEvent(e,a,()=>{},i)}},Gn=as.postPerformanceEvent.bind(as),Uo=new class extends Gi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,r,a){if(!ne.API_URL||!ne.SESSION_PATH)return;const h=ni(ne.API_URL+ne.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${a||ne.ACCESS_TOKEN||""}`);const m={url:qt(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(y,w){return Qn(fr(y,{method:"GET"}),w)}(m,y=>{this.pendingRequest=null,r(y),this.saveEventData(),this.processRequests(a)})}getSessionAPI(i,e,r,a){this.skuToken=e,this.errorCb=a,ne.SESSION_PATH&&ne.API_URL&&(r||ne.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(Ve)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},i)}},Wn=Uo.getSessionAPI.bind(Uo),ds=new Set,Cn={create:"create",load:"load",fullLoad:"fullLoad"},Ff={mark(i){$.performance.mark(i)},measure(i,e,r){$.performance.measure(i,e,r)}};function Nf(i){const e=i.name.split("?")[0];return ot(e)&&e.includes("mapbox-gl.js")?"javascript":ot(e)&&e.includes("mapbox-gl.css")?"css":function(r){return ne.API_FONTS_REGEX.test(r)}(e)?"fontRange":st(e)?"sprite":Je(e)?"style":function(r){return ne.API_TILEJSON_REGEX.test(r)}(e)?"tilejson":"other"}const Tr=$.performance;function id(i){const e=i?i.url.toString():void 0;return Tr.getEntriesByName(e)}let Bc,Rh,zh,xo;const Vo={now:()=>zh!==void 0?zh:$.performance.now(),setNow(i){zh=i},restoreNow(){zh=void 0},frame(i){const e=$.requestAnimationFrame(i);return{cancel:()=>$.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:r,height:a}=i;xo||(xo=$.document.createElement("canvas"));const h=xo.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(r>xo.width||a>xo.height)&&(xo.width=r,xo.height=a),h.clearRect(-e,-e,r+2*e,a+2*e),h.drawImage(i,0,0,r,a),h.getImageData(-e,-e,r+2*e,a+2*e)},resolveURL:i=>(Bc||(Bc=$.document.createElement("a")),Bc.href=i,Bc.href),get devicePixelRatio(){return $.devicePixelRatio},get prefersReducedMotion(){return!!$.matchMedia&&(Rh==null&&(Rh=$.matchMedia("(prefers-reduced-motion: reduce)")),Rh.matches)}};function rd(i,e,r){r[i]&&r[i].indexOf(e)!==-1||(r[i]=r[i]||[],r[i].push(e))}function Fc(i,e,r){if(r&&r[i]){const a=r[i].indexOf(e);a!==-1&&r[i].splice(a,1)}}class jo{constructor(e,r={}){fr(this,r),this.type=e}}class fa extends jo{constructor(e,r={}){super("error",fr({error:e},r))}}class jr{on(e,r){return this._listeners=this._listeners||{},rd(e,r,this._listeners),this}off(e,r){return Fc(e,r,this._listeners),Fc(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},rd(e,r,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,r){typeof e=="string"&&(e=new jo(e,r||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const w of h)w.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const w of m)Fc(a,w,this._oneTimeListeners),w.call(this,e);const y=this._eventedParent;y&&(fr(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof fa&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var wt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function $o(i,...e){for(const r of e)for(const a in r)i[a]=r[a];return i}function Nn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function es(i){if(Array.isArray(i))return i.map(es);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const r in i)e[r]=es(i[r]);return e}return Nn(i)}class Uf extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var Go=Uf;class Bh{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[a,h]of r)this.bindings[a]=h}concat(e){return new Bh(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Vf=Bh;const Wl={kind:"null"},hi={kind:"number"},hr={kind:"string"},Ki={kind:"boolean"},Ls={kind:"color"},Ks={kind:"object"},Ji={kind:"value"},Ds={kind:"collator"},fs={kind:"formatted"},vo={kind:"resolvedImage"};function Js(i,e){return{kind:"array",itemType:i,N:e}}function on(i){if(i.kind==="array"){const e=on(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const jf=[Wl,hi,hr,Ki,Ls,fs,Ks,Js(Ji),vo];function bo(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!bo(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const r of jf)if(!bo(r,e))return null}}return`Expected ${on(i)} but found ${on(e)} instead.`}function Ua(i,e){return e.some(r=>r.kind===i.kind)}function Nc(i,e){return e.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}var nd,sd={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Hl(i){return(i=Math.round(i))<0?0:i>255?255:i}function Wo(i){return Hl(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function Fh(i){return(e=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:e>1?1:e;var e}function pa(i,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?i+(e-i)*r*6:2*r<1?e:3*r<2?i+(e-i)*(2/3-r)*6:i}try{nd={}.parseCSSColor=function(i){var e,r=i.replace(/ /g,"").toLowerCase();if(r in sd)return sd[r].slice();if(r[0]==="#")return r.length===4?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:r.length===7&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=r.indexOf("("),h=r.indexOf(")");if(a!==-1&&h+1===r.length){var m=r.substr(0,a),y=r.substr(a+1,h-(a+1)).split(","),w=1;switch(m){case"rgba":if(y.length!==4)return null;w=Fh(y.pop());case"rgb":return y.length!==3?null:[Wo(y[0]),Wo(y[1]),Wo(y[2]),w];case"hsla":if(y.length!==4)return null;w=Fh(y.pop());case"hsl":if(y.length!==3)return null;var M=(parseFloat(y[0])%360+360)%360/360,k=Fh(y[1]),B=Fh(y[2]),U=B<=.5?B*(k+1):B+k-B*k,G=2*B-U;return[Hl(255*pa(G,U,M+1/3)),Hl(255*pa(G,U,M)),Hl(255*pa(G,U,M-1/3)),w];default:return null}}return null}}catch{}class Os{constructor(e,r,a,h=1){this.r=e,this.g=r,this.b=a,this.a=h}static parse(e){if(!e)return;if(e instanceof Os)return e;if(typeof e!="string")return;const r=nd(e);return r?new Os(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,a,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(a)},${h})`}toArray(){const{r:e,g:r,b:a,a:h}=this;return h===0?[0,0,0,0]:[255*e/h,255*r/h,255*a/h,h]}toArray01(){const{r:e,g:r,b:a,a:h}=this;return h===0?[0,0,0,0]:[e/h,r/h,a/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:a,a:h}=this;return[e,r,a,h]}}Os.black=new Os(0,0,0,1),Os.white=new Os(1,1,1,1),Os.transparent=new Os(0,0,0,0),Os.red=new Os(1,0,0,1),Os.blue=new Os(0,0,1,1);var An=Os;class od{constructor(e,r,a){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Uc{constructor(e,r,a,h,m){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=a,this.fontStack=h,this.textColor=m}}class Rs{constructor(e){this.sections=e}static fromString(e){return new Rs([new Uc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Rs?e:Rs.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const a={};r.fontStack&&(a["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(a["font-scale"]=r.scale),r.textColor&&(a["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(a)}return e}}class Es{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Es({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ad(i,e,r,a){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[i,e,r,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[i,e,r,a]:[i,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zs(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof An||i instanceof od||i instanceof Rs||i instanceof Es)return!0;if(Array.isArray(i)){for(const e of i)if(!zs(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!zs(i[e]))return!1;return!0}return!1}function vn(i){if(i===null)return Wl;if(typeof i=="string")return hr;if(typeof i=="boolean")return Ki;if(typeof i=="number")return hi;if(i instanceof An)return Ls;if(i instanceof od)return Ds;if(i instanceof Rs)return fs;if(i instanceof Es)return vo;if(Array.isArray(i)){const e=i.length;let r;for(const a of i){const h=vn(a);if(r){if(r===h)continue;r=Ji;break}r=h}return Js(r||Ji,e)}return Ks}function ma(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof An||i instanceof Rs||i instanceof Es?i.toString():JSON.stringify(i)}class Vc{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!zs(e[1]))return r.error("invalid value");const a=e[1];let h=vn(a);const m=r.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Vc(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof An?["rgba"].concat(this.value.toArray()):this.value instanceof Rs?this.value.serialize():this.value}}var ga=Vc,ts=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Nh={string:hr,number:hi,boolean:Ki,object:Ks};class ld{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let a,h=1;const m=e[0];if(m==="array"){let w,M;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Nh)||k==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);w=Nh[k],h++}else w=Ji;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);M=e[2],h++}a=Js(w,M)}else a=Nh[m];const y=[];for(;h<e.length;h++){const w=r.parse(e[h],h,Ji);if(!w)return null;y.push(w)}return new ld(a,y)}evaluate(e){for(let r=0;r<this.args.length;r++){const a=this.args[r].evaluate(e);if(!bo(this.type,vn(a)))return a;if(r===this.args.length-1)throw new ts(`Expected value to be of type ${on(this.type)}, but found ${on(vn(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if(e.kind==="array"){const a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){r.push(a.kind);const h=e.N;(typeof h=="number"||this.args.length>1)&&r.push(h)}}return r.concat(this.args.map(a=>a.serialize()))}}var _a=ld;class ya{constructor(e){this.type=fs,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return r.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=e.length-1;++y){const w=e[y];if(m&&typeof w=="object"&&!Array.isArray(w)){m=!1;let M=null;if(w["font-scale"]&&(M=r.parse(w["font-scale"],1,hi),!M))return null;let k=null;if(w["text-font"]&&(k=r.parse(w["text-font"],1,Js(hr)),!k))return null;let B=null;if(w["text-color"]&&(B=r.parse(w["text-color"],1,Ls),!B))return null;const U=h[h.length-1];U.scale=M,U.font=k,U.textColor=B}else{const M=r.parse(e[y],1,Ji);if(!M)return null;const k=M.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:M,scale:null,font:null,textColor:null})}}return new ya(h)}evaluate(e){return new Rs(this.sections.map(r=>{const a=r.content.evaluate(e);return vn(a)===vo?new Uc("",a,null,null,null):new Uc(ma(a),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const a={};r.scale&&(a["font-scale"]=r.scale.serialize()),r.font&&(a["text-font"]=r.font.serialize()),r.textColor&&(a["text-color"]=r.textColor.serialize()),e.push(a)}return e}}class ql{constructor(e){this.type=vo,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const a=r.parse(e[1],1,hr);return a?new ql(a):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),a=Es.fromString(r);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(r)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Xl={"to-boolean":Ki,"to-color":Ls,"to-number":hi,"to-string":hr};class wo{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return r.error("Expected one argument.");const h=Xl[a],m=[];for(let y=1;y<e.length;y++){const w=r.parse(e[y],y,Ji);if(!w)return null;m.push(w)}return new wo(h,m)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let r,a;for(const h of this.args){if(r=h.evaluate(e),a=null,r instanceof An)return r;if(typeof r=="string"){const m=e.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(a=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:ad(r[0],r[1],r[2],r[3]),!a))return new An(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ts(a||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const a of this.args){if(r=a.evaluate(e),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new ts(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Rs.fromString(ma(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Es.fromString(ma(this.args[0].evaluate(e))):ma(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ya([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ql(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var xa=wo;const Ho=["Unknown","Point","LineString","Polygon"];var cd=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ho[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-i[0])+this.featureDistanceData.bearing[1]*(a*e-i[1])}return 0}parseColor(i){let e=this._parseColorCache[i];return e||(e=this._parseColorCache[i]=An.parse(i)),e}};class ll{constructor(e,r,a,h){this.name=e,this.type=r,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const a=e[0],h=ll.definitions[a];if(!h)return r.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let M=null;for(const[k,B]of w){M=new ud(r.registry,r.path,null,r.scope);const U=[];let G=!1;for(let X=1;X<e.length;X++){const Y=e[X],ie=Array.isArray(k)?k[X-1]:k.type,de=M.parse(Y,1+U.length,ie);if(!de){G=!0;break}U.push(de)}if(!G)if(Array.isArray(k)&&k.length!==U.length)M.error(`Expected ${k.length} arguments, but found ${U.length} instead.`);else{for(let X=0;X<U.length;X++){const Y=Array.isArray(k)?k[X]:k.type,ie=U[X];M.concat(X+1).checkSubtype(Y,ie.type)}if(M.errors.length===0)return new ll(a,m,B,U)}}if(w.length===1)r.errors.push(...M.errors);else{const k=(w.length?w:y).map(([U])=>{return G=U,Array.isArray(G)?`(${G.map(on).join(", ")})`:`(${on(G.type)}...)`;var G}).join(" | "),B=[];for(let U=1;U<e.length;U++){const G=r.parse(e[U],1+B.length);if(!G)return null;B.push(on(G.type))}r.error(`Expected arguments of type ${k}, but found (${B.join(", ")}) instead.`)}return null}static register(e,r){ll.definitions=r;for(const a in r)e[a]=ll}}var qo=ll;class bn{constructor(e,r,a){this.type=Ds,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return r.error("Collator options argument must be an object.");const h=r.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Ki);if(!h)return null;const m=r.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Ki);if(!m)return null;let y=null;return a.locale&&(y=r.parse(a.locale,1,hr),!y)?null:new bn(h,m,y)}evaluate(e){return new od(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const is=8192;function jc(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function Zl(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Yl(i,e){const r=(180+i[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(r*h*is),Math.round(a*h*is)]}function Kl(i,e,r){const a=i[0]-e[0],h=i[1]-e[1],m=i[0]-r[0],y=i[1]-r[1];return a*y-m*h==0&&a*m<=0&&h*y<=0}function Uh(i,e){let r=!1;for(let y=0,w=e.length;y<w;y++){const M=e[y];for(let k=0,B=M.length;k<B-1;k++){if(Kl(i,M[k],M[k+1]))return!1;(h=M[k])[1]>(a=i)[1]!=(m=M[k+1])[1]>a[1]&&a[0]<(m[0]-h[0])*(a[1]-h[1])/(m[1]-h[1])+h[0]&&(r=!r)}}var a,h,m;return r}function Jl(i,e){for(let r=0;r<e.length;r++)if(Uh(i,e[r]))return!0;return!1}function Vh(i,e,r,a){const h=a[0]-r[0],m=a[1]-r[1],y=(i[0]-r[0])*m-h*(i[1]-r[1]),w=(e[0]-r[0])*m-h*(e[1]-r[1]);return y>0&&w<0||y<0&&w>0}function Qs(i,e,r){for(const k of r)for(let B=0;B<k.length-1;++B)if((w=[(y=k[B+1])[0]-(m=k[B])[0],y[1]-m[1]])[0]*(M=[(h=e)[0]-(a=i)[0],h[1]-a[1]])[1]-w[1]*M[0]!=0&&Vh(a,h,m,y)&&Vh(m,y,a,h))return!0;var a,h,m,y,w,M;return!1}function wr(i,e){for(let r=0;r<i.length;++r)if(!Uh(i[r],e))return!1;for(let r=0;r<i.length-1;++r)if(Qs(i[r],i[r+1],e))return!1;return!0}function wm(i,e){for(let r=0;r<e.length;r++)if(wr(i,e[r]))return!0;return!1}function cl(i,e,r){const a=[];for(let h=0;h<i.length;h++){const m=[];for(let y=0;y<i[h].length;y++){const w=Yl(i[h][y],r);jc(e,w),m.push(w)}a.push(m)}return a}function hd(i,e,r){const a=[];for(let h=0;h<i.length;h++){const m=cl(i[h],e,r);a.push(m)}return a}function jh(i,e,r,a){if(i[0]<r[0]||i[0]>r[2]){const h=.5*a;let m=i[0]-r[0]>h?-a:r[0]-i[0]>h?a:0;m===0&&(m=i[0]-r[2]>h?-a:r[2]-i[0]>h?a:0),i[0]+=m}jc(e,i)}function $h(i,e,r,a){const h=Math.pow(2,a.z)*is,m=[a.x*is,a.y*is],y=[];if(!i)return y;for(const w of i)for(const M of w){const k=[M.x+m[0],M.y+m[1]];jh(k,e,r,h),y.push(k)}return y}function Gh(i,e,r,a){const h=Math.pow(2,a.z)*is,m=[a.x*is,a.y*is],y=[];if(!i)return y;for(const M of i){const k=[];for(const B of M){const U=[B.x+m[0],B.y+m[1]];jc(e,U),k.push(U)}y.push(k)}if(e[2]-e[0]<=h/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const M of y)for(const k of M)jh(k,e,r,h)}var w;return y}class Va{constructor(e,r){this.type=Ki,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(zs(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let h=0;h<a.features.length;++h){const m=a.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Va(a,a.features[h].geometry)}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Va(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Va(a,a)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(!y)return!1;if(a.type==="Polygon"){const w=cl(a.coordinates,m,y),M=$h(r.geometry(),h,m,y);if(!Zl(h,m))return!1;for(const k of M)if(!Uh(k,w))return!1}if(a.type==="MultiPolygon"){const w=hd(a.coordinates,m,y),M=$h(r.geometry(),h,m,y);if(!Zl(h,m))return!1;for(const k of M)if(!Jl(k,w))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(!y)return!1;if(a.type==="Polygon"){const w=cl(a.coordinates,m,y),M=Gh(r.geometry(),h,m,y);if(!Zl(h,m))return!1;for(const k of M)if(!wr(k,w))return!1}if(a.type==="MultiPolygon"){const w=hd(a.coordinates,m,y),M=Gh(r.geometry(),h,m,y);if(!Zl(h,m))return!1;for(const k of M)if(!wm(k,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Wh=Va;function hl(i){if(i instanceof qo&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Wh)return!1;let e=!0;return i.eachChild(r=>{e&&!hl(r)&&(e=!1)}),e}function To(i){if(i instanceof qo&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(r=>{e&&!To(r)&&(e=!1)}),e}function ul(i,e){if(i instanceof qo&&e.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(a=>{r&&!ul(a,e)&&(r=!1)}),r}class Hh{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const a=e[1];return r.scope.has(a)?new Hh(a,r.scope.get(a)):r.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var $f=Hh;class $c{constructor(e,r=[],a,h=new Vf,m=[]){this.registry=e,this.path=r,this.key=r.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=m,this.expectedType=a}parse(e,r,a,h,m={}){return r?this.concat(r,a,h)._parse(e,m):this._parse(e,m)}_parse(e,r){function a(h,m,y){return y==="assert"?new _a(m,[h]):y==="coerce"?new xa(m,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,M=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||M.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(w,M))return null}else y=a(y,w,r.typeAnnotation||"coerce");else y=a(y,w,r.typeAnnotation||"assert")}if(!(y instanceof ga)&&y.type.kind!=="resolvedImage"&&Gc(y)){const w=new cd;try{y=new ga(y.type,y.evaluate(w))}catch(M){return this.error(M.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,a){const h=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new $c(this.registry,h,r||null,m,this.errors)}error(e,...r){const a=`${this.key}${r.map(h=>`[${h}]`).join("")}`;this.errors.push(new Go(a,e))}checkSubtype(e,r){const a=bo(e,r);return a&&this.error(a),a}}var ud=$c;function Gc(i){if(i instanceof $f)return Gc(i.boundExpression);if(i instanceof qo&&i.name==="error"||i instanceof bn||i instanceof Wh)return!1;const e=i instanceof xa||i instanceof _a;let r=!0;return i.eachChild(a=>{r=e?r&&Gc(a):r&&a instanceof ga}),!!r&&hl(i)&&ul(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function qh(i,e){const r=i.length-1;let a,h,m=0,y=r,w=0;for(;m<=y;)if(w=Math.floor((m+y)/2),a=i[w],h=i[w+1],a<=e){if(w===r||e<h)return w;m=w+1}else{if(!(a>e))throw new ts("Input is not a number.");y=w-1}return 0}class Xh{constructor(e,r,a){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const a=r.parse(e[1],1,hi);if(!a)return null;const h=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let y=1;y<e.length;y+=2){const w=y===1?-1/0:e[y],M=e[y+1],k=y,B=y+1;if(typeof w!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(h.length&&h[h.length-1][0]>=w)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const U=r.parse(M,B,m);if(!U)return null;m=m||U.type,h.push([w,U])}return new Xh(m,a,h)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);const m=r.length;return h>=r[m-1]?a[m-1].evaluate(e):a[qh(r,h)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var dd=Xh;function mr(i,e,r){return i*(1-r)+e*r}var Xo=Object.freeze({__proto__:null,array:function(i,e,r){return i.map((a,h)=>mr(a,e[h],r))},color:function(i,e,r){return new An(mr(i.r,e.r,r),mr(i.g,e.g,r),mr(i.b,e.b,r),mr(i.a,e.a,r))},number:mr});const fd=.95047,Zh=1.08883,Gf=4/29,dl=6/29,pd=3*dl*dl,md=dl*dl*dl,gd=Math.PI/180,Yh=180/Math.PI;function Ql(i){return i>md?Math.pow(i,1/3):i/pd+Gf}function _d(i){return i>dl?i*i*i:pd*(i-Gf)}function Kh(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function fl(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function ja(i){const e=fl(i.r),r=fl(i.g),a=fl(i.b),h=Ql((.4124564*e+.3575761*r+.1804375*a)/fd),m=Ql((.2126729*e+.7151522*r+.072175*a)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-Ql((.0193339*e+.119192*r+.9503041*a)/Zh)),alpha:i.a}}function Wf(i){let e=(i.l+16)/116,r=isNaN(i.a)?e:e+i.a/500,a=isNaN(i.b)?e:e-i.b/200;return e=1*_d(e),r=fd*_d(r),a=Zh*_d(a),new An(Kh(3.2404542*r-1.5371385*e-.4985314*a),Kh(-.969266*r+1.8760108*e+.041556*a),Kh(.0556434*r-.2040259*e+1.0572252*a),i.alpha)}function pl(i,e,r){const a=e-i;return i+r*(a>180||a<-180?a-360*Math.round(a/360):a)}const Wc={forward:ja,reverse:Wf,interpolate:function(i,e,r){return{l:mr(i.l,e.l,r),a:mr(i.a,e.a,r),b:mr(i.b,e.b,r),alpha:mr(i.alpha,e.alpha,r)}}},Eo={forward:function(i){const{l:e,a:r,b:a}=ja(i),h=Math.atan2(a,r)*Yh;return{h:h<0?h+360:h,c:Math.sqrt(r*r+a*a),l:e,alpha:i.a}},reverse:function(i){const e=i.h*gd,r=i.c;return Wf({l:i.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:i.alpha})},interpolate:function(i,e,r){return{h:pl(i.h,e.h,r),c:mr(i.c,e.c,r),l:mr(i.l,e.l,r),alpha:mr(i.alpha,e.alpha,r)}}};var ml=Object.freeze({__proto__:null,hcl:Eo,lab:Wc});class Hc{constructor(e,r,a,h,m){this.type=e,this.operator=r,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[y,w]of m)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(e,r,a,h){let m=0;if(e.name==="exponential")m=qc(r,e.base,a,h);else if(e.name==="linear")m=qc(r,1,a,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new rt(y[0],y[1],y[2],y[3]).solve(qc(r,1,a,h))}return m}static parse(e,r){let[a,h,m,...y]=e;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const k=h[1];if(typeof k!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:k}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const k=h.slice(1);if(k.length!==4||k.some(B=>typeof B!="number"||B<0||B>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,hi),!m)return null;const w=[];let M=null;a==="interpolate-hcl"||a==="interpolate-lab"?M=Ls:r.expectedType&&r.expectedType.kind!=="value"&&(M=r.expectedType);for(let k=0;k<y.length;k+=2){const B=y[k],U=y[k+1],G=k+3,X=k+4;if(typeof B!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(w.length&&w[w.length-1][0]>=B)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=r.parse(U,X,M);if(!Y)return null;M=M||Y.type,w.push([B,Y])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Hc(M,a,h,m,w):r.error(`Type ${on(M)} is not interpolatable.`)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);const m=r.length;if(h>=r[m-1])return a[m-1].evaluate(e);const y=qh(r,h),w=Hc.interpolationFactor(this.interpolation,h,r[y],r[y+1]),M=a[y].evaluate(e),k=a[y+1].evaluate(e);return this.operator==="interpolate"?Xo[this.type.kind.toLowerCase()](M,k,w):this.operator==="interpolate-hcl"?Eo.reverse(Eo.interpolate(Eo.forward(M),Eo.forward(k),w)):Wc.reverse(Wc.interpolate(Wc.forward(M),Wc.forward(k),w))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)r.push(this.labels[a],this.outputs[a].serialize());return r}}function qc(i,e,r,a){const h=a-r,m=i-r;return h===0?0:e===1?m/h:(Math.pow(e,m)-1)/(Math.pow(e,h)-1)}var eo=Hc;class Jh{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let a=null;const h=r.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const w of e.slice(1)){const M=r.parse(w,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!M)return null;a=a||M.type,m.push(M)}const y=h&&m.some(w=>bo(h,w.type));return new Jh(y?Ji:a,m)}evaluate(e){let r,a=null,h=0;for(const m of this.args){if(h++,a=m.evaluate(e),a&&a instanceof Es&&!a.available&&(r||(r=a),a=null,h===this.args.length))return r;if(a!==null)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var yd=Jh;class Qh{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=r.parse(e[m+1],m+1);if(!w)return null;a.push([y,w])}const h=r.parse(e[e.length-1],e.length-1,r.expectedType,a);return h?new Qh(a,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,a]of this.bindings)e.push(r,a.serialize());return e.push(this.result.serialize()),e}}var Xc=Qh;class xd{constructor(e,r,a){this.type=e,this.index=r,this.input=a}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,hi),h=r.parse(e[2],2,Js(r.expectedType||Ji));return a&&h?new xd(h.type.itemType,a,h):null}evaluate(e){const r=this.index.evaluate(e),a=this.input.evaluate(e);if(r<0)throw new ts(`Array index out of bounds: ${r} < 0.`);if(r>=a.length)throw new ts(`Array index out of bounds: ${r} > ${a.length-1}.`);if(r!==Math.floor(r))throw new ts(`Array index must be an integer, but found ${r} instead.`);return a[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Tm=xd;class vd{constructor(e,r){this.type=Ki,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Ji),h=r.parse(e[2],2,Ji);return a&&h?Ua(a.type,[Ki,hr,hi,Wl,Ji])?new vd(a,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${on(a.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(a==null)return!1;if(!Nc(r,["boolean","string","number","null"]))throw new ts(`Expected first argument to be of type boolean, string, number or null, but found ${on(vn(r))} instead.`);if(!Nc(a,["string","array"]))throw new ts(`Expected second argument to be of type array or string, but found ${on(vn(a))} instead.`);return a.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var So=vd;class Zc{constructor(e,r,a){this.type=hi,this.needle=e,this.haystack=r,this.fromIndex=a}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Ji),h=r.parse(e[2],2,Ji);if(!a||!h)return null;if(!Ua(a.type,[Ki,hr,hi,Wl,Ji]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${on(a.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,hi);return m?new Zc(a,h,m):null}return new Zc(a,h)}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!Nc(r,["boolean","string","number","null"]))throw new ts(`Expected first argument to be of type boolean, string, number or null, but found ${on(vn(r))} instead.`);if(!Nc(a,["string","array"]))throw new ts(`Expected second argument to be of type array or string, but found ${on(vn(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(r,h)}return a.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var bd=Zc;class wd{constructor(e,r,a,h,m,y){this.inputType=e,this.type=r,this.input=a,this.cases=h,this.outputs=m,this.otherwise=y}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let a,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const m={},y=[];for(let k=2;k<e.length-1;k+=2){let B=e[k];const U=e[k+1];Array.isArray(B)||(B=[B]);const G=r.concat(k);if(B.length===0)return G.error("Expected at least one branch label.");for(const Y of B){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(a){if(G.checkSubtype(a,vn(Y)))return null}else a=vn(Y);if(m[String(Y)]!==void 0)return G.error("Branch labels must be unique.");m[String(Y)]=y.length}const X=r.parse(U,k,h);if(!X)return null;h=h||X.type,y.push(X)}const w=r.parse(e[1],1,Ji);if(!w)return null;const M=r.parse(e[e.length-1],e.length-1,h);return M?w.type.kind!=="value"&&r.concat(1).checkSubtype(a,w.type)?null:new wd(a,h,w,m,y,M):null}evaluate(e){const r=this.input.evaluate(e);return(vn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),a=[],h={};for(const y of r){const w=h[this.cases[y]];w===void 0?(h[this.cases[y]]=a.length,a.push([this.cases[y],[y]])):a[w][1].push(y)}const m=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,w]of a)e.push(w.length===1?m(w[0]):w.map(m)),e.push(this.outputs[y].serialize());return e.push(this.otherwise.serialize()),e}}var Em=wd;class ec{constructor(e,r,a){this.type=e,this.branches=r,this.otherwise=a}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const w=r.parse(e[y],y,Ki);if(!w)return null;const M=r.parse(e[y+1],y+1,a);if(!M)return null;h.push([w,M]),a=a||M.type}const m=r.parse(e[e.length-1],e.length-1,a);return m?new ec(a,h,m):null}evaluate(e){for(const[r,a]of this.branches)if(r.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,a]of this.branches)e(r),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Hf=ec;class Yc{constructor(e,r,a,h){this.type=e,this.input=r,this.beginIndex=a,this.endIndex=h}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Ji),h=r.parse(e[2],2,hi);if(!a||!h)return null;if(!Ua(a.type,[Js(Ji),hr,Ji]))return r.error(`Expected first argument to be of type array or string, but found ${on(a.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,hi);return m?new Yc(a.type,a,h,m):null}return new Yc(a.type,a,h)}evaluate(e){const r=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!Nc(r,["string","array"]))throw new ts(`Expected first argument to be of type array or string, but found ${on(vn(r))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return r.slice(a,h)}return r.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Td=Yc;function eu(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function gl(i,e,r,a){return a.compare(e,r)===0}function to(i,e,r){const a=i!=="=="&&i!=="!=";return class ZA{constructor(m,y,w){this.type=Ki,this.lhs=m,this.rhs=y,this.collator=w,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const w=m[0];let M=y.parse(m[1],1,Ji);if(!M)return null;if(!eu(w,M.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${on(M.type)}'.`);let k=y.parse(m[2],2,Ji);if(!k)return null;if(!eu(w,k.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${on(k.type)}'.`);if(M.type.kind!==k.type.kind&&M.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${on(M.type)}' and '${on(k.type)}'.`);a&&(M.type.kind==="value"&&k.type.kind!=="value"?M=new _a(k.type,[M]):M.type.kind!=="value"&&k.type.kind==="value"&&(k=new _a(M.type,[k])));let B=null;if(m.length===4){if(M.type.kind!=="string"&&k.type.kind!=="string"&&M.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(B=y.parse(m[3],3,Ds),!B)return null}return new ZA(M,k,B)}evaluate(m){const y=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const M=vn(y),k=vn(w);if(M.kind!==k.kind||M.kind!=="string"&&M.kind!=="number")throw new ts(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${M.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const M=vn(y),k=vn(w);if(M.kind!=="string"||k.kind!=="string")return e(m,y,w)}return this.collator?r(m,y,w,this.collator.evaluate(m)):e(m,y,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[i];return this.eachChild(y=>{m.push(y.serialize())}),m}}}const Sm=to("==",function(i,e,r){return e===r},gl),Cm=to("!=",function(i,e,r){return e!==r},function(i,e,r,a){return!gl(0,e,r,a)}),Am=to("<",function(i,e,r){return e<r},function(i,e,r,a){return a.compare(e,r)<0}),Mm=to(">",function(i,e,r){return e>r},function(i,e,r,a){return a.compare(e,r)>0}),Im=to("<=",function(i,e,r){return e<=r},function(i,e,r,a){return a.compare(e,r)<=0}),Kc=to(">=",function(i,e,r){return e>=r},function(i,e,r,a){return a.compare(e,r)>=0});class tc{constructor(e,r,a,h,m,y){this.type=hr,this.number=e,this.locale=r,this.currency=a,this.unit=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const a=r.parse(e[1],1,hi);if(!a)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=r.parse(h.locale,1,hr),!m))return null;let y=null;if(h.currency&&(y=r.parse(h.currency,1,hr),!y))return null;let w=null;if(h.unit&&(w=r.parse(h.unit,1,hr),!w))return null;let M=null;if(h["min-fraction-digits"]&&(M=r.parse(h["min-fraction-digits"],1,hi),!M))return null;let k=null;return h["max-fraction-digits"]&&(k=r.parse(h["max-fraction-digits"],1,hi),!k)?null:new tc(a,m,y,w,M,k)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class ic{constructor(e){this.type=hi,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=r.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${on(a.type)} instead.`):new ic(a):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new ts(`Expected value to be of type string or array, but found ${on(vn(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const Jc={"==":Sm,"!=":Cm,">":Mm,"<":Am,">=":Kc,"<=":Im,array:_a,at:Tm,boolean:_a,case:Hf,coalesce:yd,collator:bn,format:ya,image:ql,in:So,"index-of":bd,interpolate:eo,"interpolate-hcl":eo,"interpolate-lab":eo,length:ic,let:Xc,literal:ga,match:Em,number:_a,"number-format":tc,object:_a,slice:Td,step:dd,string:_a,"to-boolean":xa,"to-color":xa,"to-number":xa,"to-string":xa,var:$f,within:Wh};function tu(i,[e,r,a,h]){e=e.evaluate(i),r=r.evaluate(i),a=a.evaluate(i);const m=h?h.evaluate(i):1,y=ad(e,r,a,m);if(y)throw new ts(y);return new An(e/255*m,r/255*m,a/255*m,m)}function va(i,e){return i in e}function Qc(i,e){const r=e[i];return r===void 0?null:r}function ps(i){return{type:i}}qo.register(Jc,{error:[{kind:"error"},[hr],(i,[e])=>{throw new ts(e.evaluate(i))}],typeof:[hr,[Ji],(i,[e])=>on(vn(e.evaluate(i)))],"to-rgba":[Js(hi,4),[Ls],(i,[e])=>e.evaluate(i).toArray()],rgb:[Ls,[hi,hi,hi],tu],rgba:[Ls,[hi,hi,hi,hi],tu],has:{type:Ki,overloads:[[[hr],(i,[e])=>va(e.evaluate(i),i.properties())],[[hr,Ks],(i,[e,r])=>va(e.evaluate(i),r.evaluate(i))]]},get:{type:Ji,overloads:[[[hr],(i,[e])=>Qc(e.evaluate(i),i.properties())],[[hr,Ks],(i,[e,r])=>Qc(e.evaluate(i),r.evaluate(i))]]},"feature-state":[Ji,[hr],(i,[e])=>Qc(e.evaluate(i),i.featureState||{})],properties:[Ks,[],i=>i.properties()],"geometry-type":[hr,[],i=>i.geometryType()],id:[Ji,[],i=>i.id()],zoom:[hi,[],i=>i.globals.zoom],pitch:[hi,[],i=>i.globals.pitch||0],"distance-from-center":[hi,[],i=>i.distanceFromCenter()],"heatmap-density":[hi,[],i=>i.globals.heatmapDensity||0],"line-progress":[hi,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[hi,[],i=>i.globals.skyRadialProgress||0],accumulated:[Ji,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[hi,ps(hi),(i,e)=>{let r=0;for(const a of e)r+=a.evaluate(i);return r}],"*":[hi,ps(hi),(i,e)=>{let r=1;for(const a of e)r*=a.evaluate(i);return r}],"-":{type:hi,overloads:[[[hi,hi],(i,[e,r])=>e.evaluate(i)-r.evaluate(i)],[[hi],(i,[e])=>-e.evaluate(i)]]},"/":[hi,[hi,hi],(i,[e,r])=>e.evaluate(i)/r.evaluate(i)],"%":[hi,[hi,hi],(i,[e,r])=>e.evaluate(i)%r.evaluate(i)],ln2:[hi,[],()=>Math.LN2],pi:[hi,[],()=>Math.PI],e:[hi,[],()=>Math.E],"^":[hi,[hi,hi],(i,[e,r])=>Math.pow(e.evaluate(i),r.evaluate(i))],sqrt:[hi,[hi],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[hi,[hi],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[hi,[hi],(i,[e])=>Math.log(e.evaluate(i))],log2:[hi,[hi],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[hi,[hi],(i,[e])=>Math.sin(e.evaluate(i))],cos:[hi,[hi],(i,[e])=>Math.cos(e.evaluate(i))],tan:[hi,[hi],(i,[e])=>Math.tan(e.evaluate(i))],asin:[hi,[hi],(i,[e])=>Math.asin(e.evaluate(i))],acos:[hi,[hi],(i,[e])=>Math.acos(e.evaluate(i))],atan:[hi,[hi],(i,[e])=>Math.atan(e.evaluate(i))],min:[hi,ps(hi),(i,e)=>Math.min(...e.map(r=>r.evaluate(i)))],max:[hi,ps(hi),(i,e)=>Math.max(...e.map(r=>r.evaluate(i)))],abs:[hi,[hi],(i,[e])=>Math.abs(e.evaluate(i))],round:[hi,[hi],(i,[e])=>{const r=e.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[hi,[hi],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[hi,[hi],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Ki,[hr,Ji],(i,[e,r])=>i.properties()[e.value]===r.value],"filter-id-==":[Ki,[Ji],(i,[e])=>i.id()===e.value],"filter-type-==":[Ki,[hr],(i,[e])=>i.geometryType()===e.value],"filter-<":[Ki,[hr,Ji],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a<h}],"filter-id-<":[Ki,[Ji],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r<a}],"filter->":[Ki,[hr,Ji],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a>h}],"filter-id->":[Ki,[Ji],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r>a}],"filter-<=":[Ki,[hr,Ji],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[Ki,[Ji],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r<=a}],"filter->=":[Ki,[hr,Ji],(i,[e,r])=>{const a=i.properties()[e.value],h=r.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[Ki,[Ji],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r>=a}],"filter-has":[Ki,[Ji],(i,[e])=>e.value in i.properties()],"filter-has-id":[Ki,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Ki,[Js(hr)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ki,[Js(Ji)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Ki,[hr,Js(Ji)],(i,[e,r])=>r.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Ki,[hr,Js(Ji)],(i,[e,r])=>function(a,h,m,y){for(;m<=y;){const w=m+y>>1;if(h[w]===a)return!0;h[w]>a?y=w-1:m=w+1}return!1}(i.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Ki,overloads:[[[Ki,Ki],(i,[e,r])=>e.evaluate(i)&&r.evaluate(i)],[ps(Ki),(i,e)=>{for(const r of e)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Ki,overloads:[[[Ki,Ki],(i,[e,r])=>e.evaluate(i)||r.evaluate(i)],[ps(Ki),(i,e)=>{for(const r of e)if(r.evaluate(i))return!0;return!1}]]},"!":[Ki,[Ki],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Ki,[hr],(i,[e])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(e.evaluate(i))}],upcase:[hr,[hr],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[hr,[hr],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[hr,ps(Ji),(i,e)=>e.map(r=>ma(r.evaluate(i))).join("")],"resolved-locale":[hr,[Ds],(i,[e])=>e.evaluate(i).resolvedLocale()]});var eh=Jc;function th(i){return{result:"success",value:i}}function _l(i){return{result:"error",value:i}}function rc(i){return i["property-type"]==="data-driven"}function Gs(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function ba(i){return!!i.expression&&i.expression.interpolated}function vr(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function nc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function qf(i){return i}function sc(i,e){const r=e.type==="color",a=i.stops&&typeof i.stops[0][0]=="object",h=a||!(a||i.property!==void 0),m=i.type||(ba(e)?"exponential":"interval");if(r&&((i=$o({},i)).stops&&(i.stops=i.stops.map(k=>[k[0],An.parse(k[1])])),i.default=An.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!ml[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let y,w,M;if(m==="exponential")y=wa;else if(m==="interval")y=ih;else if(m==="categorical"){y=Xf,w=Object.create(null);for(const k of i.stops)w[k[0]]=k[1];M=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);y=iu}if(a){const k={},B=[];for(let X=0;X<i.stops.length;X++){const Y=i.stops[X],ie=Y[0].zoom;k[ie]===void 0&&(k[ie]={zoom:ie,type:i.type,property:i.property,default:i.default,stops:[]},B.push(ie)),k[ie].stops.push([Y[0].value,Y[1]])}const U=[];for(const X of B)U.push([k[X].zoom,sc(k[X],e)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:eo.interpolationFactor.bind(void 0,G),zoomStops:U.map(X=>X[0]),evaluate:({zoom:X},Y)=>wa({stops:U,base:i.base},e,X).evaluate(X,Y)}}if(h){const k=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:eo.interpolationFactor.bind(void 0,k),zoomStops:i.stops.map(B=>B[0]),evaluate:({zoom:B})=>y(i,e,B,w,M)}}return{kind:"source",evaluate(k,B){const U=B&&B.properties?B.properties[i.property]:void 0;return U===void 0?oc(i.default,e.default):y(i,e,U,w,M)}}}function oc(i,e,r){return i!==void 0?i:e!==void 0?e:r!==void 0?r:void 0}function Xf(i,e,r,a,h){return oc(typeof r===h?a[r]:void 0,i.default,e.default)}function ih(i,e,r){if(vr(r)!=="number")return oc(i.default,e.default);const a=i.stops.length;if(a===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[a-1][0])return i.stops[a-1][1];const h=qh(i.stops.map(m=>m[0]),r);return i.stops[h][1]}function wa(i,e,r){const a=i.base!==void 0?i.base:1;if(vr(r)!=="number")return oc(i.default,e.default);const h=i.stops.length;if(h===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[h-1][0])return i.stops[h-1][1];const m=qh(i.stops.map(B=>B[0]),r),y=function(B,U,G,X){const Y=X-G,ie=B-G;return Y===0?0:U===1?ie/Y:(Math.pow(U,ie)-1)/(Math.pow(U,Y)-1)}(r,a,i.stops[m][0],i.stops[m+1][0]),w=i.stops[m][1],M=i.stops[m+1][1];let k=Xo[e.type]||qf;if(i.colorSpace&&i.colorSpace!=="rgb"){const B=ml[i.colorSpace];k=(U,G)=>B.reverse(B.interpolate(B.forward(U),B.forward(G),y))}return typeof w.evaluate=="function"?{evaluate(...B){const U=w.evaluate.apply(void 0,B),G=M.evaluate.apply(void 0,B);if(U!==void 0&&G!==void 0)return k(U,G,y)}}:k(w,M,y)}function iu(i,e,r){return e.type==="color"?r=An.parse(r):e.type==="formatted"?r=Rs.fromString(r.toString()):e.type==="resolvedImage"?r=Es.fromString(r.toString()):vr(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),oc(r,i.default,e.default)}class ms{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new cd,this._defaultValue=r?function(a){return a.type==="color"&&(nc(a.default)||Array.isArray(a.default))?new An(0,0,0,0):a.type==="color"?An.parse(a.default)||null:a.default===void 0?null:a.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,a,h,m,y,w,M){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=a,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,a,h,m,y,w,M){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=M||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new ts(`Expected value to be one of ${Object.keys(this._enumValues).map(B=>JSON.stringify(B)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Ar(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in eh}function ac(i,e){const r=new ud(eh,[],e?function(h){const m={color:Ls,string:hr,number:hi,enum:hr,boolean:Ki,formatted:fs,resolvedImage:vo};return h.type==="array"?Js(m[h.value]||Ji,h.length):m[h.type]}(e):void 0),a=r.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?th(new ms(a,e)):_l(r.errors)}class ru{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!To(r.expression)}evaluateWithoutErrorHandling(e,r,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,m,y)}evaluate(e,r,a,h,m,y){return this._styleExpression.evaluate(e,r,a,h,m,y)}}class yl{constructor(e,r,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!To(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,r,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,m,y)}evaluate(e,r,a,h,m,y){return this._styleExpression.evaluate(e,r,a,h,m,y)}interpolationFactor(e,r,a){return this.interpolationType?eo.interpolationFactor(this.interpolationType,e,r,a):0}}function $a(i,e){if((i=ac(i,e)).result==="error")return i;const r=i.value.expression,a=hl(r);if(!a&&!rc(e))return _l([new Go("","data expressions not supported")]);const h=ul(r,["zoom","pitch","distance-from-center"]);if(!h&&!Gs(e))return _l([new Go("","zoom expressions not supported")]);const m=rh(r);return m||h?m instanceof Go?_l([m]):m instanceof eo&&!ba(e)?_l([new Go("",'"interpolate" expressions cannot be used with this property')]):th(m?new yl(a?"camera":"composite",i.value,m.labels,m instanceof eo?m.interpolation:void 0):new ru(a?"constant":"source",i.value)):_l([new Go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Zr{constructor(e,r){this._parameters=e,this._specification=r,$o(this,sc(this._parameters,this._specification))}static deserialize(e){return new Zr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function rh(i){let e=null;if(i instanceof Xc)e=rh(i.result);else if(i instanceof yd){for(const r of i.args)if(e=rh(r),e)break}else(i instanceof dd||i instanceof eo)&&i.input instanceof qo&&i.input.name==="zoom"&&(e=i);return e instanceof Go||i.eachChild(r=>{const a=rh(r);a instanceof Go?e=a:!e&&a?e=new Go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Go("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class fi{constructor(e,r,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function io(i){const e=i.key,r=i.value,a=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,y=i.styleSpec;let w=[];const M=vr(r);if(M!=="object")return[new fi(e,r,`object expected, ${M} found`)];for(const k in r){const B=k.split(".")[0];let U;h[B]?U=h[B]:a[B]?U=gs:h["*"]?U=h["*"]:a["*"]&&(U=gs),U?w=w.concat(U({key:(e&&`${e}.`)+k,value:r[k],valueSpec:a[B]||a["*"],style:m,styleSpec:y,object:r,objectKey:k},r)):w.push(new fi(e,r[k],`unknown property "${k}"`))}for(const k in a)h[k]||a[k].required&&a[k].default===void 0&&r[k]===void 0&&w.push(new fi(e,r,`missing required property "${k}"`));return w}function Fi(i){const e=i.value,r=i.valueSpec,a=i.style,h=i.styleSpec,m=i.key,y=i.arrayElementValidator||gs;if(vr(e)!=="array")return[new fi(m,e,`array expected, ${vr(e)} found`)];if(r.length&&e.length!==r.length)return[new fi(m,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new fi(m,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let w={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};h.$version<7&&(w.function=r.function),vr(r.value)==="object"&&(w=r.value);let M=[];for(let k=0;k<e.length;k++)M=M.concat(y({array:e,arrayIndex:k,value:e[k],valueSpec:w,style:a,styleSpec:h,key:`${m}[${k}]`}));return M}function lc(i){const e=i.key,r=i.value,a=i.valueSpec;let h=vr(r);if(h==="number"&&r!=r&&(h="NaN"),h!=="number")return[new fi(e,r,`number expected, ${h} found`)];if("minimum"in a){let m=a.minimum;if(vr(a.minimum)==="array"&&(m=a.minimum[i.arrayIndex]),r<m)return[new fi(e,r,`${r} is less than the minimum value ${m}`)]}if("maximum"in a){let m=a.maximum;if(vr(a.maximum)==="array"&&(m=a.maximum[i.arrayIndex]),r>m)return[new fi(e,r,`${r} is greater than the maximum value ${m}`)]}return[]}function Ga(i){const e=i.valueSpec,r=Nn(i.value.type);let a,h,m,y={};const w=r!=="categorical"&&i.value.property===void 0,M=!w,k=vr(i.value.stops)==="array"&&vr(i.value.stops[0])==="array"&&vr(i.value.stops[0][0])==="object",B=io({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(X){if(r==="identity")return[new fi(X.key,X.value,'identity function may not have a "stops" property')];let Y=[];const ie=X.value;return Y=Y.concat(Fi({key:X.key,value:ie,valueSpec:X.valueSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:U})),vr(ie)==="array"&&ie.length===0&&Y.push(new fi(X.key,ie,"array must have at least one stop")),Y},default:function(X){return gs({key:X.key,value:X.value,valueSpec:e,style:X.style,styleSpec:X.styleSpec})}}});return r==="identity"&&w&&B.push(new fi(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||B.push(new fi(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!ba(i.valueSpec)&&B.push(new fi(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(M&&!rc(i.valueSpec)?B.push(new fi(i.key,i.value,"property functions not supported")):w&&!Gs(i.valueSpec)&&B.push(new fi(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!k||i.value.property!==void 0||B.push(new fi(i.key,i.value,'"property" property is required')),B;function U(X){let Y=[];const ie=X.value,de=X.key;if(vr(ie)!=="array")return[new fi(de,ie,`array expected, ${vr(ie)} found`)];if(ie.length!==2)return[new fi(de,ie,`array length 2 expected, length ${ie.length} found`)];if(k){if(vr(ie[0])!=="object")return[new fi(de,ie,`object expected, ${vr(ie[0])} found`)];if(ie[0].zoom===void 0)return[new fi(de,ie,"object stop key must have zoom")];if(ie[0].value===void 0)return[new fi(de,ie,"object stop key must have value")];const Ee=Nn(ie[0].zoom);if(typeof Ee!="number")return[new fi(de,ie[0].zoom,"stop zoom values must be numbers")];if(m&&m>Ee)return[new fi(de,ie[0].zoom,"stop zoom values must appear in ascending order")];Ee!==m&&(m=Ee,h=void 0,y={}),Y=Y.concat(io({key:`${de}[0]`,value:ie[0],valueSpec:{zoom:{}},style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:lc,value:G}}))}else Y=Y.concat(G({key:`${de}[0]`,value:ie[0],style:X.style,styleSpec:X.styleSpec},ie));return Ar(es(ie[1]))?Y.concat([new fi(`${de}[1]`,ie[1],"expressions are not allowed in function stops.")]):Y.concat(gs({key:`${de}[1]`,value:ie[1],valueSpec:e,style:X.style,styleSpec:X.styleSpec}))}function G(X,Y){const ie=vr(X.value),de=Nn(X.value),Ee=X.value!==null?X.value:Y;if(a){if(ie!==a)return[new fi(X.key,Ee,`${ie} stop domain type must match previous stop domain type ${a}`)]}else a=ie;if(ie!=="number"&&ie!=="string"&&ie!=="boolean"&&typeof de!="number"&&typeof de!="string"&&typeof de!="boolean")return[new fi(X.key,Ee,"stop domain value must be a number, string, or boolean")];if(ie!=="number"&&r!=="categorical"){let Re=`number expected, ${ie} found`;return rc(e)&&r===void 0&&(Re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new fi(X.key,Ee,Re)]}return r!=="categorical"||ie!=="number"||typeof de=="number"&&isFinite(de)&&Math.floor(de)===de?r!=="categorical"&&ie==="number"&&typeof de=="number"&&typeof h=="number"&&h!==void 0&&de<h?[new fi(X.key,Ee,"stop domain values must appear in ascending order")]:(h=de,r==="categorical"&&de in y?[new fi(X.key,Ee,"stop domain values must be unique")]:(y[de]=!0,[])):[new fi(X.key,Ee,`integer expected, found ${String(de)}`)]}}function rs(i){const e=(i.expressionContext==="property"?$a:ac)(es(i.value),i.valueSpec);if(e.result==="error")return e.value.map(a=>new fi(`${i.key}${a.key}`,i.value,a.message));const r=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new fi(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!To(r))return[new fi(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return Wa(r,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!ul(r,["zoom","feature-state"]))return[new fi(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!hl(r))return[new fi(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wa(i,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)r.delete(h);if(r.size===0)return[];const a=[];return i instanceof qo&&r.has(i.name)?[new fi(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(h=>{a.push(...Wa(h,e))}),a)}function rr(i){const e=i.key,r=i.value,a=i.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(Nn(r))===-1&&h.push(new fi(e,r,`expected one of [${a.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(a.values).indexOf(Nn(r))===-1&&h.push(new fi(e,r,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function cc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!cc(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function nu(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};cc(i)||(i=hc(i));const r=i;let a=!0;try{a=function(k){if(!xl(k))return k;let B=es(k);return su(B),B=Zf(B),B}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const h=wt[`filter_${e}`],m=ac(a,h);let y=null;if(m.result==="error")throw new Error(m.value.map(k=>`${k.key}: ${k.message}`).join(", "));y=(k,B,U)=>m.value.evaluate(k,B,{},U);let w=null,M=null;if(a!==r){const k=ac(r,h);if(k.result==="error")throw new Error(k.value.map(B=>`${B.key}: ${B.message}`).join(", "));w=(B,U,G,X,Y)=>k.value.evaluate(B,U,{},G,void 0,void 0,X,Y),M=!hl(k.value.expression)}return{filter:y,dynamicFilter:w||void 0,needGeometry:Yf(a),needFeature:!!M}}function Zf(i){if(!Array.isArray(i))return i;const e=function(r){if(Ha.has(r[0])){for(let a=1;a<r.length;a++)if(xl(r[a]))return!0}return r}(i);return e===!0?e:e.map(r=>Zf(r))}function su(i){let e=!1;const r=[];if(i[0]==="case"){for(let a=1;a<i.length-1;a+=2)e=e||xl(i[a]),r.push(i[a+1]);r.push(i[i.length-1])}else if(i[0]==="match"){e=e||xl(i[1]);for(let a=2;a<i.length-1;a+=2)r.push(i[a+1]);r.push(i[i.length-1])}else if(i[0]==="step"){e=e||xl(i[1]);for(let a=1;a<i.length-1;a+=2)r.push(i[a+1])}e&&(i.length=0,i.push("any",...r));for(let a=1;a<i.length;a++)su(i[a])}function xl(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let r=1;r<i.length;r++)if(xl(i[r]))return!0;return!1}const Ha=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function km(i,e){return i<e?-1:i>e?1:0}function Yf(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Yf(i[e]))return!0;return!1}function hc(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?uc(i[1],i[2],"=="):e==="!="?au(uc(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?uc(i[1],i[2],e):e==="any"?(r=i.slice(1),["any"].concat(r.map(hc))):e==="all"?["all"].concat(i.slice(1).map(hc)):e==="none"?["all"].concat(i.slice(1).map(hc).map(au)):e==="in"?Ed(i[1],i.slice(2)):e==="!in"?au(Ed(i[1],i.slice(2))):e==="has"?ou(i[1]):e==="!has"?au(ou(i[1])):e!=="within"||i;var r}function uc(i,e,r){switch(i){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,i,e]}}function Ed(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",i,["literal",e.sort(km)]]:["filter-in-small",i,["literal",e]]}}function ou(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function au(i){return["!",i]}function nh(i){return cc(es(i.value))?rs($o({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):sh(i)}function sh(i){const e=i.value,r=i.key;if(vr(e)!=="array")return[new fi(r,e,`array expected, ${vr(e)} found`)];const a=i.styleSpec;let h,m=[];if(e.length<1)return[new fi(r,e,"filter array must have at least 1 element")];switch(m=m.concat(rr({key:`${r}[0]`,value:e[0],valueSpec:a.filter_operator,style:i.style,styleSpec:i.styleSpec})),Nn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Nn(e[1])==="$type"&&m.push(new fi(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new fi(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=vr(e[1]),h!=="string"&&m.push(new fi(`${r}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=vr(e[y]),Nn(e[1])==="$type"?m=m.concat(rr({key:`${r}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new fi(`${r}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(sh({key:`${r}[${y}]`,value:e[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=vr(e[1]),e.length!==2?m.push(new fi(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new fi(`${r}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=vr(e[1]),e.length!==2?m.push(new fi(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&m.push(new fi(`${r}[1]`,e[1],`object expected, ${h} found`))}return m}function Sd(i,e){const r=i.key,a=i.style,h=i.styleSpec,m=i.value,y=i.objectKey,w=h[`${e}_${i.layerType}`];if(!w)return[];const M=y.match(/^(.*)-transition$/);if(e==="paint"&&M&&w[M[1]]&&w[M[1]].transition)return gs({key:r,value:m,valueSpec:h.transition,style:a,styleSpec:h});const k=i.valueSpec||w[y];if(!k)return[new fi(r,m,`unknown property "${y}"`)];let B;if(vr(m)==="string"&&rc(k)&&!k.tokens&&(B=/^{([^}]+)}$/.exec(m))){const G=`\`{ "type": "identity", "property": ${B?JSON.stringify(B[1]):'"_"'} }\``;return[new fi(r,m,`"${y}" does not support interpolation syntax
Use an identity property function instead: ${G}.`)]}const U=[];return i.layerType==="symbol"&&(y==="text-field"&&a&&!a.glyphs&&U.push(new fi(r,m,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&nc(es(m))&&Nn(m.type)==="identity"&&U.push(new fi(r,m,'"text-font" does not support identity functions'))),U.concat(gs({key:i.key,value:m,valueSpec:k,style:a,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:y}))}function Kf(i){return Sd(i,"paint")}function lu(i){return Sd(i,"layout")}function Jf(i){let e=[];const r=i.value,a=i.key,h=i.style,m=i.styleSpec;r.type||r.ref||e.push(new fi(a,r,'either "type" or "ref" is required'));let y=Nn(r.type);const w=Nn(r.ref);if(r.id){const M=Nn(r.id);for(let k=0;k<i.arrayIndex;k++){const B=h.layers[k];Nn(B.id)===M&&e.push(new fi(a,r.id,`duplicate layer id "${r.id}", previously used at line ${B.id.__line__}`))}}if("ref"in r){let M;["type","source","source-layer","filter","layout"].forEach(k=>{k in r&&e.push(new fi(a,r[k],`"${k}" is prohibited for ref layers`))}),h.layers.forEach(k=>{Nn(k.id)===w&&(M=k)}),M?M.ref?e.push(new fi(a,r.ref,"ref cannot reference another ref layer")):y=Nn(M.type):typeof w=="string"&&e.push(new fi(a,r.ref,`ref layer "${w}" not found`))}else if(y!=="background"&&y!=="sky")if(r.source){const M=h.sources&&h.sources[r.source],k=M&&Nn(M.type);M?k==="vector"&&y==="raster"?e.push(new fi(a,r.source,`layer "${r.id}" requires a raster source`)):k==="raster"&&y!=="raster"?e.push(new fi(a,r.source,`layer "${r.id}" requires a vector source`)):k!=="vector"||r["source-layer"]?k==="raster-dem"&&y!=="hillshade"?e.push(new fi(a,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||k==="geojson"&&M.lineMetrics||e.push(new fi(a,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new fi(a,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new fi(a,r.source,`source "${r.source}" not found`))}else e.push(new fi(a,r,'missing required property "source"'));return e=e.concat(io({key:a,value:r,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gs({key:`${a}.type`,value:r.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:M=>nh($o({layerType:y},M)),layout:M=>io({layer:r,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":k=>lu($o({layerType:y},k))}}),paint:M=>io({layer:r,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":k=>Kf($o({layerType:y},k))}})}})),e}function qa(i){const e=i.value,r=i.key,a=vr(e);return a!=="string"?[new fi(r,e,`string expected, ${a} found`)]:[]}const Cd={promoteId:function({key:i,value:e}){if(vr(e)==="string")return qa({key:i,value:e});{const r=[];for(const a in e)r.push(...qa({key:`${i}.${a}`,value:e[a]}));return r}}};function Ad(i){const e=i.value,r=i.key,a=i.styleSpec,h=i.style;if(!e.type)return[new fi(r,e,'"type" is required')];const m=Nn(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=io({key:r,value:e,valueSpec:a[`source_${m.replace("-","_")}`],style:i.style,styleSpec:a,objectElementValidators:Cd}),y;case"geojson":if(y=io({key:r,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,objectElementValidators:Cd}),e.cluster)for(const w in e.clusterProperties){const[M,k]=e.clusterProperties[w],B=typeof M=="string"?[M,["accumulated"],["get",w]]:M;y.push(...rs({key:`${r}.${w}.map`,value:k,expressionContext:"cluster-map"})),y.push(...rs({key:`${r}.${w}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return y;case"video":return io({key:r,value:e,valueSpec:a.source_video,style:h,styleSpec:a});case"image":return io({key:r,value:e,valueSpec:a.source_image,style:h,styleSpec:a});case"canvas":return[new fi(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return rr({key:`${r}.type`,value:e.type,valueSpec:{values:Zo(a)}})}}function Zo(i){return i.source.reduce((e,r)=>{const a=i[r];return a.type.type==="enum"&&(e=e.concat(Object.keys(a.type.values))),e},[])}function Qf(i){const e=i.value,r=i.styleSpec,a=r.light,h=i.style;let m=[];const y=vr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new fi("light",e,`object expected, ${y} found`)]),m;for(const w in e){const M=w.match(/^(.*)-transition$/);m=m.concat(M&&a[M[1]]&&a[M[1]].transition?gs({key:w,value:e[w],valueSpec:r.transition,style:h,styleSpec:r}):a[w]?gs({key:w,value:e[w],valueSpec:a[w],style:h,styleSpec:r}):[new fi(w,e[w],`unknown property "${w}"`)])}return m}function Md(i){const e=i.value,r=i.key,a=i.style,h=i.styleSpec,m=h.terrain;let y=[];const w=vr(e);if(e===void 0)return y;if(w!=="object")return y=y.concat([new fi("terrain",e,`object expected, ${w} found`)]),y;for(const M in e){const k=M.match(/^(.*)-transition$/);y=y.concat(k&&m[k[1]]&&m[k[1]].transition?gs({key:M,value:e[M],valueSpec:h.transition,style:a,styleSpec:h}):m[M]?gs({key:M,value:e[M],valueSpec:m[M],style:a,styleSpec:h}):[new fi(M,e[M],`unknown property "${M}"`)])}if(e.source){const M=a.sources&&a.sources[e.source],k=M&&Nn(M.type);M?k!=="raster-dem"&&y.push(new fi(r,e.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):y.push(new fi(r,e.source,`source "${e.source}" not found`))}else y.push(new fi(r,e,'terrain is missing required property "source"'));return y}function ep(i){const e=i.value,r=i.style,a=i.styleSpec,h=a.fog;let m=[];const y=vr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new fi("fog",e,`object expected, ${y} found`)]),m;for(const w in e){const M=w.match(/^(.*)-transition$/);m=m.concat(M&&h[M[1]]&&h[M[1]].transition?gs({key:w,value:e[w],valueSpec:a.transition,style:r,styleSpec:a}):h[w]?gs({key:w,value:e[w],valueSpec:h[w],style:r,styleSpec:a}):[new fi(w,e[w],`unknown property "${w}"`)])}return m}const Id={"*":()=>[],array:Fi,boolean:function(i){const e=i.value,r=i.key,a=vr(e);return a!=="boolean"?[new fi(r,e,`boolean expected, ${a} found`)]:[]},number:lc,color:function(i){const e=i.key,r=i.value,a=vr(r);return a!=="string"?[new fi(e,r,`color expected, ${a} found`)]:nd(r)===null?[new fi(e,r,`color expected, "${r}" found`)]:[]},enum:rr,filter:nh,function:Ga,layer:Jf,object:io,source:Ad,light:Qf,terrain:Md,fog:ep,string:qa,formatted:function(i){return qa(i).length===0?[]:rs(i)},resolvedImage:function(i){return qa(i).length===0?[]:rs(i)},projection:function(i){const e=i.value,r=i.styleSpec,a=r.projection,h=i.style;let m=[];const y=vr(e);if(y==="object")for(const w in e)m=m.concat(gs({key:w,value:e[w],valueSpec:a[w],style:h,styleSpec:r}));else y!=="string"&&(m=m.concat([new fi("projection",e,`object or string expected, ${y} found`)]));return m}};function gs(i){const e=i.value,r=i.valueSpec,a=i.styleSpec;return r.expression&&nc(Nn(e))?Ga(i):r.expression&&Ar(es(e))?rs(i):r.type&&Id[r.type]?Id[r.type](i):io($o({},i,{valueSpec:r.type?a[r.type]:r}))}function Pm(i){const e=i.value,r=i.key,a=qa(i);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new fi(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new fi(r,e,'"glyphs" url must include a "{range}" token'))),a}function oh(i,e=wt){return ro(gs({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:Pm,"*":()=>[]}}))}const Lm=i=>ro(Kf(i)),tp=i=>ro(lu(i));function ro(i){return i.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function ip(i,e){let r=!1;if(e&&e.length)for(const a of e)i.fire(new fa(new Error(a.message))),r=!0;return r}var rp=Yo,Co=3;function Yo(i,e,r){var a=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var h=new Int32Array(this.arrayBuffer);i=h[0],this.d=(e=h[1])+2*(r=h[2]);for(var m=0;m<this.d*this.d;m++){var y=h[Co+m],w=h[Co+m+1];a.push(y===w?null:h.subarray(y,w))}var M=h[Co+a.length+1];this.keys=h.subarray(h[Co+a.length],M),this.bboxes=h.subarray(M),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var k=0;k<this.d*this.d;k++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=r,this.scale=e/i,this.uid=0;var B=r/e*i;this.min=-B,this.max=i+B}Yo.prototype.insert=function(i,e,r,a,h){this._forEachCell(e,r,a,h,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(h)},Yo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Yo.prototype._insertCell=function(i,e,r,a,h,m){this.cells[h].push(m)},Yo.prototype.query=function(i,e,r,a,h){var m=this.min,y=this.max;if(i<=m&&e<=m&&y<=r&&y<=a&&!h)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(i,e,r,a,this._queryCell,w,{},h),w},Yo.prototype._queryCell=function(i,e,r,a,h,m,y,w){var M=this.cells[h];if(M!==null)for(var k=this.keys,B=this.bboxes,U=0;U<M.length;U++){var G=M[U];if(y[G]===void 0){var X=4*G;(w?w(B[X+0],B[X+1],B[X+2],B[X+3]):i<=B[X+2]&&e<=B[X+3]&&r>=B[X+0]&&a>=B[X+1])?(y[G]=!0,m.push(k[G])):y[G]=!1}}},Yo.prototype._forEachCell=function(i,e,r,a,h,m,y,w){for(var M=this._convertToCellCoord(i),k=this._convertToCellCoord(e),B=this._convertToCellCoord(r),U=this._convertToCellCoord(a),G=M;G<=B;G++)for(var X=k;X<=U;X++){var Y=this.d*X+G;if((!w||w(this._convertFromCellCoord(G),this._convertFromCellCoord(X),this._convertFromCellCoord(G+1),this._convertFromCellCoord(X+1)))&&h.call(this,i,e,r,a,Y,m,y,w))return}},Yo.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Yo.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Yo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=Co+this.cells.length+1+1,r=0,a=0;a<this.cells.length;a++)r+=this.cells[a].length;var h=new Int32Array(e+r+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var m=e,y=0;y<i.length;y++){var w=i[y];h[Co+y]=m,h.set(w,m),m+=w.length}return h[Co+i.length]=m,h.set(this.keys,m),h[Co+i.length+1]=m+=this.keys.length,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer};var vl=ge(rp);const Ta={};function yi(i,e,r={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writeable:!1}),Ta[e]={klass:i,omit:r.omit||[]}}yi(Object,"Object"),vl.serialize=function(i,e){const r=i.toArrayBuffer();return e&&e.push(r),{buffer:r}},vl.deserialize=function(i){return new vl(i.buffer)},Object.defineProperty(vl,"name",{value:"Grid"}),yi(vl,"Grid"),yi(An,"Color"),yi(Error,"Error"),yi(yo,"AJAXError"),yi(Es,"ResolvedImage"),yi(Zr,"StylePropertyFunction"),yi(ms,"StyleExpression",{omit:["_evaluator"]}),yi(yl,"ZoomDependentExpression"),yi(ru,"ZoomConstantExpression"),yi(qo,"CompoundExpression",{omit:["_evaluate"]});for(const i in eh)Ta[eh[i]._classRegistryKey]||yi(eh[i],`Expression${i}`);function kd(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Pd(i){return $.ImageBitmap&&i instanceof $.ImageBitmap}function bl(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(kd(i)||Pd(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return e&&e.push(r.buffer),r}if(i instanceof $.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const a of i)r.push(bl(a,e));return r}if(typeof i=="object"){const r=i.constructor,a=r._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const h=r.serialize?r.serialize(i,e):{};if(!r.serialize){for(const m in i)i.hasOwnProperty(m)&&(Ta[a].omit.indexOf(m)>=0||(h[m]=bl(i[m],e)));i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof i)}function Xa(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||kd(i)||Pd(i)||ArrayBuffer.isView(i)||i instanceof $.ImageData)return i;if(Array.isArray(i))return i.map(Xa);if(typeof i=="object"){const e=i.$name||"Object",{klass:r}=Ta[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(i);const a=Object.create(r.prototype);for(const h of Object.keys(i))h!=="$name"&&(a[h]=Xa(i[h]));return a}throw new Error("can't deserialize object of type "+typeof i)}const li={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Ld(i){for(const e of i)if(Dd(e.charCodeAt(0)))return!0;return!1}function Dm(i){for(const e of i)if(!cu(e.charCodeAt(0)))return!1;return!0}function cu(i){return!(li.Arabic(i)||li["Arabic Supplement"](i)||li["Arabic Extended-A"](i)||li["Arabic Presentation Forms-A"](i)||li["Arabic Presentation Forms-B"](i))}function Dd(i){return!(i!==746&&i!==747&&(i<4352||!(li["Bopomofo Extended"](i)||li.Bopomofo(i)||li["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||li["CJK Compatibility Ideographs"](i)||li["CJK Compatibility"](i)||li["CJK Radicals Supplement"](i)||li["CJK Strokes"](i)||!(!li["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||li["CJK Unified Ideographs Extension A"](i)||li["CJK Unified Ideographs"](i)||li["Enclosed CJK Letters and Months"](i)||li["Hangul Compatibility Jamo"](i)||li["Hangul Jamo Extended-A"](i)||li["Hangul Jamo Extended-B"](i)||li["Hangul Jamo"](i)||li["Hangul Syllables"](i)||li.Hiragana(i)||li["Ideographic Description Characters"](i)||li.Kanbun(i)||li["Kangxi Radicals"](i)||li["Katakana Phonetic Extensions"](i)||li.Katakana(i)&&i!==12540||!(!li["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!li["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||li["Unified Canadian Aboriginal Syllabics"](i)||li["Unified Canadian Aboriginal Syllabics Extended"](i)||li["Vertical Forms"](i)||li["Yijing Hexagram Symbols"](i)||li["Yi Syllables"](i)||li["Yi Radicals"](i))))}function wl(i){return!(Dd(i)||function(e){return!!(li["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||li["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||li["Letterlike Symbols"](e)||li["Number Forms"](e)||li["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||li["Control Pictures"](e)&&e!==9251||li["Optical Character Recognition"](e)||li["Enclosed Alphanumerics"](e)||li["Geometric Shapes"](e)||li["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||li["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||li["CJK Symbols and Punctuation"](e)||li.Katakana(e)||li["Private Use Area"](e)||li["CJK Compatibility Forms"](e)||li["Small Form Variants"](e)||li["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function np(i){return i>=1424&&i<=2303||li["Arabic Presentation Forms-A"](i)||li["Arabic Presentation Forms-B"](i)}function Od(i,e){return!(!e&&np(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||li.Khmer(i))}function Om(i){for(const e of i)if(np(e.charCodeAt(0)))return!0;return!1}const ah="deferred",hu="loading",Rd="loaded";let dc=null,f="unavailable",n=null;const c=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(f="error"),dc&&dc(i)};function g(){b.fire(new jo("pluginStateChange",{pluginStatus:f,pluginURL:n}))}const b=new jr,E=function(){return f},L=function(){if(f!==ah||!n)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");f=hu,g(),n&&os({url:n},i=>{i?c(i):(f=Rd,g())})},D={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>f===Rd||D.applyArabicShaping!=null,isLoading:()=>f===hu,setState(i){f=i.pluginStatus,n=i.pluginURL},isParsed:()=>D.applyArabicShaping!=null&&D.processBidirectionalText!=null&&D.processStyledBidirectionalText!=null,getPluginURL:()=>n};class F{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,a){for(const h of r)if(!Od(h.charCodeAt(0),a))return!1;return!0}(e,D.isLoaded())}}class W{constructor(e,r){this.property=e,this.value=r,this.expression=function(a,h){if(nc(a))return new Zr(a,h);if(Ar(a)){const m=$a(a,h);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=a;return typeof a=="string"&&h.type==="color"&&(m=An.parse(a)),{kind:"constant",evaluate:()=>m}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,a){return this.property.possiblyEvaluate(this,e,r,a)}}class H{constructor(e){this.property=e,this.value=new W(e,void 0)}transitioned(e,r){return new he(this.property,this.value,r,fr({},e.transition,this.transition),e.now)}untransitioned(){return new he(this.property,this.value,null,{},0)}}class Q{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ve(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new H(this._values[e].property)),this._values[e].value=new W(this._values[e].property,r===null?void 0:ve(r))}getTransition(e){return ve(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new H(this._values[e].property)),this._values[e].transition=ve(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a);const h=this.getTransition(r);h!==void 0&&(e[`${r}-transition`]=h)}return e}transitioned(e,r){const a=new me(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,r._values[h]);return a}untransitioned(){const e=new me(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class he{constructor(e,r,a,h,m){const y=h.delay||0,w=h.duration||0;m=m||0,this.property=e,this.value=r,this.begin=m+y,this.end=this.begin+w,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,r,a){const h=e.now||0,m=this.value.possiblyEvaluate(e,r,a),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(e,r,a);{const w=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,r,a),m,vt(w))}}return m}}class me{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,a){const h=new be(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,r,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ye{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ve(this._values[e].value)}setValue(e,r){this._values[e]=new W(this._values[e].property,r===null?void 0:ve(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a)}return e}possiblyEvaluate(e,r,a){const h=new be(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,r,a);return h}}class _e{constructor(e,r,a){this.property=e,this.value=r,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,a,h){return this.property.evaluate(this.value,this.parameters,e,r,a,h)}}class be{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ee{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,a){const h=Xo[this.specification.type];return h?h(e,r,a):e}}class pe{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,a,h){return new _e(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},a,h)}:e.expression,r)}interpolate(e,r,a){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new _e(this,{kind:"constant",value:void 0},e.parameters);const h=Xo[this.specification.type];return h?new _e(this,{kind:"constant",value:h(e.value.value,r.value.value,a)},e.parameters):e}evaluate(e,r,a,h,m,y){return e.kind==="constant"?e.value:e.evaluate(r,a,h,m,y)}}class Ce{constructor(e){this.specification=e}possiblyEvaluate(e,r,a,h){return!!e.expression.evaluate(r,null,{},a,h)}interpolate(){return!1}}class Ie{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new F(0,{});for(const a in e){const h=e[a];h.specification.overridable&&this.overridableProperties.push(a);const m=this.defaultPropertyValues[a]=new W(h,void 0),y=this.defaultTransitionablePropertyValues[a]=new H(h);this.defaultTransitioningPropertyValues[a]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=m.possiblyEvaluate(r)}}}function Ge(i,e){return 256*(i=vi(Math.floor(i),0,255))+vi(Math.floor(e),0,255)}yi(pe,"DataDrivenProperty"),yi(ee,"DataConstantProperty"),yi(Ce,"ColorRampProperty");const Fe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class We{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class it{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function et(i,e=1){let r=0,a=0;return{members:i.map(h=>{const m=Fe[h.type].BYTES_PER_ELEMENT,y=r=pt(r,Math.max(e,m)),w=h.components||1;return a=Math.max(a,m),r+=m*w,{name:h.name,type:h.type,components:w,offset:y}}),size:pt(r,Math.max(a,e)),alignment:e}}function pt(i,e){return Math.ceil(i/e)*e}class Nt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.int16[h+0]=r,this.int16[h+1]=a,e}}Nt.prototype.bytesPerElement=4,yi(Nt,"StructArrayLayout2i4");class ht extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const m=3*e;return this.int16[m+0]=r,this.int16[m+1]=a,this.int16[m+2]=h,e}}ht.prototype.bytesPerElement=6,yi(ht,"StructArrayLayout3i6");class Ct extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=4*e;return this.int16[y+0]=r,this.int16[y+1]=a,this.int16[y+2]=h,this.int16[y+3]=m,e}}Ct.prototype.bytesPerElement=8,yi(Ct,"StructArrayLayout4i8");class yt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,a,h,m,y,w)}emplace(e,r,a,h,m,y,w,M){const k=6*e,B=12*e,U=3*e;return this.int16[k+0]=r,this.int16[k+1]=a,this.uint8[B+4]=h,this.uint8[B+5]=m,this.uint8[B+6]=y,this.uint8[B+7]=w,this.float32[U+2]=M,e}}yt.prototype.bytesPerElement=12,yi(yt,"StructArrayLayout2i4ub1f12");class jt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=4*e;return this.float32[y+0]=r,this.float32[y+1]=a,this.float32[y+2]=h,this.float32[y+3]=m,e}}jt.prototype.bytesPerElement=16,yi(jt,"StructArrayLayout4f16");class at extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,a,h,m)}emplace(e,r,a,h,m,y){const w=6*e,M=3*e;return this.uint16[w+0]=r,this.uint16[w+1]=a,this.uint16[w+2]=h,this.uint16[w+3]=m,this.float32[M+2]=y,e}}at.prototype.bytesPerElement=12,yi(at,"StructArrayLayout4ui1f12");class Mt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=4*e;return this.uint16[y+0]=r,this.uint16[y+1]=a,this.uint16[y+2]=h,this.uint16[y+3]=m,e}}Mt.prototype.bytesPerElement=8,yi(Mt,"StructArrayLayout4ui8");class Gt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,a,h,m,y)}emplace(e,r,a,h,m,y,w){const M=6*e;return this.int16[M+0]=r,this.int16[M+1]=a,this.int16[M+2]=h,this.int16[M+3]=m,this.int16[M+4]=y,this.int16[M+5]=w,e}}Gt.prototype.bytesPerElement=12,yi(Gt,"StructArrayLayout6i12");class Et extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G){const X=this.length;return this.resize(X+1),this.emplace(X,e,r,a,h,m,y,w,M,k,B,U,G)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X){const Y=12*e;return this.int16[Y+0]=r,this.int16[Y+1]=a,this.int16[Y+2]=h,this.int16[Y+3]=m,this.uint16[Y+4]=y,this.uint16[Y+5]=w,this.uint16[Y+6]=M,this.uint16[Y+7]=k,this.int16[Y+8]=B,this.int16[Y+9]=U,this.int16[Y+10]=G,this.int16[Y+11]=X,e}}Et.prototype.bytesPerElement=24,yi(Et,"StructArrayLayout4i4ui4i24");class Xt extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,a,h,m,y)}emplace(e,r,a,h,m,y,w){const M=10*e,k=5*e;return this.int16[M+0]=r,this.int16[M+1]=a,this.int16[M+2]=h,this.float32[k+2]=m,this.float32[k+3]=y,this.float32[k+4]=w,e}}Xt.prototype.bytesPerElement=20,yi(Xt,"StructArrayLayout3i3f20");class ki extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}ki.prototype.bytesPerElement=4,yi(ki,"StructArrayLayout1ul4");class Ni extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G,X){const Y=this.length;return this.resize(Y+1),this.emplace(Y,e,r,a,h,m,y,w,M,k,B,U,G,X)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X,Y){const ie=20*e,de=10*e;return this.int16[ie+0]=r,this.int16[ie+1]=a,this.int16[ie+2]=h,this.int16[ie+3]=m,this.int16[ie+4]=y,this.float32[de+3]=w,this.float32[de+4]=M,this.float32[de+5]=k,this.float32[de+6]=B,this.int16[ie+14]=U,this.uint32[de+8]=G,this.uint16[ie+18]=X,this.uint16[ie+19]=Y,e}}Ni.prototype.bytesPerElement=40,yi(Ni,"StructArrayLayout5i4f1i1ul2ui40");class bi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,a,h,m,y,w)}emplace(e,r,a,h,m,y,w,M){const k=8*e;return this.int16[k+0]=r,this.int16[k+1]=a,this.int16[k+2]=h,this.int16[k+4]=m,this.int16[k+5]=y,this.int16[k+6]=w,this.int16[k+7]=M,e}}bi.prototype.bytesPerElement=16,yi(bi,"StructArrayLayout3i2i2i16");class Li extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,a,h,m)}emplace(e,r,a,h,m,y){const w=4*e,M=8*e;return this.float32[w+0]=r,this.float32[w+1]=a,this.float32[w+2]=h,this.int16[M+6]=m,this.int16[M+7]=y,e}}Li.prototype.bytesPerElement=16,yi(Li,"StructArrayLayout2f1f2i16");class Wi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=12*e,w=3*e;return this.uint8[y+0]=r,this.uint8[y+1]=a,this.float32[w+1]=h,this.float32[w+2]=m,e}}Wi.prototype.bytesPerElement=12,yi(Wi,"StructArrayLayout2ub2f12");class Hi extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const m=3*e;return this.float32[m+0]=r,this.float32[m+1]=a,this.float32[m+2]=h,e}}Hi.prototype.bytesPerElement=12,yi(Hi,"StructArrayLayout3f12");class Ai extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const m=3*e;return this.uint16[m+0]=r,this.uint16[m+1]=a,this.uint16[m+2]=h,e}}Ai.prototype.bytesPerElement=6,yi(Ai,"StructArrayLayout3ui6");class Mr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ue){const Be=this.length;return this.resize(Be+1),this.emplace(Be,e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ue)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ue,Be){const _t=30*e,ft=15*e,St=60*e;return this.int16[_t+0]=r,this.int16[_t+1]=a,this.int16[_t+2]=h,this.float32[ft+2]=m,this.float32[ft+3]=y,this.uint16[_t+8]=w,this.uint16[_t+9]=M,this.uint32[ft+5]=k,this.uint32[ft+6]=B,this.uint32[ft+7]=U,this.uint16[_t+16]=G,this.uint16[_t+17]=X,this.uint16[_t+18]=Y,this.float32[ft+10]=ie,this.float32[ft+11]=de,this.uint8[St+48]=Ee,this.uint8[St+49]=Re,this.uint8[St+50]=Se,this.uint32[ft+13]=De,this.int16[_t+28]=Ue,this.uint8[St+58]=Be,e}}Mr.prototype.bytesPerElement=60,yi(Mr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Dr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ue,Be,_t,ft,St,Zt,xt,Ot,Rt,Ut){const ei=this.length;return this.resize(ei+1),this.emplace(ei,e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ue,Be,_t,ft,St,Zt,xt,Ot,Rt,Ut)}emplace(e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de,Ee,Re,Se,De,Ue,Be,_t,ft,St,Zt,xt,Ot,Rt,Ut,ei){const Tt=38*e,ai=19*e;return this.int16[Tt+0]=r,this.int16[Tt+1]=a,this.int16[Tt+2]=h,this.float32[ai+2]=m,this.float32[ai+3]=y,this.int16[Tt+8]=w,this.int16[Tt+9]=M,this.int16[Tt+10]=k,this.int16[Tt+11]=B,this.int16[Tt+12]=U,this.int16[Tt+13]=G,this.uint16[Tt+14]=X,this.uint16[Tt+15]=Y,this.uint16[Tt+16]=ie,this.uint16[Tt+17]=de,this.uint16[Tt+18]=Ee,this.uint16[Tt+19]=Re,this.uint16[Tt+20]=Se,this.uint16[Tt+21]=De,this.uint16[Tt+22]=Ue,this.uint16[Tt+23]=Be,this.uint16[Tt+24]=_t,this.uint16[Tt+25]=ft,this.uint16[Tt+26]=St,this.uint16[Tt+27]=Zt,this.uint16[Tt+28]=xt,this.uint32[ai+15]=Ot,this.float32[ai+16]=Rt,this.float32[ai+17]=Ut,this.float32[ai+18]=ei,e}}Dr.prototype.bytesPerElement=76,yi(Dr,"StructArrayLayout3i2f6i15ui1ul3f76");class Or extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}Or.prototype.bytesPerElement=4,yi(Or,"StructArrayLayout1f4");class Rr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,a,h,m)}emplace(e,r,a,h,m,y){const w=5*e;return this.float32[w+0]=r,this.float32[w+1]=a,this.float32[w+2]=h,this.float32[w+3]=m,this.float32[w+4]=y,e}}Rr.prototype.bytesPerElement=20,yi(Rr,"StructArrayLayout5f20");class _s extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,h)}emplace(e,r,a,h,m){const y=6*e;return this.uint32[3*e+0]=r,this.uint16[y+2]=a,this.uint16[y+3]=h,this.uint16[y+4]=m,e}}_s.prototype.bytesPerElement=12,yi(_s,"StructArrayLayout1ul3ui12");class ns extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.uint16[h+0]=r,this.uint16[h+1]=a,e}}ns.prototype.bytesPerElement=4,yi(ns,"StructArrayLayout2ui4");class no extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}no.prototype.bytesPerElement=2,yi(no,"StructArrayLayout1ui2");class Pr extends it{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.float32[h+0]=r,this.float32[h+1]=a,e}}Pr.prototype.bytesPerElement=8,yi(Pr,"StructArrayLayout2f8");class Yr extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Yr.prototype.size=40;class Vr extends Ni{get(e){return new Yr(this,e)}}yi(Vr,"CollisionBoxArray");class gr extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}gr.prototype.size=60;class Un extends Mr{get(e){return new gr(this,e)}}yi(Un,"PlacedSymbolArray");class Ss extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ss.prototype.size=76;class Kr extends Dr{get(e){return new Ss(this,e)}}yi(Kr,"SymbolInstanceArray");class qn extends Or{getoffsetX(e){return this.float32[1*e+0]}}yi(qn,"GlyphOffsetArray");class uu extends Nt{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}yi(uu,"SymbolLineVertexArray");class Ea extends We{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ea.prototype.size=12;class fc extends _s{get(e){return new Ea(this,e)}}yi(fc,"FeatureIndexArray");class Ko extends ns{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}yi(Ko,"FillExtrusionCentroidArray");const Sa=et([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Tl=et([{name:"a_dash",components:4,type:"Uint16"}]);var wn={exports:{}},lh={exports:{}};lh.exports=function(i,e){var r,a,h,m,y,w,M,k;for(a=i.length-(r=3&i.length),h=e,y=3432918353,w=461845907,k=0;k<a;)M=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,h=27492+(65535&(m=5*(65535&(h=(h^=M=(65535&(M=(M=(65535&M)*y+(((M>>>16)*y&65535)<<16)&4294967295)<<15|M>>>17))*w+(((M>>>16)*w&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(M=0,r){case 3:M^=(255&i.charCodeAt(k+2))<<16;case 2:M^=(255&i.charCodeAt(k+1))<<8;case 1:h^=M=(65535&(M=(M=(65535&(M^=255&i.charCodeAt(k)))*y+(((M>>>16)*y&65535)<<16)&4294967295)<<15|M>>>17))*w+(((M>>>16)*w&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var zd=lh.exports,Rm={exports:{}};Rm.exports=function(i,e){for(var r,a=i.length,h=e^a,m=0;a>=4;)r=1540483477*(65535&(r=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(r>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:h^=(255&i.charCodeAt(m+2))<<16;case 2:h^=(255&i.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Bd=zd,du=Rm.exports;wn.exports=Bd,wn.exports.murmur3=Bd,wn.exports.murmur2=du;var zm=ge(wn.exports);class pn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,a,h){this.ids.push(__(e)),this.positions.push(r,a,h)}getPositions(e){const r=__(e);let a=0,h=this.ids.length-1;for(;a<h;){const y=a+h>>1;this.ids[y]>=r?h=y:a=y+1}const m=[];for(;this.ids[a]===r;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,r){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return sp(a,h,0,a.length-1),r&&r.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const r=new pn;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function __(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:zm(String(i))}function sp(i,e,r,a){for(;r<a;){const h=i[r+a>>1];let m=r-1,y=a+1;for(;;){do m++;while(i[m]<h);do y--;while(i[y]>h);if(m>=y)break;Fd(i,m,y),Fd(e,3*m,3*y),Fd(e,3*m+1,3*y+1),Fd(e,3*m+2,3*y+2)}y-r<a-y?(sp(i,e,r,y),r=y+1):(sp(i,e,y+1,a),a=y)}}function Fd(i,e,r){const a=i[e];i[e]=i[r],i[r]=a}yi(pn,"FeaturePositionMap");class Za{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}}class Hn extends Za{constructor(e){super(e),this.current=0}set(e,r,a){this.fetchUniformLocation(e,r)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class y_ extends Za{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,a){this.fetchUniformLocation(e,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class fu extends Za{constructor(e){super(e),this.current=An.transparent}set(e,r,a){this.fetchUniformLocation(e,r)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const Bm=new Float32Array(16),Mn=new Float32Array(9),qx=new Float32Array(4);function op(i){return[Ge(255*i.r,255*i.g),Ge(255*i.b,255*i.a)]}class Ws{constructor(e,r,a){this.value=e,this.uniformNames=r.map(h=>`u_${h}`),this.type=a}setUniform(e,r,a,h,m){r.set(e,m,h.constantOr(this.value))}getBinding(e,r){return this.type==="color"?new fu(e):new Hn(e)}}class ys{constructor(e,r){this.uniformNames=r.map(a=>`u_${a}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,a,h,m){const y=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;y&&r.set(e,m,y)}getBinding(e,r){return r==="u_pattern"||r==="u_dash"?new y_(e):new Hn(e)}}class El{constructor(e,r,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=r.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,r,a,h,m,y){const w=this.paintVertexArray.length,M=this.expression.evaluate(new F(0),r,{},m,h,y);this.paintVertexArray.resize(e),this._setPaintValue(w,e,M)}updatePaintArray(e,r,a,h,m){const y=this.expression.evaluate({zoom:0},a,h,void 0,m);this._setPaintValue(e,r,y)}_setPaintValue(e,r,a){if(this.type==="color"){const h=op(a);for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=e;h<r;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ca{constructor(e,r,a,h,m,y){this.expression=e,this.uniformNames=r.map(w=>`u_${w}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(w=>({name:`a_${w}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,r,a,h,m,y){const w=this.expression.evaluate(new F(this.zoom),r,{},m,h,y),M=this.expression.evaluate(new F(this.zoom+1),r,{},m,h,y),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,w,M)}updatePaintArray(e,r,a,h,m){const y=this.expression.evaluate({zoom:this.zoom},a,h,void 0,m),w=this.expression.evaluate({zoom:this.zoom+1},a,h,void 0,m);this._setPaintValue(e,r,y,w)}_setPaintValue(e,r,a,h){if(this.type==="color"){const m=op(a),y=op(h);for(let w=e;w<r;w++)this.paintVertexArray.emplace(w,m[0],m[1],y[0],y[1])}else{for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,a,h,m){const y=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,w=vi(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);r.set(e,m,w)}getBinding(e,r){return new Hn(e)}}class Sl{constructor(e,r,a,h,m){this.expression=e,this.layerId=m,this.paintVertexAttributes=(a==="array"?Tl:Sa).members;for(let y=0;y<r.length;++y);this.paintVertexArray=new h}populatePaintArray(e,r,a){const h=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(h,e,r.patterns&&r.patterns[this.layerId],a)}updatePaintArray(e,r,a,h,m,y){this._setPaintValues(e,r,a.patterns&&a.patterns[this.layerId],y)}_setPaintValues(e,r,a,h){if(!h||!a)return;const m=h[a];if(!m)return;const{tl:y,br:w,pixelRatio:M}=m;for(let k=e;k<r;k++)this.paintVertexArray.emplace(k,y[0],y[1],w[0],w[1],M)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pc{constructor(e,r,a=()=>!0){this.binders={},this._buffers=[];const h=[];for(const m in e.paint._values){if(!a(m))continue;const y=e.paint.get(m);if(!(y instanceof _e&&rc(y.property.specification)))continue;const w=Zx(m,e.type),M=y.value,k=y.property.specification.type,B=!!y.property.useIntegerZoom,U=m==="line-dasharray"||m.endsWith("pattern"),G=m==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(M.kind!=="constant"||G)if(M.kind==="source"||G||U){const X=x_(m,k,"source");this.binders[m]=U?new Sl(M,w,k,X,e.id):new El(M,w,k,X),h.push(`/a_${m}`)}else{const X=x_(m,k,"composite");this.binders[m]=new Ca(M,w,k,B,r,X),h.push(`/z_${m}`)}else this.binders[m]=U?new ys(M.value,w):new Ws(M.value,w,k),h.push(`/u_${m}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof El||r instanceof Ca?r.maxValue:0}populatePaintArrays(e,r,a,h,m,y){for(const w in this.binders){const M=this.binders[w];(M instanceof El||M instanceof Ca||M instanceof Sl)&&M.populatePaintArray(e,r,a,h,m,y)}}setConstantPatternPositions(e){for(const r in this.binders){const a=this.binders[r];a instanceof ys&&a.setConstantPatternPositions(e)}}updatePaintArrays(e,r,a,h,m,y){let w=!1;for(const M in e){const k=r.getPositions(M);for(const B of k){const U=a.feature(B.index);for(const G in this.binders){const X=this.binders[G];if((X instanceof El||X instanceof Ca||X instanceof Sl)&&X.expression.isStateDependent===!0){const Y=h.paint.get(G);X.expression=Y.value,X.updatePaintArray(B.start,B.end,U,e[M],m,y),w=!0}}}}return w}defines(){const e=[];for(const r in this.binders){const a=this.binders[r];(a instanceof Ws||a instanceof ys)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof El||a instanceof Ca||a instanceof Sl)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof Ws||a instanceof ys||a instanceof Ca)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const r=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Ws||h instanceof ys||h instanceof Ca)for(const m of h.uniformNames)r.push({name:m,property:a,binding:h.getBinding(e,m)})}return r}setUniforms(e,r,a,h,m){for(const{name:y,property:w,binding:M}of a)this.binders[w].setUniform(e,M,m,h.get(w),y)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const r=this.binders[e];(r instanceof El||r instanceof Ca||r instanceof Sl)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){const a=this.binders[r];(a instanceof El||a instanceof Ca||a instanceof Sl)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof El||r instanceof Ca||r instanceof Sl)&&r.destroy()}}}class mc{constructor(e,r,a=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new pc(h,r,a);this.needsUpload=!1,this._featureMap=new pn,this._bufferOffset=0}populatePaintArrays(e,r,a,h,m,y,w){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(e,r,h,m,y,w);r.id!==void 0&&this._featureMap.add(r.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,a,h,m){for(const y of a)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,r,y,h,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Xx={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Zx(i,e){return Xx[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const ap={"line-pattern":{source:at,composite:at},"fill-pattern":{source:at,composite:at},"fill-extrusion-pattern":{source:at,composite:at},"line-dasharray":{source:Mt,composite:Mt}},Yx={color:{source:Pr,composite:jt},number:{source:Or,composite:Pr}};function x_(i,e,r){const a=ap[i];return a&&a[r]||Yx[e][r]}yi(Ws,"ConstantBinder"),yi(ys,"PatternConstantBinder"),yi(El,"SourceExpressionBinder"),yi(Sl,"PatternCompositeBinder"),yi(Ca,"CompositeExpressionBinder"),yi(pc,"ProgramConfiguration",{omit:["_buffers"]}),yi(mc,"ProgramConfigurationSet");const lp="-transition";class Aa extends jr{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new ye(r.layout)),r.paint)){this._transitionablePaint=new Q(r.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new be(r.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,a={}){r!=null&&this._validate(tp,`layers.${this.id}.layout.${e}`,e,r,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return or(e,lp)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,a={}){if(r!=null&&this._validate(Lm,`layers.${this.id}.paint.${e}`,e,r,a))return!1;if(or(e,lp))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[e],m=h.value.isDataDriven(),y=h.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value,M=w.isDataDriven(),k=or(e,"pattern")||e==="line-dasharray";return M||m||k||this._handleOverridablePaintPropertyUpdate(e,y,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),xe(e,(r,a)=>!(r===void 0||a==="layout"&&!Object.keys(r).length||a==="paint"&&!Object.keys(r).length))}_validate(e,r,a,h,m={}){return(!m||m.validate!==!1)&&ip(this,e.call(oh,{key:r,layerType:this.type,objectKey:a,value:h,styleSpec:wt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof _e&&rc(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=nu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Kx=et([{name:"a_pos",components:2,type:"Int16"}],4),Cl=et([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class In{constructor(e=[]){this.segments=e}prepareSegment(e,r,a,h){let m=this.segments[this.segments.length-1];return e>In.MAX_VERTEX_ARRAY_LENGTH&&Lt(`Max vertices per segment is ${In.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>In.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,a,h){return new In([{vertexOffset:e,primitiveOffset:r,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}In.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,yi(In,"SegmentVector");var Mi=8192;class ls{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof zr?new zr(e.lng,e.lat):zr.convert(e),this}setSouthWest(e){return this._sw=e instanceof zr?new zr(e.lng,e.lat):zr.convert(e),this}extend(e){const r=this._sw,a=this._ne;let h,m;if(e instanceof zr)h=e,m=e;else{if(!(e instanceof ls))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ls.convert(e)):this.extend(zr.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(zr.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return r||a?(r.lng=Math.min(h.lng,r.lng),r.lat=Math.min(h.lat,r.lat),a.lng=Math.max(m.lng,a.lng),a.lat=Math.max(m.lat,a.lat)):(this._sw=new zr(h.lng,h.lat),this._ne=new zr(m.lng,m.lat)),this}getCenter(){return new zr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new zr(this.getWest(),this.getNorth())}getSouthEast(){return new zr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:a}=zr.convert(e);let h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&h}static convert(e){return!e||e instanceof ls?e:new ls(e)}}var cp=1e-6,so=typeof Float32Array<"u"?Float32Array:Array;function v_(){var i=new so(9);return so!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function b_(i,e,r){var a=e[0],h=e[1],m=e[2],y=e[3],w=e[4],M=e[5],k=e[6],B=e[7],U=e[8],G=r[0],X=r[1],Y=r[2],ie=r[3],de=r[4],Ee=r[5],Re=r[6],Se=r[7],De=r[8];return i[0]=G*a+X*y+Y*k,i[1]=G*h+X*w+Y*B,i[2]=G*m+X*M+Y*U,i[3]=ie*a+de*y+Ee*k,i[4]=ie*h+de*w+Ee*B,i[5]=ie*m+de*M+Ee*U,i[6]=Re*a+Se*y+De*k,i[7]=Re*h+Se*w+De*B,i[8]=Re*m+Se*M+De*U,i}function Ao(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function hp(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=e[4],w=e[5],M=e[6],k=e[7],B=e[8],U=e[9],G=e[10],X=e[11],Y=e[12],ie=e[13],de=e[14],Ee=e[15],Re=r*w-a*y,Se=r*M-h*y,De=r*k-m*y,Ue=a*M-h*w,Be=a*k-m*w,_t=h*k-m*M,ft=B*ie-U*Y,St=B*de-G*Y,Zt=B*Ee-X*Y,xt=U*de-G*ie,Ot=U*Ee-X*ie,Rt=G*Ee-X*de,Ut=Re*Rt-Se*Ot+De*xt+Ue*Zt-Be*St+_t*ft;return Ut?(i[0]=(w*Rt-M*Ot+k*xt)*(Ut=1/Ut),i[1]=(h*Ot-a*Rt-m*xt)*Ut,i[2]=(ie*_t-de*Be+Ee*Ue)*Ut,i[3]=(G*Be-U*_t-X*Ue)*Ut,i[4]=(M*Zt-y*Rt-k*St)*Ut,i[5]=(r*Rt-h*Zt+m*St)*Ut,i[6]=(de*De-Y*_t-Ee*Se)*Ut,i[7]=(B*_t-G*De+X*Se)*Ut,i[8]=(y*Ot-w*Zt+k*ft)*Ut,i[9]=(a*Zt-r*Ot-m*ft)*Ut,i[10]=(Y*Be-ie*De+Ee*Re)*Ut,i[11]=(U*De-B*Be-X*Re)*Ut,i[12]=(w*St-y*xt-M*ft)*Ut,i[13]=(r*xt-a*St+h*ft)*Ut,i[14]=(ie*Se-Y*Ue-de*Re)*Ut,i[15]=(B*Ue-U*Se+G*Re)*Ut,i):null}function Al(i,e,r){var a=e[0],h=e[1],m=e[2],y=e[3],w=e[4],M=e[5],k=e[6],B=e[7],U=e[8],G=e[9],X=e[10],Y=e[11],ie=e[12],de=e[13],Ee=e[14],Re=e[15],Se=r[0],De=r[1],Ue=r[2],Be=r[3];return i[0]=Se*a+De*w+Ue*U+Be*ie,i[1]=Se*h+De*M+Ue*G+Be*de,i[2]=Se*m+De*k+Ue*X+Be*Ee,i[3]=Se*y+De*B+Ue*Y+Be*Re,i[4]=(Se=r[4])*a+(De=r[5])*w+(Ue=r[6])*U+(Be=r[7])*ie,i[5]=Se*h+De*M+Ue*G+Be*de,i[6]=Se*m+De*k+Ue*X+Be*Ee,i[7]=Se*y+De*B+Ue*Y+Be*Re,i[8]=(Se=r[8])*a+(De=r[9])*w+(Ue=r[10])*U+(Be=r[11])*ie,i[9]=Se*h+De*M+Ue*G+Be*de,i[10]=Se*m+De*k+Ue*X+Be*Ee,i[11]=Se*y+De*B+Ue*Y+Be*Re,i[12]=(Se=r[12])*a+(De=r[13])*w+(Ue=r[14])*U+(Be=r[15])*ie,i[13]=Se*h+De*M+Ue*G+Be*de,i[14]=Se*m+De*k+Ue*X+Be*Ee,i[15]=Se*y+De*B+Ue*Y+Be*Re,i}function Nd(i,e,r){var a,h,m,y,w,M,k,B,U,G,X,Y,ie=r[0],de=r[1],Ee=r[2];return e===i?(i[12]=e[0]*ie+e[4]*de+e[8]*Ee+e[12],i[13]=e[1]*ie+e[5]*de+e[9]*Ee+e[13],i[14]=e[2]*ie+e[6]*de+e[10]*Ee+e[14],i[15]=e[3]*ie+e[7]*de+e[11]*Ee+e[15]):(h=e[1],m=e[2],y=e[3],w=e[4],M=e[5],k=e[6],B=e[7],U=e[8],G=e[9],X=e[10],Y=e[11],i[0]=a=e[0],i[1]=h,i[2]=m,i[3]=y,i[4]=w,i[5]=M,i[6]=k,i[7]=B,i[8]=U,i[9]=G,i[10]=X,i[11]=Y,i[12]=a*ie+w*de+U*Ee+e[12],i[13]=h*ie+M*de+G*Ee+e[13],i[14]=m*ie+k*de+X*Ee+e[14],i[15]=y*ie+B*de+Y*Ee+e[15]),i}function Ml(i,e,r){var a=r[0],h=r[1],m=r[2];return i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i[3]=e[3]*a,i[4]=e[4]*h,i[5]=e[5]*h,i[6]=e[6]*h,i[7]=e[7]*h,i[8]=e[8]*m,i[9]=e[9]*m,i[10]=e[10]*m,i[11]=e[11]*m,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Ud(i,e,r){var a=Math.sin(r),h=Math.cos(r),m=e[4],y=e[5],w=e[6],M=e[7],k=e[8],B=e[9],U=e[10],G=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=m*h+k*a,i[5]=y*h+B*a,i[6]=w*h+U*a,i[7]=M*h+G*a,i[8]=k*h-m*a,i[9]=B*h-y*a,i[10]=U*h-w*a,i[11]=G*h-M*a,i}function up(i,e,r){var a=Math.sin(r),h=Math.cos(r),m=e[0],y=e[1],w=e[2],M=e[3],k=e[8],B=e[9],U=e[10],G=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*h-k*a,i[1]=y*h-B*a,i[2]=w*h-U*a,i[3]=M*h-G*a,i[8]=m*a+k*h,i[9]=y*a+B*h,i[10]=w*a+U*h,i[11]=M*a+G*h,i}function Fm(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function gc(i,e,r){var a,h,m,y=r[0],w=r[1],M=r[2],k=Math.hypot(y,w,M);return k<cp?null:(y*=k=1/k,w*=k,M*=k,a=Math.sin(e),h=Math.cos(e),i[0]=y*y*(m=1-h)+h,i[1]=w*y*m+M*a,i[2]=M*y*m-w*a,i[3]=0,i[4]=y*w*m-M*a,i[5]=w*w*m+h,i[6]=M*w*m+y*a,i[7]=0,i[8]=y*M*m+w*a,i[9]=w*M*m-y*a,i[10]=M*M*m+h,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Vd=Al;function dp(){var i=new so(3);return so!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function w_(i){var e=new so(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function pu(i){return Math.hypot(i[0],i[1],i[2])}function _c(i,e,r){var a=new so(3);return a[0]=i,a[1]=e,a[2]=r,a}function Ma(i,e,r){return i[0]=e[0]+r[0],i[1]=e[1]+r[1],i[2]=e[2]+r[2],i}function fp(i,e,r){return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],i}function pp(i,e,r){return i[0]=e[0]*r[0],i[1]=e[1]*r[1],i[2]=e[2]*r[2],i}function Hs(i,e,r){return i[0]=Math.min(e[0],r[0]),i[1]=Math.min(e[1],r[1]),i[2]=Math.min(e[2],r[2]),i}function Jo(i,e,r){return i[0]=Math.max(e[0],r[0]),i[1]=Math.max(e[1],r[1]),i[2]=Math.max(e[2],r[2]),i}function oo(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i}function jd(i,e,r,a){return i[0]=e[0]+r[0]*a,i[1]=e[1]+r[1]*a,i[2]=e[2]+r[2]*a,i}function Bs(i,e){var r=e[0],a=e[1],h=e[2],m=r*r+a*a+h*h;return m>0&&(m=1/Math.sqrt(m)),i[0]=e[0]*m,i[1]=e[1]*m,i[2]=e[2]*m,i}function ao(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Ya(i,e,r){var a=e[0],h=e[1],m=e[2],y=r[0],w=r[1],M=r[2];return i[0]=h*M-m*w,i[1]=m*y-a*M,i[2]=a*w-h*y,i}function mn(i,e,r){var a=e[0],h=e[1],m=e[2],y=r[3]*a+r[7]*h+r[11]*m+r[15];return i[0]=(r[0]*a+r[4]*h+r[8]*m+r[12])/(y=y||1),i[1]=(r[1]*a+r[5]*h+r[9]*m+r[13])/y,i[2]=(r[2]*a+r[6]*h+r[10]*m+r[14])/y,i}function Er(i,e,r){var a=r[0],h=r[1],m=r[2],y=e[0],w=e[1],M=e[2],k=h*M-m*w,B=m*y-a*M,U=a*w-h*y,G=h*U-m*B,X=m*k-a*U,Y=a*B-h*k,ie=2*r[3];return B*=ie,U*=ie,X*=2,Y*=2,i[0]=y+(k*=ie)+(G*=2),i[1]=w+B+X,i[2]=M+U+Y,i}var $d,Mo=fp,Jx=pp,mu=pu;function T_(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i}function Gd(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=r*r+a*a+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),i[0]=r*y,i[1]=a*y,i[2]=h*y,i[3]=m*y,i}function Fs(i,e,r){var a=e[0],h=e[1],m=e[2],y=e[3];return i[0]=r[0]*a+r[4]*h+r[8]*m+r[12]*y,i[1]=r[1]*a+r[5]*h+r[9]*m+r[13]*y,i[2]=r[2]*a+r[6]*h+r[10]*m+r[14]*y,i[3]=r[3]*a+r[7]*h+r[11]*m+r[15]*y,i}function mp(){var i=new so(4);return so!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function xs(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function E_(i,e,r){r*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(r),M=Math.cos(r);return i[0]=a*M+y*w,i[1]=h*M+m*w,i[2]=m*M-h*w,i[3]=y*M-a*w,i}function Nm(i,e,r){r*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(r),M=Math.cos(r);return i[0]=a*M-m*w,i[1]=h*M+y*w,i[2]=m*M+a*w,i[3]=y*M-h*w,i}dp(),$d=new so(4),so!=Float32Array&&($d[0]=0,$d[1]=0,$d[2]=0,$d[3]=0);var S_=Gd;dp(),_c(1,0,0),_c(0,1,0),mp(),mp(),v_();const gp=et([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:C_}=gp,A_=et([{name:"a_pos_3",components:3,type:"Int16"}]);var Qo=et([{name:"a_pos",type:"Int16",components:2}]);class Um{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,a){const h=ao(r,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/h;return a[0]=this.pos[0]+this.dir[0]*m,a[1]=this.pos[1]+this.dir[1]*m,a[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(e,r,a){if(function(X,Y){var ie=X[0],de=X[1],Ee=X[2],Re=Y[0],Se=Y[1],De=Y[2];return Math.abs(ie-Re)<=cp*Math.max(1,Math.abs(ie),Math.abs(Re))&&Math.abs(de-Se)<=cp*Math.max(1,Math.abs(de),Math.abs(Se))&&Math.abs(Ee-De)<=cp*Math.max(1,Math.abs(Ee),Math.abs(De))}(this.pos,e)||r===0)return a[0]=a[1]=a[2]=0,!1;const[h,m,y]=this.dir,w=this.pos[0]-e[0],M=this.pos[1]-e[1],k=this.pos[2]-e[2],B=h*h+m*m+y*y,U=2*(w*h+M*m+k*y),G=U*U-4*B*(w*w+M*M+k*k-r*r);if(G<0){const X=Math.max(-U/2,0),Y=w+h*X,ie=M+m*X,de=k+y*X,Ee=Math.hypot(Y,ie,de);return a[0]=Y*r/Ee,a[1]=ie*r/Ee,a[2]=de*r/Ee,!1}{const X=(-U-Math.sqrt(G))/(2*B);if(X<0){const Y=Math.hypot(w,M,k);return a[0]=w*r/Y,a[1]=M*r/Y,a[2]=k*r/Y,!1}return a[0]=w+h*X,a[1]=M+m*X,a[2]=k+y*X,!0}}}class Vm{constructor(e,r,a,h,m){this.TL=e,this.TR=r,this.BR=a,this.BL=h,this.horizon=m}static fromInvProjectionMatrix(e,r,a){const h=[-1,1,1],m=[1,1,1],y=[1,-1,1],w=[-1,-1,1],M=mn(h,h,e),k=mn(m,m,e),B=mn(y,y,e),U=mn(w,w,e);return new Vm(M,k,B,U,r/a)}}class Ka{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,a,h){const m=Math.pow(2,a),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const k=Fs([],M,e),B=1/k[3]/r*m;return function(U,G,X){return U[0]=G[0]*X[0],U[1]=G[1]*X[1],U[2]=G[2]*X[2],U[3]=G[3]*X[3],U}(k,k,[B,B,h?1/k[3]:B,B])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const k=Bs([],Ya([],Mo([],y[M[0]],y[M[1]]),Mo([],y[M[2]],y[M[1]]))),B=-ao(k,y[M[1]]);return k.concat(B)});return new Ka(y,w)}}class cs{static fromPoints(e){const r=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const h of e)Hs(r,r,h),Jo(a,a,h);return new cs(r,a)}static applyTransform(e,r){const a=e.getCorners();for(let h=0;h<a.length;++h)mn(a[h],a[h],r);return cs.fromPoints(a)}constructor(e,r){this.min=e,this.max=r,this.center=oo([],Ma([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],a=w_(this.min),h=w_(this.max);for(let m=0;m<r.length;m++)a[m]=r[m]?this.min[m]:this.center[m],h[m]=r[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new cs(a,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let a=!0;for(let h=0;h<e.planes.length;h++){const m=e.planes[h];let y=0;for(let w=0;w<r.length;w++)y+=ao(m,r[w])+m[3]>=0;if(y===0)return 0;y!==r.length&&(a=!1)}if(a)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const M=e.points[w][h]-this.min[h];m=Math.min(m,M),y=Math.max(y,M)}if(y<0||m>this.max[h]-this.min[h])return 0}return 1}}const Wd=5,_p=6,Ja=Mi/Math.PI/2,M_=16383,yc=64,Hd=[yc,32,16],Io=-Ja,Ns=Ja,Qx=[new cs([Io,Io,Io],[Ns,Ns,Ns]),new cs([Io,Io,Io],[0,0,Ns]),new cs([0,Io,Io],[Ns,0,Ns]),new cs([Io,0,Io],[0,Ns,Ns]),new cs([0,0,Io],[Ns,Ns,Ns])];function yp(i){return i*Ja/Yd}function I_(i,e,r,a=!0){const h=oo([],i._camera.position,i.worldSize),m=[e,r,1,1];Fs(m,m,i.pixelMatrixInverse),T_(m,m,1/m[3]);const y=Bs([],Mo([],m,h)),w=i.globeMatrix,M=[w[12],w[13],w[14]],k=Mo([],M,h),B=pu(k),U=Bs([],k),G=i.worldSize/(2*Math.PI),X=ao(U,y),Y=Math.asin(G/B);if(Y<Math.acos(X)){if(!a)return null;const Zt=[],xt=[];oo(Zt,y,B/X),Bs(xt,Mo(xt,Zt,k)),Bs(y,Ma(y,k,oo(y,xt,Math.tan(Y)*B)))}const ie=[];new Um(h,y).closestPointOnSphere(M,G,ie);const de=Bs([],Ht(w,0)),Ee=Bs([],Ht(w,1)),Re=Bs([],Ht(w,2)),Se=ao(de,ie),De=ao(Ee,ie),Ue=ao(Re,ie),Be=kt(Math.asin(-De/G));let _t=kt(Math.atan2(Se,Ue));_t=i.center.lng+function(Zt,xt){const Ot=(xt-Zt+180)%360-180;return Ot<-180?Ot+360:Ot}(i.center.lng,_t);const ft=ka(_t),St=vi(ta(Be),0,1);return new xu(ft,St)}class k_{constructor(e,r,a){this.a=Mo([],e,a),this.b=Mo([],r,a),this.center=a;const h=Bs([],this.a),m=Bs([],this.b);this.angle=Math.acos(ao(h,m))}}function qd(i,e){if(i.angle===0)return null;let r;return r=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),r<0||r>1?null:function(a,h,m,y){const w=Math.sin(m);return a*(Math.sin((1-y)*m)/w)+h*(Math.sin(y*m)/w)}(i.a[e],i.b[e],i.angle,vi(r,0,1))+i.center[e]}function ea(i){if(i.z<=1)return Qx[i.z+2*i.y+i.x];const e=ch(Xd(i));return cs.fromPoints(e)}function Ia(i,e,r){return oo(i,i,1-r),jd(i,i,e,r)}function jm(i,e){const r=yu(e.zoom);if(r===0)return ea(i);const a=Xd(i),h=ch(a),m=ka(a.getWest())*e.worldSize,y=ka(a.getEast())*e.worldSize,w=ta(a.getNorth())*e.worldSize,M=ta(a.getSouth())*e.worldSize,k=[m,w,0],B=[y,w,0],U=[m,M,0],G=[y,M,0],X=hp([],e.globeMatrix);return mn(k,k,X),mn(B,B,X),mn(U,U,X),mn(G,G,X),h[0]=Ia(h[0],U,r),h[1]=Ia(h[1],G,r),h[2]=Ia(h[2],B,r),h[3]=Ia(h[3],k,r),cs.fromPoints(h)}function P_(i,e,r){for(const a of i)mn(a,a,e),oo(a,a,r)}function ev(i,e,r){const a=e/i.worldSize,h=i.globeMatrix;if(r.z<=1){const ft=ea(r).getCorners();return P_(ft,h,a),cs.fromPoints(ft)}const m=Xd(r),y=ch(m);P_(y,h,a);const w=Number.MAX_VALUE,M=[-w,-w,-w],k=[w,w,w];if(m.contains(i.center)){for(const Zt of y)Hs(k,k,Zt),Jo(M,M,Zt);M[2]=0;const ft=i.point,St=[ft.x*a,ft.y*a,0];return Hs(k,k,St),Jo(M,M,St),new cs(k,M)}const B=[h[12]*a,h[13]*a,h[14]*a],U=m.getCenter(),G=vi(i.center.lat,-85.051129,Po),X=vi(U.lat,-85.051129,Po),Y=ka(i.center.lng),ie=ta(G);let de=Y-ka(U.lng);const Ee=ie-ta(X);de>.5?de-=1:de<-.5&&(de+=1);let Re=0;Math.abs(de)>Math.abs(Ee)?Re=de>=0?1:3:(Re=Ee>=0?0:2,jd(B,B,[h[4]*a,h[5]*a,h[6]*a],-Math.sin(dt(Ee>=0?m.getSouth():m.getNorth()))*Ja));const Se=y[Re],De=y[(Re+1)%4],Ue=new k_(Se,De,B),Be=[qd(Ue,0)||Se[0],qd(Ue,1)||Se[1],qd(Ue,2)||Se[2]],_t=yu(i.zoom);if(_t>0){const ft=function({x:Zt,y:xt,z:Ot},Rt,Ut,ei,Tt){const ai=1/(1<<Ot);let Ti=Zt*ai,di=Ti+ai,Xi=xt*ai,ti=Xi+ai,Di=0;const Zi=(Ti+di)/2-ei;return Zi>.5?Di=-1:Zi<-.5&&(Di=1),Ti=((Ti+Di)*Rt-(ei*=Rt))*Ut+ei,di=((di+Di)*Rt-ei)*Ut+ei,Xi=(Xi*Rt-(Tt*=Rt))*Ut+Tt,ti=(ti*Rt-Tt)*Ut+Tt,[[Ti,ti,0],[di,ti,0],[di,Xi,0],[Ti,Xi,0]]}(r,e,i._pixelsPerMercatorPixel,Y,ie);for(let Zt=0;Zt<y.length;Zt++)Ia(y[Zt],ft[Zt],_t);const St=Ma([],ft[Re],ft[(Re+1)%4]);oo(St,St,.5),Ia(Be,St,_t)}for(const ft of y)Hs(k,k,ft),Jo(M,M,ft);return k[2]=Math.min(Se[2],De[2]),Hs(k,k,Be),Jo(M,M,Be),new cs(k,M)}function Xd({x:i,y:e,z:r}){const a=1/(1<<r),h=new zr(ko(i*a),vs((e+1)*a)),m=new zr(ko((i+1)*a),vs(e*a));return new ls(h,m)}function ch(i){const e=dt(i.getNorth()),r=dt(i.getSouth()),a=Math.cos(e),h=Math.cos(r),m=Math.sin(e),y=Math.sin(r),w=i.getWest(),M=i.getEast();return[hh(h,y,w),hh(h,y,M),hh(a,m,M),hh(a,m,w)]}function hh(i,e,r,a=Ja){return r=dt(r),[i*Math.sin(r)*a,-e*a,i*Math.cos(r)*a]}function gu(i,e,r){return hh(Math.cos(dt(i)),Math.sin(dt(i)),e,r)}function Zd(i,e,r,a){const h=1<<r.z,m=(i/Mi+r.x)/h;return gu(vs((e/Mi+r.y)/h),ko(m),a)}function _u({min:i,max:e}){return M_/Math.max(e[0]-i[0],e[1]-i[1],e[2]-i[2])}const xc=new Float64Array(16);function uh(i){const e=_u(i),r=Fm(xc,[e,e,e]);return Nd(r,r,((a=[])[0]=-(h=i.min)[0],a[1]=-h[1],a[2]=-h[2],a));var a,h}function $m(i){const e=(a=i.min,(r=xc)[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=a[0],r[13]=a[1],r[14]=a[2],r[15]=1,r);var r,a;const h=1/_u(i);return Ml(e,e,[h,h,h])}function L_(i,e,r,a,h){const m=function(M){const k=Mi/(2*Math.PI);return M/(2*Math.PI)/k}(r),y=[i,e,-r/(2*Math.PI)],w=Ao(new Float64Array(16));return Nd(w,w,y),Ml(w,w,[m,m,m]),Ud(w,w,dt(-h)),up(w,w,dt(-a)),w}function yu(i){return Lr(Wd,_p,i)}function D_(i,e){const r=gu(e.lat,e.lng),a=function(Y){const ie=gu(Y._center.lat,Y._center.lng);let de=Ya([],_c(0,1,0),ie);const Ee=gc([],-Y.angle,ie);de=mn(de,de,Ee),gc(Ee,-Y._pitch,de);const Re=Bs([],ie);return oo(Re,Re,yp(Y.cameraToCenterDistance/Y.pixelsPerMeter)),mn(Re,Re,Ee),Ma([],ie,Re)}(i);return y=(h=fp([],a,r))[0],w=h[1],M=h[2],k=(m=r)[0],B=m[1],U=m[2],X=(G=Math.sqrt(y*y+w*w+M*M)*Math.sqrt(k*k+B*B+U*U))&&ao(h,m)/G,Math.acos(Math.min(Math.max(X,-1),1));var h,m,y,w,M,k,B,U,G,X}function Gm(i,e){return D_(i,e)>Math.PI/2*1.01}const O_=dt(85),tv=Math.cos(O_),iv=Math.sin(O_),Yd=63710088e-1,R_=2*Math.PI*Yd;class vc{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vc(ir(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,a=this.lat*r,h=e.lat*r,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*r);return Yd*Math.acos(Math.min(m,1))}toBounds(e=0){const r=360*e/40075017,a=r/Math.cos(Math.PI/180*this.lat);return new ls(new vc(this.lng-a,this.lat-r),new vc(this.lng+a,this.lat+r))}toEcef(e){const r=yp(e);return gu(this.lat,this.lng,Ja+r)}static convert(e){if(e instanceof vc)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new vc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new vc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var zr=vc;function Wm(i){return R_*Math.cos(i*Math.PI/180)}function ka(i){return(180+i)/360}function ta(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Pa(i,e){return i/Wm(e)}function ko(i){return 360*i-180}function vs(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Kd(i,e){return i*Wm(vs(e))}const Po=85.051129;function Hm(i){return 1/Math.cos(i*Math.PI/180)}class xu{constructor(e,r,a=0){this.x=+e,this.y=+r,this.z=+a}static fromLngLat(e,r=0){const a=zr.convert(e);return new xu(ka(a.lng),ta(a.lat),Pa(r,a.lat))}toLngLat(){return new zr(ko(this.x),vs(this.y))}toAltitude(){return Kd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/R_*Hm(vs(this.y))}}function vu(i,e,r,a,h,m,y,w,M){const k=(e+a)/2,B=(r+h)/2,U=new He(k,B);w(U),function(G,X,Y,ie,de,Ee){const Re=Y-de,Se=ie-Ee;return Math.abs((ie-X)*Re-(Y-G)*Se)/Math.hypot(Re,Se)}(U.x,U.y,m.x,m.y,y.x,y.y)>=M?(vu(i,e,r,k,B,m,U,w,M),vu(i,k,B,a,h,U,y,w,M)):i.push(y)}function xp(i,e,r){let a=i[0],h=a.x,m=a.y;e(a);const y=[a];for(let w=1;w<i.length;w++){const M=i[w],{x:k,y:B}=M;e(M),vu(y,h,m,k,B,a,M,e,r),h=k,m=B,a=M}return y}function vp(i,e,r,a){if(a(e,r)){const h=e.add(r)._mult(.5);vp(i,e,h,a),vp(i,h,r,a)}else i.push(r)}function rv(i,e){let r=i[0];const a=[r];for(let h=1;h<i.length;h++){const m=i[h];vp(a,r,m,e),r=m}return a}const Jd=Math.pow(2,14)-1,z_=-Jd-1;function nv(i,e){const r=Math.round(i.x*e),a=Math.round(i.y*e);return i.x=vi(r,z_,Jd),i.y=vi(a,z_,Jd),(r<i.x||r>i.x+1||a<i.y||a>i.y+1)&&Lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function La(i,e,r){const a=i.loadGeometry(),h=i.extent,m=Mi/h;if(e&&r&&r.projection.isReprojectedInTileSpace){const y=1<<e.z,{scale:w,x:M,y:k,projection:B}=r,U=G=>{const X=ko((e.x+G.x/h)/y),Y=vs((e.y+G.y/h)/y),ie=B.project(X,Y);G.x=(ie.x*w-M)*h,G.y=(ie.y*w-k)*h};for(let G=0;G<a.length;G++)if(i.type!==1)a[G]=xp(a[G],U,1);else{const X=[];for(const Y of a[G])Y.x<0||Y.x>=h||Y.y<0||Y.y>=h||(U(Y),X.push(Y));a[G]=X}}for(const y of a)for(const w of y)nv(w,m);return a}function dh(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?La(i):[]}}function bp(i,e,r,a,h){i.emplaceBack(2*e+(a+1)/2,2*r+(h+1)/2)}function wp(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class bu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Nt,this.indexArray=new Ai,this.segments=new In,this.programConfigurations=new mc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a,h){const m=this.layers[0],y=[];let w=null;m.type==="circle"&&(w=m.layout.get("circle-sort-key"));for(const{feature:k,id:B,index:U,sourceLayerIndex:G}of e){const X=this.layers[0]._featureFilter.needGeometry,Y=dh(k,X);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),Y,a))continue;const ie=w?w.evaluate(Y,{},a):void 0,de={id:B,properties:k.properties,type:k.type,sourceLayerIndex:G,index:U,geometry:X?Y.geometry:La(k,a,h),patterns:{},sortKey:ie};y.push(de)}w&&y.sort((k,B)=>k.sortKey-B.sortKey);let M=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new Gt,M=h.projection);for(const k of y){const{geometry:B,index:U,sourceLayerIndex:G}=k,X=e[U].feature;this.addFeature(k,B,U,r.availableImages,a,M),r.featureIndex.insert(X,B,U,G,this.index)}}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Kx.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Cl.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,a,h,m,y){for(const w of r)for(const M of w){const k=M.x,B=M.y;if(k<0||k>=Mi||B<0||B>=Mi)continue;if(y){const X=y.projectTilePoint(k,B,m),Y=y.upVector(m,k,B),ie=this.globeExtVertexArray;wp(ie,X,Y),wp(ie,X,Y),wp(ie,X,Y),wp(ie,X,Y)}const U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),G=U.vertexLength;bp(this.layoutVertexArray,k,B,-1,-1),bp(this.layoutVertexArray,k,B,1,-1),bp(this.layoutVertexArray,k,B,1,1),bp(this.layoutVertexArray,k,B,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+2,G+3),U.vertexLength+=4,U.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h,m)}}function Qd(i,e){for(let r=0;r<i.length;r++)if(Qa(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Qa(i,e[r]))return!0;return!!Tp(i,e)}function B_(i,e,r){return!!Qa(i,e)||!!ef(e,i,r)}function qm(i,e){if(i.length===1)return N_(e,i[0]);for(let r=0;r<e.length;r++){const a=e[r];for(let h=0;h<a.length;h++)if(Qa(i,a[h]))return!0}for(let r=0;r<i.length;r++)if(N_(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Tp(i,e[r]))return!0;return!1}function F_(i,e,r){if(i.length>1){if(Tp(i,e))return!0;for(let a=0;a<e.length;a++)if(ef(e[a],i,r))return!0}for(let a=0;a<i.length;a++)if(ef(i[a],e,r))return!0;return!1}function Tp(i,e){if(i.length===0||e.length===0)return!1;for(let r=0;r<i.length-1;r++){const a=i[r],h=i[r+1];for(let m=0;m<e.length-1;m++)if(Ep(a,h,e[m],e[m+1]))return!0}return!1}function Ep(i,e,r,a){return At(i,r,a)!==At(e,r,a)&&At(i,e,r)!==At(i,e,a)}function ef(i,e,r){const a=r*r;if(e.length===1)return i.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(wu(i,e[h-1],e[h])<a)return!0;return!1}function wu(i,e,r){const a=e.distSqr(r);if(a===0)return i.distSqr(e);const h=((i.x-e.x)*(r.x-e.x)+(i.y-e.y)*(r.y-e.y))/a;return i.distSqr(h<0?e:h>1?r:r.sub(e)._mult(h)._add(e))}function N_(i,e){let r,a,h,m=!1;for(let y=0;y<i.length;y++){r=i[y];for(let w=0,M=r.length-1;w<r.length;M=w++)a=r[w],h=r[M],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function Qa(i,e){let r=!1;for(let a=0,h=i.length-1;a<i.length;h=a++){const m=i[a],y=i[h];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(r=!r)}return r}function tf(i,e,r,a,h){for(const y of i)if(e<=y.x&&r<=y.y&&a>=y.x&&h>=y.y)return!0;const m=[new He(e,r),new He(e,h),new He(a,h),new He(a,r)];if(i.length>2){for(const y of m)if(Qa(i,y))return!0}for(let y=0;y<i.length-1;y++)if(sv(i[y],i[y+1],m))return!0;return!1}function sv(i,e,r){const a=r[0],h=r[2];if(i.x<a.x&&e.x<a.x||i.x>h.x&&e.x>h.x||i.y<a.y&&e.y<a.y||i.y>h.y&&e.y>h.y)return!1;const m=At(i,e,r[0]);return m!==At(i,e,r[1])||m!==At(i,e,r[2])||m!==At(i,e,r[3])}function Tu(i,e,r){const a=e.paint.get(i).value;return a.kind==="constant"?a.value:r.programConfigurations.get(e.id).getMaxValue(i)}function el(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Xm(i,e,r,a,h){if(!e[0]&&!e[1])return i;const m=He.convert(e)._mult(h);r==="viewport"&&m._rotate(-a);const y=[];for(let w=0;w<i.length;w++)y.push(i[w].sub(m));return y}function Sp(i,e,r,a){const h=He.convert(i)._mult(a);return e==="viewport"&&h._rotate(-r),h}yi(bu,"CircleBucket",{omit:["layers"]});const U_=new Ie({"circle-sort-key":new pe(wt.layout_circle["circle-sort-key"])});var bc={paint:new Ie({"circle-radius":new pe(wt.paint_circle["circle-radius"]),"circle-color":new pe(wt.paint_circle["circle-color"]),"circle-blur":new pe(wt.paint_circle["circle-blur"]),"circle-opacity":new pe(wt.paint_circle["circle-opacity"]),"circle-translate":new ee(wt.paint_circle["circle-translate"]),"circle-translate-anchor":new ee(wt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ee(wt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ee(wt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pe(wt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pe(wt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pe(wt.paint_circle["circle-stroke-opacity"])}),layout:U_};function Eu(i,e,r,a,h,m,y,w,M){if(m&&i.queryGeometry.isAboveHorizon)return!1;m&&(M*=i.pixelToTileUnitsFactor);const k=i.tileID.canonical,B=r.projection.upVectorScale(k,r.center.lat,r.worldSize).metersToTile;for(const U of e)for(const G of U){const X=G.add(w),Y=h&&r.elevation?r.elevation.exaggeration()*h.getElevationAt(X.x,X.y,!0):0,ie=r.projection.projectTilePoint(X.x,X.y,k);if(Y>0){const Se=r.projection.upVector(k,X.x,X.y);ie.x+=Se[0]*B*Y,ie.y+=Se[1]*B*Y,ie.z+=Se[2]*B*Y}const de=m?X:rf(ie.x,ie.y,ie.z,a),Ee=m?i.tilespaceRays.map(Se=>ov(Se,Y)):i.queryGeometry.screenGeometry,Re=Fs([],[ie.x,ie.y,ie.z,1],a);if(!y&&m?M*=Re[3]/r.cameraToCenterDistance:y&&!m&&(M*=r.cameraToCenterDistance/Re[3]),m){const Se=vs((G.y/Mi+k.y)/(1<<k.z));M/=r.projection.pixelsPerMeter(Se,1)/Pa(1,Se)}if(B_(Ee,de,M))return!0}return!1}function rf(i,e,r,a){const h=Fs([],[i,e,r,1],a);return new He(h[0]/h[3],h[1]/h[3])}const V_=_c(0,0,0),nf=_c(0,0,1);function ov(i,e){const r=dp();return V_[2]=e,i.intersectsPlane(V_,nf,r),new He(r[0],r[1])}class Zm extends bu{}function sf(i,{width:e,height:r},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*r*a)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*r*a);return i.width=e,i.height=r,i.data=h,i}function j_(i,e,r){const{width:a,height:h}=e;a===i.width&&h===i.height||(Cp(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,a),height:Math.min(i.height,h)},r),i.width=a,i.height=h,i.data=e.data)}function Cp(i,e,r,a,h,m){if(h.width===0||h.height===0)return e;if(h.width>i.width||h.height>i.height||r.x>i.width-h.width||r.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,w=e.data;for(let M=0;M<h.height;M++){const k=((r.y+M)*i.width+r.x)*m,B=((a.y+M)*e.width+a.x)*m;for(let U=0;U<h.width*m;U++)w[B+U]=y[k+U]}return e}yi(Zm,"HeatmapBucket",{omit:["layers"]});class Il{constructor(e,r){sf(this,e,1,r)}resize(e){j_(this,new Il(e),1)}clone(){return new Il({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,h,m){Cp(e,r,a,h,m,1)}}class lo{constructor(e,r){sf(this,e,4,r)}resize(e){j_(this,new lo(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new lo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,h,m){Cp(e,r,a,h,m,4)}}yi(Il,"AlphaImage"),yi(lo,"RGBAImage");var av={paint:new Ie({"heatmap-radius":new pe(wt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pe(wt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ee(wt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ce(wt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ee(wt.paint_heatmap["heatmap-opacity"])})};function Ym(i){const e={},r=i.resolution||256,a=i.clips?i.clips.length:1,h=i.image||new lo({width:r,height:a}),m=(y,w,M)=>{e[i.evaluationKey]=M;const k=i.expression.evaluate(e);h.data[y+w+0]=Math.floor(255*k.r/k.a),h.data[y+w+1]=Math.floor(255*k.g/k.a),h.data[y+w+2]=Math.floor(255*k.b/k.a),h.data[y+w+3]=Math.floor(255*k.a)};if(i.clips)for(let y=0,w=0;y<a;++y,w+=4*r)for(let M=0,k=0;M<r;M++,k+=4){const B=M/(r-1),{start:U,end:G}=i.clips[y];m(w,k,U*(1-B)+G*B)}else for(let y=0,w=0;y<r;y++,w+=4)m(0,w,y/(r-1));return h}var lv={paint:new Ie({"hillshade-illumination-direction":new ee(wt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ee(wt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ee(wt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ee(wt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ee(wt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ee(wt.paint_hillshade["hillshade-accent-color"])})};const Km=et([{name:"a_pos",components:2,type:"Int16"}],4),{members:cv}=Km;var Ap={exports:{}};function Mp(i,e,r){r=r||2;var a,h,m,y,w,M,k,B=e&&e.length,U=B?e[0]*r:i.length,G=$_(i,0,U,r,!0),X=[];if(!G||G.next===G.prev)return X;if(B&&(G=function(ie,de,Ee,Re){var Se,De,Ue,Be=[];for(Se=0,De=de.length;Se<De;Se++)(Ue=$_(ie,de[Se]*Re,Se<De-1?de[Se+1]*Re:ie.length,Re,!1))===Ue.next&&(Ue.steiner=!0),Be.push(fv(Ue));for(Be.sort(uv),Se=0;Se<Be.length;Se++)Ee=W_(Be[Se],Ee);return Ee}(i,e,G,r)),i.length>80*r){a=m=i[0],h=y=i[1];for(var Y=r;Y<U;Y+=r)(w=i[Y])<a&&(a=w),(M=i[Y+1])<h&&(h=M),w>m&&(m=w),M>y&&(y=M);k=(k=Math.max(m-a,y-h))!==0?32767/k:0}return wc(G,X,r,a,h,k,0),X}function $_(i,e,r,a,h){var m,y;if(h===lf(i,e,r,a)>0)for(m=e;m<r;m+=a)y=eg(m,i[m],i[m+1],y);else for(m=r-a;m>=e;m-=a)y=eg(m,i[m],i[m+1],y);return y&&Pp(y,y.next)&&(ph(y),y=y.next),y}function fh(i,e){if(!i)return i;e||(e=i);var r,a=i;do if(r=!1,a.steiner||!Pp(a,a.next)&&Vn(a.prev,a,a.next)!==0)a=a.next;else{if(ph(a),(a=e=a.prev)===a.next)break;r=!0}while(r||a!==e);return e}function wc(i,e,r,a,h,m,y){if(i){!y&&m&&function(B,U,G,X){var Y=B;do Y.z===0&&(Y.z=kp(Y.x,Y.y,U,G,X)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==B);Y.prevZ.nextZ=null,Y.prevZ=null,function(ie){var de,Ee,Re,Se,De,Ue,Be,_t,ft=1;do{for(Ee=ie,ie=null,De=null,Ue=0;Ee;){for(Ue++,Re=Ee,Be=0,de=0;de<ft&&(Be++,Re=Re.nextZ);de++);for(_t=ft;Be>0||_t>0&&Re;)Be!==0&&(_t===0||!Re||Ee.z<=Re.z)?(Se=Ee,Ee=Ee.nextZ,Be--):(Se=Re,Re=Re.nextZ,_t--),De?De.nextZ=Se:ie=Se,Se.prevZ=De,De=Se;Ee=Re}De.nextZ=null,ft*=2}while(Ue>1)}(Y)}(i,a,h,m);for(var w,M,k=i;i.prev!==i.next;)if(w=i.prev,M=i.next,m?hv(i,a,h,m):G_(i))e.push(w.i/r|0),e.push(i.i/r|0),e.push(M.i/r|0),ph(i),i=M.next,k=M.next;else if((i=M)===k){y?y===1?wc(i=Jm(fh(i),e,r),e,r,a,h,m,2):y===2&&Ip(i,e,r,a,h,m):wc(fh(i),e,r,a,h,m,1);break}}}function G_(i){var e=i.prev,r=i,a=i.next;if(Vn(e,r,a)>=0)return!1;for(var h=e.x,m=r.x,y=a.x,w=e.y,M=r.y,k=a.y,B=h<m?h<y?h:y:m<y?m:y,U=w<M?w<k?w:k:M<k?M:k,G=h>m?h>y?h:y:m>y?m:y,X=w>M?w>k?w:k:M>k?M:k,Y=a.next;Y!==e;){if(Y.x>=B&&Y.x<=G&&Y.y>=U&&Y.y<=X&&Su(h,w,m,M,y,k,Y.x,Y.y)&&Vn(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function hv(i,e,r,a){var h=i.prev,m=i,y=i.next;if(Vn(h,m,y)>=0)return!1;for(var w=h.x,M=m.x,k=y.x,B=h.y,U=m.y,G=y.y,X=w<M?w<k?w:k:M<k?M:k,Y=B<U?B<G?B:G:U<G?U:G,ie=w>M?w>k?w:k:M>k?M:k,de=B>U?B>G?B:G:U>G?U:G,Ee=kp(X,Y,e,r,a),Re=kp(ie,de,e,r,a),Se=i.prevZ,De=i.nextZ;Se&&Se.z>=Ee&&De&&De.z<=Re;){if(Se.x>=X&&Se.x<=ie&&Se.y>=Y&&Se.y<=de&&Se!==h&&Se!==y&&Su(w,B,M,U,k,G,Se.x,Se.y)&&Vn(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,De.x>=X&&De.x<=ie&&De.y>=Y&&De.y<=de&&De!==h&&De!==y&&Su(w,B,M,U,k,G,De.x,De.y)&&Vn(De.prev,De,De.next)>=0))return!1;De=De.nextZ}for(;Se&&Se.z>=Ee;){if(Se.x>=X&&Se.x<=ie&&Se.y>=Y&&Se.y<=de&&Se!==h&&Se!==y&&Su(w,B,M,U,k,G,Se.x,Se.y)&&Vn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;De&&De.z<=Re;){if(De.x>=X&&De.x<=ie&&De.y>=Y&&De.y<=de&&De!==h&&De!==y&&Su(w,B,M,U,k,G,De.x,De.y)&&Vn(De.prev,De,De.next)>=0)return!1;De=De.nextZ}return!0}function Jm(i,e,r){var a=i;do{var h=a.prev,m=a.next.next;!Pp(h,m)&&Qm(h,a,a.next,m)&&af(h,m)&&af(m,h)&&(e.push(h.i/r|0),e.push(a.i/r|0),e.push(m.i/r|0),ph(a),ph(a.next),a=i=m),a=a.next}while(a!==i);return fh(a)}function Ip(i,e,r,a,h,m){var y=i;do{for(var w=y.next.next;w!==y.prev;){if(y.i!==w.i&&pv(y,w)){var M=H_(y,w);return y=fh(y,y.next),M=fh(M,M.next),wc(y,e,r,a,h,m,0),void wc(M,e,r,a,h,m,0)}w=w.next}y=y.next}while(y!==i)}function uv(i,e){return i.x-e.x}function W_(i,e){var r=function(h,m){var y,w=m,M=h.x,k=h.y,B=-1/0;do{if(k<=w.y&&k>=w.next.y&&w.next.y!==w.y){var U=w.x+(k-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(U<=M&&U>B&&(B=U,y=w.x<w.next.x?w:w.next,U===M))return y}w=w.next}while(w!==m);if(!y)return null;var G,X=y,Y=y.x,ie=y.y,de=1/0;w=y;do M>=w.x&&w.x>=Y&&M!==w.x&&Su(k<ie?M:B,k,Y,ie,k<ie?B:M,k,w.x,w.y)&&(G=Math.abs(k-w.y)/(M-w.x),af(w,h)&&(G<de||G===de&&(w.x>y.x||w.x===y.x&&dv(y,w)))&&(y=w,de=G)),w=w.next;while(w!==X);return y}(i,e);if(!r)return e;var a=H_(r,i);return fh(a,a.next),fh(r,r.next)}function dv(i,e){return Vn(i.prev,i,e.prev)<0&&Vn(e.next,i,i.next)<0}function kp(i,e,r,a,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function fv(i){var e=i,r=i;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==i);return r}function Su(i,e,r,a,h,m,y,w){return(h-y)*(e-w)>=(i-y)*(m-w)&&(i-y)*(a-w)>=(r-y)*(e-w)&&(r-y)*(m-w)>=(h-y)*(a-w)}function pv(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(r,a){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==a.i&&h.next.i!==a.i&&Qm(h,h.next,r,a))return!0;h=h.next}while(h!==r);return!1}(i,e)&&(af(i,e)&&af(e,i)&&function(r,a){var h=r,m=!1,y=(r.x+a.x)/2,w=(r.y+a.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==r);return m}(i,e)&&(Vn(i.prev,i,e.prev)||Vn(i,e.prev,e))||Pp(i,e)&&Vn(i.prev,i,i.next)>0&&Vn(e.prev,e,e.next)>0)}function Vn(i,e,r){return(e.y-i.y)*(r.x-e.x)-(e.x-i.x)*(r.y-e.y)}function Pp(i,e){return i.x===e.x&&i.y===e.y}function Qm(i,e,r,a){var h=of(Vn(i,e,r)),m=of(Vn(i,e,a)),y=of(Vn(r,a,i)),w=of(Vn(r,a,e));return h!==m&&y!==w||!(h!==0||!Lp(i,r,e))||!(m!==0||!Lp(i,a,e))||!(y!==0||!Lp(r,i,a))||!(w!==0||!Lp(r,e,a))}function Lp(i,e,r){return e.x<=Math.max(i.x,r.x)&&e.x>=Math.min(i.x,r.x)&&e.y<=Math.max(i.y,r.y)&&e.y>=Math.min(i.y,r.y)}function of(i){return i>0?1:i<0?-1:0}function af(i,e){return Vn(i.prev,i,i.next)<0?Vn(i,e,i.next)>=0&&Vn(i,i.prev,e)>=0:Vn(i,e,i.prev)<0||Vn(i,i.next,e)<0}function H_(i,e){var r=new tg(i.i,i.x,i.y),a=new tg(e.i,e.x,e.y),h=i.next,m=e.prev;return i.next=e,e.prev=i,r.next=h,h.prev=r,a.next=r,r.prev=a,m.next=a,a.prev=m,a}function eg(i,e,r,a){var h=new tg(i,e,r);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function ph(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function tg(i,e,r){this.i=i,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lf(i,e,r,a){for(var h=0,m=e,y=r-a;m<r;m+=a)h+=(i[y]-i[m])*(i[m+1]+i[y+1]),y=m;return h}Ap.exports=Mp,Ap.exports.default=Mp,Mp.deviation=function(i,e,r,a){var h=e&&e.length,m=Math.abs(lf(i,0,h?e[0]*r:i.length,r));if(h)for(var y=0,w=e.length;y<w;y++)m-=Math.abs(lf(i,e[y]*r,y<w-1?e[y+1]*r:i.length,r));var M=0;for(y=0;y<a.length;y+=3){var k=a[y]*r,B=a[y+1]*r,U=a[y+2]*r;M+=Math.abs((i[k]-i[U])*(i[B+1]-i[k+1])-(i[k]-i[B])*(i[U+1]-i[k+1]))}return m===0&&M===0?0:Math.abs((M-m)/m)},Mp.flatten=function(i){for(var e=i[0][0].length,r={vertices:[],holes:[],dimensions:e},a=0,h=0;h<i.length;h++){for(var m=0;m<i[h].length;m++)for(var y=0;y<e;y++)r.vertices.push(i[h][m][y]);h>0&&r.holes.push(a+=i[h-1].length)}return r};var ig=ge(Ap.exports);function mv(i,e,r,a,h){q_(i,e,r,a||i.length-1,h||gv)}function q_(i,e,r,a,h){for(;a>r;){if(a-r>600){var m=a-r+1,y=e-r+1,w=Math.log(m),M=.5*Math.exp(2*w/3),k=.5*Math.sqrt(w*M*(m-M)/m)*(y-m/2<0?-1:1);q_(i,e,Math.max(r,Math.floor(e-y*M/m+k)),Math.min(a,Math.floor(e+(m-y)*M/m+k)),h)}var B=i[e],U=r,G=a;for(Cu(i,r,e),h(i[a],B)>0&&Cu(i,r,a);U<G;){for(Cu(i,U,G),U++,G--;h(i[U],B)<0;)U++;for(;h(i[G],B)>0;)G--}h(i[r],B)===0?Cu(i,r,G):Cu(i,++G,a),G<=e&&(r=G+1),e<=G&&(a=G-1)}}function Cu(i,e,r){var a=i[e];i[e]=i[r],i[r]=a}function gv(i,e){return i<e?-1:i>e?1:0}function Dp(i,e){const r=i.length;if(r<=1)return[i];const a=[];let h,m;for(let y=0;y<r;y++){const w=Yt(i[y]);w!==0&&(i[y].area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(h&&a.push(h),h=[i[y]]):h.push(i[y]))}if(h&&a.push(h),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(mv(a[y],e,1,a[y].length-1,X_),a[y]=a[y].slice(0,e));return a}function X_(i,e){return e.area-i.area}function rg(i,e,r){const a=r.patternDependencies;let h=!1;for(const m of e){const y=m.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const w=y.constantOr(null);w&&(h=!0,a[w]=!0)}return h}function ng(i,e,r,a,h){const m=h.patternDependencies;for(const y of e){const w=y.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let M=w.evaluate({zoom:a},r,{},h.availableImages);M=M&&M.name?M.name:M,m[M]=!0,r.patterns[y.id]=M}}return r}class cf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Nt,this.indexArray=new Ai,this.indexArray2=new ns,this.programConfigurations=new mc(e.layers,e.zoom),this.segments=new In,this.segments2=new In,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,a,h){this.hasPattern=rg("fill",this.layers,r);const m=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:w,id:M,index:k,sourceLayerIndex:B}of e){const U=this.layers[0]._featureFilter.needGeometry,G=dh(w,U);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),G,a))continue;const X=m?m.evaluate(G,{},a,r.availableImages):void 0,Y={id:M,properties:w.properties,type:w.type,sourceLayerIndex:B,index:k,geometry:U?G.geometry:La(w,a,h),patterns:{},sortKey:X};y.push(Y)}m&&y.sort((w,M)=>w.sortKey-M.sortKey);for(const w of y){const{geometry:M,index:k,sourceLayerIndex:B}=w;if(this.hasPattern){const U=ng("fill",this.layers,w,this.zoom,r);this.patternFeatures.push(U)}else this.addFeature(w,M,k,a,{},r.availableImages);r.featureIndex.insert(e[k].feature,M,k,B,this.index)}}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}addFeatures(e,r,a,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,r,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cv),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,a,h,m,y=[]){for(const w of Dp(r,500)){let M=0;for(const Y of w)M+=Y.length;const k=this.segments.prepareSegment(M,this.layoutVertexArray,this.indexArray),B=k.vertexLength,U=[],G=[];for(const Y of w){if(Y.length===0)continue;Y!==w[0]&&G.push(U.length/2);const ie=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),de=ie.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(de+Y.length-1,de),U.push(Y[0].x),U.push(Y[0].y);for(let Ee=1;Ee<Y.length;Ee++)this.layoutVertexArray.emplaceBack(Y[Ee].x,Y[Ee].y),this.indexArray2.emplaceBack(de+Ee-1,de+Ee),U.push(Y[Ee].x),U.push(Y[Ee].y);ie.vertexLength+=Y.length,ie.primitiveLength+=Y.length}const X=ig(U,G);for(let Y=0;Y<X.length;Y+=3)this.indexArray.emplaceBack(B+X[Y],B+X[Y+1],B+X[Y+2]);k.vertexLength+=M,k.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}}yi(cf,"FillBucket",{omit:["layers","patternFeatures"]});const _v=new Ie({"fill-sort-key":new pe(wt.layout_fill["fill-sort-key"])});var yv={paint:new Ie({"fill-antialias":new ee(wt.paint_fill["fill-antialias"]),"fill-opacity":new pe(wt.paint_fill["fill-opacity"]),"fill-color":new pe(wt.paint_fill["fill-color"]),"fill-outline-color":new pe(wt.paint_fill["fill-outline-color"]),"fill-translate":new ee(wt.paint_fill["fill-translate"]),"fill-translate-anchor":new ee(wt.paint_fill["fill-translate-anchor"]),"fill-pattern":new pe(wt.paint_fill["fill-pattern"])}),layout:_v};const xv=et([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),vv=et([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Z_=et([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Y_}=xv;var Op={},bv=ke,sg=Au;function Au(i,e,r,a,h){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=a,this._values=h,i.readFields(K_,this,e)}function K_(i,e,r){i==1?e.id=r.readVarint():i==2?function(a,h){for(var m=a.readVarint()+a.pos;a.pos<m;){var y=h._keys[a.readVarint()],w=h._values[a.readVarint()];h.properties[y]=w}}(r,e):i==3?e.type=r.readVarint():i==4&&(e._geometry=r.pos)}function wv(i){for(var e,r,a=0,h=0,m=i.length,y=m-1;h<m;y=h++)a+=((r=i[y]).x-(e=i[h]).x)*(e.y+r.y);return a}Au.types=["Unknown","Point","LineString","Polygon"],Au.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,r=i.readVarint()+i.pos,a=1,h=0,m=0,y=0,w=[];i.pos<r;){if(h<=0){var M=i.readVarint();a=7&M,h=M>>3}if(h--,a===1||a===2)m+=i.readSVarint(),y+=i.readSVarint(),a===1&&(e&&w.push(e),e=[]),e.push(new bv(m,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&w.push(e),w},Au.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,r=1,a=0,h=0,m=0,y=1/0,w=-1/0,M=1/0,k=-1/0;i.pos<e;){if(a<=0){var B=i.readVarint();r=7&B,a=B>>3}if(a--,r===1||r===2)(h+=i.readSVarint())<y&&(y=h),h>w&&(w=h),(m+=i.readSVarint())<M&&(M=m),m>k&&(k=m);else if(r!==7)throw new Error("unknown command "+r)}return[y,M,w,k]},Au.prototype.toGeoJSON=function(i,e,r){var a,h,m=this.extent*Math.pow(2,r),y=this.extent*i,w=this.extent*e,M=this.loadGeometry(),k=Au.types[this.type];function B(X){for(var Y=0;Y<X.length;Y++){var ie=X[Y];X[Y]=[360*(ie.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ie.y+w)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(a=0;a<M.length;a++)U[a]=M[a][0];B(M=U);break;case 2:for(a=0;a<M.length;a++)B(M[a]);break;case 3:for(M=function(X){var Y=X.length;if(Y<=1)return[X];for(var ie,de,Ee=[],Re=0;Re<Y;Re++){var Se=wv(X[Re]);Se!==0&&(de===void 0&&(de=Se<0),de===Se<0?(ie&&Ee.push(ie),ie=[X[Re]]):ie.push(X[Re]))}return ie&&Ee.push(ie),Ee}(M),a=0;a<M.length;a++)for(h=0;h<M[a].length;h++)B(M[a][h])}M.length===1?M=M[0]:k="Multi"+k;var G={type:"Feature",geometry:{type:k,coordinates:M},properties:this.properties};return"id"in this&&(G.id=this.id),G};var J_=sg,og=Q_;function Q_(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(ey,this,e),this.length=this._features.length}function ey(i,e,r){i===15?e.version=r.readVarint():i===1?e.name=r.readString():i===5?e.extent=r.readVarint():i===2?e._features.push(r.pos):i===3?e._keys.push(r.readString()):i===4&&e._values.push(function(a){for(var h=null,m=a.readVarint()+a.pos;a.pos<m;){var y=a.readVarint()>>3;h=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return h}(r))}Q_.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new J_(this._pbf,e,this.extent,this._keys,this._values)};var Tv=og;function ag(i,e,r){if(i===3){var a=new Tv(r,r.readVarint()+r.pos);a.length&&(e[a.name]=a)}}var lg=Op.VectorTile=function(i,e){this.layers=i.readFields(ag,{},e)},hf=Op.VectorTileFeature=sg;function uf(i,e,r,a){const h=[],m=a===0?(y,w,M,k,B,U)=>{y.push(new He(U,M+(U-w)/(k-w)*(B-M)))}:(y,w,M,k,B,U)=>{y.push(new He(w+(U-M)/(B-M)*(k-w),U))};for(const y of i){const w=[];for(const M of y){if(M.length<=2)continue;const k=[];for(let G=0;G<M.length-1;G++){const X=M[G].x,Y=M[G].y,ie=M[G+1].x,de=M[G+1].y,Ee=a===0?X:Y,Re=a===0?ie:de;Ee<e?Re>e&&m(k,X,Y,ie,de,e):Ee>r?Re<r&&m(k,X,Y,ie,de,r):k.push(M[G]),Re<e&&Ee>=e&&m(k,X,Y,ie,de,e),Re>r&&Ee<=r&&m(k,X,Y,ie,de,r)}let B=M[M.length-1];const U=a===0?B.x:B.y;U>=e&&U<=r&&k.push(B),k.length&&(B=k[k.length-1],k[0].x===B.x&&k[0].y===B.y||k.push(k[0]),w.push(k))}w.length&&h.push(w)}return h}Op.VectorTileLayer=og;const Ev=hf.types,Sv=Math.pow(2,13);function mh(i,e,r,a,h,m,y,w){i.emplaceBack((e<<1)+y,(r<<1)+m,(Math.floor(a*Sv)<<1)+h,Math.round(w))}function df(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class ty{constructor(){this.acc=new He(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new He(e.x,e.y),this.max=new He(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,h=this.max;e.x<a.x?a.x=e.x:e.x>h.x&&(h.x=e.x),e.y<a.y?a.y=e.y:e.y>h.y&&(h.y=e.y),((e.x===0||e.x===Mi)&&e.x===r.x)!=((e.y===0||e.y===Mi)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,mr(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>Mi!=e.x>Mi&&this.addBorderIntersection(1,mr(r.y,e.y,(Mi-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,mr(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>Mi!=e.y>Mi&&this.addBorderIntersection(3,mr(r.x,e.x,(Mi-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];r<a[0]&&(a[0]=r),r>a[1]&&(a[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const a=e.x===0?0:1;this.addBorderIntersection(a,r.y),this.addBorderIntersection(a,e.y)}else{const a=e.y===0?2:3;this.addBorderIntersection(a,r.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((r,a)=>r+a.edges,0);return e!==0?this.acc.div(e)._round():new He(0,0)}span(){return new He(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class ff{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Ct,this.centroidVertexArray=new Ko,this.indexArray=new Ai,this.programConfigurations=new mc(e.layers,e.zoom),this.segments=new In,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,a,h){this.features=[],this.hasPattern=rg("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const y=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*y/(y*y+1)/Mi/(1<<m.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:y,index:w,sourceLayerIndex:M}of e){const k=this.layers[0]._featureFilter.needGeometry,B=dh(m,k);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),B,a))continue;const U={id:y,sourceLayerIndex:M,index:w,geometry:k?B.geometry:La(m,a,h),properties:m.properties,type:m.type,patterns:{}},G=this.layoutVertexArray.length;this.hasPattern?this.features.push(ng("fill-extrusion",this.layers,U,this.zoom,r)):this.addFeature(U,U.geometry,w,a,{},r.availableImages,h),r.featureIndex.insert(m,U.geometry,w,M,this.index,G)}this.sortBorders()}addFeatures(e,r,a,h,m){for(const y of this.features){const{geometry:w}=y;this.addFeature(y,w,y.index,r,a,h,m)}this.sortBorders()}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Y_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Z_.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,vv.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,a,h,m,y,w){const M=[new He(0,0),new He(Mi,Mi)],k=w.projection,B=k.name==="globe",U=this.enableTerrain&&!B?new ty:null,G=Ev[e.type]==="Polygon";B&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Gt);const X=Dp(r,500);for(let Ee=X.length-1;Ee>=0;Ee--){const Re=X[Ee];(Re.length===0||(Y=Re[0]).every(Se=>Se.x<=0)||Y.every(Se=>Se.x>=Mi)||Y.every(Se=>Se.y<=0)||Y.every(Se=>Se.y>=Mi))&&X.splice(Ee,1)}var Y;let ie;if(B)ie=cg(X,M,h);else{ie=[];for(const Ee of X)ie.push({polygon:Ee,bounds:M})}const de=G?this.edgeRadius:0;for(const{polygon:Ee,bounds:Re}of ie){let Se=0,De=0;for(const Be of Ee)G&&!Be[0].equals(Be[Be.length-1])&&Be.push(Be[0]),De+=G?Be.length-1:Be.length;const Ue=this.segments.prepareSegment((G?5:4)*De,this.layoutVertexArray,this.indexArray);if(G){const Be=[],_t=[];Se=Ue.vertexLength;for(const St of Ee){let Zt,xt;St.length&&St!==Ee[0]&&_t.push(Be.length/2),Zt=St[1].sub(St[0])._perp()._unit();for(let Ot=1;Ot<St.length;Ot++){const Rt=St[Ot],Ut=St[Ot===St.length-1?1:Ot+1];let{x:ei,y:Tt}=Rt;if(de){xt=Ut.sub(Rt)._perp()._unit();const ai=Zt.add(xt)._unit(),Ti=de*Math.min(4,1/(Zt.x*ai.x+Zt.y*ai.y));ei+=Ti*ai.x,Tt+=Ti*ai.y,Zt=xt}mh(this.layoutVertexArray,ei,Tt,0,0,1,1,0),Ue.vertexLength++,Be.push(Rt.x,Rt.y),B&&df(this.layoutVertexExtArray,k.projectTilePoint(ei,Tt,h),k.upVector(h,ei,Tt))}}const ft=ig(Be,_t);for(let St=0;St<ft.length;St+=3)this.indexArray.emplaceBack(Se+ft[St],Se+ft[St+2],Se+ft[St+1]),Ue.primitiveLength++}for(const Be of Ee){U&&Be.length&&U.startRing(Be[0]);let _t,ft,St,Zt=Be.length>4&&ny(Be[Be.length-2],Be[0],Be[1]),xt=de?Cv(Be[Be.length-2],Be[0],Be[1],de):0;ft=Be[1].sub(Be[0])._perp()._unit();let Ot=!0;for(let Rt=1,Ut=0;Rt<Be.length;Rt++){let ei=Be[Rt-1],Tt=Be[Rt];const ai=Be[Rt===Be.length-1?1:Rt+1];if(U&&G&&U.currentPolyCount.top++,pf(Tt,ei,Re)){de&&(ft=ai.sub(Tt)._perp()._unit(),Ot=!Ot);continue}U&&U.append(Tt,ei);const Ti=Tt.sub(ei)._perp(),di=Ti.x/(Math.abs(Ti.x)+Math.abs(Ti.y)),Xi=Ti.y>0?1:0,ti=ei.dist(Tt);if(Ut+ti>32768&&(Ut=0),de){St=ai.sub(Tt)._perp()._unit();let Yi=ry(ei,Tt,ai,iy(ft,St),de);isNaN(Yi)&&(Yi=0);const Bi=Tt.sub(ei)._unit();ei=ei.add(Bi.mult(xt))._round(),Tt=Tt.add(Bi.mult(-Yi))._round(),xt=Yi,ft=St}const Di=Ue.vertexLength,Zi=Be.length>4&&ny(ei,Tt,ai);let Sr=sy(Ut,Zt,Ot);if(mh(this.layoutVertexArray,ei.x,ei.y,di,Xi,0,0,Sr),mh(this.layoutVertexArray,ei.x,ei.y,di,Xi,0,1,Sr),Ut+=ti,Sr=sy(Ut,Zi,!Ot),Zt=Zi,mh(this.layoutVertexArray,Tt.x,Tt.y,di,Xi,0,0,Sr),mh(this.layoutVertexArray,Tt.x,Tt.y,di,Xi,0,1,Sr),Ue.vertexLength+=4,this.indexArray.emplaceBack(Di+0,Di+1,Di+2),this.indexArray.emplaceBack(Di+1,Di+3,Di+2),Ue.primitiveLength+=2,de){const Yi=Se+(Rt===1?Be.length-2:Rt-2),Bi=Rt===1?Se:Yi+1;if(this.indexArray.emplaceBack(Di+1,Yi,Di+3),this.indexArray.emplaceBack(Yi,Bi,Di+3),Ue.primitiveLength+=2,_t===void 0&&(_t=Di),!pf(ai,Be[Rt],Re)){const ln=Rt===Be.length-1?_t:Ue.vertexLength;this.indexArray.emplaceBack(Di+2,Di+3,ln),this.indexArray.emplaceBack(Di+3,ln+1,ln),this.indexArray.emplaceBack(Di+3,Bi,ln+1),Ue.primitiveLength+=3}Ot=!Ot}if(B){const Yi=this.layoutVertexExtArray,Bi=k.projectTilePoint(ei.x,ei.y,h),ln=k.projectTilePoint(Tt.x,Tt.y,h),Qi=k.upVector(h,ei.x,ei.y),er=k.upVector(h,Tt.x,Tt.y);df(Yi,Bi,Qi),df(Yi,Bi,Qi),df(Yi,ln,er),df(Yi,ln,er)}}G&&(Se+=Be.length-1)}}if(U&&U.polyCount.length>0){if(U.borders){U.vertexArrayOffset=this.centroidVertexArray.length;const Ee=U.borders,Re=this.featuresOnBorder.push(U)-1;for(let Se=0;Se<4;Se++)Ee[Se][0]!==Number.MAX_VALUE&&this.borders[Se].push(Re)}this.encodeCentroid(U.borders?void 0:U.centroid(),U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,a)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,r,a=!0){let h,m;if(e)if(e.y!==0){const w=r.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(w.x/10)),m=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else h=Math.ceil(7*(e.x+450)),m=0;else h=0,m=+a;let y=a?this.centroidVertexArray.length:r.vertexArrayOffset;for(const w of r.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let M=0;M<w.top;M++)this.centroidVertexArray.emplace(y++,h,m);for(let M=0;M<2*w.edges;M++)this.centroidVertexArray.emplace(y++,0,m),this.centroidVertexArray.emplace(y++,h,m)}}}function iy(i,e){const r=i.add(e)._unit();return i.x*r.x+i.y*r.y}function Cv(i,e,r,a){const h=e.sub(i)._perp()._unit(),m=r.sub(e)._perp()._unit();return ry(i,e,r,iy(h,m),a)}function ry(i,e,r,a,h){const m=Math.sqrt(1-a*a);return Math.min(i.dist(e)/3,e.dist(r)/3,h*m/a)}function pf(i,e,r){return i.x<r[0].x&&e.x<r[0].x||i.x>r[1].x&&e.x>r[1].x||i.y<r[0].y&&e.y<r[0].y||i.y>r[1].y&&e.y>r[1].y}function ny(i,e,r){if(i.x<0||i.x>=Mi||e.x<0||e.x>=Mi||r.x<0||r.x>=Mi)return!1;const a=r.sub(e),h=a.perp(),m=i.sub(e);return(a.x*m.x+a.y*m.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(m.x*m.x+m.y*m.y))>-.866&&h.x*m.x+h.y*m.y<0}function sy(i,e,r){const a=e?2|i:-3&i;return r?1|a:-2&a}function oy(){const i=Math.PI/32,e=Math.tan(i),r=Yd;return r*Math.sqrt(1+2*e*e)-r}function cg(i,e,r){const a=1<<r.z,h=ko(r.x/a),m=ko((r.x+1)/a),y=vs(r.y/a),w=vs((r.y+1)/a);return function(M,k,B,U,G=0,X){const Y=[];if(!M.length||!B||!U)return Y;const ie=(Be,_t)=>{for(const ft of Be)Y.push({polygon:ft,bounds:_t})},de=Math.ceil(Math.log2(B)),Ee=Math.ceil(Math.log2(U)),Re=de-Ee,Se=[];for(let Be=0;Be<Math.abs(Re);Be++)Se.push(Re>0?0:1);for(let Be=0;Be<Math.min(de,Ee);Be++)Se.push(0),Se.push(1);let De=M;if(De=uf(De,k[0].y-G,k[1].y+G,1),De=uf(De,k[0].x-G,k[1].x+G,0),!De.length)return Y;const Ue=[];for(Se.length?Ue.push({polygons:De,bounds:k,depth:0}):ie(De,k);Ue.length;){const Be=Ue.pop(),_t=Be.depth,ft=Se[_t],St=Be.bounds[0],Zt=Be.bounds[1],xt=ft===0?St.x:St.y,Ot=ft===0?Zt.x:Zt.y,Rt=X?X(ft,xt,Ot):.5*(xt+Ot),Ut=uf(Be.polygons,xt-G,Rt+G,ft),ei=uf(Be.polygons,Rt-G,Ot+G,ft);if(Ut.length){const Tt=[St,new He(ft===0?Rt:Zt.x,ft===1?Rt:Zt.y)];Se.length>_t+1?Ue.push({polygons:Ut,bounds:Tt,depth:_t+1}):ie(Ut,Tt)}if(ei.length){const Tt=[new He(ft===0?Rt:St.x,ft===1?Rt:St.y),Zt];Se.length>_t+1?Ue.push({polygons:ei,bounds:Tt,depth:_t+1}):ie(ei,Tt)}}return Y}(i,e,Math.ceil((m-h)/11.25),Math.ceil((y-w)/11.25),1,(M,k,B)=>{if(M===0)return .5*(k+B);{const U=vs((r.y+k/Mi)/a);return(ta(.5*(vs((r.y+B/Mi)/a)+U))*a-r.y)*Mi}})}yi(ff,"FillExtrusionBucket",{omit:["layers","features"]}),yi(ty,"PartMetadata");const R=new Ie({"fill-extrusion-edge-radius":new ee(wt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var o={paint:new Ie({"fill-extrusion-opacity":new ee(wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pe(wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ee(wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ee(wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new pe(wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pe(wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pe(wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ee(wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ee(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ee(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ee(wt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:R};function u(i,e,r){var a=2*Math.PI*6378137/256/Math.pow(2,r);return[i*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class p{constructor(e,r,a){this.z=e,this.x=r,this.y=a,this.key=S(0,e,e,r,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const a=function(m,y,w){var M=u(256*m,256*(y=Math.pow(2,w)-y-1),w),k=u(256*(m+1),256*(y+1),w);return M[0]+","+M[1]+","+k[0]+","+k[1]}(this.x,this.y,this.z),h=function(m,y,w){let M,k="";for(let B=m;B>0;B--)M=1<<B-1,k+=(y&M?1:0)+(w&M?2:0);return k}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class x{constructor(e,r){this.wrap=e,this.canonical=r,this.key=S(e,r.z,r.z,r.x,r.y)}}class v{constructor(e,r,a,h,m){this.overscaledZ=e,this.wrap=r,this.canonical=new p(a,+h,+m),this.key=r===0&&e===a?this.canonical.key:S(r,e,a,h,m)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new v(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new v(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return S(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return S(this.wrap*+r,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new v(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new v(r,this.wrap,r,a,h),new v(r,this.wrap,r,a+1,h),new v(r,this.wrap,r,a,h+1),new v(r,this.wrap,r,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new v(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new v(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new x(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function S(i,e,r,a,h){const m=1<<Math.min(r,22);let y=m*(h%m)+a%m;return i&&r<22&&(y+=m*m*((i<0?-2*i-1:2*i)%(1<<2*(22-r)))),16*(32*y+r)+(e-r)}yi(p,"CanonicalTileID"),yi(v,"OverscaledTileID",{omit:["projMatrix"]});class A extends He{constructor(e,r,a){super(e,r),this.z=a}}function I(i,e){return i.x*e.x+i.y*e.y}function O(i,e){if(i.length===1){let r=0;const a=e[r++];let h;for(;!h||a.equals(h);)if(h=e[r++],!h)return 1/0;for(;r<e.length;r++){const m=e[r],y=i[0],w=h.sub(a),M=m.sub(a),k=y.sub(a),B=I(w,w),U=I(w,M),G=I(M,M),X=I(k,w),Y=I(k,M),ie=B*G-U*U,de=(G*X-U*Y)/ie,Ee=(B*Y-U*X)/ie,Re=a.z*(1-de-Ee)+h.z*de+m.z*Ee;if(isFinite(Re))return Re}return 1/0}{let r=1/0;for(const a of e)r=Math.min(r,a.z);return r}}function N(i,e,r,a,h,m,y,w){const M=y*h.getElevationAt(i,e,!0,!0),k=m[0]!==0,B=k?m[1]===0?y*(m[0]/7-450):y*function(U,G,X){const Y=Math.floor(G[0]/8),ie=Math.floor(G[1]/8),de=10*(G[0]-8*Y),Ee=10*(G[1]-8*ie),Re=U.getElevationAt(Y,ie,!0,!0),Se=U.getMeterToDEM(X),De=Math.floor(.5*(de*Se-1)),Ue=Math.floor(.5*(Ee*Se-1)),Be=U.tileCoordToPixel(Y,ie),_t=2*De+1,ft=2*Ue+1,St=function(ei,Tt,ai,Ti,di){return[ei.getElevationAtPixel(Tt,ai,!0),ei.getElevationAtPixel(Tt+di,ai,!0),ei.getElevationAtPixel(Tt,ai+di,!0),ei.getElevationAtPixel(Tt+Ti,ai+di,!0)]}(U,Be.x-De,Be.y-Ue,_t,ft),Zt=Math.abs(St[0]-St[1]),xt=Math.abs(St[2]-St[3]),Ot=Math.abs(St[0]-St[2])+Math.abs(St[1]-St[3]),Rt=Math.min(.25,.5*Se*(Zt+xt)/_t),Ut=Math.min(.25,.5*Se*Ot/ft);return Re+Math.max(Rt*de,Ut*Ee)}(h,m,w):M;return{base:M+(r===0)?-1:r,top:k?Math.max(B+a,M+r+2):M+a}}const z=et([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:j}=z,q=et([{name:"a_packed",components:4,type:"Float32"}]),{members:K}=q,se=hf.types,re=Math.cos(Math.PI/180*37.5);class te{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new yt,this.layoutVertexArray2=new jt,this.indexArray=new Ai,this.programConfigurations=new mc(e.layers,e.zoom),this.segments=new In,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a,h){this.hasPattern=rg("line",this.layers,r);const m=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:B,id:U,index:G,sourceLayerIndex:X}of e){const Y=this.layers[0]._featureFilter.needGeometry,ie=dh(B,Y);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),ie,a))continue;const de=m?m.evaluate(ie,{},a):void 0,Ee={id:U,properties:B.properties,type:B.type,sourceLayerIndex:X,index:G,geometry:Y?ie.geometry:La(B,a,h),patterns:{},sortKey:de};y.push(Ee)}m&&y.sort((B,U)=>B.sortKey-U.sortKey);const{lineAtlas:w,featureIndex:M}=r,k=this.addConstantDashes(w);for(const B of y){const{geometry:U,index:G,sourceLayerIndex:X}=B;if(k&&this.addFeatureDashes(B,w),this.hasPattern){const Y=ng("line",this.layers,B,this.zoom,r);this.patternFeatures.push(Y)}else this.addFeature(B,U,G,a,w.positions,r.availableImages);M.insert(e[G].feature,U,G,X,this.index)}}addConstantDashes(e){let r=!1;for(const a of this.layers){const h=a.paint.get("line-dasharray").value,m=a.layout.get("line-cap").value;if(h.kind!=="constant"||m.kind!=="constant")r=!0;else{const y=m.value,w=h.value;if(!w)continue;e.addDash(w,y)}}return r}addFeatureDashes(e,r){const a=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if(m.kind==="constant"&&y.kind==="constant")continue;let w,M;if(m.kind==="constant"){if(w=m.value,!w)continue}else w=m.evaluate({zoom:a},e);M=y.kind==="constant"?y.value:y.evaluate({zoom:a},e),r.addDash(w,M),e.patterns[h.id]=r.getKey(w,M)}}update(e,r,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a,h)}addFeatures(e,r,a,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,r,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,K)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,a,h,m,y){const w=this.layers[0].layout,M=w.get("line-join").evaluate(e,{}),k=w.get("line-cap").evaluate(e,{}),B=w.get("line-miter-limit"),U=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const G of r)this.addLine(G,e,M,k,B,U);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}addLine(e,r,a,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ee=0;Ee<e.length-1;Ee++)this.totalDistance+=e[Ee].dist(e[Ee+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=se[r.type]==="Polygon";let M=e.length;for(;M>=2&&e[M-1].equals(e[M-2]);)M--;let k=0;for(;k<M-1&&e[k].equals(e[k+1]);)k++;if(M<(w?3:2))return;a==="bevel"&&(m=1.05);const B=this.overscaling<=16?15*Mi/(512*this.overscaling):0,U=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let G,X,Y,ie,de;this.e1=this.e2=-1,w&&(G=e[M-2],de=e[k].sub(G)._unit()._perp());for(let Ee=k;Ee<M;Ee++){if(Y=Ee===M-1?w?e[k+1]:void 0:e[Ee+1],Y&&e[Ee].equals(Y))continue;de&&(ie=de),G&&(X=G),G=e[Ee],de=Y?Y.sub(G)._unit()._perp():ie,ie=ie||de;let Re=ie.add(de);Re.x===0&&Re.y===0||Re._unit();const Se=ie.x*de.x+ie.y*de.y,De=Re.x*de.x+Re.y*de.y,Ue=De!==0?1/De:1/0,Be=2*Math.sqrt(2-2*De),_t=De<re&&X&&Y,ft=ie.x*de.y-ie.y*de.x>0;if(_t&&Ee>k){const xt=G.dist(X);if(xt>2*B){const Ot=G.sub(G.sub(X)._mult(B/xt)._round());this.updateDistance(X,Ot),this.addCurrentVertex(Ot,ie,0,0,U),X=Ot}}const St=X&&Y;let Zt=St?a:w?"butt":h;if(St&&Zt==="round"&&(Ue<y?Zt="miter":Ue<=2&&(Zt="fakeround")),Zt==="miter"&&Ue>m&&(Zt="bevel"),Zt==="bevel"&&(Ue>2&&(Zt="flipbevel"),Ue<m&&(Zt="miter")),X&&this.updateDistance(X,G),Zt==="miter")Re._mult(Ue),this.addCurrentVertex(G,Re,0,0,U);else if(Zt==="flipbevel"){if(Ue>100)Re=de.mult(-1);else{const xt=Ue*ie.add(de).mag()/ie.sub(de).mag();Re._perp()._mult(xt*(ft?-1:1))}this.addCurrentVertex(G,Re,0,0,U),this.addCurrentVertex(G,Re.mult(-1),0,0,U)}else if(Zt==="bevel"||Zt==="fakeround"){const xt=-Math.sqrt(Ue*Ue-1),Ot=ft?xt:0,Rt=ft?0:xt;if(X&&this.addCurrentVertex(G,ie,Ot,Rt,U),Zt==="fakeround"){const Ut=Math.round(180*Be/Math.PI/20);for(let ei=1;ei<Ut;ei++){let Tt=ei/Ut;if(Tt!==.5){const Ti=Tt-.5;Tt+=Tt*Ti*(Tt-1)*((1.0904+Se*(Se*(3.55645-1.43519*Se)-3.2452))*Ti*Ti+(.848013+Se*(.215638*Se-1.06021)))}const ai=de.sub(ie)._mult(Tt)._add(ie)._unit()._mult(ft?-1:1);this.addHalfVertex(G,ai.x,ai.y,!1,ft,0,U)}}Y&&this.addCurrentVertex(G,de,-Ot,-Rt,U)}else if(Zt==="butt")this.addCurrentVertex(G,Re,0,0,U);else if(Zt==="square"){const xt=X?1:-1;X||this.addCurrentVertex(G,Re,xt,xt,U),this.addCurrentVertex(G,Re,0,0,U),X&&this.addCurrentVertex(G,Re,xt,xt,U)}else Zt==="round"&&(X&&(this.addCurrentVertex(G,ie,0,0,U),this.addCurrentVertex(G,ie,1,1,U,!0)),Y&&(this.addCurrentVertex(G,de,-1,-1,U,!0),this.addCurrentVertex(G,de,0,0,U)));if(_t&&Ee<M-1){const xt=G.dist(Y);if(xt>2*B){const Ot=G.add(Y.sub(G)._mult(B/xt)._round());this.updateDistance(G,Ot),this.addCurrentVertex(Ot,de,0,0,U),G=Ot}}}}addCurrentVertex(e,r,a,h,m,y=!1){const w=r.y*h-r.x,M=-r.y-r.x*h;this.addHalfVertex(e,r.x+r.y*a,r.y-r.x*a,y,!1,a,m),this.addHalfVertex(e,w,M,y,!0,-h,m)}addHalfVertex({x:e,y:r},a,h,m,y,w,M){this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(r<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(w===0?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),M.primitiveLength++),y?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}yi(te,"LineBucket",{omit:["layers","patternFeatures"]});const ce=new Ie({"line-cap":new pe(wt.layout_line["line-cap"]),"line-join":new pe(wt.layout_line["line-join"]),"line-miter-limit":new ee(wt.layout_line["line-miter-limit"]),"line-round-limit":new ee(wt.layout_line["line-round-limit"]),"line-sort-key":new pe(wt.layout_line["line-sort-key"])});var fe={paint:new Ie({"line-opacity":new pe(wt.paint_line["line-opacity"]),"line-color":new pe(wt.paint_line["line-color"]),"line-translate":new ee(wt.paint_line["line-translate"]),"line-translate-anchor":new ee(wt.paint_line["line-translate-anchor"]),"line-width":new pe(wt.paint_line["line-width"]),"line-gap-width":new pe(wt.paint_line["line-gap-width"]),"line-offset":new pe(wt.paint_line["line-offset"]),"line-blur":new pe(wt.paint_line["line-blur"]),"line-dasharray":new pe(wt.paint_line["line-dasharray"]),"line-pattern":new pe(wt.paint_line["line-pattern"]),"line-gradient":new Ce(wt.paint_line["line-gradient"]),"line-trim-offset":new ee(wt.paint_line["line-trim-offset"])}),layout:ce};const Xe=new class extends pe{possiblyEvaluate(i,e){return e=new F(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,r,a){return e=fr({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,r,a)}}(fe.paint.properties["line-width"].specification);function Ne(i,e){return e>0?e+2*i:i}Xe.useIntegerZoom=!0;const $e=et([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mt=et([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),tt=et([{name:"a_projected_pos",components:4,type:"Float32"}],4);et([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gt=et([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Bt=et([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);et([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Jt=et([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ii=et([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);et([{name:"triangle",components:3,type:"Uint16"}]),et([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),et([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),et([{type:"Float32",name:"offsetX"}]),et([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ft=24;const ui=128;function gi(i,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new F(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=r;let m=0;for(;m<a.length&&a[m]<=i;)m++;m=Math.max(0,m-1);let y=m;for(;y<a.length&&a[y]<i+1;)y++;y=Math.min(a.length-1,y);const w=a[m],M=a[y];return r.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:M,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:M,minSize:r.evaluate(new F(w)),maxSize:r.evaluate(new F(M)),interpolationType:h}}}function Ui(i,{uSize:e,uSizeT:r},{lowerSize:a,upperSize:h}){return i.kind==="source"?a/ui:i.kind==="composite"?mr(a/ui,h/ui,r):e}function wi(i,e){let r=0,a=0;if(i.kind==="constant")a=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=i,w=h?vi(eo.interpolationFactor(h,e,m,y),0,1):0;i.kind==="camera"?a=mr(i.minSize,i.maxSize,w):r=w}return{uSizeT:r,uSize:a}}var ji=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ui,evaluateSizeForFeature:Ui,evaluateSizeForZoom:wi,getSizeData:gi});function _r(i,e,r){return i.sections.forEach(a=>{a.text=function(h,m,y){const w=m.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),D.applyArabicShaping&&(h=D.applyArabicShaping(h)),h}(a.text,e,r)}),i}const lr={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function br(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function Cs(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}var yr=pi,Br=function(i,e,r,a,h){var m,y,w=8*h-a-1,M=(1<<w)-1,k=M>>1,B=-7,U=h-1,G=-1,X=i[e+U];for(U+=G,m=X&(1<<-B)-1,X>>=-B,B+=w;B>0;m=256*m+i[e+U],U+=G,B-=8);for(y=m&(1<<-B)-1,m>>=-B,B+=a;B>0;y=256*y+i[e+U],U+=G,B-=8);if(m===0)m=1-k;else{if(m===M)return y?NaN:1/0*(X?-1:1);y+=Math.pow(2,a),m-=k}return(X?-1:1)*y*Math.pow(2,m-a)},qi=function(i,e,r,a,h,m){var y,w,M,k=8*m-h-1,B=(1<<k)-1,U=B>>1,G=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=0,Y=1,ie=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,y=B):(y=Math.floor(Math.log(e)/Math.LN2),e*(M=Math.pow(2,-y))<1&&(y--,M*=2),(e+=y+U>=1?G/M:G*Math.pow(2,1-U))*M>=2&&(y++,M/=2),y+U>=B?(w=0,y=B):y+U>=1?(w=(e*M-1)*Math.pow(2,h),y+=U):(w=e*Math.pow(2,U-1)*Math.pow(2,h),y=0));h>=8;i[r+X]=255&w,X+=Y,w/=256,h-=8);for(y=y<<h|w,k+=h;k>0;i[r+X]=255&y,X+=Y,y/=256,k-=8);i[r+X-Y]|=128*ie};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function pi(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}pi.Varint=0,pi.Fixed64=1,pi.Bytes=2,pi.Fixed32=5;var kn=4294967296,Fr=1/kn,Jr=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function an(i){return i.type===pi.Bytes?i.readVarint()+i.pos:i.pos+1}function co(i,e,r){return r?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Lo(i,e,r){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(a);for(var h=r.pos-1;h>=i;h--)r.buf[h+a]=r.buf[h]}function ia(i,e){for(var r=0;r<i.length;r++)e.writeVarint(i[r])}function qs(i,e){for(var r=0;r<i.length;r++)e.writeSVarint(i[r])}function Xn(i,e){for(var r=0;r<i.length;r++)e.writeFloat(i[r])}function mf(i,e){for(var r=0;r<i.length;r++)e.writeDouble(i[r])}function Tc(i,e){for(var r=0;r<i.length;r++)e.writeBoolean(i[r])}function gh(i,e){for(var r=0;r<i.length;r++)e.writeFixed32(i[r])}function gf(i,e){for(var r=0;r<i.length;r++)e.writeSFixed32(i[r])}function Da(i,e){for(var r=0;r<i.length;r++)e.writeFixed64(i[r])}function Mu(i,e){for(var r=0;r<i.length;r++)e.writeSFixed64(i[r])}function _f(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function Rp(i,e,r){i[r]=e,i[r+1]=e>>>8,i[r+2]=e>>>16,i[r+3]=e>>>24}function t1(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}pi.prototype={destroy:function(){this.buf=null},readFields:function(i,e,r){for(r=r||this.length;this.pos<r;){var a=this.readVarint(),h=a>>3,m=this.pos;this.type=7&a,i(h,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=_f(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=t1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=_f(this.buf,this.pos)+_f(this.buf,this.pos+4)*kn;return this.pos+=8,i},readSFixed64:function(){var i=_f(this.buf,this.pos)+t1(this.buf,this.pos+4)*kn;return this.pos+=8,i},readFloat:function(){var i=Br(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Br(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,r,a=this.buf;return e=127&(r=a[this.pos++]),r<128?e:(e|=(127&(r=a[this.pos++]))<<7,r<128?e:(e|=(127&(r=a[this.pos++]))<<14,r<128?e:(e|=(127&(r=a[this.pos++]))<<21,r<128?e:function(h,m,y){var w,M,k=y.buf;if(w=(112&(M=k[y.pos++]))>>4,M<128||(w|=(127&(M=k[y.pos++]))<<3,M<128)||(w|=(127&(M=k[y.pos++]))<<10,M<128)||(w|=(127&(M=k[y.pos++]))<<17,M<128)||(w|=(127&(M=k[y.pos++]))<<24,M<128)||(w|=(1&(M=k[y.pos++]))<<31,M<128))return co(h,w,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=a[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Jr?function(r,a,h){return Jr.decode(r.subarray(a,h))}(this.buf,e,i):function(r,a,h){for(var m="",y=a;y<h;){var w,M,k,B=r[y],U=null,G=B>239?4:B>223?3:B>191?2:1;if(y+G>h)break;G===1?B<128&&(U=B):G===2?(192&(w=r[y+1]))==128&&(U=(31&B)<<6|63&w)<=127&&(U=null):G===3?(M=r[y+2],(192&(w=r[y+1]))==128&&(192&M)==128&&((U=(15&B)<<12|(63&w)<<6|63&M)<=2047||U>=55296&&U<=57343)&&(U=null)):G===4&&(M=r[y+2],k=r[y+3],(192&(w=r[y+1]))==128&&(192&M)==128&&(192&k)==128&&((U=(15&B)<<18|(63&w)<<12|(63&M)<<6|63&k)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,G=1):U>65535&&(U-=65536,m+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),m+=String.fromCharCode(U),y+=G}return m}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==pi.Bytes)return i.push(this.readVarint(e));var r=an(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==pi.Bytes)return i.push(this.readSVarint());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==pi.Bytes)return i.push(this.readBoolean());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==pi.Bytes)return i.push(this.readFloat());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==pi.Bytes)return i.push(this.readDouble());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==pi.Bytes)return i.push(this.readFixed32());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==pi.Bytes)return i.push(this.readSFixed32());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==pi.Bytes)return i.push(this.readFixed64());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==pi.Bytes)return i.push(this.readSFixed64());var e=an(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===pi.Varint)for(;this.buf[this.pos++]>127;);else if(e===pi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===pi.Fixed32)this.pos+=4;else{if(e!==pi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Rp(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Rp(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Rp(this.buf,-1&i,this.pos),Rp(this.buf,Math.floor(i*Fr),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Rp(this.buf,-1&i,this.pos),Rp(this.buf,Math.floor(i*Fr),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,r){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(m,y,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)}(a,0,r),function(m,y){var w=(7&m)<<4;y.buf[y.pos++]|=w|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(a,h,m){for(var y,w,M=0;M<h.length;M++){if((y=h.charCodeAt(M))>55295&&y<57344){if(!w){y>56319||M+1===h.length?(a[m++]=239,a[m++]=191,a[m++]=189):w=y;continue}if(y<56320){a[m++]=239,a[m++]=191,a[m++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(a[m++]=239,a[m++]=191,a[m++]=189,w=null);y<128?a[m++]=y:(y<2048?a[m++]=y>>6|192:(y<65536?a[m++]=y>>12|224:(a[m++]=y>>18|240,a[m++]=y>>12&63|128),a[m++]=y>>6&63|128),a[m++]=63&y|128)}return m}(this.buf,i,this.pos);var r=this.pos-e;r>=128&&Lo(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),qi(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),qi(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,e){this.pos++;var r=this.pos;i(e,this);var a=this.pos-r;a>=128&&Lo(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeMessage:function(i,e,r){this.writeTag(i,pi.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,ia,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,qs,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,Tc,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,Xn,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,mf,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,gh,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,gf,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,Da,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,Mu,e)},writeBytesField:function(i,e){this.writeTag(i,pi.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,pi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,pi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,pi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,pi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,pi.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,pi.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,pi.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,pi.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,pi.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};var ay=ge(yr);const Av=3;function mM(i,e,r){e.glyphs=[],i===1&&r.readMessage(gM,e)}function gM(i,e,r){if(i===3){const{id:a,bitmap:h,width:m,height:y,left:w,top:M,advance:k}=r.readMessage(_M,{});e.glyphs.push({id:a,bitmap:new Il({width:m+2*Av,height:y+2*Av},h),metrics:{width:m,height:y,left:w,top:M,advance:k}})}else i===4?e.ascender=r.readSVarint():i===5&&(e.descender=r.readSVarint())}function _M(i,e,r){i===1?e.id=r.readVarint():i===2?e.bitmap=r.readBytes():i===3?e.width=r.readVarint():i===4?e.height=r.readVarint():i===5?e.left=r.readSVarint():i===6?e.top=r.readSVarint():i===7&&(e.advance=r.readVarint())}const yM=Av;function Mv(i){let e=0,r=0;for(const y of i)e+=y.w*y.h,r=Math.max(r,y.w);i.sort((y,w)=>w.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let h=0,m=0;for(const y of i)for(let w=a.length-1;w>=0;w--){const M=a[w];if(!(y.w>M.w||y.h>M.h)){if(y.x=M.x,y.y=M.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===M.w&&y.h===M.h){const k=a.pop();w<a.length&&(a[w]=k)}else y.h===M.h?(M.x+=y.w,M.w-=y.w):y.w===M.w?(M.y+=y.h,M.h-=y.h):(a.push({x:M.x+y.w,y:M.y,w:M.w-y.w,h:y.h}),M.y+=y.h,M.h-=y.h);break}}return{w:h,h:m,fill:e/(h*m)||0}}const Do=1;class Iv{constructor(e,{pixelRatio:r,version:a,stretchX:h,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=h,this.stretchY=m,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+Do,this.paddedRect.y+Do]}get br(){return[this.paddedRect.x+this.paddedRect.w-Do,this.paddedRect.y+this.paddedRect.h-Do]}get displaySize(){return[(this.paddedRect.w-2*Do)/this.pixelRatio,(this.paddedRect.h-2*Do)/this.pixelRatio]}}class i1{constructor(e,r){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(r,h,m);const{w:y,h:w}=Mv(m),M=new lo({width:y||1,height:w||1});for(const k in e){const B=e[k],U=a[k].paddedRect;lo.copy(B.data,M,{x:0,y:0},{x:U.x+Do,y:U.y+Do},B.data)}for(const k in r){const B=r[k],U=h[k].paddedRect,G=U.x+Do,X=U.y+Do,Y=B.data.width,ie=B.data.height;lo.copy(B.data,M,{x:0,y:0},{x:G,y:X},B.data),lo.copy(B.data,M,{x:0,y:ie-1},{x:G,y:X-1},{width:Y,height:1}),lo.copy(B.data,M,{x:0,y:0},{x:G,y:X+ie},{width:Y,height:1}),lo.copy(B.data,M,{x:Y-1,y:0},{x:G-1,y:X},{width:1,height:ie}),lo.copy(B.data,M,{x:0,y:0},{x:G+Y,y:X},{width:1,height:ie})}this.image=M,this.iconPositions=a,this.patternPositions=h}addImages(e,r,a){for(const h in e){const m=e[h],y={x:0,y:0,w:m.data.width+2*Do,h:m.data.height+2*Do};a.push(y),r[h]=new Iv(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),r),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),r)}patchUpdatedImage(e,r,a){if(!e||!r||e.version===r.version)return;e.version=r.version;const[h,m]=e.tl;a.update(r.data,void 0,{x:h,y:m})}}yi(Iv,"ImagePosition"),yi(i1,"ImageAtlas");const Oa={horizontal:1,vertical:2,horizontalOnly:3},r1=-17;class hg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const a=new hg;return a.scale=e||1,a.fontStack=r,a}static forImage(e){const r=new hg;return r.imageName=e,r}}class zp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const a=new zp;for(let h=0;h<e.sections.length;h++){const m=e.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,r)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,a){let h="";for(let m=0;m<r.length;m++){const y=r.charCodeAt(m+1)||null,w=r.charCodeAt(m-1)||null;h+=!a&&(y&&wl(y)&&!lr[r[m+1]]||w&&wl(w)&&!lr[r[m-1]])||!lr[r[m]]?r[m]:lr[r[m]]}return h}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&ly[this.text.charCodeAt(a)];a++)e++;let r=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&ly[this.text.charCodeAt(a)];a--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const a=new zp;return a.text=this.text.substring(e,r),a.sectionIndex=this.sectionIndex.slice(e,r),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(hg.forText(e.scale,e.fontStack||r));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void Lt("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(hg.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function kv(i,e,r,a,h,m,y,w,M,k,B,U,G,X,Y){const ie=zp.fromFeature(i,h);U===Oa.vertical&&ie.verticalizePunctuation(G);let de=[];const Ee=function(Be,_t,ft,St,Zt,xt){if(!Be)return[];const Ot=[],Rt=function(ai,Ti,di,Xi,ti,Di){let Zi=0;for(let Sr=0;Sr<ai.length();Sr++){const Yi=ai.getSection(Sr);Zi+=n1(ai.getCharCode(Sr),Yi,Xi,ti,Ti,Di)}return Zi/Math.max(1,Math.ceil(Zi/di))}(Be,_t,ft,St,Zt,xt),Ut=Be.text.indexOf("")>=0;let ei=0;for(let ai=0;ai<Be.length();ai++){const Ti=Be.getSection(ai),di=Be.getCharCode(ai);if(ly[di]||(ei+=n1(di,Ti,St,Zt,_t,xt)),ai<Be.length()-1){const Xi=!((Tt=di)<11904||!(li["Bopomofo Extended"](Tt)||li.Bopomofo(Tt)||li["CJK Compatibility Forms"](Tt)||li["CJK Compatibility Ideographs"](Tt)||li["CJK Compatibility"](Tt)||li["CJK Radicals Supplement"](Tt)||li["CJK Strokes"](Tt)||li["CJK Symbols and Punctuation"](Tt)||li["CJK Unified Ideographs Extension A"](Tt)||li["CJK Unified Ideographs"](Tt)||li["Enclosed CJK Letters and Months"](Tt)||li["Halfwidth and Fullwidth Forms"](Tt)||li.Hiragana(Tt)||li["Ideographic Description Characters"](Tt)||li["Kangxi Radicals"](Tt)||li["Katakana Phonetic Extensions"](Tt)||li.Katakana(Tt)||li["Vertical Forms"](Tt)||li["Yi Radicals"](Tt)||li["Yi Syllables"](Tt)));(xM[di]||Xi||Ti.imageName)&&Ot.push(o1(ai+1,ei,Rt,Ot,vM(di,Be.getCharCode(ai+1),Xi&&Ut),!1))}}var Tt;return a1(o1(Be.length(),ei,Rt,Ot,0,!0))}(ie,k,m,e,a,X),{processBidirectionalText:Re,processStyledBidirectionalText:Se}=D;if(Re&&ie.sections.length===1){const Be=Re(ie.toString(),Ee);for(const _t of Be){const ft=new zp;ft.text=_t,ft.sections=ie.sections;for(let St=0;St<_t.length;St++)ft.sectionIndex.push(0);de.push(ft)}}else if(Se){const Be=Se(ie.text,ie.sectionIndex,Ee);for(const _t of Be){const ft=new zp;ft.text=_t[0],ft.sectionIndex=_t[1],ft.sections=ie.sections,de.push(ft)}}else de=function(Be,_t){const ft=[],St=Be.text;let Zt=0;for(const xt of _t)ft.push(Be.substring(Zt,xt)),Zt=xt;return Zt<St.length&&ft.push(Be.substring(Zt,St.length)),ft}(ie,Ee);const De=[],Ue={positionedLines:De,text:ie.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:U,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Be,_t,ft,St,Zt,xt,Ot,Rt,Ut,ei,Tt,ai){let Ti=0,di=0,Xi=0;const ti=Rt==="right"?1:Rt==="left"?0:.5;let Di=!1;for(const Qi of Zt){const er=Qi.getSections();for(const Wr of er){if(Wr.imageName)continue;const Qr=_t[Wr.fontStack];if(Qr&&(Di=Qr.ascender!==void 0&&Qr.descender!==void 0,!Di))break}if(!Di)break}let Zi=0;for(const Qi of Zt){Qi.trim();const er=Qi.getMaxScale(),Wr=(er-1)*Ft,Qr={positionedGlyphs:[],lineOffset:0};Be.positionedLines[Zi]=Qr;const en=Qr.positionedGlyphs;let Hr=0;if(!Qi.length()){di+=xt,++Zi;continue}let Tn=0,jn=0;for(let qr=0;qr<Qi.length();qr++){const ss=Qi.getSection(qr),Yn=Qi.getSectionIndex(qr),Pn=Qi.getCharCode(qr);let Ir=ss.scale,Kn=null,tn=null,ho=null,Jn=Ft,As=0;const bs=!(Ut===Oa.horizontal||!Tt&&!Dd(Pn)||Tt&&(ly[Pn]||(Sr=Pn,li.Arabic(Sr)||li["Arabic Supplement"](Sr)||li["Arabic Extended-A"](Sr)||li["Arabic Presentation Forms-A"](Sr)||li["Arabic Presentation Forms-B"](Sr))));if(ss.imageName){const uo=St[ss.imageName];if(!uo)continue;ho=ss.imageName,Be.iconsInText=Be.iconsInText||!0,tn=uo.paddedRect;const ws=uo.displaySize;Ir=Ir*Ft/ai,Kn={width:ws[0],height:ws[1],left:Do,top:-3,advance:bs?ws[1]:ws[0],localGlyph:!1},As=Di?-Kn.height*Ir:r1+er*Ft-ws[1]*Ir,Jn=Kn.advance;const Ll=(bs?ws[0]:ws[1])*Ir-Ft*er;Ll>0&&Ll>Hr&&(Hr=Ll)}else{const uo=ft[ss.fontStack];if(!uo)continue;uo[Pn]&&(tn=uo[Pn]);const ws=_t[ss.fontStack];if(!ws)continue;const Ll=ws.glyphs[Pn];if(!Ll)continue;if(Kn=Ll.metrics,Jn=Pn!==8203?Ft:0,Di){const jp=ws.ascender!==void 0?Math.abs(ws.ascender):0,vg=ws.descender!==void 0?Math.abs(ws.descender):0,bg=(jp+vg)*Ir;Tn<bg&&(Tn=bg,jn=(jp-vg)/2*Ir),As=-jp*Ir}else As=r1+(er-Ir)*Ft}bs?(Be.verticalizable=!0,en.push({glyph:Pn,imageName:ho,x:Ti,y:di+As,vertical:bs,scale:Ir,localGlyph:Kn.localGlyph,fontStack:ss.fontStack,sectionIndex:Yn,metrics:Kn,rect:tn}),Ti+=Jn*Ir+ei):(en.push({glyph:Pn,imageName:ho,x:Ti,y:di+As,vertical:bs,scale:Ir,localGlyph:Kn.localGlyph,fontStack:ss.fontStack,sectionIndex:Yn,metrics:Kn,rect:tn}),Ti+=Kn.advance*Ir+ei)}en.length!==0&&(Xi=Math.max(Ti-ei,Xi),Di?l1(en,ti,Hr,jn,xt*er/2):l1(en,ti,Hr,0,xt/2)),Ti=0;const Zn=xt*er+Hr;Qr.lineOffset=Math.max(Hr,Wr),di+=Zn,++Zi}var Sr;const Yi=di,{horizontalAlign:Bi,verticalAlign:ln}=Pv(Ot);(function(Qi,er,Wr,Qr,en,Hr){const Tn=(er-Wr)*en,jn=-Hr*Qr;for(const Zn of Qi)for(const qr of Zn.positionedGlyphs)qr.x+=Tn,qr.y+=jn})(Be.positionedLines,ti,Bi,ln,Xi,Yi),Be.top+=-ln*Yi,Be.bottom=Be.top+Yi,Be.left+=-Bi*Xi,Be.right=Be.left+Xi,Be.hasBaseline=Di}(Ue,e,r,a,de,y,w,M,U,k,G,Y),!function(Be){for(const _t of Be)if(_t.positionedGlyphs.length!==0)return!1;return!0}(De)&&Ue}const ly={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},xM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function n1(i,e,r,a,h,m){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*Ft/m+h:0}{const y=r[e.fontStack],w=y&&y.glyphs[i];return w?w.metrics.advance*e.scale+h:0}}function s1(i,e,r,a){const h=Math.pow(i-e,2);return a?i<e?h/2:2*h:h+Math.abs(r)*r}function vM(i,e,r){let a=0;return i===10&&(a-=1e4),r&&(a+=150),i!==40&&i!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function o1(i,e,r,a,h,m){let y=null,w=s1(e,r,h,m);for(const M of a){const k=s1(e-M.x,r,h,m)+M.badness;k<=w&&(y=M,w=k)}return{index:i,x:e,priorBreak:y,badness:w}}function a1(i){return i?a1(i.priorBreak).concat(i.index):[]}function Pv(i){let e=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function l1(i,e,r,a,h){if(!(e||r||a||h))return;const m=i.length-1,y=i[m],w=(y.x+y.metrics.advance*y.scale)*e;for(let M=0;M<=m;M++)i[M].x-=w,i[M].y+=r+a+h}function bM(i,e,r){const{horizontalAlign:a,verticalAlign:h}=Pv(r),m=e[0]-i.displaySize[0]*a,y=e[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function c1(i,e,r,a,h,m){const y=i.image;let w;if(y.content){const de=y.content,Ee=y.pixelRatio||1;w=[de[0]/Ee,de[1]/Ee,y.displaySize[0]-de[2]/Ee,y.displaySize[1]-de[3]/Ee]}const M=e.left*m,k=e.right*m;let B,U,G,X;r==="width"||r==="both"?(X=h[0]+M-a[3],U=h[0]+k+a[1]):(X=h[0]+(M+k-y.displaySize[0])/2,U=X+y.displaySize[0]);const Y=e.top*m,ie=e.bottom*m;return r==="height"||r==="both"?(B=h[1]+Y-a[0],G=h[1]+ie+a[2]):(B=h[1]+(Y+ie-y.displaySize[1])/2,G=B+y.displaySize[1]),{image:y,top:B,right:U,bottom:G,left:X,collisionPadding:w}}class _h extends He{constructor(e,r,a,h,m){super(e,r),this.angle=h,this.z=a,m!==void 0&&(this.segment=m)}clone(){return new _h(this.x,this.y,this.z,this.angle,this.segment)}}function h1(i,e,r,a,h){if(e.segment===void 0)return!0;let m=e,y=e.segment+1,w=0;for(;w>-r/2;){if(y--,y<0)return!1;w-=i[y].dist(m),m=i[y]}w+=i[y].dist(i[y+1]),y++;const M=[];let k=0;for(;w<r/2;){const B=i[y],U=i[y+1];if(!U)return!1;let G=i[y-1].angleTo(B)-B.angleTo(U);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:w,angleDelta:G}),k+=G;w-M[0].distance>a;)k-=M.shift().angleDelta;if(k>h)return!1;y++,w+=B.dist(U)}return!0}function u1(i){let e=0;for(let r=0;r<i.length-1;r++)e+=i[r].dist(i[r+1]);return e}function d1(i,e,r){return i?.6*e*r:0}function f1(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function wM(i,e,r,a,h,m){const y=d1(r,h,m),w=f1(r,a)*m;let M=0;const k=u1(i)/2;for(let B=0;B<i.length-1;B++){const U=i[B],G=i[B+1],X=U.dist(G);if(M+X>k){const Y=(k-M)/X,ie=mr(U.x,G.x,Y),de=mr(U.y,G.y,Y),Ee=new _h(ie,de,0,G.angleTo(U),B);return!y||h1(i,Ee,w,y,e)?Ee:void 0}M+=X}}function TM(i,e,r,a,h,m,y,w,M){const k=d1(a,m,y),B=f1(a,h),U=B*y,G=i[0].x===0||i[0].x===M||i[0].y===0||i[0].y===M;return e-U<e/4&&(e=U+e/4),p1(i,G?e/2*w%e:(B/2+2*m)*y*w%e,e,k,r,U,G,!1,M)}function p1(i,e,r,a,h,m,y,w,M){const k=m/2,B=u1(i);let U=0,G=e-r,X=[];for(let Y=0;Y<i.length-1;Y++){const ie=i[Y],de=i[Y+1],Ee=ie.dist(de),Re=de.angleTo(ie);for(;G+r<U+Ee;){G+=r;const Se=(G-U)/Ee,De=mr(ie.x,de.x,Se),Ue=mr(ie.y,de.y,Se);if(De>=0&&De<M&&Ue>=0&&Ue<M&&G-k>=0&&G+k<=B){const Be=new _h(De,Ue,0,Re,Y);Be._round(),a&&!h1(i,Be,m,a,h)||X.push(Be)}}U+=Ee}return w||X.length||y||(X=p1(i,U/2,r,a,h,m,y,!0,M)),X}function m1(i,e,r,a,h){const m=[];for(let y=0;y<i.length;y++){const w=i[y];let M;for(let k=0;k<w.length-1;k++){let B=w[k],U=w[k+1];B.x<e&&U.x<e||(B.x<e?B=new He(e,B.y+(e-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x<e&&(U=new He(e,B.y+(e-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y<r&&U.y<r||(B.y<r?B=new He(B.x+(r-B.y)/(U.y-B.y)*(U.x-B.x),r)._round():U.y<r&&(U=new He(B.x+(r-B.y)/(U.y-B.y)*(U.x-B.x),r)._round()),B.x>=a&&U.x>=a||(B.x>=a?B=new He(a,B.y+(a-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x>=a&&(U=new He(a,B.y+(a-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y>=h&&U.y>=h||(B.y>=h?B=new He(B.x+(h-B.y)/(U.y-B.y)*(U.x-B.x),h)._round():U.y>=h&&(U=new He(B.x+(h-B.y)/(U.y-B.y)*(U.x-B.x),h)._round()),M&&B.equals(M[M.length-1])||(M=[B],m.push(M)),M.push(U)))))}}return m}yi(_h,"Anchor");const cy=1e20;function g1(i,e,r,a,h,m,y,w,M){for(let k=e;k<e+a;k++)_1(i,r*m+k,m,h,y,w,M);for(let k=r;k<r+h;k++)_1(i,k*m+e,1,a,y,w,M)}function _1(i,e,r,a,h,m,y){m[0]=0,y[0]=-1e20,y[1]=cy,h[0]=i[e];for(let w=1,M=0,k=0;w<a;w++){h[w]=i[e+w*r];const B=w*w;do{const U=m[M];k=(h[w]-h[U]+B-U*U)/(w-U)/2}while(k<=y[M]&&--M>-1);M++,m[M]=w,y[M]=k,y[M+1]=cy}for(let w=0,M=0;w<a;w++){for(;y[M+1]<w;)M++;const k=m[M],B=w-k;i[e+w*r]=h[k]+B*B}}const kl=2,Lv={none:0,ideographs:1,all:2};class Bp{constructor(e,r,a){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const a=[];for(const h in e)for(const m of e[h])a.push({stack:h,id:m});sr(a,({stack:h,id:m},y)=>{let w=this.entries[h];w||(w=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=w.glyphs[m];if(M!==void 0)return void y(null,{stack:h,id:m,glyph:M});if(M=this._tinySDF(w,h,m),M)return w.glyphs[m]=M,void y(null,{stack:h,id:m,glyph:M});const k=Math.floor(m/256);if(256*k>65535)return void y(new Error("glyphs > 65535 not supported"));if(w.ranges[k])return void y(null,{stack:h,id:m,glyph:M});let B=w.requests[k];B||(B=w.requests[k]=[],Bp.loadGlyphRange(h,k,this.url,this.requestManager,(U,G)=>{if(G){w.ascender=G.ascender,w.descender=G.descender;for(const X in G.glyphs)this._doesCharSupportLocalGlyph(+X)||(w.glyphs[+X]=G.glyphs[+X]);w.ranges[k]=!0}for(const X of B)X(U,G);delete w.requests[k]})),B.push((U,G)=>{U?y(U):G&&y(null,{stack:h,id:m,glyph:G.glyphs[m]||null})})},(h,m)=>{if(h)r(h);else if(m){const y={};for(const{stack:w,id:M,glyph:k}of m)y[w]===void 0&&(y[w]={}),y[w].glyphs===void 0&&(y[w].glyphs={}),y[w].glyphs[M]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},y[w].ascender=this.entries[w].ascender,y[w].descender=this.entries[w].descender;r(null,y)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Lv.none&&(this.localGlyphMode===Lv.all?!!this.localFontFamily:!!this.localFontFamily&&(li["CJK Unified Ideographs"](e)||li["Hangul Syllables"](e)||li.Hiragana(e)||li.Katakana(e)||li["CJK Symbols and Punctuation"](e)))}_tinySDF(e,r,a){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(a))return;let m=e.tinySDF;if(!m){let ie="400";/bold/i.test(r)?ie="900":/medium/i.test(r)?ie="500":/light/i.test(r)&&(ie="200"),m=e.tinySDF=new Bp.TinySDF({fontFamily:h,fontWeight:ie,fontSize:24*kl,buffer:3*kl,radius:8*kl}),m.fontWeight=ie}if(this.localGlyphs[m.fontWeight][a])return this.localGlyphs[m.fontWeight][a];const y=String.fromCharCode(a),{data:w,width:M,height:k,glyphWidth:B,glyphHeight:U,glyphLeft:G,glyphTop:X,glyphAdvance:Y}=m.draw(y);return this.localGlyphs[m.fontWeight][a]={id:a,bitmap:new Il({width:M,height:k},w),metrics:{width:B/kl,height:U/kl,left:G/kl,top:X/kl-27,advance:Y/kl,localGlyph:!0}}}}Bp.loadGlyphRange=function(i,e,r,a,h){const m=256*e,y=m+255,w=a.transformRequest(a.normalizeGlyphsURL(r).replace("{fontstack}",i).replace("{range}",`${m}-${y}`),us.Glyphs);os(w,(M,k)=>{if(M)h(M);else if(k){const B={},U=function(G){return new ay(G).readFields(mM,{})}(k);for(const G of U.glyphs)B[G.id]=G;h(null,{glyphs:B,ascender:U.ascender,descender:U.descender})}})},Bp.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:r=8,cutoff:a=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=r;const w=this.size=i+4*e,M=this._createCanvas(w),k=this.ctx=M.getContext("2d",{willReadFrequently:!0});k.font=`${y} ${m} ${i}px ${h}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:a,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(i),y=Math.ceil(r),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),M=Math.min(this.size-this.buffer,y+Math.ceil(a)),k=w+2*this.buffer,B=M+2*this.buffer,U=Math.max(k*B,0),G=new Uint8ClampedArray(U),X={data:G,width:k,height:B,glyphWidth:w,glyphHeight:M,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(w===0||M===0)return X;const{ctx:Y,buffer:ie,gridInner:de,gridOuter:Ee}=this;Y.clearRect(ie,ie,w,M),Y.fillText(i,ie,ie+y);const Re=Y.getImageData(ie,ie,w,M);Ee.fill(cy,0,U),de.fill(0,0,U);for(let Se=0;Se<M;Se++)for(let De=0;De<w;De++){const Ue=Re.data[4*(Se*w+De)+3]/255;if(Ue===0)continue;const Be=(Se+ie)*k+De+ie;if(Ue===1)Ee[Be]=0,de[Be]=cy;else{const _t=.5-Ue;Ee[Be]=_t>0?_t*_t:0,de[Be]=_t<0?_t*_t:0}}g1(Ee,0,0,k,B,k,this.f,this.v,this.z),g1(de,ie,ie,w,M,k,this.f,this.v,this.z);for(let Se=0;Se<U;Se++){const De=Math.sqrt(Ee[Se])-Math.sqrt(de[Se]);G[Se]=Math.round(255-255*(De/this.radius+this.cutoff))}return X}};const ug=Do;function y1(i,e,r,a){const h=[],m=i.image,y=m.pixelRatio,w=m.paddedRect.w-2*ug,M=m.paddedRect.h-2*ug,k=i.right-i.left,B=i.bottom-i.top,U=m.stretchX||[[0,w]],G=m.stretchY||[[0,M]],X=(xt,Ot)=>xt+Ot[1]-Ot[0],Y=U.reduce(X,0),ie=G.reduce(X,0),de=w-Y,Ee=M-ie;let Re=0,Se=Y,De=0,Ue=ie,Be=0,_t=de,ft=0,St=Ee;if(m.content&&a){const xt=m.content;Re=hy(U,0,xt[0]),De=hy(G,0,xt[1]),Se=hy(U,xt[0],xt[2]),Ue=hy(G,xt[1],xt[3]),Be=xt[0]-Re,ft=xt[1]-De,_t=xt[2]-xt[0]-Se,St=xt[3]-xt[1]-Ue}const Zt=(xt,Ot,Rt,Ut)=>{const ei=uy(xt.stretch-Re,Se,k,i.left),Tt=dy(xt.fixed-Be,_t,xt.stretch,Y),ai=uy(Ot.stretch-De,Ue,B,i.top),Ti=dy(Ot.fixed-ft,St,Ot.stretch,ie),di=uy(Rt.stretch-Re,Se,k,i.left),Xi=dy(Rt.fixed-Be,_t,Rt.stretch,Y),ti=uy(Ut.stretch-De,Ue,B,i.top),Di=dy(Ut.fixed-ft,St,Ut.stretch,ie),Zi=new He(ei,ai),Sr=new He(di,ai),Yi=new He(di,ti),Bi=new He(ei,ti),ln=new He(Tt/y,Ti/y),Qi=new He(Xi/y,Di/y),er=e*Math.PI/180;if(er){const en=Math.sin(er),Hr=Math.cos(er),Tn=[Hr,-en,en,Hr];Zi._matMult(Tn),Sr._matMult(Tn),Bi._matMult(Tn),Yi._matMult(Tn)}const Wr=xt.stretch+xt.fixed,Qr=Ot.stretch+Ot.fixed;return{tl:Zi,tr:Sr,bl:Bi,br:Yi,tex:{x:m.paddedRect.x+ug+Wr,y:m.paddedRect.y+ug+Qr,w:Rt.stretch+Rt.fixed-Wr,h:Ut.stretch+Ut.fixed-Qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ln,pixelOffsetBR:Qi,minFontScaleX:_t/y/k,minFontScaleY:St/y/B,isSDF:r}};if(a&&(m.stretchX||m.stretchY)){const xt=x1(U,de,Y),Ot=x1(G,Ee,ie);for(let Rt=0;Rt<xt.length-1;Rt++){const Ut=xt[Rt],ei=xt[Rt+1];for(let Tt=0;Tt<Ot.length-1;Tt++)h.push(Zt(Ut,Ot[Tt],ei,Ot[Tt+1]))}}else h.push(Zt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:M+1}));return h}function hy(i,e,r){let a=0;for(const h of i)a+=Math.max(e,Math.min(r,h[1]))-Math.max(e,Math.min(r,h[0]));return a}function x1(i,e,r){const a=[{fixed:-1,stretch:0}];for(const[h,m]of i){const y=a[a.length-1];a.push({fixed:h-y.stretch,stretch:y.stretch}),a.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return a.push({fixed:e+ug,stretch:r}),a}function uy(i,e,r,a){return i/e*r+a}function dy(i,e,r,a){return i-e*r/a}function EM(i,e,r,a){const h=e+i.positionedLines[a].lineOffset;return a===0?r+h/2:r+(h+(e+i.positionedLines[a-1].lineOffset))/2}class SM{constructor(e=[],r=CM){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:a}=this,h=r[e];for(;e>0;){const m=e-1>>1,y=r[m];if(a(h,y)>=0)break;r[e]=y,e=m}r[e]=h}_down(e){const{data:r,compare:a}=this,h=this.length>>1,m=r[e];for(;e<h;){let y=1+(e<<1),w=r[y];const M=y+1;if(M<this.length&&a(r[M],w)<0&&(y=M,w=r[M]),a(w,m)>=0)break;r[e]=w,e=y}r[e]=m}}function CM(i,e){return i<e?-1:i>e?1:0}function AM(i,e=1,r=!1){let a=1/0,h=1/0,m=-1/0,y=-1/0;const w=i[0];for(let X=0;X<w.length;X++){const Y=w[X];(!X||Y.x<a)&&(a=Y.x),(!X||Y.y<h)&&(h=Y.y),(!X||Y.x>m)&&(m=Y.x),(!X||Y.y>y)&&(y=Y.y)}const M=Math.min(m-a,y-h);let k=M/2;const B=new SM([],MM);if(M===0)return new He(a,h);for(let X=a;X<m;X+=M)for(let Y=h;Y<y;Y+=M)B.push(new Fp(X+k,Y+k,k,i));let U=function(X){let Y=0,ie=0,de=0;const Ee=X[0];for(let Re=0,Se=Ee.length,De=Se-1;Re<Se;De=Re++){const Ue=Ee[Re],Be=Ee[De],_t=Ue.x*Be.y-Be.x*Ue.y;ie+=(Ue.x+Be.x)*_t,de+=(Ue.y+Be.y)*_t,Y+=3*_t}return new Fp(ie/Y,de/Y,0,X)}(i),G=B.length;for(;B.length;){const X=B.pop();(X.d>U.d||!U.d)&&(U=X,r&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,G)),X.max-U.d<=e||(k=X.h/2,B.push(new Fp(X.p.x-k,X.p.y-k,k,i)),B.push(new Fp(X.p.x+k,X.p.y-k,k,i)),B.push(new Fp(X.p.x-k,X.p.y+k,k,i)),B.push(new Fp(X.p.x+k,X.p.y+k,k,i)),G+=4)}return r&&(console.log(`num probes: ${G}`),console.log(`best distance: ${U.d}`)),U.p}function MM(i,e){return e.max-i.max}class Fp{constructor(e,r,a,h){this.p=new He(e,r),this.h=a,this.d=function(m,y){let w=!1,M=1/0;for(let k=0;k<y.length;k++){const B=y[k];for(let U=0,G=B.length,X=G-1;U<G;X=U++){const Y=B[U],ie=B[X];Y.y>m.y!=ie.y>m.y&&m.x<(ie.x-Y.x)*(m.y-Y.y)/(ie.y-Y.y)+Y.x&&(w=!w),M=Math.min(M,wu(m,Y,ie))}}return(w?1:-1)*Math.sqrt(M)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const Np=7,Dv=Number.POSITIVE_INFINITY,IM=Math.sqrt(2);function v1(i,[e,r]){let a=0,h=0;if(r===Dv){e<0&&(e=0);const m=e/IM;switch(i){case"top-right":case"top-left":h=m-Np;break;case"bottom-right":case"bottom-left":h=-m+Np;break;case"bottom":h=-e+Np;break;case"top":h=e-Np}switch(i){case"top-right":case"bottom-right":a=-m;break;case"top-left":case"bottom-left":a=m;break;case"left":a=e;break;case"right":a=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),i){case"top-right":case"top-left":case"top":h=r-Np;break;case"bottom-right":case"bottom-left":case"bottom":h=-r+Np}switch(i){case"top-right":case"bottom-right":case"right":a=-e;break;case"top-left":case"bottom-left":case"left":a=e}}return[a,h]}function kM(i,e,r,a,h,m,y,w,M,k){i.createArrays(),i.tilePixelRatio=Mi/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const B=i.layers[0].layout,U=i.layers[0]._unevaluatedLayout._values,G={};if(i.textSizeData.kind==="composite"){const{minZoom:ie,maxZoom:de}=i.textSizeData;G.compositeTextSizes=[U["text-size"].possiblyEvaluate(new F(ie),w),U["text-size"].possiblyEvaluate(new F(de),w)]}if(i.iconSizeData.kind==="composite"){const{minZoom:ie,maxZoom:de}=i.iconSizeData;G.compositeIconSizes=[U["icon-size"].possiblyEvaluate(new F(ie),w),U["icon-size"].possiblyEvaluate(new F(de),w)]}G.layoutTextSize=U["text-size"].possiblyEvaluate(new F(M+1),w),G.layoutIconSize=U["icon-size"].possiblyEvaluate(new F(M+1),w),G.textMaxSize=U["text-size"].possiblyEvaluate(new F(18),w);const X=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Y=B.get("text-size");for(const ie of i.features){const de=B.get("text-font").evaluate(ie,{},w).join(","),Ee=Y.evaluate(ie,{},w),Re=G.layoutTextSize.evaluate(ie,{},w),Se=(G.layoutIconSize.evaluate(ie,{},w),{horizontal:{},vertical:void 0}),De=ie.text;let Ue,Be=[0,0];if(De){const St=De.toString(),Zt=B.get("text-letter-spacing").evaluate(ie,{},w)*Ft,xt=B.get("text-line-height").evaluate(ie,{},w)*Ft,Ot=Dm(St)?Zt:0,Rt=B.get("text-anchor").evaluate(ie,{},w),Ut=B.get("text-variable-anchor");if(!Ut){const di=B.get("text-radial-offset").evaluate(ie,{},w);Be=di?v1(Rt,[di*Ft,Dv]):B.get("text-offset").evaluate(ie,{},w).map(Xi=>Xi*Ft)}let ei=X?"center":B.get("text-justify").evaluate(ie,{},w);const Tt=B.get("symbol-placement")==="point",ai=Tt?B.get("text-max-width").evaluate(ie,{},w)*Ft:1/0,Ti=di=>{i.allowVerticalPlacement&&Ld(St)&&(Se.vertical=kv(De,e,r,h,de,ai,xt,Rt,di,Ot,Be,Oa.vertical,!0,Re,Ee))};if(!X&&Ut){const di=ei==="auto"?Ut.map(ti=>Ov(ti)):[ei];let Xi=!1;for(let ti=0;ti<di.length;ti++){const Di=di[ti];if(!Se.horizontal[Di])if(Xi)Se.horizontal[Di]=Se.horizontal[0];else{const Zi=kv(De,e,r,h,de,ai,xt,"center",Di,Ot,Be,Oa.horizontal,!1,Re,Ee);Zi&&(Se.horizontal[Di]=Zi,Xi=Zi.positionedLines.length===1)}}Ti("left")}else{if(ei==="auto"&&(ei=Ov(Rt)),Tt||B.get("text-writing-mode").indexOf("horizontal")>=0||!Ld(St)){const di=kv(De,e,r,h,de,ai,xt,Rt,ei,Ot,Be,Oa.horizontal,!1,Re,Ee);di&&(Se.horizontal[ei]=di)}Ti(Tt?"left":ei)}}let _t=!1;if(ie.icon&&ie.icon.name){const St=a[ie.icon.name];St&&(Ue=bM(h[ie.icon.name],B.get("icon-offset").evaluate(ie,{},w),B.get("icon-anchor").evaluate(ie,{},w)),_t=St.sdf,i.sdfIcons===void 0?i.sdfIcons=St.sdf:i.sdfIcons!==St.sdf&&Lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(St.pixelRatio!==i.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const ft=w1(Se.horizontal)||Se.vertical;i.iconsInText||(i.iconsInText=!!ft&&ft.iconsInText),(ft||Ue)&&PM(i,ie,Se,Ue,a,G,Re,0,Be,_t,y,w,k)}m&&i.generateCollisionDebugBuffers(M,i.collisionBoxArray)}function Ov(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function PM(i,e,r,a,h,m,y,w,M,k,B,U,G){let X=m.textMaxSize.evaluate(e,{},U);X===void 0&&(X=y);const Y=i.layers[0].layout,ie=Y.get("icon-offset").evaluate(e,{},U),de=w1(r.horizontal)||r.vertical,Ee=G.name==="globe",Re=Ft,Se=y/Re,De=i.tilePixelRatio*X/Re,Ue=(Rt=i.overscaling,i.zoom>18&&Rt>2&&(Rt>>=1),Math.max(Mi/(512*Rt),1)*Y.get("symbol-spacing")),Be=Y.get("text-padding")*i.tilePixelRatio,_t=Y.get("icon-padding")*i.tilePixelRatio,ft=dt(Y.get("text-max-angle")),St=Y.get("text-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",Zt=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",xt=Y.get("symbol-placement"),Ot=Ue/2;var Rt;const Ut=Y.get("icon-text-fit");let ei;a&&Ut!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(ei=c1(a,r.vertical,Ut,Y.get("icon-text-fit-padding"),ie,Se)),de&&(a=c1(a,de,Ut,Y.get("icon-text-fit-padding"),ie,Se)));const Tt=(ai,Ti,di)=>{if(Ti.x<0||Ti.x>=Mi||Ti.y<0||Ti.y>=Mi)return;let Xi=null;if(Ee){const{x:ti,y:Di,z:Zi}=G.projectTilePoint(Ti.x,Ti.y,di);Xi={anchor:new _h(ti,Di,Zi,0,void 0),up:G.upVector(di,Ti.x,Ti.y)}}(function(ti,Di,Zi,Sr,Yi,Bi,ln,Qi,er,Wr,Qr,en,Hr,Tn,jn,Zn,qr,ss,Yn,Pn,Ir,Kn,tn,ho,Jn){const As=ti.addToLineVertexArray(Di,Sr);let bs,uo,ws,Ll,jp,vg,bg,tw=0,iw=0,rw=0,nw=0,Zv=-1,Yv=-1;const Ac={};let sw=zm("");const vf=Zi?Zi.anchor:Di;let Kv=0,Jv=0;if(er._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Kv,Jv]=er.layout.get("text-offset").evaluate(Ir,{},Jn).map(ra=>ra*Ft):(Kv=er.layout.get("text-radial-offset").evaluate(Ir,{},Jn)*Ft,Jv=Dv),ti.allowVerticalPlacement&&Yi.vertical){const ra=Yi.vertical;if(jn)vg=Rv(ra),Qi&&(bg=Rv(Qi));else{const na=er.layout.get("text-rotate").evaluate(Ir,{},Jn)+90;ws=fy(Wr,vf,Di,Qr,en,Hr,ra,Tn,na,Zn),Qi&&(Ll=fy(Wr,vf,Di,Qr,en,Hr,Qi,ss,na))}}if(Bi){const ra=er.layout.get("icon-rotate").evaluate(Ir,{},Jn),na=er.layout.get("icon-text-fit")!=="none",wg=y1(Bi,ra,tn,na),e0=Qi?y1(Qi,ra,tn,na):void 0;uo=fy(Wr,vf,Di,Qr,en,Hr,Bi,ss,ra),tw=4*wg.length;const ow=ti.iconSizeData;let bf=null;ow.kind==="source"?(bf=[ui*er.layout.get("icon-size").evaluate(Ir,{},Jn)],bf[0]>Iu&&Lt(`${ti.layerIds[0]}: Value for "icon-size" is >= ${dg}. Reduce your "icon-size".`)):ow.kind==="composite"&&(bf=[ui*Kn.compositeIconSizes[0].evaluate(Ir,{},Jn),ui*Kn.compositeIconSizes[1].evaluate(Ir,{},Jn)],(bf[0]>Iu||bf[1]>Iu)&&Lt(`${ti.layerIds[0]}: Value for "icon-size" is >= ${dg}. Reduce your "icon-size".`)),ti.addSymbols(ti.icon,wg,bf,Pn,Yn,Ir,!1,Zi,Di,As.lineStartIndex,As.lineLength,-1,ho,Jn),Zv=ti.icon.placedSymbolArray.length-1,e0&&(iw=4*e0.length,ti.addSymbols(ti.icon,e0,bf,Pn,Yn,Ir,Oa.vertical,Zi,Di,As.lineStartIndex,As.lineLength,-1,ho,Jn),Yv=ti.icon.placedSymbolArray.length-1)}for(const ra in Yi.horizontal){const na=Yi.horizontal[ra];bs||(sw=zm(na.text),jn?jp=Rv(na):bs=fy(Wr,vf,Di,Qr,en,Hr,na,Tn,er.layout.get("text-rotate").evaluate(Ir,{},Jn),Zn));const wg=na.positionedLines.length===1;if(rw+=b1(ti,Zi,Di,na,ln,er,jn,Ir,Zn,As,Yi.vertical?Oa.horizontal:Oa.horizontalOnly,wg?Object.keys(Yi.horizontal):[ra],Ac,Zv,Kn,ho,Jn),wg)break}Yi.vertical&&(nw+=b1(ti,Zi,Di,Yi.vertical,ln,er,jn,Ir,Zn,As,Oa.vertical,["vertical"],Ac,Yv,Kn,ho,Jn));let Ru=-1;const Qv=(ra,na)=>ra?Math.max(ra,na):na;Ru=Qv(jp,Ru),Ru=Qv(vg,Ru),Ru=Qv(bg,Ru);const sI=Ru>-1?1:0;ti.glyphOffsetArray.length>=Pu.MAX_GLYPHS&&Lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ir.sortKey!==void 0&&ti.addToSortKeyRanges(ti.symbolInstances.length,Ir.sortKey),ti.symbolInstances.emplaceBack(vf.x,vf.y,vf.z,Di.x,Di.y,Ac.right>=0?Ac.right:-1,Ac.center>=0?Ac.center:-1,Ac.left>=0?Ac.left:-1,Ac.vertical>=0?Ac.vertical:-1,Zv,Yv,sw,bs!==void 0?bs:ti.collisionBoxArray.length,bs!==void 0?bs+1:ti.collisionBoxArray.length,ws!==void 0?ws:ti.collisionBoxArray.length,ws!==void 0?ws+1:ti.collisionBoxArray.length,uo!==void 0?uo:ti.collisionBoxArray.length,uo!==void 0?uo+1:ti.collisionBoxArray.length,Ll||ti.collisionBoxArray.length,Ll?Ll+1:ti.collisionBoxArray.length,Qr,rw,nw,tw,iw,sI,0,Kv,Jv,Ru)})(i,Ti,Xi,ai,r,a,h,ei,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,Be,St,M,0,_t,Zt,ie,e,m,k,B,U)};if(xt==="line")for(const ai of m1(e.geometry,0,0,Mi,Mi)){const Ti=TM(ai,Ue,ft,r.vertical||de,a,Re,De,i.overscaling,Mi);for(const di of Ti)de&&LM(i,de.text,Ot,di)||Tt(ai,di,U)}else if(xt==="line-center"){for(const ai of e.geometry)if(ai.length>1){const Ti=wM(ai,ft,r.vertical||de,a,Re,De);Ti&&Tt(ai,Ti,U)}}else if(e.type==="Polygon")for(const ai of Dp(e.geometry,0)){const Ti=AM(ai,16);Tt(ai[0],new _h(Ti.x,Ti.y,0,0,void 0),U)}else if(e.type==="LineString")for(const ai of e.geometry)Tt(ai,new _h(ai[0].x,ai[0].y,0,0,void 0),U);else if(e.type==="Point")for(const ai of e.geometry)for(const Ti of ai)Tt([Ti],new _h(Ti.x,Ti.y,0,0,void 0),U)}const dg=255,Iu=dg*ui;function b1(i,e,r,a,h,m,y,w,M,k,B,U,G,X,Y,ie,de){const Ee=function(De,Ue,Be,_t,ft,St,Zt,xt){const Ot=[];if(Ue.positionedLines.length===0)return Ot;const Rt=_t.layout.get("text-rotate").evaluate(St,{})*Math.PI/180,Ut=function(di){const Xi=di[0],ti=di[1],Di=Xi*ti;return Di>0?[Xi,-ti]:Di<0?[-Xi,ti]:Xi===0?[ti,Xi]:[ti,-Xi]}(Be);let ei=Math.abs(Ue.top-Ue.bottom);for(const di of Ue.positionedLines)ei-=di.lineOffset;const Tt=Ue.positionedLines.length,ai=ei/Tt;let Ti=Ue.top-Be[1];for(let di=0;di<Tt;++di){const Xi=Ue.positionedLines[di];Ti=EM(Ue,ai,Ti,di);for(const ti of Xi.positionedGlyphs){if(!ti.rect)continue;const Di=ti.rect||{};let Zi=yM+1,Sr=!0,Yi=1,Bi=0;if(ti.imageName){const tn=Zt[ti.imageName];if(!tn)continue;if(tn.sdf){Lt("SDF images are not supported in formatted text and will be ignored.");continue}Sr=!1,Yi=tn.pixelRatio,Zi=Do/Yi}const ln=(ft||xt)&&ti.vertical,Qi=ti.metrics.advance*ti.scale/2,er=ti.metrics,Wr=ti.rect;if(Wr===null)continue;xt&&Ue.verticalizable&&(Bi=ti.imageName?Qi-ti.metrics.width*ti.scale/2:0);const Qr=ft?[ti.x+Qi,ti.y]:[0,0];let en=[0,0],Hr=[0,0],Tn=!1;ft||(ln?(Hr=[ti.x+Qi+Ut[0],ti.y+Ut[1]-Bi],Tn=!0):en=[ti.x+Qi+Be[0],ti.y+Be[1]-Bi]);const jn=Wr.w*ti.scale/(Yi*(ti.localGlyph?kl:1)),Zn=Wr.h*ti.scale/(Yi*(ti.localGlyph?kl:1));let qr,ss,Yn,Pn;if(ln){const tn=ti.y-Ti,ho=new He(-Qi,Qi-tn),Jn=-Math.PI/2,As=new He(...Hr);qr=new He(-Qi+en[0],en[1]),qr._rotateAround(Jn,ho)._add(As),qr.x+=-tn+Qi,qr.y-=(er.left-Zi)*ti.scale;const bs=ti.imageName?er.advance*ti.scale:Ft*ti.scale,uo=String.fromCharCode(ti.glyph);br(uo)?qr.x+=(1-Zi)*ti.scale:Cs(uo)?qr.x+=bs-er.height*ti.scale+(-Zi-1)*ti.scale:qr.x+=ti.imageName||er.width+2*Zi===Wr.w&&er.height+2*Zi===Wr.h?(bs-Zn)/2:(bs-(er.height+2*Zi)*ti.scale)/2,ss=new He(qr.x,qr.y-jn),Yn=new He(qr.x+Zn,qr.y),Pn=new He(qr.x+Zn,qr.y-jn)}else{const tn=(er.left-Zi)*ti.scale-Qi+en[0],ho=(-er.top-Zi)*ti.scale+en[1],Jn=tn+jn,As=ho+Zn;qr=new He(tn,ho),ss=new He(Jn,ho),Yn=new He(tn,As),Pn=new He(Jn,As)}if(Rt){let tn;tn=ft?new He(0,0):Tn?new He(Ut[0],Ut[1]):new He(Be[0],Be[1]),qr._rotateAround(Rt,tn),ss._rotateAround(Rt,tn),Yn._rotateAround(Rt,tn),Pn._rotateAround(Rt,tn)}const Ir=new He(0,0),Kn=new He(0,0);Ot.push({tl:qr,tr:ss,bl:Yn,br:Pn,tex:Di,writingMode:Ue.writingMode,glyphOffset:Qr,sectionIndex:ti.sectionIndex,isSDF:Sr,pixelOffsetTL:Ir,pixelOffsetBR:Kn,minFontScaleX:0,minFontScaleY:0})}}return Ot}(0,a,M,m,y,w,h,i.allowVerticalPlacement),Re=i.textSizeData;let Se=null;Re.kind==="source"?(Se=[ui*m.layout.get("text-size").evaluate(w,{},de)],Se[0]>Iu&&Lt(`${i.layerIds[0]}: Value for "text-size" is >= ${dg}. Reduce your "text-size".`)):Re.kind==="composite"&&(Se=[ui*Y.compositeTextSizes[0].evaluate(w,{},de),ui*Y.compositeTextSizes[1].evaluate(w,{},de)],(Se[0]>Iu||Se[1]>Iu)&&Lt(`${i.layerIds[0]}: Value for "text-size" is >= ${dg}. Reduce your "text-size".`)),i.addSymbols(i.text,Ee,Se,M,y,w,B,e,r,k.lineStartIndex,k.lineLength,X,ie,de);for(const De of U)G[De]=i.text.placedSymbolArray.length-1;return 4*Ee.length}function w1(i){for(const e in i)return i[e];return null}function fy(i,e,r,a,h,m,y,w,M,k){let B=y.top,U=y.bottom,G=y.left,X=y.right;const Y=y.collisionPadding;if(Y&&(G-=Y[0],B-=Y[1],X+=Y[2],U+=Y[3]),M){const ie=new He(G,B),de=new He(X,B),Ee=new He(G,U),Re=new He(X,U),Se=dt(M);let De=new He(0,0);k&&(De=new He(k[0],k[1])),ie._rotateAround(Se,De),de._rotateAround(Se,De),Ee._rotateAround(Se,De),Re._rotateAround(Se,De),G=Math.min(ie.x,de.x,Ee.x,Re.x),X=Math.max(ie.x,de.x,Ee.x,Re.x),B=Math.min(ie.y,de.y,Ee.y,Re.y),U=Math.max(ie.y,de.y,Ee.y,Re.y)}return i.emplaceBack(e.x,e.y,e.z,r.x,r.y,G,B,X,U,w,a,h,m),i.length-1}function Rv(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function LM(i,e,r,a){const h=i.compareText;if(e in h){const m=h[e];for(let y=m.length-1;y>=0;y--)if(a.dist(m[y])<r)return!0}else h[e]=[];return h[e].push(a),!1}function T1(i,e){const r=i.fovAboveCenter,a=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,h=(i._camera.position[2]*i.worldSize-a)/Math.cos(i._pitch),m=Math.sin(r)*h/Math.sin(Math.max(Math.PI/2-i._pitch-r,.01)),y=Math.sin(i._pitch)*m+h;return Math.min(1.01*y,h*(1/i._horizonShift))}function yf(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const r=Math.pow(2,-i.z),a=i.x*r,h=(i.x+1)*r,m=i.y*r,y=(i.y+1)*r,w=ko(a),M=ko(h),k=vs(m),B=vs(y),U=e.project(w,k),G=e.project(M,k),X=e.project(M,B),Y=e.project(w,B);let ie=Math.min(U.x,G.x,X.x,Y.x),de=Math.min(U.y,G.y,X.y,Y.y),Ee=Math.max(U.x,G.x,X.x,Y.x),Re=Math.max(U.y,G.y,X.y,Y.y);const Se=r/16;function De(Be,_t,ft,St,Zt,xt){const Ot=(ft+Zt)/2,Rt=(St+xt)/2,Ut=e.project(ko(Ot),vs(Rt)),ei=Math.max(0,ie-Ut.x,de-Ut.y,Ut.x-Ee,Ut.y-Re);ie=Math.min(ie,Ut.x),Ee=Math.max(Ee,Ut.x),de=Math.min(de,Ut.y),Re=Math.max(Re,Ut.y),ei>Se&&(De(Be,Ut,ft,St,Ot,Rt),De(Ut,_t,Ot,Rt,Zt,xt))}De(U,G,a,m,h,m),De(G,X,h,m,h,y),De(X,Y,h,y,a,y),De(Y,U,a,y,a,m),ie-=Se,de-=Se,Ee+=Se,Re+=Se;const Ue=1/Math.max(Ee-ie,Re-de);return{scale:Ue,x:ie*Ue,y:de*Ue,x2:Ee*Ue,y2:Re*Ue,projection:e}}const DM=Ao(new Float32Array(16));class ku{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new zr(0,0)}projectTilePoint(e,r,a){return{x:e,y:r,z:0}}locationPoint(e,r,a=!0){return e._coordinatePoint(e.locationCoordinate(r),a)}pixelsPerMeter(e,r){return Pa(1,e)*r}pixelSpaceConversion(e,r,a){return 1}farthestPixelDistance(e){return T1(e,e.pixelsPerMeter)}pointCoordinate(e,r,a,h){const m=e.horizonLineFromTop(!1),y=new He(r,Math.max(m,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(y,h))}pointCoordinate3D(e,r,a){const h=new He(r,a);if(e.elevation)return e.elevation.pointCoordinate(h);{const m=this.pointCoordinate(e,h.x,h.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const a=e.horizonLineFromTop();return r.y<a}createInversionMatrix(e,r){return DM}createTileMatrix(e,r,a){let h,m,y;const w=a.canonical,M=Ao(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=yf(w,this);h=1,m=k.x+a.wrap*k.scale,y=k.y,Ml(M,M,[h/k.scale,h/k.scale,e.pixelsPerMeter/r])}else h=r/e.zoomScale(w.z),m=(w.x+Math.pow(2,w.z)*a.wrap)*h,y=w.y*h;return Nd(M,M,[m,y,0]),Ml(M,M,[h/Mi,h/Mi,1]),M}upVector(e,r,a){return[0,0,1]}upVectorScale(e,r,a){return{metersToTile:1}}}class OM extends ku{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,a]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(dt(r));this.n=(h+Math.sin(dt(a)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n:a,c:h,r0:m}=this,y=dt(e-this.center[0]),w=dt(r),M=Math.sqrt(h-2*a*Math.sin(w))/a;return{x:M*Math.sin(y*a),y:M*Math.cos(y*a)-m,z:0}}unproject(e,r){const{n:a,c:h,r0:m}=this,y=m+r;let w=Math.atan2(e,Math.abs(y))*Math.sign(y);y*a<0&&(w-=Math.PI*Math.sign(e)*Math.sign(y));const M=dt(this.center[0])*a;w=ir(w,-Math.PI-M,Math.PI-M);const k=vi(kt(w/a)+this.center[0],-180,180),B=Math.asin(vi((h-(e*e+y*y)*a*a)/(2*a),-1,1)),U=vi(kt(B),-85.051129,Po);return new zr(k,U)}}const fg=1.340264,pg=-.081106,mg=893e-6,gg=.003796,py=Math.sqrt(3)/2;class RM extends ku{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(py*Math.sin(r)),h=a*a,m=h*h*h;return{x:.5*(e*Math.cos(a)/(py*(fg+3*pg*h+m*(7*mg+9*gg*h)))/Math.PI+.5),y:1-.5*(a*(fg+pg*h+m*(mg+gg*h))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let a=r=(2*(1-r)-1)*Math.PI,h=a*a,m=h*h*h;for(let B,U,G,X=0;X<12&&(U=a*(fg+pg*h+m*(mg+gg*h))-r,G=fg+3*pg*h+m*(7*mg+9*gg*h),B=U/G,a=vi(a-B,-Math.PI/3,Math.PI/3),h=a*a,m=h*h*h,!(Math.abs(B)<1e-12));++X);const y=py*e*(fg+3*pg*h+m*(7*mg+9*gg*h))/Math.cos(a),w=Math.asin(Math.sin(a)/py),M=vi(180*y/Math.PI,-180,180),k=vi(180*w/Math.PI,-85.051129,Po);return new zr(M,k)}}class zM extends ku{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const a=360*(e-.5),h=vi(360*(.5-r),-85.051129,Po);return new zr(a,h)}}const Up=Math.PI/2;function my(i){return Math.tan((Up+i)/2)}class BM extends ku{constructor(e){super(e),this.center=e.center||[0,30];const[r,a]=this.parallels=e.parallels||[30,30];let h=dt(r),m=dt(a);this.southernCenter=h+m<0,this.southernCenter&&(h=-h,m=-m);const y=Math.cos(h),w=my(h);this.n=h===m?Math.sin(h):Math.log(y/Math.cos(m))/Math.log(my(m)/w),this.f=y*Math.pow(my(h),this.n)/this.n}project(e,r){r=dt(r),this.southernCenter&&(r=-r),e=dt(e-this.center[0]);const a=1e-6,{n:h,f:m}=this;m>0?r<-Up+a&&(r=-Up+a):r>Up-a&&(r=Up-a);const y=m/Math.pow(my(r),h);let w=y*Math.sin(h*e),M=m-y*Math.cos(h*e);return w=.5*(w/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:w,y:this.southernCenter?M:1-M,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:a,f:h}=this,m=h-r,y=Math.sign(m),w=Math.sign(a)*Math.sqrt(e*e+m*m);let M=Math.atan2(e,Math.abs(m))*y;m*a<0&&(M-=Math.PI*Math.sign(e)*y);const k=vi(kt(M/a)+this.center[0],-180,180),B=vi(kt(2*Math.atan(Math.pow(h/w,1/a))-Up),-85.051129,Po);return new zr(k,this.southernCenter?-B:B)}}class E1 extends ku{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:ka(e),y:ta(r),z:0}}unproject(e,r){const a=ko(e),h=vs(r);return new zr(a,h)}}const S1=dt(Po);class FM extends ku{project(e,r){const a=(r=dt(r))*r,h=a*a;return{x:.5*((e=dt(e))*(.8707-.131979*a+h*(h*(.003971*a-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+a*(.015085+h*(.028874*a-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let a=r=(2*(1-r)-1)*Math.PI,h=25,m=0,y=a*a;do{y=a*a;const k=y*y;m=(a*(1.007226+y*(.015085+k*(.028874*y-.044475-.005916*k)))-r)/(1.007226+y*(.045255+k*(.259866*y-.311325-.005916*11*k))),a=vi(a-m,-S1,S1)}while(Math.abs(m)>1e-6&&--h>0);y=a*a;const w=vi(kt(e/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),M=kt(a);return new zr(w,M)}}const C1=dt(Po);class NM extends ku{project(e,r){r=dt(r),e=dt(e);const a=Math.cos(r),h=2/Math.PI,m=Math.acos(a*Math.cos(e/2)),y=Math.sin(m)/m,w=.5*(e*h+2*a*Math.sin(e/2)/y)||0,M=.5*(r+Math.sin(r)/y)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(e,r){let a=e=(2*e-.5)*Math.PI,h=r=(2*(1-r)-1)*Math.PI,m=25;const y=1e-6;let w=0,M=0;do{const k=Math.cos(h),B=Math.sin(h),U=2*B*k,G=B*B,X=k*k,Y=Math.cos(a/2),ie=Math.sin(a/2),de=2*Y*ie,Ee=ie*ie,Re=1-X*Y*Y,Se=Re?1/Re:0,De=Re?Math.acos(k*Y)*Math.sqrt(1/Re):0,Ue=.5*(2*De*k*ie+2*a/Math.PI)-e,Be=.5*(De*B+h)-r,_t=.5*Se*(X*Ee+De*k*Y*G)+1/Math.PI,ft=Se*(de*U/4-De*B*ie),St=.125*Se*(U*ie-De*B*X*de),Zt=.5*Se*(G*Y+De*Ee*k)+.5,xt=ft*St-Zt*_t;w=(Be*ft-Ue*Zt)/xt,M=(Ue*St-Be*_t)/xt,a=vi(a-w,-Math.PI,Math.PI),h=vi(h-M,-C1,C1)}while((Math.abs(w)>y||Math.abs(M)>y)&&--m>0);return new zr(kt(a),kt(h))}}class A1 extends ku{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(dt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:a,cosPhi:h}=this;return{x:dt(e)*h*a+.5,y:-Math.sin(dt(r))/h*a+.5,z:0}}unproject(e,r){const{scale:a,cosPhi:h}=this,m=-(r-.5)/a,y=vi(kt((e-.5)/a)/h,-180,180),w=Math.asin(vi(m*h,-1,1)),M=vi(kt(w),-85.051129,Po);return new zr(y,M)}}class UM extends E1{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,a){const h=Zd(e,r,a);return mn(h,h,uh(ea(a))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,r){const a=gu(r.lat,r.lng),h=Bs([],a),m=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude;jd(a,a,h,Pa(1,0)*Mi*m);const y=Ao(new Float64Array(16));return Al(y,e.pixelMatrix,e.globeMatrix),mn(a,a,y),new He(a[0],a[1])}pixelsPerMeter(e,r){return Pa(1,0)*r}pixelSpaceConversion(e,r,a){const h=Pa(1,e)*r,m=mr(Pa(1,45)*r,h,a);return this.pixelsPerMeter(e,r)/m}createTileMatrix(e,r,a){const h=$m(ea(a.canonical));return Al(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,r){const{center:a}=e,h=uh(ea(r));return up(h,h,dt(a.lng)),Ud(h,h,dt(a.lat)),Ml(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,r,a,h){return I_(e,r,a,!0)||new xu(0,0)}pointCoordinate3D(e,r,a){const h=this.pointCoordinate(e,r,a,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,r){return!I_(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(h,m){const y=h.cameraToCenterDistance,w=h._centerAltitude*m,M=h._camera,k=h._camera.forward(),B=Ma([],oo([],k,-y),[0,0,w]),U=h.worldSize/(2*Math.PI),G=[0,0,-U],X=h.width/h.height,Y=Math.tan(h.fovAboveCenter),ie=oo([],M.up(),Y),de=oo([],M.right(),Y*X),Ee=Bs([],Ma([],Ma([],k,ie),de)),Re=[];let Se;if(new Um(B,Ee).closestPointOnSphere(G,U,Re)){const De=Ma([],Re,G),Ue=Mo([],De,B);Se=Math.cos(h.fovAboveCenter)*pu(Ue)}else{const De=Mo([],B,G),Ue=Mo([],G,B);Bs(Ue,Ue);const Be=pu(De)-U;Se=Math.sqrt(Be*(Be+2*U));const _t=Math.acos(Se/(U+Be))-Math.acos(ao(k,Ue));Se*=Math.cos(_t)}return 1.01*Se}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=yu(e.zoom);if(a>0){const h=T1(e,Pa(1,e.center.lat)*e.worldSize),m=e.worldSize/(2*Math.PI),y=Math.max(e.width,e.height)/e.worldSize*Math.PI;return mr(r,h+m*(1-Math.cos(y)),Math.pow(a,10))}return r}upVector(e,r,a){return Zd(r,a,e,1)}upVectorScale(e){return{metersToTile:yp(_u(ea(e)))}}}function M1(i){const e=i.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new E1(i);case"equirectangular":return new zM(i);case"naturalEarth":return new FM(i);case"equalEarth":return new RM(i);case"winkelTripel":return new NM(i);case"albers":return r?new A1(i):new OM(i);case"lambertConformalConic":return r?new A1(i):new BM(i);case"globe":return new UM(i)}throw new Error(`Invalid projection name: ${i.name}`)}const VM=hf.types,jM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gy(i,e,r,a,h,m,y,w,M,k,B,U,G){const X=w?Math.min(Iu,Math.round(w[0])):0,Y=w?Math.min(Iu,Math.round(w[1])):0;i.emplaceBack(e,r,Math.round(32*a),Math.round(32*h),m,y,(X<<1)+(M?1:0),Y,16*k,16*B,256*U,256*G)}function _y(i,e,r,a,h,m,y){i.emplaceBack(e,r,a,h,m,y)}function yy(i,e,r,a,h){i.emplaceBack(e,r,a,h),i.emplaceBack(e,r,a,h),i.emplaceBack(e,r,a,h),i.emplaceBack(e,r,a,h)}function $M(i){for(const e of i.sections)if(Om(e.text))return!0;return!1}class zv{constructor(e){this.layoutVertexArray=new Et,this.indexArray=new Ai,this.programConfigurations=e,this.segments=new In,this.dynamicLayoutVertexArray=new jt,this.opacityVertexArray=new ki,this.placedSymbolArray=new Un,this.globeExtVertexArray=new Xt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$e.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,tt.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,jM,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,mt.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}yi(zv,"SymbolBuffers");class Bv{constructor(e,r,a){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new a,this.segments=new In,this.collisionVertexArray=new Wi,this.collisionVertexArrayExt=new Hi}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,gt.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Bt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}yi(Bv,"CollisionBuffers");class Pu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ao([]),this.placementViewportMatrix=Ao([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gi(this.zoom,r["text-size"]),this.iconSizeData=gi(this.zoom,r["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(y=>Oa[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new zv(new mc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new zv(new mc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new qn,this.lineVertexArray=new uu,this.symbolInstances=new Kr}calculateGlyphDependencies(e,r,a,h,m){for(let y=0;y<e.length;y++)if(r[e.charCodeAt(y)]=!0,h&&m){const w=lr[e.charAt(y)];w&&(r[w.charCodeAt(0)]=!0)}}populate(e,r,a,h){const m=this.layers[0],y=m.layout,w=this.projection.name==="globe",M=y.get("text-font"),k=y.get("text-field"),B=y.get("icon-image"),U=(k.value.kind!=="constant"||k.value.value instanceof Rs&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),G=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,X=y.get("symbol-sort-key");if(this.features=[],!U&&!G)return;const Y=r.iconDependencies,ie=r.glyphDependencies,de=r.availableImages,Ee=new F(this.zoom);for(const{feature:Re,id:Se,index:De,sourceLayerIndex:Ue}of e){const Be=m._featureFilter.needGeometry,_t=dh(Re,Be);if(!m._featureFilter.filter(Ee,_t,a))continue;if(Be||(_t.geometry=La(Re,a,h)),w&&Re.type!==1&&a.z<=5){const xt=_t.geometry,Ot=.98078528056,Rt=(Ut,ei)=>ao(Zd(Ut.x,Ut.y,a,1),Zd(ei.x,ei.y,a,1))<Ot;for(let Ut=0;Ut<xt.length;Ut++)xt[Ut]=rv(xt[Ut],Rt)}let ft,St;if(U){const xt=m.getValueAndResolveTokens("text-field",_t,a,de),Ot=Rs.factory(xt);$M(Ot)&&(this.hasRTLText=!0),(!this.hasRTLText||E()==="unavailable"||this.hasRTLText&&D.isParsed())&&(ft=_r(Ot,m,_t))}if(G){const xt=m.getValueAndResolveTokens("icon-image",_t,a,de);St=xt instanceof Es?xt:Es.fromString(xt)}if(!ft&&!St)continue;const Zt=this.sortFeaturesByKey?X.evaluate(_t,{},a):void 0;if(this.features.push({id:Se,text:ft,icon:St,index:De,sourceLayerIndex:Ue,geometry:_t.geometry,properties:Re.properties,type:VM[Re.type],sortKey:Zt}),St&&(Y[St.name]=!0),ft){const xt=M.evaluate(_t,{},a).join(","),Ot=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Oa.vertical)>=0;for(const Rt of ft.sections)if(Rt.image)Y[Rt.image.name]=!0;else{const Ut=Ld(ft.toString()),ei=Rt.fontStack||xt,Tt=ie[ei]=ie[ei]||{};this.calculateGlyphDependencies(Rt.text,Tt,Ot,this.allowVerticalPlacement,Ut)}}}y.get("symbol-placement")==="line"&&(this.features=function(Re){const Se={},De={},Ue=[];let Be=0;function _t(xt){Ue.push(Re[xt]),Be++}function ft(xt,Ot,Rt){const Ut=De[xt];return delete De[xt],De[Ot]=Ut,Ue[Ut].geometry[0].pop(),Ue[Ut].geometry[0]=Ue[Ut].geometry[0].concat(Rt[0]),Ut}function St(xt,Ot,Rt){const Ut=Se[Ot];return delete Se[Ot],Se[xt]=Ut,Ue[Ut].geometry[0].shift(),Ue[Ut].geometry[0]=Rt[0].concat(Ue[Ut].geometry[0]),Ut}function Zt(xt,Ot,Rt){const Ut=Rt?Ot[0][Ot[0].length-1]:Ot[0][0];return`${xt}:${Ut.x}:${Ut.y}`}for(let xt=0;xt<Re.length;xt++){const Ot=Re[xt],Rt=Ot.geometry,Ut=Ot.text?Ot.text.toString():null;if(!Ut){_t(xt);continue}const ei=Zt(Ut,Rt),Tt=Zt(Ut,Rt,!0);if(ei in De&&Tt in Se&&De[ei]!==Se[Tt]){const ai=St(ei,Tt,Rt),Ti=ft(ei,Tt,Ue[ai].geometry);delete Se[ei],delete De[Tt],De[Zt(Ut,Ue[Ti].geometry,!0)]=Ti,Ue[ai].geometry=null}else ei in De?ft(ei,Tt,Rt):Tt in Se?St(ei,Tt,Rt):(_t(xt),Se[ei]=Be-1,De[Tt]=Be-1)}return Ue.filter(xt=>xt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Re,Se)=>Re.sortKey-Se.sortKey)}update(e,r,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,a,h),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,a,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=M1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const a=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:h,y:m}of r)this.lineVertexArray.emplaceBack(h,m);return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,r,a,h,m,y,w,M,k,B,U,G,X,Y){const ie=e.indexArray,de=e.layoutVertexArray,Ee=e.globeExtVertexArray,Re=e.segments.prepareSegment(4*r.length,de,ie,this.canOverlap?y.sortKey:void 0),Se=this.glyphOffsetArray.length,De=Re.vertexLength,Ue=this.allowVerticalPlacement&&w===Oa.vertical?Math.PI/2:0,Be=y.text&&y.text.sections;for(let ft=0;ft<r.length;ft++){const{tl:St,tr:Zt,bl:xt,br:Ot,tex:Rt,pixelOffsetTL:Ut,pixelOffsetBR:ei,minFontScaleX:Tt,minFontScaleY:ai,glyphOffset:Ti,isSDF:di,sectionIndex:Xi}=r[ft],ti=Re.vertexLength,Di=Ti[1];if(gy(de,k.x,k.y,St.x,Di+St.y,Rt.x,Rt.y,a,di,Ut.x,Ut.y,Tt,ai),gy(de,k.x,k.y,Zt.x,Di+Zt.y,Rt.x+Rt.w,Rt.y,a,di,ei.x,Ut.y,Tt,ai),gy(de,k.x,k.y,xt.x,Di+xt.y,Rt.x,Rt.y+Rt.h,a,di,Ut.x,ei.y,Tt,ai),gy(de,k.x,k.y,Ot.x,Di+Ot.y,Rt.x+Rt.w,Rt.y+Rt.h,a,di,ei.x,ei.y,Tt,ai),M){const{x:Zi,y:Sr,z:Yi}=M.anchor,[Bi,ln,Qi]=M.up;_y(Ee,Zi,Sr,Yi,Bi,ln,Qi),_y(Ee,Zi,Sr,Yi,Bi,ln,Qi),_y(Ee,Zi,Sr,Yi,Bi,ln,Qi),_y(Ee,Zi,Sr,Yi,Bi,ln,Qi),yy(e.dynamicLayoutVertexArray,Zi,Sr,Yi,Ue)}else yy(e.dynamicLayoutVertexArray,k.x,k.y,k.z,Ue);ie.emplaceBack(ti,ti+1,ti+2),ie.emplaceBack(ti+1,ti+2,ti+3),Re.vertexLength+=4,Re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ti[0]),ft!==r.length-1&&Xi===r[ft+1].sectionIndex||e.programConfigurations.populatePaintArrays(de.length,y,y.index,{},X,Y,Be&&Be[Xi])}const _t=M?M.anchor:k;e.placedSymbolArray.emplaceBack(_t.x,_t.y,_t.z,k.x,k.y,Se,this.glyphOffsetArray.length-Se,De,B,U,k.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],w,0,!1,0,G,0)}_commitLayoutVertex(e,r,a,h,m,y,w){e.emplaceBack(r,a,h,m,y,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(e,r,a,h,m,y,w){const M=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),k=M.vertexLength,B=w.tileAnchorX,U=w.tileAnchorY;for(let X=0;X<4;X++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,B,U,new He(e.x1,e.y2)),M.vertexLength+=4;const G=a.indexArray;G.emplaceBack(k,k+1),G.emplaceBack(k+1,k+2),G.emplaceBack(k+2,k+3),G.emplaceBack(k+3,k),M.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceTextSize(e,y,r,w);this._addCollisionDebugVertices(M,k,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceIconSize(e,r,y.placedIconSymbolIndex);this._addCollisionDebugVertices(M,k,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,y)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Bv(bi,Jt.members,ns),this.iconCollisionBox=new Bv(bi,Jt.members,ns);const a=wi(this.iconSizeData,e),h=wi(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(h,e,r,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,e,r,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(a,e,r,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(a,e,r,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(e,r,a,h){const m=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:h),y=Ui(this.textSizeData,e,m)/Ft;return this.tilePixelRatio*y}getSymbolInstanceIconSize(e,r,a){const h=this.icon.placedSymbolArray.get(a),m=Ui(this.iconSizeData,e,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(e,r,a){e.emplaceBack(r,-a,-a),e.emplaceBack(r,a,-a),e.emplaceBack(r,a,a),e.emplaceBack(r,-a,a)}_updateTextDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceTextSize(e,y,r,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,M.padding)}}_updateIconDebugCollisionBoxes(e,r,a,h,m,y){for(let w=h;w<m;w++){const M=a.get(w),k=this.getSymbolInstanceIconSize(e,r,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,M.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=wi(this.iconSizeData,e),h=wi(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(h,e,r,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,e,r,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(a,e,r,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,r,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,a,h,m,y,w,M,k){const B={};if(r<a){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ue}=e.get(r);B.textBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.textFeatureIndex=Ue}if(h<m){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ue}=e.get(h);B.verticalTextBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.verticalTextFeatureIndex=Ue}if(y<w){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ue}=e.get(y);B.iconBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.iconFeatureIndex=Ue}if(M<k){const{x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De,featureIndex:Ue}=e.get(M);B.verticalIconBox={x1:U,y1:G,x2:X,y2:Y,padding:ie,projectedAnchorX:de,projectedAnchorY:Ee,projectedAnchorZ:Re,tileAnchorX:Se,tileAnchorY:De},B.verticalIconFeatureIndex=Ue}return B}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const a=e.placedSymbolArray.get(r),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),a=Math.cos(e),h=[],m=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const M=this.symbolInstances.get(w);h.push(0|Math.round(r*M.tileAnchorX+a*M.tileAnchorY)),m.push(M.featureIndex)}return y.sort((w,M)=>h[w]-h[M]||m[M]-m[w]),y}addToSortKeyRanges(e,r){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===r?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const a=this.symbolInstances.get(r);this.featureSortOrder.push(a.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:k}=a;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&this.addIndicesForPlacedSymbol(this.text,m),y>=0&&y!==m&&y!==h&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}yi(Pu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Pu.MAX_GLYPHS=65535,Pu.addDynamicAttributes=yy;const GM=new Ie({"symbol-placement":new ee(wt.layout_symbol["symbol-placement"]),"symbol-spacing":new ee(wt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ee(wt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pe(wt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ee(wt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ee(wt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ee(wt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ee(wt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ee(wt.layout_symbol["icon-rotation-alignment"]),"icon-size":new pe(wt.layout_symbol["icon-size"]),"icon-text-fit":new ee(wt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ee(wt.layout_symbol["icon-text-fit-padding"]),"icon-image":new pe(wt.layout_symbol["icon-image"]),"icon-rotate":new pe(wt.layout_symbol["icon-rotate"]),"icon-padding":new ee(wt.layout_symbol["icon-padding"]),"icon-keep-upright":new ee(wt.layout_symbol["icon-keep-upright"]),"icon-offset":new pe(wt.layout_symbol["icon-offset"]),"icon-anchor":new pe(wt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ee(wt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ee(wt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ee(wt.layout_symbol["text-rotation-alignment"]),"text-field":new pe(wt.layout_symbol["text-field"]),"text-font":new pe(wt.layout_symbol["text-font"]),"text-size":new pe(wt.layout_symbol["text-size"]),"text-max-width":new pe(wt.layout_symbol["text-max-width"]),"text-line-height":new pe(wt.layout_symbol["text-line-height"]),"text-letter-spacing":new pe(wt.layout_symbol["text-letter-spacing"]),"text-justify":new pe(wt.layout_symbol["text-justify"]),"text-radial-offset":new pe(wt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ee(wt.layout_symbol["text-variable-anchor"]),"text-anchor":new pe(wt.layout_symbol["text-anchor"]),"text-max-angle":new ee(wt.layout_symbol["text-max-angle"]),"text-writing-mode":new ee(wt.layout_symbol["text-writing-mode"]),"text-rotate":new pe(wt.layout_symbol["text-rotate"]),"text-padding":new ee(wt.layout_symbol["text-padding"]),"text-keep-upright":new ee(wt.layout_symbol["text-keep-upright"]),"text-transform":new pe(wt.layout_symbol["text-transform"]),"text-offset":new pe(wt.layout_symbol["text-offset"]),"text-allow-overlap":new ee(wt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ee(wt.layout_symbol["text-ignore-placement"]),"text-optional":new ee(wt.layout_symbol["text-optional"])});var Fv={paint:new Ie({"icon-opacity":new pe(wt.paint_symbol["icon-opacity"]),"icon-color":new pe(wt.paint_symbol["icon-color"]),"icon-halo-color":new pe(wt.paint_symbol["icon-halo-color"]),"icon-halo-width":new pe(wt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pe(wt.paint_symbol["icon-halo-blur"]),"icon-translate":new ee(wt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ee(wt.paint_symbol["icon-translate-anchor"]),"text-opacity":new pe(wt.paint_symbol["text-opacity"]),"text-color":new pe(wt.paint_symbol["text-color"],{runtimeType:Ls,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new pe(wt.paint_symbol["text-halo-color"]),"text-halo-width":new pe(wt.paint_symbol["text-halo-width"]),"text-halo-blur":new pe(wt.paint_symbol["text-halo-blur"]),"text-translate":new ee(wt.paint_symbol["text-translate"]),"text-translate-anchor":new ee(wt.paint_symbol["text-translate-anchor"])}),layout:GM};class I1{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Wl,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}yi(I1,"FormatSectionOverride",{omit:["defaultValue"]});class xy extends Aa{constructor(e){super(e,Fv)}recalculate(e,r){super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,a,h){const m=this.layout.get(e).evaluate(r,{},a,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ar(y.value)||!m?m:function(w,M){return M.replace(/{([^{}]+)}/g,(k,B)=>B in w?String(w[B]):"")}(r.properties,m)}createBucket(e){return new Pu(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Fv.paint.overridableProperties){if(!xy.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),a=new I1(r),h=new ms(a,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new ru("source",h):new yl("composite",h,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new _e(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,a){return!(!this.layout||r.isDataDriven()||a.isDataDriven())&&xy.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const a=e.get("text-field"),h=Fv.paint.properties[r];let m=!1;const y=w=>{for(const M of w)if(h.overrides&&h.overrides.hasOverride(M))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Rs)y(a.value.value.sections);else if(a.value.kind==="source"){const w=k=>{m||(k instanceof ga&&vn(k.value)===fs?y(k.value.sections):k instanceof ya?y(k.sections):k.eachChild(w))},M=a.value;M._styleExpression&&w(M._styleExpression.expression)}return m}getProgramConfiguration(e){return new pc(this,e)}}var WM={paint:new Ie({"background-color":new ee(wt.paint_background["background-color"]),"background-pattern":new ee(wt.paint_background["background-pattern"]),"background-opacity":new ee(wt.paint_background["background-opacity"])})},HM={paint:new Ie({"raster-opacity":new ee(wt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ee(wt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ee(wt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ee(wt.paint_raster["raster-brightness-max"]),"raster-saturation":new ee(wt.paint_raster["raster-saturation"]),"raster-contrast":new ee(wt.paint_raster["raster-contrast"]),"raster-resampling":new ee(wt.paint_raster["raster-resampling"]),"raster-fade-duration":new ee(wt.paint_raster["raster-fade-duration"])})};class qM extends Aa{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var XM={paint:new Ie({"sky-type":new ee(wt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ee(wt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ee(wt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ee(wt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ee(wt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ce(wt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ee(wt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ee(wt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ee(wt.paint_sky["sky-opacity"])})};function Nv(i,e,r){const a=[0,0,1],h=xs([]);return Nm(h,h,r?-dt(i)+Math.PI:dt(i)),E_(h,h,-dt(e)),Er(a,a,h),Bs(a,a)}const ZM={circle:class extends Aa{constructor(i){super(i,bc)}createBucket(i){return new bu(i)}queryRadius(i){const e=i;return Tu("circle-radius",this,e)+Tu("circle-stroke-width",this,e)+el(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,r,a,h,m,y,w){const M=Sp(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return Eu(i,a,m,y,w,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,k)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new pc(this,i)}},heatmap:class extends Aa{createBucket(i){return new Zm(i)}constructor(i){super(i,av),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ym({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Tu("heatmap-radius",this,i)}queryIntersectsFeature(i,e,r,a,h,m,y,w){const M=this.paint.get("heatmap-radius").evaluate(e,r);return Eu(i,a,m,y,w,!0,!0,new He(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new pc(this,i)}},hillshade:class extends Aa{constructor(i){super(i,lv)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Aa{constructor(i){super(i,yv)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(i){return new pc(this,i)}recalculate(i,e){super.recalculate(i,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new cf(i)}queryRadius(){return el(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,r,a,h,m){return!i.queryGeometry.isAboveHorizon&&qm(Xm(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends Aa{constructor(i){super(i,o)}createBucket(i){return new ff(i)}queryRadius(){return el(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new pc(this,i)}queryIntersectsFeature(i,e,r,a,h,m,y,w,M){const k=Sp(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),B=this.paint.get("fill-extrusion-height").evaluate(e,r),U=this.paint.get("fill-extrusion-base").evaluate(e,r),G=[0,0],X=w&&m.elevation,Y=m.elevation?m.elevation.exaggeration():1,ie=i.tile.getBucket(this);if(X&&ie instanceof ff){const De=ie.centroidVertexArray,Ue=M+1;Ue<De.length&&(G[0]=De.geta_centroid_pos0(Ue),G[1]=De.geta_centroid_pos1(Ue))}if(G[0]===0&&G[1]===1)return!1;m.projection.name==="globe"&&(a=cg([a],[new He(0,0),new He(Mi,Mi)],i.tileID.canonical).map(De=>De.polygon).flat());const de=X?w:null,[Ee,Re]=function(De,Ue,Be,_t,ft,St,Zt,xt,Ot,Rt,Ut){return De.projection.name==="globe"?function(ei,Tt,ai,Ti,di,Xi,ti,Di,Zi,Sr,Yi){const Bi=[],ln=[],Qi=ei.projection.upVectorScale(Yi,ei.center.lat,ei.worldSize).metersToTile,er=[0,0,0,1],Wr=[0,0,0,1],Qr=(Hr,Tn,jn,Zn)=>{Hr[0]=Tn,Hr[1]=jn,Hr[2]=Zn,Hr[3]=1},en=oy();ai>0&&(ai+=en),Ti+=en;for(const Hr of Tt){const Tn=[],jn=[];for(const Zn of Hr){const qr=Zn.x+di.x,ss=Zn.y+di.y,Yn=ei.projection.projectTilePoint(qr,ss,Yi),Pn=ei.projection.upVector(Yi,Zn.x,Zn.y);let Ir=ai,Kn=Ti;if(ti){const tn=N(qr,ss,ai,Ti,ti,Di,Zi,Sr);Ir+=tn.base,Kn+=tn.top}ai!==0?Qr(er,Yn.x+Pn[0]*Qi*Ir,Yn.y+Pn[1]*Qi*Ir,Yn.z+Pn[2]*Qi*Ir):Qr(er,Yn.x,Yn.y,Yn.z),Qr(Wr,Yn.x+Pn[0]*Qi*Kn,Yn.y+Pn[1]*Qi*Kn,Yn.z+Pn[2]*Qi*Kn),mn(er,er,Xi),mn(Wr,Wr,Xi),Tn.push(new A(er[0],er[1],er[2])),jn.push(new A(Wr[0],Wr[1],Wr[2]))}Bi.push(Tn),ln.push(jn)}return[Bi,ln]}(De,Ue,Be,_t,ft,St,Zt,xt,Ot,Rt,Ut):Zt?function(ei,Tt,ai,Ti,di,Xi,ti,Di,Zi){const Sr=[],Yi=[],Bi=[0,0,0,1];for(const ln of ei){const Qi=[],er=[];for(const Wr of ln){const Qr=Wr.x+Ti.x,en=Wr.y+Ti.y,Hr=N(Qr,en,Tt,ai,Xi,ti,Di,Zi);Bi[0]=Qr,Bi[1]=en,Bi[2]=Hr.base,Bi[3]=1,Fs(Bi,Bi,di),Bi[3]=Math.max(Bi[3],1e-5);const Tn=new A(Bi[0]/Bi[3],Bi[1]/Bi[3],Bi[2]/Bi[3]);Bi[0]=Qr,Bi[1]=en,Bi[2]=Hr.top,Bi[3]=1,Fs(Bi,Bi,di),Bi[3]=Math.max(Bi[3],1e-5);const jn=new A(Bi[0]/Bi[3],Bi[1]/Bi[3],Bi[2]/Bi[3]);Qi.push(Tn),er.push(jn)}Sr.push(Qi),Yi.push(er)}return[Sr,Yi]}(Ue,Be,_t,ft,St,Zt,xt,Ot,Rt):function(ei,Tt,ai,Ti,di){const Xi=[],ti=[],Di=di[8]*Tt,Zi=di[9]*Tt,Sr=di[10]*Tt,Yi=di[11]*Tt,Bi=di[8]*ai,ln=di[9]*ai,Qi=di[10]*ai,er=di[11]*ai;for(const Wr of ei){const Qr=[],en=[];for(const Hr of Wr){const Tn=Hr.x+Ti.x,jn=Hr.y+Ti.y,Zn=di[0]*Tn+di[4]*jn+di[12],qr=di[1]*Tn+di[5]*jn+di[13],ss=di[2]*Tn+di[6]*jn+di[14],Yn=di[3]*Tn+di[7]*jn+di[15],Pn=Zn+Di,Ir=qr+Zi,Kn=ss+Sr,tn=Math.max(Yn+Yi,1e-5),ho=Zn+Bi,Jn=qr+ln,As=ss+Qi,bs=Math.max(Yn+er,1e-5);Qr.push(new A(Pn/tn,Ir/tn,Kn/tn)),en.push(new A(ho/bs,Jn/bs,As/bs))}Xi.push(Qr),ti.push(en)}return[Xi,ti]}(Ue,Be,_t,ft,St)}(m,a,U,B,k,y,de,G,Y,m.center.lat,i.tileID.canonical),Se=i.queryGeometry;return function(De,Ue,Be){let _t=1/0;qm(Be,Ue)&&(_t=O(Be,Ue[0]));for(let ft=0;ft<Ue.length;ft++){const St=Ue[ft],Zt=De[ft];for(let xt=0;xt<St.length-1;xt++){const Ot=St[xt],Rt=[Ot,St[xt+1],Zt[xt+1],Zt[xt],Ot];Qd(Be,Rt)&&(_t=Math.min(_t,O(Be,Rt)))}}return _t!==1/0&&_t}(Ee,Re,Se.isPointQuery()?Se.screenBounds:Se.screenGeometry)}},line:class extends Aa{constructor(i){super(i,fe),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof dd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=Xe.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new te(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new pc(this,i)}queryRadius(i){const e=i,r=Ne(Tu("line-width",this,e),Tu("line-gap-width",this,e)),a=Tu("line-offset",this,e);return r/2+Math.abs(a)+el(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,r,a,h,m){if(i.queryGeometry.isAboveHorizon)return!1;const y=Xm(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),w=i.pixelToTileUnitsFactor/2*Ne(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),M=this.paint.get("line-offset").evaluate(e,r);return M&&(a=function(k,B){const U=[],G=new He(0,0);for(let X=0;X<k.length;X++){const Y=k[X],ie=[];for(let de=0;de<Y.length;de++){const Ee=Y[de],Re=Y[de+1],Se=de===0?G:Ee.sub(Y[de-1])._unit()._perp(),De=de===Y.length-1?G:Re.sub(Ee)._unit()._perp(),Ue=Se._add(De)._unit();Ue._mult(1/(Ue.x*De.x+Ue.y*De.y)),ie.push(Ue._mult(B)._add(Ee))}U.push(ie)}return U}(a,M*i.pixelToTileUnitsFactor)),function(k,B,U){for(let G=0;G<B.length;G++){const X=B[G];if(k.length>=3){for(let Y=0;Y<X.length;Y++)if(Qa(k,X[Y]))return!0}if(F_(k,X,U))return!0}return!1}(y,a,w)}isTileClipped(){return!0}},symbol:xy,background:class extends Aa{constructor(i){super(i,WM)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Aa{constructor(i){super(i,HM)}getProgramIds(){return["raster"]}},sky:class extends Aa{constructor(i){super(i,XM),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ym({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const a=this.paint.get("sky-atmosphere-sun"),h=!a,m=i.style.light,y=m.properties.get("position");return h&&m.properties.get("anchor")==="viewport"&&Lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Nv(y.azimuthal,90-y.polar,e):Nv(a[0],90-a[1],e)}const r=this.paint.get("sky-gradient-center");return Nv(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class _g{constructor(e,r,a,h){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(r,h)}update(e,r,a){const{width:h,height:m}=e,{context:y}=this,{gl:w}=y,{HTMLImageElement:M,HTMLCanvasElement:k,HTMLVideoElement:B,ImageData:U,ImageBitmap:G}=$;if(w.bindTexture(w.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!r||r.premultiply!==!1)),a||this.size&&this.size[0]===h&&this.size[1]===m){const{x:X,y:Y}=a||{x:0,y:0};e instanceof M||e instanceof k||e instanceof B||e instanceof U||G&&e instanceof G?w.texSubImage2D(w.TEXTURE_2D,0,X,Y,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,X,Y,h,m,w.RGBA,w.UNSIGNED_BYTE,e.data)}else this.size=[h,m],e instanceof M||e instanceof k||e instanceof B||e instanceof U||G&&e instanceof G?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,h,m,0,this.format,w.UNSIGNED_BYTE,e.data);this.useMipmap=!!(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(e,r){const{context:a}=this,{gl:h}=a;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,r),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class YM{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class KM{constructor(){this.tasks={},this.taskQueue=[],Ei(["process"],this),this.invoker=new YM(this.process),this.nextId=0}add(e,r){const a=this.nextId++,h=function({type:m,isSymbolTile:y,zoom:w}){return w=w||0,m==="message"?0:m!=="maybePrepare"||y?m!=="parseTile"||y?m==="parseTile"&&y?300-w:m==="maybePrepare"&&y?400-w:500:200-w:100-w}(r);if(h===0){oi();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:r,priority:h,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){oi();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<r&&(r=m.priority,e=h)}if(e===null)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class k1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const a=e[r];this._stringToNumber[a]=r,this._numberToString[r]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const JM=["tile","layer","source","sourceLayer","state"];class P1{constructor(e,r,a,h,m){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=a,this._y=h,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const r of JM)this[r]!==void 0&&(e[r]=this[r]);return e}}const tl=32,Ec=33,Lu=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,r=0,a=0,h=0,m=0,y=0,w=0;for(1&e?h=m=y=tl:r=a=w=tl;(e>>=1)>1;){const k=r+h>>1,B=a+m>>1;1&e?(h=r,m=a,r=y,a=w):(r=h,a=m,h=y,m=w),y=k,w=B}const M=4*i;Lu[M+0]=r,Lu[M+1]=a,Lu[M+2]=h,Lu[M+3]=m}const Sc=new Uint16Array(2178),Du=new Uint8Array(1089),vy=new Uint16Array(1089);function L1(i){return i===0?-.03125:i===32?.03125:0}var D1=et([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const O1={type:2,extent:Mi,loadGeometry:()=>[[new He(0,0),new He(Mi+1,0),new He(Mi+1,Mi+1),new He(0,Mi+1),new He(0,0)]]};class Uv{constructor(e,r,a,h,m){this.tileID=e,this.uid=sn(),this.uses=0,this.tileSize=r,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<Vo.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=yf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const y={};if(!m)return y;for(const w of h){const M=w.layerIds.map(k=>m.getLayer(k)).filter(Boolean);if(M.length!==0){w.layers=M,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(k=>M.filter(B=>B.id===k)[0]));for(const k of M)y[k.id]=w}}return y}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof Pu){if(this.hasSymbolBuckets=!0,!a)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof Pu&&m.hasRTLText){this.hasRTLText=!0,D.isLoading()||D.isLoaded()||E()!=="deferred"||L();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Vr}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const h=this.buckets[a];h.uploadPending()&&h.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _g(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _g(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new _g(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,a,h,m,y,w,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:w,transform:y,params:m,tileTransform:this.tileTransform},e,r,a):{}}querySourceFeatures(e,r){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const h=a.loadVTLayers(),m=r?r.sourceLayer:"",y=h._geojsonTileLayer||h[m];if(!y)return;const w=nu(r&&r.filter),{z:M,x:k,y:B}=this.tileID.canonical,U={z:M,x:k,y:B};for(let G=0;G<y.length;G++){const X=y.feature(G);if(w.needGeometry){const de=dh(X,!0);if(!w.filter(new F(this.tileID.overscaledZ),de,this.tileID.canonical))continue}else if(!w.filter(new F(this.tileID.overscaledZ),X))continue;const Y=a.getId(X,m),ie=new P1(X,M,k,B,Y);ie.tile=U,e.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const a=Te(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let h=!1;if(this.expirationTime>a)h=!1;else if(r)if(this.expirationTime<r)h=!0;else{const m=this.expirationTime-r;m?this.expirationTime=a+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!r)return;const a=this.latestFeatureIndex.loadVTLayers(),h=r.style.listImages();for(const m in this.buckets){if(!r.style.hasLayer(m))continue;const y=this.buckets[m],w=y.layers[0].sourceLayer||"_geojsonTileLayer",M=a[w],k=e[w];if(!M||!k||Object.keys(k).length===0)continue;if(y.update(k,M,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof te||y instanceof cf){const U=r.style._getSourceCache(y.layers[0].source);r._terrain&&r._terrain.enabled&&U&&y.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(U.id,this.tileID)}const B=r&&r.style&&r.style.getLayer(m);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Vo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Vo.now()+e}setTexture(e,r){const a=r.context,h=a.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new _g(a,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(e,r){const a={};for(const h of r)a[h]=!0;this.dependencies[e]=a}hasDependency(e,r){for(const a of e){const h=this.dependencies[a];if(h){for(const m of r)if(h[m])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const a=La(O1,this.tileID.canonical,this.tileTransform)[0],h=new Nt,m=new no;for(let y=0;y<a.length;y++){const{x:w,y:M}=a[y];h.emplaceBack(w,M),m.emplaceBack(y)}m.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(m),this._tileDebugBuffer=e.createVertexBuffer(h,Qo.members),this._tileDebugSegments=In.simpleSegment(0,0,h.length,m.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const a=La(O1,this.tileID.canonical,this.tileTransform)[0];let h,m;if(this.isRaster){const y=function(w,M){const k=yf(w,M),B=Math.pow(2,w.z);for(let de=0;de<Ec;de++)for(let Ee=0;Ee<Ec;Ee++){const Re=ko((w.x+(Ee+L1(Ee))/tl)/B),Se=vs((w.y+(de+L1(de))/tl)/B),De=M.project(Re,Se),Ue=de*Ec+Ee;Sc[2*Ue+0]=Math.round((De.x*k.scale-k.x)*Mi),Sc[2*Ue+1]=Math.round((De.y*k.scale-k.y)*Mi)}Du.fill(0),vy.fill(0);for(let de=2045;de>=0;de--){const Ee=4*de,Re=Lu[Ee+0],Se=Lu[Ee+1],De=Lu[Ee+2],Ue=Lu[Ee+3],Be=Re+De>>1,_t=Se+Ue>>1,ft=Be+_t-Se,St=_t+Re-Be,Zt=Se*Ec+Re,xt=Ue*Ec+De,Ot=_t*Ec+Be,Rt=Math.hypot((Sc[2*Zt+0]+Sc[2*xt+0])/2-Sc[2*Ot+0],(Sc[2*Zt+1]+Sc[2*xt+1])/2-Sc[2*Ot+1])>=16;Du[Ot]=Du[Ot]||(Rt?1:0),de<1022&&(Du[Ot]=Du[Ot]||Du[(Se+St>>1)*Ec+(Re+ft>>1)]||Du[(Ue+St>>1)*Ec+(De+ft>>1)])}const U=new Ct,G=new Ai;let X=0;function Y(de,Ee){const Re=Ee*Ec+de;return vy[Re]===0&&(U.emplaceBack(Sc[2*Re+0],Sc[2*Re+1],de*Mi/tl,Ee*Mi/tl),vy[Re]=++X),vy[Re]-1}function ie(de,Ee,Re,Se,De,Ue){const Be=de+Re>>1,_t=Ee+Se>>1;if(Math.abs(de-De)+Math.abs(Ee-Ue)>1&&Du[_t*Ec+Be])ie(De,Ue,de,Ee,Be,_t),ie(Re,Se,De,Ue,Be,_t);else{const ft=Y(de,Ee),St=Y(Re,Se),Zt=Y(De,Ue);G.emplaceBack(ft,St,Zt)}}return ie(0,0,tl,tl,tl,0),ie(tl,tl,0,0,0,tl),{vertices:U,indices:G}}(this.tileID.canonical,r);h=y.vertices,m=y.indices}else{h=new Ct,m=new Ai;for(const{x:w,y:M}of a)h.emplaceBack(w,M,0,0);const y=ig(h.int16,void 0,4);for(let w=0;w<y.length;w+=3)m.emplaceBack(y[w],y[w+1],y[w+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,D1.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(m),this._tileBoundsSegments=In.simpleSegment(0,0,h.length,m.length)}_makeGlobeTileDebugBuffers(e,r){const a=r.projection;if(!a||a.name!=="globe"||r.freezeTileCoverage)return;const h=this.tileID.canonical,m=uh(jm(h,r)),y=yu(r.zoom);let w;y>0&&(w=hp(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,h,r,m,w,y),this._makeGlobeTileDebugTextBuffer(e,h,r,m,w,y)}_globePoint(e,r,a,h,m,y,w){let M=Zd(e,r,a);if(y){const k=1<<a.z,B=ka(h.center.lng),U=ta(h.center.lat),G=(a.x+.5)/k-B;let X=0;G>.5?X=-1:G<-.5&&(X=1);let Y=(e/Mi+a.x)/k+X,ie=(r/Mi+a.y)/k;Y=(Y-B)*h._pixelsPerMercatorPixel+B,ie=(ie-U)*h._pixelsPerMercatorPixel+U;const de=[Y*h.worldSize,ie*h.worldSize,0];mn(de,de,y),M=Ia(M,de,w)}return mn(M,M,m)}_makeGlobeTileDebugBorderBuffer(e,r,a,h,m,y){const w=new Nt,M=new no,k=new ht,B=(G,X,Y,ie,de)=>{const Ee=(Y-G)/(de-1),Re=(ie-X)/(de-1),Se=w.length;for(let De=0;De<de;De++){const Ue=G+De*Ee,Be=X+De*Re;w.emplaceBack(Ue,Be);const _t=this._globePoint(Ue,Be,r,a,h,m,y);k.emplaceBack(_t[0],_t[1],_t[2]),M.emplaceBack(Se+De)}},U=Mi;B(0,0,U,0,16),B(U,0,U,U,16),B(U,U,0,U,16),B(0,U,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(M),this._tileDebugBuffer=e.createVertexBuffer(w,Qo.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(k,A_.members),this._tileDebugSegments=In.simpleSegment(0,0,w.length,M.length)}_makeGlobeTileDebugTextBuffer(e,r,a,h,m,y){const w=Mi/4,M=new Nt,k=new Ai,B=new ht,U=25;k.reserve(32),M.reserve(U),B.reserve(U);const G=(X,Y)=>U*X+Y;for(let X=0;X<U;X++){const Y=X*w;for(let ie=0;ie<U;ie++){const de=ie*w;M.emplaceBack(de,Y);const Ee=this._globePoint(de,Y,r,a,h,m,y);B.emplaceBack(Ee[0],Ee[1],Ee[2])}}for(let X=0;X<4;X++)for(let Y=0;Y<4;Y++){const ie=G(X,Y),de=G(X,Y+1),Ee=G(X+1,Y),Re=G(X+1,Y+1);k.emplaceBack(ie,de,Ee),k.emplaceBack(Ee,de,Re)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(k),this._tileDebugTextBuffer=e.createVertexBuffer(M,Qo.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(B,A_.members),this._tileDebugTextSegments=In.simpleSegment(0,0,U,32)}}class QM{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,a){const h=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},fr(this.stateChanges[e][h],a),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])a[m]||(this.deletedStates[e][h][m]=null)}else for(const m in a)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,r,a){if(this.deletedStates[e]===null)return;const h=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&r!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][a]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(a in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][a]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,r){const a=String(r),h=fr({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][r];if(m===null)return{};for(const y in m)delete h[y]}return h}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const a={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),fr(this.state[h][y],this.stateChanges[h][y]),m[y]=this.state[h][y];a[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const y in this.state[h])m[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(this.deletedStates[h][y]===null)this.state[h][y]={};else if(this.state[h][y])for(const w of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][w];m[y]=this.state[h][y]}a[h]=a[h]||{},fr(a[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(const h in e)e[h].setFeatureState(a,r)}}class R1{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const a=this.toIdx(e,r);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function z1(i,e,r,a){let h=0,m=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(a[y])<1e-15){if(r[y]<i[y]||r[y]>e[y])return null}else{const w=1/a[y];let M=(i[y]-r[y])*w,k=(e[y]-r[y])*w;if(M>k){const B=M;M=k,k=B}if(M>h&&(h=M),k<m&&(m=k),h>m)return null}return h}function B1(i,e,r,a,h,m,y,w,M,k,B){const U=a-i,G=h-e,X=m-r,Y=y-i,ie=w-e,de=M-r,Ee=B[1]*de-B[2]*ie,Re=B[2]*Y-B[0]*de,Se=B[0]*ie-B[1]*Y,De=U*Ee+G*Re+X*Se;if(Math.abs(De)<1e-15)return null;const Ue=1/De,Be=k[0]-i,_t=k[1]-e,ft=k[2]-r,St=(Be*Ee+_t*Re+ft*Se)*Ue;if(St<0||St>1)return null;const Zt=_t*X-ft*G,xt=ft*U-Be*X,Ot=Be*G-_t*U,Rt=(B[0]*Zt+B[1]*xt+B[2]*Ot)*Ue;return Rt<0||St+Rt>1?null:(Y*Zt+ie*xt+de*Ot)*Ue}function F1(i,e,r){return(i-e)/(r-e)}function N1(i,e,r,a,h,m,y,w,M){const k=1<<r,B=m-a,U=y-h,G=(i+1)/k*B+a,X=(e+0)/k*U+h,Y=(e+1)/k*U+h;w[0]=(i+0)/k*B+a,w[1]=X,M[0]=G,M[1]=Y}class U1{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(m){const y=Math.ceil(Math.log2(m.dim/8)),w=[];let M=Math.ceil(Math.pow(2,y));const k=1/M,B=(X,Y,ie,de,Ee)=>{const Re=de?1:0,Se=(X+1)*ie-Re,De=Y*ie,Ue=(Y+1)*ie-Re;Ee[0]=X*ie,Ee[1]=De,Ee[2]=Se,Ee[3]=Ue};let U=new R1(M);const G=[];for(let X=0;X<M*M;X++){B(X%M,Math.floor(X/M),k,!1,G);const Y=Ou(G[0],G[1],m),ie=Ou(G[2],G[1],m),de=Ou(G[2],G[3],m),Ee=Ou(G[0],G[3],m);U.minimums.push(Math.min(Y,ie,de,Ee)),U.maximums.push(Math.max(Y,ie,de,Ee)),U.leaves.push(1)}for(w.push(U),M/=2;M>=1;M/=2){const X=w[w.length-1];U=new R1(M);for(let Y=0;Y<M*M;Y++){B(Y%M,Math.floor(Y/M),2,!0,G);const ie=X.getElevation(G[0],G[1]),de=X.getElevation(G[2],G[1]),Ee=X.getElevation(G[2],G[3]),Re=X.getElevation(G[0],G[3]),Se=X.isLeaf(G[0],G[1]),De=X.isLeaf(G[2],G[1]),Ue=X.isLeaf(G[2],G[3]),Be=X.isLeaf(G[0],G[3]),_t=Math.min(ie.min,de.min,Ee.min,Re.min),ft=Math.max(ie.max,de.max,Ee.max,Re.max),St=Se&&De&&Ue&&Be;U.maximums.push(ft),U.minimums.push(_t),U.leaves.push(ft-_t<=5&&St?1:0)}w.push(U)}return w}(this.dem),a=r.length-1,h=r[a];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(r,0,0,a,0)}raycastRoot(e,r,a,h,m,y,w=1){return z1([e,r,-100],[a,h,this.maximums[0]*w],m,y)}raycast(e,r,a,h,m,y,w=1){if(!this.nodeCount)return null;const M=this.raycastRoot(e,r,a,h,m,y,w);if(M==null)return null;const k=[],B=[],U=[],G=[],X=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;X.length>0;){const{idx:Y,t:ie,nodex:de,nodey:Ee,depth:Re}=X.pop();if(this.leaves[Y]){N1(de,Ee,Re,e,r,a,h,U,G);const De=1<<Re,Ue=(de+0)/De,Be=(de+1)/De,_t=(Ee+0)/De,ft=(Ee+1)/De,St=Ou(Ue,_t,this.dem)*w,Zt=Ou(Be,_t,this.dem)*w,xt=Ou(Be,ft,this.dem)*w,Ot=Ou(Ue,ft,this.dem)*w,Rt=B1(U[0],U[1],St,G[0],U[1],Zt,G[0],G[1],xt,m,y),Ut=B1(G[0],G[1],xt,U[0],G[1],Ot,U[0],U[1],St,m,y),ei=Math.min(Rt!==null?Rt:Number.MAX_VALUE,Ut!==null?Ut:Number.MAX_VALUE);if(ei!==Number.MAX_VALUE)return ei;{const Tt=jd([],m,y,ie);if(V1(St,Zt,Ot,xt,F1(Tt[0],U[0],G[0]),F1(Tt[1],U[1],G[1]))>=Tt[2])return ie}continue}let Se=0;for(let De=0;De<this._siblingOffset.length;De++){N1((de<<1)+this._siblingOffset[De][0],(Ee<<1)+this._siblingOffset[De][1],Re+1,e,r,a,h,U,G),U[2]=-100,G[2]=this.maximums[this.childOffsets[Y]+De]*w;const Ue=z1(U,G,m,y);if(Ue!=null){const Be=Ue;k[De]=Be;let _t=!1;for(let ft=0;ft<Se&&!_t;ft++)Be>=k[B[ft]]&&(B.splice(ft,0,De),_t=!0);_t||(B[Se]=De),Se++}}for(let De=0;De<Se;De++){const Ue=B[De];X.push({idx:this.childOffsets[Y]+Ue,t:k[Ue],nodex:(de<<1)+this._siblingOffset[Ue][0],nodey:(Ee<<1)+this._siblingOffset[Ue][1],depth:Re+1})}}return null}_addNode(e,r,a){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,a,h,m){if(e[h].isLeaf(r,a)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const y=h-1,w=e[y];let M=0,k=0;for(let B=0;B<this._siblingOffset.length;B++){const U=2*r+this._siblingOffset[B][0],G=2*a+this._siblingOffset[B][1],X=w.getElevation(U,G),Y=w.isLeaf(U,G),ie=this._addNode(X.min,X.max,Y);Y&&(M|=1<<B),k||(k=ie)}for(let B=0;B<this._siblingOffset.length;B++)M&1<<B||this._construct(e,2*r+this._siblingOffset[B][0],2*a+this._siblingOffset[B][1],y,k+B)}}function V1(i,e,r,a,h,m){return mr(mr(i,r,m),mr(e,a,m),h)}function Ou(i,e,r){const a=r.dim,h=vi(i*a-.5,0,a-1),m=vi(e*a-.5,0,a-1),y=Math.floor(h),w=Math.floor(m),M=Math.min(y+1,a-1),k=Math.min(w+1,a-1);return V1(r.get(y,w),r.get(M,w),r.get(y,k),r.get(M,k),h-y,m-w)}const j1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function eI(i,e,r){return(256*i*256+256*e+r)/10-1e4}function tI(i,e,r){return 256*i+e+r/256-32768}class by{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,a,h=!1,m=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return Lt(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const y=this.dim=r.height-2,w=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=a||"mapbox",this.borderReady=h,!h){for(let M=0;M<y;M++)w[this._idx(-1,M)]=w[this._idx(0,M)],w[this._idx(y,M)]=w[this._idx(y-1,M)],w[this._idx(M,-1)]=w[this._idx(M,0)],w[this._idx(M,y)]=w[this._idx(M,y-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(y,-1)]=w[this._idx(y-1,0)],w[this._idx(-1,y)]=w[this._idx(0,y-1)],w[this._idx(y,y)]=w[this._idx(y-1,y-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new U1(this)}get(e,r,a=!1){a&&(e=vi(e,-1,this.dim),r=vi(r,-1,this.dim));const h=4*this._idx(e,r);return(this.encoding==="terrarium"?tI:eI)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return j1[e]}get unpackVector(){return j1[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}static pack(e,r){const a=[0,0,0,0],h=by.getUnpackVector(r);let m=Math.floor((e+h[3])/h[2]);return a[2]=m%256,m=Math.floor(m/256),a[1]=m%256,m=Math.floor(m/256),a[0]=m,a}getPixels(){return new lo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,m=r*this.dim+this.dim,y=a*this.dim,w=a*this.dim+this.dim;switch(r){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:y=w-1;break;case 1:w=y+1}const M=-r*this.dim,k=-a*this.dim;for(let B=y;B<w;B++)for(let U=h;U<m;U++){const G=4*this._idx(U,B),X=4*this._idx(U+M,B+k);this.pixels[G+0]=e.pixels[X+0],this.pixels[G+1]=e.pixels[X+1],this.pixels[G+2]=e.pixels[X+2],this.pixels[G+3]=e.pixels[X+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}yi(by,"DEMData"),yi(U1,"DemMinMaxQuadTree",{omit:["dem"]});class iI{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,a){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:r,timeout:void 0};if(a!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},a)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const a=e.wrapped().key,h=r===void 0?0:this.data[a].indexOf(r),m=this.data[a][h];return this.data[a].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(m.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const a in this.data)for(const h of this.data[a])e(h.value)||r.push(h);for(const a of r)this.remove(a.value.tileID,a)}}class Vp{constructor(e,r,a){this.func=e,this.mask=r,this.range=a}}Vp.ReadOnly=!1,Vp.ReadWrite=!0,Vp.disabled=new Vp(519,Vp.ReadOnly,[0,1]);const Vv=7680;class jv{constructor(e,r,a,h,m,y){this.test=e,this.ref=r,this.mask=a,this.fail=h,this.depthFail=m,this.pass=y}}jv.disabled=new jv({func:519,mask:0},0,0,Vv,Vv,Vv);class Cc{constructor(e,r,a){this.blendFunction=e,this.blendColor=r,this.mask=a}}Cc.Replace=[1,0],Cc.disabled=new Cc(Cc.Replace,An.transparent,[!1,!1,!1,!1]),Cc.unblended=new Cc(Cc.Replace,An.transparent,[!0,!0,!0,!0]),Cc.alphaBlended=new Cc([1,771],An.transparent,[!0,!0,!0,!0]);const $v=1029,Gv=2305;class Pl{constructor(e,r,a){this.enable=e,this.mode=r,this.frontFace=a}}Pl.disabled=new Pl(!1,$v,Gv),Pl.backCCW=new Pl(!0,$v,Gv),Pl.backCW=new Pl(!0,$v,2304),Pl.frontCW=new Pl(!0,1028,2304),Pl.frontCCW=new Pl(!0,1028,Gv);class xf extends jr{constructor(e,r,a){super(),this.id=e,this._onlySymbols=a,r.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new iI(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new QM,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const a=this._tiles[r];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return nn(this._tiles).map(e=>e.tileID).sort($1).map(e=>e.key)}getRenderableIds(e){const r=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&r.push(this._tiles[a]);return e?r.sort((a,h)=>{const m=a.tileID,y=h.tileID,w=new He(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),M=new He(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-y.overscaledZ||M.y-w.y||M.x-w.x}).map(a=>a.tileID.key):r.map(a=>a.tileID).sort($1).map(a=>a.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const a=this._tiles[e];a&&(a.state!=="loading"&&(a.state=r),this._loadTile(a,this._tileLoaded.bind(this,a,e,r)))}_tileLoaded(e,r,a,h){if(h)if(e.state="errored",h.status!==404)this._source.fire(new fa(h,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Vo.now(),a==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new jo("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let h=0;h<r.length;h++){const m=r[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);a(e,y),a(y,e)}}function a(h,m){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=m.tileID.canonical.x-h.tileID.canonical.x;const w=m.tileID.canonical.y-h.tileID.canonical.y,M=Math.pow(2,h.tileID.canonical.z),k=m.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+M)===1?y+=M:Math.abs(y-M)===1&&(y-=M)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,y,w),h.neighboringTiles&&h.neighboringTiles[k]&&(h.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,a,h){for(const m in this._tiles){let y=this._tiles[m];if(h[m]||!y.hasData()||y.tileID.overscaledZ<=r||y.tileID.overscaledZ>a)continue;let w=y.tileID;for(;y&&y.tileID.overscaledZ>r+1;){const k=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[k.key],y&&y.hasData()&&(w=k)}let M=w;for(;M.overscaledZ>r;)if(M=M.scaledTo(M.overscaledZ-1),e[M.key]){h[w.key]=w;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=r?a:null}for(let a=e.overscaledZ-1;a>=r;a--){const h=e.scaledTo(a),m=this._getLoadedTile(h);if(m)return m}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const a=Math.ceil(e.width/r)+1,h=Math.ceil(e.height/r)+1,m=Math.floor(a*h*5),y=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,m):m,w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(w)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const a={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+r),a[m.tileID.key]=m}this._tiles=a;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,r,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let h;this.updateCacheSize(e,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new v(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(h=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(w=>this._source.hasTile(w)))):h=[];const m=this._updateRetainedTiles(h);if(G1(this._source.type)&&h.length!==0){const w={},M={},k=Object.keys(m);for(const U of k){const G=m[U],X=this._tiles[U];if(!X||X.fadeEndTime&&X.fadeEndTime<=Vo.now())continue;const Y=this.findLoadedParent(G,Math.max(G.overscaledZ-xf.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),w[Y.tileID.key]=Y.tileID),M[U]=G}const B=h[h.length-1].overscaledZ;for(const U in this._tiles){const G=this._tiles[U];if(m[U]||!G.hasData())continue;let X=G.tileID;for(;X.overscaledZ>B;){X=X.scaledTo(X.overscaledZ-1);const Y=this._tiles[X.key];if(Y&&Y.hasData()&&M[X.key]){m[U]=G.tileID;break}}}for(const U in w)m[U]||(this._coveredTiles[U]=!0,m[U]=w[U])}for(const w in m)this._tiles[w].clearFadeHold();const y=function(w,M){const k=[];for(const B in w)B in M||k.push(B);return k}(this._tiles,m);for(const w of y){const M=this._tiles[w];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(e.length===0)return r;const a={},h=e.reduce((k,B)=>Math.min(k,B.overscaledZ),1/0),m=e[0].overscaledZ,y=Math.max(m-xf.maxOverzooming,this._source.minzoom),w=Math.max(m+xf.maxUnderzooming,this._source.minzoom),M={};for(const k of e){const B=this._addTile(k);r[k.key]=k,B.hasData()||h<this._source.maxzoom&&(M[k.key]=k)}this._retainLoadedChildren(M,h,w,r);for(const k of e){let B=this._tiles[k.key];if(B.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const G=k.children(this._source.maxzoom)[0],X=this.getTile(G);if(X&&X.hasData()){r[G.key]=G;continue}}else{const G=k.children(this._source.maxzoom);if(r[G[0].key]&&r[G[1].key]&&r[G[2].key]&&r[G[3].key])continue}let U=B.wasRequested();for(let G=k.overscaledZ-1;G>=y;--G){const X=k.scaledTo(G);if(a[X.key]||(a[X.key]=!0,B=this.getTile(X),!B&&U&&(B=this._addTile(X)),B&&(r[X.key]=X,U=B.wasRequested(),B.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let a,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){a=this._loadedParentTiles[h.key];break}r.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(a=this._getLoadedTile(m),a)break;h=m}for(const m of r)this._loadedParentTiles[m]=a}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const a=!!r;if(!a){const h=this.map?this.map.painter:null;r=new Uv(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,a||this._source.fire(new jo("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=r.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,a){const h=[],m=this.transform;if(!m)return h;const y=m.projection.name==="globe",w=ka(m.center.lng);for(const M in this._tiles){const k=this._tiles[M];if(a&&k.clearQueryDebugViz(),k.holdingForFade())continue;let B;if(y){const U=k.tileID.canonical;if(U.z===0){const G=[Math.abs(vi(w,...yg(U,-1))-w),Math.abs(vi(w,...yg(U,1))-w)];B=[0,2*G.indexOf(Math.min(...G))-1]}else{const G=[Math.abs(vi(w,...yg(U,-1))-w),Math.abs(vi(w,...yg(U,0))-w),Math.abs(vi(w,...yg(U,1))-w)];B=[G.indexOf(Math.min(...G))-1]}}else B=[0];for(const U of B){const G=e.containsTile(k,m,r,U);G&&h.push(G)}}return h}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of r)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(G1(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Vo.now())return!0}return!1}setFeatureState(e,r,a){this._state.updateState(e=e||"_geojsonTileLayer",r,a)}removeFeatureState(e,r,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,a)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,a){const h=this._tiles[e];h&&h.setDependencies(r,a)}reloadTilesForDependencies(e,r){for(const a in this._tiles)this._tiles[a].hasDependency(e,r)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(e,r))};return void this._source.on("data",w)}const a=new Map,h=Array.isArray(e)?e:[e],m=this.map.painter.terrain,y=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const w of h){const M=w.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of M)a.set(k.key,k);this.usedForTerrain&&w.updateElevation(!1)}sr(Array.from(a.values()),(w,M)=>{const k=new Uv(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,B=>{this._source.type==="raster-dem"&&k.dem&&this._backfillDEM(k),M(B,k)})},r)}}function $1(i,e){const r=Math.abs(2*i.wrap)-+(i.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||a-r||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function G1(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function yg(i,e){const r=1<<i.z;return[i.x/r+e,(i.x+1)/r+e]}xf.maxOverzooming=10,xf.maxUnderzooming=3;class wy{constructor(e,r,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=a}static create(e,r,a){const h=a||e.findDEMTileFor(r);if(!h||!h.dem)return;const m=h.dem,y=h.tileID,w=1<<r.canonical.z-y.canonical.z;return new wy(h,h.tileSize/Mi/w,[(r.canonical.x/w-y.canonical.x)*m.dim,(r.canonical.y/w-y.canonical.y)*m.dim])}tileCoordToPixel(e,r){const a=r*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),m=Math.floor(a);return new He(h,m)}getElevationAt(e,r,a,h){const m=e*this._scale+this._offset[0],y=r*this._scale+this._offset[1],w=Math.floor(m),M=Math.floor(y),k=this._dem;return h=!!h,a?mr(mr(k.get(w,M,h),k.get(w,M+1,h),y-M),mr(k.get(w+1,M,h),k.get(w+1,M+1,h),y-M),m-w):k.get(w,M,h)}getElevationAtPixel(e,r,a){return this._dem.get(e,r,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Pa(1,e)*this._dem.stride}}class W1{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new vl(Mi,16,0),this.featureIndexArray=new fc,this.promoteId=r}insert(e,r,a,h,m,y=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m,y);const M=this.grid;for(let k=0;k<r.length;k++){const B=r[k],U=[1/0,1/0,-1/0,-1/0];for(let G=0;G<B.length;G++){const X=B[G];U[0]=Math.min(U[0],X.x),U[1]=Math.min(U[1],X.y),U[2]=Math.max(U[2],X.x),U[3]=Math.max(U[3],X.y)}U[0]<Mi&&U[1]<Mi&&U[2]>=0&&U[3]>=0&&M.insert(w,U[0],U[1],U[2],U[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new lg(new ay(this.rawTileData)).layers,this.sourceLayerCoder=new k1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,a,h){this.loadVTLayers();const m=e.params||{},y=nu(m.filter),w=e.tileResult,M=e.transform,k=w.bufferedTilespaceBounds,B=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Y,ie,de,Ee)=>tf(w.bufferedTilespaceGeometry,Y,ie,de,Ee));B.sort(rI);let U=null;M.elevation&&B.length>0&&(U=wy.create(M.elevation,this.tileID));const G={};let X;for(let Y=0;Y<B.length;Y++){const ie=B[Y];if(ie===X)continue;X=ie;const de=this.featureIndexArray.get(ie);let Ee=null;this.loadMatchingFeature(G,de,y,m.layers,m.availableImages,r,a,h,(Re,Se,De,Ue=0)=>(Ee||(Ee=La(Re,this.tileID.canonical,e.tileTransform)),Se.queryIntersectsFeature(w,Re,De,Ee,this.z,e.transform,e.pixelPosMatrix,U,Ue)))}return G}loadMatchingFeature(e,r,a,h,m,y,w,M,k){const{featureIndex:B,bucketIndex:U,sourceLayerIndex:G,layoutVertexArrayOffset:X}=r,Y=this.bucketLayerIDs[U];if(h&&!function(Re,Se){for(let De=0;De<Re.length;De++)if(Se.indexOf(Re[De])>=0)return!0;return!1}(h,Y))return;const ie=this.sourceLayerCoder.decode(G),de=this.vtLayers[ie].feature(B);if(a.needGeometry){const Re=dh(de,!0);if(!a.filter(new F(this.tileID.overscaledZ),Re,this.tileID.canonical))return}else if(!a.filter(new F(this.tileID.overscaledZ),de))return;const Ee=this.getId(de,ie);for(let Re=0;Re<Y.length;Re++){const Se=Y[Re];if(h&&h.indexOf(Se)<0)continue;const De=y[Se];if(!De)continue;let Ue={};Ee!==void 0&&M&&(Ue=M.getState(De.sourceLayer||"_geojsonTileLayer",Ee));const Be=fr({},w[Se]);Be.paint=H1(Be.paint,De.paint,de,Ue,m),Be.layout=H1(Be.layout,De.layout,de,Ue,m);const _t=!k||k(de,De,Ue,X);if(!_t)continue;const ft=new P1(de,this.z,this.x,this.y,Ee);ft.layer=Be;let St=e[Se];St===void 0&&(St=e[Se]=[]),St.push({featureIndex:B,feature:ft,intersectionZ:_t})}}lookupSymbolFeatures(e,r,a,h,m,y,w,M){const k={};this.loadVTLayers();const B=nu(m);for(const U of e)this.loadMatchingFeature(k,{bucketIndex:a,sourceLayerIndex:h,featureIndex:U,layoutVertexArrayOffset:0},B,y,w,M,r);return k}loadFeature(e){const{featureIndex:r,sourceLayerIndex:a}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(a),m=this.vtFeatures[h];if(m[r])return m[r];const y=this.vtLayers[h].feature(r);return m[r]=y,y}hasLayer(e){for(const r of this.bucketLayerIDs)for(const a of r)if(e===a)return!0;return!1}getId(e,r){let a=e.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];h!=null&&(a=e.properties[h]),typeof a=="boolean"&&(a=Number(a))}return a}}function H1(i,e,r,a,h){return Si(i,(m,y)=>{const w=e instanceof be?e.get(y):null;return w&&w.evaluate?w.evaluate(r,a,h):w})}function rI(i,e){return e-i}yi(W1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class q1{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new Il({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const a=this.getKey(e,r);return this.positions[a]}trim(){const e=this.width,r=this.height=mi(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,a){const h=[];let m=e.length%2==1?-e[e.length-1]*a:0,y=e[0]*a,w=!0;h.push({left:m,right:y,isDash:w,zeroLength:e[0]===0});let M=e[0];for(let k=1;k<e.length;k++){w=!w;const B=e[k];m=M*a,M+=B,y=M*a,h.push({left:m,right:y,isDash:w,zeroLength:B===0})}return h}addRoundDash(e,r,a){const h=r/2;for(let m=-a;m<=a;m++){const y=this.width*(this.nextRow+a+m);let w=0,M=e[w];for(let k=0;k<this.width;k++){k/M.right>1&&(M=e[++w]);const B=Math.abs(k-M.left),U=Math.abs(k-M.right),G=Math.min(B,U);let X;const Y=m/a*(h+1);if(M.isDash){const ie=h-Math.abs(Y);X=Math.sqrt(G*G+ie*ie)}else X=h-Math.sqrt(G*G+Y*Y);this.image.data[y+k]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(e,r){for(let M=e.length-1;M>=0;--M){const k=e[M],B=e[M+1];k.zeroLength?e.splice(M,1):B&&B.isDash===k.isDash&&(B.left=k.left,e.splice(M,1))}const a=e[0],h=e[e.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const m=this.width*this.nextRow;let y=0,w=e[y];for(let M=0;M<this.width;M++){M/w.right>1&&(w=e[++y]);const k=Math.abs(M-w.left),B=Math.abs(M-w.right),U=Math.min(k,B);this.image.data[m+M]=Math.max(0,Math.min(255,(w.isDash?U:-U)+r+128))}}addDash(e,r){const a=this.getKey(e,r);if(this.positions[a])return this.positions[a];const h=r==="round",m=h?7:0,y=2*m+1;if(this.nextRow+y>this.height)return Lt("LineAtlas out of space"),null;e.length===0&&e.push(1);let w=0;for(let B=0;B<e.length;B++)e[B]<0&&(Lt("Negative value is found in line dasharray, replacing values with 0"),e[B]=0),w+=e[B];if(w!==0){const B=this.width/w,U=this.getDashRanges(e,this.width,B);h?this.addRoundDash(U,B,m):this.addRegularDash(U,r==="square"?.5*B:0)}const M=this.nextRow+m;this.nextRow+=y;const k={tl:[M,m],br:[w,0]};return this.positions[a]=k,k}}yi(q1,"LineAtlas");const X1=1*kl;class Z1{constructor(e){const r={},a=[];for(const w in e){const M=e[w],k=r[w]={};for(const B in M.glyphs){const U=M.glyphs[+B];if(!U||U.bitmap.width===0||U.bitmap.height===0)continue;const G=U.metrics.localGlyph?X1:1,X={x:0,y:0,w:U.bitmap.width+2*G,h:U.bitmap.height+2*G};a.push(X),k[B]=X}}const{w:h,h:m}=Mv(a),y=new Il({width:h||1,height:m||1});for(const w in e){const M=e[w];for(const k in M.glyphs){const B=M.glyphs[+k];if(!B||B.bitmap.width===0||B.bitmap.height===0)continue;const U=r[w][k],G=B.metrics.localGlyph?X1:1;Il.copy(B.bitmap,y,{x:0,y:0},{x:U.x+G,y:U.y+G},B.bitmap)}}this.image=y,this.positions=r}}yi(Z1,"GlyphAtlas");class nI{constructor(e){this.tileID=new v(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=yf(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,a,h,m){this.status="parsing",this.data=e,this.collisionBoxArray=new Vr;const y=new k1(Object.keys(e.layers).sort()),w=new W1(this.tileID,this.promoteId);w.bucketLayerIDs=[];const M={},k=new q1(256,256),B={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:a},U=r.familiesBySource[this.source];for(const Ue in U){const Be=e.layers[Ue];if(!Be)continue;let _t=!1,ft=!1;for(const xt of U[Ue])xt[0].type==="symbol"?_t=!0:ft=!0;if(this.isSymbolTile===!0&&!_t||this.isSymbolTile===!1&&!ft)continue;Be.version===1&&Lt(`Vector tile source "${this.source}" layer "${Ue}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const St=y.encode(Ue),Zt=[];for(let xt=0;xt<Be.length;xt++){const Ot=Be.feature(xt),Rt=w.getId(Ot,Ue);Zt.push({feature:Ot,id:Rt,index:xt,sourceLayerIndex:St})}for(const xt of U[Ue]){const Ot=xt[0];this.isSymbolTile!==void 0&&Ot.type==="symbol"!==this.isSymbolTile||Ot.minzoom&&this.zoom<Math.floor(Ot.minzoom)||Ot.maxzoom&&this.zoom>=Ot.maxzoom||Ot.visibility!=="none"&&(Wv(xt,this.zoom,a),(M[Ot.id]=Ot.createBucket({index:w.bucketLayerIDs.length,layers:xt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:St,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(Zt,B,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(xt.map(Rt=>Rt.id)))}}let G,X,Y,ie;k.trim();const de={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ee=()=>{if(G)return m(G);if(X&&Y&&ie){const Ue=new Z1(X),Be=new i1(Y,ie);for(const _t in M){const ft=M[_t];ft instanceof Pu?(Wv(ft.layers,this.zoom,a),kM(ft,X,Ue.positions,Y,Be.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):ft.hasPattern&&(ft instanceof te||ft instanceof cf||ft instanceof ff)&&(Wv(ft.layers,this.zoom,a),ft.addFeatures(B,this.tileID.canonical,Be.patternPositions,a,this.tileTransform))}this.status="done",m(null,{buckets:nn(M).filter(_t=>!_t.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ue.image,lineAtlas:k,imageAtlas:Be,glyphMap:this.returnDependencies?X:null,iconMap:this.returnDependencies?Y:null,glyphPositions:this.returnDependencies?Ue.positions:null})}},Re=Si(B.glyphDependencies,Ue=>Object.keys(Ue).map(Number));Object.keys(Re).length?h.send("getGlyphs",{uid:this.uid,stacks:Re},(Ue,Be)=>{G||(G=Ue,X=Be,Ee())},void 0,!1,de):X={};const Se=Object.keys(B.iconDependencies);Se.length?h.send("getImages",{icons:Se,source:this.source,tileID:this.tileID,type:"icons"},(Ue,Be)=>{G||(G=Ue,Y=Be,Ee())},void 0,!1,de):Y={};const De=Object.keys(B.patternDependencies);De.length?h.send("getImages",{icons:De,source:this.source,tileID:this.tileID,type:"patterns"},(Ue,Be)=>{G||(G=Ue,ie=Be,Ee())},void 0,!1,de):ie={},Ee()}}function Wv(i,e,r){const a=new F(e);for(const h of i)h.recalculate(a,r)}class Y1{constructor(e){this.entries={},this.scheduler=e}request(e,r,a,h){const m=this.entries[e]=this.entries[e]||{callbacks:[]};if(m.result){const[y,w]=m.result;return this.scheduler?this.scheduler.add(()=>{h(y,w)},r):h(y,w),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=a((y,w)=>{m.result=[y,w];for(const M of m.callbacks)this.scheduler?this.scheduler.add(()=>{M(y,w)},r):M(y,w);setTimeout(()=>delete this.entries[e],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(y=>y!==h),m.callbacks.length||(m.cancel(),delete this.entries[e]))}}}function K1(i,e,r){const a=JSON.stringify(i.request);return i.data&&(this.deduped.entries[a]={result:[null,i.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},h=>{const m=os(i.request,(y,w,M,k)=>{y?h(y):w&&h(null,{vectorTile:r?void 0:new lg(new ay(w)),rawData:w,cacheControl:M,expires:k})});return()=>{m.cancel(),h()}},e)}const J1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Hv{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,a]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=J1[15&a];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[w]=new Uint32Array(e,4,1);return new Hv(w,y,m,e)}constructor(e,r=64,a=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const m=J1.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,w=e*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-w%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+M,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+w+M),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+M,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=r,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return qv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:w}=this,M=[0,m.length-1,0],k=[];for(;M.length;){const B=M.pop()||0,U=M.pop()||0,G=M.pop()||0;if(U-G<=w){for(let de=G;de<=U;de++){const Ee=y[2*de],Re=y[2*de+1];Ee>=e&&Ee<=a&&Re>=r&&Re<=h&&k.push(m[de])}continue}const X=G+U>>1,Y=y[2*X],ie=y[2*X+1];Y>=e&&Y<=a&&ie>=r&&ie<=h&&k.push(m[X]),(B===0?e<=Y:r<=ie)&&(M.push(G),M.push(X-1),M.push(1-B)),(B===0?a>=Y:h>=ie)&&(M.push(X+1),M.push(U),M.push(1-B))}return k}within(e,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,w=[0,h.length-1,0],M=[],k=a*a;for(;w.length;){const B=w.pop()||0,U=w.pop()||0,G=w.pop()||0;if(U-G<=y){for(let de=G;de<=U;de++)ew(m[2*de],m[2*de+1],e,r)<=k&&M.push(h[de]);continue}const X=G+U>>1,Y=m[2*X],ie=m[2*X+1];ew(Y,ie,e,r)<=k&&M.push(h[X]),(B===0?e-a<=Y:r-a<=ie)&&(w.push(G),w.push(X-1),w.push(1-B)),(B===0?e+a>=Y:r+a>=ie)&&(w.push(X+1),w.push(U),w.push(1-B))}return M}}function qv(i,e,r,a,h,m){if(h-a<=r)return;const y=a+h>>1;Q1(i,e,y,a,h,m),qv(i,e,r,a,y-1,1-m),qv(i,e,r,y+1,h,1-m)}function Q1(i,e,r,a,h,m){for(;h>a;){if(h-a>600){const k=h-a+1,B=r-a+1,U=Math.log(k),G=.5*Math.exp(2*U/3),X=.5*Math.sqrt(U*G*(k-G)/k)*(B-k/2<0?-1:1);Q1(i,e,r,Math.max(a,Math.floor(r-B*G/k+X)),Math.min(h,Math.floor(r+(k-B)*G/k+X)),m)}const y=e[2*r+m];let w=a,M=h;for(xg(i,e,a,r),e[2*h+m]>y&&xg(i,e,a,h);w<M;){for(xg(i,e,w,M),w++,M--;e[2*w+m]<y;)w++;for(;e[2*M+m]>y;)M--}e[2*a+m]===y?xg(i,e,a,M):(M++,xg(i,e,M,h)),M<=r&&(a=M+1),r<=M&&(h=M-1)}}function xg(i,e,r,a){Xv(i,r,a),Xv(e,2*r,2*a),Xv(e,2*r+1,2*a+1)}function Xv(i,e,r){const a=i[e];i[e]=i[r],i[r]=a}function ew(i,e,r,a){const h=i-r,m=e-a;return h*h+m*m}s.ARRAY_TYPE=so,s.AUTH_ERR_MSG=Ve,s.Aabb=cs,s.Actor=class{constructor(i,e,r){this.target=i,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},Ei(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=oi()?i:$,this.scheduler=new KM}send(i,e,r,a,h=!1,m){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=m,this.callbacks[y]=r);const w=Qe(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:i,hasCallback:!!r,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:bl(e,w)},w),{cancel:()=>{r&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(i){const e=i.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const a=this.cancelCallbacks[r];delete this.cancelCallbacks[r],a&&a.cancel()}else if(e.mustQueue||oi()){const a=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),a&&a.metadata||{type:"message"})}else this.processTask(r,e)}processTask(i,e){if(e.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(e.error?r(Xa(e.error)):r(null,Xa(e.data)))}else{const r=Qe(this.globalScope)?void 0:[],a=e.hasCallback?(m,y)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:m?bl(m):null,data:bl(y,r)},r)}:m=>{},h=Xa(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,a);else if(this.parent.getWorkerSource){const m=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,m[0],h.source)[m[1]](h,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=p,s.Color=An,s.ColorMode=Cc,s.CullFaceMode=Pl,s.DEMData=by,s.DataConstantProperty=ee,s.DedupedRequest=Y1,s.DepthMode=Vp,s.EXTENT=Mi,s.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(this.isUsingMockSource()||!e||i.y<0||i.y>1)return!1;const r=e.getSource().maxzoom,a=1<<r,h=Math.floor(i.x),m=Math.floor((i.x-h)*a),y=Math.floor(i.y*a),w=this.findDEMTileFor(new v(r,h,r,m,y));return!(!w||!w.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,r=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const a=this._source();if(!a||i.y<0||i.y>1)return e;const h=a.getSource().maxzoom,m=1<<h,y=Math.floor(i.x),w=i.x-y,M=new v(h,y,h,Math.floor(w*m),Math.floor(i.y*m)),k=this.findDEMTileFor(M);if(!k||!k.dem)return e;const B=k.dem,U=1<<k.tileID.canonical.z,G=(w*U-k.tileID.canonical.x)*B.dim,X=(i.y*U-k.tileID.canonical.y)*B.dim,Y=Math.floor(G),ie=Math.floor(X);return(r?this.exaggeration():1)*mr(mr(B.get(Y,ie),B.get(Y,ie+1),X-ie),mr(B.get(Y+1,ie),B.get(Y+1,ie+1),X-ie),G-Y)}getAtTileOffset(i,e,r){const a=1<<i.canonical.z;return this.getAtPointOrZero(new xu(i.wrap+(i.canonical.x+e/Mi)/a,(i.canonical.y+r/Mi)/a))}getAtTileOffsetFunc(i,e,r,a){return h=>{const m=this.getAtTileOffset(i,h.x,h.y),y=a.upVector(i.canonical,h.x,h.y);return oo(y,y,m*a.upVectorScale(i.canonical,e,r).metersToTile),y}}getForTilePoints(i,e,r,a){if(this.isUsingMockSource())return!1;const h=wy.create(this,i,a);return!!h&&(e.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],r)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const r=e.dem.tree,a=e.tileID,h=1<<i.canonical.z-a.canonical.z;let m=i.canonical.x/h-a.canonical.x,y=i.canonical.y/h-a.canonical.y,w=0;for(let M=0;M<i.canonical.z-a.canonical.z&&!r.leaves[w];M++){m*=2,y*=2;const k=2*Math.floor(y)+Math.floor(m);w=r.childOffsets[w]+k,m%=1,y%=1}return{min:this.exaggeration()*r.minimums[w],max:this.exaggeration()*r.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=fa,s.EvaluationParameters=F,s.Event=jo,s.Evented=jr,s.FillExtrusionBucket=ff,s.Frustum=Ka,s.FrustumCorners=Vm,s.GLOBE_RADIUS=Ja,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=_p,s.GLOBE_ZOOM_THRESHOLD_MIN=Wd,s.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,e){const r=new Nt,a=new Ai,h=[],m=i+1+2,y=e[0]+1,w=e[0]+1+(1+e.length),M=(k,B,U)=>{let G=k===m-1?k-2:k===0?k:k-1;return G+=U?24575:0,[G,B]};for(let k=0;k<m;++k)r.emplaceBack(...M(k,0,!0));for(let k=0;k<y;++k)for(let B=0;B<m;++B)r.emplaceBack(...M(B,k,(B===0||B===m-1)&&!0));for(let k=0;k<e.length;++k){const B=e[k];for(let U=0;U<m;++U)r.emplaceBack(...M(U,B,!0))}for(let k=0;k<e.length;++k){const B=a.length,U=e[k]+1+2,G=new Ai;for(let ie=0;ie<U-1;ie++){const de=ie===U-2,Ee=de?m*(w-e.length+k-ie):m;for(let Re=0;Re<m-1;Re++){const Se=ie*m+Re;ie===0||de||Re===0||Re===m-2?(G.emplaceBack(Se+1,Se,Se+Ee),G.emplaceBack(Se+Ee,Se+Ee+1,Se+1)):(a.emplaceBack(Se+1,Se,Se+Ee),a.emplaceBack(Se+Ee,Se+Ee+1,Se+1))}}const X=In.simpleSegment(0,B,r.length,a.length-B);for(let ie=0;ie<G.uint16.length;ie+=3)a.emplaceBack(G.uint16[ie],G.uint16[ie+1],G.uint16[ie+2]);const Y=In.simpleSegment(0,B,r.length,a.length-B);h.push({withoutSkirts:X,withSkirts:Y})}return{vertices:r,indices:a,segments:h}}_createGrid(i){const e=this._fillGridMeshWithLods(yc,Hd);this._gridSegments=e.segments,this._gridBuffer=i.createVertexBuffer(e.vertices,Qo.members),this._gridIndexBuffer=i.createIndexBuffer(e.indices,!0)}_createPoles(i){const e=new Ai;for(let h=0;h<=yc;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const r=new Rr,a=new Rr;this._poleSegments=[];for(let h=0,m=0;h<Wd;h++){const y=360/(1<<h);r.emplaceBack(0,-Ja,0,.5,0),a.emplaceBack(0,-Ja,0,.5,1);for(let w=0;w<=yc;w++){const M=w/yc,k=mr(0,y,M),[B,U,G]=hh(tv,iv,k,Ja);r.emplaceBack(B,U,G,M,0),a.emplaceBack(B,U,G,M,1)}this._poleSegments.push(In.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(r,C_,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(a,C_,!1)}getGridBuffers(i,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,e){if(!this._wireframeSegments){const r=new ns,a=yc,h=a+1+2,m=1;this._wireframeSegments=[];for(let y=0,w=0;y<Hd.length;y++){const M=Hd[y];for(let B=m;B<M+m;B++)for(let U=m;U<a+m;U++){const G=B*h+U;r.emplaceBack(G,G+1),r.emplaceBack(G,G+h),r.emplaceBack(G,G+h+1)}const k=M*a*3;this._wireframeSegments.push(In.simpleSegment(0,w,(M+1)*h,k)),w+=k}this._wireframeIndexBuffer=i.createIndexBuffer(r)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=Bp,s.ImagePosition=Iv,s.KDBush=Hv,s.LivePerformanceUtils=Ff,s.LngLat=zr,s.LngLatBounds=ls,s.LocalGlyphMode=Lv,s.MAX_MERCATOR_LATITUDE=Po,s.MercatorCoordinate=xu,s.ONE_EM=Ft,s.OverscaledTileID=v,s.PerformanceMarkers=Cn,s.Point=He,s.Properties=Ie,s.RGBAImage=lo,s.Ray=Um,s.RequestManager=class{constructor(i,e,r){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ae,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!qe(i))return i;const r=ni(i);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!qe(i))return i;const r=ni(i);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(i,e,r,a){if(!qe(i))return i;const h=ni(i);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),r&&h.params.push(`language=${r}`),a&&h.params.push(`worldview=${a}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(i,e,r,a){const h=ni(i);return qe(i)?(h.path=`/styles/v1${h.path}/sprite${e}${r}`,this._makeAPIURL(h,this._customAccessToken||a)):(h.path+=`${e}${r}`,qt(h))}normalizeTileURL(i,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!qe(i))return i;const a=ni(i);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&a.authority!=="raster"&&r===512?"@2x":""}${ue.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${ne.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${ne.TILE_URL_VERSION}${a.path}`);const h=this._customAccessToken||function(m){for(const y of m){const w=y.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(a.params)||ne.ACCESS_TOKEN;return ne.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,h)}canonicalizeTileURL(i,e){const r=ni(i);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return i;let a="mapbox://";r.path.match(/^\/raster\/v1\//)?a+=`raster/${r.path.replace(`/${ne.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${r.path.replace(`/${ne.TILE_URL_VERSION}/`,"")}`;let h=r.params;return e&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(a+=`?${h.join("&")}`),a}canonicalizeTileset(i,e){const r=!!e&&qe(e),a=[];for(const h of i.tiles||[])ct(h)?a.push(this.canonicalizeTileURL(h,r)):a.push(h);return a}_makeAPIURL(i,e){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=ni(ne.API_URL);if(i.protocol=a.protocol,i.authority=a.authority,i.protocol==="http"){const h=i.params.indexOf("secure");h>=0&&i.params.splice(h,1)}if(a.path!=="/"&&(i.path=`${a.path}${i.path}`),!ne.REQUIRE_ACCESS_TOKEN)return qt(i);if(e=e||ne.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return i.params=i.params.filter(h=>h.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),qt(i)}},s.ResourceType=us,s.SegmentVector=In,s.SourceCache=xf,s.StencilMode=jv,s.StructArrayLayout1ui2=no,s.StructArrayLayout2f1f2i16=Li,s.StructArrayLayout2i4=Nt,s.StructArrayLayout2ui4=ns,s.StructArrayLayout3f12=Hi,s.StructArrayLayout3ui6=Ai,s.StructArrayLayout4i8=Ct,s.StructArrayLayout5f20=Rr,s.Texture=_g,s.Tile=Uv,s.Transitionable=Q,s.Uniform1f=Hn,s.Uniform1i=class extends Za{constructor(i){super(i),this.current=0}set(i,e,r){this.fetchUniformLocation(i,e)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},s.Uniform2f=class extends Za{constructor(i){super(i),this.current=[0,0]}set(i,e,r){this.fetchUniformLocation(i,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}},s.Uniform3f=class extends Za{constructor(i){super(i),this.current=[0,0,0]}set(i,e,r){this.fetchUniformLocation(i,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}},s.Uniform4f=y_,s.UniformColor=fu,s.UniformMatrix2f=class extends Za{constructor(i){super(i),this.current=qx}set(i,e,r){if(this.fetchUniformLocation(i,e)){for(let a=0;a<4;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}}},s.UniformMatrix3f=class extends Za{constructor(i){super(i),this.current=Mn}set(i,e,r){if(this.fetchUniformLocation(i,e)){for(let a=0;a<9;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}}},s.UniformMatrix4f=class extends Za{constructor(i){super(i),this.current=Bm}set(i,e,r){if(this.fetchUniformLocation(i,e)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let a=1;a<16;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}},s.UnwrappedTileID=x,s.ValidationError=fi,s.VectorTileFeature=hf,s.VectorTileWorkerSource=class extends jr{constructor(i,e,r,a,h){super(),this.actor=i,this.layerIndex=e,this.availableImages=r,this.loadVectorData=h||K1,this.loading={},this.loaded={},this.deduped=new Y1(i.scheduler),this.isSpriteLoaded=a,this.scheduler=i.scheduler}loadTile(i,e){const r=i.uid,a=i&&i.request,h=a&&a.collectResourceTiming,m=this.loading[r]=new nI(i);m.abort=this.loadVectorData(i,(y,w)=>{const M=!this.loading[r];if(delete this.loading[r],M||y||!w)return m.status="done",M||(this.loaded[r]=m),e(y);const k=w.rawData,B={};w.expires&&(B.expires=w.expires),w.cacheControl&&(B.cacheControl=w.cacheControl),m.vectorTile=w.vectorTile||new lg(new ay(k));const U=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(G,X)=>{if(G||!X)return e(G);const Y={};if(h){const ie=id(a);ie.length>0&&(Y.resourceTiming=JSON.parse(JSON.stringify(ie)))}e(null,fr({rawTileData:k.slice(0)},X,B,Y))})};this.isSpriteLoaded?U():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(U,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):U()}),this.loaded=this.loaded||{},this.loaded[r]=m})}reloadTile(i,e){const r=this.loaded,a=i.uid,h=this;if(r&&r[a]){const m=r[a];m.showCollisionBoxes=i.showCollisionBoxes,m.enableTerrain=!!i.enableTerrain,m.projection=i.projection,m.tileTransform=yf(i.tileID.canonical,i.projection);const y=(w,M)=>{const k=m.reloadCallback;k&&(delete m.reloadCallback,m.parse(m.vectorTile,h.layerIndex,this.availableImages,h.actor,k)),e(w,M)};m.status==="parsing"?m.reloadCallback=y:m.status==="done"&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(i,e){const r=i.uid,a=this.loading[r];a&&(a.abort&&a.abort(),delete this.loading[r]),e()}removeTile(i,e){const r=this.loaded,a=i.uid;r&&r[a]&&delete r[a],e()}},s.WritingMode=Oa,s.ZoomDependentExpression=yl,s.add=Ma,s.addDynamicAttributes=yy,s.adjoint=function(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=e[4],w=e[5],M=e[6],k=e[7],B=e[8];return i[0]=y*B-w*k,i[1]=h*k-a*B,i[2]=a*w-h*y,i[3]=w*M-m*B,i[4]=r*B-h*M,i[5]=h*m-r*w,i[6]=m*k-y*M,i[7]=a*M-r*k,i[8]=r*y-a*m,i},s.asyncAll=sr,s.bezier=ci,s.bindAll=Ei,s.boundsAttributes=D1,s.bufferConvexPolygon=function(i,e){const r=[];for(let a=0;a<i.length;a++){const h=ir(a-1,-1,i.length-1),m=ir(a+1,-1,i.length-1),y=i[a],w=i[m],M=i[h].sub(y).unit(),k=w.sub(y).unit(),B=k.angleWithSep(M.x,M.y),U=M.add(k).unit().mult(-1*e/Math.sin(B/2));r.push(y.add(U))}return r},s.cacheEntryPossiblyAdded=function(i){cr++,cr>It&&(i.getActor().send("enforceCacheSizeLimit",ut),cr=0)},s.calculateGlobeLabelMatrix=function(i,e){const{x:r,y:a}=i.point,h=L_(r,a,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Al(h,h,$m(ea(e)))},s.calculateGlobeMatrix=function(i){const{x:e,y:r}=i.point,{lng:a,lat:h}=i._center;return L_(e,r,i.worldSize,a,h)},s.calculateGlobeMercatorMatrix=function(i){const e=i.pixelsPerMeter,r=e/Pa(1,i.center.lat),a=Ao(new Float64Array(16));return Nd(a,a,[i.point.x,i.point.y,0]),Ml(a,a,[r,r,e]),Float32Array.from(a)},s.circumferenceAtLatitude=Wm,s.clamp=vi,s.clearTileCache=function(i){if(!Gr())return;const e=$.caches.delete(Kt);i&&e.catch(i).then(()=>i())},s.clipLine=m1,s.clone=function(i){var e=new so(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},s.clone$1=ve,s.collisionCircleLayout=ii,s.config=ne,s.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},s.create=function(){var i=new so(16);return so!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},s.create$1=v_,s.createExpression=ac,s.createLayout=et,s.createStyleLayer=function(i){return i.type==="custom"?new qM(i):new ZM[i.type](i)},s.cross=Ya,s.degToRad=dt,s.distance=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},s.div=function(i,e,r){return i[0]=e[0]/r[0],i[1]=e[1]/r[1],i[2]=e[2]/r[2],i},s.dot=ao,s.earthRadius=Yd,s.ease=xi,s.easeCubicInOut=vt,s.ecefToLatLng=function([i,e,r]){const a=Math.hypot(i,e,r),h=Math.atan2(i,r),m=.5*Math.PI-Math.acos(-e/a);return new zr(kt(h),kt(m))},s.emitValidationErrors=ip,s.endsWith=or,s.enforceCacheSizeLimit=function(i){Ur(),Ii&&Ii.then(e=>{e.keys().then(r=>{for(let a=0;a<r.length-i;a++)e.delete(r[a])})})},s.evaluateSizeForFeature=Ui,s.evaluateSizeForZoom=wi,s.evaluateVariableOffset=v1,s.evented=b,s.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},s.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},s.exported=Vo,s.exported$1=ue,s.extend=fr,s.extend$1=$o,s.fillExtrusionHeightLift=oy,s.filterObject=xe,s.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},s.fromQuat=function(i,e){var r=e[0],a=e[1],h=e[2],m=e[3],y=r+r,w=a+a,M=h+h,k=r*y,B=a*y,U=a*w,G=h*y,X=h*w,Y=h*M,ie=m*y,de=m*w,Ee=m*M;return i[0]=1-U-Y,i[1]=B+Ee,i[2]=G-de,i[3]=0,i[4]=B-Ee,i[5]=1-k-Y,i[6]=X+ie,i[7]=0,i[8]=G+de,i[9]=X-ie,i[10]=1-k-U,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},s.fromRotation=function(i,e){var r=Math.sin(e),a=Math.cos(e);return i[0]=a,i[1]=r,i[2]=0,i[3]=-r,i[4]=a,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},s.fromScaling=Fm,s.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Pt[e]},s.getAABBPointSquareDist=function(i,e,r){let a=0;for(let h=0;h<2;++h){const m=r?r[h]:0;i[h]>m&&(a+=(i[h]-m)*(i[h]-m)),e[h]<m&&(a+=(m-e[h])*(m-e[h]))}return a},s.getAnchorAlignment=Pv,s.getAnchorJustification=Ov,s.getBounds=function(i){let e=1/0,r=1/0,a=-1/0,h=-1/0;for(const m of i)e=Math.min(e,m.x),r=Math.min(r,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{min:new He(e,r),max:new He(a,h)}},s.getColumn=Ht,s.getDefaultExportFromCjs=ge,s.getGridMatrix=function(i,e,r,a){const h=e.getNorth(),m=e.getSouth(),y=e.getWest(),w=e.getEast(),M=1<<i.z,k=w-y,B=h-m,U=k/yc,G=-B/Hd[r],X=[0,U,0,G,0,0,h,y,0];if(i.z>0){const Y=180/a;b_(X,X,[Y/k+1,0,0,0,Y/B+1,0,-.5*Y/U,.5*Y/G,1])}return X[2]=M,X[5]=i.x,X[8]=i.y,X},s.getImage=Pe,s.getJSON=function(i,e){return Qn(fr(i,{type:"json"}),e)},s.getLatitudinalLod=function(i){const e=Po-5;i=vi(i,-80.051129,e)/e*90;const r=Math.pow(Math.abs(Math.sin(dt(i))),3);return Math.round(r*(Hd.length-1))},s.getMapSessionAPI=Wn,s.getPerformanceMeasurement=id,s.getProjection=M1,s.getRTLTextPluginStatus=E,s.getReferrer=Fn,s.getTilePoint=function(i,{x:e,y:r},a=0){return new He(((e-a)*i.scale-i.x)*Mi,(r*i.scale-i.y)*Mi)},s.getTileVec3=function(i,e,r=0){return _c(((e.x-r)*i.scale-i.x)*Mi,(e.y*i.scale-i.y)*Mi,Kd(e.z,e.y))},s.getVideo=function(i,e){const r=$.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let a=0;a<i.length;a++){const h=$.document.createElement("source");Gl(i[a])||(r.crossOrigin="Anonymous"),h.src=i[a],r.appendChild(h)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(i){const e=[0,0,0],r=Ao(new Float64Array(16));return Al(r,i.pixelMatrix,i.globeMatrix),mn(e,e,r),new He(e[0],e[1])},s.globeDenormalizeECEF=$m,s.globeECEFOrigin=function(i,e){const r=[0,0,0];return mn(r,r,uh(ea(e.canonical))),mn(r,r,i),r},s.globeMetersToEcef=yp,s.globeNormalizeECEF=uh,s.globePixelsToTileUnits=function(i,e){return Mi/(512*Math.pow(2,i))*_u(ea(e))},s.globePoleMatrixForTile=function(i,e,r){const a=Ao(new Float64Array(16)),h=(e/(1<<i)-.5)*Math.PI*2;return up(a,r.globeMatrix,h),Float32Array.from(a)},s.globeTileBounds=ea,s.globeTiltAtLngLat=D_,s.globeToMercatorTransition=yu,s.globeUseCustomAntiAliasing=function(i,e,r){const a=yu(r.zoom),h=i.style.map._antialias,m=!!e.extStandardDerivatives,y=e.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return a===0&&!h&&!y&&m},s.identity=Ao,s.identity$1=xs,s.invert=hp,s.isFullscreen=function(){return!!$.document.fullscreenElement||!!$.document.webkitFullscreenElement},s.isLngLatBehindGlobe=Gm,s.isMapAuthenticated=function(i){return ds.has(i)},s.isMapboxURL=qe,s.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!Qe(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=vs,s.latLngToECEF=gu,s.len=mu,s.length=pu,s.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},s.lngFromMercatorX=ko,s.loadVectorTile=K1,s.makeRequest=Qn,s.mapValue=function(i,e,r,a,h){return vi((i-e)/(r-e)*(h-a)+a,a,h)},s.mercatorScale=Hm,s.mercatorXfromLng=ka,s.mercatorYfromLat=ta,s.mercatorZfromAltitude=Pa,s.mul=Vd,s.mul$1=Jx,s.multiply=Al,s.multiply$1=b_,s.multiply$2=pp,s.nextPowerOfTwo=mi,s.normalize=Bs,s.normalize$1=S_,s.normalize$2=Gd,s.number=mr,s.ortho=function(i,e,r,a,h,m,y){var w=1/(e-r),M=1/(a-h),k=1/(m-y);return i[0]=-2*w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*M,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(e+r)*w,i[13]=(h+a)*M,i[14]=(y+m)*k,i[15]=1,i},s.pbf=yr,s.perspective=function(i,e,r,a,h){var m,y=1/Math.tan(e/2);return i[0]=y/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+a)*(m=1/(a-h)),i[14]=2*h*a*m):(i[10]=-1,i[14]=-2*a),i},s.pick=function(i,e){const r={};for(let a=0;a<e.length;a++){const h=e[a];h in i&&(r[h]=i[h])}return r},s.plugin=D,s.pointGeometry=ke,s.polesInViewport=function(i){const e=Ao(new Float64Array(16));Al(e,i.pixelMatrix,i.globeMatrix);const r=[0,Io,0],a=[0,Ns,0];return mn(r,r,e),mn(a,a,e),[r[0]>0&&r[0]<=i.width&&r[1]>0&&r[1]<=i.height&&!Gm(i,new zr(i.center.lat,90)),a[0]>0&&a[0]<=i.width&&a[1]>0&&a[1]<=i.height&&!Gm(i,new zr(i.center.lat,-90))]},s.polygonContainsPoint=Qa,s.polygonIntersectsBox=tf,s.polygonIntersectsPolygon=Qd,s.polygonizeBounds=function(i,e,r=0,a=!0){const h=new He(r,r),m=i.sub(h),y=e.add(h),w=[m,new He(y.x,m.y),y,new He(m.x,y.y)];return a&&w.push(m.clone()),w},s.posAttributes=Qo,s.postMapLoadEvent=xn,s.postPerformanceEvent=Gn,s.postTurnstileEvent=dr,s.potpack=Mv,s.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},s.radToDeg=kt,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(i){return i({pluginStatus:f,pluginURL:n}),b.on("pluginStateChange",i),i},s.removeAuthState=function(i){ds.delete(i)},s.renderColorRamp=Ym,s.resample=xp,s.rotateX=Ud,s.rotateX$1=E_,s.rotateY=up,s.rotateY$1=Nm,s.rotateZ=function(i,e,r){var a=Math.sin(r),h=Math.cos(r),m=e[0],y=e[1],w=e[2],M=e[3],k=e[4],B=e[5],U=e[6],G=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*h+k*a,i[1]=y*h+B*a,i[2]=w*h+U*a,i[3]=M*h+G*a,i[4]=k*h-m*a,i[5]=B*h-y*a,i[6]=U*h-w*a,i[7]=G*h-M*a,i},s.rotateZ$1=function(i,e,r){r*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(r),M=Math.cos(r);return i[0]=a*M+h*w,i[1]=h*M-a*w,i[2]=m*M+y*w,i[3]=y*M-m*w,i},s.scale=Ml,s.scale$1=T_,s.scale$2=oo,s.scaleAndAdd=jd,s.set=function(i,e,r,a){return i[0]=e,i[1]=r,i[2]=a,i},s.setCacheLimits=function(i,e){ut=i,It=e},s.setColumn=function(i,e,r){i[4*e+0]=r[0],i[4*e+1]=r[1],i[4*e+2]=r[2],i[4*e+3]=r[3]},s.setRTLTextPlugin=function(i,e,r=!1){if(f===ah||f===hu||f===Rd)throw new Error("setRTLTextPlugin cannot be called multiple times.");n=Vo.resolveURL(i),f=ah,dc=e,g(),r||L()},s.smoothstep=Lr,s.spec=wt,s.squaredLength=function(i){var e=i[0],r=i[1],a=i[2];return e*e+r*r+a*a},s.storeAuthState=function(i,e){e?ds.add(i):ds.delete(i)},s.sub=Mo,s.subtract=fp,s.symbolSize=ji,s.tileAABB=function(i,e,r,a,h,m,y,w,M){if(M.name==="globe")return ev(i,e,new p(r,a,h));const k=yf({z:r,x:a,y:h},M);return new cs([(m+k.x/k.scale)*e,e*(k.y/k.scale),y],[(m+k.x2/k.scale)*e,e*(k.y2/k.scale),w])},s.tileCornersToBounds=Xd,s.tileTransform=yf,s.transformMat3=function(i,e,r){var a=e[0],h=e[1],m=e[2];return i[0]=a*r[0]+h*r[3]+m*r[6],i[1]=a*r[1]+h*r[4]+m*r[7],i[2]=a*r[2]+h*r[5]+m*r[8],i},s.transformMat4=mn,s.transformMat4$1=Fs,s.transformQuat=Er,s.transitionTileAABBinECEF=jm,s.translate=Nd,s.transpose=function(i,e){if(i===e){var r=e[1],a=e[2],h=e[5];i[1]=e[3],i[2]=e[6],i[3]=r,i[5]=e[7],i[6]=a,i[7]=h}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},s.triggerPluginCompletionEvent=c,s.uniqueId=sn,s.updateGlobeVertexNormal=function(i,e,r,a,h){const m=5*e+2;i.float32[m+0]=r,i.float32[m+1]=a,i.float32[m+2]=h},s.validateCustomStyleLayer=function(i){const e=[],r=i.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=i=>ro(nh(i)),s.validateFog=i=>ro(ep(i)),s.validateLayer=i=>ro(Jf(i)),s.validateLight=i=>ro(Qf(i)),s.validateSource=i=>ro(Ad(i)),s.validateStyle=oh,s.validateTerrain=i=>ro(Md(i)),s.values=nn,s.vectorTile=Op,s.version=Z,s.warnOnce=Lt,s.window=$,s.wrap=ir}),P(["./shared"],function(s){function $(Le){if(typeof Le=="number"||typeof Le=="boolean"||typeof Le=="string"||Le==null)return JSON.stringify(Le);if(Array.isArray(Le)){let le="[";for(const Pe of Le)le+=`${$(Pe)},`;return`${le}]`}let oe="{";for(const le of Object.keys(Le).sort())oe+=`${le}:${$(Le[le])},`;return`${oe}}`}function Z(Le){let oe="";for(const le of s.refProperties)oe+=`/${$(Le[le])}`;return oe}class J{constructor(oe){this.keyCache={},oe&&this.replace(oe)}replace(oe){this._layerConfigs={},this._layers={},this.update(oe,[])}update(oe,le){for(const Ve of oe)this._layerConfigs[Ve.id]=Ve,(this._layers[Ve.id]=s.createStyleLayer(Ve)).compileFilter(),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id];for(const Ve of le)delete this.keyCache[Ve],delete this._layerConfigs[Ve],delete this._layers[Ve];this.familiesBySource={};const Pe=function(Ve,qe){const ct={};for(let Je=0;Je<Ve.length;Je++){const st=qe&&qe[Ve[Je].id]||Z(Ve[Je]);qe&&(qe[Ve[Je].id]=st);let Qt=ct[st];Qt||(Qt=ct[st]=[]),Qt.push(Ve[Je])}const ot=[];for(const Je in ct)ot.push(ct[Je]);return ot}(s.values(this._layerConfigs),this.keyCache);for(const Ve of Pe){const qe=Ve.map(ni=>this._layers[ni.id]),ct=qe[0];if(ct.visibility==="none")continue;const ot=ct.source||"";let Je=this.familiesBySource[ot];Je||(Je=this.familiesBySource[ot]={});const st=ct.sourceLayer||"_geojsonTileLayer";let Qt=Je[st];Qt||(Qt=Je[st]=[]),Qt.push(qe)}}}class ne{loadTile(oe,le){const{uid:Pe,encoding:Ve,rawImageData:qe,padding:ct,buildQuadTree:ot}=oe,Je=s.window.ImageBitmap&&qe instanceof s.window.ImageBitmap?this.getImageData(qe,ct):qe;le(null,new s.DEMData(Pe,Je,Ve,ct<1,ot))}getImageData(oe,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(oe.width,oe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=oe.width,this.offscreenCanvas.height=oe.height,this.offscreenCanvasContext.drawImage(oe,0,0,oe.width,oe.height);const Pe=this.offscreenCanvasContext.getImageData(-le,-le,oe.width+2*le,oe.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Pe}}function ue(Le,oe){if(Le.length!==0){we(Le[0],oe);for(var le=1;le<Le.length;le++)we(Le[le],!oe)}}function we(Le,oe){for(var le=0,Pe=0,Ve=0,qe=Le.length,ct=qe-1;Ve<qe;ct=Ve++){var ot=(Le[Ve][0]-Le[ct][0])*(Le[ct][1]+Le[Ve][1]),Je=le+ot;Pe+=Math.abs(le)>=Math.abs(ot)?le-Je+ot:ot-Je+le,le=Je}le+Pe>=0!=!!oe&&Le.reverse()}var Me=s.getDefaultExportFromCjs(function Le(oe,le){var Pe,Ve=oe&&oe.type;if(Ve==="FeatureCollection")for(Pe=0;Pe<oe.features.length;Pe++)Le(oe.features[Pe],le);else if(Ve==="GeometryCollection")for(Pe=0;Pe<oe.geometries.length;Pe++)Le(oe.geometries[Pe],le);else if(Ve==="Feature")Le(oe.geometry,le);else if(Ve==="Polygon")ue(oe.coordinates,le);else if(Ve==="MultiPolygon")for(Pe=0;Pe<oe.coordinates.length;Pe++)ue(oe.coordinates[Pe],le);return oe});const Ye=s.VectorTileFeature.prototype.toGeoJSON;var Ze={exports:{}},je=s.pointGeometry,ae=s.vectorTile.VectorTileFeature,ge=Oe;function Oe(Le,oe){this.options=oe||{},this.features=Le,this.length=Le.length}function ze(Le,oe){this.id=typeof Le.id=="number"?Le.id:void 0,this.type=Le.type,this.rawGeometry=Le.type===1?[Le.geometry]:Le.geometry,this.properties=Le.tags,this.extent=oe||4096}Oe.prototype.feature=function(Le){return new ze(this.features[Le],this.options.extent)},ze.prototype.loadGeometry=function(){var Le=this.rawGeometry;this.geometry=[];for(var oe=0;oe<Le.length;oe++){for(var le=Le[oe],Pe=[],Ve=0;Ve<le.length;Ve++)Pe.push(new je(le[Ve][0],le[Ve][1]));this.geometry.push(Pe)}return this.geometry},ze.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Le=this.geometry,oe=1/0,le=-1/0,Pe=1/0,Ve=-1/0,qe=0;qe<Le.length;qe++)for(var ct=Le[qe],ot=0;ot<ct.length;ot++){var Je=ct[ot];oe=Math.min(oe,Je.x),le=Math.max(le,Je.x),Pe=Math.min(Pe,Je.y),Ve=Math.max(Ve,Je.y)}return[oe,Pe,le,Ve]},ze.prototype.toGeoJSON=ae.prototype.toGeoJSON;var rt=s.pbf,ke=ge;function Ke(Le){var oe=new rt;return function(le,Pe){for(var Ve in le.layers)Pe.writeMessage(3,He,le.layers[Ve])}(Le,oe),oe.finish()}function He(Le,oe){var le;oe.writeVarintField(15,Le.version||1),oe.writeStringField(1,Le.name||""),oe.writeVarintField(5,Le.extent||4096);var Pe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<Le.length;le++)Pe.feature=Le.feature(le),oe.writeMessage(2,ri,Pe);var Ve=Pe.keys;for(le=0;le<Ve.length;le++)oe.writeStringField(3,Ve[le]);var qe=Pe.values;for(le=0;le<qe.length;le++)oe.writeMessage(4,vt,qe[le])}function ri(Le,oe){var le=Le.feature;le.id!==void 0&&oe.writeVarintField(1,le.id),oe.writeMessage(2,bt,Le),oe.writeVarintField(3,le.type),oe.writeMessage(4,Pt,le)}function bt(Le,oe){var le=Le.feature,Pe=Le.keys,Ve=Le.values,qe=Le.keycache,ct=Le.valuecache;for(var ot in le.properties){var Je=le.properties[ot],st=qe[ot];if(Je!==null){st===void 0&&(Pe.push(ot),qe[ot]=st=Pe.length-1),oe.writeVarint(st);var Qt=typeof Je;Qt!=="string"&&Qt!=="boolean"&&Qt!=="number"&&(Je=JSON.stringify(Je));var ni=Qt+":"+Je,qt=ct[ni];qt===void 0&&(Ve.push(Je),ct[ni]=qt=Ve.length-1),oe.writeVarint(qt)}}}function dt(Le,oe){return(oe<<3)+(7&Le)}function kt(Le){return Le<<1^Le>>31}function Pt(Le,oe){for(var le=Le.loadGeometry(),Pe=Le.type,Ve=0,qe=0,ct=le.length,ot=0;ot<ct;ot++){var Je=le[ot],st=1;Pe===1&&(st=Je.length),oe.writeVarint(dt(1,st));for(var Qt=Pe===3?Je.length-1:Je.length,ni=0;ni<Qt;ni++){ni===1&&Pe!==1&&oe.writeVarint(dt(2,Qt-1));var qt=Je[ni].x-Ve,$i=Je[ni].y-qe;oe.writeVarint(kt(qt)),oe.writeVarint(kt($i)),Ve+=qt,qe+=$i}Pe===3&&oe.writeVarint(dt(7,1))}}function vt(Le,oe){var le=typeof Le;le==="string"?oe.writeStringField(1,Le):le==="boolean"?oe.writeBooleanField(7,Le):le==="number"&&(Le%1!=0?oe.writeDoubleField(3,Le):Le<0?oe.writeSVarintField(6,Le):oe.writeVarintField(5,Le))}Ze.exports=Ke,Ze.exports.fromVectorTileJs=Ke,Ze.exports.fromGeojsonVt=function(Le,oe){oe=oe||{};var le={};for(var Pe in Le)le[Pe]=new ke(Le[Pe].features,oe),le[Pe].name=Pe,le[Pe].version=oe.version,le[Pe].extent=oe.extent;return Ke({layers:le})},Ze.exports.GeoJSONWrapper=ke;var ci=s.getDefaultExportFromCjs(Ze.exports);const xi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Le=>Le},vi=Math.fround||(Lr=new Float32Array(1),Le=>(Lr[0]=+Le,Lr[0]));var Lr;const ir=3,sr=5,nn=6;class fr{constructor(oe){this.options=Object.assign(Object.create(xi),oe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(oe){const{log:le,minZoom:Pe,maxZoom:Ve}=this.options;le&&console.time("total time");const qe=`prepare ${oe.length} points`;le&&console.time(qe),this.points=oe;const ct=[];for(let Je=0;Je<oe.length;Je++){const st=oe[Je];if(!st.geometry)continue;const[Qt,ni]=st.geometry.coordinates,qt=vi(zt(Qt)),$i=vi(mi(ni));ct.push(qt,$i,1/0,Je,-1,1),this.options.reduce&&ct.push(0)}let ot=this.trees[Ve+1]=this._createTree(ct);le&&console.timeEnd(qe);for(let Je=Ve;Je>=Pe;Je--){const st=+Date.now();ot=this.trees[Je]=this._createTree(this._cluster(ot,Je)),le&&console.log("z%d: %d clusters in %dms",Je,ot.numItems,+Date.now()-st)}return le&&console.timeEnd("total time"),this}getClusters(oe,le){let Pe=((oe[0]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,oe[1]));let qe=oe[2]===180?180:((oe[2]+180)%360+360)%360-180;const ct=Math.max(-90,Math.min(90,oe[3]));if(oe[2]-oe[0]>=360)Pe=-180,qe=180;else if(Pe>qe){const ni=this.getClusters([Pe,Ve,180,ct],le),qt=this.getClusters([-180,Ve,qe,ct],le);return ni.concat(qt)}const ot=this.trees[this._limitZoom(le)],Je=ot.range(zt(Pe),mi(ct),zt(qe),mi(Ve)),st=ot.data,Qt=[];for(const ni of Je){const qt=this.stride*ni;Qt.push(st[qt+sr]>1?Bn(st,qt,this.clusterProps):this.points[st[qt+ir]])}return Qt}getChildren(oe){const le=this._getOriginId(oe),Pe=this._getOriginZoom(oe),Ve="No cluster with the specified id.",qe=this.trees[Pe];if(!qe)throw new Error(Ve);const ct=qe.data;if(le*this.stride>=ct.length)throw new Error(Ve);const ot=this.options.radius/(this.options.extent*Math.pow(2,Pe-1)),Je=qe.within(ct[le*this.stride],ct[le*this.stride+1],ot),st=[];for(const Qt of Je){const ni=Qt*this.stride;ct[ni+4]===oe&&st.push(ct[ni+sr]>1?Bn(ct,ni,this.clusterProps):this.points[ct[ni+ir]])}if(st.length===0)throw new Error(Ve);return st}getLeaves(oe,le,Pe){const Ve=[];return this._appendLeaves(Ve,oe,le=le||10,Pe=Pe||0,0),Ve}getTile(oe,le,Pe){const Ve=this.trees[this._limitZoom(oe)],qe=Math.pow(2,oe),{extent:ct,radius:ot}=this.options,Je=ot/ct,st=(Pe-Je)/qe,Qt=(Pe+1+Je)/qe,ni={features:[]};return this._addTileFeatures(Ve.range((le-Je)/qe,st,(le+1+Je)/qe,Qt),Ve.data,le,Pe,qe,ni),le===0&&this._addTileFeatures(Ve.range(1-Je/qe,st,1,Qt),Ve.data,qe,Pe,qe,ni),le===qe-1&&this._addTileFeatures(Ve.range(0,st,Je/qe,Qt),Ve.data,-1,Pe,qe,ni),ni.features.length?ni:null}getClusterExpansionZoom(oe){let le=this._getOriginZoom(oe)-1;for(;le<=this.options.maxZoom;){const Pe=this.getChildren(oe);if(le++,Pe.length!==1)break;oe=Pe[0].properties.cluster_id}return le}_appendLeaves(oe,le,Pe,Ve,qe){const ct=this.getChildren(le);for(const ot of ct){const Je=ot.properties;if(Je&&Je.cluster?qe+Je.point_count<=Ve?qe+=Je.point_count:qe=this._appendLeaves(oe,Je.cluster_id,Pe,Ve,qe):qe<Ve?qe++:oe.push(ot),oe.length===Pe)break}return qe}_createTree(oe){const le=new s.KDBush(oe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Pe=0;Pe<oe.length;Pe+=this.stride)le.add(oe[Pe],oe[Pe+1]);return le.finish(),le.data=oe,le}_addTileFeatures(oe,le,Pe,Ve,qe,ct){for(const ot of oe){const Je=ot*this.stride,st=le[Je+sr]>1;let Qt,ni,qt;if(st)Qt=sn(le,Je,this.clusterProps),ni=le[Je],qt=le[Je+1];else{const Gi=this.points[le[Je+ir]];Qt=Gi.properties;const[ar,dr]=Gi.geometry.coordinates;ni=zt(ar),qt=mi(dr)}const $i={type:1,geometry:[[Math.round(this.options.extent*(ni*qe-Pe)),Math.round(this.options.extent*(qt*qe-Ve))]],tags:Qt};let zi;zi=st||this.options.generateId?le[Je+ir]:this.points[le[Je+ir]].id,zi!==void 0&&($i.id=zi),ct.features.push($i)}}_limitZoom(oe){return Math.max(this.options.minZoom,Math.min(Math.floor(+oe),this.options.maxZoom+1))}_cluster(oe,le){const{radius:Pe,extent:Ve,reduce:qe,minPoints:ct}=this.options,ot=Pe/(Ve*Math.pow(2,le)),Je=oe.data,st=[],Qt=this.stride;for(let ni=0;ni<Je.length;ni+=Qt){if(Je[ni+2]<=le)continue;Je[ni+2]=le;const qt=Je[ni],$i=Je[ni+1],zi=oe.within(Je[ni],Je[ni+1],ot),Gi=Je[ni+sr];let ar=Gi;for(const dr of zi){const dn=dr*Qt;Je[dn+2]>le&&(ar+=Je[dn+sr])}if(ar>Gi&&ar>=ct){let dr,dn=qt*Gi,xn=$i*Gi,as=-1;const Gn=((ni/Qt|0)<<5)+(le+1)+this.points.length;for(const Uo of zi){const Wn=Uo*Qt;if(Je[Wn+2]<=le)continue;Je[Wn+2]=le;const ds=Je[Wn+sr];dn+=Je[Wn]*ds,xn+=Je[Wn+1]*ds,Je[Wn+4]=Gn,qe&&(dr||(dr=this._map(Je,ni,!0),as=this.clusterProps.length,this.clusterProps.push(dr)),qe(dr,this._map(Je,Wn)))}Je[ni+4]=Gn,st.push(dn/ar,xn/ar,1/0,Gn,-1,ar),qe&&st.push(as)}else{for(let dr=0;dr<Qt;dr++)st.push(Je[ni+dr]);if(ar>1)for(const dr of zi){const dn=dr*Qt;if(!(Je[dn+2]<=le)){Je[dn+2]=le;for(let xn=0;xn<Qt;xn++)st.push(Je[dn+xn])}}}}return st}_getOriginId(oe){return oe-this.points.length>>5}_getOriginZoom(oe){return(oe-this.points.length)%32}_map(oe,le,Pe){if(oe[le+sr]>1){const ct=this.clusterProps[oe[le+nn]];return Pe?Object.assign({},ct):ct}const Ve=this.points[oe[le+ir]].properties,qe=this.options.map(Ve);return Pe&&qe===Ve?Object.assign({},qe):qe}}function Bn(Le,oe,le){return{type:"Feature",id:Le[oe+ir],properties:sn(Le,oe,le),geometry:{type:"Point",coordinates:[(Pe=Le[oe],360*(Pe-.5)),si(Le[oe+1])]}};var Pe}function sn(Le,oe,le){const Pe=Le[oe+sr],Ve=Pe>=1e4?`${Math.round(Pe/1e3)}k`:Pe>=1e3?Math.round(Pe/100)/10+"k":Pe,qe=Le[oe+nn],ct=qe===-1?{}:Object.assign({},le[qe]);return Object.assign(ct,{cluster:!0,cluster_id:Le[oe+ir],point_count:Pe,point_count_abbreviated:Ve})}function zt(Le){return Le/360+.5}function mi(Le){const oe=Math.sin(Le*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function si(Le){const oe=(180-360*Le)*Math.PI/180;return 360*Math.atan(Math.exp(oe))/Math.PI-90}function Ei(Le,oe,le,Pe){for(var Ve,qe=Pe,ct=le-oe>>1,ot=le-oe,Je=Le[oe],st=Le[oe+1],Qt=Le[le],ni=Le[le+1],qt=oe+3;qt<le;qt+=3){var $i=or(Le[qt],Le[qt+1],Je,st,Qt,ni);if($i>qe)Ve=qt,qe=$i;else if($i===qe){var zi=Math.abs(qt-ct);zi<ot&&(Ve=qt,ot=zi)}}qe>Pe&&(Ve-oe>3&&Ei(Le,oe,Ve,Pe),Le[Ve+2]=qe,le-Ve>3&&Ei(Le,Ve,le,Pe))}function or(Le,oe,le,Pe,Ve,qe){var ct=Ve-le,ot=qe-Pe;if(ct!==0||ot!==0){var Je=((Le-le)*ct+(oe-Pe)*ot)/(ct*ct+ot*ot);Je>1?(le=Ve,Pe=qe):Je>0&&(le+=ct*Je,Pe+=ot*Je)}return(ct=Le-le)*ct+(ot=oe-Pe)*ot}function Si(Le,oe,le,Pe){var Ve={id:Le===void 0?null:Le,type:oe,geometry:le,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qe){var ct=qe.geometry,ot=qe.type;if(ot==="Point"||ot==="MultiPoint"||ot==="LineString")xe(qe,ct);else if(ot==="Polygon"||ot==="MultiLineString")for(var Je=0;Je<ct.length;Je++)xe(qe,ct[Je]);else if(ot==="MultiPolygon")for(Je=0;Je<ct.length;Je++)for(var st=0;st<ct[Je].length;st++)xe(qe,ct[Je][st])}(Ve),Ve}function xe(Le,oe){for(var le=0;le<oe.length;le+=3)Le.minX=Math.min(Le.minX,oe[le]),Le.minY=Math.min(Le.minY,oe[le+1]),Le.maxX=Math.max(Le.maxX,oe[le]),Le.maxY=Math.max(Le.maxY,oe[le+1])}function ve(Le,oe,le,Pe){if(oe.geometry){var Ve=oe.geometry.coordinates,qe=oe.geometry.type,ct=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),ot=[],Je=oe.id;if(le.promoteId?Je=oe.properties[le.promoteId]:le.generateId&&(Je=Pe||0),qe==="Point")nt(Ve,ot);else if(qe==="MultiPoint")for(var st=0;st<Ve.length;st++)nt(Ve[st],ot);else if(qe==="LineString")Lt(Ve,ot,ct,!1);else if(qe==="MultiLineString"){if(le.lineMetrics){for(st=0;st<Ve.length;st++)Lt(Ve[st],ot=[],ct,!1),Le.push(Si(Je,"LineString",ot,oe.properties));return}At(Ve,ot,ct,!1)}else if(qe==="Polygon")At(Ve,ot,ct,!0);else{if(qe!=="MultiPolygon"){if(qe==="GeometryCollection"){for(st=0;st<oe.geometry.geometries.length;st++)ve(Le,{id:Je,geometry:oe.geometry.geometries[st],properties:oe.properties},le,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(st=0;st<Ve.length;st++){var Qt=[];At(Ve[st],Qt,ct,!0),ot.push(Qt)}}Le.push(Si(Je,qe,ot,oe.properties))}}function nt(Le,oe){oe.push(Yt(Le[0])),oe.push(oi(Le[1])),oe.push(0)}function Lt(Le,oe,le,Pe){for(var Ve,qe,ct=0,ot=0;ot<Le.length;ot++){var Je=Yt(Le[ot][0]),st=oi(Le[ot][1]);oe.push(Je),oe.push(st),oe.push(0),ot>0&&(ct+=Pe?(Ve*st-Je*qe)/2:Math.sqrt(Math.pow(Je-Ve,2)+Math.pow(st-qe,2))),Ve=Je,qe=st}var Qt=oe.length-3;oe[2]=1,Ei(oe,0,Qt,le),oe[Qt+2]=1,oe.size=Math.abs(ct),oe.start=0,oe.end=oe.size}function At(Le,oe,le,Pe){for(var Ve=0;Ve<Le.length;Ve++){var qe=[];Lt(Le[Ve],qe,le,Pe),oe.push(qe)}}function Yt(Le){return Le/360+.5}function oi(Le){var oe=Math.sin(Le*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function Te(Le,oe,le,Pe,Ve,qe,ct,ot){if(Pe/=oe,qe>=(le/=oe)&&ct<Pe)return Le;if(ct<le||qe>=Pe)return null;for(var Je=[],st=0;st<Le.length;st++){var Qt=Le[st],ni=Qt.geometry,qt=Qt.type,$i=Ve===0?Qt.minX:Qt.minY,zi=Ve===0?Qt.maxX:Qt.maxY;if($i>=le&&zi<Pe)Je.push(Qt);else if(!(zi<le||$i>=Pe)){var Gi=[];if(qt==="Point"||qt==="MultiPoint")Ae(ni,Gi,le,Pe,Ve);else if(qt==="LineString")Qe(ni,Gi,le,Pe,Ve,!1,ot.lineMetrics);else if(qt==="MultiLineString")Ht(ni,Gi,le,Pe,Ve,!1);else if(qt==="Polygon")Ht(ni,Gi,le,Pe,Ve,!0);else if(qt==="MultiPolygon")for(var ar=0;ar<ni.length;ar++){var dr=[];Ht(ni[ar],dr,le,Pe,Ve,!0),dr.length&&Gi.push(dr)}if(Gi.length){if(ot.lineMetrics&&qt==="LineString"){for(ar=0;ar<Gi.length;ar++)Je.push(Si(Qt.id,qt,Gi[ar],Qt.tags));continue}qt!=="LineString"&&qt!=="MultiLineString"||(Gi.length===1?(qt="LineString",Gi=Gi[0]):qt="MultiLineString"),qt!=="Point"&&qt!=="MultiPoint"||(qt=Gi.length===3?"Point":"MultiPoint"),Je.push(Si(Qt.id,qt,Gi,Qt.tags))}}}return Je.length?Je:null}function Ae(Le,oe,le,Pe,Ve){for(var qe=0;qe<Le.length;qe+=3){var ct=Le[qe+Ve];ct>=le&&ct<=Pe&&(oe.push(Le[qe]),oe.push(Le[qe+1]),oe.push(Le[qe+2]))}}function Qe(Le,oe,le,Pe,Ve,qe,ct){for(var ot,Je,st=Wt(Le),Qt=Ve===0?ut:It,ni=Le.start,qt=0;qt<Le.length-3;qt+=3){var $i=Le[qt],zi=Le[qt+1],Gi=Le[qt+2],ar=Le[qt+3],dr=Le[qt+4],dn=Ve===0?$i:zi,xn=Ve===0?ar:dr,as=!1;ct&&(ot=Math.sqrt(Math.pow($i-ar,2)+Math.pow(zi-dr,2))),dn<le?xn>le&&(Je=Qt(st,$i,zi,ar,dr,le),ct&&(st.start=ni+ot*Je)):dn>Pe?xn<Pe&&(Je=Qt(st,$i,zi,ar,dr,Pe),ct&&(st.start=ni+ot*Je)):Kt(st,$i,zi,Gi),xn<le&&dn>=le&&(Je=Qt(st,$i,zi,ar,dr,le),as=!0),xn>Pe&&dn<=Pe&&(Je=Qt(st,$i,zi,ar,dr,Pe),as=!0),!qe&&as&&(ct&&(st.end=ni+ot*Je),oe.push(st),st=Wt(Le)),ct&&(ni+=ot)}var Gn=Le.length-3;$i=Le[Gn],zi=Le[Gn+1],Gi=Le[Gn+2],(dn=Ve===0?$i:zi)>=le&&dn<=Pe&&Kt(st,$i,zi,Gi),Gn=st.length-3,qe&&Gn>=3&&(st[Gn]!==st[0]||st[Gn+1]!==st[1])&&Kt(st,st[0],st[1],st[2]),st.length&&oe.push(st)}function Wt(Le){var oe=[];return oe.size=Le.size,oe.start=Le.start,oe.end=Le.end,oe}function Ht(Le,oe,le,Pe,Ve,qe){for(var ct=0;ct<Le.length;ct++)Qe(Le[ct],oe,le,Pe,Ve,qe,!1)}function Kt(Le,oe,le,Pe){Le.push(oe),Le.push(le),Le.push(Pe)}function ut(Le,oe,le,Pe,Ve,qe){var ct=(qe-oe)/(Pe-oe);return Le.push(qe),Le.push(le+(Ve-le)*ct),Le.push(1),ct}function It(Le,oe,le,Pe,Ve,qe){var ct=(qe-le)/(Ve-le);return Le.push(oe+(Pe-oe)*ct),Le.push(qe),Le.push(1),ct}function Ii(Le,oe){for(var le=[],Pe=0;Pe<Le.length;Pe++){var Ve,qe=Le[Pe],ct=qe.type;if(ct==="Point"||ct==="MultiPoint"||ct==="LineString")Ve=Oi(qe.geometry,oe);else if(ct==="MultiLineString"||ct==="Polygon"){Ve=[];for(var ot=0;ot<qe.geometry.length;ot++)Ve.push(Oi(qe.geometry[ot],oe))}else if(ct==="MultiPolygon")for(Ve=[],ot=0;ot<qe.geometry.length;ot++){for(var Je=[],st=0;st<qe.geometry[ot].length;st++)Je.push(Oi(qe.geometry[ot][st],oe));Ve.push(Je)}le.push(Si(qe.id,ct,Ve,qe.tags))}return le}function Oi(Le,oe){var le=[];le.size=Le.size,Le.start!==void 0&&(le.start=Le.start,le.end=Le.end);for(var Pe=0;Pe<Le.length;Pe+=3)le.push(Le[Pe]+oe,Le[Pe+1],Le[Pe+2]);return le}function Gr(Le,oe){if(Le.transformed)return Le;var le,Pe,Ve,qe=1<<Le.z,ct=Le.x,ot=Le.y;for(le=0;le<Le.features.length;le++){var Je=Le.features[le],st=Je.geometry,Qt=Je.type;if(Je.geometry=[],Qt===1)for(Pe=0;Pe<st.length;Pe+=2)Je.geometry.push(Ur(st[Pe],st[Pe+1],oe,qe,ct,ot));else for(Pe=0;Pe<st.length;Pe++){var ni=[];for(Ve=0;Ve<st[Pe].length;Ve+=2)ni.push(Ur(st[Pe][Ve],st[Pe][Ve+1],oe,qe,ct,ot));Je.geometry.push(ni)}}return Le.transformed=!0,Le}function Ur(Le,oe,le,Pe,Ve,qe){return[Math.round(le*(Le*Pe-Ve)),Math.round(le*(oe*Pe-qe))]}function un(Le,oe,le,Pe,Ve){for(var qe=oe===Ve.maxZoom?0:Ve.tolerance/((1<<oe)*Ve.extent),ct={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:Pe,z:oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ot=0;ot<Le.length;ot++){ct.numFeatures++,cr(ct,Le[ot],qe,Ve);var Je=Le[ot].minX,st=Le[ot].minY,Qt=Le[ot].maxX,ni=Le[ot].maxY;Je<ct.minX&&(ct.minX=Je),st<ct.minY&&(ct.minY=st),Qt>ct.maxX&&(ct.maxX=Qt),ni>ct.maxY&&(ct.maxY=ni)}return ct}function cr(Le,oe,le,Pe){var Ve=oe.geometry,qe=oe.type,ct=[];if(qe==="Point"||qe==="MultiPoint")for(var ot=0;ot<Ve.length;ot+=3)ct.push(Ve[ot]),ct.push(Ve[ot+1]),Le.numPoints++,Le.numSimplified++;else if(qe==="LineString")us(ct,Ve,Le,le,!1,!1);else if(qe==="MultiLineString"||qe==="Polygon")for(ot=0;ot<Ve.length;ot++)us(ct,Ve[ot],Le,le,qe==="Polygon",ot===0);else if(qe==="MultiPolygon")for(var Je=0;Je<Ve.length;Je++){var st=Ve[Je];for(ot=0;ot<st.length;ot++)us(ct,st[ot],Le,le,!0,ot===0)}if(ct.length){var Qt=oe.tags||null;if(qe==="LineString"&&Pe.lineMetrics){for(var ni in Qt={},oe.tags)Qt[ni]=oe.tags[ni];Qt.mapbox_clip_start=Ve.start/Ve.size,Qt.mapbox_clip_end=Ve.end/Ve.size}var qt={geometry:ct,type:qe==="Polygon"||qe==="MultiPolygon"?3:qe==="LineString"||qe==="MultiLineString"?2:1,tags:Qt};oe.id!==null&&(qt.id=oe.id),Le.features.push(qt)}}function us(Le,oe,le,Pe,Ve,qe){var ct=Pe*Pe;if(Pe>0&&oe.size<(Ve?ct:Pe))le.numPoints+=oe.length/3;else{for(var ot=[],Je=0;Je<oe.length;Je+=3)(Pe===0||oe[Je+2]>ct)&&(le.numSimplified++,ot.push(oe[Je]),ot.push(oe[Je+1])),le.numPoints++;Ve&&function(st,Qt){for(var ni=0,qt=0,$i=st.length,zi=$i-2;qt<$i;zi=qt,qt+=2)ni+=(st[qt]-st[zi])*(st[qt+1]+st[zi+1]);if(ni>0===Qt)for(qt=0,$i=st.length;qt<$i/2;qt+=2){var Gi=st[qt],ar=st[qt+1];st[qt]=st[$i-2-qt],st[qt+1]=st[$i-1-qt],st[$i-2-qt]=Gi,st[$i-1-qt]=ar}}(ot,qe),Le.push(ot)}}function yo(Le,oe){var le=(oe=this.options=function(Ve,qe){for(var ct in qe)Ve[ct]=qe[ct];return Ve}(Object.create(this.options),oe)).debug;if(le&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Pe=function(Ve,qe){var ct=[];if(Ve.type==="FeatureCollection")for(var ot=0;ot<Ve.features.length;ot++)ve(ct,Ve.features[ot],qe,ot);else ve(ct,Ve.type==="Feature"?Ve:{geometry:Ve},qe);return ct}(Le,oe);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Pe=function(Ve,qe){var ct=qe.buffer/qe.extent,ot=Ve,Je=Te(Ve,1,-1-ct,ct,0,-1,2,qe),st=Te(Ve,1,1-ct,2+ct,0,-1,2,qe);return(Je||st)&&(ot=Te(Ve,1,-ct,1+ct,0,-1,2,qe)||[],Je&&(ot=Ii(Je,1).concat(ot)),st&&(ot=ot.concat(Ii(st,-1)))),ot}(Pe,oe),Pe.length&&this.splitTile(Pe,0,0,0),le&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Fn(Le,oe,le){return 32*((1<<Le)*le+oe)+Le}function Qn(Le,oe){const le=Le.tileID.canonical;if(!this._geoJSONIndex)return oe(null,null);const Pe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!Pe)return oe(null,null);const Ve=new class{constructor(ct){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=ct.length,this._features=ct}feature(ct){return new class{constructor(ot){this._feature=ot,this.extent=s.EXTENT,this.type=ot.type,this.properties=ot.tags,"id"in ot&&!isNaN(ot.id)&&(this.id=parseInt(ot.id,10))}loadGeometry(){if(this._feature.type===1){const ot=[];for(const Je of this._feature.geometry)ot.push([new s.Point(Je[0],Je[1])]);return ot}{const ot=[];for(const Je of this._feature.geometry){const st=[];for(const Qt of Je)st.push(new s.Point(Qt[0],Qt[1]));ot.push(st)}return ot}}toGeoJSON(ot,Je,st){return Ye.call(this,ot,Je,st)}}(this._features[ct])}}(Pe.features);let qe=ci(Ve);qe.byteOffset===0&&qe.byteLength===qe.buffer.byteLength||(qe=new Uint8Array(qe)),oe(null,{vectorTile:Ve,rawData:qe.buffer})}yo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yo.prototype.splitTile=function(Le,oe,le,Pe,Ve,qe,ct){for(var ot=[Le,oe,le,Pe],Je=this.options,st=Je.debug;ot.length;){Pe=ot.pop(),le=ot.pop(),oe=ot.pop(),Le=ot.pop();var Qt=1<<oe,ni=Fn(oe,le,Pe),qt=this.tiles[ni];if(!qt&&(st>1&&console.time("creation"),qt=this.tiles[ni]=un(Le,oe,le,Pe,Je),this.tileCoords.push({z:oe,x:le,y:Pe}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,le,Pe,qt.numFeatures,qt.numPoints,qt.numSimplified),console.timeEnd("creation"));var $i="z"+oe;this.stats[$i]=(this.stats[$i]||0)+1,this.total++}if(qt.source=Le,Ve){if(oe===Je.maxZoom||oe===Ve)continue;var zi=1<<Ve-oe;if(le!==Math.floor(qe/zi)||Pe!==Math.floor(ct/zi))continue}else if(oe===Je.indexMaxZoom||qt.numPoints<=Je.indexMaxPoints)continue;if(qt.source=null,Le.length!==0){st>1&&console.time("clipping");var Gi,ar,dr,dn,xn,as,Gn=.5*Je.buffer/Je.extent,Uo=.5-Gn,Wn=.5+Gn,ds=1+Gn;Gi=ar=dr=dn=null,xn=Te(Le,Qt,le-Gn,le+Wn,0,qt.minX,qt.maxX,Je),as=Te(Le,Qt,le+Uo,le+ds,0,qt.minX,qt.maxX,Je),Le=null,xn&&(Gi=Te(xn,Qt,Pe-Gn,Pe+Wn,1,qt.minY,qt.maxY,Je),ar=Te(xn,Qt,Pe+Uo,Pe+ds,1,qt.minY,qt.maxY,Je),xn=null),as&&(dr=Te(as,Qt,Pe-Gn,Pe+Wn,1,qt.minY,qt.maxY,Je),dn=Te(as,Qt,Pe+Uo,Pe+ds,1,qt.minY,qt.maxY,Je),as=null),st>1&&console.timeEnd("clipping"),ot.push(Gi||[],oe+1,2*le,2*Pe),ot.push(ar||[],oe+1,2*le,2*Pe+1),ot.push(dr||[],oe+1,2*le+1,2*Pe),ot.push(dn||[],oe+1,2*le+1,2*Pe+1)}}},yo.prototype.getTile=function(Le,oe,le){var Pe=this.options,Ve=Pe.extent,qe=Pe.debug;if(Le<0||Le>24)return null;var ct=1<<Le,ot=Fn(Le,oe=(oe%ct+ct)%ct,le);if(this.tiles[ot])return Gr(this.tiles[ot],Ve);qe>1&&console.log("drilling down to z%d-%d-%d",Le,oe,le);for(var Je,st=Le,Qt=oe,ni=le;!Je&&st>0;)st--,Qt=Math.floor(Qt/2),ni=Math.floor(ni/2),Je=this.tiles[Fn(st,Qt,ni)];return Je&&Je.source?(qe>1&&console.log("found parent tile z%d-%d-%d",st,Qt,ni),qe>1&&console.time("drilling down"),this.splitTile(Je.source,st,Qt,ni,Le,oe,le),qe>1&&console.timeEnd("drilling down"),this.tiles[ot]?Gr(this.tiles[ot],Ve):null):null};class os extends s.VectorTileWorkerSource{constructor(oe,le,Pe,Ve,qe){super(oe,le,Pe,Ve,Qn),qe&&(this.loadGeoJSON=qe)}loadData(oe,le){const Pe=oe&&oe.request,Ve=Pe&&Pe.collectResourceTiming;this.loadGeoJSON(oe,(qe,ct)=>{if(qe||!ct)return le(qe);if(typeof ct!="object")return le(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`));{Me(ct,!0);try{if(oe.filter){const Je=s.createExpression(oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Je.result==="error")throw new Error(Je.value.map(Qt=>`${Qt.key}: ${Qt.message}`).join(", "));ct={type:"FeatureCollection",features:ct.features.filter(Qt=>Je.value.evaluate({zoom:0},Qt))}}this._geoJSONIndex=oe.cluster?new fr(function({superclusterOptions:Je,clusterProperties:st}){if(!st||!Je)return Je;const Qt={},ni={},qt={accumulated:null,zoom:0},$i={properties:null},zi=Object.keys(st);for(const Gi of zi){const[ar,dr]=st[Gi],dn=s.createExpression(dr),xn=s.createExpression(typeof ar=="string"?[ar,["accumulated"],["get",Gi]]:ar);Qt[Gi]=dn.value,ni[Gi]=xn.value}return Je.map=Gi=>{$i.properties=Gi;const ar={};for(const dr of zi)ar[dr]=Qt[dr].evaluate(qt,$i);return ar},Je.reduce=(Gi,ar)=>{$i.properties=ar;for(const dr of zi)qt.accumulated=Gi[dr],Gi[dr]=ni[dr].evaluate(qt,$i)},Je}(oe)).load(ct.features):function(Je,st){return new yo(Je,st)}(ct,oe.geojsonVtOptions)}catch(Je){return le(Je)}this.loaded={};const ot={};if(Ve){const Je=s.getPerformanceMeasurement(Pe);Je&&(ot.resourceTiming={},ot.resourceTiming[oe.source]=JSON.parse(JSON.stringify(Je)))}le(null,ot)}})}reloadTile(oe,le){const Pe=this.loaded;return Pe&&Pe[oe.uid]?super.reloadTile(oe,le):this.loadTile(oe,le)}loadGeoJSON(oe,le){if(oe.request)s.getJSON(oe.request,le);else{if(typeof oe.data!="string")return le(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(oe.data))}catch{return le(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(oe,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(oe.clusterId))}catch(Pe){le(Pe)}}getClusterChildren(oe,le){try{le(null,this._geoJSONIndex.getChildren(oe.clusterId))}catch(Pe){le(Pe)}}getClusterLeaves(oe,le){try{le(null,this._geoJSONIndex.getLeaves(oe.clusterId,oe.limit,oe.offset))}catch(Pe){le(Pe)}}}class Gl{constructor(oe){this.self=oe,this.actor=new s.Actor(oe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:os},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,Pe)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=Pe},this.self.registerRTLTextPlugin=le=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=le.applyArabicShaping,s.plugin.processBidirectionalText=le.processBidirectionalText,s.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(oe,le,Pe){delete this.layerIndexes[oe],delete this.availableImages[oe],delete this.workerSources[oe],delete this.demWorkerSources[oe],Pe()}checkIfReady(oe,le,Pe){Pe()}setReferrer(oe,le){this.referrer=le}spriteLoaded(oe,le){this.isSpriteLoaded[oe]=le;for(const Pe in this.workerSources[oe]){const Ve=this.workerSources[oe][Pe];for(const qe in Ve)Ve[qe]instanceof s.VectorTileWorkerSource&&(Ve[qe].isSpriteLoaded=le,Ve[qe].fire(new s.Event("isSpriteLoaded")))}}setImages(oe,le,Pe){this.availableImages[oe]=le;for(const Ve in this.workerSources[oe]){const qe=this.workerSources[oe][Ve];for(const ct in qe)qe[ct].availableImages=le}Pe()}enableTerrain(oe,le,Pe){this.terrain=le,Pe()}setProjection(oe,le){this.projections[oe]=s.getProjection(le)}setLayers(oe,le,Pe){this.getLayerIndex(oe).replace(le),Pe()}updateLayers(oe,le,Pe){this.getLayerIndex(oe).update(le.layers,le.removedIds),Pe()}loadTile(oe,le,Pe){const Ve=this.enableTerrain?s.extend({enableTerrain:this.terrain},le):le;Ve.projection=this.projections[oe]||this.defaultProjection,this.getWorkerSource(oe,le.type,le.source).loadTile(Ve,Pe)}loadDEMTile(oe,le,Pe){const Ve=this.enableTerrain?s.extend({buildQuadTree:this.terrain},le):le;this.getDEMWorkerSource(oe,le.source).loadTile(Ve,Pe)}reloadTile(oe,le,Pe){const Ve=this.enableTerrain?s.extend({enableTerrain:this.terrain},le):le;Ve.projection=this.projections[oe]||this.defaultProjection,this.getWorkerSource(oe,le.type,le.source).reloadTile(Ve,Pe)}abortTile(oe,le,Pe){this.getWorkerSource(oe,le.type,le.source).abortTile(le,Pe)}removeTile(oe,le,Pe){this.getWorkerSource(oe,le.type,le.source).removeTile(le,Pe)}removeSource(oe,le,Pe){if(!this.workerSources[oe]||!this.workerSources[oe][le.type]||!this.workerSources[oe][le.type][le.source])return;const Ve=this.workerSources[oe][le.type][le.source];delete this.workerSources[oe][le.type][le.source],Ve.removeSource!==void 0?Ve.removeSource(le,Pe):Pe()}loadWorkerSource(oe,le,Pe){try{this.self.importScripts(le.url),Pe()}catch(Ve){Pe(Ve.toString())}}syncRTLPluginState(oe,le,Pe){try{s.plugin.setState(le);const Ve=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Ve!=null){this.self.importScripts(Ve);const qe=s.plugin.isParsed();Pe(qe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ve}`),qe)}}catch(Ve){Pe(Ve.toString())}}getAvailableImages(oe){let le=this.availableImages[oe];return le||(le=[]),le}getLayerIndex(oe){let le=this.layerIndexes[oe];return le||(le=this.layerIndexes[oe]=new J),le}getWorkerSource(oe,le,Pe){if(this.workerSources[oe]||(this.workerSources[oe]={}),this.workerSources[oe][le]||(this.workerSources[oe][le]={}),!this.workerSources[oe][le][Pe]){const Ve={send:(qe,ct,ot,Je,st,Qt)=>{this.actor.send(qe,ct,ot,oe,st,Qt)},scheduler:this.actor.scheduler};this.workerSources[oe][le][Pe]=new this.workerSourceTypes[le](Ve,this.getLayerIndex(oe),this.getAvailableImages(oe),this.isSpriteLoaded[oe])}return this.workerSources[oe][le][Pe]}getDEMWorkerSource(oe,le){return this.demWorkerSources[oe]||(this.demWorkerSources[oe]={}),this.demWorkerSources[oe][le]||(this.demWorkerSources[oe][le]=new ne),this.demWorkerSources[oe][le]}enforceCacheSizeLimit(oe,le){s.enforceCacheSizeLimit(le)}getWorkerPerformanceMetrics(oe,le,Pe){Pe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Gl(self)),Gl}),P(["./shared"],function(s){function $(f,n){if(Array.isArray(f)){if(!Array.isArray(n)||f.length!==n.length)return!1;for(let c=0;c<f.length;c++)if(!$(f[c],n[c]))return!1;return!0}if(typeof f=="object"&&f!==null&&n!==null){if(typeof n!="object"||Object.keys(f).length!==Object.keys(n).length)return!1;for(const c in f)if(!$(f[c],n[c]))return!1;return!0}return f===n}var Z=J;function J(f){return!function(n){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,b,E=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(E);try{b=new Worker(L),g=!0}catch{g=!1}return b&&b.terminate(),URL.revokeObjectURL(L),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var b=g.getContext("2d");if(!b)return!1;var E=b.getImageData(0,0,1,1);return E&&E.width===g.width}()?(ne[c=n&&n.failIfMajorPerformanceCaveat]===void 0&&(ne[c]=function(g){var b,E=function(L){var D=document.createElement("canvas"),F=Object.create(J.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=L,D.getContext("webgl",F)||D.getContext("experimental-webgl",F)}(g);if(!E)return!1;try{b=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!b||E.isContextLost())&&(E.shaderSource(b,"void main() {}"),E.compileShader(b),E.getShaderParameter(b,E.COMPILE_STATUS)===!0)}(c)),ne[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(f)}var ne={};function ue(f,n,c){const g=s.window.document.createElement(f);return n!==void 0&&(g.className=n),c&&c.appendChild(g),g}function we(f,n,c){const g=s.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const b of Object.keys(n))g.setAttributeNS(null,b,n[b]);return c&&c.appendChild(g),g}J.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Me=s.window.document&&s.window.document.documentElement.style,Ye=Me&&Me.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ze;function je(){Me&&Ye&&(Ze=Me[Ye],Me[Ye]="none")}function ae(){Me&&Ye&&(Me[Ye]=Ze)}function ge(f){f.preventDefault(),f.stopPropagation(),s.window.removeEventListener("click",ge,!0)}function Oe(){s.window.addEventListener("click",ge,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",ge,!0)},0)}function ze(f,n){const c=f.getBoundingClientRect();return Ke(f,c,n)}function rt(f,n){const c=f.getBoundingClientRect(),g=[];for(let b=0;b<n.length;b++)g.push(Ke(f,c,n[b]));return g}function ke(f){return s.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function Ke(f,n,c){const g=f.offsetWidth===n.width?1:f.offsetWidth/n.width;return new s.Point((c.clientX-n.left)*g,(c.clientY-n.top)*g)}function He(f,n){var c=n[0],g=n[1],b=n[2],E=n[3],L=c*E-b*g;return L?(f[0]=E*(L=1/L),f[1]=-g*L,f[2]=-b*L,f[3]=c*L,f):null}function ri(f){const{userImage:n}=f;return!!(n&&n.render&&n.render())&&(f.data.replace(new Uint8Array(n.data.buffer)),!0)}class bt extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:c,callback:g}of this.requestors)this._notify(c,g);this.requestors=[]}}hasImage(n){return!!this.getImage(n)}getImage(n){return this.images[n]}addImage(n,c){this._validate(n,c)&&(this.images[n]=c)}_validate(n,c){let g=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),g=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),g=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),g=!1),g}_validateStretch(n,c){if(!n)return!0;let g=0;for(const b of n){if(b[0]<g||b[1]<b[0]||c<b[1])return!1;g=b[1]}return!0}_validateContent(n,c){return!(n&&(n.length!==4||n[0]<0||c.data.width<n[0]||n[1]<0||c.data.height<n[1]||n[2]<0||c.data.width<n[2]||n[3]<0||c.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,c){c.version=this.images[n].version+1,this.images[n]=c,this.updatedImages[n]=!0}removeImage(n){const c=this.images[n];delete this.images[n],delete this.patterns[n],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,c){let g=!0;if(!this.isLoaded())for(const b of n)this.images[b]||(g=!1);this.isLoaded()||g?this._notify(n,c):this.requestors.push({ids:n,callback:c})}_notify(n,c){const g={};for(const b of n){this.images[b]||this.fire(new s.Event("styleimagemissing",{id:b}));const E=this.images[b];E?g[b]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:s.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,g)}getPixelSize(){const{width:n,height:c}=this.atlasImage;return{width:n,height:c}}getPattern(n){const c=this.patterns[n],g=this.getImage(n);if(!g)return null;if(c&&c.position.version===g.version)return c.position;if(c)c.position.version=g.version;else{const b={w:g.data.width+2,h:g.data.height+2,x:0,y:0},E=new s.ImagePosition(b,g);this.patterns[n]={bin:b,position:E}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const c=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(n,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const E in this.patterns)n.push(this.patterns[E].bin);const{w:c,h:g}=s.potpack(n),b=this.atlasImage;b.resize({width:c||1,height:g||1});for(const E in this.patterns){const{bin:L}=this.patterns[E],D=L.x+1,F=L.y+1,W=this.images[E].data,H=W.width,Q=W.height;s.RGBAImage.copy(W,b,{x:0,y:0},{x:D,y:F},{width:H,height:Q}),s.RGBAImage.copy(W,b,{x:0,y:Q-1},{x:D,y:F-1},{width:H,height:1}),s.RGBAImage.copy(W,b,{x:0,y:0},{x:D,y:F+Q},{width:H,height:1}),s.RGBAImage.copy(W,b,{x:H-1,y:0},{x:D-1,y:F},{width:1,height:Q}),s.RGBAImage.copy(W,b,{x:0,y:0},{x:D+H,y:F},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const c of n){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const g=this.images[c];ri(g)&&this.updateImage(c,g)}}}const dt=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(f,n){return function([c,g,b]){const E=s.degToRad(g+90),L=s.degToRad(b);return{x:c*Math.cos(E)*Math.sin(L),y:c*Math.sin(E)*Math.sin(L),z:c*Math.cos(L),azimuthal:g,polar:b}}(f.expression.evaluate(n))}interpolate(f,n,c){return{x:s.number(f.x,n.x,c),y:s.number(f.y,n.y,c),z:s.number(f.z,n.z,c),azimuthal:s.number(f.azimuthal,n.azimuthal,c),polar:s.number(f.polar,n.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class kt extends s.Evented{constructor(n){super(),this._transitionable=new s.Transitionable(dt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,c={}){if(!this._validate(s.validateLight,n,c))for(const g in n){const b=n[g];s.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,n.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const Pt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let vt=class extends s.Evented{constructor(f,n){super(),this._transitionable=new s.Transitionable(Pt),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(f){for(const n in f){const c=f[n];s.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),c):this._transitionable.setValue(n,c)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}};function ci(f,n,c,g){const b=s.smoothstep(45,65,c),[E,L]=xi(f,g),D=s.length(n);let F=1-Math.min(1,Math.exp((D-E)/(L-E)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*b*f.alpha}function xi(f,n){const c=.5/Math.tan(.5*n);return[f.range[0]+c,f.range[1]+c]}const vi=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class Lr extends s.Evented{constructor(n,c){super(),this._transitionable=new s.Transitionable(vi),this.set(n),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const n=this._transform,c=n.projection.name==="globe",g=s.globeToMercatorTransition(n.zoom),b=this.properties.get("range"),E=[.5,3];return{range:c?[s.number(E[0],b[0],g),s.number(E[1],b[1],g)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,c={}){if(!this._validate(s.validateFog,n,c)){for(const g of Object.keys(s.spec.fog))n&&n[g]===void 0&&(n[g]=s.spec.fog[g].default);for(const g in n){const b=n[g];s.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,n))*c.a}getOpacityAtLatLng(n,c){return this._transform.projection.supportsFog?function(g,b,E){const L=s.MercatorCoordinate.fromLngLat(b),D=E.elevation?E.elevation.getAtPointOrZero(L):0,F=[L.x,L.y,D];return s.transformMat4(F,F,E.mercatorFogMatrix),ci(g,F,E.pitch,E._fov)}(this.state,n,c):0}getFovAdjustedRange(n){return this._transform.projection.supportsFog?xi(this.state,n):[0,1]}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,n.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class ir{constructor(n,c){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const g=this.workerPool.acquire(this.id);for(let b=0;b<g.length;b++){const E=new ir.Actor(g[b],c,this.id);E.name=`Worker ${b}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,c,g){s.asyncAll(this.actors,(b,E)=>{b.send(n,c,E)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function sr(f,n,c){return n*(s.EXTENT/(f.tileSize*Math.pow(2,c-f.tileID.overscaledZ)))}ir.Actor=s.Actor;class nn{constructor(n,c,g,b){this.screenBounds=n,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(n,c){let g,b;if(n instanceof s.Point||typeof n[0]=="number"){const E=s.Point.convert(n);g=[E],b=c.isPointAboveHorizon(E)}else{const E=s.Point.convert(n[0]),L=s.Point.convert(n[1]);g=[E,L],b=s.polygonizeBounds(E,L).every(D=>c.isPointAboveHorizon(D))}return new nn(g,c.getCameraPoint(),b,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const c=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],b=s.polygonizeBounds(c,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<g.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?b[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(b[3]=this.cameraPoint)),s.bufferConvexPolygon(b,n)}bufferedCameraGeometryGlobe(n){const c=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],b=s.polygonizeBounds(c,g,n),E=this.cameraPoint.clone();switch(3*((E.y>c.y)+(E.y>g.y))+((E.x>c.x)+(E.x>g.x))){case 0:b[0]=E,b[4]=E.clone();break;case 1:b.splice(1,0,E);break;case 2:b[1]=E;break;case 3:b.splice(4,0,E);break;case 5:b.splice(2,0,E);break;case 6:b[3]=E;break;case 7:b.splice(3,0,E);break;case 8:b[2]=E}return b}containsTile(n,c,g,b=0){const E=n.queryPadding/c._pixelsPerMercatorPixel+1,L=g?this._bufferedCameraMercator(E,c):this._bufferedScreenMercator(E,c);let D=n.tileID.wrap+(L.unwrapped?b:0);const F=L.polygon.map(be=>s.getTilePoint(n.tileTransform,be,D));if(!s.polygonIntersectsBox(F,0,0,s.EXTENT,s.EXTENT))return;D=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const W=this.screenGeometryMercator.polygon.map(be=>s.getTileVec3(n.tileTransform,be,D)),H=W.map(be=>new s.Point(be[0],be[1])),Q=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),he=s.getTileVec3(n.tileTransform,Q,D),me=W.map(be=>{const ee=s.sub(be,be,he);return s.normalize(ee,ee),new s.Ray(he,ee)}),ye=sr(n,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:me,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(_e=s.getBounds(F),_e.min.x=s.clamp(_e.min.x,0,s.EXTENT),_e.min.y=s.clamp(_e.min.y,0,s.EXTENT),_e.max.x=s.clamp(_e.max.x,0,s.EXTENT),_e.max.y=s.clamp(_e.max.y,0,s.EXTENT),_e),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:ye};var _e}_bufferedScreenMercator(n,c){const g=sn(n);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let b;return b=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),c):{polygon:this.bufferedScreenGeometry(n).map(E=>c.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[g]=b,b}}_bufferedCameraMercator(n,c){const g=sn(n);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let b;return b=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),c):{polygon:this.bufferedCameraGeometry(n).map(E=>c.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[g]=b,b}}_projectAndResample(n,c){const g=function(E,L){const D=s.multiply([],L.pixelMatrix,L.globeMatrix),F=[0,-s.GLOBE_RADIUS,0,1],W=[0,s.GLOBE_RADIUS,0,1],H=[0,0,0,1];s.transformMat4$1(F,F,D),s.transformMat4$1(W,W,D),s.transformMat4$1(H,H,D);const Q=new s.Point(F[0]/F[3],F[1]/F[3]),he=new s.Point(W[0]/W[3],W[1]/W[3]),me=s.polygonContainsPoint(E,Q)&&F[3]<H[3],ye=s.polygonContainsPoint(E,he)&&W[3]<H[3];if(!me&&!ye)return null;const _e=function(We,it,et){for(let pt=1;pt<We.length;pt++){const Nt=Bn(it.pointCoordinate3D(We[pt-1]).x),ht=Bn(it.pointCoordinate3D(We[pt]).x);if(et<0){if(Nt<ht)return{idx:pt,t:-Nt/(ht-1-Nt)}}else if(ht<Nt)return{idx:pt,t:(1-Nt)/(ht+1-Nt)}}return null}(E,L,me?-1:1);if(!_e)return null;const{idx:be,t:ee}=_e;let pe=be>1?fr(E.slice(0,be),L):[],Ce=be<E.length?fr(E.slice(be),L):[];pe=pe.map(We=>new s.Point(Bn(We.x),We.y)),Ce=Ce.map(We=>new s.Point(Bn(We.x),We.y));const Ie=[...pe];Ie.length===0&&Ie.push(Ce[Ce.length-1]);const Ge=s.number(Ie[Ie.length-1].y,(Ce.length===0?pe[0]:Ce[0]).y,ee);let Fe;return Fe=me?[new s.Point(0,Ge),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Ge)]:[new s.Point(1,Ge),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Ge)],Ie.push(...Fe),Ce.length===0?Ie.push(pe[0]):Ie.push(...Ce),{polygon:Ie.map(We=>new s.MercatorCoordinate(We.x,We.y)),unwrapped:!1}}(n,c);if(g)return g;const b=function(E,L){let D=!1,F=-1/0,W=0;for(let Q=0;Q<E.length-1;Q++)E[Q].x>F&&(F=E[Q].x,W=Q);for(let Q=0;Q<E.length-1;Q++){const he=(W+Q)%(E.length-1),me=E[he],ye=E[he+1];Math.abs(me.x-ye.x)>.5&&(me.x<ye.x?(me.x+=1,he===0&&(E[E.length-1].x+=1)):(ye.x+=1,he+1===E.length-1&&(E[0].x+=1)),D=!0)}const H=s.mercatorXfromLng(L.center.lng);return D&&H<Math.abs(H-1)&&E.forEach(Q=>{Q.x-=1}),{polygon:E,unwrapped:D}}(fr(n,c).map(E=>new s.Point(Bn(E.x),E.y)),c);return{polygon:b.polygon.map(E=>new s.MercatorCoordinate(E.x,E.y)),unwrapped:b.unwrapped}}}function fr(f,n){return s.resample(f,c=>{const g=n.pointCoordinate3D(c);c.x=g.x,c.y=g.y},1/256)}function Bn(f){return f<0?1+f%1:f%1}function sn(f){return 100*f|0}function zt(f,n,c,g,b){const E=function(L,D){if(L)return b(L);if(D){f.url&&D.tiles&&f.tiles&&delete f.tiles;const F=s.pick(s.extend(D,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(F.vectorLayers=D.vector_layers,F.vectorLayerIds=F.vectorLayers.map(W=>W.id)),F.tiles=n.canonicalizeTileset(F,f.url),b(null,F)}};return f.url?s.getJSON(n.transformRequest(n.normalizeSourceURL(f.url,null,c,g),s.ResourceType.Source),E):s.exported.frame(()=>E(null,f))}class mi{constructor(n,c,g){this.bounds=s.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=c||0,this.maxzoom=g||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const c=Math.pow(2,n.z),g=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),b=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),E=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),L=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return n.x>=g&&n.x<E&&n.y>=b&&n.y<L}}class si{constructor(n,c,g){this.context=n;const b=n.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ei={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class or{constructor(n,c,g,b){this.length=c.length,this.attributes=g,this.itemSize=c.bytesPerElement,this.dynamicDraw=b,this.context=n;const E=n.gl;this.buffer=E.createBuffer(),n.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,c){for(let g=0;g<this.attributes.length;g++){const b=c.attributes[this.attributes[g].name];b!==void 0&&n.enableVertexAttribArray(b)}}setVertexAttribPointers(n,c,g){for(let b=0;b<this.attributes.length;b++){const E=this.attributes[b],L=c.attributes[E.name];L!==void 0&&n.vertexAttribPointer(L,E.components,n[Ei[E.type]],!1,this.itemSize,E.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Si{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class xe extends Si{getDefault(){return s.Color.transparent}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ve extends Si{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class nt extends Si{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Lt extends Si{getDefault(){return[!0,!0,!0,!0]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class At extends Si{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Yt extends Si{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class oi extends Si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Te extends Si{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Ae extends Si{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}}class Qe extends Si{getDefault(){return[0,1]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Wt extends Si{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}}class Ht extends Si{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Kt extends Si{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}}class ut extends Si{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class It extends Si{getDefault(){return s.Color.transparent}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Ii extends Si{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Oi extends Si{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}}class Gr extends Si{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Ur extends Si{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let un,cr=class extends Si{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class us extends Si{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class yo extends Si{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Fn extends Si{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Qn extends Si{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class os extends Si{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Gl extends Si{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Le extends Si{getDefault(){return null}set(n){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class oe extends Si{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class le extends Si{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Pe extends Si{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Ve extends Si{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class qe extends Si{constructor(n,c){super(n),this.context=n,this.parent=c}getDefault(){return null}}class ct extends qe{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class ot extends qe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Je extends ot{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class st{constructor(n,c,g,b){this.context=n,this.width=c,this.height=g;const E=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new ct(n,E),b&&(this.depthAttachment=new ot(n,E))}destroy(){const n=this.context.gl,c=this.colorAttachment.get();if(c&&n.deleteTexture(c),this.depthAttachment){const g=this.depthAttachment.get();g&&n.deleteRenderbuffer(g)}n.deleteFramebuffer(this.framebuffer)}}class Qt{constructor(n,c=!1){if(this.gl=n,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const g=n;this.extVertexArrayObject={createVertexArrayOES:g.createVertexArray.bind(n),deleteVertexArrayOES:g.deleteVertexArray.bind(n),bindVertexArrayOES:g.bindVertexArray.bind(n)}}this.clearColor=new xe(this),this.clearDepth=new ve(this),this.clearStencil=new nt(this),this.colorMask=new Lt(this),this.depthMask=new At(this),this.stencilMask=new Yt(this),this.stencilFunc=new oi(this),this.stencilOp=new Te(this),this.stencilTest=new Ae(this),this.depthRange=new Qe(this),this.depthTest=new Wt(this),this.depthFunc=new Ht(this),this.blend=new Kt(this),this.blendFunc=new ut(this),this.blendColor=new It(this),this.blendEquation=new Ii(this),this.cullFace=new Oi(this),this.cullFaceSide=new Gr(this),this.frontFace=new Ur(this),this.program=new cr(this),this.activeTexture=new us(this),this.viewport=new yo(this),this.bindFramebuffer=new Fn(this),this.bindRenderbuffer=new Qn(this),this.bindTexture=new os(this),this.bindVertexBuffer=new Gl(this),this.bindElementBuffer=new Le(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new oe(this),this.pixelStoreUnpack=new le(this),this.pixelStoreUnpackPremultiplyAlpha=new Pe(this),this.pixelStoreUnpackFlipY=new Ve(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=n.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&n.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||n.getExtension("OES_standard_derivatives"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,c){return new si(this,n,c)}createVertexBuffer(n,c,g){return new or(this,n,c,g)}createRenderbuffer(n,c,g){const b=this.gl,E=b.createRenderbuffer();return this.bindRenderbuffer.set(E),b.renderbufferStorage(b.RENDERBUFFER,n,c,g),this.bindRenderbuffer.set(null),E}createFramebuffer(n,c,g){return new st(this,n,c,g)}clear({color:n,depth:c,stencil:g}){const b=this.gl;let E=0;n&&(E|=b.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(E|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),g!==void 0&&(E|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),b.clear(E)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){$(n.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ni extends s.Evented{constructor(n,c,g,b){if(super(),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(c,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(n){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=zt(this._options,this.map._requestManager,c,g,(b,E)=>{this._tileJSONRequest=null,this._loaded=!0,b?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new s.ErrorEvent(b))):E&&(s.extend(this,E),E.bounds&&(this.tileBounds=new mi(E.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),n&&n(b)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(n,c){const g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(g,s.ResourceType.Tile),data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile};if(b.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=c:n.request=n.actor.send("reloadTile",b,E.bind(this));else if(n.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",b,E.bind(this),void 0,!0);else{const L=s.loadVectorTile.call({deduped:this._deduped},b,(D,F)=>{D||!F?E.call(this,D):(b.data={cacheControl:F.cacheControl,expires:F.expires,rawData:F.rawData.slice(0)},n.actor&&n.actor.send("loadTile",b,E.bind(this),void 0,!0))},!0);n.request={cancel:L}}function E(L,D){return delete n.request,n.aborted?c(null):L&&L.status!==404?c(L):(D&&D.resourceTiming&&(n.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&n.setExpiryData(D),n.loadVectorData(D,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id})}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class qt extends s.Evented{constructor(n,c,g,b){super(),this.id=n,this.dispatcher=g,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zt(this._options,this.map._requestManager,null,null,(c,g)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):g&&(s.extend(this,g),g.bounds&&(this.tileBounds=new mi(g.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(g.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),n&&n(c)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,c){const g=s.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);n.request=s.getImage(this.map._requestManager.transformRequest(b,s.ResourceType.Tile),(E,L,D,F)=>(delete n.request,n.aborted?(n.state="unloaded",c(null)):E?(n.state="errored",c(E)):L?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:D,expires:F}),n.setTexture(L,this.map.painter),n.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(n,c,g){n.setTexture(c,g)}static unloadTileData(n,c){n.texture&&c.saveTileTexture(n.texture)}abortTile(n,c){n.request&&(n.request.cancel(),delete n.request),c()}unloadTile(n,c){n.texture&&this.map.painter.saveTileTexture(n.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function $i(f,n,c,g,b,E,L,D){const F=[f,c,b,n,g,E,1,1,1],W=[L,D,1],H=s.adjoint([],F),[Q,he,me]=s.transformMat3(W,W,s.transpose(H,H));return s.multiply$1(F,[Q,0,0,0,he,0,0,0,me],F)}class zi extends s.Evented{constructor(n,c,g,b){super(),this.id=n,this.dispatcher=g,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=c,this._dirty=!1}load(n,c){this._loaded=c||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(g,b)=>{if(this._imageRequest=null,this._loaded=!0,g)this.fire(new s.ErrorEvent(g));else if(b){const{HTMLImageElement:E}=s.window;this.image=b instanceof E?s.exported.getImageData(b):b,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading()}})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(n){this.coordinates=n,this._boundsArray=void 0;const c=n.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let b=1/0,E=1/0,L=-1/0,D=-1/0;for(const Q of g)b=Math.min(b,Q.x),E=Math.min(E,Q.y),L=Math.max(L,Q.x),D=Math.max(D,Q.y);const F=Math.max(L-b,D-E),W=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),H=Math.pow(2,W);return new s.CanonicalTileID(W,Math.floor((b+L)/2*H),Math.floor((E+D)/2*H))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(n){for(const F in this.tiles){const W=this.tiles[F];W.state!=="loaded"&&(W.state="loaded",W.texture=this.texture)}if(this._boundsArray)return;const c=s.tileTransform(this.tileID,this.map.transform.projection),[g,b,E,L]=this.coordinates.map(F=>{const W=c.projection.project(F[0],F[1]);return s.getTilePoint(c,W)._round()});this.perspectiveTransform=function(F,W,H,Q,he,me,ye,_e,be,ee){const pe=$i(0,0,F,0,0,W,F,W),Ce=$i(H,Q,he,me,ye,_e,be,ee);return s.multiply$1(Ce,s.adjoint(pe,pe),Ce),[Ce[6]/Ce[8]*F/s.EXTENT,Ce[7]/Ce[8]*W/s.EXTENT]}(this.width,this.height,g.x,g.y,b.x,b.y,L.x,L.y,E.x,E.y);const D=this._boundsArray=new s.StructArrayLayout4i8;D.emplaceBack(g.x,g.y,0,0),D.emplaceBack(b.x,b.y,s.EXTENT,0),D.emplaceBack(L.x,L.y,0,s.EXTENT),D.emplaceBack(E.x,E.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=n.createVertexBuffer(D,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,c=n.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(n,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(n)}loadTile(n,c){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},c(null)):(n.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Gi={vector:ni,raster:qt,"raster-dem":class extends qt{constructor(f,n,c,g){super(f,n,c,g),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(f,n){const c=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(b,E){b&&(f.state="errored",n(b)),E&&(f.dem=E,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",n(null))}f.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),(function(b,E,L,D){if(delete f.request,f.aborted)f.state="unloaded",n(null);else if(b)f.state="errored",n(b);else if(E){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:L,expires:D});const F=s.window.ImageBitmap&&E instanceof s.window.ImageBitmap&&(un==null&&(un=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),un),W=1-(E.width-s.prevPowerOfTwo(E.width))/2;W<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const H=F?E:s.exported.getImageData(E,W),Q={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:W};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",Q,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const n=f.canonical,c=Math.pow(2,n.z),g=(n.x-1+c)%c,b=n.x===0?f.wrap-1:f.wrap,E=(n.x+1+c)%c,L=n.x+1===c?f.wrap+1:f.wrap,D={};return D[new s.OverscaledTileID(f.overscaledZ,b,n.z,g,n.y).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,L,n.z,E,n.y).key]={backfilled:!1},n.y>0&&(D[new s.OverscaledTileID(f.overscaledZ,b,n.z,g,n.y-1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,f.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,L,n.z,E,n.y-1).key]={backfilled:!1}),n.y+1<c&&(D[new s.OverscaledTileID(f.overscaledZ,b,n.z,g,n.y+1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,f.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},D[new s.OverscaledTileID(f.overscaledZ,L,n.z,E,n.y+1).key]={backfilled:!1}),D}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends s.Evented{constructor(f,n,c,g){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(g),this._data=n.data,this._options=s.extend({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const b=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*b,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*b,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:s.EXTENT,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*b,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},n),this}getClusterChildren(f,n){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},n),this}getClusterLeaves(f,n,c,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:n,offset:c},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=s.extend({},this.workerOptions),n=this._data;typeof n=="string"?(f.request=this.map._requestManager.transformRequest(s.exported.resolveURL(n),s.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(c,g)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(b.resourceTiming=g.resourceTiming[this.id]),this.fire(new s.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,n){const c=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(c,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,b)=>(delete f.request,f.unloadVectorData(),f.aborted?n(null):g?n(g):(f.loadVectorData(b,this.map.painter,c==="reloadTile"),n(null))),void 0,c==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends zi{constructor(f,n,c,g){super(f,n,c,g),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const n of f.urls)this.urls.push(this.map._requestManager.transformRequest(n,s.ResourceType.Source).url);s.getVideo(this.urls,(n,c)=>{this._loaded=!0,n?this.fire(new s.ErrorEvent(n)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const n=this.video.seekable;f<n.start(0)||f>n.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,n=f.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(f,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:zi,canvas:class extends zi{constructor(f,n,c,g){super(f,n,c,g),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(E=>typeof E!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends s.Evented{constructor(f,n,c,g){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=n,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new mi(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:n,y:c,z:g}=f.canonical;return this._implementation.hasTile({x:n,y:c,z:g})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,n){const{x:c,y:g,z:b}=f.tileID.canonical,E=new s.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:c,y:g,z:b},{signal:E.signal})).then((function(L){return delete f.request,f.aborted?(f.state="unloaded",n(null)):L===void 0?(f.state="errored",n(null)):L===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",n(null)):function(D){return D instanceof s.window.ImageData||D instanceof s.window.HTMLCanvasElement||D instanceof s.window.ImageBitmap||D instanceof s.window.HTMLImageElement}(L)?(this.loadTileData(f,L),f.state="loaded",void n(null)):(f.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(L=>{L.code!==20&&(f.state="errored",n(L))}),f.request.cancel=()=>E.abort()}loadTileData(f,n){qt.loadTileData(f,n,this._map.painter)}unloadTileData(f){qt.unloadTileData(f,this._map.painter)}unloadTile(f,n){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:c,y:g,z:b}=f.tileID.canonical;this._implementation.unloadTile({x:c,y:g,z:b})}n()}abortTile(f,n){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),n()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ar=function(f,n,c,g){const b=new Gi[n.type](f,n,c,g);if(b.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${b.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],b),b};function dr(f,n){const c=s.identity([]);return s.scale(c,c,[.5*f.width,.5*-f.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,f.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(c)}function dn(f,n,c,g,b,E,L,D=!1){const F=f.tilesIn(g,L,D);F.sort(as);const W=[];for(const Q of F)W.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(n,c,f._state,Q,b,E,dr(f.transform,Q.tile.tileID),D)});const H=function(Q){const he={},me={};for(const ye of Q){const _e=ye.queryResults,be=ye.wrappedTileID,ee=me[be]=me[be]||{};for(const pe in _e){const Ce=_e[pe],Ie=ee[pe]=ee[pe]||{},Ge=he[pe]=he[pe]||[];for(const Fe of Ce)Ie[Fe.featureIndex]||(Ie[Fe.featureIndex]=!0,Ge.push(Fe))}}return he}(W);for(const Q in H)H[Q].forEach(he=>{const me=he.feature,ye=me.layer;ye&&ye.type!=="background"&&ye.type!=="sky"&&(me.source=ye.source,ye["source-layer"]&&(me.sourceLayer=ye["source-layer"]),me.state=me.id!==void 0?f.getFeatureState(ye["source-layer"],me.id):{})});return H}function xn(f,n){const c=f.getRenderableIds().map(E=>f.getTileByID(E)),g=[],b={};for(let E=0;E<c.length;E++){const L=c[E],D=L.tileID.canonical.key;b[D]||(b[D]=!0,L.querySourceFeatures(g,n))}return g}function as(f,n){const c=f.tileID,g=n.tileID;return c.overscaledZ-g.overscaledZ||c.canonical.y-g.canonical.y||c.wrap-g.wrap||c.canonical.x-g.canonical.x}function Gn(){return dc.workerClass!=null?new dc.workerClass:new s.window.Worker(dc.workerUrl)}const Uo="mapboxgl_preloaded_worker_pool";class Wn{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Wn.workerCount;)this.workers.push(new Gn);return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Uo]}numActive(){return Object.keys(this.active).length}}let ds;function Cn(){return ds||(ds=new Wn),ds}function Ff(f,n){const c={};for(const g in f)g!=="ref"&&(c[g]=f[g]);return s.refProperties.forEach(g=>{g in n&&(c[g]=n[g])}),c}function Nf(f){f=f.slice();const n=Object.create(null);for(let c=0;c<f.length;c++)n[f[c].id]=f[c];for(let c=0;c<f.length;c++)"ref"in f[c]&&(f[c]=Ff(f[c],n[f[c].ref]));return f}Wn.workerCount=2;const Tr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function id(f,n,c){c.push({command:Tr.addSource,args:[f,n[f]]})}function Bc(f,n,c){n.push({command:Tr.removeSource,args:[f]}),c[f]=!0}function Rh(f,n,c,g){Bc(f,c,g),id(f,n,c)}function zh(f,n,c){let g;for(g in f[c])if(f[c].hasOwnProperty(g)&&g!=="data"&&!$(f[c][g],n[c][g]))return!1;for(g in n[c])if(n[c].hasOwnProperty(g)&&g!=="data"&&!$(f[c][g],n[c][g]))return!1;return!0}function xo(f,n,c,g,b,E){let L;for(L in n=n||{},f=f||{})f.hasOwnProperty(L)&&($(f[L],n[L])||c.push({command:E,args:[g,L,n[L],b]}));for(L in n)n.hasOwnProperty(L)&&!f.hasOwnProperty(L)&&($(f[L],n[L])||c.push({command:E,args:[g,L,n[L],b]}))}function Vo(f){return f.id}function rd(f,n){return f[n.id]=n,f}class Fc{constructor(n,c){this.reset(n,c)}reset(n,c){this.points=n||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=s.clamp(n,0,1);let c=1,g=this._distances[c];const b=n*this.paddedLength+this.padding;for(;g<b&&c<this._distances.length;)g=this._distances[++c];const E=c-1,L=this._distances[E],D=g-L,F=D>0?(b-L)/D:0;return this.points[E].mult(1-F).add(this.points[c].mult(F))}}class jo{constructor(n,c,g){const b=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(n/g),this.yCellCount=Math.ceil(c/g);for(let L=0;L<this.xCellCount*this.yCellCount;L++)b.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=c,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,c,g,b,E){this._forEachCell(c,g,b,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(E)}insertCircle(n,c,g,b){this._forEachCell(c-b,g-b,c+b,g+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(c),this.circles.push(g),this.circles.push(b)}_insertBoxCell(n,c,g,b,E,L){this.boxCells[E].push(L)}_insertCircleCell(n,c,g,b,E,L){this.circleCells[E].push(L)}_query(n,c,g,b,E,L){if(g<0||n>this.width||b<0||c>this.height)return!E&&[];const D=[];if(n<=0&&c<=0&&this.width<=g&&this.height<=b){if(E)return!0;for(let F=0;F<this.boxKeys.length;F++)D.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const W=this.circles[3*F],H=this.circles[3*F+1],Q=this.circles[3*F+2];D.push({key:this.circleKeys[F],x1:W-Q,y1:H-Q,x2:W+Q,y2:H+Q})}return L?D.filter(L):D}return this._forEachCell(n,c,g,b,this._queryCell,D,{hitTest:E,seenUids:{box:{},circle:{}}},L),E?D.length>0:D}_queryCircle(n,c,g,b,E){const L=n-g,D=n+g,F=c-g,W=c+g;if(D<0||L>this.width||W<0||F>this.height)return!b&&[];const H=[];return this._forEachCell(L,F,D,W,this._queryCellCircle,H,{hitTest:b,circle:{x:n,y:c,radius:g},seenUids:{box:{},circle:{}}},E),b?H.length>0:H}query(n,c,g,b,E){return this._query(n,c,g,b,!1,E)}hitTest(n,c,g,b,E){return this._query(n,c,g,b,!0,E)}hitTestCircle(n,c,g,b){return this._queryCircle(n,c,g,!0,b)}_queryCell(n,c,g,b,E,L,D,F){const W=D.seenUids,H=this.boxCells[E];if(H!==null){const he=this.bboxes;for(const me of H)if(!W.box[me]){W.box[me]=!0;const ye=4*me;if(n<=he[ye+2]&&c<=he[ye+3]&&g>=he[ye+0]&&b>=he[ye+1]&&(!F||F(this.boxKeys[me]))){if(D.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[me],x1:he[ye],y1:he[ye+1],x2:he[ye+2],y2:he[ye+3]})}}}const Q=this.circleCells[E];if(Q!==null){const he=this.circles;for(const me of Q)if(!W.circle[me]){W.circle[me]=!0;const ye=3*me;if(this._circleAndRectCollide(he[ye],he[ye+1],he[ye+2],n,c,g,b)&&(!F||F(this.circleKeys[me]))){if(D.hitTest)return L.push(!0),!0;{const _e=he[ye],be=he[ye+1],ee=he[ye+2];L.push({key:this.circleKeys[me],x1:_e-ee,y1:be-ee,x2:_e+ee,y2:be+ee})}}}}}_queryCellCircle(n,c,g,b,E,L,D,F){const W=D.circle,H=D.seenUids,Q=this.boxCells[E];if(Q!==null){const me=this.bboxes;for(const ye of Q)if(!H.box[ye]){H.box[ye]=!0;const _e=4*ye;if(this._circleAndRectCollide(W.x,W.y,W.radius,me[_e+0],me[_e+1],me[_e+2],me[_e+3])&&(!F||F(this.boxKeys[ye])))return L.push(!0),!0}}const he=this.circleCells[E];if(he!==null){const me=this.circles;for(const ye of he)if(!H.circle[ye]){H.circle[ye]=!0;const _e=3*ye;if(this._circlesCollide(me[_e],me[_e+1],me[_e+2],W.x,W.y,W.radius)&&(!F||F(this.circleKeys[ye])))return L.push(!0),!0}}}_forEachCell(n,c,g,b,E,L,D,F){const W=this._convertToXCellCoord(n),H=this._convertToYCellCoord(c),Q=this._convertToXCellCoord(g),he=this._convertToYCellCoord(b);for(let me=W;me<=Q;me++)for(let ye=H;ye<=he;ye++)if(E.call(this,n,c,g,b,this.xCellCount*ye+me,L,D,F))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,c,g,b,E,L){const D=b-n,F=E-c,W=g+L;return W*W>D*D+F*F}_circleAndRectCollide(n,c,g,b,E,L,D){const F=(L-b)/2,W=Math.abs(n-(b+F));if(W>F+g)return!1;const H=(D-E)/2,Q=Math.abs(c-(E+H));if(Q>H+g)return!1;if(W<=F||Q<=H)return!0;const he=W-F,me=Q-H;return he*he+me*me<=g*g}}const fa={unknown:0,flipRequired:1,flipNotRequired:2},jr=Math.tan(85*Math.PI/180);function wt(f,n,c,g,b,E,L){const D=s.create();if(c)if(E.name==="globe"){const F=s.calculateGlobeLabelMatrix(b,n);s.multiply(D,D,F)}else{const F=He([],L);D[0]=F[0],D[1]=F[1],D[4]=F[2],D[5]=F[3],g||s.rotateZ(D,D,b.angle)}else s.multiply(D,b.labelPlaneMatrix,f);return D}function $o(f,n,c,g,b,E,L){const D=wt(f,n,c,g,b,E,L);return E.name==="globe"&&c||(D[2]=D[6]=D[10]=D[14]=0),D}function Nn(f,n,c,g,b,E,L){if(c){if(E.name==="globe"){const D=wt(f,n,c,g,b,E,L);return s.invert(D,D),s.multiply(D,f,D),D}{const D=s.clone(f),F=s.identity([]);return F[0]=L[0],F[1]=L[1],F[4]=L[2],F[5]=L[3],s.multiply(D,D,F),g||s.rotateZ(D,D,-b.angle),D}}return b.glCoordMatrix}function es(f,n,c,g){const b=[f,n,c,1];c?s.transformMat4$1(b,b,g):Ji(b,b,g);const E=b[3];return b[0]/=E,b[1]/=E,b[2]/=E,b}function Uf(f,n){return Math.min(.5+f/n*.5,1.5)}function Go(f,n){const c=f[0]/f[3],g=f[1]/f[3];return c>=-n[0]&&c<=n[0]&&g>=-n[1]&&g<=n[1]}function Bh(f,n,c,g,b,E,L,D,F,W){const H=c.transform,Q=g?f.textSizeData:f.iconSizeData,he=s.evaluateSizeForZoom(Q,c.transform.zoom),me=H.projection.name==="globe",ye=[256/c.width*2+1,256/c.height*2+1],_e=g?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;_e.clear();let be=null;me&&(be=g?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const ee=f.lineVertexArray,pe=g?f.text.placedSymbolArray:f.icon.placedSymbolArray,Ce=c.transform.width/c.transform.height;let Ie,Ge=!1;for(let Fe=0;Fe<pe.length;Fe++){const We=pe.get(Fe),{numGlyphs:it,writingMode:et}=We;if(et!==s.WritingMode.vertical||Ge||Ie===s.WritingMode.horizontal||(Ge=!0),Ie=et,(We.hidden||et===s.WritingMode.vertical)&&!Ge){Ks(it,_e);continue}Ge=!1;const pt=new s.Point(We.tileAnchorX,We.tileAnchorY);let{x:Nt,y:ht,z:Ct}=H.projection.projectTilePoint(pt.x,pt.y,W.canonical);if(F){const[Ni,bi,Li]=F(pt);Nt+=Ni,ht+=bi,Ct+=Li}const yt=[Nt,ht,Ct,1];if(s.transformMat4$1(yt,yt,n),!Go(yt,ye)){Ks(it,_e);continue}const jt=Uf(c.transform.cameraToCenterDistance,yt[3]),at=s.evaluateSizeForFeature(Q,he,We),Mt=L?at/jt:at*jt,Gt=es(Nt,ht,Ct,b);if(Gt[3]<=0){Ks(it,_e);continue}let Et={};const Xt=L?null:F,ki=hi(We,Mt,!1,D,n,b,E,f.glyphOffsetArray,ee,_e,be,Gt,pt,Et,Ce,Xt,H.projection,W,L);Ge=ki.useVertical,Xt&&ki.needsFlipping&&(Et={}),(ki.notEnoughRoom||Ge||ki.needsFlipping&&hi(We,Mt,!0,D,n,b,E,f.glyphOffsetArray,ee,_e,be,Gt,pt,Et,Ce,Xt,H.projection,W,L).notEnoughRoom)&&Ks(it,_e)}g?(f.text.dynamicLayoutVertexBuffer.updateData(_e),be&&f.text.globeExtVertexBuffer.updateData(be)):(f.icon.dynamicLayoutVertexBuffer.updateData(_e),be&&f.icon.globeExtVertexBuffer.updateData(be))}function Vf(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e){const{lineStartIndex:be,glyphStartIndex:ee,segment:pe}=D,Ce=ee+D.numGlyphs,Ie=be+D.lineLength,Ge=n.getoffsetX(ee),Fe=n.getoffsetX(Ce-1),We=Ls(f*Ge,c,g,b,E,L,pe,be,Ie,F,W,H,Q,he,!0,me,ye,_e);if(!We)return null;const it=Ls(f*Fe,c,g,b,E,L,pe,be,Ie,F,W,H,Q,he,!0,me,ye,_e);return it?{first:We,last:it}:null}function Wl(f,n,c,g){return f===s.WritingMode.horizontal&&Math.abs(g)>Math.abs(c)?{useVertical:!0}:f===s.WritingMode.vertical?g>0?{needsFlipping:!0}:null:n!==fa.unknown&&function(b,E){return b===0||Math.abs(E/b)>jr}(c,g)?n===fa.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function hi(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be,ee,pe){const Ce=n/24,Ie=f.lineOffsetX*Ce,Ge=f.lineOffsetY*Ce,{lineStartIndex:Fe,glyphStartIndex:We,numGlyphs:it,segment:et,writingMode:pt,flipState:Nt}=f,ht=Fe+f.lineLength,Ct=yt=>{if(H){const[Gt,Et,Xt]=yt.up,ki=W.length;s.updateGlobeVertexNormal(H,ki+0,Gt,Et,Xt),s.updateGlobeVertexNormal(H,ki+1,Gt,Et,Xt),s.updateGlobeVertexNormal(H,ki+2,Gt,Et,Xt),s.updateGlobeVertexNormal(H,ki+3,Gt,Et,Xt)}const[jt,at,Mt]=yt.point;s.addDynamicAttributes(W,jt,at,Mt,yt.angle)};if(it>1){const yt=Vf(Ce,D,Ie,Ge,c,Q,he,f,F,E,me,_e,!1,be,ee,pe);if(!yt)return{notEnoughRoom:!0};if(g&&!c){let[jt,at,Mt]=yt.first.point,[Gt,Et,Xt]=yt.last.point;[jt,at]=es(jt,at,Mt,L),[Gt,Et]=es(Gt,Et,Xt,L);const ki=Wl(pt,Nt,(Gt-jt)*ye,Et-at);if(f.flipState=ki&&ki.needsFlipping?fa.flipRequired:fa.flipNotRequired,ki)return ki}Ct(yt.first);for(let jt=We+1;jt<We+it-1;jt++){const at=Ls(Ce*D.getoffsetX(jt),Ie,Ge,c,Q,he,et,Fe,ht,F,E,me,_e,!1,!1,be,ee,pe);if(!at)return W.length-=4*(jt-We),{notEnoughRoom:!0};Ct(at)}Ct(yt.last)}else{if(g&&!c){const jt=es(he.x,he.y,0,b),at=Fe+et+1,Mt=new s.Point(F.getx(at),F.gety(at)),Gt=es(Mt.x,Mt.y,0,b),Et=Gt[3]>0?Gt:Ki(he,Mt,jt,1,b,void 0,be,ee.canonical),Xt=Wl(pt,Nt,(Et[0]-jt[0])*ye,Et[1]-jt[1]);if(f.flipState=Xt&&Xt.needsFlipping?fa.flipRequired:fa.flipNotRequired,Xt)return Xt}const yt=Ls(Ce*D.getoffsetX(We),Ie,Ge,c,Q,he,et,Fe,ht,F,E,me,_e,!1,!1,be,ee,pe);if(!yt)return{notEnoughRoom:!0};Ct(yt)}return{}}function hr(f,n,c,g,b){const{x:E,y:L,z:D}=g.projectTilePoint(f.x,f.y,n);if(!b)return es(E,L,D,c);const[F,W,H]=b(f);return es(E+F,L+W,D+H,c)}function Ki(f,n,c,g,b,E,L,D){const F=hr(f.sub(n)._unit()._add(f),D,b,L,E);return s.sub(F,c,F),s.normalize(F,F),s.scaleAndAdd(F,c,F,g)}function Ls(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be,ee){const pe=g?f-n:f+n;let Ce=pe>0?1:-1,Ie=0;g&&(Ce*=-1,Ie=Math.PI),Ce<0&&(Ie+=Math.PI);let Ge=D+L+(Ce>0?0:1)|0,Fe=b,We=b,it=0,et=0;const pt=Math.abs(pe),Nt=[],ht=[];let Ct=E,yt=Ct;const jt=()=>Ki(yt,Ct,We,pt-it+1,H,he,_e,be.canonical);for(;it+et<=pt;){if(Ge+=Ce,Ge<D||Ge>=F)return null;if(We=Fe,yt=Ct,Nt.push(We),me&&ht.push(yt),Ct=new s.Point(W.getx(Ge),W.gety(Ge)),Fe=Q[Ge],!Fe){const Li=hr(Ct,be.canonical,H,_e,he);Fe=Li[3]>0?Q[Ge]=Li:jt()}it+=et,et=s.distance(We,Fe)}ye&&he&&(Q[Ge]&&(Fe=jt(),et=s.distance(We,Fe)),Q[Ge]=Fe);const at=(pt-it)/et,Mt=Ct.sub(yt)._mult(at)._add(yt),Gt=s.sub([],Fe,We),Et=s.scaleAndAdd([],We,Gt,at);let Xt=[0,0,1],ki=Gt[0],Ni=Gt[1];if(ee&&(Xt=_e.upVector(be.canonical,Mt.x,Mt.y),Xt[0]!==0||Xt[1]!==0||Xt[2]!==1)){const Li=[Xt[2],0,-Xt[0]],Wi=s.cross([],Xt,Li);s.normalize(Li,Li),s.normalize(Wi,Wi),ki=s.dot(Gt,Li),Ni=s.dot(Gt,Wi)}if(c){const Li=s.cross([],Xt,Gt);s.normalize(Li,Li),s.scaleAndAdd(Et,Et,Li,c*Ce)}const bi=Ie+Math.atan2(Ni,ki);return Nt.push(Et),me&&ht.push(Mt),{point:Et,angle:bi,path:Nt,tilePath:ht,up:Xt}}function Ks(f,n){const c=n.length,g=c+4*f;n.resize(g),n.float32.fill(-1/0,4*c,4*g)}function Ji(f,n,c){const g=n[0],b=n[1];return f[0]=c[0]*g+c[4]*b+c[12],f[1]=c[1]*g+c[5]*b+c[13],f[3]=c[3]*g+c[7]*b+c[15],f}const Ds=100;class fs{constructor(n,c,g=new jo(n.width+200,n.height+200,25),b=new jo(n.width+200,n.height+200,25)){this.transform=n,this.grid=g,this.ignoredGrid=b,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Ds,this.screenBottomBoundary=n.height+Ds,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=c}placeCollisionBox(n,c,g,b,E,L,D,F){let W=g.projectedAnchorX,H=g.projectedAnchorY,Q=g.projectedAnchorZ;const he=g.elevation,me=g.tileID,ye=n.getProjection();if(he&&me){const[Fe,We,it]=ye.upVector(me.canonical,g.tileAnchorX,g.tileAnchorY),et=ye.upVectorScale(me.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=Fe*he*et,H+=We*he*et,Q+=it*he*et}const _e=this.projectAndGetPerspectiveRatio(D,W,H,Q,g.tileID,ye.name==="globe"||!!he||this.transform.pitch>0,ye),be=L*_e.perspectiveRatio,ee=(g.x1*c+b.x-g.padding)*be+_e.point.x,pe=(g.y1*c+b.y-g.padding)*be+_e.point.y,Ce=(g.x2*c+b.x+g.padding)*be+_e.point.x,Ie=(g.y2*c+b.y+g.padding)*be+_e.point.y,Ge=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(ee,pe,Ce,Ie)||!E&&this.grid.hitTest(ee,pe,Ce,Ie,F)||Ge?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[ee,pe,Ce,Ie],offscreen:this.isOffscreen(ee,pe,Ce,Ie),occluded:!1}}placeCollisionCircles(n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e){const be=[],ee=this.transform.elevation,pe=n.getProjection(),Ce=ee?ee.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,pe):null,Ie=new s.Point(g.tileAnchorX,g.tileAnchorY);let{x:Ge,y:Fe,z:We}=pe.projectTilePoint(Ie.x,Ie.y,_e.canonical);if(Ce){const[Mt,Gt,Et]=Ce(Ie);Ge+=Mt,Fe+=Gt,We+=Et}const it=pe.name==="globe",et=this.projectAndGetPerspectiveRatio(D,Ge,Fe,We,_e,it||!!ee||this.transform.pitch>0,pe),{perspectiveRatio:pt}=et,Nt=(Q?L/pt:L*pt)/s.ONE_EM,ht=es(Ge,Fe,We,F),Ct=et.signedDistanceFromCamera>0?Vf(Nt,E,g.lineOffsetX*Nt,g.lineOffsetY*Nt,!1,ht,Ie,g,b,F,{},ee&&!Q?Ce:null,Q&&!!ee,pe,_e,Q):null;let yt=!1,jt=!1,at=!0;if(Ct&&!et.occluded){const Mt=.5*me*pt+ye,Gt=new s.Point(-100,-100),Et=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),Xt=new Fc,{first:ki,last:Ni}=Ct,bi=ki.path.length;let Li=[];for(let Ai=bi-1;Ai>=1;Ai--)Li.push(ki.path[Ai]);for(let Ai=1;Ai<Ni.path.length;Ai++)Li.push(Ni.path[Ai]);const Wi=2.5*Mt;W&&(Li=Li.map(([Ai,Mr,Dr],Or)=>(Ce&&!it&&(Dr=Ce(Or<bi-1?ki.tilePath[bi-1-Or]:Ni.tilePath[Or-bi+2])[2]),es(Ai,Mr,Dr,W))),Li.some(Ai=>Ai[3]<=0)&&(Li=[]));let Hi=[];if(Li.length>0){let Ai=1/0,Mr=-1/0,Dr=1/0,Or=-1/0;for(const Rr of Li)Ai=Math.min(Ai,Rr[0]),Dr=Math.min(Dr,Rr[1]),Mr=Math.max(Mr,Rr[0]),Or=Math.max(Or,Rr[1]);Mr>=Gt.x&&Ai<=Et.x&&Or>=Gt.y&&Dr<=Et.y&&(Hi=[Li.map(Rr=>new s.Point(Rr[0],Rr[1]))],(Ai<Gt.x||Mr>Et.x||Dr<Gt.y||Or>Et.y)&&(Hi=s.clipLine(Hi,Gt.x,Gt.y,Et.x,Et.y)))}for(const Ai of Hi){Xt.reset(Ai,.25*Mt);let Mr=0;Mr=Xt.length<=.5*Mt?1:Math.ceil(Xt.paddedLength/Wi)+1;for(let Dr=0;Dr<Mr;Dr++){const Or=Dr/Math.max(Mr-1,1),Rr=Xt.lerp(Or),_s=Rr.x+Ds,ns=Rr.y+Ds;be.push(_s,ns,Mt,0);const no=_s-Mt,Pr=ns-Mt,Yr=_s+Mt,Vr=ns+Mt;if(at=at&&this.isOffscreen(no,Pr,Yr,Vr),jt=jt||this.isInsideGrid(no,Pr,Yr,Vr),!c&&this.grid.hitTestCircle(_s,ns,Mt,he)&&(yt=!0,!H))return{circles:[],offscreen:!1,collisionDetected:yt,occluded:!1}}}}return{circles:!H&&yt||!jt?[]:be,offscreen:at,collisionDetected:yt,occluded:et.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let g=1/0,b=1/0,E=-1/0,L=-1/0;for(const H of n){const Q=new s.Point(H.x+Ds,H.y+Ds);g=Math.min(g,Q.x),b=Math.min(b,Q.y),E=Math.max(E,Q.x),L=Math.max(L,Q.y),c.push(Q)}const D=this.grid.query(g,b,E,L).concat(this.ignoredGrid.query(g,b,E,L)),F={},W={};for(const H of D){const Q=H.key;if(F[Q.bucketInstanceId]===void 0&&(F[Q.bucketInstanceId]={}),F[Q.bucketInstanceId][Q.featureIndex])continue;const he=[new s.Point(H.x1,H.y1),new s.Point(H.x2,H.y1),new s.Point(H.x2,H.y2),new s.Point(H.x1,H.y2)];s.polygonIntersectsPolygon(c,he)&&(F[Q.bucketInstanceId][Q.featureIndex]=!0,W[Q.bucketInstanceId]===void 0&&(W[Q.bucketInstanceId]=[]),W[Q.bucketInstanceId].push(Q.featureIndex))}return W}insertCollisionBox(n,c,g,b,E){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:b,collisionGroupID:E},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,c,g,b,E){const L=c?this.ignoredGrid:this.grid,D={bucketInstanceId:g,featureIndex:b,collisionGroupID:E};for(let F=0;F<n.length;F+=4)L.insertCircle(D,n[F],n[F+1],n[F+2])}projectAndGetPerspectiveRatio(n,c,g,b,E,L,D){const F=[c,g,b,1];let W=!1;b||this.transform.pitch>0?(s.transformMat4$1(F,F,n),this.fogState&&E&&D.name!=="globe"&&(W=function(he,me,ye,_e,be,ee){const pe=ee.calculateFogTileMatrix(be),Ce=[me,ye,_e];return s.transformMat4(Ce,Ce,pe),ci(he,Ce,ee.pitch,ee._fov)}(this.fogState,c,g,b,E.toUnwrapped(),this.transform)>.9)):Ji(F,F,n);const H=F[3];return{point:new s.Point((F[0]/H+1)/2*this.transform.width+Ds,(-F[1]/H+1)/2*this.transform.height+Ds),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/H*.5,1.5),signedDistanceFromCamera:H,occluded:L&&F[2]>H||W}}isOffscreen(n,c,g,b){return g<Ds||n>=this.screenRightBoundary||b<Ds||c>this.screenBottomBoundary}isInsideGrid(n,c,g,b){return g>=0&&n<this.gridRightBoundary&&b>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const n=s.identity([]);return s.translate(n,n,[-100,-100,0]),n}}function vo(f,n,c){const g=n.createTileMatrix(f,f.worldSize,c.toUnwrapped());return s.multiply(new Float32Array(16),f.projMatrix,g)}function Js(f,n,c){if(n.projection.name===c.projection.name)return f.projMatrix;const g=c.clone();return g.setProjection(n.projection),vo(g,n.getProjection(),f)}function on(f,n,c){return n.name===c.projection.name?f.projMatrix:vo(c,n,f)}class jf{constructor(n,c,g,b){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?c:-c))):b&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class bo{constructor(n,c,g,b,E,L=!1){this.text=new jf(n?n.text:null,c,g,E),this.icon=new jf(n?n.icon:null,c,b,E),this.clipped=L}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ua{constructor(n,c,g,b=!1){this.text=n,this.icon=c,this.skipFade=g,this.clipped=b}}class Nc{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class nd{constructor(n,c,g,b,E){this.bucketInstanceId=n,this.featureIndex=c,this.sourceLayerIndex=g,this.bucketIndex=b,this.tileID=E}}class sd{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const c=++this.maxGroupID;this.collisionGroups[n]={ID:c,predicate:g=>g.collisionGroupID===c}}return this.collisionGroups[n]}}function Hl(f,n,c,g,b){const{horizontalAlign:E,verticalAlign:L}=s.getAnchorAlignment(f),D=-(E-.5)*n,F=-(L-.5)*c,W=s.evaluateVariableOffset(f,g);return new s.Point(D+W[0]*b,F+W[1]*b)}function Wo(f,n,c,g,b){const E=new s.Point(f,n);return c&&E._rotate(g?b:-b),E}class Fh{constructor(n,c,g,b,E){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new fs(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new sd(g),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,c,g,b){const E=g.getBucket(c),L=g.latestFeatureIndex;if(!E||!L||c.id!==E.layerIds[0])return;const D=E.layers[0].layout,F=g.collisionBoxArray,W=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),H=g.tileSize/s.EXTENT,Q=g.tileID.toUnwrapped();this.transform.setProjection(E.projection);const he=(me=g.tileID,ye=E.getProjection(),_e=this.transform,ye.name===this.projection?_e.calculateProjMatrix(me.toUnwrapped()):vo(_e,ye,me));var me,ye,_e;const be=D.get("text-pitch-alignment")==="map",ee=D.get("text-rotation-alignment")==="map";c.compileFilter();const pe=c.dynamicFilter(),Ce=c.dynamicFilterNeedsFeature(),Ie=this.transform.calculatePixelsToTileUnitsMatrix(g),Ge=$o(he,g.tileID.canonical,be,ee,this.transform,E.getProjection(),Ie);let Fe=null;if(be){const et=Nn(he,g.tileID.canonical,be,ee,this.transform,E.getProjection(),Ie);Fe=s.multiply([],this.transform.labelPlaneMatrix,et)}let We=null;pe&&g.latestFeatureIndex&&(We={unwrappedTileID:Q,dynamicFilter:pe,dynamicFilterNeedsFeature:Ce,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new nd(E.bucketInstanceId,L,E.sourceLayerIndex,E.index,g.tileID);const it={bucket:E,layout:D,posMatrix:he,textLabelPlaneMatrix:Ge,labelToScreenMatrix:Fe,clippingData:We,scale:W,textPixelRatio:H,holdingForFade:g.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(b)for(const et of E.sortKeyRanges){const{sortKey:pt,symbolInstanceStart:Nt,symbolInstanceEnd:ht}=et;n.push({sortKey:pt,symbolInstanceStart:Nt,symbolInstanceEnd:ht,parameters:it})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:it})}attemptAnchorPlacement(n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be,ee,pe){const{textOffset0:Ce,textOffset1:Ie,crossTileID:Ge}=he,Fe=[Ce,Ie],We=Hl(n,g,b,Fe,E),it=this.collisionIndex.placeCollisionBox(ye,E,c,Wo(We.x,We.y,L,D,this.transform.angle),Q,F,W,H.predicate);if(be){const et=ye.getSymbolInstanceIconSize(pe,this.transform.zoom,he.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ye,et,be,Wo(We.x,We.y,L,D,this.transform.angle),Q,F,W,H.predicate).box.length===0)return}if(it.box.length>0){let et;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ge]&&this.prevPlacement.placements[Ge]&&this.prevPlacement.placements[Ge].text&&(et=this.prevPlacement.variableOffsets[Ge].anchor),this.variableOffsets[Ge]={textOffset:Fe,width:g,height:b,anchor:n,textScale:E,prevAnchor:et},this.markUsedJustification(ye,n,he,_e),ye.allowVerticalPlacement&&(this.markUsedOrientation(ye,_e,he),this.placedOrientations[Ge]=_e),{shift:We,placedGlyphBoxes:it}}}placeLayerBucketPart(n,c,g,b){const{bucket:E,layout:L,posMatrix:D,textLabelPlaneMatrix:F,labelToScreenMatrix:W,clippingData:H,textPixelRatio:Q,holdingForFade:he,collisionBoxArray:me,partiallyEvaluatedTextSize:ye,partiallyEvaluatedIconSize:_e,collisionGroup:be}=n.parameters,ee=L.get("text-optional"),pe=L.get("icon-optional"),Ce=L.get("text-allow-overlap"),Ie=L.get("icon-allow-overlap"),Ge=L.get("text-rotation-alignment")==="map",Fe=L.get("text-pitch-alignment")==="map",We=L.get("icon-text-fit")!=="none",it=L.get("symbol-z-order")==="viewport-y";this.transform.setProjection(E.projection);let et=Ce&&(Ie||!E.hasIconData()||pe),pt=Ie&&(Ce||!E.hasTextData()||ee);!E.collisionArrays&&me&&E.deserializeCollisionBoxes(me),g&&b&&E.updateCollisionDebugBuffers(this.transform.zoom,me);const Nt=(ht,Ct,yt)=>{const{crossTileID:jt,numVerticalGlyphVertices:at}=ht;if(H){const Yr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Vr=null;if(H.dynamicFilterNeedsFeature){const gr=this.retainedQueryData[E.bucketInstanceId];Vr=H.featureIndex.loadFeature({featureIndex:ht.featureIndex,bucketIndex:gr.bucketIndex,sourceLayerIndex:gr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,H.dynamicFilter)(Yr,Vr,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new s.Point(ht.tileAnchorX,ht.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[jt]=new Ua(!1,!1,!1,!0),void c.add(jt)}if(c.has(jt))return;if(he)return void(this.placements[jt]=new Ua(!1,!1,!1));let Mt=!1,Gt=!1,Et=!0,Xt=!1,ki=!1,Ni=null,bi={box:null,offscreen:null,occluded:null},Li={box:null},Wi=null,Hi=null,Ai=null,Mr=0,Dr=0,Or=0;yt.textFeatureIndex?Mr=yt.textFeatureIndex:ht.useRuntimeCollisionCircles&&(Mr=ht.featureIndex),yt.verticalTextFeatureIndex&&(Dr=yt.verticalTextFeatureIndex);const Rr=Yr=>{Yr.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Vr=this.transform.elevation;(Vr||Yr.elevation)&&(Yr.elevation=Vr?Vr.getAtTileOffset(Yr.tileID,Yr.tileAnchorX,Yr.tileAnchorY):0)},_s=yt.textBox;if(_s){Rr(_s);const Yr=gr=>{let Un=s.WritingMode.horizontal;if(E.allowVerticalPlacement&&!gr&&this.prevPlacement){const Ss=this.prevPlacement.placedOrientations[jt];Ss&&(this.placedOrientations[jt]=Ss,Un=Ss,this.markUsedOrientation(E,Un,ht))}return Un},Vr=(gr,Un)=>{if(E.allowVerticalPlacement&&at>0&&yt.verticalTextBox){for(const Ss of E.writingModes)if(Ss===s.WritingMode.vertical?(bi=Un(),Li=bi):bi=gr(),bi&&bi.box&&bi.box.length)break}else bi=gr()};if(L.get("text-variable-anchor")){let gr=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[jt]){const Kr=this.prevPlacement.variableOffsets[jt];gr.indexOf(Kr.anchor)>0&&(gr=gr.filter(qn=>qn!==Kr.anchor),gr.unshift(Kr.anchor))}const Un=(Kr,qn,uu)=>{const Ea=E.getSymbolInstanceTextSize(ye,ht,this.transform.zoom,Ct),fc=(Kr.x2-Kr.x1)*Ea+2*Kr.padding,Ko=(Kr.y2-Kr.y1)*Ea+2*Kr.padding,Sa=We&&!Ie?qn:null;Sa&&Rr(Sa);let Tl={box:[],offscreen:!1,occluded:!1};const wn=Ce?2*gr.length:gr.length;for(let lh=0;lh<wn;++lh){const zd=this.attemptAnchorPlacement(gr[lh%gr.length],Kr,fc,Ko,Ea,Ge,Fe,Q,D,be,lh>=gr.length,ht,Ct,E,uu,Sa,ye,_e);if(zd&&(Tl=zd.placedGlyphBoxes,Tl&&Tl.box&&Tl.box.length)){Mt=!0,Ni=zd.shift;break}}return Tl};Vr(()=>Un(_s,yt.iconBox,s.WritingMode.horizontal),()=>{const Kr=yt.verticalTextBox;return Kr&&Rr(Kr),E.allowVerticalPlacement&&!(bi&&bi.box&&bi.box.length)&&at>0&&Kr?Un(Kr,yt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),bi&&(Mt=bi.box,Et=bi.offscreen,Xt=bi.occluded);const Ss=Yr(!(!bi||!bi.box));if(!Mt&&this.prevPlacement){const Kr=this.prevPlacement.variableOffsets[jt];Kr&&(this.variableOffsets[jt]=Kr,this.markUsedJustification(E,Kr.anchor,ht,Ss))}}else{const gr=(Un,Ss)=>{const Kr=E.getSymbolInstanceTextSize(ye,ht,this.transform.zoom,Ct),qn=this.collisionIndex.placeCollisionBox(E,Kr,Un,new s.Point(0,0),Ce,Q,D,be.predicate);return qn&&qn.box&&qn.box.length&&(this.markUsedOrientation(E,Ss,ht),this.placedOrientations[jt]=Ss),qn};Vr(()=>gr(_s,s.WritingMode.horizontal),()=>{const Un=yt.verticalTextBox;return E.allowVerticalPlacement&&at>0&&Un?(Rr(Un),gr(Un,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Yr(!!(bi&&bi.box&&bi.box.length))}}if(Wi=bi,Mt=Wi&&Wi.box&&Wi.box.length>0,Et=Wi&&Wi.offscreen,Xt=Wi&&Wi.occluded,ht.useRuntimeCollisionCircles){const Yr=E.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex>=0?ht.centerJustifiedTextSymbolIndex:ht.verticalPlacedTextSymbolIndex),Vr=s.evaluateSizeForFeature(E.textSizeData,ye,Yr),gr=L.get("text-padding");Hi=this.collisionIndex.placeCollisionCircles(E,Ce,Yr,E.lineVertexArray,E.glyphOffsetArray,Vr,D,F,W,g,Fe,be.predicate,ht.collisionCircleDiameter*Vr/s.ONE_EM,gr,this.retainedQueryData[E.bucketInstanceId].tileID),Mt=Ce||Hi.circles.length>0&&!Hi.collisionDetected,Et=Et&&Hi.offscreen,Xt=Hi.occluded}if(yt.iconFeatureIndex&&(Or=yt.iconFeatureIndex),yt.iconBox){const Yr=Vr=>{Rr(Vr);const gr=We&&Ni?Wo(Ni.x,Ni.y,Ge,Fe,this.transform.angle):new s.Point(0,0),Un=E.getSymbolInstanceIconSize(_e,this.transform.zoom,ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Un,Vr,gr,Ie,Q,D,be.predicate)};Li&&Li.box&&Li.box.length&&yt.verticalIconBox?(Ai=Yr(yt.verticalIconBox),Gt=Ai.box.length>0):(Ai=Yr(yt.iconBox),Gt=Ai.box.length>0),Et=Et&&Ai.offscreen,ki=Ai.occluded}const ns=ee||ht.numHorizontalGlyphVertices===0&&at===0,no=pe||ht.numIconVertices===0;if(ns||no?no?ns||(Gt=Gt&&Mt):Mt=Gt&&Mt:Gt=Mt=Gt&&Mt,Mt&&Wi&&Wi.box&&this.collisionIndex.insertCollisionBox(Wi.box,L.get("text-ignore-placement"),E.bucketInstanceId,Li&&Li.box&&Dr?Dr:Mr,be.ID),Gt&&Ai&&this.collisionIndex.insertCollisionBox(Ai.box,L.get("icon-ignore-placement"),E.bucketInstanceId,Or,be.ID),Hi&&(Mt&&this.collisionIndex.insertCollisionCircles(Hi.circles,L.get("text-ignore-placement"),E.bucketInstanceId,Mr,be.ID),g)){const Yr=E.bucketInstanceId;let Vr=this.collisionCircleArrays[Yr];Vr===void 0&&(Vr=this.collisionCircleArrays[Yr]=new Nc);for(let gr=0;gr<Hi.circles.length;gr+=4)Vr.circles.push(Hi.circles[gr+0]),Vr.circles.push(Hi.circles[gr+1]),Vr.circles.push(Hi.circles[gr+2]),Vr.circles.push(Hi.collisionDetected?1:0)}const Pr=E.projection.name!=="globe";et=et&&(Pr||!Xt),pt=pt&&(Pr||!ki),this.placements[jt]=new Ua(Mt||et,Gt||pt,Et||E.justReloaded),c.add(jt)};if(it){const ht=E.getSortedSymbolIndexes(this.transform.angle);for(let Ct=ht.length-1;Ct>=0;--Ct){const yt=ht[Ct];Nt(E.symbolInstances.get(yt),yt,E.collisionArrays[yt])}}else for(let ht=n.symbolInstanceStart;ht<n.symbolInstanceEnd;ht++)Nt(E.symbolInstances.get(ht),ht,E.collisionArrays[ht]);if(g&&E.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[E.bucketInstanceId];s.invert(ht.invProjMatrix,D),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(n,c,g,b){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:F,crossTileID:W}=g,H=s.getAnchorJustification(c),Q=b===s.WritingMode.vertical?F:H==="left"?E:H==="center"?L:H==="right"?D:-1;E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=Q>=0&&E!==Q?0:W),L>=0&&(n.text.placedSymbolArray.get(L).crossTileID=Q>=0&&L!==Q?0:W),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=Q>=0&&D!==Q?0:W),F>=0&&(n.text.placedSymbolArray.get(F).crossTileID=Q>=0&&F!==Q?0:W)}markUsedOrientation(n,c,g){const b=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,E=c===s.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:W}=g,H=n.text.placedSymbolArray;L>=0&&(H.get(L).placedOrientation=b),D>=0&&(H.get(D).placedOrientation=b),F>=0&&(H.get(F).placedOrientation=b),W>=0&&(H.get(W).placedOrientation=E)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let g=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const b=c?c.symbolFadeChange(n):1,E=c?c.opacities:{},L=c?c.variableOffsets:{},D=c?c.placedOrientations:{};for(const F in this.placements){const W=this.placements[F],H=E[F];H?(this.opacities[F]=new bo(H,b,W.text,W.icon,null,W.clipped),g=g||W.text!==H.text.placed||W.icon!==H.icon.placed):(this.opacities[F]=new bo(null,b,W.text,W.icon,W.skipFade,W.clipped),g=g||W.text||W.icon)}for(const F in E){const W=E[F];if(!this.opacities[F]){const H=new bo(W,b,!1,!1);H.isHidden()||(this.opacities[F]=H,g=g||W.text.placed||W.icon.placed)}}for(const F in L)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=L[F]);for(const F in D)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=D[F]);g?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:n)}updateLayerOpacities(n,c){const g=new Set;for(const b of c){const E=b.getBucket(n);E&&b.latestFeatureIndex&&n.id===E.layerIds[0]&&this.updateBucketOpacities(E,g,b.collisionBoxArray)}}updateBucketOpacities(n,c,g){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const b=n.layers[0].layout,E=!!n.layers[0].dynamicFilter(),L=new bo(null,0,!1,!1,!0),D=b.get("text-allow-overlap"),F=b.get("icon-allow-overlap"),W=b.get("text-variable-anchor"),H=b.get("text-rotation-alignment")==="map",Q=b.get("text-pitch-alignment")==="map",he=b.get("icon-text-fit")!=="none",me=new bo(null,0,D&&(F||!n.hasIconData()||b.get("icon-optional")),F&&(D||!n.hasTextData()||b.get("text-optional")),!0);!n.collisionArrays&&g&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(g);const ye=(be,ee,pe)=>{for(let Ce=0;Ce<ee/4;Ce++)be.opacityVertexArray.emplaceBack(pe)};let _e=0;for(let be=0;be<n.symbolInstances.length;be++){const ee=n.symbolInstances.get(be),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:Ce,crossTileID:Ie,numIconVertices:Ge}=ee,Fe=c.has(Ie);let We=this.opacities[Ie];Fe?We=L:We||(We=me,this.opacities[Ie]=We),c.add(Ie);const it=pe>0||Ce>0,et=Ge>0,pt=this.placedOrientations[Ie],Nt=pt===s.WritingMode.vertical,ht=pt===s.WritingMode.horizontal||pt===s.WritingMode.horizontalOnly;if(!it&&!et||We.isHidden()||_e++,it){const Ct=zs(We.text);ye(n.text,pe,Nt?vn:Ct),ye(n.text,Ce,ht?vn:Ct);const yt=We.text.isHidden(),{leftJustifiedTextSymbolIndex:jt,centerJustifiedTextSymbolIndex:at,rightJustifiedTextSymbolIndex:Mt,verticalPlacedTextSymbolIndex:Gt}=ee,Et=n.text.placedSymbolArray,Xt=yt||Nt?1:0;jt>=0&&(Et.get(jt).hidden=Xt),at>=0&&(Et.get(at).hidden=Xt),Mt>=0&&(Et.get(Mt).hidden=Xt),Gt>=0&&(Et.get(Gt).hidden=yt||ht?1:0);const ki=this.variableOffsets[Ie];ki&&this.markUsedJustification(n,ki.anchor,ee,pt);const Ni=this.placedOrientations[Ie];Ni&&(this.markUsedJustification(n,"left",ee,Ni),this.markUsedOrientation(n,Ni,ee))}if(et){const Ct=zs(We.icon),{placedIconSymbolIndex:yt,verticalPlacedIconSymbolIndex:jt}=ee,at=n.icon.placedSymbolArray,Mt=We.icon.isHidden()?1:0;yt>=0&&(ye(n.icon,Ge,Nt?vn:Ct),at.get(yt).hidden=Mt),jt>=0&&(ye(n.icon,ee.numVerticalIconVertices,ht?vn:Ct),at.get(jt).hidden=Mt)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ct=n.collisionArrays[be];if(Ct){let yt=new s.Point(0,0),jt=!0;if(Ct.textBox||Ct.verticalTextBox){if(W){const Mt=this.variableOffsets[Ie];Mt?(yt=Hl(Mt.anchor,Mt.width,Mt.height,Mt.textOffset,Mt.textScale),H&&yt._rotate(Q?this.transform.angle:-this.transform.angle)):jt=!1}E&&(jt=!We.clipped),Ct.textBox&&pa(n.textCollisionBox.collisionVertexArray,We.text.placed,!jt||Nt,yt.x,yt.y),Ct.verticalTextBox&&pa(n.textCollisionBox.collisionVertexArray,We.text.placed,!jt||ht,yt.x,yt.y)}const at=jt&&!!(!ht&&Ct.verticalIconBox);Ct.iconBox&&pa(n.iconCollisionBox.collisionVertexArray,We.icon.placed,at,he?yt.x:0,he?yt.y:0),Ct.verticalIconBox&&pa(n.iconCollisionBox.collisionVertexArray,We.icon.placed,!at,he?yt.x:0,he?yt.y:0)}}}if(n.fullyClipped=_e===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const be=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=be.invProjMatrix,n.placementViewportMatrix=be.viewportMatrix,n.collisionCircleArray=be.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,c){const g=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*g>n}setStale(){this.stale=!0}}function pa(f,n,c,g,b){f.emplaceBack(n?1:0,c?1:0,g||0,b||0),f.emplaceBack(n?1:0,c?1:0,g||0,b||0),f.emplaceBack(n?1:0,c?1:0,g||0,b||0),f.emplaceBack(n?1:0,c?1:0,g||0,b||0)}const Os=Math.pow(2,25),An=Math.pow(2,24),od=Math.pow(2,17),Uc=Math.pow(2,16),Rs=Math.pow(2,9),Es=Math.pow(2,8),ad=Math.pow(2,1);function zs(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const n=f.placed?1:0,c=Math.floor(127*f.opacity);return c*Os+n*An+c*od+n*Uc+c*Rs+n*Es+c*ad+n}const vn=0;class ma{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,c,g,b,E){const L=this._bucketParts;for(;this._currentTileIndex<n.length;)if(c.getBucketParts(L,b,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((D,F)=>D.sortKey-F.sortKey));this._currentPartIndex<L.length;){const D=L[this._currentPartIndex];if(c.placeLayerBucketPart(D,this._seenCrossTileIDs,g,D.symbolInstanceStart===0),this._currentPartIndex++,E())return!0}return!1}}class Vc{constructor(n,c,g,b,E,L,D,F){this.placement=new Fh(n,E,L,D,F),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(n,c,g){const b=s.exported.now(),E=()=>{const L=s.exported.now()-b;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=c[n[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=D)&&(!L.maxzoom||L.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new ma(L)),this._inProgressLayer.continuePlacement(g[L.source],this.placement,this._showCollisionBoxes,L,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const ga=512/s.EXTENT/2;class ts{constructor(n,c,g){this.tileID=n,this.bucketInstanceId=g,this.index=new s.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=n.canonical.x*s.EXTENT,E=n.canonical.y*s.EXTENT;for(let L=0;L<c.length;L++){const{key:D,crossTileID:F,tileAnchorX:W,tileAnchorY:H}=c.get(L),Q=Math.floor((b+W)*ga),he=Math.floor((E+H)*ga);this.index.add(Q,he),this.keys.push(D),this.crossTileIDs.push(F)}this.index.finish()}findMatches(n,c,g){const b=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),E=ga/Math.pow(2,c.canonical.z-this.tileID.canonical.z),L=c.canonical.x*s.EXTENT,D=c.canonical.y*s.EXTENT;for(let F=0;F<n.length;F++){const W=n.get(F);if(W.crossTileID)continue;const{key:H,tileAnchorX:Q,tileAnchorY:he}=W,me=Math.floor((L+Q)*E),ye=Math.floor((D+he)*E),_e=this.index.range(me-b,ye-b,me+b,ye+b);for(const be of _e){const ee=this.crossTileIDs[be];if(this.keys[be]===H&&!g.has(ee)){g.add(ee),W.crossTileID=ee;break}}}}}class Nh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ld{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const c=Math.round((n-this.lng)/360);if(c!==0)for(const g in this.indexes){const b=this.indexes[g],E={};for(const L in b){const D=b[L];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+c),E[D.tileID.key]=D}this.indexes[g]=E}this.lng=n}addBucket(n,c,g){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let E=0;E<c.symbolInstances.length;E++)c.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const b=this.usedCrossTileIDs[n.overscaledZ];for(const E in this.indexes){const L=this.indexes[E];if(Number(E)>n.overscaledZ)for(const D in L){const F=L[D];F.tileID.isChildOf(n)&&F.findMatches(c.symbolInstances,n,b)}else{const D=L[n.scaledTo(Number(E)).key];D&&D.findMatches(c.symbolInstances,n,b)}}for(let E=0;E<c.symbolInstances.length;E++){const L=c.symbolInstances.get(E);L.crossTileID||(L.crossTileID=g.generate(),b.add(L.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new ts(n,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(n,c){for(const g of c.crossTileIDs)this.usedCrossTileIDs[n].delete(g)}removeStaleBuckets(n){let c=!1;for(const g in this.indexes){const b=this.indexes[g];for(const E in b)n[b[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,b[E]),delete b[E],c=!0)}return c}}class _a{constructor(){this.layerIndexes={},this.crossTileIDs=new Nh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,c,g,b){let E=this.layerIndexes[n.id];E===void 0&&(E=this.layerIndexes[n.id]=new ld);let L=!1;const D={};b.name!=="globe"&&E.handleWrapJump(g);for(const F of c){const W=F.getBucket(n);W&&n.id===W.layerIds[0]&&(W.bucketInstanceId||(W.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(F.tileID,W,this.crossTileIDs)&&(L=!0),D[W.bucketInstanceId]=!0)}return E.removeStaleBuckets(D)&&(L=!0),L}pruneUnusedLayers(n){const c={};n.forEach(g=>{c[g]=!0});for(const g in this.layerIndexes)c[g]||delete this.layerIndexes[g]}}const ya=(f,n)=>s.emitValidationErrors(f,n&&n.filter(c=>c.identifier!=="source.canvas")),ql=s.pick(Tr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Xl=s.pick(Tr,["setCenter","setZoom","setBearing","setPitch"]),wo={version:8,layers:[],sources:{}},xa={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ho extends s.Evented{constructor(n,c={}){super(),this.map=n,this.dispatcher=new ir(Cn(),this),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(n._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new _a,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const g=this;this._rtlTextPluginCallback=Ho.registerForPluginStateChange(b=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(E,L)=>{if(s.triggerPluginCompletionEvent(E),L&&L.every(D=>D))for(const D in g._sourceCaches){const F=g._sourceCaches[D],W=F.getSource().type;W!=="vector"&&W!=="geojson"||F.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const E=this.getSource(b.sourceId);if(E&&E.vectorLayerIds)for(const L in this._layers){const D=this._layers[L];D.source===E.id&&this._validateLayer(D)}})}loadURL(n,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const g=typeof c.validate=="boolean"?c.validate:!s.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,c.accessToken);const b=this.map._requestManager.transformRequest(n,s.ResourceType.Style);this._request=s.getJSON(b,(E,L)=>{this._request=null,E?this.fire(new s.ErrorEvent(E)):L&&this._load(L,g)})}loadJSON(n,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(n,c.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(wo,!1)}_updateLayerCount(n,c){const g=c?1:-1;n.is3D()&&(this._num3DLayers+=g),n.type==="circle"&&(this._numCircleLayers+=g),n.type==="symbol"&&(this._numSymbolLayers+=g)}_load(n,c){if(c&&ya(this,s.validateStyle(n)))return;this._loaded=!0,this.stylesheet=s.clone$1(n),this._updateMapProjection();for(const b in n.sources)this.addSource(b,n.sources[b],{validate:!1});this._changed=!1,n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(n.glyphs);const g=Nf(this.stylesheet.layers);this._order=g.map(b=>b.id),this._layers={},this._serializedLayers={};for(const b of g){const E=s.createStyleLayer(b);E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new kt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(n){this._spriteRequest=function(c,g,b){let E,L,D;const F=s.exported.devicePixelRatio>1?"@2x":"";let W=s.getJSON(g.transformRequest(g.normalizeSpriteURL(c,F,".json"),s.ResourceType.SpriteJSON),(he,me)=>{W=null,D||(D=he,E=me,Q())}),H=s.getImage(g.transformRequest(g.normalizeSpriteURL(c,F,".png"),s.ResourceType.SpriteImage),(he,me)=>{H=null,D||(D=he,L=me,Q())});function Q(){if(D)b(D);else if(E&&L){const he=s.exported.getImageData(L),me={};for(const ye in E){const{width:_e,height:be,x:ee,y:pe,sdf:Ce,pixelRatio:Ie,stretchX:Ge,stretchY:Fe,content:We}=E[ye],it=new s.RGBAImage({width:_e,height:be});s.RGBAImage.copy(he,it,{x:ee,y:pe},{x:0,y:0},{width:_e,height:be}),me[ye]={data:it,pixelRatio:Ie,sdf:Ce,stretchX:Ge,stretchY:Fe,content:We}}b(null,me)}}return{cancel(){W&&(W.cancel(),W=null),H&&(H.cancel(),H=null)}}}(n,this.map._requestManager,(c,g)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(g)for(const b in g)this.imageManager.addImage(b,g[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(n){const c=this.getSource(n.source);if(!c)return;const g=n.sourceLayer;g&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${c.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const c=[];for(const g of n){const b=this._layers[g];b.type!=="custom"&&c.push(b.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(n){return!!this.terrain&&(typeof n.isLayerDraped=="function"?n.isLayerDraped():xa[n.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(n){if(!this._loaded)return;const c=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(b.length||E.length)&&this._updateWorkerLayers(b,E);for(const L in this._updatedSources){const D=this._updatedSources[L];D==="reload"?this._reloadSource(L):D==="clear"&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(n);this.light.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._resetUpdates()}const g={};for(const b in this._sourceCaches){const E=this._sourceCaches[b];g[b]=E.used,E.used=!1}for(const b of this._order){const E=this._layers[b];if(E.recalculate(n,this._availableImages),!E.isHidden(n.zoom)){const D=this._getLayerSourceCache(E);D&&(D.used=!0)}const L=this.map.painter;if(L){const D=E.getProgramIds();if(!D)continue;const F=E.getProgramConfiguration(n.zoom);for(const W of D)L.useProgram(W,F)}}for(const b in g){const E=this._sourceCaches[b];g[b]!==E.used&&E.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),ya(this,s.validateStyle(n)))return!1;(n=s.clone$1(n)).layers=Nf(n.layers);const c=function(b,E){if(!b)return[{command:Tr.setStyle,args:[E]}];let L=[];try{if(!$(b.version,E.version))return[{command:Tr.setStyle,args:[E]}];$(b.center,E.center)||L.push({command:Tr.setCenter,args:[E.center]}),$(b.zoom,E.zoom)||L.push({command:Tr.setZoom,args:[E.zoom]}),$(b.bearing,E.bearing)||L.push({command:Tr.setBearing,args:[E.bearing]}),$(b.pitch,E.pitch)||L.push({command:Tr.setPitch,args:[E.pitch]}),$(b.sprite,E.sprite)||L.push({command:Tr.setSprite,args:[E.sprite]}),$(b.glyphs,E.glyphs)||L.push({command:Tr.setGlyphs,args:[E.glyphs]}),$(b.transition,E.transition)||L.push({command:Tr.setTransition,args:[E.transition]}),$(b.light,E.light)||L.push({command:Tr.setLight,args:[E.light]}),$(b.fog,E.fog)||L.push({command:Tr.setFog,args:[E.fog]}),$(b.projection,E.projection)||L.push({command:Tr.setProjection,args:[E.projection]});const D={},F=[];(function(Q,he,me,ye){let _e;for(_e in he=he||{},Q=Q||{})Q.hasOwnProperty(_e)&&(he.hasOwnProperty(_e)||Bc(_e,me,ye));for(_e in he){if(!he.hasOwnProperty(_e))continue;const be=he[_e];Q.hasOwnProperty(_e)?$(Q[_e],be)||(Q[_e].type==="geojson"&&be.type==="geojson"&&zh(Q,he,_e)?me.push({command:Tr.setGeoJSONSourceData,args:[_e,be.data]}):Rh(_e,he,me,ye)):id(_e,he,me)}})(b.sources,E.sources,F,D);const W=[];b.layers&&b.layers.forEach(Q=>{Q.source&&D[Q.source]?L.push({command:Tr.removeLayer,args:[Q.id]}):W.push(Q)});let H=b.terrain;H&&D[H.source]&&(L.push({command:Tr.setTerrain,args:[void 0]}),H=void 0),L=L.concat(F),$(H,E.terrain)||L.push({command:Tr.setTerrain,args:[E.terrain]}),function(Q,he,me){he=he||[];const ye=(Q=Q||[]).map(Vo),_e=he.map(Vo),be=Q.reduce(rd,{}),ee=he.reduce(rd,{}),pe=ye.slice(),Ce=Object.create(null);let Ie,Ge,Fe,We,it,et,pt;for(Ie=0,Ge=0;Ie<ye.length;Ie++)Fe=ye[Ie],ee.hasOwnProperty(Fe)?Ge++:(me.push({command:Tr.removeLayer,args:[Fe]}),pe.splice(pe.indexOf(Fe,Ge),1));for(Ie=0,Ge=0;Ie<_e.length;Ie++)Fe=_e[_e.length-1-Ie],pe[pe.length-1-Ie]!==Fe&&(be.hasOwnProperty(Fe)?(me.push({command:Tr.removeLayer,args:[Fe]}),pe.splice(pe.lastIndexOf(Fe,pe.length-Ge),1)):Ge++,et=pe[pe.length-Ie],me.push({command:Tr.addLayer,args:[ee[Fe],et]}),pe.splice(pe.length-Ie,0,Fe),Ce[Fe]=!0);for(Ie=0;Ie<_e.length;Ie++)if(Fe=_e[Ie],We=be[Fe],it=ee[Fe],!Ce[Fe]&&!$(We,it))if($(We.source,it.source)&&$(We["source-layer"],it["source-layer"])&&$(We.type,it.type)){for(pt in xo(We.layout,it.layout,me,Fe,null,Tr.setLayoutProperty),xo(We.paint,it.paint,me,Fe,null,Tr.setPaintProperty),$(We.filter,it.filter)||me.push({command:Tr.setFilter,args:[Fe,it.filter]}),$(We.minzoom,it.minzoom)&&$(We.maxzoom,it.maxzoom)||me.push({command:Tr.setLayerZoomRange,args:[Fe,it.minzoom,it.maxzoom]}),We)We.hasOwnProperty(pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&(pt.indexOf("paint.")===0?xo(We[pt],it[pt],me,Fe,pt.slice(6),Tr.setPaintProperty):$(We[pt],it[pt])||me.push({command:Tr.setLayerProperty,args:[Fe,pt,it[pt]]}));for(pt in it)it.hasOwnProperty(pt)&&!We.hasOwnProperty(pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&(pt.indexOf("paint.")===0?xo(We[pt],it[pt],me,Fe,pt.slice(6),Tr.setPaintProperty):$(We[pt],it[pt])||me.push({command:Tr.setLayerProperty,args:[Fe,pt,it[pt]]}))}else me.push({command:Tr.removeLayer,args:[Fe]}),et=pe[pe.lastIndexOf(Fe)+1],me.push({command:Tr.addLayer,args:[it,et]})}(W,E.layers,L)}catch(D){console.warn("Unable to compute style diff:",D),L=[{command:Tr.setStyle,args:[E]}]}return L}(this.serialize(),n).filter(b=>!(b.command in Xl));if(c.length===0)return!1;const g=c.filter(b=>!(b.command in ql));if(g.length>0)throw new Error(`Unimplemented: ${g.map(b=>b.command).join(", ")}.`);return c.forEach(b=>{b.command!=="setTransition"&&b.command!=="setProjection"&&this[b.command].apply(this,b.args)}),this.stylesheet=n,this._updateMapProjection(),!0}addImage(n,c){return this.getImage(n)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,c),this._afterImageUpdated(n),this)}updateImage(n,c){this.imageManager.updateImage(n,c)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n),this._afterImageUpdated(n),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(n,c,g={}){if(this._checkLoaded(),this.getSource(n)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateSource,`sources.${n}`,c,null,g))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const b=ar(n,c,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(n),source:b.serialize(),sourceId:n}));const E=L=>{const D=(L?"symbol:":"other:")+n,F=this._sourceCaches[D]=new s.SourceCache(D,b,L);(L?this._symbolSourceCaches:this._otherSourceCaches)[n]=F,F.style=this,F.onAdd(this.map)};E(!1),c.type!=="vector"&&c.type!=="geojson"||E(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(n){this._checkLoaded();const c=this.getSource(n);if(!c)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===n)return this.fire(new s.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===n)return this.fire(new s.ErrorEvent(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(n);for(const b of g)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(n,c){this._checkLoaded(),this.getSource(n).setData(c),this._changed=!0}getSource(n){const c=this._getSourceCache(n);return c&&c.getSource()}_getSources(){const n=[];for(const c in this._otherSourceCaches){const g=this._getSourceCache(c);g&&n.push(g.getSource())}return n}addLayer(n,c,g={}){this._checkLoaded();const b=n.id;if(this.getLayer(b))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let E;if(n.type==="custom"){if(ya(this,s.validateCustomStyleLayer(n)))return;E=s.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(b,n.source),n=s.clone$1(n),n=s.extend(n,{source:b})),this._validate(s.validateLayer,`layers.${b}`,n,{arrayIndex:-1},g))return;E=s.createStyleLayer(n),this._validateLayer(E),E.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const L=c?this._order.indexOf(c):this._order.length;if(c&&L===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(L,0,b),this._layerOrderChanged=!0,this._layers[b]=E;const D=this._getLayerSourceCache(E);if(this._removedLayers[b]&&E.source&&D&&E.type!=="custom"){const F=this._removedLayers[b];delete this._removedLayers[b],F.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",D.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(n,c){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===c)return;const g=this._order.indexOf(n);this._order.splice(g,1);const b=c?this._order.indexOf(c):this._order.length;c&&b===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(b,0,n),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(n){this._checkLoaded();const c=this._layers[n];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const g=this._order.indexOf(n);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=c,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}hasLayerType(n){for(const c in this._layers)if(this._layers[c].type===n)return!0;return!1}setLayerZoomRange(n,c,g){this._checkLoaded();const b=this.getLayer(n);b?b.minzoom===c&&b.maxzoom===g||(c!=null&&(b.minzoom=c),g!=null&&(b.maxzoom=g),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,c,g={}){this._checkLoaded();const b=this.getLayer(n);if(b){if(!$(b.filter,c))return c==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(s.validateFilter,`layers.${b.id}.filter`,c,{layerType:b.type},g)||(b.filter=s.clone$1(c),this._updateLayer(b)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(n){const c=this.getLayer(n);return c&&s.clone$1(c.filter)}setLayoutProperty(n,c,g,b={}){this._checkLoaded();const E=this.getLayer(n);E?$(E.getLayoutProperty(c),g)||(E.setLayoutProperty(c,g,b),this._updateLayer(E)):this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(n,c){const g=this.getLayer(n);if(g)return g.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style.`)))}setPaintProperty(n,c,g,b={}){this._checkLoaded();const E=this.getLayer(n);E?$(E.getPaintProperty(c),g)||(E.setPaintProperty(c,g,b)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(n,c){const g=this.getLayer(n);return g&&g.getPaintProperty(c)}setFeatureState(n,c){this._checkLoaded();const g=n.source,b=n.sourceLayer,E=this.getSource(g);if(!E)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const L=E.type;if(L==="geojson"&&b)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(L==="vector"&&!b)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const D=this._getSourceCaches(g);for(const F of D)F.setFeatureState(b,n.id,c)}removeFeatureState(n,c){this._checkLoaded();const g=n.source,b=this.getSource(g);if(!b)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const E=b.type,L=E==="vector"?n.sourceLayer:void 0;if(E==="vector"&&!L)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const D=this._getSourceCaches(g);for(const F of D)F.removeFeatureState(L,n.id,c)}getFeatureState(n){this._checkLoaded();const c=n.source,g=n.sourceLayer,b=this.getSource(c);if(b){if(b.type!=="vector"||g)return n.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(g,n.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n={};for(const c in this._sourceCaches){const g=this._sourceCaches[c].getSource();n[g.id]||(n[g.id]=g.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:n,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0;const c=this._getLayerSourceCache(n);n.source&&!this._updatedSources[n.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",c.pause()),this._changed=!0,n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const c=L=>this._layers[L].type==="fill-extrusion",g={},b=[];for(let L=this._order.length-1;L>=0;L--){const D=this._order[L];if(c(D)){g[D]=L;for(const F of n){const W=F[D];if(W)for(const H of W)b.push(H)}}}b.sort((L,D)=>D.intersectionZ-L.intersectionZ);const E=[];for(let L=this._order.length-1;L>=0;L--){const D=this._order[L];if(c(D))for(let F=b.length-1;F>=0;F--){const W=b[F].feature;if(g[W.layer.id]<L)break;E.push(W),b.pop()}else for(const F of n){const W=F[D];if(W)for(const H of W)E.push(H.feature)}}return E}queryRenderedFeatures(n,c,g){c&&c.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const b={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of c.layers){const W=this._layers[F];if(!W)return this.fire(new s.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];b[W.source]=!0}}const E=[];c.availableImages=this._availableImages;const L=c&&c.layers?c.layers.some(F=>{const W=this.getLayer(F);return W&&W.is3D()}):this.has3DLayers(),D=nn.createFromScreenPoints(n,g);for(const F in this._sourceCaches){const W=this._sourceCaches[F].getSource().id;c.layers&&!b[W]||E.push(dn(this._sourceCaches[F],this._layers,this._serializedLayers,D,c,g,L,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(F,W,H,Q,he,me,ye){const _e={},be=me.queryRenderedSymbols(Q),ee=[];for(const pe of Object.keys(be).map(Number))ee.push(ye[pe]);ee.sort(as);for(const pe of ee){const Ce=pe.featureIndex.lookupSymbolFeatures(be[pe.bucketInstanceId],W,pe.bucketIndex,pe.sourceLayerIndex,he.filter,he.layers,he.availableImages,F);for(const Ie in Ce){const Ge=_e[Ie]=_e[Ie]||[],Fe=Ce[Ie];Fe.sort((We,it)=>{const et=pe.featureSortOrder;if(et){const pt=et.indexOf(We.featureIndex);return et.indexOf(it.featureIndex)-pt}return it.featureIndex-We.featureIndex});for(const We of Fe)Ge.push(We)}}for(const pe in _e)_e[pe].forEach(Ce=>{const Ie=Ce.feature,Ge=H(F[pe]);if(!Ge)return;const Fe=Ge.getFeatureState(Ie.layer["source-layer"],Ie.id);Ie.source=Ie.layer.source,Ie.layer["source-layer"]&&(Ie.sourceLayer=Ie.layer["source-layer"]),Ie.state=Fe});return _e}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),D.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(n,c){c&&c.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const g=this._getSourceCaches(n);let b=[];for(const E of g)b=b.concat(xn(E,c));return b}addSourceType(n,c,g){return Ho.getSourceType(n)?g(new Error(`A source type called "${n}" already exists.`)):(Ho.setSourceType(n,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:c.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(n,c={}){this._checkLoaded();const g=this.light.getLight();let b=!1;for(const L in n)if(!$(n[L],g[L])){b=!0;break}if(!b)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(n,c),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n,c=1){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let g=n;if(c===1){if(typeof g.source=="object"){const b="terrain-dem-src";this.addSource(b,g.source),g=s.clone$1(g),g=s.extend(g,{source:b})}if(this._validate(s.validateTerrain,"terrain",g))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,c)}else{const b=this.terrain,E=b.get();for(const L of Object.keys(s.spec.terrain))!g.hasOwnProperty(L)&&s.spec.terrain[L].default&&(g[L]=s.spec.terrain[L].default);for(const L in g)if(!$(g[L],E[L])){b.set(g),this.stylesheet.terrain=g;const D=this._setTransitionParameters({duration:0});b.updateTransitions(D);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const c=this.fog=new Lr(n,this.map.transform);this.stylesheet.fog=n;const g=this._setTransitionParameters({duration:0});c.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,g=c.get();Object.keys(n).length===0&&c.set(n);for(const b in n)if(!$(n[b],g[b])){c.set(n),this.stylesheet.fog=n;const E=this._setTransitionParameters({duration:0});c.updateTransitions(E);break}}else this._createFog(n);this._markersNeedUpdate=!0}_setTransitionParameters(n){return{now:s.exported.now(),transition:s.extend(n,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const n=this._order.filter(g=>this.isLayerDraped(this._layers[g])),c=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...c)}_createTerrain(n,c){const g=this.terrain=new vt(n,c);this.stylesheet.terrain=n,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const b=this._setTransitionParameters({duration:0});g.updateTransitions(b)}_force3DLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="symbol"&&this._updateLayer(c)}}_validate(n,c,g,b,E={}){return(!E||E.validate!==!1)&&ya(this,n.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:g,styleSpec:s.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){const c=this._getSourceCaches(n);for(const g of c)g.clearTiles()}_reloadSource(n){const c=this._getSourceCaches(n);for(const g of c)g.resume(),g.reload()}_reloadSources(){for(const n of this._getSources())n.reload&&n.reload()}_updateSources(n){for(const c in this._sourceCaches)this._sourceCaches[c].update(n)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const c=this._sourceCaches[n];c.resume(),c.reload()}}_updatePlacement(n,c,g,b,E=!1){let L=!1,D=!1;const F={};for(const W of this._order){const H=this._layers[W];if(H.type!=="symbol")continue;if(!F[H.source]){const he=this._getLayerSourceCache(H);if(!he)continue;F[H.source]=he.getRenderableIds(!0).map(me=>he.getTileByID(me)).sort((me,ye)=>ye.tileID.overscaledZ-me.tileID.overscaledZ||(me.tileID.isLessThan(ye.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(H,F[H.source],n.center.lng,n.projection);L=L||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),n.zoom))&&(this.pauseablePlacement=new Vc(n,this._order,E,c,g,b,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),D=!0),L&&this.pauseablePlacement.placement.setStale()),D||L)for(const W of this._order){const H=this._layers[W];H.type==="symbol"&&this.placement.updateLayerOpacities(H,F[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,c,g){this.imageManager.getImages(c.icons,g),this._updateTilesForChangedImages();const b=E=>{E&&E.setDependencies(c.tileID.key,c.type,c.icons)};b(this._otherSourceCaches[c.source]),b(this._symbolSourceCaches[c.source])}getGlyphs(n,c,g){this.glyphManager.getGlyphs(c.stacks,g)}getResource(n,c,g){return s.makeRequest(c,g)}_getSourceCache(n){return this._otherSourceCaches[n]}_getLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}_getSourceCaches(n){const c=[];return this._otherSourceCaches[n]&&c.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&c.push(this._symbolSourceCaches[n]),c}_isSourceCacheLoaded(n){const c=this._getSourceCaches(n);return c.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${n}'`))),!1):c.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ho.getSourceType=function(f){return Gi[f]},Ho.setSourceType=function(f,n){Gi[f]=n},Ho.registerForPluginStateChange=s.registerForPluginStateChange;var cd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,ll="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",qo=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,bn=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,is=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let jc={},Zl={};const Yl=[];Qs(cd,Yl),Qs(qo,Yl),Qs(bn,Yl),Qs(is,Yl),jc=wr("",qo),Zl=wr(is,bn);const Kl=wr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Uh=cd,Jl=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Vh={background:wr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:wr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:wr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:wr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:wr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:wr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:wr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:wr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:wr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:wr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:wr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:wr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:wr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:wr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:wr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:wr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:wr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:wr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:wr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:wr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:wr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:wr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:wr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:wr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:wr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:wr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ll),skyboxGradient:wr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ll),skyboxCapture:wr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:wr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:wr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Qs(f,n){const c=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of c)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=g.split(" ");for(const E of b)n.includes(E)||n.push(E)}}function wr(f,n){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=n.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),b={},E=[...Yl];return Qs(f,E),Qs(n,E),{fragmentSource:f=f.replace(c,(L,D,F,W,H)=>(b[H]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${F} ${W} ${H};
#else
uniform ${F} ${W} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${F} ${W} ${H} = u_${H};
#endif
`)),vertexSource:n=n.replace(c,(L,D,F,W,H)=>{const Q=W==="float"?"vec2":"vec4",he=H.match(/color/)?"color":Q;return b[H]?D==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${F} ${Q} a_${H};
varying ${F} ${W} ${H};
#else
uniform ${F} ${W} u_${H};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${F} ${W} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${he}(a_${H}, u_${H}_t);
#else
    ${F} ${W} ${H} = u_${H};
#endif
`:D==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${F} ${Q} a_${H};
#else
uniform ${F} ${W} u_${H};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${F} ${W} ${H} = a_${H};
#else
    ${F} ${W} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${F} ${W} ${H} = unpack_mix_${he}(a_${H}, u_${H}_t);
#else
    ${F} ${W} ${H} = u_${H};
#endif
`}),staticAttributes:g,usedDefines:E}}class wm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,c,g,b,E,L,D){this.context=n;let F=this.boundPaintVertexBuffers.length!==b.length;for(let H=0;!F&&H<b.length;H++)this.boundPaintVertexBuffers[H]!==b[H]&&(F=!0);let W=this.boundDynamicVertexBuffers.length!==D.length;for(let H=0;!W&&H<D.length;H++)this.boundDynamicVertexBuffers[H]!==D[H]&&(W=!0);if(!n.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==g||F||W||this.boundIndexBuffer!==E||this.boundVertexOffset!==L)this.freshBind(c,g,b,E,L,D);else{n.bindVertexArrayOES.set(this.vao);for(const H of D)H&&H.bind();E&&E.dynamicDraw&&E.bind()}}freshBind(n,c,g,b,E,L){let D;const F=n.numAttributes,W=this.context,H=W.gl;if(W.extVertexArrayObject)this.vao&&this.destroy(),this.vao=W.extVertexArrayObject.createVertexArrayOES(),W.bindVertexArrayOES.set(this.vao),D=0,this.boundProgram=n,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=b,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=L;else{D=W.currentNumAttributes||0;for(let Q=F;Q<D;Q++)H.disableVertexAttribArray(Q)}c.enableAttributes(H,n),c.bind(),c.setVertexAttribPointers(H,n,E);for(const Q of g)Q.enableAttributes(H,n),Q.bind(),Q.setVertexAttribPointers(H,n,E);for(const Q of L)Q&&(Q.enableAttributes(H,n),Q.bind(),Q.setVertexAttribPointers(H,n,E));b&&b.bind(),W.currentNumAttributes=F}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function cl(f,n){const c=Math.pow(2,n.canonical.z),g=n.canonical.y;return[new s.MercatorCoordinate(0,g/c).toLngLat().lat,new s.MercatorCoordinate(0,(g+1)/c).toLngLat().lat]}function hd(f,n,c,g,b,E,L){const D=f.context,F=D.gl,W=c.fbo;if(!W)return;f.prepareDrawTile();const H=f.useProgram("hillshade");D.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,W.colorAttachment.get());const Q=((_e,be,ee,pe)=>{const Ce=ee.paint.get("hillshade-shadow-color"),Ie=ee.paint.get("hillshade-highlight-color"),Ge=ee.paint.get("hillshade-accent-color");let Fe=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(Fe-=_e.transform.angle);const We=!_e.options.moving;return{u_matrix:pe||_e.transform.calculateProjMatrix(be.tileID.toUnwrapped(),We),u_image:0,u_latrange:cl(0,be.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),Fe],u_shadow:Ce,u_highlight:Ie,u_accent:Ge}})(f,c,g,f.terrain?n.projMatrix:null);f.prepareDrawProgram(D,H,n.toUnwrapped());const{tileBoundsBuffer:he,tileBoundsIndexBuffer:me,tileBoundsSegments:ye}=f.getTileBoundsBuffers(c);H.draw(D,F.TRIANGLES,b,E,L,s.CullFaceMode.disabled,Q,g.id,he,me,ye)}function jh(f,n,c){if(!n.needsDEMTextureUpload)return;const g=f.context,b=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||f.getTileTexture(c.stride);const E=c.getPixels();n.demTexture?n.demTexture.update(E,{premultiply:!1}):n.demTexture=new s.Texture(g,E,b.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function $h(f,n,c,g,b,E){const L=f.context,D=L.gl;if(!n.dem)return;const F=n.dem;if(L.activeTexture.set(D.TEXTURE1),jh(f,n,F),!n.demTexture)return;n.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE);const W=F.dim;L.activeTexture.set(D.TEXTURE0);let H=n.fbo;if(!H){const ye=new s.Texture(L,{width:W,height:W,data:null},D.RGBA);ye.bind(D.LINEAR,D.CLAMP_TO_EDGE),H=n.fbo=L.createFramebuffer(W,W,!0),H.colorAttachment.set(ye.texture)}L.bindFramebuffer.set(H.framebuffer),L.viewport.set([0,0,W,W]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:he,tileBoundsSegments:me}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(L,D.TRIANGLES,g,b,E,s.CullFaceMode.disabled,((ye,_e)=>{const be=_e.stride,ee=s.create();return s.ortho(ee,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ee,ee,[0,-s.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[be,be],u_zoom:ye.overscaledZ,u_unpack:_e.unpackVector}})(n.tileID,F),c.id,Q,he,me),n.needsHillshadePrepare=!1}const Gh=f=>({u_matrix:new s.UniformMatrix4f(f),u_image0:new s.Uniform1i(f),u_skirt_height:new s.Uniform1f(f)}),Va=(f,n)=>({u_matrix:f,u_image0:0,u_skirt_height:n}),Wh=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:c,u_zoom_transition:b,u_merc_center:E,u_image0:0,u_frustum_tl:L,u_frustum_tr:D,u_frustum_br:F,u_frustum_bl:W,u_globe_pos:H,u_globe_radius:Q,u_viewport:he,u_grid_matrix:ye?Float32Array.from(ye):new Float32Array(9),u_skirt_height:me});function hl(f,n){return f!=null&&n!=null&&!(!f.hasData()||!n.hasData())&&f.demTexture!=null&&n.demTexture!=null&&f.tileID.key!==n.tileID.key}const To=new class{constructor(){this.operations={}}newMorphing(f,n,c,g,b){if(f in this.operations){const E=this.operations[f];E.to.tileID.key!==c.tileID.key&&(E.queued=c)}else this.operations[f]={startTime:g,phase:0,duration:b,from:n,to:c,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const n=this.operations[f];return{from:n.from,to:n.to,phase:n.phase}}update(f){for(const n in this.operations){const c=this.operations[n];for(c.phase=(f-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,f)){delete this.operations[n];break}}}_nextOp(f,n){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=n,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},ul={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Hh(f){return 6*Math.pow(1.5,22-f)}function $f(f,n){const c=1<<f.z;return!n&&(f.x===0||f.x===c-1)||f.y===0||f.y===c-1}const $c=f=>({u_matrix:f});function ud(f,n,c,g,b){if(b>0){const E=s.exported.now(),L=(E-f.timeAdded)/b,D=n?(E-n.timeAdded)/b:-1,F=c.getSource(),W=g.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),H=!n||Math.abs(n.tileID.overscaledZ-W)>Math.abs(f.tileID.overscaledZ-W),Q=H&&f.refreshedUponExpiration?1:s.clamp(H?L:1-D,0,1);return f.refreshedUponExpiration&&L>=1&&(f.refreshedUponExpiration=!1),n?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class Gc extends s.SourceCache{constructor(n){const c={type:"raster-dem",maxzoom:n.transform.maxZoom},g=new ir(Cn(),null),b=ar("mock-dem",c,g,n.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,c){n.state="loaded",c(null)}}class qh extends s.SourceCache{constructor(n){const c=ar("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new ir(Cn(),null),n.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,c,g){if(n.freezeTileCoverage)return;this.transform=n;const b=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,L)=>{if(E[L.key]="",!this._tiles[L.key]){const D=new s.Tile(L,this._source.tileSize*L.overscaleFactor(),n.tileZoom);D.state="loaded",this._tiles[L.key]=D}return E},{});for(const E in this._tiles)E in b||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(n){const c=this.proxyCachedFBO[n];if(c!==void 0){const g=Object.values(c);this.renderCachePool.push(...g),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Xh extends s.OverscaledTileID{constructor(n,c,g){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=c,this.projMatrix=g}}class dd extends s.Elevation{constructor(n,c){super(),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,b,E]=function(F){const W=new s.StructArrayLayout2i4,H=new s.StructArrayLayout3ui6,Q=131;W.reserve(17161),H.reserve(33800);const he=s.EXTENT/128,me=s.EXTENT+he/2,ye=me+he;for(let be=-he;be<ye;be+=he)for(let ee=-he;ee<ye;ee+=he){const pe=ee<0||ee>me||be<0||be>me?24575:0,Ce=s.clamp(Math.round(ee),0,s.EXTENT),Ie=s.clamp(Math.round(be),0,s.EXTENT);W.emplaceBack(Ce+pe,Ie)}const _e=(be,ee)=>{const pe=ee*Q+be;H.emplaceBack(pe+1,pe,pe+Q),H.emplaceBack(pe+Q,pe+Q+1,pe+1)};for(let be=1;be<129;be++)for(let ee=1;ee<129;ee++)_e(ee,be);return[0,129].forEach(be=>{for(let ee=0;ee<130;ee++)_e(ee,be),_e(be,ee)}),[W,H,32768]}(),L=n.context;this.gridBuffer=L.createVertexBuffer(g,s.posAttributes.members),this.gridIndexBuffer=L.createIndexBuffer(b),this.gridSegments=s.SegmentVector.simpleSegment(0,0,g.length,b.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,g.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new qh(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const D=L.gl;this._overlapStencilMode=new s.StencilMode({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Gc(c.map)}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),n.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=n,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,c,g){if(n&&n.terrain){this._style!==n&&(this.style=n),this.enabled=!0;const b=n.terrain.properties;this.sourceCache=n.terrain.drapeRenderMode===0?this._mockSourceCache:n._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const E=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const L=this.getScaledDemTileSize();this.sourceCache.update(c,L,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),c.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const n=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||n.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${n.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${n.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._sourceCaches)this._style._sourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=c.getIds().map(F=>{const W=c.getTileByID(F).tileID;return W.projMatrix=g.calculateProjMatrix(W.toUnwrapped()),W});(function(F,W){const H=W.transform.pointCoordinate(W.transform.getCameraPoint()),Q=new s.Point(H.x,H.y);F.sort((he,me)=>{if(me.overscaledZ-he.overscaledZ)return me.overscaledZ-he.overscaledZ;const ye=new s.Point(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),_e=new s.Point(me.canonical.x+(1<<me.canonical.z)*me.wrap,me.canonical.y),be=Q.mult(1<<he.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ye)-be.distSqr(_e)})})(b,this.painter),this._previousZoom=g.zoom;const E=this.proxyToSource||{};this.proxyToSource={},b.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const L=this._style._sourceCaches;for(const F in L){const W=L[F];if(!W.used||(W!==this.sourceCache&&this.resetTileLookupCache(W.id),this._setupProxiedCoordsForOrtho(W,n[F],E),W.usedForTerrain))continue;const H=n[F];W.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[c.id]=b.map(F=>new Xh(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const D={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const W=this.terrainTileForTile[F.key];if(!W)continue;const H=W.tileID.key;H in D||(this._visibleDemTiles.push(W),D[H]=H)}}_assignTerrainTiles(n){this._initializing||n.forEach(c=>{if(this.terrainTileForTile[c.key])return;const g=this._findTileCoveringTileID(c,this.sourceCache);g&&(this.terrainTileForTile[c.key]=g)})}_prepareDEMTextures(){const n=this.painter.context,c=n.gl;for(const g in this.terrainTileForTile){const b=this.terrainTileForTile[g],E=b.dem;!E||b.demTexture&&!b.needsDEMTextureUpload||(n.activeTexture.set(c.TEXTURE1),jh(this.painter,b,E))}}_prepareDemTileUniforms(n,c,g,b){if(!c||c.demTexture==null)return!1;const E=n.tileID.canonical,L=Math.pow(2,c.tileID.canonical.z-E.z),D=b||"";return g[`u_dem_tl${D}`]=[E.x*L%1,E.y*L%1],g[`u_dem_scale${D}`]=L,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const n=this.painter.context,c=n.gl;if(!this._emptyDepthBufferTexture){const g=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(n,g,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let n=0;const c=this._visibleDemTiles.reduce((g,b)=>{if(!b.dem)return g;const E=b.dem.tree.minimums[0];return E>0&&n++,g+E},0);return n?c/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,c=n.gl;n.activeTexture.set(c.TEXTURE2);const g=this._getLoadedAreaMinimum(),b=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(b,{premultiply:!1}):E=this._emptyDEMTexture=new s.Texture(n,b,c.RGBA,{premultiply:!1}),E}setupElevationDraw(n,c,g){const b=this.painter.context,E=b.gl,L=(D=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(D),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var D;L.u_dem_size=this.sourceCache.getSource().tileSize,L.u_exaggeration=this.exaggeration();let F=null,W=null,H=1;if(g&&g.morphing&&this._useVertexMorphing){const Q=g.morphing.srcDemTile,he=g.morphing.dstDemTile;H=g.morphing.phase,Q&&he&&(this._prepareDemTileUniforms(n,Q,L,"_prev")&&(W=Q),this._prepareDemTileUniforms(n,he,L)&&(F=he))}if(W&&F?(b.activeTexture.set(E.TEXTURE2),F.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),b.activeTexture.set(E.TEXTURE4),W.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),L.u_dem_lerp=H):(F=this.terrainTileForTile[n.tileID.key],b.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(n,F,L)?F.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),b.activeTexture.set(E.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(L.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),L.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&F){const Q=(1<<F.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;L.u_meter_to_dem=Q}if(g&&g.labelPlaneMatrixInv&&(L.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),c.setTerrainUniformValues(b,L),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,n.tileID.canonical,g&&g.useDenormalizedUpVectorScale);c.setGlobeUniformValues(b,Q)}}globeUniformValues(n,c,g){const b=n.projection;return{u_tile_tl_up:b.upVector(c,0,0),u_tile_tr_up:b.upVector(c,s.EXTENT,0),u_tile_br_up:b.upVector(c,s.EXTENT,s.EXTENT),u_tile_bl_up:b.upVector(c,0,s.EXTENT),u_tile_up_scale:g?s.globeMetersToEcef(1):b.upVectorScale(c,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const c=this.painter,g=this.painter.context;n.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,E,L,D,F){if(b.transform.projection.name==="globe")(function(W,H,Q,he,me){const ye=W.context,_e=ye.gl;let be,ee;const pe=W.options.showTerrainWireframe?2:0,Ce=W.transform,Ie=s.globeUseCustomAntiAliasing(W,ye,Ce),Ge=(jt,at)=>{if(ee===jt)return;const Mt=[ul[jt],"PROJECTION_GLOBE_VIEW"];Ie&&Mt.push("CUSTOM_ANTIALIASING"),at&&Mt.push(ul[pe]),be=W.useProgram("globeRaster",null,Mt),ee=jt},Fe=W.colorModeForRenderPass(),We=new s.DepthMode(_e.LEQUAL,s.DepthMode.ReadWrite,W.depthRangeFor3D);To.update(me);const it=s.calculateGlobeMercatorMatrix(Ce),et=[s.mercatorXfromLng(Ce.center.lng),s.mercatorYfromLat(Ce.center.lat)],pt=pe?[!1,!0]:[!1],Nt=W.globeSharedBuffers,ht=[Ce.width*s.exported.devicePixelRatio,Ce.height*s.exported.devicePixelRatio],Ct=Float32Array.from(Ce.globeMatrix),yt={useDenormalizedUpVectorScale:!0};if(pt.forEach(jt=>{const at=W.transform,Mt=Hh(at.zoom)*H.exaggeration();ee=-1;const Gt=jt?_e.LINES:_e.TRIANGLES;for(const Et of he){const Xt=Q.getTile(Et),ki=s.StencilMode.disabled,Ni=H.prevTerrainTileForTile[Et.key],bi=H.terrainTileForTile[Et.key];hl(Ni,bi)&&To.newMorphing(Et.key,Ni,bi,me,250),ye.activeTexture.set(_e.TEXTURE0),Xt.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Li=To.getMorphValuesForProxy(Et.key),Wi=Li?1:0;Li&&s.extend$1(yt,{morphing:{srcDemTile:Li.from,dstDemTile:Li.to,phase:s.easeCubicInOut(Li.phase)}});const Hi=s.tileCornersToBounds(Et.canonical),Ai=s.getLatitudinalLod(Hi.getCenter().lat),Mr=s.getGridMatrix(Et.canonical,Hi,Ai,at.worldSize/at._pixelsPerMercatorPixel),Dr=s.globeNormalizeECEF(s.globeTileBounds(Et.canonical)),Or=Wh(at.projMatrix,Ct,it,Dr,s.globeToMercatorTransition(at.zoom),et,at.frustumCorners.TL,at.frustumCorners.TR,at.frustumCorners.BR,at.frustumCorners.BL,at.globeCenterInViewSpace,at.globeRadius,ht,Mt,Mr);if(Ge(Wi,jt),H.setupElevationDraw(Xt,be,yt),W.prepareDrawProgram(ye,be,Et.toUnwrapped()),Nt){const[Rr,_s,ns]=jt?Nt.getWirefameBuffers(W.context,Ai):Nt.getGridBuffers(Ai,Mt!==0);be.draw(ye,Gt,We,ki,Fe,s.CullFaceMode.backCCW,Or,"globe_raster",Rr,_s,ns)}}}),Nt){const jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ie&&jt.push("CUSTOM_ANTIALIASING"),be=W.useProgram("globeRaster",null,jt);for(const at of he){const{x:Mt,y:Gt,z:Et}=at.canonical,Xt=Gt===0,ki=Gt===(1<<Et)-1,[Ni,bi,Li,Wi]=Nt.getPoleBuffers(Et);if(Wi&&(Xt||ki)){const Hi=Q.getTile(at);ye.activeTexture.set(_e.TEXTURE0),Hi.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let Ai=s.globePoleMatrixForTile(Et,Mt,Ce);const Mr=s.globeNormalizeECEF(s.globeTileBounds(at.canonical)),Dr=(Or,Rr)=>Or.draw(ye,_e.TRIANGLES,We,s.StencilMode.disabled,Fe,s.CullFaceMode.disabled,Wh(Ce.projMatrix,Ai,Ai,Mr,0,et,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,ht,0),"globe_pole_raster",Rr,Li,Wi);H.setupElevationDraw(Hi,be,yt),W.prepareDrawProgram(ye,be,at.toUnwrapped()),Xt&&Dr(be,Ni),ki&&(Ai=s.scale(s.create(),Ai,[1,-1,1]),Dr(be,bi))}}}})(b,E,L,D,F);else{const W=b.context,H=W.gl;let Q,he;const me=b.options.showTerrainWireframe?2:0,ye=(Ce,Ie)=>{if(he===Ce)return;const Ge=[ul[Ce]];Ie&&Ge.push(ul[me]),Q=b.useProgram("terrainRaster",null,Ge),he=Ce},_e=b.colorModeForRenderPass(),be=new s.DepthMode(H.LEQUAL,s.DepthMode.ReadWrite,b.depthRangeFor3D);To.update(F);const ee=b.transform,pe=Hh(ee.zoom)*E.exaggeration();(me?[!1,!0]:[!1]).forEach(Ce=>{he=-1;const Ie=Ce?H.LINES:H.TRIANGLES,[Ge,Fe]=Ce?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const We of D){const it=L.getTile(We),et=s.StencilMode.disabled,pt=E.prevTerrainTileForTile[We.key],Nt=E.terrainTileForTile[We.key];hl(pt,Nt)&&To.newMorphing(We.key,pt,Nt,F,250),W.activeTexture.set(H.TEXTURE0),it.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);const ht=To.getMorphValuesForProxy(We.key),Ct=ht?1:0;let yt;ht&&(yt={morphing:{srcDemTile:ht.from,dstDemTile:ht.to,phase:s.easeCubicInOut(ht.phase)}});const jt=Va(We.projMatrix,$f(We.canonical,ee.renderWorldCopies)?pe/10:pe);ye(Ct,Ce),E.setupElevationDraw(it,Q,yt),b.prepareDrawProgram(W,Q,We.toUnwrapped()),Q.draw(W,Ie,be,et,_e,s.CullFaceMode.backCCW,jt,"terrain_raster",E.gridBuffer,Ge,Fe)}})}}(c,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const c=this.painter,g=this.painter.context,b=this.proxySourceCache,E=this.proxiedCoords[b.id],L=this._drapedRenderBatches.shift(),D=[],F=c.style.order;let W=0;for(const H of E){const Q=b.getTileByID(H.proxyTileKey),he=b.proxyCachedFBO[H.key]?b.proxyCachedFBO[H.key][n]:void 0,me=he!==void 0?b.renderCache[he]:this.pool[W++],ye=he!==void 0;if(Q.texture=me.tex,ye&&!me.dirty){D.push(Q.tileID);continue}let _e;g.bindFramebuffer.set(me.fb.framebuffer),this.renderedToTile=!1,me.dirty&&(g.clear({color:s.Color.transparent,stencil:0}),me.dirty=!1);for(let be=L.start;be<=L.end;++be){const ee=c.style._layers[F[be]];if(ee.isHidden(c.transform.zoom))continue;const pe=c.style._getLayerSourceCache(ee),Ce=pe?this.proxyToSource[H.key][pe.id]:[H];if(!Ce)continue;const Ie=Ce;g.viewport.set([0,0,me.fb.width,me.fb.height]),_e!==(pe?pe.id:null)&&(this._setupStencil(me,Ce,ee,pe),_e=pe?pe.id:null),c.renderLayer(c,pe,ee,Ie)}this.renderedToTile?(me.dirty=!0,D.push(Q.tileID)):ye||--W,W===5&&(W=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,c.width,c.height]),L.end+1}postRender(){}renderCacheEfficiency(n){const c=n.order.length;if(c===0)return{efficiency:100};let g,b=0,E=0,L=!1;for(let D=0;D<c;++D){const F=n._layers[n.order[D]];this._style.isLayerDraped(F)?(L&&++b,++E):L||(L=!0,g=F.id)}return E===0?{efficiency:100}:{efficiency:100*(1-b/E),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{n=Math.min(n,c.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,c,g){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const L=E.tileID,D=1<<L.overscaledZ,{x:F,y:W}=L.canonical,H=F/D,Q=(F+1)/D,he=W/D,me=(W+1)/D;return{minx:H,miny:he,maxx:Q,maxy:me,t:E.dem.tree.raycastRoot(H,he,Q,me,n,c,g),tile:E}});b.sort((E,L)=>(E.t!==null?E.t:Number.MAX_VALUE)-(L.t!==null?L.t:Number.MAX_VALUE));for(const E of b){if(E.t==null)return null;const L=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,n,c,g);if(L!=null)return L}return null}_createFBO(){const n=this.painter.context,c=n.gl,g=this.drapeBufferSize;n.activeTexture.set(c.TEXTURE0);const b=new s.Texture(n,{width:g[0],height:g[1],data:null},c.RGBA);b.bind(c.LINEAR,c.CLAMP_TO_EDGE);const E=n.createFramebuffer(g[0],g[1],!1);return E.colorAttachment.set(b.texture),E.depthAttachment=new Je(n,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&!n.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:E,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const c=this._style._layers[n],g=c.isHidden(this.painter.transform.zoom);return c.type==="custom"?!g&&c.shouldRedrape():!g&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const g of this._style._getSources())if(g instanceof ni){n=!0;break}if(!n)return;const c={};for(let g=0;g<this._style.order.length;++g){const b=this._style._layers[this._style.order[g]],E=this._style._getLayerSourceCache(b);if(E&&!c[E.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof s.ZoomDependentExpression){c[E.id]=!0;for(const L of this.proxyCoords){const D=this.proxyToSource[L.key][E.id];if(D)for(const F of D)this._clearRenderCacheForTile(E.id,F)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const g in this._style._sourceCaches)if(this._style._sourceCaches[g]._source instanceof qt){n=!0;break}if(!n)return;const c={};for(let g=0;g<this._style.order.length;++g){const b=this._style._layers[this._style.order[g]],E=this._style._getLayerSourceCache(b);if(!E||c[E.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const L=b.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const F=this.proxyToSource[D.key][E.id];if(F)for(const W of F){const H=ud(E.getTile(W),E.findLoadedParent(W,0),E,this.painter.transform,L);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(E.id,W)}}}}_setupDrapedRenderBatches(){const n=this._style.order,c=n.length;if(c===0)return;const g=[];let b,E=0,L=this._style._layers[n[E]];for(;!this._style.isLayerDraped(L)&&L.isHidden(this.painter.transform.zoom)&&++E<c;)L=this._style._layers[n[E]];for(;E<c;++E){const D=this._style._layers[n[E]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?b===void 0&&(b=E):b!==void 0&&(g.push({start:b,end:E-1}),b=void 0))}b!==void 0&&g.push({start:b,end:E-1}),this._drapedRenderBatches=g}_setupRenderCache(n){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const L=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let D=0;D<L.length;++D){const F=Object.values(L[D]);c.renderCachePool.push(...F)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,b=this._tilesDirty;for(let L=g.length-1;L>=0;L--){const D=g[L];if(c.getTileByID(D.key),c.proxyCachedFBO[D.key]!==void 0){const F=n[D.key],W=this.proxyToSource[D.key];let H=0;for(const Q in W){const he=W[Q],me=F[Q];if(!me||me.length!==he.length||he.some((ye,_e)=>ye!==me[_e]||b[Q]&&b[Q].hasOwnProperty(ye.key))){H=-1;break}++H}for(const Q in c.proxyCachedFBO[D.key])c.renderCache[c.proxyCachedFBO[D.key][Q]].dirty=H<0||H!==Object.values(F).length}}const E=[...this._drapedRenderBatches];E.sort((L,D)=>D.end-D.start-(L.end-L.start));for(const L of E)for(const D of g){if(c.proxyCachedFBO[D.key])continue;let F=c.renderCachePool.pop();F===void 0&&c.renderCache.length<50&&(F=c.renderCache.length,c.renderCache.push(this._createFBO())),F!==void 0&&(c.proxyCachedFBO[D.key]={},c.proxyCachedFBO[D.key][L.start]=F,c.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(n,c,g,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,L=E.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let D;if(g.isTileClipped())D=c.length,this._overlapStencilMode.test={func:L.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:L.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(n,c){const g=this.painter,b=this.painter.context,E=b.gl;g._tileClippingMaskIDs={},b.setColorMode(s.ColorMode.disabled),b.setDepthMode(s.DepthMode.disabled);const L=g.useProgram("clippingMask");for(const D of n){const F=g._tileClippingMaskIDs[D.key]=--c;L.draw(b,E.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:E.ALWAYS,mask:0},F,255,E.KEEP,E.KEEP,E.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,$c(D.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(n){const c=this.painter.transform;if(n.x<0||n.x>c.width||n.y<0||n.y>c.height)return null;const g=[n.x,n.y,1,1];s.transformMat4$1(g,g,c.pixelMatrixInverse),s.scale$1(g,g,1/g[3]),g[0]/=c.worldSize,g[1]/=c.worldSize;const b=c._camera.position,E=s.mercatorZfromAltitude(1,c.center.lat),L=[b[0],b[1],b[2]/E,0],D=s.subtract([],g.slice(0,3),L);s.normalize(D,D);const F=this.raycast(L,D,this._exaggeration);return F!==null&&F?(s.scaleAndAdd(L,L,D,F),L[3]=L[2],L[2]*=E,L):null}drawDepth(){const n=this.painter,c=n.context,g=this.proxySourceCache,b=Math.ceil(n.width),E=Math.ceil(n.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const L=c.gl,D=c.createFramebuffer(b,E,!0);c.activeTexture.set(L.TEXTURE0);const F=new s.Texture(c,{width:b,height:E,data:null},L.RGBA);F.bind(L.NEAREST,L.CLAMP_TO_EDGE),D.colorAttachment.set(F.texture);const W=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,b,E);D.depthAttachment.set(W),this._depthFBO=D,this._depthTexture=F}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,b,E]),function(L,D,F,W){if(L.transform.projection.name==="globe")return;const H=L.context,Q=H.gl;H.clear({depth:1});const he=L.useProgram("terrainDepth"),me=new s.DepthMode(Q.LESS,s.DepthMode.ReadWrite,L.depthRangeFor3D);for(const ye of W){const _e=F.getTile(ye),be=Va(ye.projMatrix,0);D.setupElevationDraw(_e,he),he.draw(H,Q.TRIANGLES,me,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,be,"terrain_depth",D.gridBuffer,D.gridIndexBuffer,D.gridNoSkirtSegments)}}(n,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(n,c,g){if(n.getSource()instanceof zi)return this._setupProxiedCoordsForImageSource(n,c,g);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const b=this.proxiedCoords[n.id]=[],E=this.proxyCoords;for(let D=0;D<E.length;D++){const F=E[D],W=this._findTileCoveringTileID(F,n);if(W){const H=this._createProxiedId(F,W,g[F.key]&&g[F.key][n.id]);b.push(H),this.proxyToSource[F.key][n.id]=[H]}}let L=!1;for(let D=0;D<c.length;D++){const F=n.getTile(c[D]);if(!F||!F.hasData())continue;const W=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==F.tileID.canonical.z){const H=this.proxyToSource[W.tileID.key][n.id],Q=this._createProxiedId(W.tileID,F,g[W.tileID.key]&&g[W.tileID.key][n.id]);H?H.splice(H.length-1,0,Q):this.proxyToSource[W.tileID.key][n.id]=[Q],b.push(Q),L=!0}}this._sourceTilesOverlap[n.id]=L}_setupProxiedCoordsForImageSource(n,c,g){if(!n.getSource().loaded())return;const b=this.proxiedCoords[n.id]=[],E=this.proxyCoords,L=n.getSource(),D=new s.Point(L.tileID.x,L.tileID.y)._div(1<<L.tileID.z),F=L.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((H,Q)=>(H.min.x=Math.min(H.min.x,Q.x-D.x),H.min.y=Math.min(H.min.y,Q.y-D.y),H.max.x=Math.max(H.max.x,Q.x-D.x),H.max.y=Math.max(H.max.y,Q.y-D.y),H),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(H,Q)=>{const he=H.wrap+H.canonical.x/(1<<H.canonical.z),me=H.canonical.y/(1<<H.canonical.z),ye=s.EXTENT/(1<<H.canonical.z),_e=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),be=Q.canonical.y/(1<<Q.canonical.z);return he+ye<_e+F.min.x||he>_e+F.max.x||me+ye<be+F.min.y||me>be+F.max.y};for(let H=0;H<E.length;H++){const Q=E[H];for(let he=0;he<c.length;he++){const me=n.getTile(c[he]);if(!me||!me.hasData()||W(Q,me.tileID))continue;const ye=this._createProxiedId(Q,me,g[Q.key]&&g[Q.key][n.id]),_e=this.proxyToSource[Q.key][n.id];_e?_e.push(ye):this.proxyToSource[Q.key][n.id]=[ye],b.push(ye)}}}_createProxiedId(n,c,g){let b=this.orthoMatrix;if(g){const E=g.find(L=>L.key===c.tileID.key);if(E)return E}if(c.tileID.key!==n.key){const E=n.canonical.z-c.tileID.canonical.z;let L,D,F;b=s.create();const W=c.tileID.wrap-n.wrap<<n.overscaledZ;E>0?(L=s.EXTENT>>E,D=L*((c.tileID.canonical.x<<E)-n.canonical.x+W),F=L*((c.tileID.canonical.y<<E)-n.canonical.y)):(L=s.EXTENT<<-E,D=s.EXTENT*(c.tileID.canonical.x-(n.canonical.x+W<<-E)),F=s.EXTENT*(c.tileID.canonical.y-(n.canonical.y<<-E))),s.ortho(b,0,L,0,L,0,1),s.translate(b,b,[D,F,0])}return new Xh(c.tileID,n.key,b)}_findTileCoveringTileID(n,c){let g=c.getTile(n);if(g&&g.hasData())return g;const b=this._findCoveringTileCache[c.id],E=b[n.key];if(g=E?c.getTileByID(E):null,g&&g.hasData()||E===null)return g;let L=g?g.tileID:n,D=L.overscaledZ;const F=c.getSource().minzoom,W=[];if(!E){const Q=c.getSource().maxzoom;if(n.canonical.z>=Q){const he=n.canonical.z-Q;c.getSource().reparseOverscaled?(D=Math.max(n.canonical.z+2,c.transform.tileZoom),L=new s.OverscaledTileID(D,n.wrap,Q,n.canonical.x>>he,n.canonical.y>>he)):he!==0&&(D=Q,L=new s.OverscaledTileID(D,n.wrap,Q,n.canonical.x>>he,n.canonical.y>>he))}L.key!==n.key&&(W.push(L.key),g=c.getTile(L))}const H=Q=>{W.forEach(he=>{b[he]=Q}),W.length=0};for(D-=1;D>=F&&(!g||!g.hasData());D--){g&&H(g.tileID.key);const Q=L.calculateScaledKey(D);if(g=c.getTileByID(Q),g&&g.hasData())break;const he=b[Q];if(he===null)break;he===void 0?W.push(Q):g=c.getTileByID(he)}return H(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,c){let g=this._tilesDirty[n];g||(g=this._tilesDirty[n]={}),g[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const n=function(c){let g=0;const b=new s.StructArrayLayout2ui4,E=131;for(let L=1;L<129;L++){for(let D=1;D<129;D++)g=L*E+D,b.emplaceBack(g,g+1),b.emplaceBack(g,g+E),b.emplaceBack(g+1,g+E),L===128&&b.emplaceBack(g+E,g+E+1);b.emplaceBack(g+1,g+1+E)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(n),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class mr{static cacheKey(n,c,g,b){let E=`${c}${b?b.cacheKey:""}`;for(const L of g)n.usedDefines.includes(L)&&(E+=`/${L}`);return E}constructor(n,c,g,b,E,L){const D=n.gl;this.program=D.createProgram();const F=function(ee){const pe=[];for(let Ce=0;Ce<ee.length;Ce++){if(ee[Ce]===null)continue;const Ie=ee[Ce].split(" ");pe.push(Ie.pop())}return pe}(g.staticAttributes),W=b?b.getBinderAttributes():[],H=F.concat(W);let Q=b?b.defines():[];Q=Q.concat(L.map(ee=>`#define ${ee}`));const he=n.isWebGL2?`#version 300 es
`:"",me=he+Q.concat(n.extStandardDerivatives&&he.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Jl):Jl,Jl,Uh,Kl.fragmentSource,Zl.fragmentSource,g.fragmentSource).join(`
`),ye=he+Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Uh,Kl.vertexSource,Zl.vertexSource,jc.vertexSource,g.vertexSource).join(`
`),_e=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(_e,me),D.compileShader(_e),D.attachShader(this.program,_e);const be=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(be,ye),D.compileShader(be),D.attachShader(this.program,be),this.attributes={},this.numAttributes=H.length;for(let ee=0;ee<this.numAttributes;ee++)H[ee]&&(D.bindAttribLocation(this.program,ee,H[ee]),this.attributes[H[ee]]=ee);D.linkProgram(this.program),D.deleteShader(be),D.deleteShader(_e),this.fixedUniforms=E(n),this.binderUniforms=b?b.getUniforms(n):[],L.includes("TERRAIN")&&(this.terrainUniforms=(ee=>({u_dem:new s.Uniform1i(ee),u_dem_prev:new s.Uniform1i(ee),u_dem_unpack:new s.Uniform4f(ee),u_dem_tl:new s.Uniform2f(ee),u_dem_scale:new s.Uniform1f(ee),u_dem_tl_prev:new s.Uniform2f(ee),u_dem_scale_prev:new s.Uniform1f(ee),u_dem_size:new s.Uniform1f(ee),u_dem_lerp:new s.Uniform1f(ee),u_exaggeration:new s.Uniform1f(ee),u_depth:new s.Uniform1i(ee),u_depth_size_inv:new s.Uniform2f(ee),u_meter_to_dem:new s.Uniform1f(ee),u_label_plane_matrix_inv:new s.UniformMatrix4f(ee)}))(n)),L.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new s.Uniform3f(ee),u_tile_tr_up:new s.Uniform3f(ee),u_tile_br_up:new s.Uniform3f(ee),u_tile_bl_up:new s.Uniform3f(ee),u_tile_up_scale:new s.Uniform1f(ee)}))(n)),L.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new s.UniformMatrix4f(ee),u_fog_range:new s.Uniform2f(ee),u_fog_color:new s.Uniform4f(ee),u_fog_horizon_blend:new s.Uniform1f(ee),u_fog_temporal_offset:new s.Uniform1f(ee),u_frustum_tl:new s.Uniform3f(ee),u_frustum_tr:new s.Uniform3f(ee),u_frustum_br:new s.Uniform3f(ee),u_frustum_bl:new s.Uniform3f(ee),u_globe_pos:new s.Uniform3f(ee),u_globe_radius:new s.Uniform1f(ee),u_globe_transition:new s.Uniform1f(ee),u_is_globe:new s.Uniform1i(ee),u_viewport:new s.Uniform2f(ee)}))(n))}}setTerrainUniformValues(n,c){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const b in c)g[b]&&g[b].set(this.program,b,c[b])}}setGlobeUniformValues(n,c){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const b in c)g[b]&&g[b].set(this.program,b,c[b])}}setFogUniformValues(n,c){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const b in c)g[b].set(this.program,b,c[b])}}draw(n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e){const be=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(g),n.setStencilMode(b),n.setColorMode(E),n.setCullFace(L);for(const pe of Object.keys(this.fixedUniforms))this.fixedUniforms[pe].set(this.program,pe,D[pe]);ye&&ye.setUniforms(this.program,n,this.binderUniforms,he,{zoom:me});const ee={[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[c];for(const pe of Q.get()){const Ce=pe.vaos||(pe.vaos={});(Ce[F]||(Ce[F]=new wm)).bind(n,this,W,ye?ye.getPaintVertexBuffers():[],H,pe.vertexOffset,_e||[]),be.drawElements(c,pe.primitiveLength*ee,be.UNSIGNED_SHORT,pe.primitiveOffset*ee*2)}}}function Xo(f,n){const c=Math.pow(2,n.tileID.overscaledZ),g=n.tileSize*Math.pow(2,f.transform.tileZoom)/c,b=g*(n.tileID.canonical.x+n.tileID.wrap*c),E=g*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_tile_units_to_pixels:1/sr(n,1,f.transform.tileZoom),u_pixel_coord_upper:[b>>16,E>>16],u_pixel_coord_lower:[65535&b,65535&E]}}const fd=s.create(),Zh=(f,n,c,g,b,E,L,D,F,W,H)=>{const Q=n.style.light,he=Q.properties.get("position"),me=[he.x,he.y,he.z],ye=s.create$1();Q.properties.get("anchor")==="viewport"&&(s.fromRotation(ye,-n.transform.angle),s.transformMat3(me,me,ye));const _e=Q.properties.get("color"),be=n.transform,ee={u_matrix:f,u_lightpos:me,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[_e.r,_e.g,_e.b],u_vertical_gradient:+c,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:fd,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:b,u_edge_radius:E};return be.projection.name==="globe"&&(ee.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],ee.u_zoom_transition=F,ee.u_inv_rot_matrix=H,ee.u_merc_center=W,ee.u_up_dir=be.projection.upVector(new s.CanonicalTileID(0,0,0),W[0]*s.EXTENT,W[1]*s.EXTENT),ee.u_height_lift=D),ee},Gf=(f,n,c,g,b,E,L,D,F,W,H,Q)=>{const he=Zh(f,n,c,g,b,E,L,F,W,H,Q),me={u_height_factor:-Math.pow(2,L.overscaledZ)/D.tileSize/8};return s.extend(he,Xo(n,D),me)},dl=f=>({u_matrix:f}),pd=(f,n,c)=>s.extend(dl(f),Xo(n,c)),md=(f,n)=>({u_matrix:f,u_world:n}),gd=(f,n,c,g)=>s.extend(pd(f,n,c),{u_world:g}),Yh=s.create(),Ql=(f,n,c,g,b,E)=>{const L=f.transform,D=L.projection.name==="globe";let F;if(E.paint.get("circle-pitch-alignment")==="map")if(D){const H=s.globePixelsToTileUnits(L.zoom,n.canonical)*L._pixelsPerMercatorPixel;F=Float32Array.from([H,0,0,H])}else F=L.calculatePixelsToTileUnitsMatrix(c);else F=new Float32Array([L.pixelsToGLUnits[0],0,0,L.pixelsToGLUnits[1]]);const W={u_camera_to_center_distance:L.cameraToCenterDistance,u_matrix:f.translatePosMatrix(n.projMatrix,c,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:F,u_inv_rot_matrix:Yh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){W.u_inv_rot_matrix=g,W.u_merc_center=b,W.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],W.u_zoom_transition=s.globeToMercatorTransition(L.zoom);const H=b[0]*s.EXTENT,Q=b[1]*s.EXTENT;W.u_up_dir=L.projection.upVector(new s.CanonicalTileID(0,0,0),H,Q)}return W},_d=f=>{const n=[];return f.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n},Kh=(f,n,c,g)=>{const b=s.EXTENT/c.tileSize;return{u_matrix:f,u_camera_to_center_distance:n.getCameraToCenterDistance(g),u_extrude_scale:[n.pixelsToGLUnits[0]/b,n.pixelsToGLUnits[1]/b]}},fl=(f,n,c=1)=>({u_matrix:f,u_color:n,u_overlay:0,u_overlay_scale:c}),ja=s.create(),Wf=(f,n,c,g,b,E,L)=>{const D=f.transform,F=D.projection.name==="globe",W=F?s.globePixelsToTileUnits(D.zoom,n.canonical)*D._pixelsPerMercatorPixel:sr(c,1,E),H={u_matrix:n.projMatrix,u_extrude_scale:W,u_intensity:L,u_inv_rot_matrix:ja,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){H.u_inv_rot_matrix=g,H.u_merc_center=b,H.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],H.u_zoom_transition=s.globeToMercatorTransition(D.zoom);const Q=b[0]*s.EXTENT,he=b[1]*s.EXTENT;H.u_up_dir=D.projection.upVector(new s.CanonicalTileID(0,0,0),Q,he)}return H},pl=(f,n,c,g,b,E,L)=>{const D=f.transform,F=D.calculatePixelsToTileUnitsMatrix(n);return{u_matrix:ml(f,n,c,g),u_pixels_to_tile_units:F,u_device_pixel_ratio:E,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:Hc(c)?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Eo(n,f.transform),u_alpha_discard_threshold:0,u_trim_offset:L}},Wc=(f,n,c,g,b)=>{const E=f.transform;return{u_matrix:ml(f,n,c,g),u_texsize:n.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:b,u_image:0,u_tile_units_to_pixels:Eo(n,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Eo(f,n){return 1/sr(f,1,n.tileZoom)}function ml(f,n,c,g){return f.translatePosMatrix(g||n.tileID.projMatrix,n,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Hc(f){const n=f.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}const qc=(f,n,c,g,b,E)=>{return{u_matrix:f,u_tl_parent:n,u_scale_parent:c,u_fade_t:g.mix,u_opacity:g.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(D=b.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(L=b.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:eo(b.paint.get("raster-hue-rotate")),u_perspective_transform:E};var L,D};function eo(f){f*=Math.PI/180;const n=Math.sin(f),c=Math.cos(f);return[(2*c+1)/3,(-Math.sqrt(3)*n-c+1)/3,(Math.sqrt(3)*n-c+1)/3]}const Jh=s.create(),yd=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e)=>{const be=b.transform,ee={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:be.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:be.width/be.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:L,u_coord_matrix:D,u_is_text:+F,u_pitch_with_map:+g,u_texsize:W,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Jh,u_up_vector:[0,-1,0]};return _e.name==="globe"&&(ee.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],ee.u_zoom_transition=Q,ee.u_inv_rot_matrix=me,ee.u_merc_center=he,ee.u_camera_forward=be._camera.forward(),ee.u_ecef_origin=s.globeECEFOrigin(be.globeMatrix,H.toUnwrapped()),ee.u_tile_matrix=Float32Array.from(be.globeMatrix),ee.u_up_vector=ye),ee},Qh=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e,be)=>s.extend(yd(f,n,c,g,b,E,L,D,F,W,Q,he,me,ye,_e,be),{u_gamma_scale:g?b.transform.cameraToCenterDistance*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:1}),Xc=(f,n,c,g,b,E,L,D,F,W,H,Q,he,me,ye,_e)=>s.extend(Qh(f,n,c,g,b,E,L,D,!0,F,!0,H,Q,he,me,ye,_e),{u_texsize_icon:W,u_texture_icon:1}),xd=(f,n,c)=>({u_matrix:f,u_opacity:n,u_color:c}),Tm=(f,n,c,g,b)=>s.extend(function(E,L,D){const F=L.imageManager.getPattern(E.toString()),{width:W,height:H}=L.imageManager.getPixelSize(),Q=Math.pow(2,D.tileID.overscaledZ),he=D.tileSize*Math.pow(2,L.transform.tileZoom)/Q,me=he*(D.tileID.canonical.x+D.tileID.wrap*Q),ye=he*D.tileID.canonical.y;return{u_image:0,u_pattern_tl:F.tl,u_pattern_br:F.br,u_texsize:[W,H],u_pattern_size:F.displaySize,u_tile_units_to_pixels:1/sr(D,1,L.transform.tileZoom),u_pixel_coord_upper:[me>>16,ye>>16],u_pixel_coord_lower:[65535&me,65535&ye]}}(g,c,b),{u_matrix:f,u_opacity:n}),vd={fillExtrusion:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_height_factor:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f)}),fill:f=>({u_matrix:new s.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),fillOutline:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),collisionBox:f=>({u_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new s.UniformMatrix4f(f),u_inv_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_viewport_size:new s.Uniform2f(f)}),debug:f=>({u_color:new s.UniformColor(f),u_matrix:new s.UniformMatrix4f(f),u_overlay:new s.Uniform1i(f),u_overlay_scale:new s.Uniform1f(f)}),clippingMask:f=>({u_matrix:new s.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new s.Uniform1f(f),u_intensity:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),heatmapTexture:f=>({u_image:new s.Uniform1i(f),u_color_ramp:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f)}),hillshade:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_latrange:new s.Uniform2f(f),u_light:new s.Uniform2f(f),u_shadow:new s.UniformColor(f),u_highlight:new s.UniformColor(f),u_accent:new s.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_dimension:new s.Uniform2f(f),u_zoom:new s.Uniform1f(f),u_unpack:new s.Uniform4f(f)}),line:f=>({u_matrix:new s.UniformMatrix4f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_units_to_pixels:new s.Uniform2f(f),u_dash_image:new s.Uniform1i(f),u_gradient_image:new s.Uniform1i(f),u_image_height:new s.Uniform1f(f),u_texsize:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f),u_trim_offset:new s.Uniform2f(f)}),linePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_texsize:new s.Uniform2f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_units_to_pixels:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f)}),raster:f=>({u_matrix:new s.UniformMatrix4f(f),u_tl_parent:new s.Uniform2f(f),u_scale_parent:new s.Uniform1f(f),u_fade_t:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_image0:new s.Uniform1i(f),u_image1:new s.Uniform1i(f),u_brightness_low:new s.Uniform1f(f),u_brightness_high:new s.Uniform1f(f),u_saturation_factor:new s.Uniform1f(f),u_contrast_factor:new s.Uniform1f(f),u_spin_weights:new s.Uniform3f(f),u_perspective_transform:new s.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_texture:new s.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_is_halo:new s.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texsize_icon:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_texture_icon:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_is_halo:new s.Uniform1i(f)}),background:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_color:new s.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_pattern_tl:new s.Uniform2f(f),u_pattern_br:new s.Uniform2f(f),u_texsize:new s.Uniform2f(f),u_pattern_size:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),terrainRaster:Gh,terrainDepth:Gh,skybox:f=>({u_matrix:new s.UniformMatrix4f(f),u_sun_direction:new s.Uniform3f(f),u_cubemap:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new s.UniformMatrix4f(f),u_color_ramp:new s.Uniform1i(f),u_center_direction:new s.Uniform3f(f),u_radius:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new s.UniformMatrix3f(f),u_sun_direction:new s.Uniform3f(f),u_sun_intensity:new s.Uniform1f(f),u_color_tint_r:new s.Uniform4f(f),u_color_tint_m:new s.Uniform4f(f),u_luminance:new s.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new s.UniformMatrix4f(f),u_globe_matrix:new s.UniformMatrix4f(f),u_normalize_matrix:new s.UniformMatrix4f(f),u_merc_matrix:new s.UniformMatrix4f(f),u_zoom_transition:new s.Uniform1f(f),u_merc_center:new s.Uniform2f(f),u_image0:new s.Uniform1i(f),u_grid_matrix:new s.UniformMatrix3f(f),u_skirt_height:new s.Uniform1f(f),u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_globe_pos:new s.Uniform3f(f),u_globe_radius:new s.Uniform1f(f),u_viewport:new s.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_horizon:new s.Uniform1f(f),u_transition:new s.Uniform1f(f),u_fadeout_range:new s.Uniform1f(f),u_color:new s.Uniform4f(f),u_high_color:new s.Uniform4f(f),u_space_color:new s.Uniform4f(f),u_star_intensity:new s.Uniform1f(f),u_star_density:new s.Uniform1f(f),u_star_size:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f),u_horizon_angle:new s.Uniform1f(f),u_rotation_matrix:new s.UniformMatrix4f(f)})};let So;function Zc(f,n,c,g,b,E,L){const D=f.context,F=D.gl,W=f.transform,H=f.useProgram("collisionBox"),Q=[];let he=0,me=0;for(let Ie=0;Ie<g.length;Ie++){const Ge=g[Ie],Fe=n.getTile(Ge),We=Fe.getBucket(c);if(!We)continue;const it=Js(Ge,We,W);let et=it;b[0]===0&&b[1]===0||(et=f.translatePosMatrix(it,Fe,b,E));const pt=L?We.textCollisionBox:We.iconCollisionBox,Nt=We.collisionCircleArray;if(Nt.length>0){const ht=s.create(),Ct=et;s.mul(ht,We.placementInvProjMatrix,W.glCoordMatrix),s.mul(ht,ht,We.placementViewportMatrix),Q.push({circleArray:Nt,circleOffset:me,transform:Ct,invTransform:ht,projection:We.getProjection()}),he+=Nt.length/4,me=he}pt&&(f.terrain&&f.terrain.setupElevationDraw(Fe,H),H.draw(D,F.LINES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,Kh(et,W,Fe,We.getProjection()),c.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,null,W.zoom,null,[pt.collisionVertexBuffer,pt.collisionVertexBufferExt]))}if(!L||!Q.length)return;const ye=f.useProgram("collisionCircle"),_e=new s.StructArrayLayout2f1f2i16;_e.resize(4*he),_e._trim();let be=0;for(const Ie of Q)for(let Ge=0;Ge<Ie.circleArray.length/4;Ge++){const Fe=4*Ge,We=Ie.circleArray[Fe+0],it=Ie.circleArray[Fe+1],et=Ie.circleArray[Fe+2],pt=Ie.circleArray[Fe+3];_e.emplace(be++,We,it,et,pt,0),_e.emplace(be++,We,it,et,pt,1),_e.emplace(be++,We,it,et,pt,2),_e.emplace(be++,We,it,et,pt,3)}(!So||So.length<2*he)&&(So=function(Ie){const Ge=2*Ie,Fe=new s.StructArrayLayout3ui6;Fe.resize(Ge),Fe._trim();for(let We=0;We<Ge;We++){const it=6*We;Fe.uint16[it+0]=4*We+0,Fe.uint16[it+1]=4*We+1,Fe.uint16[it+2]=4*We+2,Fe.uint16[it+3]=4*We+2,Fe.uint16[it+4]=4*We+3,Fe.uint16[it+5]=4*We+0}return Fe}(he));const ee=D.createIndexBuffer(So,!0),pe=D.createVertexBuffer(_e,s.collisionCircleLayout.members,!0);for(const Ie of Q){const Ge={u_matrix:Ie.transform,u_inv_matrix:Ie.invTransform,u_camera_to_center_distance:(Ce=W).getCameraToCenterDistance(Ie.projection),u_viewport_size:[Ce.width,Ce.height]};ye.draw(D,F.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,Ge,c.id,pe,ee,s.SegmentVector.simpleSegment(0,2*Ie.circleOffset,Ie.circleArray.length,Ie.circleArray.length/2),null,W.zoom)}var Ce;pe.destroy(),ee.destroy()}const bd=s.create();function wd({width:f,height:n,anchor:c,textOffset:g,textScale:b},E){const{horizontalAlign:L,verticalAlign:D}=s.getAnchorAlignment(c),F=-(L-.5)*f,W=-(D-.5)*n,H=s.evaluateVariableOffset(c,g);return new s.Point((F/b+H[0])*E,(W/b+H[1])*E)}function Em(f,n,c,g,b,E,L,D,F,W,H){const Q=f.text.placedSymbolArray,he=f.text.dynamicLayoutVertexArray,me=f.icon.dynamicLayoutVertexArray,ye={},_e=f.getProjection(),be=on(D,_e,E),ee=E.elevation,pe=_e.upVectorScale(D.canonical,E.center.lat,E.worldSize).metersToTile;he.clear();for(let Ce=0;Ce<Q.length;Ce++){const Ie=Q.get(Ce),{tileAnchorX:Ge,tileAnchorY:Fe,numGlyphs:We}=Ie,it=Ie.hidden||!Ie.crossTileID||f.allowVerticalPlacement&&!Ie.placedOrientation?null:g[Ie.crossTileID];if(it){let et=0,pt=0,Nt=0;if(ee){const Xt=ee?ee.getAtTileOffset(D,Ge,Fe):0,[ki,Ni,bi]=_e.upVector(D.canonical,Ge,Fe);et=Xt*ki*pe,pt=Xt*Ni*pe,Nt=Xt*bi*pe}let[ht,Ct,yt,jt]=es(Ie.projectedAnchorX+et,Ie.projectedAnchorY+pt,Ie.projectedAnchorZ+Nt,c?be:L);const at=Uf(E.getCameraToCenterDistance(_e),jt);let Mt=b.evaluateSizeForFeature(f.textSizeData,W,Ie)*at/s.ONE_EM;c&&(Mt*=f.tilePixelRatio/F);const Gt=wd(it,Mt);c?({x:ht,y:Ct,z:yt}=_e.projectTilePoint(Ge+Gt.x,Fe+Gt.y,D.canonical),[ht,Ct,yt]=es(ht+et,Ct+pt,yt+Nt,L)):(n&&Gt._rotate(-E.angle),ht+=Gt.x,Ct+=Gt.y,yt=0);const Et=f.allowVerticalPlacement&&Ie.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Xt=0;Xt<We;Xt++)s.addDynamicAttributes(he,ht,Ct,yt,Et);H&&Ie.associatedIconIndex>=0&&(ye[Ie.associatedIconIndex]={x:ht,y:Ct,z:yt,angle:Et})}else Ks(We,he)}if(H){me.clear();const Ce=f.icon.placedSymbolArray;for(let Ie=0;Ie<Ce.length;Ie++){const Ge=Ce.get(Ie),{numGlyphs:Fe}=Ge,We=ye[Ie];if(Ge.hidden||!We)Ks(Fe,me);else{const{x:it,y:et,z:pt,angle:Nt}=We;for(let ht=0;ht<Fe;ht++)s.addDynamicAttributes(me,it,et,pt,Nt)}}f.icon.dynamicLayoutVertexBuffer.updateData(me)}f.text.dynamicLayoutVertexBuffer.updateData(he)}function ec(f,n,c){return c.iconsInText&&n?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Hf(f,n,c,g,b,E,L,D,F,W,H,Q){const he=f.context,me=he.gl,ye=f.transform,_e=D==="map",be=F==="map",ee=_e&&c.layout.get("symbol-placement")!=="point",pe=_e&&!be&&!ee,Ce=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ie=!1;const Ge=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),Fe=[s.mercatorXfromLng(ye.center.lng),s.mercatorYfromLat(ye.center.lat)],We=c.layout.get("text-variable-anchor"),it=ye.projection.name==="globe",et=[],pt=[0,-1,0];let Nt=pt;!it&&!ye.mercatorFromTransition||_e||(Nt=function(ht){const Ct=ht._camera.getWorldToCamera(ht.worldSize,1),yt=s.multiply([],Ct,ht.globeMatrix);s.invert(yt,yt);const jt=[0,0,0],at=[0,1,0,0];return s.transformMat4$1(at,at,yt),jt[0]=at[0],jt[1]=at[1],jt[2]=at[2],s.normalize(jt,jt),jt}(ye));for(const ht of g){const Ct=n.getTile(ht),yt=Ct.getBucket(c);if(!yt||yt.projection.name==="mercator"&&it)continue;const jt=b?yt.text:yt.icon;if(!jt||yt.fullyClipped||!jt.segments.get().length)continue;const at=jt.programConfigurations.get(c.id),Mt=b||yt.sdfIcons,Gt=b?yt.textSizeData:yt.iconSizeData,Et=be||ye.pitch!==0,Xt=s.evaluateSizeForZoom(Gt,ye.zoom);let ki,Ni,bi,Li,Wi=[0,0],Hi=null;if(b)Ni=Ct.glyphAtlasTexture,bi=me.LINEAR,ki=Ct.glyphAtlasTexture.size,yt.iconsInText&&(Wi=Ct.imageAtlasTexture.size,Hi=Ct.imageAtlasTexture,Li=Et||f.options.rotating||f.options.zooming||Gt.kind==="composite"||Gt.kind==="camera"?me.LINEAR:me.NEAREST);else{const Ko=c.layout.get("icon-size").constantOr(0)!==1||yt.iconsNeedLinear;Ni=Ct.imageAtlasTexture,bi=Mt||f.options.rotating||f.options.zooming||Ko||Et?me.LINEAR:me.NEAREST,ki=Ct.imageAtlasTexture.size}const Ai=yt.projection.name==="globe",Mr=Ai?Nt:pt,Dr=Ai?s.globeToMercatorTransition(ye.zoom):0,Or=on(ht,yt.getProjection(),ye),Rr=ye.calculatePixelsToTileUnitsMatrix(Ct),_s=wt(Or,Ct.tileID.canonical,be,_e,ye,yt.getProjection(),Rr),ns=f.terrain&&be&&ee?s.invert(s.create(),_s):bd,no=Nn(Or,Ct.tileID.canonical,be,_e,ye,yt.getProjection(),Rr),Pr=We&&yt.hasTextData(),Yr=c.layout.get("icon-text-fit")!=="none"&&Pr&&yt.hasIconData();if(ee){const Ko=ye.elevation,Sa=Ko?Ko.getAtTileOffsetFunc(ht,ye.center.lat,ye.worldSize,yt.getProjection()):null,Tl=$o(Or,Ct.tileID.canonical,be,_e,ye,yt.getProjection(),Rr);Bh(yt,Or,f,b,Tl,no,be,W,Sa,ht)}const Vr=ee||b&&We||Yr,gr=f.translatePosMatrix(Or,Ct,E,L),Un=Vr?bd:_s,Ss=f.translatePosMatrix(no,Ct,E,L,!0),Kr=yt.getProjection().createInversionMatrix(ye,ht.canonical),qn=[];f.terrainRenderModeElevated()&&be&&qn.push("PITCH_WITH_MAP_TERRAIN"),Ai&&qn.push("PROJECTION_GLOBE_VIEW"),Vr&&qn.push("PROJECTED_POS_ON_VIEWPORT");const uu=Mt&&c.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ea;Ea=Mt?yt.iconsInText?Xc(Gt.kind,Xt,pe,be,f,gr,Un,Ss,ki,Wi,ht,Dr,Fe,Kr,Mr,yt.getProjection()):Qh(Gt.kind,Xt,pe,be,f,gr,Un,Ss,b,ki,!0,ht,Dr,Fe,Kr,Mr,yt.getProjection()):yd(Gt.kind,Xt,pe,be,f,gr,Un,Ss,b,ki,ht,Dr,Fe,Kr,Mr,yt.getProjection());const fc={program:f.useProgram(ec(Mt,b,yt),at,qn),buffers:jt,uniformValues:Ea,atlasTexture:Ni,atlasTextureIcon:Hi,atlasInterpolation:bi,atlasInterpolationIcon:Li,isSDF:Mt,hasHalo:uu,tile:Ct,labelPlaneMatrixInv:ns};if(Ce&&yt.canOverlap){Ie=!0;const Ko=jt.segments.get();for(const Sa of Ko)et.push({segments:new s.SegmentVector([Sa]),sortKey:Sa.sortKey,state:fc})}else et.push({segments:jt.segments,sortKey:0,state:fc})}Ie&&et.sort((ht,Ct)=>ht.sortKey-Ct.sortKey);for(const ht of et){const Ct=ht.state;if(f.terrain&&f.terrain.setupElevationDraw(Ct.tile,Ct.program,{useDepthForOcclusion:!it,labelPlaneMatrixInv:Ct.labelPlaneMatrixInv}),he.activeTexture.set(me.TEXTURE0),Ct.atlasTexture.bind(Ct.atlasInterpolation,me.CLAMP_TO_EDGE),Ct.atlasTextureIcon&&(he.activeTexture.set(me.TEXTURE1),Ct.atlasTextureIcon&&Ct.atlasTextureIcon.bind(Ct.atlasInterpolationIcon,me.CLAMP_TO_EDGE)),Ct.isSDF){const yt=Ct.uniformValues;Ct.hasHalo&&(yt.u_is_halo=1,Yc(Ct.buffers,ht.segments,c,f,Ct.program,Ge,H,Q,yt)),yt.u_is_halo=0}Yc(Ct.buffers,ht.segments,c,f,Ct.program,Ge,H,Q,Ct.uniformValues)}}function Yc(f,n,c,g,b,E,L,D,F){const W=g.context,H=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];b.draw(W,W.gl.TRIANGLES,E,L,D,s.CullFaceMode.disabled,F,c.id,f.layoutVertexBuffer,f.indexBuffer,n,c.paint,g.transform.zoom,f.programConfigurations.get(c.id),H)}function Td(f,n,c,g,b,E,L){const D=f.context.gl,F=c.paint.get("fill-pattern"),W=F&&F.constantOr(1);let H,Q,he,me,ye;L?(Q=W&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=D.LINES):(Q=W?"fillPattern":"fill",H=D.TRIANGLES);for(const _e of g){const be=n.getTile(_e);if(W&&!be.patternsLoaded())continue;const ee=be.getBucket(c);if(!ee)continue;f.prepareDrawTile();const pe=ee.programConfigurations.get(c.id),Ce=f.useProgram(Q,pe);W&&(f.context.activeTexture.set(D.TEXTURE0),be.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),pe.updatePaintBuffers());const Ie=F.constantOr(null);if(Ie&&be.imageAtlas){const Fe=be.imageAtlas.patternPositions[Ie.toString()];Fe&&pe.setConstantPatternPositions(Fe)}const Ge=f.translatePosMatrix(_e.projMatrix,be,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(L){me=ee.indexBuffer2,ye=ee.segments2;const Fe=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];he=Q==="fillOutlinePattern"&&W?gd(Ge,f,be,Fe):md(Ge,Fe)}else me=ee.indexBuffer,ye=ee.segments,he=W?pd(Ge,f,be):dl(Ge);f.prepareDrawProgram(f.context,Ce,_e.toUnwrapped()),Ce.draw(f.context,H,b,f.stencilModeForClipping(_e),E,s.CullFaceMode.disabled,he,c.id,ee.layoutVertexBuffer,me,ye,c.paint,f.transform.zoom,pe)}}function eu(f,n,c,g,b,E,L){const D=f.context,F=D.gl,W=f.transform,H=c.paint.get("fill-extrusion-pattern"),Q=H.constantOr(1),he=c.paint.get("fill-extrusion-opacity"),me=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],ye=c.layout.get("fill-extrusion-edge-radius"),_e=ye>0&&!c.paint.get("fill-extrusion-rounded-roof"),be=_e?0:ye,ee=W.projection.name==="globe"?s.fillExtrusionHeightLift():0,pe=W.projection.name==="globe",Ce=pe?s.globeToMercatorTransition(W.zoom):0,Ie=[s.mercatorXfromLng(W.center.lng),s.mercatorYfromLat(W.center.lat)],Ge=[];pe&&Ge.push("PROJECTION_GLOBE_VIEW"),me[0]>0&&Ge.push("FAUX_AO"),_e&&Ge.push("ZERO_ROOF_RADIUS");for(const Fe of g){const We=n.getTile(Fe),it=We.getBucket(c);if(!it||it.projection.name!==W.projection.name)continue;const et=it.programConfigurations.get(c.id),pt=f.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",et,Ge);if(f.terrain){const Mt=f.terrain;if(f.style.terrainSetForDrapingOnly())Mt.setupElevationDraw(We,pt,{useMeterToDem:!0});else{if(!it.enableTerrain)continue;if(Mt.setupElevationDraw(We,pt,{useMeterToDem:!0}),gl(D,n,Fe,it,c,Mt),!it.centroidVertexBuffer){const Gt=pt.attributes.a_centroid_pos;Gt!==void 0&&F.vertexAttrib2f(Gt,0,0)}}}Q&&(f.context.activeTexture.set(F.TEXTURE0),We.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),et.updatePaintBuffers());const Nt=H.constantOr(null);if(Nt&&We.imageAtlas){const Mt=We.imageAtlas.patternPositions[Nt.toString()];Mt&&et.setConstantPatternPositions(Mt)}const ht=f.translatePosMatrix(Fe.projMatrix,We,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ct=W.projection.createInversionMatrix(W,Fe.canonical),yt=c.paint.get("fill-extrusion-vertical-gradient"),jt=Q?Gf(ht,f,yt,he,me,be,Fe,We,ee,Ce,Ie,Ct):Zh(ht,f,yt,he,me,be,Fe,ee,Ce,Ie,Ct);f.prepareDrawProgram(D,pt,Fe.toUnwrapped());const at=[];f.terrain&&at.push(it.centroidVertexBuffer),pe&&at.push(it.layoutVertexExtBuffer),pt.draw(D,D.gl.TRIANGLES,b,E,L,s.CullFaceMode.backCCW,jt,c.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,c.paint,f.transform.zoom,et,at)}}function gl(f,n,c,g,b,E){const L=[ee=>{let pe=ee.canonical.x-1,Ce=ee.wrap;return pe<0&&(pe=(1<<ee.canonical.z)-1,Ce--),new s.OverscaledTileID(ee.overscaledZ,Ce,ee.canonical.z,pe,ee.canonical.y)},ee=>{let pe=ee.canonical.x+1,Ce=ee.wrap;return pe===1<<ee.canonical.z&&(pe=0,Ce++),new s.OverscaledTileID(ee.overscaledZ,Ce,ee.canonical.z,pe,ee.canonical.y)},ee=>new s.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,(ee.canonical.y===0?1<<ee.canonical.z:ee.canonical.y)-1),ee=>new s.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y===(1<<ee.canonical.z)-1?0:ee.canonical.y+1)],D=ee=>{const pe=n.getSource().minzoom,Ce=Ge=>{const Fe=n.getTileByID(Ge);if(Fe&&Fe.hasData())return Fe.getBucket(b)},Ie=[0,-1,1];for(const Ge of Ie){if(ee.overscaledZ+Ge<pe)continue;const Fe=Ce(ee.calculateScaledKey(ee.overscaledZ+Ge));if(Fe)return Fe}},F=[0,0,0],W=(ee,pe)=>(F[0]=Math.min(ee.min.y,pe.min.y),F[1]=Math.max(ee.max.y,pe.max.y),F[2]=s.EXTENT-pe.min.x>ee.max.x?pe.min.x-s.EXTENT:ee.max.x,F),H=(ee,pe)=>(F[0]=Math.min(ee.min.x,pe.min.x),F[1]=Math.max(ee.max.x,pe.max.x),F[2]=s.EXTENT-pe.min.y>ee.max.y?pe.min.y-s.EXTENT:ee.max.y,F),Q=[(ee,pe)=>W(ee,pe),(ee,pe)=>W(pe,ee),(ee,pe)=>H(ee,pe),(ee,pe)=>H(pe,ee)],he=new s.Point(0,0);let me,ye,_e;const be=(ee,pe,Ce,Ie,Ge)=>{const Fe=[[Ie?Ce:ee,Ie?ee:Ce,0],[Ie?Ce:pe,Ie?pe:Ce,0]],We=Ge<0?s.EXTENT+Ge:Ge,it=[Ie?We:(ee+pe)/2,Ie?(ee+pe)/2:We,0];return Ce===0&&Ge<0||Ce!==0&&Ge>0?E.getForTilePoints(_e,[it],!0,ye):Fe.push(it),E.getForTilePoints(c,Fe,!0,me),Math.max(Fe[0][2],Fe[1][2],it[2])/E.exaggeration()};for(let ee=0;ee<4;ee++){const pe=(ee<2?1:5)-ee,Ce=g.borders[ee];if(Ce.length===0)continue;const Ie=_e=L[ee](c),Ge=D(Ie);if(!(Ge&&Ge instanceof s.FillExtrusionBucket&&Ge.enableTerrain)||g.borderDoneWithNeighborZ[ee]===Ge.canonical.z&&Ge.borderDoneWithNeighborZ[pe]===g.canonical.z||(ye=E.findDEMTileFor(Ie),!ye||!ye.dem))continue;if(!me){const et=E.findDEMTileFor(c);if(!et||!et.dem)return;me=et}const Fe=Ge.borders[pe];let We=0;const it=Ge.borderDoneWithNeighborZ[pe]!==g.canonical.z;if(g.canonical.z===Ge.canonical.z){for(let et=0;et<Ce.length;et++){const pt=g.featuresOnBorder[Ce[et]],Nt=pt.borders[ee];let ht;for(;We<Fe.length&&(ht=Ge.featuresOnBorder[Fe[We]],!(ht.borders[pe][1]>Nt[0]+3));)it&&Ge.encodeCentroid(void 0,ht,!1),We++;if(ht&&We<Fe.length){const Ct=We;let yt=0;for(;!(ht.borders[pe][0]>Nt[1]-3)&&(yt++,++We!==Fe.length);)ht=Ge.featuresOnBorder[Fe[We]];if(ht=Ge.featuresOnBorder[Fe[Ct]],pt.intersectsCount()>1||ht.intersectsCount()>1||yt!==1){yt!==1&&(We=Ct),g.encodeCentroid(void 0,pt,!1),it&&Ge.encodeCentroid(void 0,ht,!1);continue}const jt=Q[ee](pt,ht),at=ee%2?s.EXTENT-1:0;he.x=be(jt[0],Math.min(s.EXTENT-1,jt[1]),at,ee<2,jt[2]),he.y=0,g.encodeCentroid(he,pt,!1),it&&Ge.encodeCentroid(he,ht,!1)}else g.encodeCentroid(void 0,pt,!1)}g.borderDoneWithNeighborZ[ee]=Ge.canonical.z,g.needsCentroidUpdate=!0,it&&(Ge.borderDoneWithNeighborZ[pe]=g.canonical.z,Ge.needsCentroidUpdate=!0)}else{for(const et of Ce)g.encodeCentroid(void 0,g.featuresOnBorder[et],!1);if(it){for(const et of Fe)Ge.encodeCentroid(void 0,Ge.featuresOnBorder[et],!1);Ge.borderDoneWithNeighborZ[pe]=g.canonical.z,Ge.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[ee]=Ge.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(f)}const to=new s.Color(1,0,0,1),Sm=new s.Color(0,1,0,1),Cm=new s.Color(0,0,1,1),Am=new s.Color(1,0,1,1),Mm=new s.Color(0,1,1,1);function Im(f,n,c){const g=f.context,b=f.transform,E=g.gl,L=b.projection.name==="globe",D=L?["PROJECTION_GLOBE_VIEW"]:null;let F=c.projMatrix;if(L&&s.globeToMercatorTransition(b.zoom)>0){const pt=s.transitionTileAABBinECEF(c.canonical,b),Nt=s.globeDenormalizeECEF(pt);F=s.multiply(new Float32Array(16),b.globeMatrix,Nt),s.multiply(F,b.projMatrix,F)}const W=f.useProgram("debug",null,D),H=n.getTileByID(c.key);f.terrain&&f.terrain.setupElevationDraw(H,W);const Q=s.DepthMode.disabled,he=s.StencilMode.disabled,me=f.colorModeForRenderPass(),ye="$debug";g.activeTexture.set(E.TEXTURE0),f.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),L?H._makeGlobeTileDebugBuffers(f.context,b):H._makeDebugTileBoundsBuffers(f.context,b.projection);const _e=H._tileDebugBuffer||f.debugBuffer,be=H._tileDebugIndexBuffer||f.debugIndexBuffer,ee=H._tileDebugSegments||f.debugSegments;W.draw(g,E.LINE_STRIP,Q,he,me,s.CullFaceMode.disabled,fl(F,s.Color.red),ye,_e,be,ee,null,null,null,[H._globeTileDebugBorderBuffer]);const pe=H.latestRawTileData,Ce=Math.floor((pe&&pe.byteLength||0)/1024),Ie=n.getTile(c).tileSize,Ge=512/Math.min(Ie,512)*(c.overscaledZ/b.zoom)*.5;let Fe=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Fe+=` => ${c.overscaledZ}`),Fe+=` ${Ce}kb`,function(pt,Nt){pt.initDebugOverlayCanvas();const ht=pt.debugOverlayCanvas,Ct=pt.context.gl,yt=pt.debugOverlayCanvas.getContext("2d");yt.clearRect(0,0,ht.width,ht.height),yt.shadowColor="white",yt.shadowBlur=2,yt.lineWidth=1.5,yt.strokeStyle="white",yt.textBaseline="top",yt.font="bold 36px Open Sans, sans-serif",yt.fillText(Nt,5,5),yt.strokeText(Nt,5,5),pt.debugOverlayTexture.update(ht),pt.debugOverlayTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE)}(f,Fe);const We=H._tileDebugTextBuffer||f.debugBuffer,it=H._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,et=H._tileDebugTextSegments||f.debugSegments;W.draw(g,E.TRIANGLES,Q,he,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,fl(F,s.Color.transparent,Ge),ye,We,it,et,null,null,null,[H._globeTileDebugTextBuffer])}function Kc(f,n,c,g){ic(f,0,n+c/2,f.transform.width,c,g)}function tc(f,n,c,g){ic(f,n-c/2,0,c,f.transform.height,g)}function ic(f,n,c,g,b,E){const L=f.context,D=L.gl;D.enable(D.SCISSOR_TEST),D.scissor(n*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,g*s.exported.devicePixelRatio,b*s.exported.devicePixelRatio),L.clear({color:E}),D.disable(D.SCISSOR_TEST)}const Jc=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:tu}=Jc;function va(f,n,c,g){f.emplaceBack(n,c,g)}class Qc{constructor(n){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,va(this.vertexArray,-1,-1,1),va(this.vertexArray,1,-1,1),va(this.vertexArray,-1,1,1),va(this.vertexArray,1,1,1),va(this.vertexArray,-1,-1,-1),va(this.vertexArray,1,-1,-1),va(this.vertexArray,-1,1,-1),va(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,tu),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function ps(f,n,c,g,b,E){const L=f.gl,D=n.paint.get("sky-atmosphere-color"),F=n.paint.get("sky-atmosphere-halo-color"),W=n.paint.get("sky-atmosphere-sun-intensity"),H=((Q,he,me,ye,_e)=>({u_matrix_3f:Q,u_sun_direction:he,u_sun_intensity:me,u_color_tint_r:[ye.r,ye.g,ye.b,ye.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),g),b,W,D,F);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+E,n.skyboxTexture,0),c.draw(f,L.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,H,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const eh=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class th{constructor(n){const c=new s.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const g=new s.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(c,eh.members),this.indexBuffer=n.createIndexBuffer(g),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const _l={symbol:function(f,n,c,g,b){if(f.renderPass!=="translucent")return;const E=s.StencilMode.disabled,L=f.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(D,F,W,H,Q,he,me){const ye=F.transform,_e=Q==="map",be=he==="map";for(const ee of D){const pe=H.getTile(ee),Ce=pe.getBucket(W);if(!Ce||!Ce.text||!Ce.text.segments.get().length)continue;const Ie=s.evaluateSizeForZoom(Ce.textSizeData,ye.zoom),Ge=on(ee,Ce.getProjection(),ye),Fe=ye.calculatePixelsToTileUnitsMatrix(pe),We=wt(Ge,pe.tileID.canonical,be,_e,ye,Ce.getProjection(),Fe),it=W.layout.get("icon-text-fit")!=="none"&&Ce.hasIconData();if(Ie){const et=Math.pow(2,ye.zoom-pe.tileID.overscaledZ);Em(Ce,_e,be,me,s.symbolSize,ye,We,ee,et,Ie,it)}}}(g,f,c,n,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),b),c.paint.get("icon-opacity").constantOr(1)!==0&&Hf(f,n,c,g,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),E,L),c.paint.get("text-opacity").constantOr(1)!==0&&Hf(f,n,c,g,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),E,L),n.map.showCollisionBoxes&&(Zc(f,n,c,g,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Zc(f,n,c,g,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(f,n,c,g){if(f.renderPass!=="translucent")return;const b=c.paint.get("circle-opacity"),E=c.paint.get("circle-stroke-width"),L=c.paint.get("circle-stroke-opacity"),D=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(b.constantOr(1)===0&&(E.constantOr(1)===0||L.constantOr(1)===0))return;const F=f.context,W=F.gl,H=f.transform,Q=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),he=s.StencilMode.disabled,me=f.colorModeForRenderPass(),ye=H.projection.name==="globe",_e=[s.mercatorXfromLng(H.center.lng),s.mercatorYfromLat(H.center.lat)],be=[];for(let pe=0;pe<g.length;pe++){const Ce=g[pe],Ie=n.getTile(Ce),Ge=Ie.getBucket(c);if(!Ge||Ge.projection.name!==H.projection.name)continue;const Fe=Ge.programConfigurations.get(c.id),We=_d(c);ye&&We.push("PROJECTION_GLOBE_VIEW");const it=f.useProgram("circle",Fe,We),et=Ge.layoutVertexBuffer,pt=Ge.globeExtVertexBuffer,Nt=Ge.indexBuffer,ht=H.projection.createInversionMatrix(H,Ce.canonical),Ct={programConfiguration:Fe,program:it,layoutVertexBuffer:et,globeExtVertexBuffer:pt,indexBuffer:Nt,uniformValues:Ql(f,Ce,Ie,ht,_e,c),tile:Ie};if(D){const yt=Ge.segments.get();for(const jt of yt)be.push({segments:new s.SegmentVector([jt]),sortKey:jt.sortKey,state:Ct})}else be.push({segments:Ge.segments,sortKey:0,state:Ct})}D&&be.sort((pe,Ce)=>pe.sortKey-Ce.sortKey);const ee={useDepthForOcclusion:!ye};for(const pe of be){const{programConfiguration:Ce,program:Ie,layoutVertexBuffer:Ge,globeExtVertexBuffer:Fe,indexBuffer:We,uniformValues:it,tile:et}=pe.state,pt=pe.segments;f.terrain&&f.terrain.setupElevationDraw(et,Ie,ee),f.prepareDrawProgram(F,Ie,et.tileID.toUnwrapped()),Ie.draw(F,W.TRIANGLES,Q,he,me,s.CullFaceMode.disabled,it,c.id,Ge,We,pt,c.paint,H.zoom,Ce,[Fe])}},heatmap:function(f,n,c,g){if(c.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const b=f.context,E=b.gl,L=s.StencilMode.disabled,D=new s.ColorMode([E.ONE,E.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(me,ye,_e,be){const ee=me.gl,pe=ye.width*be,Ce=ye.height*be;me.activeTexture.set(ee.TEXTURE1),me.viewport.set([0,0,pe,Ce]);let Ie=_e.heatmapFbo;if(!Ie||Ie&&(Ie.width!==pe||Ie.height!==Ce)){Ie&&Ie.destroy();const Ge=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,Ge),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),Ie=_e.heatmapFbo=me.createFramebuffer(pe,Ce,!1),function(Fe,We,it,et,pt,Nt){const ht=Fe.gl;ht.texImage2D(ht.TEXTURE_2D,0,Fe.isWebGL2&&Fe.extRenderToTextureHalfFloat?ht.RGBA16F:ht.RGBA,pt,Nt,0,ht.RGBA,Fe.extRenderToTextureHalfFloat?Fe.isWebGL2?ht.HALF_FLOAT:Fe.extTextureHalfFloat.HALF_FLOAT_OES:ht.UNSIGNED_BYTE,null),et.colorAttachment.set(it)}(me,0,Ge,Ie,pe,Ce)}else ee.bindTexture(ee.TEXTURE_2D,Ie.colorAttachment.get()),me.bindFramebuffer.set(Ie.framebuffer)})(b,f,c,f.transform.projection.name==="globe"?.5:.25),b.clear({color:s.Color.transparent});const F=f.transform,W=F.projection.name==="globe",H=W?["PROJECTION_GLOBE_VIEW"]:null,Q=W?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,he=[s.mercatorXfromLng(F.center.lng),s.mercatorYfromLat(F.center.lat)];for(let me=0;me<g.length;me++){const ye=g[me];if(n.hasRenderableParent(ye))continue;const _e=n.getTile(ye),be=_e.getBucket(c);if(!be||be.projection.name!==F.projection.name)continue;const ee=be.programConfigurations.get(c.id),pe=f.useProgram("heatmap",ee,H),{zoom:Ce}=f.transform;f.terrain&&f.terrain.setupElevationDraw(_e,pe),f.prepareDrawProgram(b,pe,ye.toUnwrapped());const Ie=F.projection.createInversionMatrix(F,ye.canonical);pe.draw(b,E.TRIANGLES,s.DepthMode.disabled,L,D,Q,Wf(f,ye,_e,Ie,he,Ce,c.paint.get("heatmap-intensity")),c.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,c.paint,f.transform.zoom,ee,W?[be.globeExtVertexBuffer]:null)}b.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(b,E){const L=b.context,D=L.gl,F=E.heatmapFbo;if(!F)return;L.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,F.colorAttachment.get()),L.activeTexture.set(D.TEXTURE1);let W=E.colorRampTexture;W||(W=E.colorRampTexture=new s.Texture(L,E.colorRamp,D.RGBA)),W.bind(D.LINEAR,D.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(L,D.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,b.colorModeForRenderPass(),s.CullFaceMode.disabled,((H,Q,he,me)=>({u_image:0,u_color_ramp:1,u_opacity:Q.paint.get("heatmap-opacity")}))(0,E),E.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,E.paint,b.transform.zoom)}(f,c))},line:function(f,n,c,g){if(f.renderPass!=="translucent")return;const b=c.paint.get("line-opacity"),E=c.paint.get("line-width");if(b.constantOr(1)===0||E.constantOr(1)===0)return;const L=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),D=f.colorModeForRenderPass(),F=f.terrain&&f.terrain.renderingToTexture?1:s.exported.devicePixelRatio,W=c.paint.get("line-dasharray"),H=W.constantOr(1),Q=c.layout.get("line-cap"),he=c.paint.get("line-pattern"),me=he.constantOr(1),ye=c.paint.get("line-gradient"),_e=me?"linePattern":"line",be=f.context,ee=be.gl,pe=(Ie=>{const Ge=[];Hc(Ie)&&Ge.push("RENDER_LINE_DASH"),Ie.paint.get("line-gradient")&&Ge.push("RENDER_LINE_GRADIENT");const Fe=Ie.paint.get("line-trim-offset");Fe[0]===0&&Fe[1]===0||Ge.push("RENDER_LINE_TRIM_OFFSET");const We=Ie.paint.get("line-pattern").constantOr(1),it=Ie.paint.get("line-opacity").constantOr(1)!==1;return!We&&it&&Ge.push("RENDER_LINE_ALPHA_DISCARD"),Ge})(c);let Ce=pe.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(Ce=!1);for(const Ie of g){const Ge=n.getTile(Ie);if(me&&!Ge.patternsLoaded())continue;const Fe=Ge.getBucket(c);if(!Fe)continue;f.prepareDrawTile();const We=Fe.programConfigurations.get(c.id),it=f.useProgram(_e,We,pe),et=he.constantOr(null);if(et&&Ge.imageAtlas){const Mt=Ge.imageAtlas.patternPositions[et.toString()];Mt&&We.setConstantPatternPositions(Mt)}const pt=W.constantOr(null),Nt=Q.constantOr(null);if(!me&&pt&&Nt&&Ge.lineAtlas){const Mt=Ge.lineAtlas.getDash(pt,Nt);Mt&&We.setConstantPatternPositions(Mt)}let[ht,Ct]=c.paint.get("line-trim-offset");(Nt==="round"||Nt==="square")&&ht!==Ct&&(ht===0&&(ht-=1),Ct===1&&(Ct+=1));const yt=f.terrain?Ie.projMatrix:null,jt=me?Wc(f,Ge,c,yt,F):pl(f,Ge,c,yt,Fe.lineClipsArray.length,F,[ht,Ct]);if(ye){const Mt=Fe.gradients[c.id];let Gt=Mt.texture;if(c.gradientVersion!==Mt.version){let Et=256;if(c.stepInterpolant){const Xt=n.getSource().maxzoom,ki=Ie.canonical.z===Xt?Math.ceil(1<<f.transform.maxZoom-Ie.canonical.z):1;Et=s.clamp(s.nextPowerOfTwo(Fe.maxLineLength/s.EXTENT*1024*ki),256,be.maxTextureSize)}Mt.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Et,image:Mt.gradient||void 0,clips:Fe.lineClipsArray}),Mt.texture?Mt.texture.update(Mt.gradient):Mt.texture=new s.Texture(be,Mt.gradient,ee.RGBA),Mt.version=c.gradientVersion,Gt=Mt.texture}be.activeTexture.set(ee.TEXTURE1),Gt.bind(c.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}H&&(be.activeTexture.set(ee.TEXTURE0),Ge.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),We.updatePaintBuffers()),me&&(be.activeTexture.set(ee.TEXTURE0),Ge.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),We.updatePaintBuffers()),f.prepareDrawProgram(be,it,Ie.toUnwrapped());const at=Mt=>{it.draw(be,ee.TRIANGLES,L,Mt,D,s.CullFaceMode.disabled,jt,c.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,c.paint,f.transform.zoom,We,[Fe.layoutVertexBuffer2])};if(Ce){const Mt=f.stencilModeForClipping(Ie).ref;Mt===0&&f.terrain&&be.clear({stencil:0});const Gt={func:ee.EQUAL,mask:255};jt.u_alpha_discard_threshold=.8,at(new s.StencilMode(Gt,Mt,255,ee.KEEP,ee.KEEP,ee.INVERT)),jt.u_alpha_discard_threshold=0,at(new s.StencilMode(Gt,Mt,255,ee.KEEP,ee.KEEP,ee.KEEP))}else at(f.stencilModeForClipping(Ie))}Ce&&(f.resetStencilClippingMasks(),f.terrain&&be.clear({stencil:0}))},fill:function(f,n,c,g){const b=c.paint.get("fill-color"),E=c.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const L=f.colorModeForRenderPass(),D=c.paint.get("fill-pattern"),F=f.opaquePassEnabledForLayer()&&!D.constantOr(1)&&b.constantOr(s.Color.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===F){const W=f.depthModeForSublayer(1,f.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Td(f,n,c,g,W,L,!1)}if(f.renderPass==="translucent"&&c.paint.get("fill-antialias")){const W=f.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Td(f,n,c,g,W,L,!0)}},"fill-extrusion":function(f,n,c,g){const b=c.paint.get("fill-extrusion-opacity");if(b!==0&&f.renderPass==="translucent"){const E=new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D);if(b!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))eu(f,n,c,g,E,s.StencilMode.disabled,s.ColorMode.disabled),eu(f,n,c,g,E,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const L=f.colorModeForRenderPass();eu(f,n,c,g,E,s.StencilMode.disabled,L)}}},hillshade:function(f,n,c,g){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const b=f.context,E=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),L=f.colorModeForRenderPass(),D=f.terrain&&f.terrain.renderingToTexture,[F,W]=f.renderPass!=="translucent"||D?[{},g]:f.stencilConfigForOverlap(g);for(const H of W){const Q=n.getTile(H);if(Q.needsHillshadePrepare&&f.renderPass==="offscreen")$h(f,Q,c,E,s.StencilMode.disabled,L);else if(f.renderPass==="translucent"){const he=D&&f.terrain?f.terrain.stencilModeForRTTOverlap(H):F[H.overscaledZ];hd(f,H,Q,c,E,he,L)}}b.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,n,c,g,b,E){if(f.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!g.length)return;const L=f.context,D=L.gl,F=n.getSource(),W=f.useProgram("raster"),H=f.colorModeForRenderPass(),Q=f.terrain&&f.terrain.renderingToTexture,[he,me]=F instanceof zi||Q?[{},g]:f.stencilConfigForOverlap(g),ye=me[me.length-1].overscaledZ,_e=!f.options.moving;for(const be of me){const ee=Q?s.DepthMode.disabled:f.depthModeForSublayer(be.overscaledZ-ye,c.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,D.LESS),pe=be.toUnwrapped(),Ce=n.getTile(be);if(Q&&(!Ce||!Ce.hasData()))continue;const Ie=Q?be.projMatrix:f.transform.calculateProjMatrix(pe,_e),Ge=f.terrain&&Q?f.terrain.stencilModeForRTTOverlap(be):he[be.overscaledZ],Fe=E?0:c.paint.get("raster-fade-duration");Ce.registerFadeDuration(Fe);const We=n.findLoadedParent(be,0),it=ud(Ce,We,n,f.transform,Fe);let et,pt;f.terrain&&f.terrain.prepareDrawTile();const Nt=c.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;L.activeTexture.set(D.TEXTURE0),Ce.texture.bind(Nt,D.CLAMP_TO_EDGE),L.activeTexture.set(D.TEXTURE1),We?(We.texture.bind(Nt,D.CLAMP_TO_EDGE),et=Math.pow(2,We.tileID.overscaledZ-Ce.tileID.overscaledZ),pt=[Ce.tileID.canonical.x*et%1,Ce.tileID.canonical.y*et%1]):Ce.texture.bind(Nt,D.CLAMP_TO_EDGE),Ce.texture.useMipmap&&L.extTextureFilterAnisotropic&&f.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);const ht=qc(Ie,pt||[0,0],et||1,it,c,F instanceof zi?F.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(L,W,pe),F instanceof zi)F.boundsBuffer&&F.boundsSegments&&W.draw(L,D.TRIANGLES,ee,s.StencilMode.disabled,H,s.CullFaceMode.disabled,ht,c.id,F.boundsBuffer,f.quadTriangleIndexBuffer,F.boundsSegments);else{const{tileBoundsBuffer:Ct,tileBoundsIndexBuffer:yt,tileBoundsSegments:jt}=f.getTileBoundsBuffers(Ce);W.draw(L,D.TRIANGLES,ee,Ge,H,s.CullFaceMode.disabled,ht,c.id,Ct,yt,jt)}}f.resetStencilClippingMasks()},background:function(f,n,c,g){const b=c.paint.get("background-color"),E=c.paint.get("background-opacity");if(E===0)return;const L=f.context,D=L.gl,F=f.transform,W=F.tileSize,H=c.paint.get("background-pattern");if(f.isPatternMissing(H))return;const Q=!H&&b.a===1&&E===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==Q)return;const he=s.StencilMode.disabled,me=f.depthModeForSublayer(0,Q==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),ye=f.colorModeForRenderPass(),_e=f.useProgram(H?"backgroundPattern":"background");let be,ee=g;ee||(be=f.getBackgroundTiles(),ee=Object.values(be).map(pe=>pe.tileID)),H&&(L.activeTexture.set(D.TEXTURE0),f.imageManager.bind(f.context));for(const pe of ee){const Ce=pe.toUnwrapped(),Ie=g?pe.projMatrix:f.transform.calculateProjMatrix(Ce);f.prepareDrawTile();const Ge=n?n.getTile(pe):be?be[pe.key]:new s.Tile(pe,W,F.zoom,f),Fe=H?Tm(Ie,E,f,H,{tileID:pe,tileSize:W}):xd(Ie,E,b);f.prepareDrawProgram(L,_e,Ce);const{tileBoundsBuffer:We,tileBoundsIndexBuffer:it,tileBoundsSegments:et}=f.getTileBoundsBuffers(Ge);_e.draw(L,D.TRIANGLES,me,he,ye,s.CullFaceMode.disabled,Fe,c.id,We,it,et)}},sky:function(f,n,c){const g=f.transform,b=g.projection.name==="mercator"||g.projection.name==="globe"?1:s.smoothstep(7,8,g.zoom),E=c.paint.get("sky-opacity")*b;if(E===0)return;const L=f.context,D=c.paint.get("sky-type"),F=new s.DepthMode(L.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),W=f.frameCounter/1e3%1;D==="atmosphere"?f.renderPass==="offscreen"?c.needsSkyboxCapture(f)&&(function(H,Q,he,me){const ye=H.context,_e=ye.gl;let be=Q.skyboxFbo;if(!be){be=Q.skyboxFbo=ye.createFramebuffer(32,32,!1),Q.skyboxGeometry=new Qc(ye),Q.skyboxTexture=ye.gl.createTexture(),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Q.skyboxTexture),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MAG_FILTER,_e.LINEAR);for(let Ie=0;Ie<6;++Ie)_e.texImage2D(_e.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,_e.RGBA,32,32,0,_e.RGBA,_e.UNSIGNED_BYTE,null)}ye.bindFramebuffer.set(be.framebuffer),ye.viewport.set([0,0,32,32]);const ee=Q.getCenter(H,!0),pe=H.useProgram("skyboxCapture"),Ce=new Float64Array(16);s.identity(Ce),s.rotateY(Ce,Ce,.5*-Math.PI),ps(ye,Q,pe,Ce,ee,0),s.identity(Ce),s.rotateY(Ce,Ce,.5*Math.PI),ps(ye,Q,pe,Ce,ee,1),s.identity(Ce),s.rotateX(Ce,Ce,.5*-Math.PI),ps(ye,Q,pe,Ce,ee,2),s.identity(Ce),s.rotateX(Ce,Ce,.5*Math.PI),ps(ye,Q,pe,Ce,ee,3),s.identity(Ce),ps(ye,Q,pe,Ce,ee,4),s.identity(Ce),s.rotateY(Ce,Ce,Math.PI),ps(ye,Q,pe,Ce,ee,5),ye.viewport.set([0,0,H.width,H.height])}(f,c),c.markSkyboxValid(f)):f.renderPass==="sky"&&function(H,Q,he,me,ye){const _e=H.context,be=_e.gl,ee=H.transform,pe=H.useProgram("skybox");_e.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_CUBE_MAP,Q.skyboxTexture);const Ce=((Ie,Ge,Fe,We,it)=>({u_matrix:Ie,u_sun_direction:Ge,u_cubemap:0,u_opacity:We,u_temporal_offset:it}))(ee.skyboxMatrix,Q.getCenter(H,!1),0,me,ye);H.prepareDrawProgram(_e,pe),pe.draw(_e,be.TRIANGLES,he,s.StencilMode.disabled,H.colorModeForRenderPass(),s.CullFaceMode.backCW,Ce,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(f,c,F,E,W):D==="gradient"&&f.renderPass==="sky"&&function(H,Q,he,me,ye){const _e=H.context,be=_e.gl,ee=H.transform,pe=H.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Qc(_e)),_e.activeTexture.set(be.TEXTURE0);let Ce=Q.colorRampTexture;Ce||(Ce=Q.colorRampTexture=new s.Texture(_e,Q.colorRamp,be.RGBA)),Ce.bind(be.LINEAR,be.CLAMP_TO_EDGE);const Ie=((Ge,Fe,We,it,et)=>({u_matrix:Ge,u_color_ramp:0,u_center_direction:Fe,u_radius:s.degToRad(We),u_opacity:it,u_temporal_offset:et}))(ee.skyboxMatrix,Q.getCenter(H,!1),Q.paint.get("sky-gradient-radius"),me,ye);H.prepareDrawProgram(_e,pe),pe.draw(_e,be.TRIANGLES,he,s.StencilMode.disabled,H.colorModeForRenderPass(),s.CullFaceMode.backCW,Ie,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(f,c,F,E,W)},debug:function(f,n,c){for(let g=0;g<c.length;g++)Im(f,n,c[g])},custom:function(f,n,c,g){const b=f.context,E=c.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&c.isLayerDraped()){if(f.renderPass==="offscreen"){const L=E.prerender;if(L){if(f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const D=f.transform.pointMerc;L.call(E,b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[D.x,D.y],f.transform.pixelsPerMeterRatio)}else L.call(E,b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const D=E.renderToTile;if(D){const F=g[0].canonical,W=new s.MercatorCoordinate(F.x+g[0].wrap*(1<<F.z),F.y,F.z);b.setDepthMode(s.DepthMode.disabled),b.setStencilMode(s.StencilMode.disabled),b.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),D.call(E,b.gl,W),b.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),b.setStencilMode(s.StencilMode.disabled);const L=E.renderingMode==="3d"?new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(b.setDepthMode(L),f.transform.projection.name==="globe"){const D=f.transform.pointMerc;E.render(b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[D.x,D.y],f.transform.pixelsPerMeterRatio)}else E.render(b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState(),b.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class rc{constructor(n,c,g=!1){this.context=new Qt(n,g),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(n,c){const g=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new dd(this,n));const b=this._terrain;this.transform.elevation=g?b:null,b.update(n,this.transform,c)}_updateFog(n){const c=n.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,b]=c.getFovAdjustedRange(this.transform._fov);if(g>b)return void(this.transform.fogCullDistSq=null);const E=g+.78*(b-g);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(n,c){if(this.width=n*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const n=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const g=new s.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(s.EXTENT,0),g.emplaceBack(0,s.EXTENT),g.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=n.createVertexBuffer(g,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const b=new s.StructArrayLayout2i4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(b,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const E=new s.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(s.EXTENT,0,s.EXTENT,0),E.emplaceBack(0,s.EXTENT,0,s.EXTENT),E.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=n.createVertexBuffer(E,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const L=new s.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(L);const D=new s.StructArrayLayout1ui2;for(const W of[0,1,3,2,0])D.emplaceBack(W);this.debugIndexBuffer=n.createIndexBuffer(D),this.emptyTexture=new s.Texture(n,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA),this.identityMat=s.create();const F=this.context.gl;this.stencilClearMode=new s.StencilMode({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new th(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context,c=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(n,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,$c(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,c,g){if(!c||this.currentStencilSource===c.id||!n.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const F of g)if(this._tileClippingMaskIDs[F.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=c.id;const b=this.context,E=b.gl;this.nextStencilID+g.length>256&&this.clearStencil(),b.setColorMode(s.ColorMode.disabled),b.setDepthMode(s.DepthMode.disabled);const L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of g){const F=c.getTile(D),W=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:Q,tileBoundsSegments:he}=this.getTileBoundsBuffers(F);L.draw(b,E.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:E.ALWAYS,mask:0},W,255,E.KEEP,E.KEEP,E.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,$c(D.projMatrix),"$clipping",H,Q,he)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},n,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(n){const c=this.context.gl,g=n.sort((L,D)=>D.overscaledZ-L.overscaledZ),b=g[g.length-1].overscaledZ,E=g[0].overscaledZ-b+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const L={};for(let D=0;D<E;D++)L[D+b]=new s.StencilMode({func:c.GEQUAL,mask:255},D+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=E,[L,g]}return[{[b]:s.StencilMode.disabled},g]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([n.CONSTANT_COLOR,n.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(n,c,g){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new s.DepthMode(g||this.context.gl.LEQUAL,c,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,c){this.style=n,this.options=c,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const g=this.style.order,b=this.style._sourceCaches;for(const W in b){const H=b[W];H.used&&H.prepare(this.context)}const E={},L={},D={};for(const W in b){const H=b[W];E[W]=H.getVisibleCoordinates(),L[W]=E[W].slice().reverse(),D[W]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let W=0;W<g.length;W++)if(this.style._layers[g[W]].is3D()){this.opaquePassCutoff=W;break}if(this.terrain&&(this.terrain.updateTileBinding(D),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const W of g){const H=this.style._layers[W],Q=n._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const he=Q?L[Q.id]:void 0;(H.type==="custom"||H.isSky()||he&&he.length)&&this.renderLayer(this,Q,H,he)}this.depthRangeFor3D=[0,1-(n.order.length+2)*this.numSublayers*this.depthEpsilon];const F=this.terrain;if(F&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&F.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const W=this.style._layers[g[this.currentLayer]],H=n._getLayerSourceCache(W);if(W.isSky())continue;const Q=H?L[H.id]:void 0;this._renderTileClippingMasks(W,H,Q),this.renderLayer(this,H,W,Q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(W,H){const Q=W.context,he=Q.gl,me=W.transform,ye=new s.DepthMode(he.LEQUAL,s.DepthMode.ReadOnly,[0,1]),_e=W.useProgram("globeAtmosphere",null,me.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),be=s.globeToMercatorTransition(me.zoom),ee=H.properties.get("color").toArray01(),pe=H.properties.get("high-color").toArray01(),Ce=H.properties.get("space-color").toArray01PremultipliedAlpha(),Ie=s.identity$1([]);s.rotateY$1(Ie,Ie,-s.degToRad(me._center.lng)),s.rotateX$1(Ie,Ie,s.degToRad(me._center.lat)),s.rotateZ$1(Ie,Ie,me.angle),s.rotateX$1(Ie,Ie,-me._pitch);const Ge=s.fromQuat(new Float32Array(16),Ie),Fe=s.mapValue(H.properties.get("star-intensity"),0,1,0,.25),We=5e-4,it=s.mapValue(H.properties.get("horizon-blend"),0,1,We,.25),et=s.globeUseCustomAntiAliasing(W,Q,me)&&it===We?me.worldSize/(2*Math.PI*1.025)-1:me.globeRadius,pt=W.frameCounter/1e3%1,Nt=s.length(me.globeCenterInViewSpace),ht=Math.sqrt(Math.pow(Nt,2)-Math.pow(et,2)),Ct=Math.acos(ht/Nt),yt=((at,Mt,Gt,Et,Xt,ki,Ni,bi,Li,Wi,Hi,Ai,Mr,Dr)=>({u_frustum_tl:at,u_frustum_tr:Mt,u_frustum_br:Gt,u_frustum_bl:Et,u_horizon:Xt,u_transition:ki,u_fadeout_range:Ni,u_color:bi,u_high_color:Li,u_space_color:Wi,u_star_intensity:Hi,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ai,u_horizon_angle:Mr,u_rotation_matrix:Dr}))(me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.frustumCorners.horizon,be,it,ee,pe,Ce,Fe,pt,Ct,Ge);W.prepareDrawProgram(Q,_e);const jt=W.atmosphereBuffer;jt&&_e.draw(Q,he.TRIANGLES,ye,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,yt,"skybox",jt.vertexBuffer,jt.indexBuffer,jt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const W=this.style._layers[g[this.currentLayer]],H=n._getLayerSourceCache(W);W.isSky()&&this.renderLayer(this,H,W,H?L[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const W=this.style._layers[g[this.currentLayer]],H=n._getLayerSourceCache(W);if(W.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(W)){if(W.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=H?(W.type==="symbol"?D:L)[H.id]:void 0;this._renderTileClippingMasks(W,H,H?E[H.id]:void 0),this.renderLayer(this,H,W,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let W=null;s.values(this.style._layers).forEach(H=>{const Q=n._getLayerSourceCache(H);Q&&!H.isHidden(this.transform.zoom)&&(!W||W.getSource().maxzoom<Q.getSource().maxzoom)&&(W=Q)}),W&&this.options.showTileBoundaries&&_l.debug(this,W,W.getVisibleCoordinates())}this.options.showPadding&&function(W){const H=W.transform.padding;Kc(W,W.transform.height-(H.top||0),3,to),Kc(W,H.bottom||0,3,Sm),tc(W,H.left||0,3,Cm),tc(W,W.transform.width-(H.right||0),3,Am);const Q=W.transform.centerPoint;(function(he,me,ye,_e){ic(he,me-1,ye-10,2,20,_e),ic(he,me-10,ye-1,20,2,_e)})(W,Q.x,W.transform.height-Q.y,Mm)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(n,c,g,b){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||b&&b.length)&&(this.id=g.id,this.gpuTimingStart(g),(!n.transform.projection.unsupportedLayers||!n.transform.projection.unsupportedLayers.includes(g.type)||n.terrain&&g.type==="custom")&&_l[g.type](n,c,g,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let g=this.gpuTimers[n.id];g||(g=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),g.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,c=n.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),n.beginQueryEXT(n.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const c={};for(const g in n){const b=n[g],E=this.context.extTimerQuery,L=E.getQueryObjectEXT(b.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(b.query),c[g]=L}return c}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let g=0;for(const b of n)g+=c.getQueryObjectEXT(b,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(b);return g}translatePosMatrix(n,c,g,b,E){if(!g[0]&&!g[1])return n;const L=E?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(L){const W=Math.sin(L),H=Math.cos(L);g=[g[0]*H-g[1]*W,g[0]*W+g[1]*H]}const D=[E?g[0]:sr(c,g[0],this.transform.zoom),E?g[1]:sr(c,g[1],this.transform.zoom),0],F=new Float32Array(16);return s.translate(F,n,D),F}saveTileTexture(n){const c=this._tileTextures[n.size[0]];c?c.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const c=this._tileTextures[n];return c&&c.length>0?c.pop():null}isPatternMissing(n){return n===null||n!==void 0&&!this.imageManager.getPattern(n.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const n=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&this.terrain.exaggeration()===0,g=this.style&&this.style.fog,b=[];return this.terrainRenderModeElevated()&&b.push("TERRAIN"),this.transform.projection.name==="globe"&&b.push("GLOBE"),c&&b.push("ZERO_EXAGGERATION"),g&&!n&&g.getOpacity(this.transform.pitch)!==0&&b.push("FOG"),n&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}useProgram(n,c,g){this.cache=this.cache||{};const b=g||[],E=this.currentGlobalDefines().concat(b),L=mr.cacheKey(Vh[n],n,E,c);return this.cache[L]||(this.cache[L]=new mr(this.context,n,Vh[n],c,vd[n],E)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(n,c,g){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const E=b.getOpacity(this.transform.pitch),L=((D,F,W,H,Q,he,me,ye,_e,be,ee)=>{const pe=D.transform,Ce=F.properties.get("color").toArray01();Ce[3]=H;const Ie=D.frameCounter/1e3%1;return{u_fog_matrix:W?pe.calculateFogTileMatrix(W):D.identityMat,u_fog_range:F.getFovAdjustedRange(pe._fov),u_fog_color:Ce,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_temporal_offset:Ie,u_frustum_tl:Q,u_frustum_tr:he,u_frustum_br:me,u_frustum_bl:ye,u_globe_pos:_e,u_globe_radius:be,u_viewport:ee,u_globe_transition:s.globeToMercatorTransition(pe.zoom),u_is_globe:+(pe.projection.name==="globe")}})(this,b,g,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);c.setFogUniformValues(n,L)}}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,c=n.createTexture();return n.bindTexture(n.TEXTURE_2D,c),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,c=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const b of g)c[b.key]=n[b.key]||new s.Tile(b,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Gs{constructor(n=0,c=0,g=0,b=0){if(isNaN(n)||n<0||isNaN(c)||c<0||isNaN(g)||g<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=c,this.left=g,this.right=b}interpolate(n,c,g){return c.top!=null&&n.top!=null&&(this.top=s.number(n.top,c.top,g)),c.bottom!=null&&n.bottom!=null&&(this.bottom=s.number(n.bottom,c.bottom,g)),c.left!=null&&n.left!=null&&(this.left=s.number(n.left,c.left,g)),c.right!=null&&n.right!=null&&(this.right=s.number(n.right,c.right,g)),this}getCenter(n,c){const g=s.clamp((this.left+n-this.right)/2,0,n),b=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.Point(g,b)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Gs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ba(f,n){const c=s.getColumn(f,3);s.fromQuat(f,n),s.setColumn(f,3,c)}function vr(f,n){const c=s.identity$1([]);return s.rotateZ$1(c,c,-n),s.rotateX$1(c,c,-f),c}function nc(f,n){const c=[f[0],f[1],0],g=[n[0],n[1],0];if(s.length(c)>=1e-15){const L=s.normalize([],c);s.scale$2(g,L,s.dot(g,L)),n[0]=g[0],n[1]=g[1]}const b=s.cross([],n,f);if(s.len(b)<1e-15)return null;const E=Math.atan2(-b[1],b[0]);return vr(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),E)}class qf{constructor(n,c){this.position=n,this.orientation=c}get position(){return this._position}set position(n){if(n){const c=n instanceof s.MercatorCoordinate?n:new s.MercatorCoordinate(n[0],n[1],n[2]);this._renderWorldCopies&&(c.x=s.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(n,c){if(this.orientation=null,!this.position)return;const g=this.position,b=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(n)):0,E=s.MercatorCoordinate.fromLngLat(n,b),L=[E.x-g.x,E.y-g.y,E.z-g.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=nc(L,c)}setPitchBearing(n,c){this.orientation=vr(s.degToRad(n),s.degToRad(-c))}}class sc{constructor(n,c){this._transform=s.identity([]),this.orientation=c,this.position=n}get mercatorPosition(){const n=this.position;return new s.MercatorCoordinate(n[0],n[1],n[2])}get position(){const n=s.getColumn(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var c;n&&s.setColumn(this._transform,3,[(c=n)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||s.identity$1([]),n&&ba(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,c){this._orientation=vr(n,c),ba(this._transform,this._orientation)}forward(){const n=s.getColumn(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=s.getColumn(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=s.getColumn(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,c){const g=new Float64Array(16);return s.invert(g,this.getWorldToCamera(n,c)),g}getWorldToCameraPosition(n,c,g){const b=this.position;s.scale$2(b,b,-n);const E=new Float64Array(16);return s.fromScaling(E,[g,g,g]),s.translate(E,E,b),E[10]*=c,E}getWorldToCamera(n,c){const g=new Float64Array(16),b=new Float64Array(4),E=this.position;return s.conjugate(b,this._orientation),s.scale$2(E,E,-n),s.fromQuat(g,b),s.translate(g,g,E),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=c,g[9]*=c,g[10]*=c,g[11]*=c,g}getCameraToClipPerspective(n,c,g,b){const E=new Float64Array(16);return s.perspective(E,n,c,g,b),E}getDistanceToElevation(n,c=!1){const g=n===0?0:s.mercatorZfromAltitude(n,c?s.latFromMercatorY(this.position[1]):this.position[1]),b=this.forward();return(g-this.position[2])/b[2]}clone(){return new sc([...this.position],[...this.orientation])}}function oc(f,n){const c=ih(f.projection,f.zoom,f.width,f.height),g=function(E,L,D,F,W){const H=new s.LngLat(D.lng-180*wa,D.lat),Q=new s.LngLat(D.lng+180*wa,D.lat),he=E.project(H.lng,H.lat),me=E.project(Q.lng,Q.lat),ye=-Math.atan2(me.y-he.y,me.x-he.x),_e=s.MercatorCoordinate.fromLngLat(D);_e.y=s.clamp(_e.y,-1+wa,1-wa);const be=_e.toLngLat(),ee=E.project(be.lng,be.lat),pe=s.MercatorCoordinate.fromLngLat(be);pe.x+=wa;const Ce=pe.toLngLat(),Ie=E.project(Ce.lng,Ce.lat),Ge=ms(Ie.x-ee.x,Ie.y-ee.y,ye),Fe=s.MercatorCoordinate.fromLngLat(be);Fe.y+=wa;const We=Fe.toLngLat(),it=E.project(We.lng,We.lat),et=ms(it.x-ee.x,it.y-ee.y,ye),pt=Math.abs(Ge.x)/Math.abs(et.y),Nt=s.identity([]);s.rotateZ(Nt,Nt,-ye*(1-(W?0:F)));const ht=s.identity([]);return s.scale(ht,ht,[1,1-(1-pt)*F,1]),ht[4]=-et.x/et.y*F,s.rotateZ(ht,ht,ye),s.multiply(ht,Nt,ht),ht}(f.projection,0,f.center,c,n),b=Xf(f);return s.scale(g,g,[b,b,1]),g}function Xf(f){const n=f.projection,c=ih(f.projection,f.zoom,f.width,f.height),g=iu(n,f.center),b=iu(n,s.LngLat.convert(n.center));return Math.pow(2,g*c+(1-c)*b)}function ih(f,n,c,g,b=1/0){const E=f.range;if(!E)return 0;const L=Math.min(b,Math.max(c,g)),D=Math.log(L/1024)/Math.LN2;return s.smoothstep(E[0]+D,E[1]+D,n)}const wa=1/4e4;function iu(f,n){const c=s.clamp(n.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=new s.LngLat(n.lng-180*wa,c),b=new s.LngLat(n.lng+180*wa,c),E=f.project(g.lng,c),L=f.project(b.lng,c),D=s.MercatorCoordinate.fromLngLat(g),F=s.MercatorCoordinate.fromLngLat(b),W=L.x-E.x,H=L.y-E.y,Q=F.x-D.x,he=F.y-D.y,me=Math.sqrt((Q*Q+he*he)/(W*W+H*H));return Math.log(me)/Math.LN2}function ms(f,n,c){const g=Math.cos(c),b=Math.sin(c);return{x:f*g-n*b,y:f*b+n*g}}class Ar{constructor(n,c,g,b,E,L,D){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=g??0,this._maxPitch=b??60,this.setProjection(L),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Gs,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new sc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const n=new Ar(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(n,c=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(n||g)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const g=!$(c,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const c=n!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const c=-n*Math.PI/180;var g;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(g=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(b,E,L){var D=E[0],F=E[1],W=E[2],H=E[3],Q=Math.sin(L),he=Math.cos(L);b[0]=D*he+W*Q,b[1]=F*he+H*Q,b[2]=D*-Q+W*he,b[3]=F*-Q+H*he}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const c=s.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=s.degToRad(n),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const c=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const n=this._elevation;this._centerAltitude=n.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=n.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let b=0,E=0;for(let L=0;L<c.length;L++){const D=new s.Point(c[L][0]*this.width,g+c[L][1]*(this.height-g)),F=n.pointCoordinate(D);if(!F)continue;const W=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);b+=F[3]*W,E+=W}return E===0?NaN:b/E}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*c,b=this._mercatorZfromZoom(n),E=this._mercatorZfromZoom(this._maxZoom),L=Math.max(b-g,E);this._setZoom(this._zoomFromMercatorZ(L))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let g;g=n.z<this._camera.position[2]?[c.x,c.y,c.z]:[n.x,n.y,n.z];const b=s.length(s.sub([],this._camera.position,g));return s.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let c=!1;if(n.orientation&&!s.exactEquals(n.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(n.orientation)),n.position){const g=[n.position.x,n.position.y,n.position.z];s.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,c=new qf;return c.position=new s.MercatorCoordinate(n[0],n[1],n[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(n){if(!s.length$1(n))return!1;s.normalize$1(n,n);const c=s.transformQuat([],[0,0,-1],n),g=s.transformQuat([],[0,-1,0],n);if(g[2]<0)return!1;const b=nc(c,g);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(n){const c=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;n[2]=s.clamp(n[2],b/g,b/c),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,c,g){this._unmodified=!1,this._edgeInsets.interpolate(n,c,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const c=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(n){const c=[new s.UnwrappedTileID(0,n)];if(this.renderWorldCopies){const g=this.pointCoordinate(new s.Point(0,0)),b=this.pointCoordinate(new s.Point(this.width,0)),E=this.pointCoordinate(new s.Point(this.width,this.height)),L=this.pointCoordinate(new s.Point(0,this.height)),D=Math.floor(Math.min(g.x,b.x,E.x,L.x)),F=Math.floor(Math.max(g.x,b.x,E.x,L.x)),W=1;for(let H=D-W;H<=F+W;H++)H!==0&&c.push(new s.UnwrappedTileID(H,n))}return c}coveringTiles(n){let c=this.coveringZoomLevel(n);const g=c,b=this.elevation&&!n.isTerrainDEM,E=this.projection.name==="mercator";if(n.minzoom!==void 0&&c<n.minzoom)return[];n.maxzoom!==void 0&&c>n.maxzoom&&(c=n.maxzoom);const L=this.locationCoordinate(this.center),D=this.center.lat,F=1<<c,W=[F*L.x,F*L.y,0],H=this.projection.name==="globe",Q=!H,he=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,Q),me=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ye=F*s.mercatorZfromAltitude(1,this.center.lat),_e=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),be=[F*me.x,F*me.y,_e*(Q?1:ye)],ee=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),pe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,Ce=n.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ie=n.isTerrainDEM?-Ce:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ge=this.projection.isReprojectedInTileSpace?Xf(this):1,Fe=at=>{const Gt=new s.MercatorCoordinate(at.x+25e-6,at.y,at.z),Et=new s.MercatorCoordinate(at.x,at.y+25e-6,at.z),Xt=at.toLngLat(),ki=Gt.toLngLat(),Ni=Et.toLngLat(),bi=this.locationCoordinate(Xt),Li=this.locationCoordinate(ki),Wi=this.locationCoordinate(Ni),Hi=Math.hypot(Li.x-bi.x,Li.y-bi.y),Ai=Math.hypot(Wi.x-bi.x,Wi.y-bi.y);return Math.sqrt(Hi*Ai)*Ge/25e-6},We=at=>{const Mt=Ce,Gt=Ie;return{aabb:s.tileAABB(this,F,0,0,0,at,Gt,Mt,this.projection),zoom:0,x:0,y:0,minZ:Gt,maxZ:Mt,wrap:at,fullyVisible:!1}},it=[];let et=[];const pt=c,Nt=n.reparseOverscaled?g:c,ht=at=>at*at,Ct=ht((_e-this._centerAltitude)*ye),yt=at=>{if(!this._elevation||!at.tileID||!E)return;const Mt=this._elevation.getMinMaxForTile(at.tileID),Gt=at.aabb;Mt?(Gt.min[2]=Mt.min,Gt.max[2]=Mt.max,Gt.center[2]=(Gt.min[2]+Gt.max[2])/2):(at.shouldSplit=jt(at),at.shouldSplit||(Gt.min[2]=Gt.max[2]=Gt.center[2]=this._centerAltitude))},jt=at=>{if(at.zoom<pe)return!0;if(at.zoom===pt)return!1;if(at.shouldSplit!=null)return at.shouldSplit;const Mt=at.aabb.distanceX(be),Gt=at.aabb.distanceY(be);let Et=Ct,Xt=1;if(H){Et=ht(at.aabb.distanceZ(be));const bi=Math.pow(2,at.zoom),Li=s.latFromMercatorY((at.y+1)/bi),Wi=s.latFromMercatorY(at.y/bi),Hi=Math.min(Math.max(D,Li),Wi),Ai=s.circumferenceAtLatitude(Hi)/s.circumferenceAtLatitude(D);if(Xt=Hi===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ai/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&at.zoom===pt-1&&Ai>=.9)return!0}else if(b&&(Et=ht(at.aabb.distanceZ(be)*ye)),this.projection.isReprojectedInTileSpace&&g<=5){const bi=Math.pow(2,at.zoom),Li=Fe(new s.MercatorCoordinate((at.x+.5)/bi,(at.y+.5)/bi));Xt=Li>.85?1:Li}const ki=Mt*Mt+Gt*Gt+Et,Ni=ht((1<<pt-at.zoom)*ee*Xt*((bi,Li)=>{if(Li*ht(.707)<bi)return 1;const Wi=Math.sqrt(Li/bi);return Wi/(1.4144271570014144+(Math.pow(1.1,Wi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Et,Ct),ki));return ki<Ni};if(this.renderWorldCopies)for(let at=1;at<=3;at++)it.push(We(-at)),it.push(We(at));for(it.push(We(0));it.length>0;){const at=it.pop(),Mt=at.x,Gt=at.y;let Et=at.fullyVisible;if(!Et){const Xt=at.aabb.intersects(he);if(Xt===0)continue;Et=Xt===2}if(at.zoom!==pt&&jt(at))for(let Xt=0;Xt<4;Xt++){const ki=(Mt<<1)+Xt%2,Ni=(Gt<<1)+(Xt>>1),bi={aabb:E?at.aabb.quadrant(Xt):s.tileAABB(this,F,at.zoom+1,ki,Ni,at.wrap,at.minZ,at.maxZ,this.projection),zoom:at.zoom+1,x:ki,y:Ni,wrap:at.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:at.minZ,maxZ:at.maxZ};b&&!H&&(bi.tileID=new s.OverscaledTileID(at.zoom+1===pt?Nt:at.zoom+1,at.wrap,at.zoom+1,ki,Ni),yt(bi)),it.push(bi)}else{const Xt=at.zoom===pt?Nt:at.zoom;if(n.minzoom&&n.minzoom>Xt)continue;const ki=W[0]-(.5+Mt+(at.wrap<<at.zoom))*(1<<c-at.zoom),Ni=W[1]-.5-Gt,bi=at.tileID?at.tileID:new s.OverscaledTileID(Xt,at.wrap,at.zoom,Mt,Gt);et.push({tileID:bi,distanceSq:ki*ki+Ni*Ni})}}if(this.fogCullDistSq){const at=this.fogCullDistSq,Mt=this.horizonLineFromTop();et=et.filter(Gt=>{const Et=[0,0,0,1],Xt=[s.EXTENT,s.EXTENT,0,1],ki=this.calculateFogTileMatrix(Gt.tileID.toUnwrapped());s.transformMat4$1(Et,Et,ki),s.transformMat4$1(Xt,Xt,ki);const Ni=s.getAABBPointSquareDist(Et,Xt);if(Ni===0)return!0;let bi=!1;const Li=this._elevation;if(Li&&Ni>at&&Mt!==0){const Wi=this.calculateProjMatrix(Gt.tileID.toUnwrapped());let Hi;n.isTerrainDEM||(Hi=Li.getMinMaxForTile(Gt.tileID)),Hi||(Hi={min:Ie,max:Ce});const Ai=s.furthestTileCorner(this.rotation),Mr=[Ai[0]*s.EXTENT,Ai[1]*s.EXTENT,Hi.max];s.transformMat4(Mr,Mr,Wi),bi=(1-Mr[1])*this.height*.5<Mt}return Ni<at||bi})}return et.sort((at,Mt)=>at.distanceSq-Mt.distanceSq).map(at=>at.tileID)}resize(n,c){this.width=n,this.height=c,this.pixelsToGLUnits=[2/n,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const c=s.clamp(n.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=this.projection.project(n.lng,c);return new s.Point(g.x*this.worldSize,g.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,c){let g,b;const E=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;g=(c.x-E.x)/D,b=(c.y-E.y)/D}else{const D=this.pointCoordinate(c),F=this.pointCoordinate(E);g=D.x-F.x,b=D.y-F.y}const L=this.locationCoordinate(n);this.setLocation(new s.MercatorCoordinate(L.x-g,L.y-b))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,c){const g=c?s.mercatorZfromAltitude(c,n.lat):void 0,b=this.projection.project(n.lng,n.lat);return new s.MercatorCoordinate(b.x,b.y,g)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,c){const g=c??this._centerAltitude,b=[n.x,n.y,0,1],E=[n.x,n.y,1,1];s.transformMat4$1(b,b,this.pixelMatrixInverse),s.transformMat4$1(E,E,this.pixelMatrixInverse);const L=E[3];s.scale$1(b,b,1/b[3]),s.scale$1(E,E,1/L);const D=b[2],F=E[2];return{p0:b,p1:E,t:D===F?0:(g-D)/(F-D)}}screenPointToMercatorRay(n){const c=[n.x,n.y,0,1],g=[n.x,n.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(g,g,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(g,g,1/g[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,g[2]=s.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(g,g,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],g,c)))}rayIntersectionCoordinate(n){const{p0:c,p1:g,t:b}=n,E=s.mercatorZfromAltitude(c[2],this._center.lat),L=s.mercatorZfromAltitude(g[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],g[0],b)/this.worldSize,s.number(c[1],g[1],b)/this.worldSize,s.number(E,L,b))}pointCoordinate(n,c=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,c)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let c=this.projection.pointCoordinate3D(this,n.x,n.y);if(c)return new s.MercatorCoordinate(c[0],c[1],c[2]);let g=0,b=this.horizonLineFromTop();if(n.y>b)return this.pointCoordinate(n);const E=.02*b,L=n.clone();for(let D=0;D<10&&b-g>E;D++){L.y=s.number(g,b,.66);const F=this.projection.pointCoordinate3D(this,L.x,L.y);F?(b=L.y,c=F):g=L.y}return c?new s.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(n);const c=this.pointCoordinate(n);return c.y>=0&&c.y<=1}_coordinatePoint(n,c){const g=c&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,b=[n.x*this.worldSize,n.y*this.worldSize,g+n.toAltitude(),1];return s.transformMat4$1(b,b,this.pixelMatrix),b[3]>0?new s.Point(b[0]/b[3],b[1]/b[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:c}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,E=this.pointLocation3D(new s.Point(c,n)),L=this.pointLocation3D(new s.Point(b,n)),D=this.pointLocation3D(new s.Point(b,g)),F=this.pointLocation3D(new s.Point(c,g));let W=Math.min(E.lng,L.lng,D.lng,F.lng),H=Math.max(E.lng,L.lng,D.lng,F.lng),Q=Math.min(E.lat,L.lat,D.lat,F.lat),he=Math.max(E.lat,L.lat,D.lat,F.lat);const me=Math.pow(2,-this.zoom)/16*270,ye=this.projection.name==="globe"?1:4,_e=(be,ee,pe,Ce,Ie)=>{const Ge=(be+pe)/2,Fe=(ee+Ce)/2,We=new s.Point(Ge,Fe),{lng:it,lat:et}=this.pointLocation3D(We),pt=Math.max(0,W-it,Q-et,it-H,et-he);W=Math.min(W,it),H=Math.max(H,it),Q=Math.min(Q,et),he=Math.max(he,et),(Ie<ye||pt>me)&&(_e(be,ee,Ge,Fe,Ie+1),_e(Ge,Fe,pe,Ce,Ie+1))};if(_e(c,n,b,n,1),_e(b,n,b,g,1),_e(b,g,c,g,1),_e(c,g,c,n,1),this.projection.name==="globe"){const[be,ee]=s.polesInViewport(this);be?(he=90,H=180,W=-180):ee&&(Q=-90,H=180,W=-180)}return new s.LngLatBounds(new s.LngLat(W,Q),new s.LngLat(H,he))}_getBoundsRectangular(n,c){const{top:g,left:b}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,L=this.width-this._edgeInsets.right,D=new s.Point(b,g),F=new s.Point(L,g),W=new s.Point(L,E),H=new s.Point(b,E);let Q=this.pointCoordinate(D,n),he=this.pointCoordinate(F,n);const me=this.pointCoordinate(W,c),ye=this.pointCoordinate(H,c),_e=(be,ee)=>(ee.y-be.y)/(ee.x-be.x);return Q.y>1&&he.y>=0?Q=new s.MercatorCoordinate((1-ye.y)/_e(ye,Q)+ye.x,1):Q.y<0&&he.y<=1&&(Q=new s.MercatorCoordinate(-ye.y/_e(ye,Q)+ye.x,0)),he.y>1&&Q.y>=0?he=new s.MercatorCoordinate((1-me.y)/_e(me,he)+me.x,1):he.y<0&&Q.y<=1&&(he=new s.MercatorCoordinate(-me.y/_e(me,he)+me.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(he)).extend(this.coordinateLocation(ye)).extend(this.coordinateLocation(me))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=n.visibleDemTiles.reduce((g,b)=>{if(b.dem){const E=b.dem.tree;g.min=Math.min(g.min,E.minimums[0]),g.max=Math.max(g.max,E.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*n.exaggeration(),c.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-c*(1-this._horizonShift);return n?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,c){return this.projection.createTileMatrix(this,c,n)}calculateDistanceTileData(n){const c=n.key,g=this._distanceTileDataCache;if(g[c])return g[c];const b=n.canonical,E=1/this.height,L=this.cameraWorldSize,D=L/this.zoomScale(b.z),F=(b.x+Math.pow(2,b.z)*n.wrap)*D,W=b.y*D,H=this.point;H.x*=L/this.worldSize,H.y*=L/this.worldSize;const Q=this.angle,he=Math.sin(-Q),me=-Math.cos(-Q);return g[c]={bearing:[he,me],center:[(H.x-F)*E,(H.y-W)*E],scale:D/s.EXTENT*E},g[c]}calculateFogTileMatrix(n){const c=n.key,g=this._fogTileMatrixCache;if(g[c])return g[c];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return s.multiply(b,this.worldToFogMatrix,b),g[c]=new Float32Array(b),g[c]}calculateProjMatrix(n,c=!1){const g=n.key,b=c?this._alignedProjMatrixCache:this._projMatrixCache;if(b[g])return b[g];const E=this.calculatePosMatrix(n,this.worldSize);return s.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,E),b[g]=new Float32Array(E),b[g]}calculatePixelsToTileUnitsMatrix(n){const c=n.tileID.key,g=this._pixelsToTileUnitsCache;if(g[c])return g[c];const b=function(E,L){const{scale:D}=E.tileTransform,F=D*s.EXTENT/(E.tileSize*Math.pow(2,L.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return W=new Float32Array(4),he=(H=L.inverseAdjustmentMatrix)[1],me=H[2],ye=H[3],be=(Q=[F,F])[1],W[0]=H[0]*(_e=Q[0]),W[1]=he*_e,W[2]=me*be,W[3]=ye*be,W;var W,H,Q,he,me,ye,_e,be}(n,this);return g[c]=b,g[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,c=s.fromScaling([],[n,n,n]);return s.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(c),b=this._camera.forward(),E=s.mercatorZfromAltitude(1,this._center.lat);g[2]/=E,b[2]/=E,s.normalize(b,b);const L=n.raycast(g,b,n.exaggeration());if(L){const D=s.scaleAndAdd([],g,b,L),F=new s.MercatorCoordinate(D[0],D[1],s.mercatorZfromAltitude(D[2],s.latFromMercatorY(D[1]))),W=(F.z+s.length([F.x-g[0],F.y-g[1],F.z-g[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(W),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const c=this._elevation,g=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(g),E=c.getAtPointOrZero(new s.MercatorCoordinate(...b)),L=this.pixelsPerMeter/this.worldSize*E,D=this._minimumHeightOverTerrain(),F=b[2]-L;if(F<=D)if(F<0||n){const W=this.locationCoordinate(this._center,this._centerAltitude),H=[b[0],b[1],W.z-b[2]],Q=s.length(H);H[2]-=(D-F)/this._pixelsPerMercatorPixel;const he=s.length(H);if(he===0)return;s.scale$2(H,H,Q/he*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],W.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const he=this.center;return he.lat=s.clamp(he.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(he.lng=s.clamp(he.lng,this.minLng,this.maxLng)),this.center=he,void(this._constraining=!1)}const c=this._unmodified,{x:g,y:b}=this.point;let E=0,L=g,D=b;const F=this.width/2,W=this.height/2,H=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(b-W<H&&(D=H+W),b+W>Q&&(D=Q-W),Q-H<this.height&&(E=Math.max(E,this.height/(Q-H)),D=(Q+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const he=this.worldMinX*this.scale,me=this.worldMaxX*this.scale,ye=this.worldSize/2-(he+me)/2;L=(g+ye+this.worldSize)%this.worldSize-ye,L-F<he&&(L=he+F),L+F>me&&(L=me-F),me-he<this.width&&(E=Math.max(E,this.width/(me-he)),L=(me+he)/2)}L===g&&D===b||(this.center=this.unproject(new s.Point(L,D))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const g=ih(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?c:1,E=this._camera.getWorldToCamera(this.worldSize,b),L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);L[8]=2*-n.x/this.width,L[9]=2*n.y/this.height;let D=s.mul([],L,E);if(this.projection.isReprojectedInTileSpace){const Fe=this.locationCoordinate(this.center),We=s.identity([]);s.translate(We,We,[Fe.x*this.worldSize,Fe.y*this.worldSize,0]),s.multiply(We,We,oc(this)),s.translate(We,We,[-Fe.x*this.worldSize,-Fe.y*this.worldSize,0]),s.multiply(D,D,We),this.inverseAdjustmentMatrix=function(it){const et=oc(it,!0);return He([],[et[0],et[1],et[4],et[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],D,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=D,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const F=s.invert([],L);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(F,this.horizonLineFromTop(),this.height);const W=new Float32Array(16);s.identity(W),s.scale(W,W,[1,-1,1]),s.rotateX(W,W,this._pitch),s.rotateZ(W,W,this.angle);const H=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-n.x/this.width,H[9]=2*(n.y+Q)/this.height,this.skyboxMatrix=s.multiply(W,H,W);const he=this.point,me=he.x,ye=he.y,_e=this.width%2/2,be=this.height%2/2,ee=Math.cos(this.angle),pe=Math.sin(this.angle),Ce=me-Math.round(me)+ee*_e+pe*be,Ie=ye-Math.round(ye)+ee*be+pe*_e,Ge=new Float64Array(D);if(s.translate(Ge,Ge,[Ce>.5?Ce-1:Ce,Ie>.5?Ie-1:Ie,0]),this.alignedProjMatrix=Ge,D=s.create(),s.scale(D,D,[this.width/2,-this.height/2,1]),s.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=s.create(),s.scale(D,D,[1,-1,1]),s.translate(D,D,[-1,-1,0]),s.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},D=s.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Fe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Fe,Fe,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,g=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,E=[n,n,c];s.scale$2(E,E,b),s.scale$2(g,g,-1),s.multiply$2(g,g,E);const L=s.create();s.translate(L,L,g),s.scale(L,L,E),this.mercatorFogMatrix=L,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,c,b)}_computeCameraPosition(n){const c=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),b=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-n/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-g[0]*E,b.y/this.worldSize-g[1]*E,n/this.worldSize*this._centerAltitude-g[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],b=n[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(E=Math.min((c-g)/b,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,n,E),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,c=this._camera.forward(),{pitch:g,bearing:b}=this._camera.getPitchBearing(),E=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,L=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),D=Math.max((n[2]-E)/Math.cos(g),L),F=this._zoomFromMercatorZ(D);s.scaleAndAdd(n,n,c,D),this._pitch=s.clamp(g,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(b,-Math.PI,Math.PI),this._setZoom(s.clamp(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}zoomFromMercatorZAdjusted(n){let c=0,g=s.GLOBE_ZOOM_THRESHOLD_MAX,b=0,E=1/0;for(;g-c>1e-6&&g>c;){const L=c+.5*(g-c),D=this.tileSize*Math.pow(2,L),F=this.getCameraToCenterDistance(this.projection,L,D),W=this.scaleZoom(F/(n*this.tileSize)),H=Math.abs(L-W);H<E&&(E=H,b=L),L<W?c=L:g=L}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,c){const g=Math.min(n.x,c.x),b=Math.max(n.x,c.x),E=Math.min(n.y,c.y),L=Math.max(n.y,c.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new s.Point(g,E),new s.Point(b,L),new s.Point(g,L),new s.Point(b,E)],F=this.renderWorldCopies?-3:0,W=this.renderWorldCopies?4:1;for(const H of D){const Q=this.pointRayIntersection(H);if(Q.t<0)return!0;const he=this.rayIntersectionCoordinate(Q);if(he.x<F||he.y<0||he.x>W||he.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(n,c){const g=s.length(s.sub([],this._camera.position,n)),b=this._zoomFromMercatorZ(g)+c;return g-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([c,g,b],E){const L=[c,g,b,1];s.transformMat4$1(L,L,E);const D=L[3]=Math.max(L[3],1e-6);return L[0]/=D,L[1]/=D,L[2]/=D,L}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,n))}}getCameraToCenterDistance(n,c=this.zoom,g=this.worldSize){const b=ih(n,c,this.width,this.height,1024),E=n.pixelSpaceConversion(this.center.lat,g,b);return .5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(n,n,this.globeMatrix),n}}function ac(f,n){let c=!1,g=null;const b=()=>{g=null,c&&(f(),g=setTimeout(b,n),c=!1)};return()=>(c=!0,g||b(),g)}class ru{constructor(n){this._hashName=n&&encodeURIComponent(n),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ac(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,s.window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const c=yl(n);if(this._hashName){const g=this._hashName;let b=!1;const E=s.window.location.hash.slice(1).split("&").map(L=>{const D=L.split("=")[0];return D===g?(b=!0,`${D}=${c}`):L}).filter(L=>L);return b||E.push(`${g}=${c}`),`#${E.join("&")}`}return`#${c}`}_getCurrentHash(){const n=s.window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(c=g)}),(c&&c[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(g=>isNaN(g))){const g=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(c[3]||0):n.getBearing();return n.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:g,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,n)}}function yl(f,n){const c=f.getCenter(),g=Math.round(100*f.getZoom())/100,b=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,b),L=Math.round(c.lng*E)/E,D=Math.round(c.lat*E)/E,F=f.getBearing(),W=f.getPitch();let H=n?`/${L}/${D}/${g}`:`${g}/${D}/${L}`;return(F||W)&&(H+="/"+Math.round(10*F)/10),W&&(H+=`/${Math.round(W)}`),H}const $a={linearity:.3,easing:s.bezier(0,0,.3,1)},Zr=s.extend({deceleration:2500,maxSpeed:1400},$a),rh=s.extend({deceleration:20,maxSpeed:1400},$a),fi=s.extend({deceleration:1e3,maxSpeed:360},$a),io=s.extend({deceleration:1e3,maxSpeed:90},$a);class Fi{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,c=s.exported.now();for(;n.length>0&&c-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)c.zoom+=E.zoomDelta||0,c.bearing+=E.bearingDelta||0,c.pitch+=E.pitchDelta||0,E.panDelta&&c.pan._add(E.panDelta),E.around&&(c.around=E.around),E.pinchAround&&(c.pinchAround=E.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(c.pan.mag()){const E=Ga(c.pan.mag(),g,s.extend({},Zr,n||{}));b.offset=c.pan.mult(E.amount/c.pan.mag()),b.center=this._map.transform.center,lc(b,E)}if(c.zoom){const E=Ga(c.zoom,g,rh);b.zoom=this._map.transform.zoom+E.amount,lc(b,E)}if(c.bearing){const E=Ga(c.bearing,g,fi);b.bearing=this._map.transform.bearing+s.clamp(E.amount,-179,179),lc(b,E)}if(c.pitch){const E=Ga(c.pitch,g,io);b.pitch=this._map.transform.pitch+E.amount,lc(b,E)}if(b.zoom||b.bearing){const E=c.pinchAround===void 0?c.around:c.pinchAround;b.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function lc(f,n){(!f.duration||f.duration<n.duration)&&(f.duration=n.duration,f.easing=n.easing)}function Ga(f,n,c){const{maxSpeed:g,linearity:b,deceleration:E}=c,L=s.clamp(f*b/(n/1e3),-g,g),D=Math.abs(L)/(E*b);return{easing:c.easing,duration:1e3*D,amount:L*(D/2)}}class rs extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,g,b={}){const E=ze(c.getCanvasContainer(),g),L=c.unproject(E);super(n,s.extend({point:E,lngLat:L,originalEvent:g},b)),this._defaultPrevented=!1,this.target=c}}class Wa extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,g){const b=n==="touchend"?g.changedTouches:g.touches,E=rt(c.getCanvasContainer(),b),L=E.map(F=>c.unproject(F)),D=E.reduce((F,W,H,Q)=>F.add(W.div(Q.length)),new s.Point(0,0));super(n,{points:E,point:D,lngLats:L,lngLat:c.unproject(D),originalEvent:g}),this._defaultPrevented=!1}}class rr extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,g){super(n,{originalEvent:g}),this._defaultPrevented=!1}}class cc{constructor(n,c){this._map=n,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new rr(n.type,this._map,n))}mousedown(n,c){return this._mousedownPos=c,this._firePreventable(new rs(n.type,this._map,n))}mouseup(n){this._map.fire(new rs(n.type,this._map,n))}preclick(n){const c=s.extend({},n);c.type="preclick",this._map.fire(new rs(c.type,this._map,c))}click(n,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(n),this._map.fire(new rs(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new rs(n.type,this._map,n))}mouseover(n){this._map.fire(new rs(n.type,this._map,n))}mouseout(n){this._map.fire(new rs(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Wa(n.type,this._map,n))}touchmove(n){this._map.fire(new Wa(n.type,this._map,n))}touchend(n){this._map.fire(new Wa(n.type,this._map,n))}touchcancel(n){this._map.fire(new Wa(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nu{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new rs(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new rs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new rs(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zf{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,c){this.isEnabled()&&n.shiftKey&&n.button===0&&(je(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(n,c){if(!this._active)return;const g=c,b=this._startPos,E=this._lastPos;if(!b||!E||E.equals(g)||!this._box&&g.dist(b)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=ue("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const L=Math.min(b.x,g.x),D=Math.max(b.x,g.x),F=Math.min(b.y,g.y),W=Math.max(b.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${L}px,${F}px)`,this._box.style.width=D-L+"px",this._box.style.height=W-F+"px")})}mouseupWindow(n,c){if(!this._active)return;const g=this._startPos,b=c;if(g&&n.button===0){if(this.reset(),Oe(),g.x!==b.x||g.y!==b.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:E=>E.fitScreenCoordinates(g,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ae(),delete this._startPos,delete this._lastPos}_fireEvent(n,c){return this._map.fire(new s.Event(n,{originalEvent:c}))}}function su(f,n){const c={};for(let g=0;g<f.length;g++)c[f[g].identifier]=n[g];return c}class xl{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,c,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),g.length===this.numTouches&&(this.centroid=function(b){const E=new s.Point(0,0);for(const L of b)E._add(L);return E.div(b.length)}(c),this.touches=su(g,c)))}touchmove(n,c,g){if(this.aborted||!this.centroid)return;const b=su(g,c);for(const E in this.touches){const L=b[E];(!L||L.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(n,c,g){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Ha{constructor(n){this.singleTap=new xl(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,c,g){this.singleTap.touchstart(n,c,g)}touchmove(n,c,g){this.singleTap.touchmove(n,c,g)}touchend(n,c,g){const b=this.singleTap.touchend(n,c,g);if(b){const E=n.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(b)<30;if(E&&L||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class km{constructor(){this._zoomIn=new Ha({numTouches:1,numTaps:2}),this._zoomOut=new Ha({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,c,g){this._zoomIn.touchstart(n,c,g),this._zoomOut.touchstart(n,c,g)}touchmove(n,c,g){this._zoomIn.touchmove(n,c,g),this._zoomOut.touchmove(n,c,g)}touchend(n,c,g){const b=this._zoomIn.touchend(n,c,g),E=this._zoomOut.touchend(n,c,g);return b?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(b)},{originalEvent:n})}):E?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(E)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Yf={0:1,2:2};class hc{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,c){return!1}_move(n,c){return{}}mousedown(n,c){if(this._lastPoint)return;const g=ke(n);this._correctButton(n,g)&&(this._lastPoint=c,this._eventButton=g)}mousemoveWindow(n,c){const g=this._lastPoint;if(g){if(n.preventDefault(),this._eventButton!=null&&function(b,E){const L=Yf[E];return b.buttons===void 0||(b.buttons&L)!==L}(n,this._eventButton))this.reset();else if(this._moved||!(c.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(g,c)}}mouseupWindow(n){this._lastPoint&&ke(n)===this._eventButton&&(this._moved&&Oe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uc extends hc{mousedown(n,c){super.mousedown(n,c),this._lastPoint&&(this._active=!0)}_correctButton(n,c){return c===0&&!n.ctrlKey}_move(n,c){return{around:c,panDelta:c.sub(n)}}}class Ed extends hc{_correctButton(n,c){return c===0&&n.ctrlKey||c===2}_move(n,c){const g=.8*(c.x-n.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(n){n.preventDefault()}}class ou extends hc{_correctButton(n,c){return c===0&&n.ctrlKey||c===2}_move(n,c){const g=-.5*(c.y-n.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(n){n.preventDefault()}}class au{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(n,c,g){return this._calculateTransform(n,c,g)}touchmove(n,c,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,c,g)}}touchend(n,c,g){this._calculateTransform(n,c,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,c,g){g.length>0&&(this._active=!0);const b=su(g,c),E=new s.Point(0,0),L=new s.Point(0,0);let D=0;for(const W in b){const H=b[W],Q=this._touches[W];Q&&(E._add(H),L._add(H.sub(Q)),D++,b[W]=H)}if(this._touches=b,D<this._minTouches||!L.mag())return;const F=L.div(D);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(D),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ue("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class nh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,c,g){return{}}touchstart(n,c,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([c[0],c[1]]))}touchmove(n,c,g){const b=this._firstTwoTouches;if(!b)return;n.preventDefault();const[E,L]=b,D=sh(g,c,E),F=sh(g,c,L);if(!D||!F)return;const W=this._aroundCenter?null:D.add(F).div(2);return this._move([D,F],W,n)}touchend(n,c,g){if(!this._firstTwoTouches)return;const[b,E]=this._firstTwoTouches,L=sh(g,c,b),D=sh(g,c,E);L&&D||(this._active&&Oe(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function sh(f,n,c){for(let g=0;g<f.length;g++)if(f[g].identifier===c)return n[g]}function Sd(f,n){return Math.log(f/n)/Math.LN2}class Kf extends nh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,c){const g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Sd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sd(this._distance,g),pinchAround:c}}}function lu(f,n){return 180*f.angleWith(n)/Math.PI}class Jf extends nh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,c){const g=this._vector;if(this._vector=n[0].sub(n[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:lu(this._vector,g),pinchAround:c}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const c=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const b=lu(n,g);return Math.abs(b)<c}}function qa(f){return Math.abs(f.y)>Math.abs(f.x)}class Cd extends nh{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,qa(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,c,g){const b=this._lastPoints;if(!b)return;const E=n[0].sub(b[0]),L=n[1].sub(b[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(E,L,g.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(E.y+L.y)/2*-.5})}gestureBeginsVertically(n,c,g){if(this._valid!==void 0)return this._valid;const b=n.mag()>=2,E=c.mag()>=2;if(!b&&!E)return;if(!b||!E)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const L=n.y>0==c.y>0;return qa(n)&&qa(c)&&L}}const Ad={panStep:100,bearingStep:15,pitchStep:10};class Zo{constructor(){const n=Ad;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let c=0,g=0,b=0,E=0,L=0;switch(n.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:n.shiftKey?g=-1:(n.preventDefault(),E=-1);break;case 39:n.shiftKey?g=1:(n.preventDefault(),E=1);break;case 38:n.shiftKey?b=1:(n.preventDefault(),L=-1);break;case 40:n.shiftKey?b=-1:(n.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(g=0,b=0),{cameraAnimation:D=>{const F=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:Qf,zoom:c?Math.round(F)+c*(n.shiftKey?2:1):F,bearing:D.getBearing()+g*this._bearingStep,pitch:D.getPitch()+b*this._pitchStep,offset:[-E*this._panStep,-L*this._panStep],center:D.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Qf(f){return f*(2-f)}const Md=4.000244140625;class ep{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=n.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const g=s.exported.now(),b=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,c!==0&&c%Md==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(b*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),n.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=n,this._delta-=c,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=ze(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>Md?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&W!==0&&(W=1/W);const H=c(),Q=Math.pow(2,H),he=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(he*W))),this._type==="wheel"&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:c(),b=this._startZoom,E=this._easing;let L,D=!1;if(this._type==="wheel"&&b&&E){const F=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),W=E(F);L=s.number(b,g,W),F<1?this._frameId||(this._frameId=!0):D=!0}else L=g,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:L-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let c=s.ease;if(this._prevEase){const g=this._prevEase,b=(s.exported.now()-g.start)/g.duration,E=g.easing(b+.01)-g.easing(b),L=.27/Math.sqrt(E*E+1e-4)*.01,D=Math.sqrt(.0729-L*L);c=s.bezier(L,D,.25,1)}return this._prevEase={start:s.exported.now(),duration:n,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ue("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Id{constructor(n,c){this._clickZoom=n,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,c){return n.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(n.shiftKey?-1:1),around:g.unproject(c)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pm{constructor(){this._tap=new Ha({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,c,g){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=c[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(n,c,g))}touchmove(n,c,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const b=c[0],E=b.y-this._swipePoint.y;return this._swipePoint=b,n.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(n,c,g)}touchend(n,c,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(n,c,g)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oh{constructor(n,c,g){this._el=n,this._mousePan=c,this._touchPan=g}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Lm{constructor(n,c,g){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=c,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tp{constructor(n,c,g,b){this._el=n,this._touchZoom=c,this._touchRotate=g,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ro=f=>f.zoom||f.drag||f.pitch||f.rotate;class ip extends s.Event{}class rp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,c){const g=s.sub([],c,n);this.radius=s.length(g[2]<0?s.div([],g,this.constants):[g[0],g[1],0])}projectRay(n){s.div(n,n,this.constants),s.normalize(n,n),s.mul$1(n,n,this.constants);const c=s.scale$2([],n,this.radius);if(c[2]>0){const g=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),b=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),E=s.add([],c,s.scale$2([],s.sub([],s.add([],b,g),c),2));c[0]=E[0],c[1]=E[1]}return c}}function Co(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Yo{constructor(n,c){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fi(n),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new rp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[b,E,L]of this._listeners)b.addEventListener(E,b===s.window.document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[n,c,g]of this._listeners)n.removeEventListener(c,n===s.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(n){const c=this._map,g=c.getCanvasContainer();this._add("mapEvent",new cc(c,n));const b=c.boxZoom=new Zf(c,n);this._add("boxZoom",b);const E=new km,L=new gs;c.doubleClickZoom=new Id(L,E),this._add("tapZoom",E),this._add("clickZoom",L);const D=new Pm;this._add("tapDragZoom",D);const F=c.touchPitch=new Cd(c);this._add("touchPitch",F);const W=new Ed(n),H=new ou(n);c.dragRotate=new Lm(n,W,H),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const Q=new uc(n),he=new au(c,n);c.dragPan=new oh(g,Q,he),this._add("mousePan",Q),this._add("touchPan",he,["touchZoom","touchRotate"]);const me=new Jf,ye=new Kf;c.touchZoomRotate=new tp(g,ye,me,D),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",ye,["touchPan","touchRotate"]),this._add("blockableMapEvent",new nu(c));const _e=c.scrollZoom=new ep(c,this);this._add("scrollZoom",_e,["mousePan"]);const be=c.keyboard=new Zo;this._add("keyboard",be);for(const ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[ee]&&c[ee].enable(n[ee])}_add(n,c,g){this._handlers.push({handlerName:n,handler:c,allowed:g}),this._handlersById[n]=c}stop(n){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ro(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,c,g){for(const b in n)if(b!==g&&(!c||c.indexOf(b)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const c=[];for(const g of n)this._el.contains(g.target)&&c.push(g);return c}handleEvent(n,c){this._updatingCamera=!0;const g=n.type==="renderFrame",b=g?void 0:n,E={needsRenderFrame:!1},L={},D={},F=n.touches?this._getMapTouches(n.touches):void 0,W=F?rt(this._el,F):g?void 0:ze(this._el,n);for(const{handlerName:he,handler:me,allowed:ye}of this._handlers){if(!me.isEnabled())continue;let _e;this._blockedByActive(D,ye,he)?me.reset():me[c||n.type]&&(_e=me[c||n.type](n,W,F),this.mergeHandlerResult(E,L,_e,he,b),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||me.isActive())&&(D[he]=me)}const H={};for(const he in this._previousActiveHandlers)D[he]||(H[he]=b);this._previousActiveHandlers=D,(Object.keys(H).length||Co(E))&&(this._changes.push([E,L,H]),this._triggerRenderFrame()),(Object.keys(D).length||Co(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=E;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(n,c,g,b,E){if(!g)return;s.extend(n,g);const L={handlerName:b,originalEvent:g.originalEvent||E};g.zoomDelta!==void 0&&(c.zoom=L),g.panDelta!==void 0&&(c.drag=L),g.pitchDelta!==void 0&&(c.pitch=L),g.bearingDelta!==void 0&&(c.rotate=L)}_applyChanges(){const n={},c={},g={};for(const[b,E,L]of this._changes)b.panDelta&&(n.panDelta=(n.panDelta||new s.Point(0,0))._add(b.panDelta)),b.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(n.around=b.around),b.aroundCoord!==void 0&&(n.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(n.pinchAround=b.pinchAround),b.noInertia&&(n.noInertia=b.noInertia),s.extend(c,E),s.extend(g,L);this._updateMapTransform(n,c,g),this._changes=[]}_updateMapTransform(n,c,g){const b=this._map,E=b.transform,L=pe=>[pe.x,pe.y,pe.z];if((pe=>{const Ce=this._eventsInProgress.drag;return Ce&&!this._handlersById[Ce.handlerName].isActive()})()&&!Co(n)){const pe=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",pe!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&b._stop(!0),!Co(n))return void this._fireEvents(c,g,!0);let{panDelta:D,zoomDelta:F,bearingDelta:W,pitchDelta:H,around:Q,aroundCoord:he,pinchAround:me}=n;E._isCameraConstrained&&(F>0&&(F=0),E._isCameraConstrained=!1),me!==void 0&&(Q=me),(F||(pe=>c[pe]&&!this._eventsInProgress[pe])("drag"))&&Q&&(this._dragOrigin=L(E.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",b._stop(!0),Q=Q||b.transform.centerPoint,W&&(E.bearing+=W),H&&(E.pitch+=H),E._updateCameraState();const ye=[0,0,0];if(D)if(E.projection.name==="mercator"){const pe=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Q).dir),Ce=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Q.sub(D)).dir);ye[0]=Ce[0]-pe[0],ye[1]=Ce[1]-pe[1]}else{const pe=E.pointCoordinate(Q);if(E.projection.name==="globe"){D=D.rotate(-E.angle);const Ce=E._pixelsPerMercatorPixel/E.worldSize;ye[0]=-D.x*s.mercatorScale(s.latFromMercatorY(pe.y))*Ce,ye[1]=-D.y*s.mercatorScale(E.center.lat)*Ce}else{const Ce=E.pointCoordinate(Q.sub(D));pe&&Ce&&(ye[0]=Ce.x-pe.x,ye[1]=Ce.y-pe.y)}}const _e=E.zoom,be=[0,0,0];if(F){const pe=L(he||E.pointCoordinate3D(Q)),Ce={dir:s.normalize([],s.sub([],pe,E._camera.position))};if(Ce.dir[2]<0){const Ie=E.zoomDeltaToMovement(pe,F);s.scale$2(be,Ce.dir,Ie)}}const ee=s.add(ye,ye,be);E._translateCameraConstrained(ee),F&&Math.abs(E.zoom-_e)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(c,g,!0)}_fireEvents(n,c,g){const b=ro(this._eventsInProgress),E=ro(n),L={};for(const H in n){const{originalEvent:Q}=n[H];this._eventsInProgress[H]||(L[`${H}start`]=Q),this._eventsInProgress[H]=n[H]}!b&&E&&this._fireEvent("movestart",E.originalEvent);for(const H in L)this._fireEvent(H,L[H]);E&&this._fireEvent("move",E.originalEvent);for(const H in n){const{originalEvent:Q}=n[H];this._fireEvent(H,Q)}const D={};let F;for(const H in this._eventsInProgress){const{handlerName:Q,originalEvent:he}=this._eventsInProgress[H];this._handlersById[Q].isActive()||(delete this._eventsInProgress[H],F=c[Q]||he,D[`${H}end`]=F)}for(const H in D)this._fireEvent(H,D[H]);const W=ro(this._eventsInProgress);if(g&&(b||E)&&!W){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=he=>he!==0&&-this._bearingSnap<he&&he<this._bearingSnap;H?(Q(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:F})):(this._map.fire(new s.Event("moveend",{originalEvent:F})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,c){this._map.fire(new s.Event(n,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new ip("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const vl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ta extends s.Evented{constructor(n,c){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,c){return this.jumpTo({center:n},c)}panBy(n,c,g){return n=s.Point.convert(n).mult(-1),this.panTo(this.transform.center,s.extend({offset:n},c),g)}panTo(n,c,g){return this.easeTo(s.extend({center:n},c),g)}getZoom(){return this.transform.zoom}setZoom(n,c){return this.jumpTo({zoom:n},c),this}zoomTo(n,c,g){return this.easeTo(s.extend({zoom:n},c),g)}zoomIn(n,c){return this.zoomTo(this.getZoom()+1,n,c),this}zoomOut(n,c){return this.zoomTo(this.getZoom()-1,n,c),this}getBearing(){return this.transform.bearing}setBearing(n,c){return this.jumpTo({bearing:n},c),this}getPadding(){return this.transform.padding}setPadding(n,c){return this.jumpTo({padding:n},c),this}rotateTo(n,c,g){return this.easeTo(s.extend({bearing:n},c),g)}resetNorth(n,c){return this.rotateTo(0,s.extend({duration:1e3},n),c),this}resetNorthPitch(n,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},n),c),this}snapToNorth(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this}getPitch(){return this.transform.pitch}setPitch(n,c){return this.jumpTo({pitch:n},c),this}cameraForBounds(n,c){n=s.LngLatBounds.convert(n);const g=c&&c.bearing||0,b=c&&c.pitch||0,E=n.getNorthWest(),L=n.getSouthEast();return this._cameraForBounds(this.transform,E,L,g,b,c)}_extendCameraOptions(n){const c={top:0,bottom:0,right:0,left:0};if(typeof(n=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=="number"){const g=n.padding;n.padding={top:g,bottom:g,right:g,left:g}}return n.padding=s.extend(c,n.padding),n}_minimumAABBFrustumDistance(n,c){const g=c.max[0]-c.min[0],b=c.max[1]-c.min[1];return g/b>n.aspect?g/(2*Math.tan(.5*n.fovX)*n.aspect):b/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,c,g,b,E,L){const D=n.clone(),F=this._extendCameraOptions(L);D.bearing=b,D.pitch=E;const W=s.LngLat.convert(c),H=s.LngLat.convert(g),Q=.5*(W.lat+H.lat),he=.5*(W.lng+H.lng),me=s.latLngToECEF(Q,he),ye=s.normalize([],me),_e=s.normalize([],s.cross([],ye,[0,1,0])),be=s.cross([],_e,ye),ee=[_e[0],_e[1],_e[2],0,be[0],be[1],be[2],0,ye[0],ye[1],ye[2],0,0,0,0,1],pe=[me,s.latLngToECEF(W.lat,W.lng),s.latLngToECEF(H.lat,W.lng),s.latLngToECEF(H.lat,H.lng),s.latLngToECEF(W.lat,H.lng),s.latLngToECEF(Q,W.lng),s.latLngToECEF(Q,H.lng),s.latLngToECEF(W.lat,he),s.latLngToECEF(H.lat,he)];let Ce=s.Aabb.fromPoints(pe.map(Et=>[s.dot(_e,Et),s.dot(be,Et),s.dot(ye,Et)]));const Ie=s.transformMat4([],Ce.center,ee);s.squaredLength(Ie)===0&&s.set(Ie,0,0,1),s.normalize(Ie,Ie),s.scale$2(Ie,Ie,s.GLOBE_RADIUS),D.center=s.ecefToLatLng(Ie);const Ge=D.getWorldToCameraMatrix(),Fe=s.invert(new Float64Array(16),Ge);Ce=s.Aabb.applyTransform(Ce,s.multiply([],Ge,ee)),s.transformMat4(Ie,Ie,Ge);const We=.5*(Ce.max[2]-Ce.min[2]),it=this._minimumAABBFrustumDistance(D,Ce),et=s.scale$2([],[0,0,1],We),pt=s.add(et,Ie,et),Nt=it+(D.pitch===0?0:s.distance(Ie,pt)),ht=D.globeCenterInViewSpace,Ct=s.sub([],Ie,[ht[0],ht[1],ht[2]]);s.normalize(Ct,Ct),s.scale$2(Ct,Ct,Nt);const yt=s.add([],Ie,Ct);s.transformMat4(yt,yt,Fe);const jt=s.earthRadius/s.GLOBE_RADIUS,at=s.length(yt),Mt=s.mercatorZfromAltitude(Math.max(at*jt-s.earthRadius,Number.EPSILON),0),Gt=Math.min(D.zoomFromMercatorZAdjusted(Mt),F.maxZoom);return Gt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"mercator"}),D.zoom=Gt,this._cameraForBounds(D,c,g,b,E,L)):{center:D.center,zoom:Gt,bearing:b,pitch:E}}queryTerrainElevation(n,c){const g=this.transform.elevation;return g?(c=s.extend({},{exaggerated:!0},c),g.getAtPoint(s.MercatorCoordinate.fromLngLat(n),null,c.exaggerated)):null}_cameraForBounds(n,c,g,b,E,L){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,c,g,b,E,L);const D=n.clone(),F=this._extendCameraOptions(L),W=D.padding;D.bearing=b,D.pitch=E;const H=s.LngLat.convert(c),Q=s.LngLat.convert(g),he=new s.LngLat(H.lng,Q.lat),me=new s.LngLat(Q.lng,H.lat),ye=D.project(H),_e=D.project(Q),be=this.queryTerrainElevation(H),ee=this.queryTerrainElevation(Q),pe=this.queryTerrainElevation(he),Ce=this.queryTerrainElevation(me),Ie=[[ye.x,ye.y,Math.min(be||0,ee||0,pe||0,Ce||0)],[_e.x,_e.y,Math.max(be||0,ee||0,pe||0,Ce||0)]];let Ge=s.Aabb.fromPoints(Ie);const Fe=D.getWorldToCameraMatrix(),We=s.invert(new Float64Array(16),Fe);Ge=s.Aabb.applyTransform(Ge,Fe);const it=s.sub([],Ge.max,Ge.min),et=W.left||0,pt=W.right||0,Nt=W.bottom||0,ht=W.top||0,{left:Ct,right:yt,top:jt,bottom:at}=F.padding,Mt=.5*(et+pt),Gt=.5*(ht+Nt),Et=Math.min(D.scaleZoom(D.scale*Math.min((D.width-(et+pt+Ct+yt))/it[0],(D.height-(Nt+ht+at+jt))/it[1])),F.maxZoom),Xt=D.scale/D.zoomScale(Et);Ge=new s.Aabb([Ge.min[0]-(Ct+Mt)*Xt,Ge.min[1]-(at+Gt)*Xt,Ge.min[2]],[Ge.max[0]+(yt+Mt)*Xt,Ge.max[1]+(jt+Gt)*Xt,Ge.max[2]]);const ki=.5*it[2],Ni=this._minimumAABBFrustumDistance(D,Ge),bi=[0,0,1,0];s.transformMat4$1(bi,bi,Fe),s.normalize$2(bi,bi);const Li=s.scale$2([],bi,Ni+ki),Wi=s.add([],Ge.center,Li),Hi=(typeof F.offset.x=="number"&&typeof F.offset.y=="number"?new s.Point(F.offset.x,F.offset.y):s.Point.convert(F.offset)).rotate(-s.degToRad(b));Ge.center[0]-=Hi.x*Xt,Ge.center[1]+=Hi.y*Xt,s.transformMat4(Ge.center,Ge.center,We),s.transformMat4(Wi,Wi,We);const Ai=[Ge.center[0],Ge.center[1],Wi[2]*D.pixelsPerMeter];s.scale$2(Ai,Ai,1/D.worldSize);const Mr=s.lngFromMercatorX(Ai[0]),Dr=s.latFromMercatorY(Ai[1]),Or=Math.min(D._zoomFromMercatorZ(Ai[2]),F.maxZoom),Rr=new s.LngLat(Mr,Dr);return D.mercatorFromTransition&&Or<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"globe"}),D.zoom=Or,this._cameraForBounds(D,c,g,b,E,L)):{center:Rr,zoom:Or,bearing:b,pitch:E}}fitBounds(n,c,g){const b=this.cameraForBounds(n,c);return this._fitInternal(b,c,g)}fitScreenCoordinates(n,c,g,b,E){const L=s.Point.convert(n),D=s.Point.convert(c),F=new s.Point(Math.min(L.x,D.x),Math.min(L.y,D.y)),W=new s.Point(Math.max(L.x,D.x),Math.max(L.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(L,D))return this;const H=this.transform.pointLocation3D(F),Q=this.transform.pointLocation3D(W),he=this.transform.pointLocation3D(new s.Point(F.x,W.y)),me=this.transform.pointLocation3D(new s.Point(W.x,F.y)),ye=[Math.min(H.lng,Q.lng,he.lng,me.lng),Math.min(H.lat,Q.lat,he.lat,me.lat)],_e=[Math.max(H.lng,Q.lng,he.lng,me.lng),Math.max(H.lat,Q.lat,he.lat,me.lat)],be=b&&b.pitch?b.pitch:this.getPitch(),ee=this._cameraForBounds(this.transform,ye,_e,g,be,b);return this._fitInternal(ee,b,E)}_fitInternal(n,c,g){return n?(delete(c=s.extend(n,c)).padding,c.linear?this.easeTo(c,g):this.flyTo(c,g)):this}jumpTo(n,c){this.stop();const g=n.preloadOnly?this.transform.clone():this.transform;let b=!1,E=!1,L=!1;return"zoom"in n&&g.zoom!==+n.zoom&&(b=!0,g.zoom=+n.zoom),n.center!==void 0&&(g.center=s.LngLat.convert(n.center)),"bearing"in n&&g.bearing!==+n.bearing&&(E=!0,g.bearing=+n.bearing),"pitch"in n&&g.pitch!==+n.pitch&&(L=!0,g.pitch=+n.pitch),n.padding==null||g.isPaddingEqual(n.padding)||(g.padding=n.padding),n.preloadOnly?(this._preloadTiles(g),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),b&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),E&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),L&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(vl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,c){const g=this.transform;if(!g.projection.supportsFreeCamera)return s.warnOnce(vl),this;this.stop();const b=g.zoom,E=g.pitch,L=g.bearing;g.setFreeCameraOptions(n);const D=b!==g.zoom,F=E!==g.pitch,W=L!==g.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),D&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),W&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),F&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(n,c){this._stop(!1,n.easeId),((n=s.extend({offset:[0,0],duration:500,easing:s.ease},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const g=this.transform,b=this.getZoom(),E=this.getBearing(),L=this.getPitch(),D=this.getPadding(),F="zoom"in n?+n.zoom:b,W="bearing"in n?this._normalizeBearing(n.bearing,E):E,H="pitch"in n?+n.pitch:L,Q="padding"in n?n.padding:g.padding,he=s.Point.convert(n.offset);let me,ye,_e;if(g.projection.name==="globe"){const et=s.MercatorCoordinate.fromLngLat(g.center),pt=he.rotate(-g.angle);et.x+=pt.x/g.worldSize,et.y+=pt.y/g.worldSize;const Nt=et.toLngLat(),ht=s.LngLat.convert(n.center||Nt);this._normalizeCenter(ht),me=g.centerPoint.add(pt),ye=new s.Point(et.x,et.y).mult(g.worldSize),_e=new s.Point(s.mercatorXfromLng(ht.lng),s.mercatorYfromLat(ht.lat)).mult(g.worldSize).sub(ye)}else{me=g.centerPoint.add(he);const et=g.pointLocation(me),pt=s.LngLat.convert(n.center||et);this._normalizeCenter(pt),ye=g.project(et),_e=g.project(pt).sub(ye)}const be=g.zoomScale(F-b);let ee,pe;n.around&&(ee=s.LngLat.convert(n.around),pe=g.locationPoint(ee));const Ce=this._zooming||F!==b,Ie=this._rotating||E!==W,Ge=this._pitching||H!==L,Fe=!g.isPaddingEqual(Q),We=et=>pt=>{if(Ce&&(et.zoom=s.number(b,F,pt)),Ie&&(et.bearing=s.number(E,W,pt)),Ge&&(et.pitch=s.number(L,H,pt)),Fe&&(et.interpolatePadding(D,Q,pt),me=et.centerPoint.add(he)),ee)et.setLocationAtPoint(ee,pe);else{const Nt=et.zoomScale(et.zoom-b),ht=F>b?Math.min(2,be):Math.max(.5,be),Ct=Math.pow(ht,1-pt),yt=et.unproject(ye.add(_e.mult(pt*Ct)).mult(Nt));et.setLocationAtPoint(et.renderWorldCopies?yt.wrap():yt,me)}return n.preloadOnly||this._fireMoveEvents(c),et};if(n.preloadOnly){const et=this._emulate(We,n.duration,g);return this._preloadTiles(et),this}const it={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ce,this._rotating=Ie,this._pitching=Ge,this._padding=Fe,this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,it),this._ease(We(g),et=>{g.recenterOnTerrain(),this._afterEase(c,et)},n),this}_prepareEase(n,c,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||g.moving||this.fire(new s.Event("movestart",n)),this._zooming&&!g.zooming&&this.fire(new s.Event("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new s.Event("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new s.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new s.Event("move",n)),this._zooming&&this.fire(new s.Event("zoom",n)),this._rotating&&this.fire(new s.Event("rotate",n)),this._pitching&&this.fire(new s.Event("pitch",n))}_afterEase(n,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,b=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new s.Event("zoomend",n)),b&&this.fire(new s.Event("rotateend",n)),E&&this.fire(new s.Event("pitchend",n)),this.fire(new s.Event("moveend",n))}flyTo(n,c){if(this._prefersReducedMotion(n)){const Et=s.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Et,c)}this.stop(),n=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},n);const g=this.transform,b=this.getZoom(),E=this.getBearing(),L=this.getPitch(),D=this.getPadding(),F="zoom"in n?s.clamp(+n.zoom,g.minZoom,g.maxZoom):b,W="bearing"in n?this._normalizeBearing(n.bearing,E):E,H="pitch"in n?+n.pitch:L,Q="padding"in n?n.padding:g.padding,he=g.zoomScale(F-b),me=s.Point.convert(n.offset);let ye=g.centerPoint.add(me);const _e=g.pointLocation(ye),be=s.LngLat.convert(n.center||_e);this._normalizeCenter(be);const ee=g.project(_e),pe=g.project(be).sub(ee);let Ce=n.curve;const Ie=Math.max(g.width,g.height),Ge=Ie/he,Fe=pe.mag();if("minZoom"in n){const Et=s.clamp(Math.min(n.minZoom,b,F),g.minZoom,g.maxZoom),Xt=Ie/g.zoomScale(Et-b);Ce=Math.sqrt(Xt/Fe*2)}const We=Ce*Ce;function it(Et){const Xt=(Ge*Ge-Ie*Ie+(Et?-1:1)*We*We*Fe*Fe)/(2*(Et?Ge:Ie)*We*Fe);return Math.log(Math.sqrt(Xt*Xt+1)-Xt)}function et(Et){return(Math.exp(Et)-Math.exp(-Et))/2}function pt(Et){return(Math.exp(Et)+Math.exp(-Et))/2}const Nt=it(0);let ht=function(Et){return pt(Nt)/pt(Nt+Ce*Et)},Ct=function(Et){return Ie*((pt(Nt)*(et(Xt=Nt+Ce*Et)/pt(Xt))-et(Nt))/We)/Fe;var Xt},yt=(it(1)-Nt)/Ce;if(Math.abs(Fe)<1e-6||!isFinite(yt)){if(Math.abs(Ie-Ge)<1e-6)return this.easeTo(n,c);const Et=Ge<Ie?-1:1;yt=Math.abs(Math.log(Ge/Ie))/Ce,Ct=function(){return 0},ht=function(Xt){return Math.exp(Et*Ce*Xt)}}n.duration="duration"in n?+n.duration:1e3*yt/("screenSpeed"in n?+n.screenSpeed/Ce:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const jt=E!==W,at=H!==L,Mt=!g.isPaddingEqual(Q),Gt=Et=>Xt=>{const ki=Xt*yt,Ni=1/ht(ki);Et.zoom=Xt===1?F:b+Et.scaleZoom(Ni),jt&&(Et.bearing=s.number(E,W,Xt)),at&&(Et.pitch=s.number(L,H,Xt)),Mt&&(Et.interpolatePadding(D,Q,Xt),ye=Et.centerPoint.add(me));const bi=Xt===1?be:Et.unproject(ee.add(pe.mult(Ct(ki))).mult(Ni));return Et.setLocationAtPoint(Et.renderWorldCopies?bi.wrap():bi,ye),Et._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(c),Et};if(n.preloadOnly){const Et=this._emulate(Gt,n.duration,g);return this._preloadTiles(Et),this}return this._zooming=!0,this._rotating=jt,this._pitching=at,this._padding=Mt,this._prepareEase(c,!1),this._ease(Gt(g),()=>this._afterEase(c),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,c)}if(!n){const g=this.handlers;g&&g.stop(!1)}return this}_ease(n,c,g){g.animate===!1||g.duration===0?(n(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,c){n=s.wrap(n,-180,180);const g=Math.abs(n-c);return Math.abs(n-360-c)<g&&(n-=360),Math.abs(n+360-c)<g&&(n+=360),n}_normalizeCenter(n){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const g=n.lng-c.center.lng;n.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,c,g){const b=Math.ceil(15*c/1e3),E=[],L=n(g.clone());for(let D=0;D<=b;D++){const F=L(D/b);E.push(F.clone())}return E}}class yi{constructor(n={}){this.options=n,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const c=this.options&&this.options.compact;return this._map=n,this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ue("button","mapboxgl-ctrl-attrib-button",this._container),ue("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ue("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(n,c){const g=this._map._getUIString(`AttributionControl.${c}`);n.setAttribute("aria-label",g),n.removeAttribute("title"),n.firstElementChild&&n.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(n){const g=c.reduce((b,E,L)=>(E.value&&(b+=`${E.key}=${E.value}${L<c.length-1?"&":""}`),b),"?");n.href=`${s.config.FEEDBACK_URL}/${g}#${yl(this._map,!0)}`,n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const c=this._map.style._sourceCaches;for(const b in c){const E=c[b];if(E.used){const L=E.getSource();L.attribution&&n.indexOf(L.attribution)<0&&n.push(L.attribution)}}n.sort((b,E)=>b.length-E.length),n=n.filter((b,E)=>{for(let L=E+1;L<n.length;L++)if(n[L].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const g=n.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class kd{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=ue("div","mapboxgl-ctrl");const c=ue("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const c in n){const g=n[c].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Pd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const c=++this._id;return this._queue.push({callback:n,id:c,cancelled:!1}),c}remove(n){const c=this._currentlyRunning,g=c?this._queue.concat(c):this._queue;for(const b of g)if(b.id===n)return void(b.cancelled=!0)}run(n=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const g of c)if(!g.cancelled&&(g.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function bl(f,n,c){if(f=new s.LngLat(f.lng,f.lat),n){const g=new s.LngLat(f.lng-360,f.lat),b=new s.LngLat(f.lng+360,f.lat),E=360*Math.ceil(Math.abs(f.lng-c.center.lng)/360),L=c.locationPoint(f).distSqr(n),D=n.x<0||n.y<0||n.x>c.width||n.y>c.height;c.locationPoint(g).distSqr(n)<L&&(D||Math.abs(g.lng-c.center.lng)<E)?f=g:c.locationPoint(b).distSqr(n)<L&&(D||Math.abs(b.lng-c.center.lng)<E)&&(f=b)}for(;Math.abs(f.lng-c.center.lng)>180;){const g=c.locationPoint(f);if(g.x>=0&&g.y>=0&&g.x<=c.width&&g.y<=c.height)break;f.lng>c.center.lng?f.lng-=360:f.lng+=360}return f}const Xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class li extends s.Evented{constructor(n,c){if(super(),(n instanceof s.window.HTMLElement||c)&&(n=s.extend({element:n},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=n&&n.occludedOpacity||.2,n&&n.element)this._element=n.element,this._offset=s.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=ue("div");const b=41,E=27,L=we("svg",{display:"block",height:b*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${b}`},this._element),D=we("radialGradient",{id:"shadowGradient"},we("defs",{},L));we("stop",{offset:"10%","stop-opacity":.4},D),we("stop",{offset:"100%","stop-opacity":.05},D),we("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),we("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),we("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),we("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=s.Point.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const g=this._element.classList;for(const b in Xa)g.remove(`mapboxgl-marker-anchor-${b}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=s.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const c=n.code,g=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(n){const c=n.originalEvent.target,g=this._element;this._popup&&(c===g||g.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,c=this._pos;if(!n||!c)return!1;const g=n.unproject(c),b=n.getFreeCameraOptions();if(!b.position)return!1;const E=b.position.toLngLat();return E.distanceTo(g)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const c=this._pos;if(!c||c.x<0||c.x>n.transform.width||c.y<0||c.y>n.transform.height)return void this._clearFadeTimer();const g=n.unproject(c);let b;n._showingGlobe()&&s.isLngLatBehindGlobe(n.transform,this._lngLat)?b=0:(b=1-n._queryFogOpacity(g),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${Xa[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const n=this._pos,c=this._map,g=this.getPitchAlignment();if(!c||!n||g!=="map")return"";if(!c._showingGlobe()){const F=c.getPitch();return F?`rotateX(${F}deg)`:""}const b=s.radToDeg(s.globeTiltAtLngLat(c.transform,this._lngLat)),E=n.sub(s.globeCenterToScreenPoint(c.transform)),L=Math.abs(E.x)+Math.abs(E.y);if(L===0)return"";const D=b/L;return`rotateX(${-E.y*D}deg) rotateY(${E.x*D}deg)`}_calculateZTransform(){const n=this._pos,c=this._map;if(!c||!n)return"";let g=0;const b=this.getRotationAlignment();if(b==="map")if(c._showingGlobe()){const E=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),L=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);g=s.radToDeg(Math.atan2(L.y,L.x))-90}else g=-c.getBearing();else if(b==="horizon"){const E=s.smoothstep(4,6,c.getZoom()),L=s.globeCenterToScreenPoint(c.transform);L.y+=E*c.transform.height;const D=n.sub(L),F=s.radToDeg(Math.atan2(D.y,D.x));g=(F>90?F-270:F+90)*(1-E)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(n){s.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=bl(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),n===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=s.Point.convert(n),this._update(),this}_onMove(n){const c=this._map;if(!c)return;const g=this._pointerdownPos,b=this._positionDelta;if(g&&b){if(!this._isDragging){const E=this._clickTolerance||c._clickTolerance;if(n.point.dist(g)<E)return;this._isDragging=!0}this._pos=n.point.sub(b),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(n){const c=this._map,g=this._pos;c&&g&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(g),this._pointerdownPos=n.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const c=this._map;return c&&(n?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ld={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Dm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function cu(f=new s.Point(0,0),n="bottom"){if(typeof f=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(n){case"top":return new s.Point(0,f);case"top-left":return new s.Point(c,c);case"top-right":return new s.Point(-c,c);case"bottom":return new s.Point(0,-f);case"bottom-left":return new s.Point(c,-c);case"bottom-right":return new s.Point(-c,-c);case"left":return new s.Point(f,0);case"right":return new s.Point(-f,0)}return new s.Point(0,0)}return f instanceof s.Point||Array.isArray(f)?s.Point.convert(f):s.Point.convert(f[n]||[0,0])}class Dd{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const c=s.easeCubicInOut((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,c,g){this._start=this.getValue(c),this._end=n,this._startTime=c,this._endTime=c+g}}const wl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},np={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Od={showCompass:!0,showZoom:!0,visualizePitch:!1};class Om{constructor(n,c,g=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Ed({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,g&&(this.mousePitch=new ou({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(n,c){this.mouseRotate.mousedown(n,c),this.mousePitch&&this.mousePitch.mousedown(n,c),je()}move(n,c){const g=this.map,b=this.mouseRotate.mousemoveWindow(n,c),E=b&&b.bearingDelta;if(E&&g.setBearing(g.getBearing()+E),this.mousePitch){const L=this.mousePitch.mousemoveWindow(n,c),D=L&&L.pitchDelta;D&&g.setPitch(g.getPitch()+D)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ae(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(s.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),ze(this.element,n)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,ze(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=rt(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=rt(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ah={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},hu={maxWidth:100,unit:"metric"},Rd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},dc={version:s.version,supported:Z,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Ta{constructor(f){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(f=s.extend({},np,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(f.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ar(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Pd,this._domRenderTaskQueue=new Pd,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},wl,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Dd(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=s.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Yo(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new ru(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,s.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new yi({customAttribution:f.customAttribution})),this._logoControl=new kd,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new s.Event(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new s.Event(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(f,n){if(n===void 0&&(n=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=f.onAdd(this);this._controls.push(f);const g=this._controlPositions[n];return n.indexOf("bottom")!==-1?g.insertBefore(c,g.firstChild):g.appendChild(c),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(f);return n>-1&&this._controls.splice(n,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new s.Event("movestart",f)).fire(new s.Event("move",f)),this.fire(new s.Event("resize",f)),n&&this.fire(new s.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(s.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?s.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(n=>n==="auto"?s.window.navigator.language:n):f}setLanguage(f){const n=this._parseLanguage(f);if(!this.style||n===this._language)return this;this._language=n,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,n=f.projection.name;let c;n==="globe"&&f.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),c=!0):n==="mercator"&&f.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,n){return this._updateProjection(f||n||{name:"mercator"})}_updateProjection(f){let n;if(n=f.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),n){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(s.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(s.Point.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,n,c){if(f==="mouseenter"||f==="mouseover"){let g=!1;const b=L=>{const D=n.filter(W=>this.getLayer(W)),F=D.length?this.queryRenderedFeatures(L.point,{layers:D}):[];F.length?g||(g=!0,c.call(this,new rs(f,this,L.originalEvent,{features:F}))):g=!1},E=()=>{g=!1};return{layers:new Set(n),listener:c,delegates:{mousemove:b,mouseout:E}}}if(f==="mouseleave"||f==="mouseout"){let g=!1;const b=L=>{const D=n.filter(F=>this.getLayer(F));(D.length?this.queryRenderedFeatures(L.point,{layers:D}):[]).length?g=!0:g&&(g=!1,c.call(this,new rs(f,this,L.originalEvent)))},E=L=>{g&&(g=!1,c.call(this,new rs(f,this,L.originalEvent)))};return{layers:new Set(n),listener:c,delegates:{mousemove:b,mouseout:E}}}{const g=b=>{const E=n.filter(D=>this.getLayer(D)),L=E.length?this.queryRenderedFeatures(b.point,{layers:E}):[];L.length&&(b.features=L,c.call(this,b),delete b.features)};return{layers:new Set(n),listener:c,delegates:{[f]:g}}}}on(f,n,c){if(c===void 0)return super.on(f,n);Array.isArray(n)||(n=[n]);const g=this._createDelegatedListener(f,n,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(g);for(const b in g.delegates)this.on(b,g.delegates[b]);return this}once(f,n,c){if(c===void 0)return super.once(f,n);Array.isArray(n)||(n=[n]);const g=this._createDelegatedListener(f,n,c);for(const b in g.delegates)this.once(b,g.delegates[b]);return this}off(f,n,c){if(c===void 0)return super.off(f,n);n=new Set(Array.isArray(n)?n:[n]);const g=(E,L)=>{if(E.size!==L.size)return!1;for(const D of E)if(!L.has(D))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[f]:void 0;return b&&(E=>{for(let L=0;L<E.length;L++){const D=E[L];if(D.listener===c&&g(D.layers,n)){for(const F in D.delegates)this.off(F,D.delegates[F]);return E.splice(L,1),this}}})(b),this}queryRenderedFeatures(f,n){return this.style?(n!==void 0||f===void 0||f instanceof s.Point||Array.isArray(f)||(n=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(f,n){return this.style.querySourceFeatures(f,n)}isPointOnSurface(f){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&s.warnOnce(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(f))}setStyle(f,n){return(n=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(f,n))}_getUIString(f){const n=this._locale[f];if(n==null)throw new Error(`Missing UI string '${f}'`);return n}_updateStyle(f,n){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Ho(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ho(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,n){if(typeof f=="string"){const c=this._requestManager.normalizeStyleURL(f),g=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(g,(b,E)=>{b?this.fire(new s.ErrorEvent(b)):E&&this._updateDiff(E,n)})}else typeof f=="object"&&this._updateDiff(f,n)}_updateDiff(f,n){try{this.style.setState(f)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(f,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(f,n){return this._lazyInitEmptyStyle(),this.style.addSource(f,n),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const n in f){const c=f[n]._tiles;for(const g in c){const b=c[g];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}addSourceType(f,n,c){this._lazyInitEmptyStyle(),this.style.addSourceType(f,n,c)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,n,{pixelRatio:c=1,sdf:g=!1,stretchX:b,stretchY:E,content:L}={}){if(this._lazyInitEmptyStyle(),n instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&n instanceof s.window.ImageBitmap){const{width:D,height:F,data:W}=s.exported.getImageData(n);this.style.addImage(f,{data:new s.RGBAImage({width:D,height:F},W),pixelRatio:c,stretchX:b,stretchY:E,content:L,sdf:g,version:0})}else if(n.width===void 0||n.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:F}=n,W=n;this.style.addImage(f,{data:new s.RGBAImage({width:D,height:F},new Uint8Array(W.data)),pixelRatio:c,stretchX:b,stretchY:E,content:L,sdf:g,version:0,userImage:W}),W.onAdd&&W.onAdd(this,f)}}updateImage(f,n){const c=this.style.getImage(f);if(!c)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=n instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&n instanceof s.window.ImageBitmap?s.exported.getImageData(n):n,{width:b,height:E}=g;b!==void 0&&E!==void 0?b===c.data.width&&E===c.data.height?(c.data.replace(g.data,!(n instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&n instanceof s.window.ImageBitmap)),this.style.updateImage(f,c)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${b}, ${E})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,n){s.getImage(this._requestManager.transformRequest(f,s.ResourceType.Image),(c,g)=>{n(c,g instanceof s.window.HTMLImageElement?s.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(f,n){return this._lazyInitEmptyStyle(),this.style.addLayer(f,n),this._update(!0)}moveLayer(f,n){return this.style.moveLayer(f,n),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,n,c){return this.style.setLayerZoomRange(f,n,c),this._update(!0)}setFilter(f,n,c={}){return this.style.setFilter(f,n,c),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,n,c,g={}){return this.style.setPaintProperty(f,n,c,g),this._update(!0)}getPaintProperty(f,n){return this.style.getPaintProperty(f,n)}setLayoutProperty(f,n,c,g={}){return this.style.setLayoutProperty(f,n,c,g),this._update(!0)}getLayoutProperty(f,n){return this.style.getLayoutProperty(f,n)}setLight(f,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,n),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(f),this.transform):0}setFeatureState(f,n){return this.style.setFeatureState(f,n),this._update()}removeFeatureState(f,n){return this.style.removeFeatureState(f,n),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let c,g,b,E=this._container;for(;E&&(!g||!b);){const L=s.window.getComputedStyle(E).transform;L&&L!=="none"&&(c=L.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(g=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(b=c[3])),E=E.parentElement}this._containerWidth=g?Math.abs(f/g):f,this._containerHeight=b?Math.abs(n/b):n}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=ue("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=ue("div","mapboxgl-canvas-container",f);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=ue("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=ue("div","mapboxgl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{g[b]=ue("div",`mapboxgl-ctrl-${b}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,n){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(f),this._canvas.height=c*Math.ceil(n),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${n}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const n=this._markers.indexOf(f);n!==-1&&this._markers.splice(n,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const n=this._popups.indexOf(f);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const f=s.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._useWebGL2&&this._canvas.getContext("webgl2",f),c=n||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);c?(this._useWebGL2&&!n&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(c,!0),this.painter=new rc(c,this.transform,!!n),this.on("data",g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(c)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let n;const c=this.painter.context.extTimerQuery,g=s.exported.now();if(this.listens("gpu-timing-frame")&&(n=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,F=this.transform.pitch,W=s.exported.now(),H=new s.EvaluationParameters(D,{now:W,fadeDuration:b,pitch:F,transition:this.style.getTransition()});this.style.update(H)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const D=s.exported.now()-g;c.endQueryEXT(c.TIME_ELAPSED_EXT,n),setTimeout(()=>{const F=c.getQueryObjectEXT(n,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(n),this.fire(new s.Event("gpu-timing-frame",{cpuTime:D,gpuTime:F})),s.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:F}})},50)}if(this.listens("gpu-timing-layer")){const D=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(D);this.fire(new s.Event("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const D=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(D);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:F}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(L||this._repaint)this.triggerRepaint();else{const D=!this.isMoving()&&this.loaded();if(D&&(E=this._updateAverageElevation(g,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),D&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const n of this._markers)f&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!f||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(f,n=!1){const c=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((n||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const g=this.transform.averageElevation;let b=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=f;const L=Math.abs(g-b);if(L>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(b),c(b);this._averageElevation.easeTo(b,f,300)}else if(L>1e-4)return this._averageElevation.jumpTo(b),c(b)}return!!this._averageElevation.isEasing(f)&&c(this._averageElevation.getValue(f))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===s.AUTH_ERR_MSG||f.status===401)){const n=this.painter.context.gl;s.storeAuthState(n,!1),this._logoControl instanceof kd&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const c=this.painter.context.gl,g=c.createFramebuffer();function b(E){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,E,0);const L=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,L),L}return c.bindFramebuffer(c.FRAMEBUFFER,g),this._canvasPixelComparison(b(f),n.canvasCopies.map(b),n.timeStamps)}_canvasPixelComparison(f,n,c){let g=c[1]-c[0];const b=f.length/4;for(let E=0;E<n.length;E++){const L=n[E];let D=0;for(let F=0;F<L.length;F+=4)L[F]===f[F]&&L[F+1]===f[F+1]&&L[F+2]===f[F+2]&&L[F+3]===f[F+3]&&(D+=1);g+=(c[E+2]-c[E+1])*(1-D/b)}return g}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=s.exported.frame(n=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(n)}))}_preloadTiles(f){const n=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(n,(c,g)=>c._preloadTiles(f,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,n){s.setCacheLimits(f,n)}get version(){return s.version}},NavigationControl:class{constructor(f){this.options=s.extend({},Od,f),this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),ue("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),ue("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:n}):c.resetNorth({},{originalEvent:n}))}),this._compassIcon=ue("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const n=f.getZoom(),c=n===f.getMaxZoom(),g=n===f.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Om(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,n){const c=ue("button",f,this._container);return c.type="button",c.addEventListener("click",n),c}_setButtonTitle(f,n){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${n}`);f.setAttribute("aria-label",c),f.firstElementChild&&f.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(f){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},ah,f),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ac(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const n=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,f(c)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>n(c.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(f){const n=this._map.getMaxBounds(),c=f.coords;return!!n&&(c.longitude<n.getWest()||c.longitude>n.getEast()||c.latitude<n.getSouth()||c.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",f)),this._finish()}}_updateCamera(f){const n=new s.LngLat(f.coords.longitude,f.coords.latitude),c=f.coords.accuracy,g=this._map.getBearing(),b=s.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(c),b,{geolocateSource:!0})}_updateMarker(f){if(f){const n=new s.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,n=s.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,c=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=ue("button","mapboxgl-ctrl-geolocate",this._container),ue("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ue("div","mapboxgl-user-location"),this._dotElement.appendChild(ue("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ue("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new li({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ue("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new li({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:yi,ScaleControl:class{constructor(f){this.options=s.extend({},hu,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,n=this._map,c=n._containerHeight/2,g=n._containerWidth/2-f/2,b=n.unproject([g,c]),E=n.unproject([g+f,c]),L=b.distanceTo(E);if(this.options.unit==="imperial"){const D=3.2808*L;D>5280?this._setScale(f,D/5280,"mile"):this._setScale(f,D,"foot")}else this.options.unit==="nautical"?this._setScale(f,L/1852,"nautical-mile"):L>=1e3?this._setScale(f,L/1e3,"kilometer"):this._setScale(f,L,"meter")}_setScale(f,n,c){this._map._requestDomTask(()=>{const g=function(E){const L=Math.pow(10,`${Math.floor(E)}`.length-1);let D=E/L;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(F){const W=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*W)/W}(D),L*D}(n),b=g/n;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(g):`${g}&nbsp;${Rd[c]}`,this._container.style.width=f*b+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof s.window.HTMLElement?this._container=f.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=ue("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ue("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(f){super(),this.options=s.extend(Object.create(Ld),f),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=s.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(s.window.document.createTextNode(f))}setHTML(f){const n=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let g;for(c.innerHTML=f;g=c.firstChild,g;)n.appendChild(g);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=ue("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(f),this.options.closeButton){const c=this._closeButton=ue("button","mapboxgl-popup-close-button",n);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let n;return this._classList.delete(f)?n=!1:(this._classList.add(f),n=!0),this._updateClassList(),n}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const n=this._map,c=this._container,g=this._pos;if(!n||!c||!g)return"bottom";const b=c.offsetWidth,E=c.offsetHeight,L=g.x<b/2,D=g.x>n.transform.width-b/2;if(g.y+f<E)return L?"top-left":D?"top-right":"top";if(g.y>n.transform.height-E){if(L)return"bottom-left";if(D)return"bottom-right"}return L?"left":D?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),f.className=n.join(" ")}_update(f){const n=this._map,c=this._content;if(!n||!this._lngLat&&!this._trackPointer||!c)return;let g=this._container;if(g||(g=this._container=ue("div","mapboxgl-popup",n.getContainer()),this._tip=ue("div","mapboxgl-popup-tip",g),g.appendChild(c)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bl(this._lngLat,this._pos,n.transform)),!this._trackPointer||f){const b=this._pos=this._trackPointer&&f?f:n.project(this._lngLat),E=cu(this.options.offset),L=this._anchor=this._getAnchor(E.y),D=cu(this.options.offset,L),F=b.add(D).round();n._requestDomTask(()=>{this._container&&L&&(this._container.style.transform=`${Xa[L]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&n._showingGlobe()){const b=s.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Dm);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:li,Style:Ho,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:qf,Evented:s.Evented,config:s.config,prewarm:function(){Cn().acquire(Uo)},clearPrewarmedResources:function(){const f=ds;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Uo),ds=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(f){s.config.ACCESS_TOKEN=f},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(f){s.config.API_URL=f},get workerCount(){return Wn.workerCount},set workerCount(f){Wn.workerCount=f},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){s.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){s.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return dc});var V=C;return V})})(XA);var J3=XA.exports;const $y=qA(J3),Qb=fA("map",{state:()=>({map:null,boundaries:{},visibleLayer:null,basemapStyle:"light"}),actions:{setMap(t){this.map=t},setBoundaries(t){this.boundaries={country:t.country||{type:"FeatureCollection",features:[]},watershed:t.watershed||{type:"FeatureCollection",features:[]},commune:t.commune||{type:"FeatureCollection",features:[]}}},setBasemapStyle(t){this.basemapStyle=t},highlightFeature(t,l){var s,$;if(!this.map||!t)return;const d={country:"countries-outline",watershed:"watersheds-outline",commune:"communes-outline"},_=d[l],T=Object.values(d);for(const Z of T)(s=this.map)!=null&&s.getLayer(Z)&&(this.map.setLayoutProperty(Z,"visibility","none"),this.map.setPaintProperty(Z,"line-color","rgba(0,0,0,0)"));($=this.map)!=null&&$.getLayer(_)&&(this.map.setLayoutProperty(_,"visibility","visible"),this.map.setPaintProperty(_,"line-color","#000000"),this.map.setPaintProperty(_,"line-width",4)),this.visibleLayer=l;const C=t.geometry.coordinates.flat(1/0),P=C.filter((Z,J)=>J%2===0),V=C.filter((Z,J)=>J%2!==0);if(P.length&&V.length){const Z=new $y.LngLatBounds([Math.min(...P),Math.min(...V)],[Math.max(...P),Math.max(...V)]);this.map.fitBounds(Z,{padding:40})}},resetView(){if(!this.map)return;this.map.flyTo({center:[1.8,11.5],zoom:4.2,essential:!0});const t=["countries-outline","watersheds-outline","communes-outline"];for(const l of t)this.map.getLayer(l)&&this.map.setLayoutProperty(l,"visibility","none");this.visibleLayer=null}}}),Q3="/projects/soil_values/assets/LC_MAPLAYERS-SEb8qRKn.png",eB="/projects/soil_values/assets/LC_BIOPHYSICAL_HEALTH_2-HHlmRK23.png",tB="/projects/soil_values/assets/LC_BIOPHYSICAL_HEALTH-BGgneVEh.png",iB="/projects/soil_values/assets/LC_LANDCOVER-BTufKOfp.png",rB="/projects/soil_values/assets/LC_LANDCOVER_%202-Dfxvtyu_.png",nB={},sB={class:"biophysical-panel"},oB={class:"panel-title"},aB={class:"panel-description"},lB={class:"image-section"},cB={class:"chart-title"},hB={class:"image-section"},uB={class:"chart-title"},dB={class:"image-section"},fB={class:"chart-title"},pB={class:"image-section"},mB={class:"chart-title"},gB={class:"image-section"},_B={class:"chart-title"};function yB(t,l){return _i(),Pi("div",sB,[lt("h2",oB,Vt(t.$t("biophysical.title")),1),lt("p",aB,Vt(t.$t("biophysical.description")),1),lt("section",lB,[lt("h3",cB,Vt(t.$t("biophysical.mapLayers")),1),l[0]||(l[0]=lt("img",{src:Q3,alt:"Map Layers",class:"chart-image"},null,-1))]),lt("section",hB,[lt("h3",uB,Vt(t.$t("biophysical.evi")),1),l[1]||(l[1]=lt("img",{src:eB,alt:"EVI Trend",class:"chart-image"},null,-1))]),lt("section",dB,[lt("h3",fB,Vt(t.$t("biophysical.health")),1),l[2]||(l[2]=lt("img",{src:tB,alt:"Biophysical Donut",class:"chart-image"},null,-1))]),lt("section",pB,[lt("h3",mB,Vt(t.$t("biophysical.baseline")),1),l[3]||(l[3]=lt("img",{src:iB,alt:"Baseline Chart",class:"chart-image"},null,-1))]),lt("section",gB,[lt("h3",_B,Vt(t.$t("biophysical.evaluation")),1),l[4]||(l[4]=lt("img",{src:rB,alt:"Evaluation Chart",class:"chart-image"},null,-1))])])}const xB=da(nB,[["render",yB],["__scopeId","data-v-cac63d4d"]]),vB={class:"fertility-panel"},bB={class:"panel-title"},wB={class:"panel-description"},TB={class:"indicator-title"},EB={class:"baseline-current"},SB={class:"baseline"},CB={class:"current"},AB={class:"progress-bar"},MB=zn({__name:"FertilityMonitoringPanel",setup(t){const l=[{name:"organicMatter",baseline:"2.4%",current:"2.8%",change:"positive",changeClass:"change-positive",progress:65},{name:"nutrientLevels",baseline:"Medium",current:"High",change:"positive",changeClass:"change-positive",progress:75},{name:"erosionRisk",baseline:"Moderate",current:"No Change",change:"neutral",changeClass:"change-neutral",progress:50},{name:"waterRetention",baseline:"Low",current:"Moderate",change:"positive",changeClass:"change-positive",progress:40}];return(d,_)=>(_i(),Pi("div",vB,[lt("h2",bB,Vt(d.$t("fertility.title")),1),lt("p",wB,Vt(d.$t("fertility.description")),1),(_i(),Pi($r,null,Ba(l,T=>lt("div",{key:T.name,class:"indicator-card"},[lt("div",TB,[lt("strong",null,Vt(d.$t(`fertility.indicators.${T.name}`)),1),lt("span",{class:Vs(T.changeClass)},Vt(d.$t(`fertility.changes.${T.change}`)),3)]),lt("div",EB,[lt("span",SB,[js(Vt(d.$t("fertility.baseline"))+": ",1),lt("strong",null,Vt(T.baseline),1)]),lt("span",CB,[js(Vt(d.$t("fertility.current"))+": ",1),lt("strong",null,Vt(T.current),1)])]),lt("div",AB,[lt("div",{class:"progress",style:zc({width:T.progress+"%"})},null,4)])])),64))]))}}),IB=da(MB,[["__scopeId","data-v-0f70ca8a"]]),kB={class:"toolbox-container"},PB={class:"toolbox-header"},LB={class:"header-text"},DB={class:"toolbox-content"},OB=["onClick","title"],RB={class:"tool-icon"},zB={class:"icon-label"},BB={key:0,class:"floating-panel"},FB={key:2},NB={class:"text-lg font-semibold mb-2"},UB={class:"text-gray-700 text-sm leading-relaxed whitespace-pre-line"},VB=zn({__name:"Toolbox",setup(t){const l=Vi(null),d=Qb(),_=[{id:"landcover",emoji:""},{id:"crop",emoji:""},{id:"degradation",emoji:""},{id:"drought",emoji:""},{id:"fertility",emoji:""},{id:"risk",emoji:""}];function T(P){const V=l.value===P;l.value=V?null:P;const s=d.map;if(!s)return;const $=l.value==="landcover";s.getLayer("komadougou-highlight")&&s.setLayoutProperty("komadougou-highlight","visibility",$?"visible":"none"),P==="landcover"&&!V&&s.flyTo({center:[3.3,14.5],zoom:7,speed:1.2,curve:1.3,essential:!0})}function C(P,V){const[s,...$]=P.split(" ");return V===0?s:$.join(" ")||"Monitoring"}return(P,V)=>(_i(),Pi("div",kB,[lt("div",PB,[lt("span",LB,Vt(P.$t("toolbox.title")),1)]),lt("div",DB,[(_i(),Pi($r,null,Ba(_,s=>lt("div",{key:s.id,class:"tool-item",onClick:$=>T(s.id),title:P.$t(`toolbox.tools.${s.id}.name`)},[lt("div",RB,Vt(s.emoji),1),lt("div",zB,[lt("strong",null,Vt(C(P.$t(`toolbox.tools.${s.id}.name`),0)),1),V[0]||(V[0]=lt("br",null,null,-1)),lt("span",null,Vt(C(P.$t(`toolbox.tools.${s.id}.name`),1)),1)]),pr(Bb,{name:"slide"},{default:Us(()=>[l.value===s.id?(_i(),Pi("div",BB,[s.id==="landcover"?(_i(),No(xB,{key:0})):s.id==="fertility"?(_i(),No(IB,{key:1})):(_i(),Pi("div",FB,[lt("h3",NB,Vt(P.$t(`toolbox.tools.${s.id}.name`)),1),lt("p",UB,Vt(P.$t(`toolbox.tools.${s.id}.description`)),1)]))])):En("",!0)]),_:2},1024)],8,OB)),64))])]))}}),jB=da(VB,[["__scopeId","data-v-7bebdeb3"]]),$B=zn({__name:"MapboxMap",setup(t){const l=Vi(null),d=Qb(),_="pk.eyJ1Ijoib3N1bWFpIiwiYSI6ImNtOThheGt3bDAxMDYyanM1cDVoZG5jaGIifQ.rhfXn8CCj3FZ-OTeH-z-Ag",T="http://127.0.0.1:8000/api/v1",C=location.hostname.includes("github.io");let P;ha(()=>d.basemapStyle,async ne=>{const ue={light:"mapbox://styles/mapbox/light-v10",satellite:"mapbox://styles/mapbox/satellite-streets-v12",streets:"mapbox://styles/mapbox/streets-v12",dark:"mapbox://styles/mapbox/dark-v10"},we=ue[ne]||ue.light;P.setStyle(we),P.once("styledata",async()=>{V(),await $()})});function V(){(P.getStyle().layers||[]).forEach(ue=>{if(["hillshade","terrain","3d-buildings","building"].some(we=>ue.id.includes(we)))try{P.removeLayer(ue.id)}catch{}});try{P.setTerrain(null)}catch{}}async function s(){let ne=!1;try{const we=await fetch(`${T}/config`).then(Me=>Me.json());ne=(we==null?void 0:we.DEMO_MODE)===!0}catch(we){console.warn("Could not fetch config, defaulting to LIVE_MODE",we)}function ue(we,Me){return we?((Array.isArray(we)?we:we.features)||[]).map(Ze=>({...Ze,properties:{...Ze.properties,layer:Me}})):[]}if(C){const[we,Me,Ye]=await Promise.all([fetch("/projects/soil_values/data/countries.geojson").then(Ze=>Ze.json()),fetch("/projects/soil_values/data/intervention_watersheds.geojson").then(Ze=>Ze.json()),fetch("/projects/soil_values/data/communes.geojson").then(Ze=>Ze.json())]);return[...ue(we,"country"),...ue(Me,"watershed"),...ue(Ye,"commune")]}else if(ne){const{countries:we,watersheds:Me,communes:Ye}=await fetch(`${T}/synthetic/boundaries`).then(Ze=>Ze.json());return[...ue(we,"country"),...ue(Me,"watershed"),...ue(Ye,"commune")]}else{const{countries:we,watersheds:Me,communes:Ye}=await fetch(`${T}/boundaries/all`).then(Ze=>Ze.json());return[...ue(we,"country"),...ue(Me,"watershed"),...ue(Ye,"commune")]}}async function $(){const ne=await s();window._allBoundaryFeatures=ne||[]["communes-outline"].forEach(ue=>{P.getLayer(ue)&&P.removeLayer(ue)}),P.getSource("boundaries")&&P.removeSource("boundaries"),ne.length>0&&(P.addSource("boundaries",{type:"geojson",data:{type:"FeatureCollection",features:ne.filter(we=>we.properties.layer==="country")}}),P.addLayer({id:"selected-boundary-highlight",type:"line",source:"boundaries",filter:["==",["get","id"],""],paint:{"line-color":"#000","line-width":5,"line-opacity":.8}}),[{id:"countries-outline",key:"country",width:2.5},{id:"watersheds-outline",key:"watershed",width:1.5},{id:"communes-outline",key:"commune",width:.8}].forEach(({id:we,key:Me,width:Ye})=>{P.addLayer({id:we,type:"line",source:"boundaries",filter:["==",["get","layer"],Me],paint:{"line-color":"#000","line-width":Ye}})})),Z()}function Z(){const ne=`${T}/proxy_geoserver/komadogou-landcover/{z}/{x}/{y}.png`,ue=`${T}/proxy_geoserver/komadogou-river-streams/{z}/{x}/{y}.png`;["komadogou-landcover","komadogou-river-streams"].forEach(we=>{P.getLayer(we)&&P.removeLayer(we),P.getSource(we)&&P.removeSource(we)}),P.addSource("komadogou-landcover",{type:"raster",tiles:[ne],tileSize:256}),P.addLayer({id:"komadogou-landcover",type:"raster",source:"komadogou-landcover",paint:{"raster-opacity":1}}),P.addSource("komadogou-river-streams",{type:"raster",tiles:[ue],tileSize:256}),P.addLayer({id:"komadogou-river-streams",type:"raster",source:"komadogou-river-streams",paint:{"raster-opacity":.2}})}Oh(async()=>{P=new $y.Map({container:l.value,style:"mapbox://styles/mapbox/light-v10",center:[1,12],zoom:4.2,accessToken:_}),d.setMap(P),P.addControl(new $y.NavigationControl,"top-right"),P.on("load",async()=>{V(),await $()})});function J(ne,ue){const Me=(window._allBoundaryFeatures||[]).find(ae=>ae.properties.id===ne&&ae.properties.layer===ue);if(!Me)return;P.getSource("boundaries").setData({type:"FeatureCollection",features:[Me]}),P.getLayer("selected-boundary-highlight")&&P.setFilter("selected-boundary-highlight",["==",["get","id"],ne]);const Ze=new $y.LngLatBounds;function je(ae){ae.type==="Polygon"?ae.coordinates.forEach(ge=>ge.forEach(Oe=>Ze.extend(Oe))):ae.type==="MultiPolygon"&&ae.coordinates.forEach(ge=>ge.forEach(Oe=>Oe.forEach(ze=>Ze.extend(ze))))}je(Me.geometry),Ze.isEmpty()||P.fitBounds(Ze,{padding:40,duration:800})}return window.highlightBoundaryById=J,(ne,ue)=>(_i(),Pi("div",{ref_key:"mapContainer",ref:l,class:"mapbox-map w-full h-full"},null,512))}}),GB=da($B,[["__scopeId","data-v-51461c27"]]),WB={class:"map-control-wrapper"},HB={class:"dropdown-group"},qB={class:"dropdown-label"},XB={value:"light"},ZB={value:"streets"},YB={value:"satellite"},KB={value:"dark"},JB={key:0,class:"map-control-panel"},QB={class:"panel-header"},eF={class:"panel-title"},tF={class:"dropdown-group"},iF={class:"dropdown-label"},rF={disabled:"",value:""},nF=["value"],sF={key:0,class:"spinner"},oF={key:0,class:"dropdown-group"},aF={class:"dropdown-label"},lF={disabled:"",value:""},cF=["value"],hF={key:0,class:"spinner"},uF={key:1,class:"dropdown-group"},dF={class:"dropdown-label"},fF={disabled:"",value:""},pF=["value"],mF={key:0,class:"spinner"},gF={key:2,class:"dropdown-group"},_F={class:"dropdown-label"},yF={disabled:"",value:""},xF=["value"],vF=zn({__name:"MapControlPanel",setup(t){const{t:l}=_m(),d=Qb(),_=vm(),T=Vi(!0),C=Vi(null),P=Vi(null),V=Vi(null),s=Vi(""),$=Vi(!1),Z=Vi(!1),J=Vi(!1),ne=Vi([]),ue=Vi([]),we=Vi([]),Me=Vi([]);async function Ye(){try{const kt=location.hostname.includes("github.io");if($.value=!0,kt)console.info("GitHub Pages mode  using static data"),await Ze();else try{const Pt=await fetch("http://127.0.0.1:8000/api/v1/boundaries/all");if(!Pt.ok)throw new Error(`Backend returned ${Pt.status}`);const vt=await Pt.json();ne.value=je(vt.countries,"ADM0_FR","country"),ue.value=je(vt.watersheds,"layer","watershed"),we.value=je(vt.communes,"ADM3_FR","commune")}catch(Pt){console.warn("Backend boundaries failed  falling back to static data",Pt),await Ze()}d.setBoundaries({countries:ne.value,watersheds:ue.value,communes:we.value}),window._allBoundaryFeatures=[...ne.value,...ue.value,...we.value]}catch(kt){console.error("Failed to load boundaries at all:",kt)}finally{$.value=!1}}async function Ze(){const[kt,Pt,vt]=await Promise.all([fetch("/projects/soil_values/data/countries.geojson").then(ci=>ci.json()),fetch("/projects/soil_values/data/intervention_watersheds.geojson").then(ci=>ci.json()),fetch("/projects/soil_values/data/communes.geojson").then(ci=>ci.json())]);ne.value=je(kt,"ADM0_FR","country"),ue.value=je(Pt,"layer","watershed"),we.value=je(vt,"ADM3_FR","commune")}function je(kt,Pt,vt){return kt?((Array.isArray(kt)?kt:kt.features)||[]).map(xi=>{var vi,Lr;return{...xi,properties:{...xi.properties,name:((vi=xi.properties)==null?void 0:vi[Pt])||((Lr=xi.properties)==null?void 0:Lr.name),layer:vt}}}):[]}async function ae(){var kt;try{const Pt=await _n.get("http://127.0.0.1:8000/api/v1/admin/layers",{headers:{Authorization:`Bearer ${_.token}`}});(kt=Pt.data.coverageStores)!=null&&kt.coverageStore&&(Me.value=Pt.data.coverageStores.coverageStore.map(vt=>vt.name))}catch(Pt){console.warn("Failed to load rasters  hiding dropdown",Pt),Me.value=[]}}function ge(){!s.value||!window.map||(window.map.getSource(s.value)&&(window.map.removeLayer(s.value),window.map.removeSource(s.value)),window.map.addSource(s.value,{type:"raster",tiles:[`undefined?service=WMS&version=1.1.0&request=GetMap&layers=soil_values:${s.value}&styles=&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=image/png`],tileSize:256}),window.map.addLayer({id:s.value,type:"raster",source:s.value,paint:{"raster-opacity":.7}}))}function Oe(){dt()}Oh(()=>{Ye(),ae()}),ha(()=>C.value,()=>{P.value=null,V.value=null}),ha(()=>P.value,()=>{V.value=null});const ze=fn(()=>{if(!C.value)return[];const kt=ke(C.value);return ue.value.filter(Pt=>Ke(Pt,kt))}),rt=fn(()=>{if(!P.value)return[];const kt=ke(P.value);return we.value.filter(Pt=>Ke(Pt,kt))});function ke(kt){const Pt=kt.geometry.coordinates.flat(1/0),vt=Pt.filter((xi,vi)=>vi%2===0),ci=Pt.filter((xi,vi)=>vi%2!==0);return[Math.min(...vt),Math.min(...ci),Math.max(...vt),Math.max(...ci)]}function Ke(kt,[Pt,vt,ci,xi]){const[vi,Lr,ir,sr]=ke(kt);return!(ir<Pt||vi>ci||sr<vt||Lr>xi)}function He(){var Pt,vt;Z.value=!0;const kt=(vt=(Pt=C.value)==null?void 0:Pt.properties)==null?void 0:vt.id;kt&&window.highlightBoundaryById(kt,"country"),setTimeout(()=>Z.value=!1,500)}function ri(){var Pt,vt;J.value=!0;const kt=(vt=(Pt=P.value)==null?void 0:Pt.properties)==null?void 0:vt.id;kt&&window.highlightBoundaryById(kt,"watershed"),setTimeout(()=>J.value=!1,500)}function bt(){var Pt,vt;const kt=(vt=(Pt=V.value)==null?void 0:Pt.properties)==null?void 0:vt.id;kt&&window.highlightBoundaryById(kt,"commune")}function dt(){C.value=null,P.value=null,V.value=null,s.value="",d.resetView()}return(kt,Pt)=>(_i(),Pi("div",WB,[T.value?En("",!0):(_i(),Pi("button",{key:0,class:"reopen-button",onClick:Pt[0]||(Pt[0]=vt=>T.value=!0)},Vt(cn(l)("mapControls.reopen")),1)),lt("div",HB,[lt("label",qB,Vt(cn(l)("mapControls.basemap")),1),fo(lt("select",{"onUpdate:modelValue":Pt[1]||(Pt[1]=vt=>cn(d).basemapStyle=vt),onChange:Oe},[lt("option",XB,Vt(cn(l)("mapControls.basemapLight")),1),lt("option",ZB,Vt(cn(l)("mapControls.basemapStreets")),1),lt("option",YB,Vt(cn(l)("mapControls.basemapSatellite")),1),lt("option",KB,Vt(cn(l)("mapControls.basemapDark")),1)],544),[[Ch,cn(d).basemapStyle]])]),pr(Bb,{name:"fade-slide"},{default:Us(()=>[T.value?(_i(),Pi("div",JB,[lt("div",QB,[lt("h3",eF,Vt(cn(l)("mapControls.title")),1),lt("button",{class:"close-button",onClick:Pt[2]||(Pt[2]=vt=>T.value=!1)},"")]),lt("div",tF,[lt("label",iF,Vt(cn(l)("mapControls.country")),1),fo(lt("select",{"onUpdate:modelValue":Pt[3]||(Pt[3]=vt=>C.value=vt),onChange:He},[lt("option",rF,Vt(cn(l)("mapControls.select")),1),(_i(!0),Pi($r,null,Ba(ne.value,vt=>(_i(),Pi("option",{key:vt.properties.id,value:vt},Vt(vt.properties.name),9,nF))),128))],544),[[Ch,C.value]]),$.value?(_i(),Pi("span",sF,"")):En("",!0)]),ze.value.length?(_i(),Pi("div",oF,[lt("label",aF,Vt(cn(l)("mapControls.watershed")),1),fo(lt("select",{"onUpdate:modelValue":Pt[4]||(Pt[4]=vt=>P.value=vt),onChange:ri},[lt("option",lF,Vt(cn(l)("mapControls.select")),1),(_i(!0),Pi($r,null,Ba(ze.value,vt=>(_i(),Pi("option",{key:vt.properties.id,value:vt},Vt(vt.properties.name),9,cF))),128))],544),[[Ch,P.value]]),Z.value?(_i(),Pi("span",hF,"")):En("",!0)])):En("",!0),rt.value.length?(_i(),Pi("div",uF,[lt("label",dF,Vt(cn(l)("mapControls.commune")),1),fo(lt("select",{"onUpdate:modelValue":Pt[5]||(Pt[5]=vt=>V.value=vt),onChange:bt},[lt("option",fF,Vt(cn(l)("mapControls.select")),1),(_i(!0),Pi($r,null,Ba(rt.value,vt=>(_i(),Pi("option",{key:vt.properties.id,value:vt},Vt(vt.properties.name),9,pF))),128))],544),[[Ch,V.value]]),J.value?(_i(),Pi("span",mF,"")):En("",!0)])):En("",!0),Me.value.length?(_i(),Pi("div",gF,[lt("label",_F,Vt(cn(l)("mapControls.rasterLayer")),1),fo(lt("select",{"onUpdate:modelValue":Pt[6]||(Pt[6]=vt=>s.value=vt),onChange:ge},[lt("option",yF,Vt(cn(l)("mapControls.selectRaster")),1),(_i(!0),Pi($r,null,Ba(Me.value,vt=>(_i(),Pi("option",{key:vt,value:vt},Vt(vt),9,xF))),128))],544),[[Ch,s.value]])])):En("",!0),lt("button",{class:"reset-btn",onClick:dt},Vt(cn(l)("mapControls.reset")),1)])):En("",!0)]),_:1})]))}}),bF=da(vF,[["__scopeId","data-v-75f9a3b7"]]),wF={class:"legend-wrapper"},TF={key:1,class:"legend-container"},EF={class:"legend-header"},SF={class:"legend-title"},CF={class:"legend-list"},AF=zn({__name:"MapLegend",props:{show:{type:Boolean}},emits:["close"],setup(t){const l=Vi(!0),d={water:"#2b83ba",forest:"#1a9850",cropland:"#d7191c",grassland:"#fdae61",shrubland:"#abdda4",wetland:"#66c2a5",bareland:"#ffffbf",urban:"#f46d43",boundary:"#000000"};return(_,T)=>(_i(),Pi("div",wF,[l.value?(_i(),Pi("div",TF,[lt("div",EF,[lt("h4",SF,Vt(_.$t("legend.title")),1),lt("button",{class:"legend-close",onClick:T[1]||(T[1]=C=>l.value=!1)},"")]),lt("ul",CF,[(_i(),Pi($r,null,Ba(d,(C,P)=>lt("li",{key:P},[lt("span",{class:"legend-swatch",style:zc({backgroundColor:C})},null,4),js(" "+Vt(_.$t(`legend.labels.${P}`)),1)])),64))])])):(_i(),Pi("button",{key:0,class:"legend-reopen",onClick:T[0]||(T[0]=C=>l.value=!0)}," Legend "))]))}}),MF=da(AF,[["__scopeId","data-v-8141ab19"]]),IF={class:"dashboard-layout"},kF={class:"map-section"},PF={class:"map-container"},LF={class:"overlay-panels"},DF=zn({__name:"MapView",setup(t){const l=Vi(!0),d=Vi(!0);return(_,T)=>(_i(),Pi("div",IF,[lt("div",kF,[pr(jB),lt("div",PF,[pr(GB),lt("div",LF,[l.value?(_i(),No(bF,{key:0,onClose:T[0]||(T[0]=C=>l.value=!1)})):En("",!0),pr(MF,{show:d.value,onClose:T[1]||(T[1]=C=>d.value=!1)},null,8,["show"])])])])]))}}),OF=da(DF,[["__scopeId","data-v-7cb25c9c"]]),RF={class:"p-8 max-w-5xl mx-auto"},zF={class:"text-4xl font-bold text-indigo-800 mb-6"},BF={class:"text-gray-700 leading-relaxed whitespace-pre-line"},FF={__name:"MonitoringView",setup(t){return(l,d)=>(_i(),Pi("div",RF,[lt("h1",zF,Vt(l.$t("monitoring.title")),1),lt("p",BF,Vt(l.$t("monitoring.description")),1)]))}},NF=da(FF,[["__scopeId","data-v-533c53c9"]]),UF={class:"p-8 max-w-5xl mx-auto"},VF={class:"text-4xl font-bold text-green-800 mb-6"},jF={class:"text-gray-700 leading-relaxed whitespace-pre-line"},$F={__name:"CatalogView",setup(t){return(l,d)=>(_i(),Pi("div",UF,[lt("h1",VF,Vt(l.$t("catalog.title")),1),lt("p",jF,Vt(l.$t("catalog.description")),1)]))}},GF=da($F,[["__scopeId","data-v-83e12bfa"]]),WF="/projects/soil_values/assets/hand_soil-1gZV898M.jpeg",HF="/projects/soil_values/assets/harvest-man-PU7mKcrC.jpg",qF="/projects/soil_values/assets/update-burkina-oEf6LrKK.jpg",XF="/projects/soil_values/assets/update-women-DMqvfeED.jpg",ZF="/projects/soil_values/assets/update-dairy-D07hRLBv.jpg",YF={class:"about-container"},KF={class:"hero-section"},JF={class:"hero-text"},QF={class:"about-description"},eN={class:"outcomes-section"},tN={class:"partners-section"},iN={class:"note"},rN={class:"updates-section"},nN={class:"updates-grid"},sN=["href"],oN=["src","alt"],aN={class:"update-info"},lN={class:"update-date"},cN={class:"update-title"},hN={__name:"AboutView",setup(t){const l=[{id:1,title:"ISFM Training in Burkina Faso: A Collaborative Approach",date:"News | April 2, 2025",image:qF,link:"https://ifdc.org/2025/04/02/isfm-training-in-burkina-faso-a-collaborative-approach-to-soil-fertility-and-land-restoration/"},{id:2,title:"Celebrating Women in Sustainable Agriculture",date:"Event Recap | March 26, 2025",image:XF,link:"https://ifdc.org/2025/03/26/celebrating-women-at-the-heart-of-sustainable-agriculture/"},{id:3,title:"Improving Nigerias Dairy Sector and Empowering Pastoralist Communities",date:"News | May 1, 2025",image:ZF,link:"https://ifdc.org/2025/05/01/improving-nigerias-dairy-sector-and-empowering-pastoralist-communities/"}];return(d,_)=>(_i(),Pi("div",YF,[lt("section",KF,[_[0]||(_[0]=lt("img",{src:WF,alt:"African Farmer",class:"hero-image"},null,-1)),lt("div",JF,[lt("h1",null,Vt(d.$t("about.hero.title")),1),lt("p",null,Vt(d.$t("about.hero.subtitle")),1)])]),lt("section",QF,[lt("p",null,[lt("strong",null,Vt(d.$t("about.description.program")),1),js(" "+Vt(d.$t("about.description.intro")),1)]),lt("p",null,Vt(d.$t("about.description.impact")),1),lt("p",null,Vt(d.$t("about.description.approach")),1)]),_[2]||(_[2]=lt("img",{src:HF,alt:"Harvesting Legumes",class:"mid-image"},null,-1)),lt("section",eN,[lt("h2",null,Vt(d.$t("about.outcomes.title")),1),lt("ul",null,[lt("li",null,Vt(d.$t("about.outcomes.item1")),1),lt("li",null,Vt(d.$t("about.outcomes.item2")),1),lt("li",null,Vt(d.$t("about.outcomes.item3")),1),lt("li",null,Vt(d.$t("about.outcomes.item4")),1)])]),lt("section",tN,[lt("h2",null,Vt(d.$t("about.partners.title")),1),lt("p",null,Vt(d.$t("about.partners.description1")),1),lt("p",iN,Vt(d.$t("about.partners.note")),1),_[1]||(_[1]=ex('<div class="partner-logos" data-v-7d9b0679><div class="logo-row" data-v-7d9b0679><a href="https://www.government.nl/ministries/ministry-of-foreign-affairs" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+Ub+'" alt="DGIS" class="logo-lg" data-v-7d9b0679></a></div><div class="logo-row" data-v-7d9b0679><a href="https://ifdc.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+FA+'" alt="IFDC" class="logo-md" data-v-7d9b0679></a><a href="https://snv.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+UA+'" alt="SNV" class="logo-md" data-v-7d9b0679></a><a href="https://wur.nl" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+NA+'" alt="WUR" class="logo-md" data-v-7d9b0679></a></div><div class="logo-row" data-v-7d9b0679><a href="https://agra.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+VA+'" alt="AGRA" data-v-7d9b0679></a><a href="https://www.iita.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+jA+'" alt="IITA" data-v-7d9b0679></a><a href="https://www.iwmi.cgiar.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+$A+'" alt="IWMI" data-v-7d9b0679></a><a href="https://www.isric.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+GA+'" alt="ISRIC" data-v-7d9b0679></a><a href="https://www.cifor-icraf.org" target="_blank" rel="noopener" data-v-7d9b0679><img src="'+WA+'" alt="CIFOR-ICRAF" data-v-7d9b0679></a></div></div>',1))]),lt("section",rN,[lt("h2",null,Vt(d.$t("about.updates.title")),1),lt("div",nN,[(_i(),Pi($r,null,Ba(l,T=>lt("a",{key:T.id,href:T.link,target:"_blank",class:"update-card"},[lt("img",{src:T.image,alt:T.title},null,8,oN),lt("div",aN,[lt("p",lN,Vt(T.date),1),lt("h3",cN,Vt(T.title),1)])],8,sN)),64))])])]))}},uN=da(hN,[["__scopeId","data-v-7d9b0679"]]),dN={class:"login-page"},fN={class:"hero"},pN={class:"hero-overlay"},mN={class:"hero-title"},gN={class:"hero-subtitle"},_N={class:"form-section"},yN={class:"form-card"},xN={class:"form-title"},vN=["disabled"],bN={key:0,class:"error"},wN=zn({__name:"LoginView",setup(t){const l=Vi(""),d=Vi(""),_=Vi(!1),T=Vi(""),C=MC(),P=vm(),V=async()=>{if(_.value=!0,T.value="",await P.login(l.value,d.value)){const $=JN(C);C.push($)}else T.value=$t&&$t("login.invalidCredentials")||"Invalid email or password";_.value=!1};return(s,$)=>(_i(),Pi("div",dN,[lt("section",fN,[lt("div",pN,[lt("h1",mN,Vt(s.$t("login.title")||"Login"),1),lt("p",gN,Vt(s.$t("login.subtitle")||"Access your account to manage and upload data"),1)])]),lt("section",_N,[lt("div",yN,[lt("h2",xN,Vt(s.$t("login.formTitle")||"Sign In"),1),lt("form",{onSubmit:Kg(V,["prevent"]),class:"login-form"},[fo(lt("input",{"onUpdate:modelValue":$[0]||($[0]=Z=>l.value=Z),type:"email",placeholder:"Email",required:"",class:"form-input"},null,512),[[rl,l.value]]),fo(lt("input",{"onUpdate:modelValue":$[1]||($[1]=Z=>d.value=Z),type:"password",placeholder:"Password",required:"",class:"form-input"},null,512),[[rl,d.value]]),lt("button",{type:"submit",disabled:_.value,class:"form-button"},Vt(_.value?s.$t("login.loggingIn")||"Logging in...":s.$t("login.loginButton")||"Login"),9,vN)],32),T.value?(_i(),Pi("p",bN,Vt(T.value),1)):En("",!0)])])]))}}),TN=da(wN,[["__scopeId","data-v-ea3045c6"]]),EN={class:"admin-panel"},SN={class:"tabs"},CN={key:0,class:"tab-content"},AN=["placeholder"],MN=["placeholder"],IN=["placeholder"],kN=["placeholder"],PN={key:0,class:"progress-container"},LN=["disabled"],DN={key:1,class:"layers-list"},ON={key:1,class:"tab-content"},RN=["placeholder"],zN=["placeholder"],BN={disabled:"",value:""},FN={value:"admin"},NN={value:"partner"},UN={value:"analyst"},VN={value:"public"},jN={type:"submit"},$N={key:2,class:"tab-content"},GN=["disabled"],WN={key:1,style:{"margin-top":"10px"}},HN={key:2,style:{"margin-top":"10px"}},qN={style:{color:"green","white-space":"pre-wrap"}},XN={key:3,class:"tab-content"},ZN=zn({__name:"AdminPanel",setup(t){const{t:l}=_m(),d=Vi("upload"),_=vm(),T=Vi(""),C=Vi(""),P=Vi(""),V=Vi(""),s=Vi(null),$=Vi(""),Z=Vi(!1),J=Vi(!1),ne=Vi(0),ue=Vi([]),we=Vi(""),Me=Vi(""),Ye=Vi(""),Ze=Vi(""),je=Vi(!1),ae=Vi(!1),ge=Vi(""),Oe=Vi(!1),ze=Vi({}),rt=Vi(""),ke=dt=>{var Pt;const kt=dt.target;(Pt=kt.files)!=null&&Pt.length&&(s.value=kt.files[0])},Ke=async()=>{try{const dt=await _n.get("http://127.0.0.1:8000/api/v1/admin/layers",{headers:{Authorization:`Bearer ${_.token}`}});ue.value=dt.data.coverageStores.coverageStore}catch(dt){console.error("Error fetching layers:",dt)}},He=async()=>{var kt,Pt;if(!s.value)return;const dt=new FormData;dt.append("file",s.value),dt.append("name",T.value),dt.append("category",C.value),dt.append("year",P.value),dt.append("description",V.value),J.value=!0,ne.value=0,$.value="";try{const vt=await _n.post("http://127.0.0.1:8000/api/v1/admin/upload-raster",dt,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${_.token}`},onUploadProgress:ci=>{ci.total&&(ne.value=Math.round(ci.loaded/ci.total*100))}});$.value=`Raster uploaded: ${vt.data.name}`,Z.value=!0,T.value=C.value=P.value=V.value="",s.value=null,Ke()}catch(vt){$.value=((Pt=(kt=vt.response)==null?void 0:kt.data)==null?void 0:Pt.detail)||"Upload failed",Z.value=!1}finally{J.value=!1}},ri=async()=>{var dt,kt;try{const Pt=await _n.post("http://127.0.0.1:8000/api/v1/admin/create-user",{email:we.value,password:Me.value,role:Ye.value},{headers:{Authorization:`Bearer ${_.token}`}});Ze.value=Pt.data.message,je.value=!0,we.value=Me.value=Ye.value=""}catch(Pt){Ze.value=((kt=(dt=Pt.response)==null?void 0:dt.data)==null?void 0:kt.detail)||"Error creating user",je.value=!1}},bt=async()=>{var dt,kt;ae.value=!0,ge.value="",rt.value="";try{const Pt=await _n.post("http://127.0.0.1:8000/api/v1/admin/synthetic/generate",{},{headers:{Authorization:`Bearer ${_.token}`}});ge.value=Pt.data.message,Oe.value=!0,ze.value=Pt.data.counts,rt.value=Pt.data.output}catch(Pt){ge.value=((kt=(dt=Pt.response)==null?void 0:dt.data)==null?void 0:kt.detail)||"Error generating synthetic data",Oe.value=!1}finally{ae.value=!1}};return Oh(Ke),(dt,kt)=>(_i(),Pi("div",EN,[lt("h2",null,Vt(dt.$t("admin.panelTitle")),1),lt("div",SN,[lt("button",{class:Vs({active:d.value==="upload"}),onClick:kt[0]||(kt[0]=Pt=>d.value="upload")},Vt(dt.$t("admin.uploadRaster")),3),lt("button",{class:Vs({active:d.value==="createUser"}),onClick:kt[1]||(kt[1]=Pt=>d.value="createUser")},Vt(dt.$t("admin.createUser")),3),lt("button",{class:Vs({active:d.value==="generateSynthetic"}),onClick:kt[2]||(kt[2]=Pt=>d.value="generateSynthetic")},Vt(dt.$t("admin.generateSyntheticData")),3),lt("button",{class:Vs({active:d.value==="manageData"}),onClick:kt[3]||(kt[3]=Pt=>d.value="manageData")},Vt(dt.$t("admin.manageData")),3)]),d.value==="upload"?(_i(),Pi("div",CN,[lt("h3",null,Vt(dt.$t("admin.uploadRasterLayer")),1),lt("form",{onSubmit:Kg(He,["prevent"])},[fo(lt("input",{"onUpdate:modelValue":kt[4]||(kt[4]=Pt=>T.value=Pt),placeholder:dt.$t("admin.layerName"),required:""},null,8,AN),[[rl,T.value]]),fo(lt("input",{"onUpdate:modelValue":kt[5]||(kt[5]=Pt=>C.value=Pt),placeholder:dt.$t("admin.category")},null,8,MN),[[rl,C.value]]),fo(lt("input",{"onUpdate:modelValue":kt[6]||(kt[6]=Pt=>P.value=Pt),placeholder:dt.$t("admin.year")},null,8,IN),[[rl,P.value]]),fo(lt("textarea",{"onUpdate:modelValue":kt[7]||(kt[7]=Pt=>V.value=Pt),placeholder:dt.$t("admin.description")},null,8,kN),[[rl,V.value]]),lt("input",{type:"file",onChange:ke,accept:".tif,.tiff,.zip",required:""},null,32),J.value?(_i(),Pi("div",PN,[lt("div",{class:"progress-bar",style:zc({width:ne.value+"%"})},null,4)])):En("",!0),lt("button",{type:"submit",disabled:J.value},Vt(J.value?dt.$t("admin.uploading"):dt.$t("admin.upload")),9,LN)],32),$.value?(_i(),Pi("p",{key:0,class:Vs({success:Z.value,error:!Z.value})},Vt($.value),3)):En("",!0),ue.value.length?(_i(),Pi("div",DN,[lt("h4",null,Vt(dt.$t("admin.publishedLayers")),1),lt("ul",null,[(_i(!0),Pi($r,null,Ba(ue.value,Pt=>(_i(),Pi("li",{key:Pt.name},Vt(Pt.name),1))),128))])])):En("",!0)])):En("",!0),d.value==="createUser"?(_i(),Pi("div",ON,[lt("h3",null,Vt(dt.$t("admin.createNewUser")),1),lt("form",{onSubmit:Kg(ri,["prevent"])},[fo(lt("input",{"onUpdate:modelValue":kt[8]||(kt[8]=Pt=>we.value=Pt),type:"email",placeholder:dt.$t("admin.email"),required:""},null,8,RN),[[rl,we.value]]),fo(lt("input",{"onUpdate:modelValue":kt[9]||(kt[9]=Pt=>Me.value=Pt),type:"password",placeholder:dt.$t("admin.password"),required:""},null,8,zN),[[rl,Me.value]]),fo(lt("select",{"onUpdate:modelValue":kt[10]||(kt[10]=Pt=>Ye.value=Pt),required:""},[lt("option",BN,Vt(dt.$t("admin.selectRole")),1),lt("option",FN,Vt(dt.$t("admin.adminRole")),1),lt("option",NN,Vt(dt.$t("admin.partnerRole")),1),lt("option",UN,Vt(dt.$t("admin.analystRole")),1),lt("option",VN,Vt(dt.$t("admin.publicRole")),1)],512),[[Ch,Ye.value]]),lt("button",jN,Vt(dt.$t("admin.createUser")),1)],32),Ze.value?(_i(),Pi("p",{key:0,class:Vs({success:je.value,error:!je.value})},Vt(Ze.value),3)):En("",!0)])):En("",!0),d.value==="generateSynthetic"?(_i(),Pi("div",$N,[lt("h3",null,Vt(dt.$t("admin.generateSyntheticTitle")),1),lt("p",null,Vt(dt.$t("admin.generateSyntheticDescription")),1),lt("button",{onClick:bt,disabled:ae.value},Vt(ae.value?dt.$t("admin.generating"):dt.$t("admin.generateNow")),9,GN),ge.value?(_i(),Pi("p",{key:0,class:Vs({success:Oe.value,error:!Oe.value})},Vt(ge.value),3)):En("",!0),ze.value&&Object.keys(ze.value).length?(_i(),Pi("div",WN,[lt("h4",null,Vt(dt.$t("admin.insertedRowCounts")),1),lt("ul",null,[(_i(!0),Pi($r,null,Ba(ze.value,(Pt,vt)=>(_i(),Pi("li",{key:vt},Vt(vt)+": "+Vt(Pt),1))),128))])])):En("",!0),rt.value?(_i(),Pi("div",HN,[lt("strong",null,Vt(dt.$t("admin.output")),1),lt("pre",qN,Vt(rt.value),1)])):En("",!0)])):En("",!0),d.value==="manageData"?(_i(),Pi("div",XN,[lt("h3",null,Vt(dt.$t("admin.dataManagementPlaceholderTitle")),1),lt("p",null,Vt(dt.$t("admin.dataManagementPlaceholderDescription")),1)])):En("",!0)]))}}),YN=da(ZN,[["__scopeId","data-v-5c37d621"]]),KN=[{path:"/",name:"Home",component:Y3},{path:"/map",name:"Map",component:OF},{path:"/catalog",name:"Catalog",component:GF},{path:"/about",name:"About",component:uN},{path:"/me-dashboard",name:"M&E Dashboard",component:NF,meta:{requiresAuth:!0,allowedRoles:["admin","partner","analyst"]}},{path:"/dashboard",redirect:"/map"},{path:"/monitoring",redirect:"/me-dashboard"},{path:"/admin-panel",name:"Admin Panel",component:YN,meta:{requiresAuth:!0,allowedRoles:["admin"]}},{path:"/login",name:"Login",component:TN},{path:"/:pathMatch(.*)*",redirect:"/"}],YA=RD({history:hD("/projects/soil_values/"),routes:KN});YA.beforeEach((t,l,d)=>{const _=vm(),{token:T,role:C}=JR(_),P=!!T.value;if(t.name==="Login"&&P)return d("/");if(t.meta.requiresAuth&&!P){const V=encodeURIComponent(t.fullPath);return d({path:"/login",query:{redirect:V}})}if(t.meta.allowedRoles&&P&&!(t.meta.allowedRoles.includes(C.value)||C.value==="admin"))return d("/");d()});function JN(t){const d=vm().role,_=t.currentRoute.value.query.redirect;return _?decodeURIComponent(_):d==="admin"?"/admin-panel":"/"}var KA={exports:{}},T0={exports:{}},oE;function QN(){return oE||(oE=1,function(t,l){(function(d,_){d._Highcharts=_(),t.exports=d._Highcharts})(typeof window>"u"?HA:window,()=>(()=>{var cg;let d,_;var T,C,P,V,s,$,Z,J,ne,ue,we,Me,Ye,Ze,je,ae,ge,Oe,ze={};ze.d=(R,o)=>{for(var u in o)ze.o(o,u)&&!ze.o(R,u)&&Object.defineProperty(R,u,{enumerable:!0,get:o[u]})},ze.o=(R,o)=>Object.prototype.hasOwnProperty.call(R,o);var rt={};ze.d(rt,{default:()=>oy}),function(R){var o,u,p,x,v,S,A;R.SVG_NS="http://www.w3.org/2000/svg",R.product="Highcharts",R.version="12.2.0",R.win=typeof window<"u"?window:{},R.doc=R.win.document,R.svg=!!((p=(u=(o=R.doc)==null?void 0:o.createElementNS)==null?void 0:u.call(o,R.SVG_NS,"svg"))!=null&&p.createSVGRect),R.pageLang=(S=(v=(x=R.doc)==null?void 0:x.documentElement)==null?void 0:v.closest("[lang]"))==null?void 0:S.lang,R.userAgent=((A=R.win.navigator)==null?void 0:A.userAgent)||"",R.isChrome=R.win.chrome,R.isFirefox=R.userAgent.indexOf("Firefox")!==-1,R.isMS=/(edge|msie|trident)/i.test(R.userAgent)&&!R.win.opera,R.isSafari=!R.isChrome&&R.userAgent.indexOf("Safari")!==-1,R.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(R.userAgent),R.isWebKit=R.userAgent.indexOf("AppleWebKit")!==-1,R.deg2rad=2*Math.PI/360,R.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],R.noop=function(){},R.supportsPassiveEvents=function(){let I=!1;if(!R.isMS){let O=Object.defineProperty({},"passive",{get:function(){I=!0}});R.win.addEventListener&&R.win.removeEventListener&&(R.win.addEventListener("testPassive",R.noop,O),R.win.removeEventListener("testPassive",R.noop,O))}return I}(),R.charts=[],R.composed=[],R.dateFormats={},R.seriesTypes={},R.symbolSizes={},R.chartCount=0}(T||(T={}));let ke=T,{charts:Ke,doc:He,win:ri}=ke;function bt(R,o,u,p){let x=o?"Highcharts error":"Highcharts warning";R===32&&(R=`${x}: Deprecated member`);let v=vi(R),S=v?`${x} #${R}: www.highcharts.com/errors/${R}/`:R.toString();if(p!==void 0){let A="";v&&(S+="?"),si(p,function(I,O){A+=`
 - ${O}: ${I}`,v&&(S+=encodeURI(O)+"="+encodeURI(I))}),S+=A}or(ke,"displayError",{chart:u,code:R,message:S,params:p},function(){if(o)throw Error(S);ri.console&&bt.messages.indexOf(S)===-1&&console.warn(S)}),bt.messages.push(S)}function dt(R,o){return parseInt(R,o||10)}function kt(R){return typeof R=="string"}function Pt(R){let o=Object.prototype.toString.call(R);return o==="[object Array]"||o==="[object Array Iterator]"}function vt(R,o){return!!R&&typeof R=="object"&&(!o||!Pt(R))}function ci(R){return vt(R)&&typeof R.nodeType=="number"}function xi(R){let o=R==null?void 0:R.constructor;return!!(vt(R,!0)&&!ci(R)&&(o!=null&&o.name)&&o.name!=="Object")}function vi(R){return typeof R=="number"&&!isNaN(R)&&R<1/0&&R>-1/0}function Lr(R){return R!=null}function ir(R,o,u){let p,x=kt(o)&&!Lr(u),v=(S,A)=>{Lr(S)?R.setAttribute(A,S):x?(p=R.getAttribute(A))||A!=="class"||(p=R.getAttribute(A+"Name")):R.removeAttribute(A)};return kt(o)?v(u,o):si(o,v),p}function sr(R){return Pt(R)?R:[R]}function nn(R,o){let u;for(u in R||(R={}),o)R[u]=o[u];return R}function fr(){let R=arguments,o=R.length;for(let u=0;u<o;u++){let p=R[u];if(p!=null)return p}}function Bn(R,o){nn(R.style,o)}function sn(R){return Math.pow(10,Math.floor(Math.log(R)/Math.LN10))}function zt(R,o){return R>1e14?R:parseFloat(R.toPrecision(o||14))}(bt||(bt={})).messages=[],Math.easeInOutSine=function(R){return-.5*(Math.cos(Math.PI*R)-1)};let mi=Array.prototype.find?function(R,o){return R.find(o)}:function(R,o){let u,p=R.length;for(u=0;u<p;u++)if(o(R[u],u))return R[u]};function si(R,o,u){for(let p in R)Object.hasOwnProperty.call(R,p)&&o.call(u||R[p],R[p],p,R)}function Ei(R,o,u){function p(S,A){let I=R.removeEventListener;I&&I.call(R,S,A,!1)}function x(S){let A,I;R.nodeName&&(o?(A={})[o]=!0:A=S,si(A,function(O,N){if(S[N])for(I=S[N].length;I--;)p(N,S[N][I].fn)}))}let v=typeof R=="function"&&R.prototype||R;if(Object.hasOwnProperty.call(v,"hcEvents")){let S=v.hcEvents;if(o){let A=S[o]||[];u?(S[o]=A.filter(function(I){return u!==I.fn}),p(o,u)):(x(S),S[o]=[])}else x(S),delete v.hcEvents}}function or(R,o,u,p){if(u=u||{},(He==null?void 0:He.createEvent)&&(R.dispatchEvent||R.fireEvent&&R!==ke)){let x=He.createEvent("Events");x.initEvent(o,!0,!0),u=nn(x,u),R.dispatchEvent?R.dispatchEvent(u):R.fireEvent(o,u)}else if(R.hcEvents){u.target||nn(u,{preventDefault:function(){u.defaultPrevented=!0},target:R,type:o});let x=[],v=R,S=!1;for(;v.hcEvents;)Object.hasOwnProperty.call(v,"hcEvents")&&v.hcEvents[o]&&(x.length&&(S=!0),x.unshift.apply(x,v.hcEvents[o])),v=Object.getPrototypeOf(v);S&&x.sort((A,I)=>A.order-I.order),x.forEach(A=>{A.fn.call(R,u)===!1&&u.preventDefault()})}p&&!u.defaultPrevented&&p.call(R,u)}let Si=function(){let R=Math.random().toString(36).substring(2,9)+"-",o=0;return function(){return"highcharts-"+(d?"":R)+o++}}();ri.jQuery&&(ri.jQuery.fn.highcharts=function(){let R=[].slice.call(arguments);if(this[0])return R[0]?(new ke[kt(R[0])?R.shift():"Chart"](this[0],R[0],R[1]),this):Ke[ir(this[0],"data-highcharts-chart")]});let xe={addEvent:function(R,o,u,p={}){let x=typeof R=="function"&&R.prototype||R;Object.hasOwnProperty.call(x,"hcEvents")||(x.hcEvents={});let v=x.hcEvents;ke.Point&&R instanceof ke.Point&&R.series&&R.series.chart&&(R.series.chart.runTrackerClick=!0);let S=R.addEventListener;S&&S.call(R,o,u,!!ke.supportsPassiveEvents&&{passive:p.passive===void 0?o.indexOf("touch")!==-1:p.passive,capture:!1}),v[o]||(v[o]=[]);let A={fn:u,order:typeof p.order=="number"?p.order:1/0};return v[o].push(A),v[o].sort((I,O)=>I.order-O.order),function(){Ei(R,o,u)}},arrayMax:function(R){let o=R.length,u=R[0];for(;o--;)R[o]>u&&(u=R[o]);return u},arrayMin:function(R){let o=R.length,u=R[0];for(;o--;)R[o]<u&&(u=R[o]);return u},attr:ir,clamp:function(R,o,u){return R>o?R<u?R:u:o},clearTimeout:function(R){Lr(R)&&clearTimeout(R)},correctFloat:zt,createElement:function(R,o,u,p,x){let v=He.createElement(R);return o&&nn(v,o),x&&Bn(v,{padding:"0",border:"none",margin:"0"}),u&&Bn(v,u),p&&p.appendChild(v),v},crisp:function(R,o=0,u){let p=o%2/2,x=u?-1:1;return(Math.round(R*x-p)+p)*x},css:Bn,defined:Lr,destroyObjectProperties:function(R,o,u){si(R,function(p,x){p!==o&&(p!=null&&p.destroy)&&p.destroy(),(p!=null&&p.destroy||!u)&&delete R[x]})},diffObjects:function(R,o,u,p){let x={};return function v(S,A,I,O){let N=u?A:S;si(S,function(z,j){if(!O&&p&&p.indexOf(j)>-1&&A[j]){z=sr(z),I[j]=[];for(let q=0;q<Math.max(z.length,A[j].length);q++)A[j][q]&&(z[q]===void 0?I[j][q]=A[j][q]:(I[j][q]={},v(z[q],A[j][q],I[j][q],O+1)))}else vt(z,!0)&&!z.nodeType?(I[j]=Pt(z)?[]:{},v(z,A[j]||{},I[j],O+1),Object.keys(I[j]).length===0&&(j!=="colorAxis"||O!==0)&&delete I[j]):(S[j]!==A[j]||j in S&&!(j in A))&&j!=="__proto__"&&j!=="constructor"&&(I[j]=N[j])})}(R,o,x,0),x},discardElement:function(R){var o;(o=R==null?void 0:R.parentElement)==null||o.removeChild(R)},erase:function(R,o){let u=R.length;for(;u--;)if(R[u]===o){R.splice(u,1);break}},error:bt,extend:nn,extendClass:function(R,o){let u=function(){};return u.prototype=new R,nn(u.prototype,o),u},find:mi,fireEvent:or,getAlignFactor:(R="")=>({center:.5,right:1,middle:.5,bottom:1})[R]||0,getClosestDistance:function(R,o){let u,p,x,v=!o;return R.forEach(S=>{if(S.length>1)for(x=S.length-1;x>0;x--)(p=S[x]-S[x-1])<0&&!v?(o==null||o(),o=void 0):p&&(u===void 0||p<u)&&(u=p)}),u},getMagnitude:sn,getNestedProperty:function(R,o){let u=R.split(".");for(;u.length&&Lr(o);){let p=u.shift();if(p===void 0||p==="__proto__")return;if(p==="this"){let v;return vt(o)&&(v=o["@this"]),v??o}let x=o[p.replace(/[\\'"]/g,"")];if(!Lr(x)||typeof x=="function"||typeof x.nodeType=="number"||x===ri)return;o=x}return o},getStyle:function R(o,u,p){var S;let x;if(u==="width"){let A=Math.min(o.offsetWidth,o.scrollWidth),I=(S=o.getBoundingClientRect)==null?void 0:S.call(o).width;return I<A&&I>=A-1&&(A=Math.floor(I)),Math.max(0,A-(R(o,"padding-left",!0)||0)-(R(o,"padding-right",!0)||0))}if(u==="height")return Math.max(0,Math.min(o.offsetHeight,o.scrollHeight)-(R(o,"padding-top",!0)||0)-(R(o,"padding-bottom",!0)||0));let v=ri.getComputedStyle(o,void 0);return v&&(x=v.getPropertyValue(u),fr(p,u!=="opacity")&&(x=dt(x))),x},insertItem:function(R,o){let u,p=R.options.index,x=o.length;for(u=R.options.isInternal?x:0;u<x+1;u++)if(!o[u]||vi(p)&&p<fr(o[u].options.index,o[u]._i)||o[u].options.isInternal){o.splice(u,0,R);break}return u},isArray:Pt,isClass:xi,isDOMElement:ci,isFunction:function(R){return typeof R=="function"},isNumber:vi,isObject:vt,isString:kt,merge:function(R,...o){let u,p=[R,...o],x={},v=function(A,I){return typeof A!="object"&&(A={}),si(I,function(O,N){N!=="__proto__"&&N!=="constructor"&&(!vt(O,!0)||xi(O)||ci(O)?A[N]=I[N]:A[N]=v(A[N]||{},O))}),A};R===!0&&(x=p[1],p=Array.prototype.slice.call(p,2));let S=p.length;for(u=0;u<S;u++)x=v(x,p[u]);return x},normalizeTickInterval:function(R,o,u,p,x){let v,S=R;u=fr(u,sn(R));let A=R/u;for(!o&&(o=x?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],p===!1&&(u===1?o=o.filter(function(I){return I%1==0}):u<=.1&&(o=[1/u]))),v=0;v<o.length&&(S=o[v],(!x||!(S*u>=R))&&(x||!(A<=(o[v]+(o[v+1]||o[v]))/2)));v++);return zt(S*u,-Math.round(Math.log(.001)/Math.LN10))},objectEach:si,offset:function(R){let o=He.documentElement,u=R.parentElement||R.parentNode?R.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:u.top+(ri.pageYOffset||o.scrollTop)-(o.clientTop||0),left:u.left+(ri.pageXOffset||o.scrollLeft)-(o.clientLeft||0),width:u.width,height:u.height}},pad:function(R,o,u){return Array((o||2)+1-String(R).replace("-","").length).join(u||"0")+R},pick:fr,pInt:dt,pushUnique:function(R,o){return 0>R.indexOf(o)&&!!R.push(o)},relativeLength:function(R,o,u){return/%$/.test(R)?o*parseFloat(R)/100+(u||0):parseFloat(R)},removeEvent:Ei,replaceNested:function(R,...o){let u,p;do for(p of(u=R,o))R=R.replace(p[0],p[1]);while(R!==u);return R},splat:sr,stableSort:function(R,o){let u,p,x=R.length;for(p=0;p<x;p++)R[p].safeI=p;for(R.sort(function(v,S){return(u=o(v,S))===0?v.safeI-S.safeI:u}),p=0;p<x;p++)delete R[p].safeI},syncTimeout:function(R,o,u){return o>0?setTimeout(R,o,u):(R.call(0,u),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(R){return kt(R)?R.substring(0,1).toUpperCase()+R.substring(1):String(R)},uniqueKey:Si,useSerialIds:function(R){return d=fr(R,d)},wrap:function(R,o,u){let p=R[o];R[o]=function(){let x=arguments,v=this;return u.apply(this,[function(){return p.apply(v,arguments.length?arguments:x)}].concat([].slice.call(arguments)))}}},{pageLang:ve,win:nt}=ke,{defined:Lt,error:At,extend:Yt,isNumber:oi,isObject:Te,isString:Ae,merge:Qe,objectEach:Wt,pad:Ht,splat:Kt,timeUnits:ut,ucfirst:It}=xe,Ii=ke.isSafari&&nt.Intl&&!nt.Intl.DateTimeFormat.prototype.formatRange,Oi=R=>R.main===void 0,Gr=class{constructor(R,o){this.options={timezone:"UTC"},this.variableTimezone=!1,this.Date=nt.Date,this.update(R),this.lang=o}update(R={}){this.dTLCache={},this.options=R=Qe(!0,this.options,R);let{timezoneOffset:o,useUTC:u}=R;this.Date=R.Date||nt.Date||Date;let p=R.timezone;Lt(u)&&(p=u?"UTC":void 0),o&&o%60==0&&(p="Etc/GMT"+(o>0?"+":"")+o/60),this.variableTimezone=p!=="UTC"&&(p==null?void 0:p.indexOf("Etc/GMT"))!==0,this.timezone=p,["months","shortMonths","weekdays","shortWeekdays"].forEach(x=>{let v=/months/i.test(x),S=/short/.test(x),A={timeZone:"UTC"};A[v?"month":"weekday"]=S?"short":"long",this[x]=(v?[0,1,2,3,4,5,6,7,8,9,10,11]:[3,4,5,6,7,8,9]).map(I=>this.dateFormat(A,(v?31:1)*24*36e5*I))})}toParts(R){let[o,u,p,x,v,S,A]=this.dateTimeFormat({weekday:"narrow",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},R,"es").split(/(?:, | |\/|:)/g);return[x,+p-1,u,v,S,A,Math.floor(Number(R)||0)%1e3,"DLMXJVS".indexOf(o)].map(Number)}dateTimeFormat(R,o,u=this.options.locale||ve){let p=JSON.stringify(R)+u;Ae(R)&&(R=this.str2dtf(R));let x=this.dTLCache[p];if(!x){R.timeZone??(R.timeZone=this.timezone);try{x=new Intl.DateTimeFormat(u,R)}catch(v){/Invalid time zone/i.test(v.message)?(At(34),R.timeZone="UTC",x=new Intl.DateTimeFormat(u,R)):At(v.message,!1)}}return this.dTLCache[p]=x,(x==null?void 0:x.format(o))||""}str2dtf(R,o={}){let u={L:{fractionalSecondDigits:3},S:{second:"2-digit"},M:{minute:"numeric"},H:{hour:"2-digit"},k:{hour:"numeric"},E:{weekday:"narrow"},a:{weekday:"short"},A:{weekday:"long"},d:{day:"2-digit"},e:{day:"numeric"},b:{month:"short"},B:{month:"long"},m:{month:"2-digit"},o:{month:"numeric"},y:{year:"2-digit"},Y:{year:"numeric"}};return Object.keys(u).forEach(p=>{R.indexOf(p)!==-1&&Yt(o,u[p])}),o}makeTime(R,o,u=1,p=0,x,v,S){let A=this.Date.UTC(R,o,u,p,x||0,v||0,S||0);if(this.timezone!=="UTC"){let I=this.getTimezoneOffset(A);if(A+=I,[2,3,8,9,10,11].indexOf(o)!==-1&&(p<5||p>20)){let O=this.getTimezoneOffset(A);I!==O?A+=O-I:I-36e5!==this.getTimezoneOffset(A-36e5)||Ii||(A-=36e5)}}return A}parse(R){if(!Ae(R))return R??void 0;let o=(R=R.replace(/\//g,"-").replace(/(GMT|UTC)/,"")).indexOf("Z")>-1||/([+-][0-9]{2}):?[0-9]{2}$/.test(R),u=/^[0-9]{4}-[0-9]{2}(-[0-9]{2}|)$/.test(R);o||u||(R+="Z");let p=Date.parse(R);if(oi(p))return p+(!o||u?this.getTimezoneOffset(p):0)}getTimezoneOffset(R){if(this.timezone!=="UTC"){let[o,u,p,x,v=0]=this.dateTimeFormat({timeZoneName:"shortOffset"},R,"en").split(/(GMT|:)/).map(Number),S=-(36e5*(p+v/60));if(oi(S))return S}return 0}dateFormat(R,o,u){let p=this.lang;if(!Lt(o)||isNaN(o))return(p==null?void 0:p.invalidDate)||"";if(Ae(R=R??"%Y-%m-%d %H:%M:%S")){let x,v=/%\[([a-zA-Z]+)\]/g;for(;x=v.exec(R);)R=R.replace(x[0],this.dateTimeFormat(x[1],o,p==null?void 0:p.locale))}if(Ae(R)&&R.indexOf("%")!==-1){let x=this,[v,S,A,I,O,N,z,j]=this.toParts(o),q=(p==null?void 0:p.weekdays)||this.weekdays,K=(p==null?void 0:p.shortWeekdays)||this.shortWeekdays,se=(p==null?void 0:p.months)||this.months,re=(p==null?void 0:p.shortMonths)||this.shortMonths;Wt(Yt({a:K?K[j]:q[j].substr(0,3),A:q[j],d:Ht(A),e:Ht(A,2," "),w:j,v:(p==null?void 0:p.weekFrom)??"",b:re[S],B:se[S],m:Ht(S+1),o:S+1,y:v.toString().substr(2,2),Y:v,H:Ht(I),k:I,I:Ht(I%12||12),l:I%12||12,M:Ht(O),p:I<12?"AM":"PM",P:I<12?"am":"pm",S:Ht(N),L:Ht(z,3)},ke.dateFormats),function(te,ce){if(Ae(R))for(;R.indexOf("%"+ce)!==-1;)R=R.replace("%"+ce,typeof te=="function"?te.call(x,o):te)})}else if(Te(R)){let x=(this.getTimezoneOffset(o)||0)/36e5,v=this.timezone||"Etc/GMT"+(x>=0?"+":"")+x,{prefix:S="",suffix:A=""}=R;R=S+this.dateTimeFormat(Yt({timeZone:v},R),o)+A}return u?It(R):R}resolveDTLFormat(R){return Te(R,!0)?Te(R,!0)&&Oi(R)?{main:R}:R:{main:(R=Kt(R))[0],from:R[1],to:R[2]}}getDateFormat(R,o,u,p){let x=this.dateFormat("%m-%d %H:%M:%S.%L",o),v="01-01 00:00:00.000",S={millisecond:15,second:12,minute:9,hour:6,day:3},A="millisecond",I=A;for(A in ut){if(R&&R===ut.week&&+this.dateFormat("%w",o)===u&&x.substr(6)===v.substr(6)){A="week";break}if(R&&ut[A]>R){A=I;break}if(S[A]&&x.substr(S[A])!==v.substr(S[A]))break;A!=="week"&&(I=A)}return this.resolveDTLFormat(p[A]).main}},{defined:Ur,extend:un,timeUnits:cr}=xe,us=class extends Gr{getTimeTicks(R,o,u,p){let x=this,v=[],S={},{count:A=1,unitRange:I}=R,[O,N,z,j,q,K]=x.toParts(o),se=(o||0)%1e3,re;if(p??(p=1),Ur(o)){if(se=I>=cr.second?0:A*Math.floor(se/A),I>=cr.second&&(K=I>=cr.minute?0:A*Math.floor(K/A)),I>=cr.minute&&(q=I>=cr.hour?0:A*Math.floor(q/A)),I>=cr.hour&&(j=I>=cr.day?0:A*Math.floor(j/A)),I>=cr.day&&(z=I>=cr.month?1:Math.max(1,A*Math.floor(z/A))),I>=cr.month&&(N=I>=cr.year?0:A*Math.floor(N/A)),I>=cr.year&&(O-=O%A),I===cr.week){A&&(o=x.makeTime(O,N,z,j,q,K,se));let fe=this.dateTimeFormat({timeZone:this.timezone,weekday:"narrow"},o,"es"),Xe="DLMXJVS".indexOf(fe);z+=-Xe+p+(Xe<p?-7:0)}o=x.makeTime(O,N,z,j,q,K,se),x.variableTimezone&&Ur(u)&&(re=u-o>4*cr.month||x.getTimezoneOffset(o)!==x.getTimezoneOffset(u));let te=o,ce=1;for(;te<u;)v.push(te),I===cr.year?te=x.makeTime(O+ce*A,0):I===cr.month?te=x.makeTime(O,N+ce*A):re&&(I===cr.day||I===cr.week)?te=x.makeTime(O,N,z+ce*A*(I===cr.day?1:7)):re&&I===cr.hour&&A>1?te=x.makeTime(O,N,z,j+ce*A):te+=I*A,ce++;v.push(te),I<=cr.hour&&v.length<1e4&&v.forEach(fe=>{fe%18e5==0&&x.dateFormat("%H%M%S%L",fe)==="000000000"&&(S[fe]="day")})}return v.info=un(R,{higherRanks:S,totalRange:I*A}),v}},{isTouchDevice:yo}=ke,{fireEvent:Fn,merge:Qn}=xe,os={colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{weekFrom:"week from",chartTitle:"Chart title",locale:void 0,loading:"Loading...",months:void 0,seriesName:"Series {add index 1}",shortMonths:void 0,weekdays:void 0,numericSymbols:["k","M","G","T","P","E"],pieSliceName:"Slice",resetZoom:"Reset zoom",yAxisTitle:"Values",resetZoomTitle:"Reset zoom level 1:1"},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,timezone:"UTC",timezoneOffset:0,useUTC:void 0},chart:{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",margin:15,minScale:.67},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:""},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:R=>Math.sqrt(1-Math.pow(R-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%[AebHMSL]",second:"%[AebHMS]",minute:"%[AebHM]",hour:"%[AebHM]",day:"%[AebY]",week:"%v %[AebY]",month:"%[BY]",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,position:{x:0,y:3},shared:!1,snap:yo?25:10,headerFormat:'<span style="font-size: 0.8em">{ucfirst point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}},Gl=new us(os.time,os.lang),Le={defaultOptions:os,defaultTime:Gl,getOptions:function(){return os},setOptions:function(R){var o;return Fn(ke,"setOptions",{options:R}),Qn(!0,os,R),R.time&&Gl.update(os.time),R.lang&&"locale"in R.lang&&Gl.update({locale:R.lang.locale}),(o=R.lang)!=null&&o.chartTitle&&(os.title={...os.title,text:R.lang.chartTitle}),os}},{win:oe}=ke,{isNumber:le,isString:Pe,merge:Ve,pInt:qe,defined:ct}=xe,ot=(R,o,u)=>`color-mix(in srgb,${R},${o} ${100*u}%)`,Je=R=>Pe(R)&&!!R&&R!=="none";class st{static parse(o){return o?new st(o):st.None}constructor(o){let u,p,x,v;this.rgba=[NaN,NaN,NaN,NaN],this.input=o;let S=ke.Color;if(S&&S!==st)return new S(o);if(typeof o=="object"&&o.stops!==void 0)this.stops=o.stops.map(A=>new st(A[1]));else if(typeof o=="string")for(this.input=o=st.names[o.toLowerCase()]||o,x=st.parsers.length;x--&&!p;)(u=(v=st.parsers[x]).regex.exec(o))&&(p=v.parse(u));p&&(this.rgba=p)}get(o){let u=this.input,p=this.rgba;if(this.output)return this.output;if(typeof u=="object"&&this.stops!==void 0){let x=Ve(u);return x.stops=[].slice.call(x.stops),this.stops.forEach((v,S)=>{x.stops[S]=[x.stops[S][0],v.get(o)]}),x}return p&&le(p[0])?o!=="rgb"&&(o||p[3]!==1)?o==="a"?`${p[3]}`:"rgba("+p.join(",")+")":"rgb("+p[0]+","+p[1]+","+p[2]+")":u}brighten(o){let u=this.rgba;if(this.stops)this.stops.forEach(function(p){p.brighten(o)});else if(le(o)&&o!==0)if(le(u[0]))for(let p=0;p<3;p++)u[p]+=qe(255*o),u[p]<0&&(u[p]=0),u[p]>255&&(u[p]=255);else st.useColorMix&&Je(this.input)&&(this.output=ot(this.input,o>0?"white":"black",Math.abs(o)));return this}setOpacity(o){return this.rgba[3]=o,this}tweenTo(o,u){let p=this.rgba,x=o.rgba;if(!le(p[0])||!le(x[0]))return st.useColorMix&&Je(this.input)&&Je(o.input)&&u<.99?ot(this.input,o.input,u):o.input||"none";let v=x[3]!==1||p[3]!==1,S=(I,O)=>I+(p[O]-I)*(1-u),A=x.slice(0,3).map(S).map(Math.round);return v&&A.push(S(x[3],3)),(v?"rgba(":"rgb(")+A.join(",")+")"}}st.names={white:"#ffffff",black:"#000000"},st.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(R){return[qe(R[1]),qe(R[2]),qe(R[3]),parseFloat(R[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(R){return[qe(R[1]),qe(R[2]),qe(R[3]),1]}},{regex:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?$/i,parse:function(R){return[qe(R[1]+R[1],16),qe(R[2]+R[2],16),qe(R[3]+R[3],16),ct(R[4])?qe(R[4]+R[4],16)/255:1]}},{regex:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?$/i,parse:function(R){return[qe(R[1],16),qe(R[2],16),qe(R[3],16),ct(R[4])?qe(R[4],16)/255:1]}}],st.useColorMix=(cg=oe.CSS)==null?void 0:cg.supports("color","color-mix(in srgb,red,blue 9%)"),st.None=new st("");let{parse:Qt}=st,{win:ni}=ke,{isNumber:qt,objectEach:$i}=xe;class zi{constructor(o,u,p){this.pos=NaN,this.options=u,this.elem=o,this.prop=p}dSetter(){let o=this.paths,u=o==null?void 0:o[0],p=o==null?void 0:o[1],x=this.now||0,v=[];if(x!==1&&u&&p)if(u.length===p.length&&x<1)for(let S=0;S<p.length;S++){let A=u[S],I=p[S],O=[];for(let N=0;N<I.length;N++){let z=A[N],j=I[N];qt(z)&&qt(j)&&(I[0]!=="A"||N!==4&&N!==5)?O[N]=z+x*(j-z):O[N]=j}v.push(O)}else v=p;else v=this.toD||[];this.elem.attr("d",v,void 0,!0)}update(){let o=this.elem,u=this.prop,p=this.now,x=this.options.step;this[u+"Setter"]?this[u+"Setter"]():o.attr?o.element&&o.attr(u,p,null,!0):o.style[u]=p+this.unit,x&&x.call(o,p,this)}run(o,u,p){let x=this,v=x.options,S=function(O){return!S.stopped&&x.step(O)},A=ni.requestAnimationFrame||function(O){setTimeout(O,13)},I=function(){for(let O=0;O<zi.timers.length;O++)zi.timers[O]()||zi.timers.splice(O--,1);zi.timers.length&&A(I)};o!==u||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=o,this.end=u,this.unit=p,this.now=this.start,this.pos=0,S.elem=this.elem,S.prop=this.prop,S()&&zi.timers.push(S)===1&&A(I)):(delete v.curAnim[this.prop],v.complete&&Object.keys(v.curAnim).length===0&&v.complete.call(this.elem))}step(o){let u,p,x=+new Date,v=this.options,S=this.elem,A=v.complete,I=v.duration,O=v.curAnim;return S.attr&&!S.element?u=!1:o||x>=I+this.startTime?(this.now=this.end,this.pos=1,this.update(),O[this.prop]=!0,p=!0,$i(O,function(N){N!==!0&&(p=!1)}),p&&A&&A.call(S),u=!1):(this.pos=v.easing((x-this.startTime)/I),this.now=this.start+(this.end-this.start)*this.pos,this.update(),u=!0),u}initPath(o,u,p){let x=o.startX,v=o.endX,S=p.slice(),A=o.isArea,I=A?2:1,O=u&&p.length>u.length&&p.hasStackedCliffs,N,z,j,q,K=u==null?void 0:u.slice();if(!K||O)return[S,S];function se(te,ce){for(;te.length<z;){let fe=te[0],Xe=ce[z-te.length];if(Xe&&fe[0]==="M"&&(Xe[0]==="C"?te[0]=["C",fe[1],fe[2],fe[1],fe[2],fe[1],fe[2]]:te[0]=["L",fe[1],fe[2]]),te.unshift(fe),A){let Ne=te.pop();te.push(te[te.length-1],Ne)}}}function re(te){for(;te.length<z;){let ce=te[Math.floor(te.length/I)-1].slice();if(ce[0]==="C"&&(ce[1]=ce[5],ce[2]=ce[6]),A){let fe=te[Math.floor(te.length/I)].slice();te.splice(te.length/2,0,ce,fe)}else te.push(ce)}}if(x&&v&&v.length){for(j=0;j<x.length;j++){if(x[j]===v[0]){N=j;break}if(x[0]===v[v.length-x.length+j]){N=j,q=!0;break}if(x[x.length-1]===v[v.length-x.length+j]){N=x.length-j;break}}N===void 0&&(K=[])}return K.length&&qt(N)&&(z=S.length+N*I,q?(se(K,S),re(S)):(se(S,K),re(K))),[K,S]}fillSetter(){zi.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,Qt(this.start).tweenTo(Qt(this.end),this.pos),void 0,!0)}}zi.timers=[];let{defined:Gi,getStyle:ar,isArray:dr,isNumber:dn,isObject:xn,merge:as,objectEach:Gn,pick:Uo}=xe;function Wn(R){return xn(R)?as({duration:500,defer:0},R):{duration:500*!!R,defer:0}}function ds(R,o){let u=zi.timers.length;for(;u--;)zi.timers[u].elem!==R||o&&o!==zi.timers[u].prop||(zi.timers[u].stopped=!0)}let Cn={animate:function(R,o,u){let p,x="",v,S,A;xn(u)||(A=arguments,u={duration:A[2],easing:A[3],complete:A[4]}),dn(u.duration)||(u.duration=400),u.easing=typeof u.easing=="function"?u.easing:Math[u.easing]||Math.easeInOutSine,u.curAnim=as(o),Gn(o,function(I,O){ds(R,O),S=new zi(R,u,O),v=void 0,O==="d"&&dr(o.d)?(S.paths=S.initPath(R,R.pathArray,o.d),S.toD=o.d,p=0,v=1):R.attr?p=R.attr(O):(p=parseFloat(ar(R,O))||0,O!=="opacity"&&(x="px")),v||(v=I),typeof v=="string"&&v.match("px")&&(v=v.replace(/px/g,"")),S.run(p,v,x)})},animObject:Wn,getDeferredAnimation:function(R,o,u){let p=Wn(o),x=u?[u]:R.series,v=0,S=0;return x.forEach(A=>{let I=Wn(A.options.animation);v=xn(o)&&Gi(o.defer)?p.defer:Math.max(v,I.duration+I.defer),S=Math.min(p.duration,I.duration)}),R.renderer.forExport&&(v=0),{defer:Math.max(0,v-S),duration:Math.min(v,S)}},setAnimation:function(R,o){o.renderer.globalAnimation=Uo(R,o.options.chart.animation,!0)},stop:ds},{SVG_NS:Ff,win:Nf}=ke,{attr:Tr,createElement:id,css:Bc,error:Rh,isFunction:zh,isString:xo,objectEach:Vo,splat:rd}=xe,{trustedTypes:Fc}=Nf,jo=Fc&&zh(Fc.createPolicy)&&Fc.createPolicy("highcharts",{createHTML:R=>R}),fa=jo?jo.createHTML(""):"";class jr{static filterUserAttributes(o){return Vo(o,(u,p)=>{let x=!0;jr.allowedAttributes.indexOf(p)===-1&&(x=!1),["background","dynsrc","href","lowsrc","src"].indexOf(p)!==-1&&(x=xo(u)&&jr.allowedReferences.some(v=>u.indexOf(v)===0)),x||(Rh(33,!1,void 0,{"Invalid attribute in config":`${p}`}),delete o[p]),xo(u)&&o[p]&&(o[p]=u.replace(/</g,"&lt;"))}),o}static parseStyle(o){return o.split(";").reduce((u,p)=>{let x=p.split(":").map(S=>S.trim()),v=x.shift();return v&&x.length&&(u[v.replace(/-([a-z])/g,S=>S[1].toUpperCase())]=x.join(":")),u},{})}static setElementHTML(o,u){o.innerHTML=jr.emptyHTML,u&&new jr(u).addToDOM(o)}constructor(o){this.nodes=typeof o=="string"?this.parseMarkup(o):o}addToDOM(o){return function u(p,x){let v;return rd(p).forEach(function(S){let A,I=S.tagName,O=S.textContent?ke.doc.createTextNode(S.textContent):void 0,N=jr.bypassHTMLFiltering;if(I)if(I==="#text")A=O;else if(jr.allowedTags.indexOf(I)!==-1||N){let z=I==="svg"?Ff:x.namespaceURI||Ff,j=ke.doc.createElementNS(z,I),q=S.attributes||{};Vo(S,function(K,se){se!=="tagName"&&se!=="attributes"&&se!=="children"&&se!=="style"&&se!=="textContent"&&(q[se]=K)}),Tr(j,N?q:jr.filterUserAttributes(q)),S.style&&Bc(j,S.style),O&&j.appendChild(O),u(S.children||[],j),A=j}else Rh(33,!1,void 0,{"Invalid tagName in config":I});A&&x.appendChild(A),v=A}),v}(this.nodes,o)}parseMarkup(o){let u,p=[];o=o.trim().replace(/ style=(["'])/g," data-style=$1");try{u=new DOMParser().parseFromString(jo?jo.createHTML(o):o,"text/html")}catch{}if(!u){let v=id("div");v.innerHTML=o,u={body:v}}let x=(v,S)=>{let A=v.nodeName.toLowerCase(),I={tagName:A};A==="#text"&&(I.textContent=v.textContent||"");let O=v.attributes;if(O){let N={};[].forEach.call(O,z=>{z.name==="data-style"?I.style=jr.parseStyle(z.value):N[z.name]=z.value}),I.attributes=N}if(v.childNodes.length){let N=[];[].forEach.call(v.childNodes,z=>{x(z,N)}),N.length&&(I.children=N)}S.push(I)};return[].forEach.call(u.body.childNodes,v=>x(v,p)),p}}jr.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],jr.allowedReferences=["https://","http://","mailto:","/","../","./","#"],jr.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],jr.emptyHTML=fa,jr.bypassHTMLFiltering=!1;let{defaultOptions:wt,defaultTime:$o}=Le,{pageLang:Nn}=ke,{extend:es,getNestedProperty:Uf,isArray:Go,isNumber:Bh,isObject:Vf,isString:Wl,pick:hi,ucfirst:hr}=xe,Ki={add:(R,o)=>R+o,divide:(R,o)=>o!==0?R/o:"",eq:(R,o)=>R==o,each:function(R){let o=arguments[arguments.length-1];return!!Go(R)&&R.map((u,p)=>Ji(o.body,es(Vf(u)?u:{"@this":u},{"@index":p,"@first":p===0,"@last":p===R.length-1}))).join("")},ge:(R,o)=>R>=o,gt:(R,o)=>R>o,if:R=>!!R,le:(R,o)=>R<=o,lt:(R,o)=>R<o,multiply:(R,o)=>R*o,ne:(R,o)=>R!=o,subtract:(R,o)=>R-o,ucfirst:hr,unless:R=>!R},Ls={},Ks=R=>/^["'].+["']$/.test(R);function Ji(R="",o,u){var re;let p=/\{([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= #\(\)]+)\}/g,x=/\(([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= ]+)\)/g,v=[],S=/f$/,A=/\.(\d)/,I=((re=u==null?void 0:u.options)==null?void 0:re.lang)||wt.lang,O=(u==null?void 0:u.time)||$o,N=(u==null?void 0:u.numberFormatter)||Ds,z=(te="")=>{let ce;return te==="true"||te!=="false"&&((ce=Number(te)).toString()===te?ce:Ks(te)?te.slice(1,-1):Uf(te,o))},j,q,K=0,se;for(;(j=p.exec(R))!==null;){let te=j,ce=x.exec(j[1]);ce&&(j=ce,se=!0),q!=null&&q.isBlock||(q={ctx:o,expression:j[1],find:j[0],isBlock:j[1].charAt(0)==="#",start:j.index,startInner:j.index+j[0].length,length:j[0].length});let fe=(q.isBlock?te:j)[1].split(" ")[0].replace("#","");Ki[fe]&&(q.isBlock&&fe===q.fn&&K++,q.fn||(q.fn=fe));let Xe=j[1]==="else";if(q.isBlock&&q.fn&&(j[1]===`/${q.fn}`||Xe))if(K)!Xe&&K--;else{let Ne=q.startInner,$e=R.substr(Ne,j.index-Ne);q.body===void 0?(q.body=$e,q.startInner=j.index+j[0].length):q.elseBody=$e,q.find+=$e+j[0],Xe||(v.push(q),q=void 0)}else q.isBlock||v.push(q);if(ce&&!(q!=null&&q.isBlock))break}return v.forEach(te=>{let ce,fe,{body:Xe,elseBody:Ne,expression:$e,fn:mt}=te;if(mt){let tt=[te],gt=[],Bt=$e.length,Jt=0,ii;for(fe=0;fe<=Bt;fe++){let Ft=$e.charAt(fe);ii||Ft!=='"'&&Ft!=="'"?ii===Ft&&(ii=""):ii=Ft,ii||Ft!==" "&&fe!==Bt||(gt.push($e.substr(Jt,fe-Jt)),Jt=fe+1)}for(fe=Ki[mt].length;fe--;)tt.unshift(z(gt[fe+1]));ce=Ki[mt].apply(o,tt),te.isBlock&&typeof ce=="boolean"&&(ce=Ji(ce?Xe:Ne,o,u))}else{let tt=Ks($e)?[$e]:$e.split(":");if(ce=z(tt.shift()||""),tt.length&&typeof ce=="number"){let gt=tt.join(":");if(S.test(gt)){let Bt=parseInt((gt.match(A)||["","-1"])[1],10);ce!==null&&(ce=N(ce,Bt,I.decimalPoint,gt.indexOf(",")>-1?I.thousandsSep:""))}else ce=O.dateFormat(gt,ce)}x.lastIndex=0,x.test(te.find)&&Wl(ce)&&(ce=`"${ce}"`)}R=R.replace(te.find,hi(ce,""))}),se?Ji(R,o,u):R}function Ds(R,o,u,p){var se;o*=1;let x,v,[S,A]=(R=+R||0).toString().split("e").map(Number),I=((se=this==null?void 0:this.options)==null?void 0:se.lang)||wt.lang,O=(R.toString().split(".")[1]||"").split("e")[0].length,N=o,z={};u??(u=I.decimalPoint),p??(p=I.thousandsSep),o===-1?o=Math.min(O,20):Bh(o)?o&&A<0&&((v=o+A)>=0?(S=+S.toExponential(v).split("e")[0],o=v):(S=Math.floor(S),R=o<20?+(S*Math.pow(10,A)).toFixed(o):0,A=0)):o=2,A&&(o??(o=2),R=S),Bh(o)&&o>=0&&(z.minimumFractionDigits=o,z.maximumFractionDigits=o),p===""&&(z.useGrouping=!1);let j=p||u,q=j?"en":(this==null?void 0:this.locale)||I.locale||Nn,K=JSON.stringify(z)+q;return x=(Ls[K]??(Ls[K]=new Intl.NumberFormat(q,z))).format(R),j&&(x=x.replace(/([,\.])/g,"_$1").replace(/_\,/g,p??",").replace("_.",u??".")),(o||+x!=0)&&(!(A<0)||N)||(x="0"),A&&+x!=0&&(x+="e"+(A<0?"":"+")+A),x}let fs={dateFormat:function(R,o,u){return $o.dateFormat(R,o,u)},format:Ji,helpers:Ki,numberFormat:Ds};(function(R){let o;R.rendererTypes={},R.getRendererType=function(u=o){return R.rendererTypes[u]||R.rendererTypes[o]},R.registerRendererType=function(u,p,x){R.rendererTypes[u]=p,(!o||x)&&(o=u,ke.Renderer=p)}})(C||(C={}));let vo=C,{clamp:Js,pick:on,pushUnique:jf,stableSort:bo}=xe;(P||(P={})).distribute=function R(o,u,p){let x=o,v=x.reducedLen||u,S=(fe,Xe)=>fe.target-Xe.target,A=[],I=o.length,O=[],N=A.push,z,j,q,K=!0,se,re,te=0,ce;for(z=I;z--;)te+=o[z].size;if(te>v){for(bo(o,(fe,Xe)=>(Xe.rank||0)-(fe.rank||0)),q=(ce=o[0].rank===o[o.length-1].rank)?I/2:-1,j=ce?q:I-1;q&&te>v;)se=o[z=Math.floor(j)],jf(O,z)&&(te-=se.size),j+=q,ce&&j>=o.length&&(q/=2,j=q);O.sort((fe,Xe)=>Xe-fe).forEach(fe=>N.apply(A,o.splice(fe,1)))}for(bo(o,S),o=o.map(fe=>({size:fe.size,targets:[fe.target],align:on(fe.align,.5)}));K;){for(z=o.length;z--;)se=o[z],re=(Math.min.apply(0,se.targets)+Math.max.apply(0,se.targets))/2,se.pos=Js(re-se.size*se.align,0,u-se.size);for(z=o.length,K=!1;z--;)z>0&&o[z-1].pos+o[z-1].size>o[z].pos&&(o[z-1].size+=o[z].size,o[z-1].targets=o[z-1].targets.concat(o[z].targets),o[z-1].align=.5,o[z-1].pos+o[z-1].size>u&&(o[z-1].pos=u-o[z-1].size),o.splice(z,1),K=!0)}return N.apply(x,A),z=0,o.some(fe=>{let Xe=0;return(fe.targets||[]).some(()=>(x[z].pos=fe.pos+Xe,p!==void 0&&Math.abs(x[z].pos-x[z].target)>p?(x.slice(0,z+1).forEach(Ne=>delete Ne.pos),x.reducedLen=(x.reducedLen||u)-.1*u,x.reducedLen>.1*u&&R(x,u,p),!0):(Xe+=x[z].size,z++,!1)))}),bo(x,S),x};let Ua=P,{animate:Nc,animObject:nd,stop:sd}=Cn,{deg2rad:Hl,doc:Wo,svg:Fh,SVG_NS:pa,win:Os,isFirefox:An}=ke,{addEvent:od,attr:Uc,createElement:Rs,crisp:Es,css:ad,defined:zs,erase:vn,extend:ma,fireEvent:Vc,getAlignFactor:ga,isArray:ts,isFunction:Nh,isNumber:ld,isObject:_a,isString:ya,merge:ql,objectEach:Xl,pick:wo,pInt:xa,pushUnique:Ho,replaceNested:cd,syncTimeout:ll,uniqueKey:qo}=xe;class bn{_defaultGetter(o){let u=wo(this[o+"Value"],this[o],this.element?this.element.getAttribute(o):null,0);return/^-?[\d\.]+$/.test(u)&&(u=parseFloat(u)),u}_defaultSetter(o,u,p){p.setAttribute(u,o)}add(o){let u,p=this.renderer,x=this.element;return o&&(this.parentGroup=o),this.textStr!==void 0&&this.element.nodeName==="text"&&p.buildText(this),this.added=!0,(!o||o.handleZ||this.zIndex)&&(u=this.zIndexSetter()),u||(o?o.element:p.box).appendChild(x),this.onAdd&&this.onAdd(),this}addClass(o,u){let p=u?"":this.attr("class")||"";return(o=(o||"").split(/ /g).reduce(function(x,v){return p.indexOf(v)===-1&&x.push(v),x},p?[p]:[]).join(" "))!==p&&this.attr("class",o),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(o,u,p,x=!0){let v=this.renderer,S=v.alignedObjects,A=!!o;o?(this.alignOptions=o,this.alignByTranslate=u,this.alignTo=p):(o=this.alignOptions||{},u=this.alignByTranslate,p=this.alignTo);let I=!p||ya(p)?p||"renderer":void 0;I&&(A&&Ho(S,this),p=void 0);let O=wo(p,v[I],v),N=(O.x||0)+(o.x||0)+((O.width||0)-(o.width||0))*ga(o.align),z=(O.y||0)+(o.y||0)+((O.height||0)-(o.height||0))*ga(o.verticalAlign),j={"text-align":o==null?void 0:o.align};return j[u?"translateX":"x"]=Math.round(N),j[u?"translateY":"y"]=Math.round(z),x&&(this[this.placed?"animate":"attr"](j),this.placed=!0),this.alignAttr=j,this}alignSetter(o){let u={left:"start",center:"middle",right:"end"};u[o]&&(this.alignValue=o,this.element.setAttribute("text-anchor",u[o]))}animate(o,u,p){let x=nd(wo(u,this.renderer.globalAnimation,!0)),v=x.defer;return Wo.hidden&&(x.duration=0),x.duration!==0?(p&&(x.complete=p),ll(()=>{this.element&&Nc(this,o,x)},v)):(this.attr(o,void 0,p||x.complete),Xl(o,function(S,A){x.step&&x.step.call(this,S,{prop:A,pos:1,elem:this})},this)),this}applyTextOutline(o){let u=this.element;o.indexOf("contrast")!==-1&&(o=o.replace(/contrast/g,this.renderer.getContrast(u.style.fill)));let p=o.indexOf(" "),x=o.substring(p+1),v=o.substring(0,p);if(v&&v!=="none"&&ke.svg){this.fakeTS=!0,v=v.replace(/(^[\d\.]+)(.*?)$/g,function(N,z,j){return 2*Number(z)+j}),this.removeTextOutline();let S=Wo.createElementNS(pa,"tspan");Uc(S,{class:"highcharts-text-outline",fill:x,stroke:x,"stroke-width":v,"stroke-linejoin":"round"});let A=u.querySelector("textPath")||u;[].forEach.call(A.childNodes,N=>{let z=N.cloneNode(!0);z.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(j=>z.removeAttribute(j)),S.appendChild(z)});let I=0;[].forEach.call(A.querySelectorAll("text tspan"),N=>{I+=Number(N.getAttribute("dy"))});let O=Wo.createElementNS(pa,"tspan");O.textContent="",Uc(O,{x:Number(u.getAttribute("x")),dy:-I}),S.appendChild(O),A.insertBefore(S,A.firstChild)}}attr(o,u,p,x){let{element:v}=this,S=bn.symbolCustomAttribs,A,I,O=this,N;return typeof o=="string"&&u!==void 0&&(A=o,(o={})[A]=u),typeof o=="string"?O=(this[o+"Getter"]||this._defaultGetter).call(this,o,v):(Xl(o,function(z,j){N=!1,x||sd(this,j),this.symbolName&&S.indexOf(j)!==-1&&(I||(this.symbolAttr(o),I=!0),N=!0),this.rotation&&(j==="x"||j==="y")&&(this.doTransform=!0),N||(this[j+"Setter"]||this._defaultSetter).call(this,z,j,v)},this),this.afterSetters()),p&&p.call(this),O}clip(o){if(o&&!o.clipPath){let u=qo()+"-",p=this.renderer.createElement("clipPath").attr({id:u}).add(this.renderer.defs);ma(o,{clipPath:p,id:u,count:0}),o.add(p)}return this.attr("clip-path",o?`url(${this.renderer.url}#${o.id})`:"none")}crisp(o,u){u=Math.round(u||o.strokeWidth||0);let p=o.x||this.x||0,x=o.y||this.y||0,v=(o.width||this.width||0)+p,S=(o.height||this.height||0)+x,A=Es(p,u),I=Es(x,u);return ma(o,{x:A,y:I,width:Es(v,u)-A,height:Es(S,u)-I}),zs(o.strokeWidth)&&(o.strokeWidth=u),o}complexColor(o,u,p){let x=this.renderer,v,S,A,I,O,N,z,j,q,K,se=[],re;Vc(this.renderer,"complexColor",{args:arguments},function(){if(o.radialGradient?S="radialGradient":o.linearGradient&&(S="linearGradient"),S){if(A=o[S],O=x.gradients,N=o.stops,q=p.radialReference,ts(A)&&(o[S]=A={x1:A[0],y1:A[1],x2:A[2],y2:A[3],gradientUnits:"userSpaceOnUse"}),S==="radialGradient"&&q&&!zs(A.gradientUnits)&&(I=A,A=ql(A,x.getRadialAttr(q,I),{gradientUnits:"userSpaceOnUse"})),Xl(A,function(te,ce){ce!=="id"&&se.push(ce,te)}),Xl(N,function(te){se.push(te)}),O[se=se.join(",")])K=O[se].attr("id");else{A.id=K=qo();let te=O[se]=x.createElement(S).attr(A).add(x.defs);te.radAttr=I,te.stops=[],N.forEach(function(ce){ce[1].indexOf("rgba")===0?(z=(v=st.parse(ce[1])).get("rgb"),j=v.get("a")):(z=ce[1],j=1);let fe=x.createElement("stop").attr({offset:ce[0],"stop-color":z,"stop-opacity":j}).add(te);te.stops.push(fe)})}re="url("+x.url+"#"+K+")",p.setAttribute(u,re),p.gradient=se,o.toString=function(){return re}}})}css(o){let u=this.styles,p={},x=this.element,v,S=!u;if(u&&Xl(o,function(A,I){u&&u[I]!==A&&(p[I]=A,S=!0)}),S){u&&(o=ma(u,p)),o.width===null||o.width==="auto"?delete this.textWidth:x.nodeName.toLowerCase()==="text"&&o.width&&(v=this.textWidth=xa(o.width)),ma(this.styles,o),v&&!Fh&&this.renderer.forExport&&delete o.width;let A=An&&o.fontSize||null;A&&(ld(A)||/^\d+$/.test(A))&&(o.fontSize+="px");let I=ql(o);x.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","whiteSpace","width"].forEach(O=>I&&delete I[O]),I.color&&(I.fill=I.color,delete I.color)),ad(x,I)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),o.textOutline&&this.applyTextOutline(o.textOutline)),this}dashstyleSetter(o){let u,p=this["stroke-width"];if(p==="inherit"&&(p=1),o){let x=(o=o.toLowerCase()).replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(u=x.length;u--;)x[u]=""+xa(x[u])*wo(p,NaN);o=x.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",o)}}destroy(){let o=this,u=o.element||{},p=o.renderer,x=u.ownerSVGElement,v=u.nodeName==="SPAN"&&o.parentGroup||void 0,S,A;if(u.onclick=u.onmouseout=u.onmouseover=u.onmousemove=u.point=null,sd(o),o.clipPath&&x){let I=o.clipPath;[].forEach.call(x.querySelectorAll("[clip-path],[CLIP-PATH]"),function(O){O.getAttribute("clip-path").indexOf(I.element.id)>-1&&O.removeAttribute("clip-path")}),o.clipPath=I.destroy()}if(o.stops){for(A=0;A<o.stops.length;A++)o.stops[A].destroy();o.stops.length=0,o.stops=void 0}for(o.safeRemoveChild(u);v!=null&&v.div&&v.div.childNodes.length===0;)S=v.parentGroup,o.safeRemoveChild(v.div),delete v.div,v=S;o.alignOptions&&vn(p.alignedObjects,o),Xl(o,(I,O)=>{var N,z,j;(((N=o[O])==null?void 0:N.parentGroup)===o||["connector","foreignObject"].indexOf(O)!==-1)&&((j=(z=o[O])==null?void 0:z.destroy)==null||j.call(z)),delete o[O]})}dSetter(o,u,p){ts(o)&&(typeof o[0]=="string"&&(o=this.renderer.pathToSegments(o)),this.pathArray=o,o=o.reduce((x,v,S)=>v!=null&&v.join?(S?x+" ":"")+v.join(" "):(v||"").toString(),"")),/(NaN| {2}|^$)/.test(o)&&(o="M 0 0"),this[u]!==o&&(p.setAttribute(u,o),this[u]=o)}fillSetter(o,u,p){typeof o=="string"?p.setAttribute(u,o):o&&this.complexColor(o,u,p)}hrefSetter(o,u,p){p.setAttributeNS("http://www.w3.org/1999/xlink",u,o)}getBBox(o,u){let p,x,v,S,{alignValue:A,element:I,renderer:O,styles:N,textStr:z}=this,{cache:j,cacheKeys:q}=O,K=I.namespaceURI===this.SVG_NS,se=wo(u,this.rotation,0),re=O.styledMode?I&&bn.prototype.getStyle.call(I,"font-size"):N.fontSize;if(zs(z)&&((S=z.toString()).indexOf("<")===-1&&(S=S.replace(/\d/g,"0")),S+=["",O.rootFontSize,re,se,this.textWidth,A,N.lineClamp,N.textOverflow,N.fontWeight].join(",")),S&&!o&&(p=j[S]),!p||p.polygon){if(K||O.forExport){try{v=this.fakeTS&&function(ce){let fe=I.querySelector(".highcharts-text-outline");fe&&ad(fe,{display:ce})},Nh(v)&&v("none"),p=I.getBBox?ma({},I.getBBox()):{width:I.offsetWidth,height:I.offsetHeight,x:0,y:0},Nh(v)&&v("")}catch{}(!p||p.width<0)&&(p={x:0,y:0,width:0,height:0})}else p=this.htmlGetBBox();x=p.height,K&&(p.height=x={"11px,17":14,"13px,20":16}[`${re||""},${Math.round(x)}`]||x),se&&(p=this.getRotatedBox(p,se));let te={bBox:p};Vc(this,"afterGetBBox",te),p=te.bBox}if(S&&(z===""||p.height>0)){for(;q.length>250;)delete j[q.shift()];j[S]||q.push(S),j[S]=p}return p}getRotatedBox(o,u){let{x:p,y:x,width:v,height:S}=o,{alignValue:A,translateY:I,rotationOriginX:O=0,rotationOriginY:N=0}=this,z=ga(A),j=Number(this.element.getAttribute("y")||0)-(I?0:x),q=u*Hl,K=(u-90)*Hl,se=Math.cos(q),re=Math.sin(q),te=v*se,ce=v*re,fe=Math.cos(K),Xe=Math.sin(K),[[Ne,$e],[mt,tt]]=[O,N].map(br=>[br-br*se,br*re]),gt=p+z*(v-te)+Ne+tt+j*fe,Bt=gt+te,Jt=Bt-S*fe,ii=Jt-te,Ft=x+j-z*ce-$e+mt+j*Xe,ui=Ft+ce,gi=ui-S*Xe,Ui=gi-ce,wi=Math.min(gt,Bt,Jt,ii),ji=Math.min(Ft,ui,gi,Ui),_r=Math.max(gt,Bt,Jt,ii)-wi,lr=Math.max(Ft,ui,gi,Ui)-ji;return{x:wi,y:ji,width:_r,height:lr,polygon:[[gt,Ft],[Bt,ui],[Jt,gi],[ii,Ui]]}}getStyle(o){return Os.getComputedStyle(this.element||this,"").getPropertyValue(o)}hasClass(o){return(""+this.attr("class")).split(" ").indexOf(o)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(o,u){this.onEvents={},this.opacity=1,this.SVG_NS=pa,this.element=u==="span"||u==="body"?Rs(u):Wo.createElementNS(this.SVG_NS,u),this.renderer=o,this.styles={},Vc(this,"afterInit")}on(o,u){let{onEvents:p}=this;return p[o]&&p[o](),p[o]=od(this.element,o,u),this}opacitySetter(o,u,p){let x=Number(Number(o).toFixed(3));this.opacity=x,p.setAttribute(u,x)}reAlign(){var o;(o=this.alignOptions)!=null&&o.width&&this.alignOptions.align!=="left"&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(o){return this.attr("class",(""+this.attr("class")).replace(ya(o)?RegExp(`(^| )${o}( |$)`):o," ").replace(/ +/g," ").trim())}removeTextOutline(){let o=this.element.querySelector("tspan.highcharts-text-outline");o&&this.safeRemoveChild(o)}safeRemoveChild(o){let u=o.parentNode;u&&u.removeChild(o)}setRadialReference(o){let u=this.element.gradient&&this.renderer.gradients[this.element.gradient]||void 0;return this.element.radialReference=o,u!=null&&u.radAttr&&u.animate(this.renderer.getRadialAttr(o,u.radAttr)),this}shadow(o){var v;let{renderer:u}=this,p=ql(((v=this.parentGroup)==null?void 0:v.rotation)===90?{offsetX:-1,offsetY:-1}:{},_a(o)?o:{}),x=u.shadowDefinition(p);return this.attr({filter:o?`url(${u.url}#${x})`:"none"})}show(o=!0){return this.attr({visibility:o?"inherit":"visible"})}"stroke-widthSetter"(o,u,p){this[u]=o,p.setAttribute(u,o)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let o=this.getStyle("stroke-width"),u=0,p;return/px$/.test(o)?u=xa(o):o!==""&&(Uc(p=Wo.createElementNS(pa,"rect"),{width:o,"stroke-width":0}),this.element.parentNode.appendChild(p),u=p.getBBox().width,p.parentNode.removeChild(p)),u}symbolAttr(o){let u=this;bn.symbolCustomAttribs.forEach(function(p){u[p]=wo(o[p],u[p])}),u.attr({d:u.renderer.symbols[u.symbolName](u.x,u.y,u.width,u.height,u)})}textSetter(o){o!==this.textStr&&(delete this.textPxLength,this.textStr=o,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(o){let u=this.element,p=u.getElementsByTagName("title")[0]||Wo.createElementNS(this.SVG_NS,"title");u.insertBefore?u.insertBefore(p,u.firstChild):u.appendChild(p),p.textContent=cd(wo(o,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let o=this.element;return o.parentNode.appendChild(o),this}translate(o,u){return this.attr({translateX:o,translateY:u})}updateTransform(o="transform"){let{element:u,foreignObject:p,matrix:x,padding:v,rotation:S=0,rotationOriginX:A,rotationOriginY:I,scaleX:O,scaleY:N,text:z,translateX:j=0,translateY:q=0}=this,K=["translate("+j+","+q+")"];zs(x)&&K.push("matrix("+x.join(",")+")"),S&&(K.push("rotate("+S+" "+(A??u.getAttribute("x")??this.x??0)+" "+(I??u.getAttribute("y")??this.y??0)+")"),(z==null?void 0:z.element.tagName)!=="SPAN"||z!=null&&z.foreignObject||z.attr({rotation:S,rotationOriginX:(A||0)-v,rotationOriginY:(I||0)-v})),(zs(O)||zs(N))&&K.push("scale("+wo(O,1)+" "+wo(N,1)+")"),K.length&&!(z||this).textPath&&((p==null?void 0:p.element)||u).setAttribute(o,K.join(" "))}visibilitySetter(o,u,p){o==="inherit"?p.removeAttribute(u):this[u]!==o&&p.setAttribute(u,o),this[u]=o}xGetter(o){return this.element.nodeName==="circle"&&(o==="x"?o="cx":o==="y"&&(o="cy")),this._defaultGetter(o)}zIndexSetter(o,u){let p=this.renderer,x=this.parentGroup,v=(x||p).element||p.box,S=this.element,A=v===p.box,I,O,N,z=!1,j,q=this.added,K;if(zs(o)?(S.setAttribute("data-z-index",o),o*=1,this[u]===o&&(q=!1)):zs(this[u])&&S.removeAttribute("data-z-index"),this[u]=o,q){for((o=this.zIndex)&&x&&(x.handleZ=!0),K=(I=v.childNodes).length-1;K>=0&&!z;K--)j=!zs(N=(O=I[K]).getAttribute("data-z-index")),O!==S&&(o<0&&j&&!A&&!K?(v.insertBefore(S,I[K]),z=!0):(xa(N)<=o||j&&(!zs(o)||o>=0))&&(v.insertBefore(S,I[K+1]),z=!0));z||(v.insertBefore(S,I[3*!!A]),z=!0)}return z}}bn.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],bn.prototype.strokeSetter=bn.prototype.fillSetter,bn.prototype.yGetter=bn.prototype.xGetter,bn.prototype.matrixSetter=bn.prototype.rotationOriginXSetter=bn.prototype.rotationOriginYSetter=bn.prototype.rotationSetter=bn.prototype.scaleXSetter=bn.prototype.scaleYSetter=bn.prototype.translateXSetter=bn.prototype.translateYSetter=bn.prototype.verticalAlignSetter=function(R,o){this[o]=R,this.doTransform=!0};let is=bn,{defined:jc,extend:Zl,getAlignFactor:Yl,isNumber:Kl,merge:Uh,pick:Jl,removeEvent:Vh}=xe;class Qs extends is{constructor(o,u,p,x,v,S,A,I,O,N){let z;super(o,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=u,this.x=p,this.y=x,this.anchorX=S,this.anchorY=A,this.baseline=O,this.className=N,this.addClass(N==="button"?"highcharts-no-tooltip":"highcharts-label"),N&&this.addClass("highcharts-"+N),this.text=o.text(void 0,0,0,I).attr({zIndex:1}),typeof v=="string"&&((z=/^url\((.*?)\)$/.test(v))||this.renderer.symbols[v])&&(this.symbolKey=v),this.bBox=Qs.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=o.styledMode||z,this.deferredAttr={},this.alignFactor=0}alignSetter(o){let u=Yl(o);this.textAlign=o,u!==this.alignFactor&&(this.alignFactor=u,this.bBox&&Kl(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(o,u){this.anchorX=o,this.boxAttr(u,Math.round(o)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(o,u){this.anchorY=o,this.boxAttr(u,o-this.ySetting)}boxAttr(o,u){this.box?this.box.attr(o,u):this.deferredAttr[o]=u}css(o){if(o){let u={};o=Uh(o),Qs.textProps.forEach(p=>{o[p]!==void 0&&(u[p]=o[p],delete o[p])}),this.text.css(u),"fontSize"in u||"fontWeight"in u?this.updateTextPadding():("width"in u||"textOverflow"in u)&&this.updateBoxSize()}return is.prototype.css.call(this,o)}destroy(){Vh(this.element,"mouseenter"),Vh(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),is.prototype.destroy.call(this)}fillSetter(o,u){o&&(this.needsBox=!0),this.fill=o,this.boxAttr(u,o)}getBBox(o,u){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let{padding:p,height:x=0,translateX:v=0,translateY:S=0,width:A=0}=this,I=Jl(this.paddingLeft,p),O=u??(this.rotation||0),N={width:A,height:x,x:v+this.bBox.x-I,y:S+this.bBox.y-p+this.baselineOffset};return O&&(N=this.getRotatedBox(N,O)),N}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(o){this.heightSetting=o,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:Jl(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&jc(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(o,u){Kl(o)?o!==this[u]&&(this[u]=o,this.updateTextPadding()):this[u]=void 0}rSetter(o,u){this.boxAttr(u,o)}strokeSetter(o,u){this.stroke=o,this.boxAttr(u,o)}"stroke-widthSetter"(o,u){o&&(this.needsBox=!0),this["stroke-width"]=o,this.boxAttr(u,o)}"text-alignSetter"(o){this.textAlign=this["text-align"]=o,this.updateTextPadding()}textSetter(o){o!==void 0&&this.text.attr({text:o}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let o,u=this.text,p={},x=this.padding,v=this.bBox=(!Kl(this.widthSetting)||!Kl(this.heightSetting)||this.textAlign)&&jc(u.textStr)?u.getBBox(void 0,0):Qs.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||v.height||0)+2*x;let S=this.renderer.fontMetrics(u);if(this.baselineOffset=x+Math.min((this.text.firstLineMetrics||S).b,v.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-S.h)/2),this.needsBox&&!u.textPath){if(!this.box){let A=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();A.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),A.add(this)}p.x=o=this.getCrispAdjust(),p.y=(this.baseline?-this.baselineOffset:0)+o,p.width=Math.round(this.width),p.height=Math.round(this.height),this.box.attr(Zl(p,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let o=this.text,u=o.styles.textAlign||this.textAlign;if(!o.textPath){this.updateBoxSize();let p=this.baseline?0:this.baselineOffset,x=(this.paddingLeft??this.padding)+Yl(u)*(this.widthSetting??this.bBox.width);(x!==o.x||p!==o.y)&&(o.attr({align:u,x}),p!==void 0&&o.attr("y",p)),o.x=x,o.y=p}}widthSetter(o){this.widthSetting=Kl(o)?o:void 0,this.doUpdate=!0}getPaddedWidth(){let o=this.padding,u=Jl(this.paddingLeft,o),p=Jl(this.paddingRight,o);return(this.widthSetting||this.bBox.width||0)+u+p}xSetter(o){this.x=o,this.alignFactor&&(o-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(o),this.attr("translateX",this.xSetting)}ySetter(o){this.ySetting=this.y=Math.round(o),this.attr("translateY",this.ySetting)}}Qs.emptyBBox={width:0,height:0,x:0,y:0},Qs.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineClamp","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"];let{defined:wr,isNumber:wm,pick:cl}=xe;function hd(R,o,u,p,x){let v=[];if(x){let S=x.start||0,A=x.end||0,I=cl(x.r,u),O=cl(x.r,p||u),N=2e-4/(x.borderRadius?1:Math.max(I,1)),z=Math.abs(A-S-2*Math.PI)<N;z&&(S=Math.PI/2,A=2.5*Math.PI-N);let j=x.innerR,q=cl(x.open,z),K=Math.cos(S),se=Math.sin(S),re=Math.cos(A),te=Math.sin(A),ce=cl(x.longArc,A-S-Math.PI<N?0:1),fe=["A",I,O,0,ce,cl(x.clockwise,1),R+I*re,o+O*te];fe.params={start:S,end:A,cx:R,cy:o},v.push(["M",R+I*K,o+O*se],fe),wr(j)&&((fe=["A",j,j,0,ce,wr(x.clockwise)?1-x.clockwise:0,R+j*K,o+j*se]).params={start:A,end:S,cx:R,cy:o},v.push(q?["M",R+j*re,o+j*te]:["L",R+j*re,o+j*te],fe)),q||v.push(["Z"])}return v}function jh(R,o,u,p,x){return x!=null&&x.r?$h(R,o,u,p,x):[["M",R,o],["L",R+u,o],["L",R+u,o+p],["L",R,o+p],["Z"]]}function $h(R,o,u,p,x){let v=(x==null?void 0:x.r)||0;return[["M",R+v,o],["L",R+u-v,o],["A",v,v,0,0,1,R+u,o+v],["L",R+u,o+p-v],["A",v,v,0,0,1,R+u-v,o+p],["L",R+v,o+p],["A",v,v,0,0,1,R,o+p-v],["L",R,o+v],["A",v,v,0,0,1,R+v,o],["Z"]]}let Gh={arc:hd,callout:function(R,o,u,p,x){let v=Math.min((x==null?void 0:x.r)||0,u,p),S=v+6,A=x==null?void 0:x.anchorX,I=(x==null?void 0:x.anchorY)||0,O=$h(R,o,u,p,{r:v});if(!wm(A)||A<u&&A>0&&I<p&&I>0)return O;if(R+A>u-S)if(I>o+S&&I<o+p-S)O.splice(3,1,["L",R+u,I-6],["L",R+u+6,I],["L",R+u,I+6],["L",R+u,o+p-v]);else if(A<u){let N=I<o+S,z=N?o:o+p;O.splice(N?2:5,0,["L",A,I],["L",R+u-v,z])}else O.splice(3,1,["L",R+u,p/2],["L",A,I],["L",R+u,p/2],["L",R+u,o+p-v]);else if(R+A<S)if(I>o+S&&I<o+p-S)O.splice(7,1,["L",R,I+6],["L",R-6,I],["L",R,I-6],["L",R,o+v]);else if(A>0){let N=I<o+S,z=N?o:o+p;O.splice(N?1:6,0,["L",A,I],["L",R+v,z])}else O.splice(7,1,["L",R,p/2],["L",A,I],["L",R,p/2],["L",R,o+v]);else I>p&&A<u-S?O.splice(5,1,["L",A+6,o+p],["L",A,o+p+6],["L",A-6,o+p],["L",R+v,o+p]):I<0&&A>S&&O.splice(1,1,["L",A-6,o],["L",A,o-6],["L",A+6,o],["L",u-v,o]);return O},circle:function(R,o,u,p){return hd(R+u/2,o+p/2,u/2,p/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(R,o,u,p){return[["M",R+u/2,o],["L",R+u,o+p/2],["L",R+u/2,o+p],["L",R,o+p/2],["Z"]]},rect:jh,roundedRect:$h,square:jh,triangle:function(R,o,u,p){return[["M",R+u/2,o],["L",R+u,o+p],["L",R,o+p],["Z"]]},"triangle-down":function(R,o,u,p){return[["M",R,o],["L",R+u,o],["L",R+u/2,o+p],["Z"]]}},{doc:Va,SVG_NS:Wh,win:hl}=ke,{attr:To,extend:ul,fireEvent:Hh,isString:$f,objectEach:$c,pick:ud}=xe,Gc=(R,o)=>R.substring(0,o)+"",qh=class{constructor(R){let o=R.styles;this.renderer=R.renderer,this.svgElement=R,this.width=R.textWidth,this.textLineHeight=o==null?void 0:o.lineHeight,this.textOutline=o==null?void 0:o.textOutline,this.ellipsis=(o==null?void 0:o.textOverflow)==="ellipsis",this.lineClamp=o==null?void 0:o.lineClamp,this.noWrap=(o==null?void 0:o.whiteSpace)==="nowrap"}buildSVG(){let R=this.svgElement,o=R.element,u=R.renderer,p=ud(R.textStr,"").toString(),x=p.indexOf("<")!==-1,v=o.childNodes,S=!R.added&&u.box,A=[p,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,R.getStyle("font-size"),R.styles.lineClamp,this.width].join(",");if(A!==R.textCache){R.textCache=A,delete R.actualWidth;for(let I=v.length;I--;)o.removeChild(v[I]);if(x||this.ellipsis||this.width||R.textPath||p.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(p))){if(p!==""){S&&S.appendChild(o);let I=new jr(p);this.modifyTree(I.nodes),I.addToDOM(o),this.modifyDOM(),this.ellipsis&&(o.textContent||"").indexOf("")!==-1&&R.attr("title",this.unescapeEntities(R.textStr||"",["&lt;","&gt;"])),S&&S.removeChild(o)}}else o.appendChild(Va.createTextNode(this.unescapeEntities(p)));$f(this.textOutline)&&R.applyTextOutline&&R.applyTextOutline(this.textOutline)}}modifyDOM(){let R,o=this.svgElement,u=To(o.element,"x");for(o.firstLineMetrics=void 0;(R=o.element.firstChild)&&/^[\s\u200B]*$/.test(R.textContent||" ");)o.element.removeChild(R);[].forEach.call(o.element.querySelectorAll("tspan.highcharts-br"),(S,A)=>{S.nextSibling&&S.previousSibling&&(A===0&&S.previousSibling.nodeType===1&&(o.firstLineMetrics=o.renderer.fontMetrics(S.previousSibling)),To(S,{dy:this.getLineHeight(S.nextSibling),x:u}))});let p=this.width||0;if(!p)return;let x=(S,A)=>{var se;let I=S.textContent||"",O=I.replace(/([^\^])-/g,"$1- ").split(" "),N=!this.noWrap&&(O.length>1||o.element.childNodes.length>1),z=this.getLineHeight(A),j=Math.max(0,p-.8*z),q=0,K=o.actualWidth;if(N){let re=[],te=[];for(;A.firstChild&&A.firstChild!==S;)te.push(A.firstChild),A.removeChild(A.firstChild);for(;O.length;)if(O.length&&!this.noWrap&&q>0&&(re.push(S.textContent||""),S.textContent=O.join(" ").replace(/- /g,"-")),this.truncate(S,void 0,O,q===0&&K||0,p,j,(ce,fe)=>O.slice(0,fe).join(" ").replace(/- /g,"-")),K=o.actualWidth,q++,this.lineClamp&&q>=this.lineClamp){O.length&&(this.truncate(S,S.textContent||"",void 0,0,p,j,Gc),S.textContent=((se=S.textContent)==null?void 0:se.replace("",""))+"");break}te.forEach(ce=>{A.insertBefore(ce,S)}),re.forEach(ce=>{A.insertBefore(Va.createTextNode(ce),S);let fe=Va.createElementNS(Wh,"tspan");fe.textContent="",To(fe,{dy:z,x:u}),A.insertBefore(fe,S)})}else this.ellipsis&&I&&this.truncate(S,I,void 0,0,p,j,Gc)},v=S=>{[].slice.call(S.childNodes).forEach(A=>{A.nodeType===hl.Node.TEXT_NODE?x(A,S):(A.className.baseVal.indexOf("highcharts-br")!==-1&&(o.actualWidth=0),v(A))})};v(o.element)}getLineHeight(R){let o=R.nodeType===hl.Node.TEXT_NODE?R.parentElement:R;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(o||this.svgElement.element).h}modifyTree(R){let o=(u,p)=>{let{attributes:x={},children:v,style:S={},tagName:A}=u,I=this.renderer.styledMode;if(A==="b"||A==="strong"?I?x.class="highcharts-strong":S.fontWeight="bold":(A==="i"||A==="em")&&(I?x.class="highcharts-emphasized":S.fontStyle="italic"),S!=null&&S.color&&(S.fill=S.color),A==="br"){x.class="highcharts-br",u.textContent="";let O=R[p+1];O!=null&&O.textContent&&(O.textContent=O.textContent.replace(/^ +/gm,""))}else A==="a"&&v&&v.some(O=>O.tagName==="#text")&&(u.children=[{children:v,tagName:"tspan"}]);A!=="#text"&&A!=="a"&&(u.tagName="tspan"),ul(u,{attributes:x,style:S}),v&&v.filter(O=>O.tagName!=="#text").forEach(o)};R.forEach(o),Hh(this.svgElement,"afterModifyTree",{nodes:R})}truncate(R,o,u,p,x,v,S){let A,I,O=this.svgElement,{rotation:N}=O,z=[],j=u&&!p?1:0,q=(o||u||"").length,K=q;u||(x=v);let se=function(re,te){let ce=te||re,fe=R.parentNode;if(fe&&z[ce]===void 0&&fe.getSubStringLength)try{z[ce]=p+fe.getSubStringLength(0,u?ce+1:ce)}catch{}return z[ce]};if(O.rotation=0,p+(I=se(R.textContent.length))>x){for(;j<=q;)K=Math.ceil((j+q)/2),u&&(A=S(u,K)),I=se(K,A&&A.length-1),j===q?j=q+1:I>x?q=K-1:j=K;q===0?R.textContent="":o&&q===o.length-1||(R.textContent=A||S(o||u,K)),this.ellipsis&&I>x&&this.truncate(R,R.textContent||"",void 0,0,x,v,Gc)}u&&u.splice(0,K),O.actualWidth=I,O.rotation=N}unescapeEntities(R,o){return $c(this.renderer.escapes,function(u,p){o&&o.indexOf(u)!==-1||(R=R.toString().replace(RegExp(u,"g"),p))}),R}},{defaultOptions:Xh}=Le,{charts:dd,deg2rad:mr,doc:Xo,isFirefox:fd,isMS:Zh,isWebKit:Gf,noop:dl,SVG_NS:pd,symbolSizes:md,win:gd}=ke,{addEvent:Yh,attr:Ql,createElement:_d,crisp:Kh,css:fl,defined:ja,destroyObjectProperties:Wf,extend:pl,isArray:Wc,isNumber:Eo,isObject:ml,isString:Hc,merge:qc,pick:eo,pInt:Jh,replaceNested:yd,uniqueKey:Qh}=xe;class Xc{constructor(o,u,p,x,v,S,A){let I,O;this.x=0,this.y=0;let N=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),z=N.element;A||N.css(this.getStyle(x||{})),o.appendChild(z),Ql(o,"dir","ltr"),o.innerHTML.indexOf("xmlns")===-1&&Ql(z,"xmlns",this.SVG_NS),this.box=z,this.boxWrapper=N,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(Xo.createTextNode("Created with Highcharts 12.2.0")),this.defs=this.createElement("defs").add(),this.allowHTML=S,this.forExport=v,this.styledMode=A,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=N.getStyle("font-size"),this.setSize(u,p,!1),fd&&o.getBoundingClientRect&&((I=function(){fl(o,{left:0,top:0}),O=o.getBoundingClientRect(),fl(o,{left:Math.ceil(O.left)-O.left+"px",top:Math.ceil(O.top)-O.top+"px"})})(),this.unSubPixelFix=Yh(gd,"resize",I))}definition(o){return new jr([o]).addToDOM(this.defs.element)}getReferenceURL(){if((fd||Gf)&&Xo.getElementsByTagName("base").length){if(!ja(_)){let o=Qh(),u=new jr([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:o},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${o})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(Xo.body);fl(u,{position:"fixed",top:0,left:0,zIndex:9e5});let p=Xo.elementFromPoint(6,6);_=(p==null?void 0:p.id)==="hitme",Xo.body.removeChild(u)}if(_)return yd(gd.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(o){return this.style=pl({fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif',fontSize:"1rem"},o),this.style}setStyle(o){this.boxWrapper.css(this.getStyle(o))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let o=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),Wf(this.gradients||{}),this.gradients=null,this.defs=o.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(o){return new this.Element(this,o)}getRadialAttr(o,u){return{cx:o[0]-o[2]/2+(u.cx||0)*o[2],cy:o[1]-o[2]/2+(u.cy||0)*o[2],r:(u.r||0)*o[2]}}shadowDefinition(o){let u=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(o).map(x=>`${x}-${o[x]}`)].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),p=qc({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},o);return this.defs.element.querySelector(`#${u}`)||this.definition({tagName:"filter",attributes:{id:u,filterUnits:p.filterUnits},children:this.getShadowFilterContent(p)}),u}getShadowFilterContent(o){return[{tagName:"feDropShadow",attributes:{dx:o.offsetX,dy:o.offsetY,"flood-color":o.color,"flood-opacity":Math.min(5*o.opacity,1),stdDeviation:o.width/2}}]}buildText(o){new qh(o).buildSVG()}getContrast(o){let u=st.parse(o).rgba,p=" clamp(0,calc(9e9*(0.5 - (0.2126*r + 0.7152*g + 0.0722*b))),1)";if(Eo(u[0])||!st.useColorMix){let x=u.map(S=>{let A=S/255;return A<=.04?A/12.92:Math.pow((A+.055)/1.055,2.4)}),v=.2126*x[0]+.7152*x[1]+.0722*x[2];return 1.05/(v+.05)>(v+.05)/.05?"#FFFFFF":"#000000"}return"color(from "+o+" srgb"+p+p+p+")"}button(o,u,p,x,v={},S,A,I,O,N){let z=this.label(o,u,p,O,void 0,void 0,N,void 0,"button"),j=this.styledMode,q=arguments,K=0;v=qc(Xh.global.buttonTheme,v),j&&(delete v.fill,delete v.stroke,delete v["stroke-width"]);let se=v.states||{},re=v.style||{};delete v.states,delete v.style;let te=[jr.filterUserAttributes(v)],ce=[re];return j||["hover","select","disabled"].forEach((fe,Xe)=>{te.push(qc(te[0],jr.filterUserAttributes(q[Xe+5]||se[fe]||{}))),ce.push(te[Xe+1].style),delete te[Xe+1].style}),Yh(z.element,Zh?"mouseover":"mouseenter",function(){K!==3&&z.setState(1)}),Yh(z.element,Zh?"mouseout":"mouseleave",function(){K!==3&&z.setState(K)}),z.setState=(fe=0)=>{if(fe!==1&&(z.state=K=fe),z.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][fe]),!j){z.attr(te[fe]);let Xe=ce[fe];ml(Xe)&&z.css(Xe)}},z.attr(te[0]),!j&&(z.css(pl({cursor:"default"},re)),N&&z.text.css({pointerEvents:"none"})),z.on("touchstart",fe=>fe.stopPropagation()).on("click",function(fe){K!==3&&(x==null||x.call(z,fe))})}crispLine(o,u){let[p,x]=o;return ja(p[1])&&p[1]===x[1]&&(p[1]=x[1]=Kh(p[1],u)),ja(p[2])&&p[2]===x[2]&&(p[2]=x[2]=Kh(p[2],u)),o}path(o){let u=this.styledMode?{}:{fill:"none"};return Wc(o)?u.d=o:ml(o)&&pl(u,o),this.createElement("path").attr(u)}circle(o,u,p){let x=ml(o)?o:o===void 0?{}:{x:o,y:u,r:p},v=this.createElement("circle");return v.xSetter=v.ySetter=function(S,A,I){I.setAttribute("c"+A,S)},v.attr(x)}arc(o,u,p,x,v,S){let A;ml(o)?(u=(A=o).y,p=A.r,x=A.innerR,v=A.start,S=A.end,o=A.x):A={innerR:x,start:v,end:S};let I=this.symbol("arc",o,u,p,p,A);return I.r=p,I}rect(o,u,p,x,v,S){let A=ml(o)?o:o===void 0?{}:{x:o,y:u,r:v,width:Math.max(p||0,0),height:Math.max(x||0,0)},I=this.createElement("rect");return this.styledMode||(S!==void 0&&(A["stroke-width"]=S,pl(A,I.crisp(A))),A.fill="none"),I.rSetter=function(O,N,z){I.r=O,Ql(z,{rx:O,ry:O})},I.rGetter=function(){return I.r||0},I.attr(A)}roundedRect(o){return this.symbol("roundedRect").attr(o)}setSize(o,u,p){this.width=o,this.height=u,this.boxWrapper.animate({width:o,height:u},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:eo(p,!0)?void 0:0}),this.alignElements()}g(o){let u=this.createElement("g");return o?u.attr({class:"highcharts-"+o}):u}image(o,u,p,x,v,S){let A={preserveAspectRatio:"none"};Eo(u)&&(A.x=u),Eo(p)&&(A.y=p),Eo(x)&&(A.width=x),Eo(v)&&(A.height=v);let I=this.createElement("image").attr(A),O=function(N){I.attr({href:o}),S.call(I,N)};if(S){I.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let N=new gd.Image;Yh(N,"load",O),N.src=o,N.complete&&O({})}else I.attr({href:o});return I}symbol(o,u,p,x,v,S){var re,te;let A,I,O,N,z=this,j=/^url\((.*?)\)$/,q=j.test(o),K=!q&&(this.symbols[o]?o:"circle"),se=K&&this.symbols[K];if(se)typeof u=="number"&&(I=se.call(this.symbols,u||0,p||0,x||0,v||0,S)),A=this.path(I),z.styledMode||A.attr("fill","none"),pl(A,{symbolName:K||void 0,x:u,y:p,width:x,height:v}),S&&pl(A,S);else if(q){O=o.match(j)[1];let ce=A=this.image(O);ce.imgwidth=eo(S==null?void 0:S.width,(re=md[O])==null?void 0:re.width),ce.imgheight=eo(S==null?void 0:S.height,(te=md[O])==null?void 0:te.height),N=fe=>fe.attr({width:fe.width,height:fe.height}),["width","height"].forEach(fe=>{ce[`${fe}Setter`]=function(Xe,Ne){this[Ne]=Xe;let{alignByTranslate:$e,element:mt,width:tt,height:gt,imgwidth:Bt,imgheight:Jt}=this,ii=Ne==="width"?Bt:Jt,Ft=1;S&&S.backgroundSize==="within"&&tt&&gt&&Bt&&Jt?(Ft=Math.min(tt/Bt,gt/Jt),Ql(mt,{width:Math.round(Bt*Ft),height:Math.round(Jt*Ft)})):mt&&ii&&mt.setAttribute(Ne,ii),!$e&&Bt&&Jt&&this.translate(((tt||0)-Bt*Ft)/2,((gt||0)-Jt*Ft)/2)}}),ja(u)&&ce.attr({x:u,y:p}),ce.isImg=!0,ce.symbolUrl=o,ja(ce.imgwidth)&&ja(ce.imgheight)?N(ce):(ce.attr({width:0,height:0}),_d("img",{onload:function(){let fe=dd[z.chartIndex];this.width===0&&(fl(this,{position:"absolute",top:"-999em"}),Xo.body.appendChild(this)),md[O]={width:this.width,height:this.height},ce.imgwidth=this.width,ce.imgheight=this.height,ce.element&&N(ce),this.parentNode&&this.parentNode.removeChild(this),z.imgCount--,z.imgCount||!fe||fe.hasLoaded||fe.onload()},src:O}),this.imgCount++)}return A}clipRect(o,u,p,x){return this.rect(o,u,p,x,0)}text(o,u,p,x){let v={};if(x&&(this.allowHTML||!this.forExport))return this.html(o,u,p);v.x=Math.round(u||0),p&&(v.y=Math.round(p)),ja(o)&&(v.text=o);let S=this.createElement("text").attr(v);return x&&(!this.forExport||this.allowHTML)||(S.xSetter=function(A,I,O){let N=O.getElementsByTagName("tspan"),z=O.getAttribute(I);for(let j=0,q;j<N.length;j++)(q=N[j]).getAttribute(I)===z&&q.setAttribute(I,A);O.setAttribute(I,A)}),S}fontMetrics(o){let u=Jh(is.prototype.getStyle.call(o,"font-size")||0),p=u<24?u+3:Math.round(1.2*u),x=Math.round(.8*p);return{h:p,b:x,f:u}}rotCorr(o,u,p){let x=o;return u&&p&&(x=Math.max(x*Math.cos(u*mr),4)),{x:-o/3*Math.sin(u*mr),y:x}}pathToSegments(o){let u=[],p=[],x={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let v=0;v<o.length;v++)Hc(p[0])&&Eo(o[v])&&p.length===x[p[0].toUpperCase()]&&o.splice(v,0,p[0].replace("M","L").replace("m","l")),typeof o[v]=="string"&&(p.length&&u.push(p.slice(0)),p.length=0),p.push(o[v]);return u.push(p.slice(0)),u}label(o,u,p,x,v,S,A,I,O){return new Qs(this,o,u,p,x,v,S,A,I,O)}alignElements(){this.alignedObjects.forEach(o=>o.align())}}pl(Xc.prototype,{Element:is,SVG_NS:pd,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:Gh,draw:dl}),vo.registerRendererType("svg",Xc,!0);let{composed:xd,isFirefox:Tm}=ke,{attr:vd,css:So,createElement:Zc,defined:bd,extend:wd,getAlignFactor:Em,isNumber:ec,pInt:Hf,pushUnique:Yc}=xe;function Td(R,o,u){var x;let p=((x=this.div)==null?void 0:x.style)||u.style;is.prototype[`${o}Setter`].call(this,R,o,u),p&&(p[o]=R)}let eu=(R,o)=>{var u;if(!R.div){let p=vd(R.element,"class"),x=R.css,v=Zc("div",p?{className:p}:void 0,{position:"absolute",left:`${R.translateX||0}px`,top:`${R.translateY||0}px`,...R.styles,display:R.display,opacity:R.opacity,visibility:R.visibility},((u=R.parentGroup)==null?void 0:u.div)||o);R.classSetter=(S,A,I)=>{I.setAttribute("class",S),v.className=S},R.translateXSetter=R.translateYSetter=(S,A)=>{R[A]=S,v.style[A==="translateX"?"left":"top"]=`${S}px`,R.doTransform=!0},R.opacitySetter=R.visibilitySetter=Td,R.css=S=>(x.call(R,S),S.cursor&&(v.style.cursor=S.cursor),S.pointerEvents&&(v.style.pointerEvents=S.pointerEvents),R),R.on=function(){return is.prototype.on.apply({element:v,onEvents:R.onEvents},arguments),R},R.div=v}return R.div};class gl extends is{static compose(o){Yc(xd,this.compose)&&(o.prototype.html=function(u,p,x){return new gl(this,"span").attr({text:u,x:Math.round(p),y:Math.round(x)})})}constructor(o,u){super(o,u),gl.useForeignObject?this.foreignObject=o.createElement("foreignObject").attr({zIndex:2}):this.css({position:"absolute",...o.styledMode?{}:{fontFamily:o.style.fontFamily,fontSize:o.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(o,u,p){this.xCorr=-o*p,this.yCorr=-u}css(o){let u,{element:p}=this,x=p.tagName==="SPAN"&&o&&"width"in o,v=x&&o.width;return x&&(delete o.width,this.textWidth=Hf(v)||void 0,u=!0),(o==null?void 0:o.textOverflow)==="ellipsis"&&(o.overflow="hidden",o.whiteSpace="nowrap"),o!=null&&o.lineClamp&&(o.display="-webkit-box",o.WebkitLineClamp=o.lineClamp,o.WebkitBoxOrient="vertical",o.overflow="hidden"),ec(Number(o==null?void 0:o.fontSize))&&(o.fontSize+="px"),wd(this.styles,o),So(p,o),u&&this.updateTransform(),this}htmlGetBBox(){let{element:o}=this;return{x:o.offsetLeft,y:o.offsetTop,width:o.offsetWidth,height:o.offsetHeight}}updateTransform(){var ce;if(!this.added){this.alignOnAdd=!0;return}let{element:o,foreignObject:u,oldTextWidth:p,renderer:x,rotation:v,rotationOriginX:S,rotationOriginY:A,scaleX:I,scaleY:O,styles:{display:N="inline-block",whiteSpace:z},textAlign:j="left",textWidth:q,translateX:K=0,translateY:se=0,x:re=0,y:te=0}=this;if(u||So(o,{marginLeft:`${K}px`,marginTop:`${se}px`}),o.tagName==="SPAN"){let fe,Xe=[v,j,o.innerHTML,q,this.textAlign].join(","),Ne=-(((ce=this.parentGroup)==null?void 0:ce.padding)*1)||0;if(q!==p){let gt=this.textPxLength?this.textPxLength:(So(o,{width:"",whiteSpace:z||"nowrap"}),o.offsetWidth),Bt=q||0,Jt=o.style.textOverflow===""&&o.style.webkitLineClamp;(Bt>p||gt>Bt||Jt)&&(/[\-\s\u00AD]/.test(o.textContent||o.innerText)||o.style.textOverflow==="ellipsis")&&(So(o,{width:(v||I||gt>Bt||Jt)&&ec(q)?q+"px":"auto",display:N,whiteSpace:z||"normal"}),this.oldTextWidth=q)}u&&(So(o,{display:"inline-block",verticalAlign:"top"}),u.attr({width:x.width,height:x.height})),Xe!==this.cTT&&(fe=x.fontMetrics(o).b,bd(v)&&!u&&(v!==(this.oldRotation||0)||j!==this.oldAlign)&&So(o,{transform:`rotate(${v}deg)`,transformOrigin:`${Ne}% ${Ne}px`}),this.getSpanCorrection(!bd(v)&&!this.textWidth&&this.textPxLength||o.offsetWidth,fe,Em(j)));let{xCorr:$e=0,yCorr:mt=0}=this,tt={left:`${re+$e}px`,top:`${te+mt}px`,textAlign:j,transformOrigin:`${(S??re)-$e-re-Ne}px ${(A??te)-mt-te-Ne}px`};(I||O)&&(tt.transform=`scale(${I??1},${O??1})`),u?(super.updateTransform(),ec(re)&&ec(te)?(u.attr({x:re+$e,y:te+mt,width:o.offsetWidth+3,height:o.offsetHeight,"transform-origin":o.getAttribute("transform-origin")||"0 0"}),So(o,{display:N,textAlign:j})):Tm&&u.attr({width:0,height:0})):So(o,tt),this.cTT=Xe,this.oldRotation=v,this.oldAlign=j}}add(o){let{foreignObject:u,renderer:p}=this,x=p.box.parentNode,v=[];if(u)u.add(o),super.add(p.createElement("body").attr({xmlns:"http://www.w3.org/1999/xhtml"}).css({background:"transparent",margin:"0 3px 0 0"}).add(u));else{let S;if(this.parentGroup=o,o&&!(S=o.div)){let A=o;for(;A;)v.push(A),A=A.parentGroup;for(let I of v.reverse())S=eu(I,x)}(S||x).appendChild(this.element)}return this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(o){o!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,jr.setElementHTML(this.element,o??""),this.textStr=o,this.doTransform=!0)}alignSetter(o){this.alignValue=this.textAlign=o,this.doTransform=!0}xSetter(o,u){this[u]=o,this.doTransform=!0}}let to=gl.prototype;to.visibilitySetter=to.opacitySetter=Td,to.ySetter=to.rotationSetter=to.rotationOriginXSetter=to.rotationOriginYSetter=to.xSetter,function(R){R.xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%[HMSL]",range:!1},second:{main:"%[HMS]",range:!1},minute:{main:"%[HM]",range:!1},hour:{main:"%[HM]",range:!1},day:{main:"%[eb]"},week:{main:"%[eb]"},month:{main:"%[bY]"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em",textOverflow:"ellipsis"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},R.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:o}=this.axis.chart;return o(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0}}(V||(V={}));let Sm=V,{addEvent:Cm,isFunction:Am,objectEach:Mm,removeEvent:Im}=xe;(s||(s={})).registerEventOptions=function(R,o){R.eventOptions=R.eventOptions||{},Mm(o.events,function(u,p){R.eventOptions[p]!==u&&(R.eventOptions[p]&&(Im(R,p,R.eventOptions[p]),delete R.eventOptions[p]),Am(u)&&(R.eventOptions[p]=u,Cm(R,p,u,{order:0})))})};let Kc=s,{deg2rad:tc}=ke,{clamp:ic,correctFloat:Jc,defined:tu,destroyObjectProperties:va,extend:Qc,fireEvent:ps,getAlignFactor:eh,isNumber:th,merge:_l,objectEach:rc,pick:Gs}=xe,ba=class{constructor(R,o,u,p,x){this.isNew=!0,this.isNewLabel=!0,this.axis=R,this.pos=o,this.type=u||"",this.parameters=x||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,ps(this,"init"),u||p||this.addLabel()}addLabel(){var mt;let R=this,o=R.axis,u=o.options,p=o.chart,x=o.categories,v=o.logarithmic,S=o.names,A=R.pos,I=Gs((mt=R.options)==null?void 0:mt.labels,u.labels),O=o.tickPositions,N=A===O[0],z=A===O[O.length-1],j=(!I.step||I.step===1)&&o.tickInterval===1,q=O.info,K=R.label,se,re,te,ce=this.parameters.category||(x?Gs(x[A],S[A],A):A);v&&th(ce)&&(ce=Jc(v.lin2log(ce))),o.dateTime&&(q?se=(re=p.time.resolveDTLFormat(u.dateTimeLabelFormats[!u.grid&&q.higherRanks[A]||q.unitName])).main:th(ce)&&(se=o.dateTime.getXDateFormat(ce,u.dateTimeLabelFormats||{}))),R.isFirst=N,R.isLast=z;let fe={axis:o,chart:p,dateTimeLabelFormat:se,isFirst:N,isLast:z,pos:A,tick:R,tickPositionInfo:q,value:ce};ps(this,"labelFormat",fe);let Xe=tt=>I.formatter?I.formatter.call(tt,tt):I.format?(tt.text=o.defaultLabelFormatter.call(tt),fs.format(I.format,tt,p)):o.defaultLabelFormatter.call(tt),Ne=Xe.call(fe,fe),$e=re==null?void 0:re.list;$e?R.shortenLabel=function(){for(te=0;te<$e.length;te++)if(Qc(fe,{dateTimeLabelFormat:$e[te]}),K.attr({text:Xe.call(fe,fe)}),K.getBBox().width<o.getSlotWidth(R)-2*(I.padding||0))return;K.attr({text:""})}:R.shortenLabel=void 0,j&&o._addedPlotLB&&R.moveLabel(Ne,I),tu(K)||R.movedLabel?K&&K.textStr!==Ne&&!j&&(!K.textWidth||I.style.width||K.styles.width||K.css({width:null}),K.attr({text:Ne}),K.textPxLength=K.getBBox().width):(R.label=K=R.createLabel(Ne,I),R.rotation=0)}createLabel(R,o,u){let p=this.axis,{renderer:x,styledMode:v}=p.chart,S=o.style.whiteSpace,A=tu(R)&&o.enabled?x.text(R,u==null?void 0:u.x,u==null?void 0:u.y,o.useHTML).add(p.labelGroup):void 0;return A&&(v||A.css(_l(o.style)),A.textPxLength=A.getBBox().width,!v&&S&&A.css({whiteSpace:S})),A}destroy(){va(this,this.axis)}getPosition(R,o,u,p){let x=this.axis,v=x.chart,S=p&&v.oldChartHeight||v.chartHeight,A={x:R?Jc(x.translate(o+u,void 0,void 0,p)+x.transB):x.left+x.offset+(x.opposite?(p&&v.oldChartWidth||v.chartWidth)-x.right-x.left:0),y:R?S-x.bottom+x.offset-(x.opposite?x.height:0):Jc(S-x.translate(o+u,void 0,void 0,p)-x.transB)};return A.y=ic(A.y,-1e9,1e9),ps(this,"afterGetPosition",{pos:A}),A}getLabelPosition(R,o,u,p,x,v,S,A){let I,O,N=this.axis,z=N.transA,j=N.isLinked&&N.linkedParent?N.linkedParent.reversed:N.reversed,q=N.staggerLines,K=N.tickRotCorr||{x:0,y:0},se=p||N.reserveSpaceDefault?0:-N.labelOffset*(N.labelAlign==="center"?.5:1),re=x.distance,te={};return I=N.side===0?u.rotation?-re:-u.getBBox().height:N.side===2?K.y+re:Math.cos(u.rotation*tc)*(K.y-u.getBBox(!1,0).height/2),tu(x.y)&&(I=N.side===0&&N.horiz?x.y+I:x.y),R=R+Gs(x.x,[0,1,0,-1][N.side]*re)+se+K.x-(v&&p?v*z*(j?-1:1):0),o=o+I-(v&&!p?v*z*(j?1:-1):0),q&&(O=S/(A||1)%q,N.opposite&&(O=q-O-1),o+=O*(N.labelOffset/q)),te.x=R,te.y=Math.round(o),ps(this,"afterGetLabelPosition",{pos:te,tickmarkOffset:v,index:S}),te}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(R,o,u,p,x=!1,v){return v.crispLine([["M",R,o],["L",R+(x?0:-u),o+(x?u:0)]],p)}handleOverflow(R){var re;let o=this.axis,u=o.options.labels,p=R.x,x=o.chart.chartWidth,v=o.chart.spacing,S=Gs(o.labelLeft,Math.min(o.pos,v[3])),A=Gs(o.labelRight,Math.max(o.isRadial?0:o.pos+o.len,x-v[1])),I=this.label,O=this.rotation,N=eh(o.labelAlign||I.attr("align")),z=I.getBBox().width,j=o.getSlotWidth(this),q=j,K=1,se;O||u.overflow!=="justify"?O<0&&p-N*z<S?se=Math.round(p/Math.cos(O*tc)-S):O>0&&p+N*z>A&&(se=Math.round((x-p)/Math.cos(O*tc))):(p-N*z<S?q=R.x+q*(1-N)-S:p+(1-N)*z>A&&(q=A-R.x+q*N,K=-1),(q=Math.min(j,q))<j&&o.labelAlign==="center"&&(R.x+=K*(j-q-N*(j-Math.min(z,q)))),(z>q||o.autoRotation&&((re=I==null?void 0:I.styles)!=null&&re.width))&&(se=q)),se&&I&&(this.shortenLabel?this.shortenLabel():I.css(Qc({},{width:Math.floor(se)+"px",lineClamp:+!o.isRadial})))}moveLabel(R,o){let u=this,p=u.label,x=u.axis,v=!1,S;p&&p.textStr===R?(u.movedLabel=p,v=!0,delete u.label):rc(x.ticks,function(A){v||A.isNew||A===u||!A.label||A.label.textStr!==R||(u.movedLabel=A.label,v=!0,A.labelPos=u.movedLabel.xy,delete A.label)}),!v&&(u.labelPos||p)&&(S=u.labelPos||p.xy,u.movedLabel=u.createLabel(R,o,S),u.movedLabel&&u.movedLabel.attr({opacity:0}))}render(R,o,u){var K;let p=this.axis,x=p.horiz,v=this.pos,S=Gs(this.tickmarkOffset,p.tickmarkOffset),A=this.getPosition(x,v,S,o),I=A.x,O=A.y,N=p.pos,z=N+p.len,j=x?I:O,q=Gs(u,(K=this.label)==null?void 0:K.newOpacity,1);!p.chart.polar&&(Jc(j)<N||j>z)&&(u=0),u??(u=1),this.isActive=!0,this.renderGridLine(o,u),this.renderMark(A,u),this.renderLabel(A,o,q,R),this.isNew=!1,ps(this,"afterRender")}renderGridLine(R,o){let u=this.axis,p=u.options,x={},v=this.pos,S=this.type,A=Gs(this.tickmarkOffset,u.tickmarkOffset),I=u.chart.renderer,O=this.gridLine,N,z=p.gridLineWidth,j=p.gridLineColor,q=p.gridLineDashStyle;this.type==="minor"&&(z=p.minorGridLineWidth,j=p.minorGridLineColor,q=p.minorGridLineDashStyle),O||(u.chart.styledMode||(x.stroke=j,x["stroke-width"]=z||0,x.dashstyle=q),S||(x.zIndex=1),R&&(o=0),this.gridLine=O=I.path().attr(x).addClass("highcharts-"+(S?S+"-":"")+"grid-line").add(u.gridGroup)),O&&(N=u.getPlotLinePath({value:v+A,lineWidth:O.strokeWidth(),force:"pass",old:R,acrossPanes:!1}))&&O[R||this.isNew?"attr":"animate"]({d:N,opacity:o})}renderMark(R,o){let u=this.axis,p=u.options,x=u.chart.renderer,v=this.type,S=u.tickSize(v?v+"Tick":"tick"),A=R.x,I=R.y,O=Gs(p[v!=="minor"?"tickWidth":"minorTickWidth"],!v&&u.isXAxis?1:0),N=p[v!=="minor"?"tickColor":"minorTickColor"],z=this.mark,j=!z;S&&(u.opposite&&(S[0]=-S[0]),z||(this.mark=z=x.path().addClass("highcharts-"+(v?v+"-":"")+"tick").add(u.axisGroup),u.chart.styledMode||z.attr({stroke:N,"stroke-width":O})),z[j?"attr":"animate"]({d:this.getMarkPath(A,I,S[0],z.strokeWidth(),u.horiz,x),opacity:o}))}renderLabel(R,o,u,p){let x=this.axis,v=x.horiz,S=x.options,A=this.label,I=S.labels,O=I.step,N=Gs(this.tickmarkOffset,x.tickmarkOffset),z=R.x,j=R.y,q=!0;A&&th(z)&&(A.xy=R=this.getLabelPosition(z,j,A,v,I,N,p,O),(!this.isFirst||this.isLast||S.showFirstLabel)&&(!this.isLast||this.isFirst||S.showLastLabel)?!v||I.step||I.rotation||o||u===0||this.handleOverflow(R):q=!1,O&&p%O&&(q=!1),q&&th(R.y)?(R.opacity=u,A[this.isNewLabel?"attr":"animate"](R).show(!0),this.isNewLabel=!1):(A.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let R=this.label,o=this.axis;R&&!this.isNew&&(R.animate({opacity:0},void 0,R.destroy),delete this.label),o.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}},{animObject:vr}=Cn,{xAxis:nc,yAxis:qf}=Sm,{defaultOptions:sc}=Le,{registerEventOptions:oc}=Kc,{deg2rad:Xf}=ke,{arrayMax:ih,arrayMin:wa,clamp:iu,correctFloat:ms,defined:Ar,destroyObjectProperties:ac,erase:ru,error:yl,extend:$a,fireEvent:Zr,getClosestDistance:rh,insertItem:fi,isArray:io,isNumber:Fi,isString:lc,merge:Ga,normalizeTickInterval:rs,objectEach:Wa,pick:rr,relativeLength:cc,removeEvent:nu,splat:Zf,syncTimeout:su}=xe,xl=(R,o)=>rs(o,void 0,void 0,rr(R.options.allowDecimals,o<.5||R.tickAmount!==void 0),!!R.tickAmount);$a(sc,{xAxis:nc,yAxis:Ga(nc,qf)});class Ha{constructor(o,u,p){this.init(o,u,p)}init(o,u,p=this.coll){let x=p==="xAxis",v=this.isZAxis||(o.inverted?!x:x);this.chart=o,this.horiz=v,this.isXAxis=x,this.coll=p,Zr(this,"init",{userOptions:u}),this.opposite=rr(u.opposite,this.opposite),this.side=rr(u.side,this.side,v?2*!this.opposite:this.opposite?1:3),this.setOptions(u);let S=this.options,A=S.labels;this.type??(this.type=S.type||"linear"),this.uniqueNames??(this.uniqueNames=S.uniqueNames??!0),Zr(this,"afterSetType"),this.userOptions=u,this.minPixelPadding=0,this.reversed=rr(S.reversed,this.reversed),this.visible=S.visible,this.zoomEnabled=S.zoomEnabled,this.hasNames=this.type==="category"||S.categories===!0,this.categories=io(S.categories)&&S.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=Ar(S.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=S.minRange||S.maxZoom,this.range=S.range,this.offset=S.offset||0,this.max=void 0,this.min=void 0;let I=rr(S.crosshair,Zf(o.options.tooltip.crosshairs)[+!x]);this.crosshair=I===!0?{}:I,o.axes.indexOf(this)===-1&&(x?o.axes.splice(o.xAxis.length,0,this):o.axes.push(this),fi(this,o[this.coll])),o.orderItems(this.coll),this.series=this.series||[],o.inverted&&!this.isZAxis&&x&&!Ar(this.reversed)&&(this.reversed=!0),this.labelRotation=Fi(A.rotation)?A.rotation:void 0,oc(this,S),Zr(this,"afterInit")}setOptions(o){let u=this.horiz?{labels:{autoRotation:[-45],padding:3},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=Ga(u,this.coll==="yAxis"?{title:{text:this.chart.options.lang.yAxisTitle}}:{},sc[this.coll],o),Zr(this,"afterSetOptions",{userOptions:o})}defaultLabelFormatter(){let o=this.axis,{numberFormatter:u}=this.chart,p=Fi(this.value)?this.value:NaN,x=o.chart.time,v=o.categories,S=this.dateTimeLabelFormat,A=sc.lang,I=A.numericSymbols,O=A.numericSymbolMagnitude||1e3,N=o.logarithmic?Math.abs(p):o.tickInterval,z=I==null?void 0:I.length,j,q;if(v)q=`${this.value}`;else if(S)q=x.dateFormat(S,p,!0);else if(z&&I&&N>=1e3)for(;z--&&q===void 0;)N>=(j=Math.pow(O,z+1))&&10*p%j==0&&I[z]!==null&&p!==0&&(q=u(p/j,-1)+I[z]);return q===void 0&&(q=Math.abs(p)>=1e4?u(p,-1):u(p,-1,void 0,"")),q}getSeriesExtremes(){let o,u=this;Zr(this,"getSeriesExtremes",null,function(){u.hasVisibleSeries=!1,u.dataMin=u.dataMax=u.threshold=void 0,u.softThreshold=!u.isXAxis,u.series.forEach(p=>{if(p.reserveSpace()){let x=p.options,v,S=x.threshold,A,I;if(u.hasVisibleSeries=!0,u.positiveValuesOnly&&0>=(S||0)&&(S=void 0),u.isXAxis)(v=p.getColumn("x")).length&&(v=u.logarithmic?v.filter(O=>O>0):v,A=(o=p.getXExtremes(v)).min,I=o.max,Fi(A)||A instanceof Date||(v=v.filter(Fi),A=(o=p.getXExtremes(v)).min,I=o.max),v.length&&(u.dataMin=Math.min(rr(u.dataMin,A),A),u.dataMax=Math.max(rr(u.dataMax,I),I)));else{let O=p.applyExtremes();Fi(O.dataMin)&&(A=O.dataMin,u.dataMin=Math.min(rr(u.dataMin,A),A)),Fi(O.dataMax)&&(I=O.dataMax,u.dataMax=Math.max(rr(u.dataMax,I),I)),Ar(S)&&(u.threshold=S),(!x.softThreshold||u.positiveValuesOnly)&&(u.softThreshold=!1)}}})}),Zr(this,"afterGetSeriesExtremes")}translate(o,u,p,x,v,S){var se;let A=this.linkedParent||this,I=x&&A.old?A.old.min:A.min;if(!Fi(I))return NaN;let O=A.minPixelPadding,N=(A.isOrdinal||((se=A.brokenAxis)==null?void 0:se.hasBreaks)||A.logarithmic&&v)&&A.lin2val,z=1,j=0,q=x&&A.old?A.old.transA:A.transA,K=0;return q||(q=A.transA),p&&(z*=-1,j=A.len),A.reversed&&(z*=-1,j-=z*(A.sector||A.len)),u?(K=(o=o*z+j-O)/q+I,N&&(K=A.lin2val(K))):(N&&(o=A.val2lin(o)),K=z*(o-I)*q+j+z*O+(Fi(S)?q*S:0),A.isRadial||(K=ms(K))),K}toPixels(o,u){var p;return this.translate(((p=this.chart)==null?void 0:p.time.parse(o))??NaN,!1,!this.horiz,void 0,!0)+(u?0:this.pos)}toValue(o,u){return this.translate(o-(u?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(o){let u=this,p=u.chart,x=u.left,v=u.top,S=o.old,A=o.value,I=o.lineWidth,O=S&&p.oldChartHeight||p.chartHeight,N=S&&p.oldChartWidth||p.chartWidth,z=u.transB,j=o.translatedValue,q=o.force,K,se,re,te,ce;function fe(Ne,$e,mt){return q!=="pass"&&(Ne<$e||Ne>mt)&&(q?Ne=iu(Ne,$e,mt):ce=!0),Ne}let Xe={value:A,lineWidth:I,old:S,force:q,acrossPanes:o.acrossPanes,translatedValue:j};return Zr(this,"getPlotLinePath",Xe,function(Ne){K=re=(j=iu(j=rr(j,u.translate(A,void 0,void 0,S)),-1e9,1e9))+z,se=te=O-j-z,Fi(j)?u.horiz?(se=v,te=O-u.bottom+(u.options.isInternal?0:p.scrollablePixelsY||0),K=re=fe(K,x,x+u.width)):(K=x,re=N-u.right+(p.scrollablePixelsX||0),se=te=fe(se,v,v+u.height)):(ce=!0,q=!1),Ne.path=ce&&!q?void 0:p.renderer.crispLine([["M",K,se],["L",re,te]],I||1)}),Xe.path}getLinearTickPositions(o,u,p){let x,v,S,A=ms(Math.floor(u/o)*o),I=ms(Math.ceil(p/o)*o),O=[];if(ms(A+o)===A&&(S=20),this.single)return[u];for(x=A;x<=I&&(O.push(x),(x=ms(x+o,S))!==v);)v=x;return O}getMinorTickInterval(){let{minorTicks:o,minorTickInterval:u}=this.options;return o===!0?rr(u,"auto"):o!==!1?u:void 0}getMinorTickPositions(){var N;let o=this.options,u=this.tickPositions,p=this.minorTickInterval,x=this.pointRangePadding||0,v=(this.min||0)-x,S=(this.max||0)+x,A=(N=this.brokenAxis)!=null&&N.hasBreaks?this.brokenAxis.unitLength:S-v,I=[],O;if(A&&A/p<this.len/3){let z=this.logarithmic;if(z)this.paddedTicks.forEach(function(j,q,K){q&&I.push.apply(I,z.getLogTickPositions(p,K[q-1],K[q],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")I=I.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(p),v,S,o.startOfWeek));else for(O=v+(u[0]-v)%p;O<=S&&O!==I[0];O+=p)I.push(O)}return I.length!==0&&this.trimTicks(I),I}adjustForMinRange(){let o=this.options,u=this.logarithmic,p=this.chart.time,{max:x,min:v,minRange:S}=this,A,I,O,N;this.isXAxis&&S===void 0&&!u&&(S=Ar(o.min)||Ar(o.max)||Ar(o.floor)||Ar(o.ceiling)?null:Math.min(5*(rh(this.series.map(z=>{let j=z.getColumn("x");return z.xIncrement?j.slice(0,2):j}))||0),this.dataMax-this.dataMin)),Fi(x)&&Fi(v)&&Fi(S)&&x-v<S&&(I=this.dataMax-this.dataMin>=S,A=(S-x+v)/2,O=[v-A,p.parse(o.min)??v-A],I&&(O[2]=u?u.log2lin(this.dataMin):this.dataMin),N=[(v=ih(O))+S,p.parse(o.max)??v+S],I&&(N[2]=u?u.log2lin(this.dataMax):this.dataMax),(x=wa(N))-v<S&&(O[0]=x-S,O[1]=p.parse(o.min)??x-S,v=ih(O))),this.minRange=S,this.min=v,this.max=x}getClosest(){let o,u;if(this.categories)u=1;else{let p=[];this.series.forEach(function(x){let v=x.closestPointRange,S=x.getColumn("x");S.length===1?p.push(S[0]):x.sorted&&Ar(v)&&x.reserveSpace()&&(u=Ar(u)?Math.min(u,v):v)}),p.length&&(p.sort((x,v)=>x-v),o=rh([p]))}return o&&u?Math.min(o,u):o||u}nameToX(o){let u=io(this.options.categories),p=u?this.categories:this.names,x=o.options.x,v;return o.series.requireSorting=!1,Ar(x)||(x=this.uniqueNames&&p?u?p.indexOf(o.name):rr(p.keys[o.name],-1):o.series.autoIncrement()),x===-1?!u&&p&&(v=p.length):Fi(x)&&(v=x),v!==void 0?(this.names[v]=o.name,this.names.keys[o.name]=v):o.x&&(v=o.x),v}updateNames(){let o=this,u=this.names;u.length>0&&(Object.keys(u.keys).forEach(function(p){delete u.keys[p]}),u.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(p=>{p.xIncrement=null,(!p.points||p.isDirtyData)&&(o.max=Math.max(o.max||0,p.dataTable.rowCount-1),p.processData(),p.generatePoints());let x=p.getColumn("x").slice();p.data.forEach((v,S)=>{let A=x[S];v!=null&&v.options&&v.name!==void 0&&(A=o.nameToX(v))!==void 0&&A!==v.x&&(x[S]=v.x=A)}),p.dataTable.setColumn("x",x)}))}setAxisTranslation(){var j;let o=this,u=o.max-o.min,p=o.linkedParent,x=!!o.categories,v=o.isXAxis,S=o.axisPointRange||0,A,I=0,O=0,N,z=o.transA;(v||x||S)&&(A=o.getClosest(),p?(I=p.minPointOffset,O=p.pointRangePadding):o.series.forEach(function(q){let K=x?1:v?rr(q.options.pointRange,A,0):o.axisPointRange||0,se=q.options.pointPlacement;if(S=Math.max(S,K),!o.single||x){let re=q.is("xrange")?!v:v;I=Math.max(I,re&&lc(se)?0:K/2),O=Math.max(O,re&&se==="on"?0:K)}}),N=(j=o.ordinal)!=null&&j.slope&&A?o.ordinal.slope/A:1,o.minPointOffset=I*=N,o.pointRangePadding=O*=N,o.pointRange=Math.min(S,o.single&&x?1:u),v&&(o.closestPointRange=A)),o.translationSlope=o.transA=z=o.staticScale||o.len/(u+O||1),o.transB=o.horiz?o.left:o.bottom,o.minPixelPadding=z*I,Zr(this,"afterSetAxisTranslation")}minFromRange(){let{max:o,min:u}=this;return Fi(o)&&Fi(u)&&o-u||void 0}setTickInterval(o){var gi,Ui,wi,ji;let{categories:u,chart:p,dataMax:x,dataMin:v,dateTime:S,isXAxis:A,logarithmic:I,options:O,softThreshold:N}=this,z=p.time,j=Fi(this.threshold)?this.threshold:void 0,q=this.minRange||0,{ceiling:K,floor:se,linkedTo:re,softMax:te,softMin:ce}=O,fe=Fi(re)&&((gi=p[this.coll])==null?void 0:gi[re]),Xe=O.tickPixelInterval,Ne=O.maxPadding,$e=O.minPadding,mt=0,tt,gt=Fi(O.tickInterval)&&O.tickInterval>=0?O.tickInterval:void 0,Bt,Jt,ii,Ft;if(S||u||fe||this.getTickAmount(),ii=rr(this.userMin,z.parse(O.min)),Ft=rr(this.userMax,z.parse(O.max)),fe?(this.linkedParent=fe,tt=fe.getExtremes(),this.min=rr(tt.min,tt.dataMin),this.max=rr(tt.max,tt.dataMax),this.type!==fe.type&&yl(11,!0,p)):(N&&Ar(j)&&Fi(x)&&Fi(v)&&(v>=j?(Bt=j,$e=0):x<=j&&(Jt=j,Ne=0)),this.min=rr(ii,Bt,v),this.max=rr(Ft,Jt,x)),Fi(this.max)&&Fi(this.min)&&(I&&(this.positiveValuesOnly&&!o&&0>=Math.min(this.min,rr(v,this.min))&&yl(10,!0,p),this.min=ms(I.log2lin(this.min),16),this.max=ms(I.log2lin(this.max),16)),this.range&&Fi(v)&&(this.userMin=this.min=ii=Math.max(v,this.minFromRange()||0),this.userMax=Ft=this.max,this.range=void 0)),Zr(this,"foundExtremes"),this.adjustForMinRange(),Fi(this.min)&&Fi(this.max)){if(!Fi(this.userMin)&&Fi(ce)&&ce<this.min&&(this.min=ii=ce),!Fi(this.userMax)&&Fi(te)&&te>this.max&&(this.max=Ft=te),u||this.axisPointRange||(Ui=this.stacking)!=null&&Ui.usePercentage||fe||!(mt=this.max-this.min)||(!Ar(ii)&&$e&&(this.min-=mt*$e),Ar(Ft)||!Ne||(this.max+=mt*Ne)),!Fi(this.userMin)&&Fi(se)&&(this.min=Math.max(this.min,se)),!Fi(this.userMax)&&Fi(K)&&(this.max=Math.min(this.max,K)),N&&Fi(v)&&Fi(x)){let _r=j||0;!Ar(ii)&&this.min<_r&&v>=_r?this.min=O.minRange?Math.min(_r,this.max-q):_r:!Ar(Ft)&&this.max>_r&&x<=_r&&(this.max=O.minRange?Math.max(_r,this.min+q):_r)}!p.polar&&this.min>this.max&&(Ar(O.min)?this.max=this.min:Ar(O.max)&&(this.min=this.max)),mt=this.max-this.min}if(this.min!==this.max&&Fi(this.min)&&Fi(this.max)?fe&&!gt&&Xe===fe.options.tickPixelInterval?this.tickInterval=gt=fe.tickInterval:this.tickInterval=rr(gt,this.tickAmount?mt/Math.max(this.tickAmount-1,1):void 0,u?1:mt*Xe/Math.max(this.len,Xe)):this.tickInterval=1,A&&!o){let _r=this.min!==((wi=this.old)==null?void 0:wi.min)||this.max!==((ji=this.old)==null?void 0:ji.max);this.series.forEach(function(lr){var br;lr.forceCrop=(br=lr.forceCropping)==null?void 0:br.call(lr),lr.processData(_r)}),Zr(this,"postProcessData",{hasExtremesChanged:_r})}this.setAxisTranslation(),Zr(this,"initialAxisTranslation"),this.pointRange&&!gt&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let ui=rr(O.minTickInterval,S&&!this.series.some(_r=>!_r.sorted)?this.closestPointRange:0);!gt&&ui&&this.tickInterval<ui&&(this.tickInterval=ui),S||I||gt||(this.tickInterval=xl(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){var N,z;let o=this.options,u=o.tickPositions,p=o.tickPositioner,x=this.getMinorTickInterval(),v=!this.isPanning,S=v&&o.startOnTick,A=v&&o.endOnTick,I=[],O;if(this.tickmarkOffset=this.categories&&o.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.single=this.min===this.max&&Ar(this.min)&&!this.tickAmount&&(this.min%1==0||o.allowDecimals!==!1),u)I=u.slice();else if(Fi(this.min)&&Fi(this.max)){if(!((N=this.ordinal)!=null&&N.positions)&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))I=[this.min,this.max],yl(19,!1,this.chart);else if(this.dateTime)I=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,o.units),this.min,this.max,o.startOfWeek,(z=this.ordinal)==null?void 0:z.positions,this.closestPointRange,!0);else if(this.logarithmic)I=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let j=this.tickInterval,q=j;for(;q<=2*j&&(I=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&I.length>this.tickAmount);)this.tickInterval=xl(this,q*=1.1)}I.length>this.len&&(I=[I[0],I[I.length-1]])[0]===I[1]&&(I.length=1),p&&(this.tickPositions=I,(O=p.apply(this,[this.min,this.max]))&&(I=O))}this.tickPositions=I,this.minorTickInterval=x==="auto"&&this.tickInterval?this.tickInterval/o.minorTicksPerMajor:x,this.paddedTicks=I.slice(0),this.trimTicks(I,S,A),!this.isLinked&&Fi(this.min)&&Fi(this.max)&&(this.single&&I.length<2&&!this.categories&&!this.series.some(j=>j.is("heatmap")&&j.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),u||O||this.adjustTickAmount()),Zr(this,"afterSetTickPositions")}trimTicks(o,u,p){let x=o[0],v=o[o.length-1],S=!this.isOrdinal&&this.minPointOffset||0;if(Zr(this,"trimTicks"),!this.isLinked||!this.grid){if(u&&x!==-1/0)this.min=x;else for(;this.min-S>o[0];)o.shift();if(p)this.max=v;else for(;this.max+S<o[o.length-1];)o.pop();o.length===0&&Ar(x)&&!this.options.tickPositions&&o.push((v+x)/2)}}alignToOthers(){let o,u=this,p=u.chart,x=[this],v=u.options,S=p.options.chart,A=this.coll==="yAxis"&&S.alignThresholds,I=[];if(u.thresholdAlignment=void 0,(S.alignTicks!==!1&&v.alignTicks||A)&&v.startOnTick!==!1&&v.endOnTick!==!1&&!u.logarithmic){let O=z=>{let{horiz:j,options:q}=z;return[j?q.left:q.top,q.width,q.height,q.pane].join(",")},N=O(this);p[this.coll].forEach(function(z){let{series:j}=z;j.length&&j.some(q=>q.visible)&&z!==u&&O(z)===N&&(o=!0,x.push(z))})}if(o&&A){x.forEach(N=>{let z=N.getThresholdAlignment(u);Fi(z)&&I.push(z)});let O=I.length>1?I.reduce((N,z)=>N+=z,0)/I.length:void 0;x.forEach(N=>{N.thresholdAlignment=O})}return o}getThresholdAlignment(o){if((!Fi(this.dataMin)||this!==o&&this.series.some(u=>u.isDirty||u.isDirtyData))&&this.getSeriesExtremes(),Fi(this.threshold)){let u=iu((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(u=1-u),u}}getTickAmount(){let o=this.options,u=o.tickPixelInterval,p=o.tickAmount;Ar(o.tickInterval)||p||!(this.len<u)||this.isRadial||this.logarithmic||!o.startOnTick||!o.endOnTick||(p=2),!p&&this.alignToOthers()&&(p=Math.ceil(this.len/u)+1),p<4&&(this.finalTickAmt=p,p=5),this.tickAmount=p}adjustTickAmount(){let o=this,{finalTickAmt:u,max:p,min:x,options:v,tickPositions:S,tickAmount:A,thresholdAlignment:I}=o,O=S==null?void 0:S.length,N=rr(o.threshold,o.softThreshold?0:null),z,j,q=o.tickInterval,K,se=()=>S.push(ms(S[S.length-1]+q)),re=()=>S.unshift(ms(S[0]-q));if(Fi(I)&&(K=I<.5?Math.ceil(I*(A-1)):Math.floor(I*(A-1)),v.reversed&&(K=A-1-K)),o.hasData()&&Fi(x)&&Fi(p)){let te=()=>{o.transA*=(O-1)/(A-1),o.min=v.startOnTick?S[0]:Math.min(x,S[0]),o.max=v.endOnTick?S[S.length-1]:Math.max(p,S[S.length-1])};if(Fi(K)&&Fi(o.threshold)){for(;S[K]!==N||S.length!==A||S[0]>x||S[S.length-1]<p;){for(S.length=0,S.push(o.threshold);S.length<A;)S[K]===void 0||S[K]>o.threshold?re():se();if(q>8*o.tickInterval)break;q*=2}te()}else if(O<A){for(;S.length<A;)S.length%2||x===N?se():re();te()}if(Ar(u)){for(j=z=S.length;j--;)(u===3&&j%2==1||u<=2&&j>0&&j<z-1)&&S.splice(j,1);o.finalTickAmt=void 0}}}setScale(){var S,A,I,O,N;let{coll:o,stacking:u}=this,p=!1,x=!1;this.series.forEach(z=>{var j;p=p||z.isDirtyData||z.isDirty,x=x||((j=z.xAxis)==null?void 0:j.isDirty)||!1}),this.setAxisSize();let v=this.len!==((S=this.old)==null?void 0:S.len);v||p||x||this.isLinked||this.forceRedraw||this.userMin!==((A=this.old)==null?void 0:A.userMin)||this.userMax!==((I=this.old)==null?void 0:I.userMax)||this.alignToOthers()?(u&&o==="yAxis"&&u.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),u&&o==="xAxis"&&u.buildStacks(),this.isDirty||(this.isDirty=v||this.min!==((O=this.old)==null?void 0:O.min)||this.max!==((N=this.old)==null?void 0:N.max))):u&&u.cleanStacks(),p&&delete this.allExtremes,Zr(this,"afterSetScale")}setExtremes(o,u,p=!0,x,v){let S=this.chart;this.series.forEach(A=>{delete A.kdTree}),o=S.time.parse(o),u=S.time.parse(u),Zr(this,"setExtremes",v=$a(v,{min:o,max:u}),A=>{this.userMin=A.min,this.userMax=A.max,this.eventArgs=A,p&&S.redraw(x)})}setAxisSize(){let o=this.chart,u=this.options,p=u.offsets||[0,0,0,0],x=this.horiz,v=this.width=Math.round(cc(rr(u.width,o.plotWidth-p[3]+p[1]),o.plotWidth)),S=this.height=Math.round(cc(rr(u.height,o.plotHeight-p[0]+p[2]),o.plotHeight)),A=this.top=Math.round(cc(rr(u.top,o.plotTop+p[0]),o.plotHeight,o.plotTop)),I=this.left=Math.round(cc(rr(u.left,o.plotLeft+p[3]),o.plotWidth,o.plotLeft));this.bottom=o.chartHeight-S-A,this.right=o.chartWidth-v-I,this.len=Math.max(x?v:S,0),this.pos=x?I:A}getExtremes(){let o=this.logarithmic;return{min:o?ms(o.lin2log(this.min)):this.min,max:o?ms(o.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(o){let u=this.logarithmic,p=u?u.lin2log(this.min):this.min,x=u?u.lin2log(this.max):this.max;return o===null||o===-1/0?o=p:o===1/0?o=x:p>o?o=p:x<o&&(o=x),this.translate(o,0,1,0,1)}autoLabelAlign(o){let u=(rr(o,0)-90*this.side+720)%360,p={align:"center"};return Zr(this,"autoLabelAlign",p,function(x){u>15&&u<165?x.align="right":u>195&&u<345&&(x.align="left")}),p.align}tickSize(o){let u=this.options,p=rr(u[o==="tick"?"tickWidth":"minorTickWidth"],o==="tick"&&this.isXAxis&&!this.categories?1:0),x=u[o==="tick"?"tickLength":"minorTickLength"],v;p&&x&&(u[o+"Position"]==="inside"&&(x=-x),v=[x,p]);let S={tickSize:v};return Zr(this,"afterTickSize",S),S.tickSize}labelMetrics(){let o=this.chart.renderer,u=this.ticks,p=u[Object.keys(u)[0]]||{};return this.chart.renderer.fontMetrics(p.label||p.movedLabel||o.box)}unsquish(){let o=this.options.labels,u=o.padding||0,p=this.horiz,x=this.tickInterval,v=this.len/((+!!this.categories+this.max-this.min)/x),S=o.rotation,A=ms(.8*this.labelMetrics().h),I=Math.max(this.max-this.min,0),O=function(K){let se=(K+2*u)/(v||1);return(se=se>1?Math.ceil(se):1)*x>I&&K!==1/0&&v!==1/0&&I&&(se=Math.ceil(I/x)),ms(se*x)},N=x,z,j=Number.MAX_VALUE,q;if(p){if(!o.staggerLines&&(Fi(S)?q=[S]:v<o.autoRotationLimit&&(q=o.autoRotation)),q){let K,se;for(let re of q)(re===S||re&&re>=-90&&re<=90)&&(se=(K=O(Math.abs(A/Math.sin(Xf*re))))+Math.abs(re/360))<j&&(j=se,z=re,N=K)}}else N=O(.75*A);return this.autoRotation=q,this.labelRotation=rr(z,Fi(S)?S:0),o.step?x:N}getSlotWidth(o){let u=this.chart,p=this.horiz,x=this.options.labels,v=Math.max(this.tickPositions.length-+!this.categories,1),S=u.margin[3];if(o&&Fi(o.slotWidth))return o.slotWidth;if(p&&x.step<2&&!this.isRadial)return x.rotation?0:(this.staggerLines||1)*this.len/v;if(!p){let A=x.style.width;if(A!==void 0)return parseInt(String(A),10);if(S)return S-u.spacing[3]}return .33*u.chartWidth}renderUnsquish(){let o=this.chart,u=o.renderer,p=this.tickPositions,x=this.ticks,v=this.options.labels,S=v.style,A=this.horiz,I=this.getSlotWidth(),O=Math.max(1,Math.round(I-(A?2*(v.padding||0):v.distance||0))),N={},z=this.labelMetrics(),j=S.lineClamp,q,K=j??(Math.floor(this.len/(p.length*z.h))||1),se=0;lc(v.rotation)||(N.rotation=v.rotation||0),p.forEach(function(re){var fe;let te=x[re];te.movedLabel&&te.replaceMovedLabel();let ce=((fe=te.label)==null?void 0:fe.textPxLength)||0;ce>se&&(se=ce)}),this.maxLabelLength=se,this.autoRotation?se>O&&se>z.h?N.rotation=this.labelRotation:this.labelRotation=0:I&&(q=O),N.rotation&&(q=se>.5*o.chartHeight?.33*o.chartHeight:se,j||(K=1)),this.labelAlign=v.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(N.align=this.labelAlign),p.forEach(function(re){let te=x[re],ce=te==null?void 0:te.label,fe=S.width,Xe={};ce&&(ce.attr(N),te.shortenLabel?te.shortenLabel():q&&!fe&&S.whiteSpace!=="nowrap"&&(q<(ce.textPxLength||0)||ce.element.tagName==="SPAN")?ce.css($a(Xe,{width:`${q}px`,lineClamp:K})):!ce.styles.width||Xe.width||fe||ce.css({width:"auto"}),te.rotation=N.rotation)},this),this.tickRotCorr=u.rotCorr(z.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(o){return o.hasData()})||this.options.showEmpty&&Ar(this.min)&&Ar(this.max)}addTitle(o){let u,p=this.chart.renderer,x=this.horiz,v=this.opposite,S=this.options.title,A=this.chart.styledMode;this.axisTitle||((u=S.textAlign)||(u=(x?{low:"left",middle:"center",high:"right"}:{low:v?"right":"left",middle:"center",high:v?"left":"right"})[S.align]),this.axisTitle=p.text(S.text||"",0,0,S.useHTML).attr({zIndex:7,rotation:S.rotation||0,align:u}).addClass("highcharts-axis-title"),A||this.axisTitle.css(Ga(S.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),A||S.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[o?"show":"hide"](o)}generateTick(o){let u=this.ticks;u[o]?u[o].addLabel():u[o]=new ba(this,o)}createGroups(){let{axisParent:o,chart:u,coll:p,options:x}=this,v=u.renderer,S=(A,I,O)=>v.g(A).attr({zIndex:O}).addClass(`highcharts-${p.toLowerCase()}${I} `+(this.isRadial?`highcharts-radial-axis${I} `:"")+(x.className||"")).add(o);this.axisGroup||(this.gridGroup=S("grid","-grid",x.gridZIndex),this.axisGroup=S("axis","",x.zIndex),this.labelGroup=S("axis-labels","-labels",x.labels.zIndex))}getOffset(){let o=this,{chart:u,horiz:p,options:x,side:v,ticks:S,tickPositions:A,coll:I}=o,O=u.inverted&&!o.isZAxis?[1,0,3,2][v]:v,N=o.hasData(),z=x.title,j=x.labels,q=Fi(x.crossing),K=u.axisOffset,se=u.clipOffset,re=[-1,1,1,-1][v],te,ce=0,fe,Xe=0,Ne=0,$e,mt;if(o.showAxis=te=N||x.showEmpty,o.staggerLines=o.horiz&&j.staggerLines||void 0,o.createGroups(),N||o.isLinked?(A.forEach(function(tt){o.generateTick(tt)}),o.renderUnsquish(),o.reserveSpaceDefault=v===0||v===2||{1:"left",3:"right"}[v]===o.labelAlign,rr(j.reserveSpace,!q&&null,o.labelAlign==="center"||null,o.reserveSpaceDefault)&&A.forEach(function(tt){Ne=Math.max(S[tt].getLabelSize(),Ne)}),o.staggerLines&&(Ne*=o.staggerLines),o.labelOffset=Ne*(o.opposite?-1:1)):Wa(S,function(tt,gt){tt.destroy(),delete S[gt]}),z!=null&&z.text&&z.enabled!==!1&&(o.addTitle(te),te&&!q&&z.reserveSpace!==!1&&(o.titleOffset=ce=o.axisTitle.getBBox()[p?"height":"width"],Xe=Ar(fe=z.offset)?0:rr(z.margin,p?5:10))),o.renderLine(),o.offset=re*rr(x.offset,K[v]?K[v]+(x.margin||0):0),o.tickRotCorr=o.tickRotCorr||{x:0,y:0},mt=v===0?-o.labelMetrics().h:v===2?o.tickRotCorr.y:0,$e=Math.abs(Ne)+Xe,Ne&&($e-=mt,$e+=re*(p?rr(j.y,o.tickRotCorr.y+re*j.distance):rr(j.x,re*j.distance))),o.axisTitleMargin=rr(fe,$e),o.getMaxLabelDimensions&&(o.maxLabelDimensions=o.getMaxLabelDimensions(S,A)),I!=="colorAxis"&&se){let tt=this.tickSize("tick");K[v]=Math.max(K[v],(o.axisTitleMargin||0)+ce+re*o.offset,$e,A!=null&&A.length&&tt?tt[0]+re*o.offset:0);let gt=!o.axisLine||x.offset?0:o.axisLine.strokeWidth()/2;se[O]=Math.max(se[O],gt)}Zr(this,"afterGetOffset")}getLinePath(o){let u=this.chart,p=this.opposite,x=this.offset,v=this.horiz,S=this.left+(p?this.width:0)+x,A=u.chartHeight-this.bottom-(p?this.height:0)+x;return p&&(o*=-1),u.renderer.crispLine([["M",v?this.left:S,v?A:this.top],["L",v?u.chartWidth-this.right:S,v?A:u.chartHeight-this.bottom]],o)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(o){let u=this.horiz,p=this.left,x=this.top,v=this.len,S=this.options.title,A=u?p:x,I=this.opposite,O=this.offset,N=S.x,z=S.y,j=this.chart.renderer.fontMetrics(o),q=o?Math.max(o.getBBox(!1,0).height-j.h-1,0):0,K={low:A+(u?0:v),middle:A+v/2,high:A+(u?v:0)}[S.align],se=(u?x+this.height:p)+(u?1:-1)*(I?-1:1)*(this.axisTitleMargin||0)+[-q,q,j.f,-q][this.side],re={x:u?K+N:se+(I?this.width:0)+O+N,y:u?se+z-(I?this.height:0)+O:K+z};return Zr(this,"afterGetTitlePosition",{titlePosition:re}),re}renderMinorTick(o,u){let p=this.minorTicks;p[o]||(p[o]=new ba(this,o,"minor")),u&&p[o].isNew&&p[o].render(null,!0),p[o].render(null,!1,1)}renderTick(o,u,p){var S;let x=this.isLinked,v=this.ticks;(!x||o>=this.min&&o<=this.max||(S=this.grid)!=null&&S.isColumn)&&(v[o]||(v[o]=new ba(this,o)),p&&v[o].isNew&&v[o].render(u,!0,-1),v[o].render(u))}render(){let o,u,p=this,x=p.chart,v=p.logarithmic,S=x.renderer,A=p.options,I=p.isLinked,O=p.tickPositions,N=p.axisTitle,z=p.ticks,j=p.minorTicks,q=p.alternateBands,K=A.stackLabels,se=A.alternateGridColor,re=A.crossing,te=p.tickmarkOffset,ce=p.axisLine,fe=p.showAxis,Xe=vr(S.globalAnimation);if(p.labelEdge.length=0,p.overlap=!1,[z,j,q].forEach(function(Ne){Wa(Ne,function($e){$e.isActive=!1})}),Fi(re)){let Ne=this.isXAxis?x.yAxis[0]:x.xAxis[0],$e=[1,-1,-1,1][this.side];if(Ne){let mt=Ne.toPixels(re,!0);p.horiz&&(mt=Ne.len-mt),p.offset=$e*mt}}if(p.hasData()||I){let Ne=p.chart.hasRendered&&p.old&&Fi(p.old.min);p.minorTickInterval&&!p.categories&&p.getMinorTickPositions().forEach(function($e){p.renderMinorTick($e,Ne)}),O.length&&(O.forEach(function($e,mt){p.renderTick($e,mt,Ne)}),te&&(p.min===0||p.single)&&(z[-1]||(z[-1]=new ba(p,-1,null,!0)),z[-1].render(-1))),se&&O.forEach(function($e,mt){u=O[mt+1]!==void 0?O[mt+1]+te:p.max-te,mt%2==0&&$e<p.max&&u<=p.max+(x.polar?-te:te)&&(q[$e]||(q[$e]=new ke.PlotLineOrBand(p,{})),o=$e+te,q[$e].options={from:v?v.lin2log(o):o,to:v?v.lin2log(u):u,color:se,className:"highcharts-alternate-grid"},q[$e].render(),q[$e].isActive=!0)}),p._addedPlotLB||(p._addedPlotLB=!0,(A.plotLines||[]).concat(A.plotBands||[]).forEach(function($e){p.addPlotBandOrLine($e)}))}[z,j,q].forEach(function(Ne){let $e=[],mt=Xe.duration;Wa(Ne,function(tt,gt){tt.isActive||(tt.render(gt,!1,0),tt.isActive=!1,$e.push(gt))}),su(function(){let tt=$e.length;for(;tt--;)Ne[$e[tt]]&&!Ne[$e[tt]].isActive&&(Ne[$e[tt]].destroy(),delete Ne[$e[tt]])},Ne!==q&&x.hasRendered&&mt?mt:0)}),ce&&(ce[ce.isPlaced?"animate":"attr"]({d:this.getLinePath(ce.strokeWidth())}),ce.isPlaced=!0,ce[fe?"show":"hide"](fe)),N&&fe&&(N[N.isNew?"attr":"animate"](p.getTitlePosition(N)),N.isNew=!1),K!=null&&K.enabled&&p.stacking&&p.stacking.renderStackTotals(),p.old={len:p.len,max:p.max,min:p.min,transA:p.transA,userMax:p.userMax,userMin:p.userMin},p.isDirty=!1,Zr(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(o){o.render()})),this.series.forEach(function(o){o.isDirty=!0})}getKeepProps(){return this.keepProps||Ha.keepProps}destroy(o){let u=this,p=u.plotLinesAndBands,x=this.eventOptions;if(Zr(this,"destroy",{keepEvents:o}),o||nu(u),[u.ticks,u.minorTicks,u.alternateBands].forEach(function(v){ac(v)}),p){let v=p.length;for(;v--;)p[v].destroy()}for(let v in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(S){u[S]&&(u[S]=u[S].destroy())}),u.plotLinesAndBandsGroups)u.plotLinesAndBandsGroups[v]=u.plotLinesAndBandsGroups[v].destroy();Wa(u,function(v,S){u.getKeepProps().indexOf(S)===-1&&delete u[S]}),this.eventOptions=x}drawCrosshair(o,u){var z;let p=this.crosshair,x=(p==null?void 0:p.snap)??!0,v=this.chart,S,A,I,O=this.cross,N;if(Zr(this,"drawCrosshair",{e:o,point:u}),o||(o=(z=this.cross)==null?void 0:z.e),p&&(Ar(u)||!x)!==!1){if(x?Ar(u)&&(A=rr(this.coll!=="colorAxis"?u.crosshairPos:null,this.isXAxis?u.plotX:this.len-u.plotY)):A=o&&(this.horiz?o.chartX-this.pos:this.len-o.chartY+this.pos),Ar(A)&&(N={value:u&&(this.isXAxis?u.x:rr(u.stackY,u.y)),translatedValue:A},v.polar&&$a(N,{isCrosshair:!0,chartX:o==null?void 0:o.chartX,chartY:o==null?void 0:o.chartY,point:u}),S=this.getPlotLinePath(N)||null),!Ar(S)){this.hideCrosshair();return}I=this.categories&&!this.isRadial,O||(this.cross=O=v.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(I?"category ":"thin ")+(p.className||"")).attr({zIndex:rr(p.zIndex,2)}).add(),!v.styledMode&&(O.attr({stroke:p.color||(I?st.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":rr(p.width,1)}).css({"pointer-events":"none"}),p.dashStyle&&O.attr({dashstyle:p.dashStyle}))),O.show().attr({d:S}),I&&!p.width&&O.attr({"stroke-width":this.transA}),this.cross.e=o}else this.hideCrosshair();Zr(this,"afterDrawCrosshair",{e:o,point:u})}hideCrosshair(){this.cross&&this.cross.hide(),Zr(this,"afterHideCrosshair")}update(o,u){let p=this.chart;o=Ga(this.userOptions,o),this.destroy(!0),this.init(p,o),p.isDirtyBox=!0,rr(u,!0)&&p.redraw()}remove(o){let u=this.chart,p=this.coll,x=this.series,v=x.length;for(;v--;)x[v]&&x[v].remove(!1);ru(u.axes,this),ru(u[p]||[],this),u.orderItems(p),this.destroy(),u.isDirtyBox=!0,rr(o,!0)&&u.redraw()}setTitle(o,u){this.update({title:o},u)}setCategories(o,u){this.update({categories:o},u)}}Ha.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"];let{addEvent:km,getMagnitude:Yf,normalizeTickInterval:hc,timeUnits:uc}=xe;(function(R){function o(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function u(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new p(this))}R.compose=function(x){return x.keepProps.includes("dateTime")||(x.keepProps.push("dateTime"),x.prototype.getTimeTicks=o,km(x,"afterSetType",u)),x};class p{constructor(v){this.axis=v}normalizeTimeTickInterval(v,S){let A=S||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],I=A[A.length-1],O=uc[I[0]],N=I[1],z;for(z=0;z<A.length&&(O=uc[(I=A[z])[0]],N=I[1],!A[z+1]||!(v<=(O*N[N.length-1]+uc[A[z+1][0]])/2));z++);O===uc.year&&v<5*O&&(N=[1,2,5]);let j=hc(v/O,N,I[0]==="year"?Math.max(Yf(v/O),1):1);return{unitRange:O,count:j,unitName:I[0]}}getXDateFormat(v,S){let{axis:A}=this,I=A.chart.time;return A.closestPointRange?I.getDateFormat(A.closestPointRange,v,A.options.startOfWeek,S)||I.resolveDTLFormat(S.year).main:I.resolveDTLFormat(S.day).main}}R.Additions=p})($||($={}));let Ed=$,{addEvent:ou,normalizeTickInterval:au,pick:nh}=xe;(function(R){function o(){this.type!=="logarithmic"?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new p(this))}function u(){let x=this.logarithmic;x&&(this.lin2val=function(v){return x.lin2log(v)},this.val2lin=function(v){return x.log2lin(v)})}R.compose=function(x){return x.keepProps.includes("logarithmic")||(x.keepProps.push("logarithmic"),ou(x,"afterSetType",o),ou(x,"afterInit",u)),x};class p{constructor(v){this.axis=v}getLogTickPositions(v,S,A,I){let O=this.axis,N=O.len,z=O.options,j=[];if(I||(this.minorAutoInterval=void 0),v>=.5)v=Math.round(v),j=O.getLinearTickPositions(v,S,A);else if(v>=.08){let q,K,se,re,te,ce,fe,Xe=Math.floor(S);for(q=v>.3?[1,2,4]:v>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],K=Xe;K<A+1&&!fe;K++)for(se=0,re=q.length;se<re&&!fe;se++)(te=this.log2lin(this.lin2log(K)*q[se]))>S&&(!I||ce<=A)&&ce!==void 0&&j.push(ce),ce>A&&(fe=!0),ce=te}else{let q=this.lin2log(S),K=this.lin2log(A),se=I?O.getMinorTickInterval():z.tickInterval,re=z.tickPixelInterval/(I?5:1),te=I?N/O.tickPositions.length:N;v=au(v=nh(se==="auto"?null:se,this.minorAutoInterval,(K-q)*re/(te||1))),j=O.getLinearTickPositions(v,q,K).map(this.log2lin),I||(this.minorAutoInterval=v/5)}return I||(O.tickInterval=v),j}lin2log(v){return Math.pow(10,v)}log2lin(v){return Math.log(v)/Math.LN10}}R.Additions=p})(Z||(Z={}));let sh=Z,{erase:Sd,extend:Kf,isNumber:lu}=xe;(function(R){let o;function u(O){return this.addPlotBandOrLine(O,"plotBands")}function p(O,N){let z=this.userOptions,j=new o(this,O);if(this.visible&&(j=j.render()),j){if(this._addedPlotLB||(this._addedPlotLB=!0,(z.plotLines||[]).concat(z.plotBands||[]).forEach(q=>{this.addPlotBandOrLine(q)})),N){let q=z[N]||[];q.push(O),z[N]=q}this.plotLinesAndBands.push(j)}return j}function x(O){return this.addPlotBandOrLine(O,"plotLines")}function v(O,N,z){z=z||this.options;let j=this.getPlotLinePath({value:N,force:!0,acrossPanes:z.acrossPanes}),q=[],K=this.horiz,se=!lu(this.min)||!lu(this.max)||O<this.min&&N<this.min||O>this.max&&N>this.max,re=this.getPlotLinePath({value:O,force:!0,acrossPanes:z.acrossPanes}),te,ce=1,fe;if(re&&j)for(se&&(fe=re.toString()===j.toString(),ce=0),te=0;te<re.length;te+=2){let Xe=re[te],Ne=re[te+1],$e=j[te],mt=j[te+1];(Xe[0]==="M"||Xe[0]==="L")&&(Ne[0]==="M"||Ne[0]==="L")&&($e[0]==="M"||$e[0]==="L")&&(mt[0]==="M"||mt[0]==="L")&&(K&&$e[1]===Xe[1]?($e[1]+=ce,mt[1]+=ce):K||$e[2]!==Xe[2]||($e[2]+=ce,mt[2]+=ce),q.push(["M",Xe[1],Xe[2]],["L",Ne[1],Ne[2]],["L",mt[1],mt[2]],["L",$e[1],$e[2]],["Z"])),q.isFlat=fe}return q}function S(O){this.removePlotBandOrLine(O)}function A(O){let N=this.plotLinesAndBands,z=this.options,j=this.userOptions;if(N){let q=N.length;for(;q--;)N[q].id===O&&N[q].destroy();[z.plotLines||[],j.plotLines||[],z.plotBands||[],j.plotBands||[]].forEach(function(K){var se;for(q=K.length;q--;)((se=K[q])==null?void 0:se.id)===O&&Sd(K,K[q])})}}function I(O){this.removePlotBandOrLine(O)}R.compose=function(O,N){let z=N.prototype;return z.addPlotBand||(o=O,Kf(z,{addPlotBand:u,addPlotLine:x,addPlotBandOrLine:p,getPlotBandPath:v,removePlotBand:S,removePlotLine:I,removePlotBandOrLine:A})),N}})(J||(J={}));let Jf=J,{addEvent:qa,arrayMax:Cd,arrayMin:Ad,defined:Zo,destroyObjectProperties:Qf,erase:Md,fireEvent:ep,merge:Id,objectEach:gs,pick:Pm}=xe;class oh{static compose(o,u){return qa(o,"afterInit",function(){this.labelCollectors.push(()=>{var x;let p=[];for(let v of this.axes)for(let{label:S,options:A}of v.plotLinesAndBands)S&&!((x=A==null?void 0:A.label)!=null&&x.allowOverlap)&&p.push(S);return p})}),Jf.compose(oh,u)}constructor(o,u){this.axis=o,this.options=u,this.id=u.id}render(){ep(this,"render");let{axis:o,options:u}=this,{horiz:p,logarithmic:x}=o,{color:v,events:S,zIndex:A=0}=u,{renderer:I,time:O}=o.chart,N={},z=O.parse(u.to),j=O.parse(u.from),q=O.parse(u.value),K=u.borderWidth,se=u.label,{label:re,svgElem:te}=this,ce=[],fe,Xe=Zo(j)&&Zo(z),Ne=Zo(q),$e=!te,mt={class:"highcharts-plot-"+(Xe?"band ":"line ")+(u.className||"")},tt=Xe?"bands":"lines";if(!o.chart.styledMode&&(Ne?(mt.stroke=v||"#999999",mt["stroke-width"]=Pm(u.width,1),u.dashStyle&&(mt.dashstyle=u.dashStyle)):Xe&&(mt.fill=v||"#e6e9ff",K&&(mt.stroke=u.borderColor,mt["stroke-width"]=K))),N.zIndex=A,tt+="-"+A,(fe=o.plotLinesAndBandsGroups[tt])||(o.plotLinesAndBandsGroups[tt]=fe=I.g("plot-"+tt).attr(N).add()),te||(this.svgElem=te=I.path().attr(mt).add(fe)),Zo(q))ce=o.getPlotLinePath({value:(x==null?void 0:x.log2lin(q))??q,lineWidth:te.strokeWidth(),acrossPanes:u.acrossPanes});else{if(!(Zo(j)&&Zo(z)))return;ce=o.getPlotBandPath((x==null?void 0:x.log2lin(j))??j,(x==null?void 0:x.log2lin(z))??z,u)}return!this.eventsAdded&&S&&(gs(S,(gt,Bt)=>{te==null||te.on(Bt,Jt=>{S[Bt].apply(this,[Jt])})}),this.eventsAdded=!0),($e||!te.d)&&(ce!=null&&ce.length)?te.attr({d:ce}):te&&(ce?(te.show(),te.animate({d:ce})):te.d&&(te.hide(),re&&(this.label=re=re.destroy()))),se&&(Zo(se.text)||Zo(se.formatter))&&(ce!=null&&ce.length)&&o.width>0&&o.height>0&&!ce.isFlat?(se=Id({align:p&&Xe?"center":void 0,x:p?!Xe&&4:10,verticalAlign:!p&&Xe?"middle":void 0,y:p?Xe?16:10:Xe?6:-4,rotation:p&&!Xe?90:0,...Xe?{inside:!0}:{}},se),this.renderLabel(se,ce,Xe,A)):re&&re.hide(),this}renderLabel(o,u,p,x){var K;let v=this.axis,S=v.chart.renderer,A=o.inside,I=this.label;I||(this.label=I=S.text(this.getLabelText(o),0,0,o.useHTML).attr({align:o.textAlign||o.align,rotation:o.rotation,class:"highcharts-plot-"+(p?"band":"line")+"-label "+(o.className||""),zIndex:x}),v.chart.styledMode||I.css(Id({fontSize:"0.8em",textOverflow:p&&!A?"":"ellipsis"},o.style)),I.add());let O=u.xBounds||[u[0][1],u[1][1],p?u[2][1]:u[0][1]],N=u.yBounds||[u[0][2],u[1][2],p?u[2][2]:u[0][2]],z=Ad(O),j=Ad(N),q=Cd(O)-z;I.align(o,!1,{x:z,y:j,width:q,height:Cd(N)-j}),I.alignAttr.y-=S.fontMetrics(I).b,(!I.alignValue||I.alignValue==="left"||Zo(A))&&I.css({width:(((K=o.style)==null?void 0:K.width)||(p&&A?q:I.rotation===90?v.height-(I.alignAttr.y-v.top):(o.clip?v.width:v.chart.chartWidth)-(I.alignAttr.x-v.left)))+"px"}),I.show(!0)}getLabelText(o){return Zo(o.formatter)?o.formatter.call(this):o.text}destroy(){Md(this.axis.plotLinesAndBands,this),delete this.axis,Qf(this)}}let{animObject:Lm}=Cn,{format:tp}=fs,{composed:ro,dateFormats:ip,doc:rp,isSafari:Co}=ke,{distribute:Yo}=Ua,{addEvent:vl,clamp:Ta,css:yi,discardElement:kd,extend:Pd,fireEvent:bl,getAlignFactor:Xa,isArray:li,isNumber:Ld,isObject:Dm,isString:cu,merge:Dd,pick:wl,pushUnique:np,splat:Od,syncTimeout:Om}=xe;class ah{constructor(o,u,p){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=o,this.init(o,u),this.pointer=p}bodyFormatter(o){return o.map(u=>{let p=u.series.tooltipOptions,x=u.formatPrefix||"point";return(p[x+"Formatter"]||u.tooltipFormatter).call(u,p[x+"Format"]||"")})}cleanSplit(o){this.chart.series.forEach(function(u){let p=u==null?void 0:u.tt;p&&(!p.isActive||o?u.tt=p.destroy():p.isActive=!1)})}defaultFormatter(o){let u,p=this.points||Od(this);return(u=(u=[o.headerFooterFormatter(p[0])]).concat(o.bodyFormatter(p))).push(o.headerFooterFormatter(p[0],!0)),u}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),kd(this.container)),xe.clearTimeout(this.hideTimer)}getAnchor(o,u){var O;let p,{chart:x,pointer:v}=this,S=x.inverted,A=x.plotTop,I=x.plotLeft;if(o=Od(o),(O=o[0].series)!=null&&O.yAxis&&!o[0].series.yAxis.options.reversedStacks&&(o=o.slice().reverse()),this.followPointer&&u)u.chartX===void 0&&(u=v.normalize(u)),p=[u.chartX-I,u.chartY-A];else if(o[0].tooltipPos)p=o[0].tooltipPos;else{let N=0,z=0;o.forEach(function(j){let q=j.pos(!0);q&&(N+=q[0],z+=q[1])}),N/=o.length,z/=o.length,this.shared&&o.length>1&&u&&(S?N=u.chartX:z=u.chartY),p=[N-I,z-A]}return p.map(Math.round)}getClassName(o,u,p){let x=this.options,v=o.series,S=v.options;return[x.className,"highcharts-label",p&&"highcharts-tooltip-header",u?"highcharts-tooltip-box":"highcharts-tooltip",!p&&"highcharts-color-"+wl(o.colorIndex,v.colorIndex),S==null?void 0:S.className].filter(cu).join(" ")}getLabel({anchorX:o,anchorY:u}={anchorX:0,anchorY:0}){let p=this,x=this.chart.styledMode,v=this.options,S=this.split&&this.allowShared,A=this.container,I=this.chart.renderer;if(this.label){let O=!this.label.hasClass("highcharts-label");(!S&&O||S&&!O)&&this.destroy()}if(!this.label){if(this.outside){let O=this.chart,N=O.options.chart.style,z=vo.getRendererType();this.container=A=ke.doc.createElement("div"),A.className="highcharts-tooltip-container "+(O.renderTo.className.match(/(highcharts[a-zA-Z0-9-]+)\s?/gm)||""),yi(A,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,((N==null?void 0:N.zIndex)||0)+3)}),this.renderer=I=new z(A,0,0,N,void 0,void 0,I.styledMode)}if(S?this.label=I.g("tooltip"):(this.label=I.label("",o,u,v.shape||"callout",void 0,void 0,v.useHTML,void 0,"tooltip").attr({padding:v.padding,r:v.borderRadius}),x||this.label.attr({fill:v.backgroundColor,"stroke-width":v.borderWidth||0}).css(v.style).css({pointerEvents:v.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),p.outside){let O=this.label;[O.xSetter,O.ySetter].forEach((N,z)=>{O[z?"ySetter":"xSetter"]=j=>{N.call(O,p.distance),O[z?"y":"x"]=j,A&&(A.style[z?"top":"left"]=`${j}px`)}})}this.label.attr({zIndex:8}).shadow(v.shadow??!v.fixed).add()}return A&&!A.parentElement&&ke.doc.body.appendChild(A),this.label}getPlayingField(){let{body:o,documentElement:u}=rp,{chart:p,distance:x,outside:v}=this;return{width:v?Math.max(o.scrollWidth,u.scrollWidth,o.offsetWidth,u.offsetWidth,u.clientWidth)-2*x-2:p.chartWidth,height:v?Math.max(o.scrollHeight,u.scrollHeight,o.offsetHeight,u.offsetHeight,u.clientHeight):p.chartHeight}}getPosition(o,u,p){var gi,Ui;let{distance:x,chart:v,outside:S,pointer:A}=this,{inverted:I,plotLeft:O,plotTop:N,polar:z}=v,{plotX:j=0,plotY:q=0}=p,K={},se=I&&p.h||0,{height:re,width:te}=this.getPlayingField(),ce=A.getChartPosition(),fe=wi=>wi*ce.scaleX,Xe=wi=>wi*ce.scaleY,Ne=wi=>{let ji=wi==="x";return[wi,ji?te:re,ji?o:u].concat(S?[ji?fe(o):Xe(u),ji?ce.left-x+fe(j+O):ce.top-x+Xe(q+N),0,ji?te:re]:[ji?o:u,ji?j+O:q+N,ji?O:N,ji?O+v.plotWidth:N+v.plotHeight])},$e=Ne("y"),mt=Ne("x"),tt,gt=!!p.negative;!z&&((Ui=(gi=v.hoverSeries)==null?void 0:gi.yAxis)!=null&&Ui.reversed)&&(gt=!gt);let Bt=!this.followPointer&&wl(p.ttBelow,!z&&!I===gt),Jt=function(wi,ji,_r,lr,br,Cs,yr){let Br=S?wi==="y"?Xe(x):fe(x):x,qi=(_r-lr)/2,pi=lr<br-x,kn=br+x+lr<ji,Fr=br-Br-_r+qi,Jr=br+Br-qi;if(Bt&&kn)K[wi]=Jr;else if(!Bt&&pi)K[wi]=Fr;else if(pi)K[wi]=Math.min(yr-lr,Fr-se<0?Fr:Fr-se);else{if(!kn)return K[wi]=0,!1;K[wi]=Math.max(Cs,Jr+se+_r>ji?Jr:Jr+se)}},ii=function(wi,ji,_r,lr,br){if(br<x||br>ji-x)return!1;br<_r/2?K[wi]=1:br>ji-lr/2?K[wi]=ji-lr-2:K[wi]=br-_r/2},Ft=function(wi){[$e,mt]=[mt,$e],tt=wi},ui=()=>{Jt.apply(0,$e)!==!1?ii.apply(0,mt)!==!1||tt||(Ft(!0),ui()):tt?K.x=K.y=0:(Ft(!0),ui())};return(I&&!z||this.len>1)&&Ft(),ui(),K}getFixedPosition(o,u,p){var j;let x=p.series,{chart:v,options:S,split:A}=this,I=S.position,O=I.relativeTo,N=S.shared||(j=x==null?void 0:x.yAxis)!=null&&j.isRadial&&(O==="pane"||!O)?"plotBox":O,z=N==="chart"?v.renderer:v[N]||v.getClipBox(x,!0);return{x:z.x+(z.width-o)*Xa(I.align)+I.x,y:z.y+(z.height-u)*Xa(I.verticalAlign)+(!A&&I.y||0)}}hide(o){let u=this;xe.clearTimeout(this.hideTimer),o=wl(o,this.options.hideDelay),this.isHidden||(this.hideTimer=Om(function(){let p=u.getLabel();u.getLabel().animate({opacity:0},{duration:o&&150,complete:()=>{p.hide(),u.container&&u.container.remove()}}),u.isHidden=!0},o))}init(o,u){this.chart=o,this.options=u,this.crosshairs=[],this.isHidden=!0,this.split=u.split&&!o.inverted&&!o.polar,this.shared=u.shared||this.split,this.outside=wl(u.outside,!!(o.scrollablePixelsX||o.scrollablePixelsY))}shouldStickOnContact(o){return!!(!this.followPointer&&this.options.stickOnContact&&(!o||this.pointer.inClass(o.target,"highcharts-tooltip")))}move(o,u,p,x){let{followPointer:v,options:S}=this,A=Lm(!v&&!this.isHidden&&!S.fixed&&S.animation),I=v||(this.len||0)>1,O={x:o,y:u};I?O.anchorX=O.anchorY=NaN:(O.anchorX=p,O.anchorY=x),A.step=()=>this.drawTracker(),this.getLabel().animate(O,A)}refresh(o,u){let{chart:p,options:x,pointer:v,shared:S}=this,A=Od(o),I=A[0],O=x.format,N=x.formatter||this.defaultFormatter,z=p.styledMode,j=this.allowShared;if(!x.enabled||!I.series)return;xe.clearTimeout(this.hideTimer),this.allowShared=!(!li(o)&&o.series&&o.series.noSharedTooltip),j=j&&!this.allowShared,this.followPointer=!this.split&&I.series.tooltipOptions.followPointer;let q=this.getAnchor(o,u),K=q[0],se=q[1];S&&this.allowShared&&(v.applyInactiveState(A),A.forEach(ce=>ce.setState("hover")),I.points=A),this.len=A.length;let re=cu(O)?tp(O,I,p):N.call(I,this);I.points=void 0;let te=I.series;if(this.distance=wl(te.tooltipOptions.distance,16),re===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(re,A);else{let ce=K,fe=se;if(u&&v.isDirectTouch&&(ce=u.chartX-p.plotLeft,fe=u.chartY-p.plotTop),p.polar||te.options.clip===!1||A.some(Xe=>v.isDirectTouch||Xe.series.shouldShowTooltip(ce,fe))){let Xe=this.getLabel(j&&this.tt||{});(!x.style.width||z)&&Xe.css({width:(this.outside?this.getPlayingField():p.spacingBox).width+"px"}),Xe.attr({class:this.getClassName(I),text:re&&re.join?re.join(""):re}),this.outside&&Xe.attr({x:Ta(Xe.x||0,0,this.getPlayingField().width-(Xe.width||0)-1)}),z||Xe.attr({stroke:x.borderColor||I.color||te.color||"#666666"}),this.updatePosition({plotX:K,plotY:se,negative:I.negative,ttBelow:I.ttBelow,series:te,h:q[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}bl(this,"refresh")}renderSplit(o,u){var br,Cs;let p=this,{chart:x,chart:{chartWidth:v,chartHeight:S,plotHeight:A,plotLeft:I,plotTop:O,scrollablePixelsY:N=0,scrollablePixelsX:z,styledMode:j},distance:q,options:K,options:{fixed:se,position:re,positioner:te},pointer:ce}=p,{scrollLeft:fe=0,scrollTop:Xe=0}=((br=x.scrollablePlotArea)==null?void 0:br.scrollingContainer)||{},Ne=p.outside&&typeof z!="number"?rp.documentElement.getBoundingClientRect():{left:fe,right:fe+v},$e=p.getLabel(),mt=this.renderer||x.renderer,tt=!!((Cs=x.xAxis[0])!=null&&Cs.opposite),{left:gt,top:Bt}=ce.getChartPosition(),Jt=te||se,ii=O+Xe,Ft=0,ui=A-N,gi=function(yr,Br,qi,pi=[0,0],kn=!0){let Fr,Jr;if(qi.isHeader)Jr=tt?0:ui,Fr=Ta(pi[0]-yr/2,Ne.left,Ne.right-yr-(p.outside?gt:0));else if(se&&qi){let an=p.getFixedPosition(yr,Br,qi);Fr=an.x,Jr=an.y-ii}else Jr=pi[1]-ii,Fr=Ta(Fr=kn?pi[0]-yr-q:pi[0]+q,kn?Fr:Ne.left,Ne.right);return{x:Fr,y:Jr}};cu(o)&&(o=[!1,o]);let Ui=o.slice(0,u.length+1).reduce(function(yr,Br,qi){if(Br!==!1&&Br!==""){let pi=u[qi-1]||{isHeader:!0,plotX:u[0].plotX,plotY:A,series:{}},kn=pi.isHeader,Fr=kn?p:pi.series,Jr=Fr.tt=function(qs,Xn,mf){let Tc=qs,{isHeader:gh,series:gf}=Xn,Da=gf.tooltipOptions||K;if(!Tc){let Mu={padding:Da.padding,r:Da.borderRadius};j||(Mu.fill=Da.backgroundColor,Mu["stroke-width"]=Da.borderWidth??(se&&!gh?0:1)),Tc=mt.label("",0,0,Da[gh?"headerShape":"shape"]||(se&&!gh?"rect":"callout"),void 0,void 0,Da.useHTML).addClass(p.getClassName(Xn,!0,gh)).attr(Mu).add($e)}return Tc.isActive=!0,Tc.attr({text:mf}),j||Tc.css(Da.style).attr({stroke:Da.borderColor||Xn.color||gf.color||"#333333"}),Tc}(Fr.tt,pi,Br.toString()),an=Jr.getBBox(),co=an.width+Jr.strokeWidth();kn&&(Ft=an.height,ui+=Ft,tt&&(ii-=Ft));let{anchorX:Lo,anchorY:ia}=function(qs){let Xn,mf,{isHeader:Tc,plotX:gh=0,plotY:gf=0,series:Da}=qs;if(Tc)Xn=Math.max(I+gh,I),mf=O+A/2;else{let{xAxis:Mu,yAxis:_f}=Da;Xn=Mu.pos+Ta(gh,-q,Mu.len+q),Da.shouldShowTooltip(0,_f.pos-O+gf,{ignoreX:!0})&&(mf=_f.pos+gf)}return{anchorX:Xn=Ta(Xn,Ne.left-q,Ne.right+q),anchorY:mf}}(pi);if(typeof ia=="number"){let qs=an.height+1,Xn=(te||gi).call(p,co,qs,pi,[Lo,ia]);yr.push({align:Jt?0:void 0,anchorX:Lo,anchorY:ia,boxWidth:co,point:pi,rank:wl(Xn.rank,+!!kn),size:qs,target:Xn.y,tt:Jr,x:Xn.x})}else Jr.isActive=!1}return yr},[]);!Jt&&Ui.some(yr=>{let{outside:Br}=p,qi=(Br?gt:0)+yr.anchorX;return qi<Ne.left&&qi+yr.boxWidth<Ne.right||qi<gt-Ne.left+yr.boxWidth&&Ne.right-qi>qi})&&(Ui=Ui.map(yr=>{let{x:Br,y:qi}=gi.call(this,yr.boxWidth,yr.size,yr.point,[yr.anchorX,yr.anchorY],!1);return Pd(yr,{target:qi,x:Br})})),p.cleanSplit(),Yo(Ui,ui);let wi={left:gt,right:gt};Ui.forEach(function(yr){let{x:Br,boxWidth:qi,isHeader:pi}=yr;!pi&&(p.outside&&gt+Br<wi.left&&(wi.left=gt+Br),!pi&&p.outside&&wi.left+qi>wi.right&&(wi.right=gt+Br))}),Ui.forEach(function(yr){let{x:Br,anchorX:qi,anchorY:pi,pos:kn,point:{isHeader:Fr}}=yr,Jr={visibility:kn===void 0?"hidden":"inherit",x:Br,y:(kn||0)+ii+(se&&re.y||0),anchorX:qi,anchorY:pi};if(p.outside&&Br<qi){let an=gt-wi.left;an>0&&(Fr||(Jr.x=Br+an,Jr.anchorX=qi+an),Fr&&(Jr.x=(wi.right-wi.left)/2,Jr.anchorX=qi+an))}yr.tt.attr(Jr)});let{container:ji,outside:_r,renderer:lr}=p;if(_r&&ji&&lr){let{width:yr,height:Br,x:qi,y:pi}=$e.getBBox();lr.setSize(yr+qi,Br+pi,!1),ji.style.left=wi.left+"px",ji.style.top=Bt+"px"}Co&&$e.attr({opacity:$e.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let o=this.chart,u=this.label,p=this.shared?o.hoverPoints:o.hoverPoint;if(!u||!p)return;let x={x:0,y:0,width:0,height:0},v=this.getAnchor(p),S=u.getBBox();v[0]+=o.plotLeft-(u.translateX||0),v[1]+=o.plotTop-(u.translateY||0),x.x=Math.min(0,v[0]),x.y=Math.min(0,v[1]),x.width=v[0]<0?Math.max(Math.abs(v[0]),S.width-v[0]):Math.max(Math.abs(v[0]),S.width),x.height=v[1]<0?Math.max(Math.abs(v[1]),S.height-Math.abs(v[1])):Math.max(Math.abs(v[1]),S.height),this.tracker?this.tracker.attr(x):(this.tracker=u.renderer.rect(x).addClass("highcharts-tracker").add(u),o.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(o){return o.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}headerFooterFormatter(o,u){let p=o.series,x=p.tooltipOptions,v=p.xAxis,S=v==null?void 0:v.dateTime,A={isFooter:u,point:o},I=x.xDateFormat||"",O=x[u?"footerFormat":"headerFormat"];return bl(this,"headerFormatter",A,function(N){if(S&&!I&&Ld(o.key)&&(I=S.getXDateFormat(o.key,x.dateTimeLabelFormats)),S&&I){if(Dm(I)){let z=I;ip[0]=j=>p.chart.time.dateFormat(z,j),I="%0"}(o.tooltipDateKeys||["key"]).forEach(z=>{O=O.replace(RegExp("point\\."+z+"([ \\)}])"),`(point.${z}:${I})$1`)})}p.chart.styledMode&&(O=this.styledModeFormat(O)),N.text=tp(O,o,this.chart)}),A.text||""}update(o){this.destroy(),this.init(this.chart,Dd(!0,this.options,o))}updatePosition(o){var Ne;let{chart:u,container:p,distance:x,options:v,pointer:S,renderer:A}=this,{height:I=0,width:O=0}=this.getLabel(),{fixed:N,positioner:z}=v,{left:j,top:q,scaleX:K,scaleY:se}=S.getChartPosition(),re=(z||N&&this.getFixedPosition||this.getPosition).call(this,O,I,o),te=ke.doc,ce=(o.plotX||0)+u.plotLeft,fe=(o.plotY||0)+u.plotTop,Xe;if(A&&p){if(z||N){let{scrollLeft:$e=0,scrollTop:mt=0}=((Ne=u.scrollablePlotArea)==null?void 0:Ne.scrollingContainer)||{};re.x+=$e+j-x,re.y+=mt+q-x}Xe=(v.borderWidth||0)+2*x+2,A.setSize(Ta(O+Xe,0,te.documentElement.clientWidth)-1,I+Xe,!1),(K!==1||se!==1)&&(yi(p,{transform:`scale(${K}, ${se})`}),ce*=K,fe*=se),ce+=j-re.x,fe+=q-re.y}this.move(Math.round(re.x),Math.round(re.y||0),ce,fe)}}(function(R){R.compose=function(o){np(ro,"Core.Tooltip")&&vl(o,"afterInit",function(){let u=this.chart;u.options.tooltip&&(u.tooltip=new R(u,u.options.tooltip,this))})}})(ah||(ah={}));let hu=ah,{animObject:Rd}=Cn,{defaultOptions:dc}=Le,{format:f}=fs,{addEvent:n,crisp:c,erase:g,extend:b,fireEvent:E,getNestedProperty:L,isArray:D,isFunction:F,isNumber:W,isObject:H,merge:Q,pick:he,syncTimeout:me,removeEvent:ye,uniqueKey:_e}=xe;class be{animateBeforeDestroy(){let o=this,u={x:o.startXPos,opacity:0},p=o.getGraphicalProps();p.singular.forEach(function(x){o[x]=o[x].animate(x==="dataLabel"?{x:o[x].startXPos,y:o[x].startYPos,opacity:0}:u)}),p.plural.forEach(function(x){o[x].forEach(function(v){v.element&&v.animate(b({x:o.startXPos},v.startYPos?{x:v.startXPos,y:v.startYPos}:{}))})})}applyOptions(o,u){let p=this.series,x=p.options.pointValKey||p.pointValKey;return b(this,o=be.prototype.optionsToObject.call(this,o)),this.options=this.options?b(this.options,o):o,o.group&&delete this.group,o.dataLabels&&delete this.dataLabels,x&&(this.y=be.prototype.getNestedProperty.call(this,x)),this.selected&&(this.state="select"),"name"in this&&u===void 0&&p.xAxis&&p.xAxis.hasNames&&(this.x=p.xAxis.nameToX(this)),this.x===void 0&&p?this.x=u??p.autoIncrement():W(o.x)&&p.options.relativeXValue?this.x=p.autoIncrement(o.x):typeof this.x=="string"&&(u??(u=p.chart.time.parse(this.x)),W(u)&&(this.x=u)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let o=this,u=o.series,p=u.chart,x=u.options.dataSorting,v=p.hoverPoints,S=Rd(o.series.chart.renderer.globalAnimation),A=()=>{for(let I in(o.graphic||o.graphics||o.dataLabel||o.dataLabels)&&(ye(o),o.destroyElements()),o)delete o[I]};o.legendItem&&p.legend.destroyItem(o),v&&(o.setState(),g(v,o),v.length||(p.hoverPoints=null)),o===p.hoverPoint&&o.onMouseOut(),x!=null&&x.enabled?(this.animateBeforeDestroy(),me(A,S.duration)):A(),p.pointCount--}this.destroyed=!0}destroyElements(o){let u=this,p=u.getGraphicalProps(o);p.singular.forEach(function(x){u[x]=u[x].destroy()}),p.plural.forEach(function(x){u[x].forEach(function(v){v!=null&&v.element&&v.destroy()}),delete u[x]})}firePointEvent(o,u,p){let x=this,v=this.series.options;x.manageEvent(o),o==="click"&&v.allowPointSelect&&(p=function(S){!x.destroyed&&x.select&&x.select(null,S.ctrlKey||S.metaKey||S.shiftKey)}),E(x,o,u,p)}getClassName(){var o;return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+((o=this.zone)!=null&&o.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(o){let u,p,x=this,v=[],S={singular:[],plural:[]};for((o=o||{graphic:1,dataLabel:1}).graphic&&v.push("graphic","connector"),o.dataLabel&&v.push("dataLabel","dataLabelPath","dataLabelUpper"),p=v.length;p--;)x[u=v[p]]&&S.singular.push(u);return["graphic","dataLabel"].forEach(function(A){let I=A+"s";o[A]&&x[I]&&S.plural.push(I)}),S}getNestedProperty(o){return o?o.indexOf("custom.")===0?L(o,this.options):this[o]:void 0}getZone(){let o=this.series,u=o.zones,p=o.zoneAxis||"y",x,v=0;for(x=u[0];this[p]>=x.value;)x=u[++v];return this.nonZonedColor||(this.nonZonedColor=this.color),x!=null&&x.color&&!this.options.color?this.color=x.color:this.color=this.nonZonedColor,x}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(o,u,p){this.formatPrefix="point",this.visible=!0,this.point=this,this.series=o,this.applyOptions(u,p),this.id??(this.id=_e()),this.resolveColor(),this.dataLabelOnNull??(this.dataLabelOnNull=o.options.nullInteraction),o.chart.pointCount++,E(this,"afterInit")}isValid(){return(W(this.x)||this.x instanceof Date)&&W(this.y)}optionsToObject(o){var N;let u=this.series,p=u.options.keys,x=p||u.pointArrayMap||["y"],v=x.length,S={},A,I=0,O=0;if(W(o)||o===null)S[x[0]]=o;else if(D(o))for(!p&&o.length>v&&((A=typeof o[0])=="string"?(N=u.xAxis)!=null&&N.dateTime?S.x=u.chart.time.parse(o[0]):S.name=o[0]:A==="number"&&(S.x=o[0]),I++);O<v;)p&&o[I]===void 0||(x[O].indexOf(".")>0?be.prototype.setNestedProperty(S,o[I],x[O]):S[x[O]]=o[I]),I++,O++;else typeof o=="object"&&(S=o,o.dataLabels&&(u.hasDataLabels=()=>!0),o.marker&&(u._hasPointMarkers=!0));return S}pos(o,u=this.plotY){if(!this.destroyed){let{plotX:p,series:x}=this,{chart:v,xAxis:S,yAxis:A}=x,I=0,O=0;if(W(p)&&W(u))return o&&(I=S?S.pos:v.plotLeft,O=A?A.pos:v.plotTop),v.inverted&&S&&A?[A.len-u+O,S.len-p+I]:[p+I,u+O]}}resolveColor(){let o=this.series,u=o.chart.options.chart,p=o.chart.styledMode,x,v,S=u.colorCount,A;delete this.nonZonedColor,o.options.colorByPoint?(p||(x=(v=o.options.colors||o.chart.options.colors)[o.colorCounter],S=v.length),A=o.colorCounter,o.colorCounter++,o.colorCounter===S&&(o.colorCounter=0)):(p||(x=o.color),A=o.colorIndex),this.colorIndex=he(this.options.colorIndex,A),this.color=he(this.options.color,x)}setNestedProperty(o,u,p){return p.split(".").reduce(function(x,v,S,A){let I=A.length-1===S;return x[v]=I?u:H(x[v],!0)?x[v]:{},x[v]},o),o}shouldDraw(){return!this.isNull}tooltipFormatter(o){var I;let{chart:u,pointArrayMap:p=["y"],tooltipOptions:x}=this.series,{valueDecimals:v="",valuePrefix:S="",valueSuffix:A=""}=x;return u.styledMode&&(o=((I=u.tooltip)==null?void 0:I.styledModeFormat(o))||o),p.forEach(O=>{O="{point."+O,(S||A)&&(o=o.replace(RegExp(O+"}","g"),S+O+"}"+A)),o=o.replace(RegExp(O+"}","g"),O+":,."+v+"f}")}),f(o,this,u)}update(o,u,p,x){let v,S=this,A=S.series,I=S.graphic,O=A.chart,N=A.options;function z(){S.applyOptions(o);let j=I&&S.hasMockGraphic,q=S.y===null?!j:j;I&&q&&(S.graphic=I.destroy(),delete S.hasMockGraphic),H(o,!0)&&(I!=null&&I.element&&o&&o.marker&&o.marker.symbol!==void 0&&(S.graphic=I.destroy()),o!=null&&o.dataLabels&&S.dataLabel&&(S.dataLabel=S.dataLabel.destroy())),v=S.index;let K={};for(let se of A.dataColumnKeys())K[se]=S[se];A.dataTable.setRow(K,v),N.data[v]=H(N.data[v],!0)||H(o,!0)?S.options:he(o,N.data[v]),A.isDirty=A.isDirtyData=!0,!A.fixedBox&&A.hasCartesianSeries&&(O.isDirtyBox=!0),N.legendType==="point"&&(O.isDirtyLegend=!0),u&&O.redraw(p)}u=he(u,!0),x===!1?z():S.firePointEvent("update",{options:o},z)}remove(o,u){this.series.removePoint(this.series.data.indexOf(this),o,u)}select(o,u){let p=this,x=p.series,v=x.chart;o=he(o,!p.selected),this.selectedStaging=o,p.firePointEvent(o?"select":"unselect",{accumulate:u},function(){p.selected=p.options.selected=o,x.options.data[x.data.indexOf(p)]=p.options,p.setState(o&&"select"),u||v.getSelectedPoints().forEach(function(S){let A=S.series;S.selected&&S!==p&&(S.selected=S.options.selected=!1,A.options.data[A.data.indexOf(S)]=S.options,S.setState(v.hoverPoints&&A.options.inactiveOtherPoints?"inactive":""),S.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(o){let{inverted:u,pointer:p}=this.series.chart;p&&(o=o?p.normalize(o):p.getChartCoordinatesFromPoint(this,u),p.runPointActions(o,this))}onMouseOut(){let o=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(o.hoverPoints||[]).forEach(function(u){u.setState()}),o.hoverPoints=o.hoverPoint=null}manageEvent(o){var x,v,S,A,I,O,N;let u=Q(this.series.options.point,this.options),p=(x=u.events)==null?void 0:x[o];F(p)&&(!((v=this.hcEvents)!=null&&v[o])||((A=(S=this.hcEvents)==null?void 0:S[o])==null?void 0:A.map(z=>z.fn).indexOf(p))===-1)?((I=this.importedUserEvent)==null||I.call(this),this.importedUserEvent=n(this,o,p),this.hcEvents&&(this.hcEvents[o].userEvent=!0)):this.importedUserEvent&&!p&&((O=this.hcEvents)!=null&&O[o])&&((N=this.hcEvents)!=null&&N[o].userEvent)&&(ye(this,o),delete this.hcEvents[o],Object.keys(this.hcEvents)||delete this.importedUserEvent)}setState(o,u){var $e,mt;let p=this.series,x=this.state,v=p.options.states[o||"normal"]||{},S=dc.plotOptions[p.type].marker&&p.options.marker,A=S&&S.enabled===!1,I=(($e=S==null?void 0:S.states)==null?void 0:$e[o||"normal"])||{},O=I.enabled===!1,N=this.marker||{},z=p.chart,j=S&&p.markerAttribs,q=p.halo,K,se,re,te=p.stateMarkerGraphic,ce;if((o=o||"")===this.state&&!u||this.selected&&o!=="select"||v.enabled===!1||o&&(O||A&&I.enabled===!1)||o&&N.states&&N.states[o]&&N.states[o].enabled===!1)return;if(this.state=o,j&&(K=p.markerAttribs(this,o)),this.graphic&&!this.hasMockGraphic){if(x&&this.graphic.removeClass("highcharts-point-"+x),o&&this.graphic.addClass("highcharts-point-"+o),!z.styledMode){se=p.pointAttribs(this,o),re=he(z.options.chart.animation,v.animation);let tt=se.opacity;p.options.inactiveOtherPoints&&W(tt)&&(this.dataLabels||[]).forEach(function(gt){gt&&!gt.hasClass("highcharts-data-label-hidden")&&(gt.animate({opacity:tt},re),gt.connector&&gt.connector.animate({opacity:tt},re))}),this.graphic.animate(se,re)}K&&this.graphic.animate(K,he(z.options.chart.animation,I.animation,S.animation)),te&&te.hide()}else o&&I&&(ce=N.symbol||p.symbol,te&&te.currentSymbol!==ce&&(te=te.destroy()),K&&(te?te[u?"animate":"attr"]({x:K.x,y:K.y}):ce&&(p.stateMarkerGraphic=te=z.renderer.symbol(ce,K.x,K.y,K.width,K.height,Q(S,I)).add(p.markerGroup),te.currentSymbol=ce)),!z.styledMode&&te&&this.state!=="inactive"&&te.attr(p.pointAttribs(this,o))),te&&(te[o&&this.isInside?"show":"hide"](),te.element.point=this,te.addClass(this.getClassName(),!0));let fe=v.halo,Xe=this.graphic||te,Ne=(Xe==null?void 0:Xe.visibility)||"inherit";fe!=null&&fe.size&&Xe&&Ne!=="hidden"&&!this.isCluster?(q||(p.halo=q=z.renderer.path().add(Xe.parentGroup)),q.show()[u?"animate":"attr"]({d:this.haloPath(fe.size)}),q.attr({class:"highcharts-halo highcharts-color-"+he(this.colorIndex,p.colorIndex)+(this.className?" "+this.className:""),visibility:Ne,zIndex:-1}),q.point=this,z.styledMode||q.attr(b({fill:this.color||p.color,"fill-opacity":fe.opacity},jr.filterUserAttributes(fe.attributes||{})))):(mt=q==null?void 0:q.point)!=null&&mt.haloPath&&!q.point.destroyed&&q.animate({d:q.point.haloPath(0)},null,q.hide),E(this,"afterSetState",{state:o})}haloPath(o){let u=this.pos();return u?this.series.chart.renderer.symbols.circle(c(u[0],1)-o,u[1]-o,2*o,2*o):[]}}let ee=be,{parse:pe}=st,{charts:Ce,composed:Ie,isTouchDevice:Ge}=ke,{addEvent:Fe,attr:We,css:it,extend:et,find:pt,fireEvent:Nt,isNumber:ht,isObject:Ct,objectEach:yt,offset:jt,pick:at,pushUnique:Mt,splat:Gt}=xe;class Et{applyInactiveState(o=[]){let u=[];o.forEach(p=>{let x=p.series;u.push(x),x.linkedParent&&u.push(x.linkedParent),x.linkedSeries&&u.push.apply(u,x.linkedSeries),x.navigatorSeries&&u.push(x.navigatorSeries),x.boosted&&x.markerGroup&&u.push.apply(u,this.chart.series.filter(v=>v.markerGroup===x.markerGroup))}),this.chart.series.forEach(p=>{u.indexOf(p)===-1?p.setState("inactive",!0):p.options.inactiveOtherPoints&&p.setAllPointsToState("inactive")})}destroy(){let o=this;this.eventsToUnbind.forEach(u=>u()),this.eventsToUnbind=[],!ke.chartCount&&(Et.unbindDocumentMouseUp.forEach(u=>u.unbind()),Et.unbindDocumentMouseUp.length=0,Et.unbindDocumentTouchEnd&&(Et.unbindDocumentTouchEnd=Et.unbindDocumentTouchEnd())),clearInterval(o.tooltipTimeout),yt(o,function(u,p){o[p]=void 0})}getSelectionMarkerAttrs(o,u){let p={args:{chartX:o,chartY:u},attrs:{},shapeType:"rect"};return Nt(this,"getSelectionMarkerAttrs",p,x=>{let v,{chart:S,zoomHor:A,zoomVert:I}=this,{mouseDownX:O=0,mouseDownY:N=0}=S,z=x.attrs;z.x=S.plotLeft,z.y=S.plotTop,z.width=A?1:S.plotWidth,z.height=I?1:S.plotHeight,A&&(z.width=Math.max(1,Math.abs(v=o-O)),z.x=(v>0?0:v)+O),I&&(z.height=Math.max(1,Math.abs(v=u-N)),z.y=(v>0?0:v)+N)}),p}drag(o){let{chart:u}=this,{mouseDownX:p=0,mouseDownY:x=0}=u,{panning:v,panKey:S,selectionMarkerFill:A}=u.options.chart,I=u.plotLeft,O=u.plotTop,N=u.plotWidth,z=u.plotHeight,j=Ct(v)?v.enabled:v,q=S&&o[`${S}Key`],K=o.chartX,se=o.chartY,re,te=this.selectionMarker;if((!te||!te.touch)&&(K<I?K=I:K>I+N&&(K=I+N),se<O?se=O:se>O+z&&(se=O+z),this.hasDragged=Math.sqrt(Math.pow(p-K,2)+Math.pow(x-se,2)),this.hasDragged>10)){re=u.isInsidePlot(p-I,x-O,{visiblePlotOnly:!0});let{shapeType:ce,attrs:fe}=this.getSelectionMarkerAttrs(K,se);(u.hasCartesianSeries||u.mapView)&&this.hasZoom&&re&&!q&&!te&&(this.selectionMarker=te=u.renderer[ce](),te.attr({class:"highcharts-selection-marker",zIndex:7}).add(),u.styledMode||te.attr({fill:A||pe("#334eff").setOpacity(.25).get()})),te&&te.attr(fe),re&&!te&&j&&u.pan(o,v)}}dragStart(o){let u=this.chart;u.mouseIsDown=o.type,u.cancelClick=!1,u.mouseDownX=o.chartX,u.mouseDownY=o.chartY}getSelectionBox(o){let u={args:{marker:o},result:o.getBBox()};return Nt(this,"getSelectionBox",u),u.result}drop(o){let u,{chart:p,selectionMarker:x}=this;for(let v of p.axes)v.isPanning&&(v.isPanning=!1,(v.options.startOnTick||v.options.endOnTick||v.series.some(S=>S.boosted))&&(v.forceRedraw=!0,v.setExtremes(v.userMin,v.userMax,!1),u=!0));if(u&&p.redraw(),x&&o){if(this.hasDragged){let v=this.getSelectionBox(x);p.transform({axes:p.axes.filter(S=>S.zoomEnabled&&(S.coll==="xAxis"&&this.zoomX||S.coll==="yAxis"&&this.zoomY)),selection:{originalEvent:o,xAxis:[],yAxis:[],...v},from:v})}ht(p.index)&&(this.selectionMarker=x.destroy())}p&&ht(p.index)&&(it(p.container,{cursor:p._cursor}),p.cancelClick=this.hasDragged>10,p.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(o,u,p){let x;return o.forEach(function(v){let S=!(v.noSharedTooltip&&u)&&0>v.options.findNearestPointBy.indexOf("y"),A=v.searchPoint(p,S);Ct(A,!0)&&A.series&&(!Ct(x,!0)||function(I,O){var q,K;let N=I.distX-O.distX,z=I.dist-O.dist,j=((q=O.series.group)==null?void 0:q.zIndex)-((K=I.series.group)==null?void 0:K.zIndex);return N!==0&&u?N:z!==0?z:j!==0?j:I.series.index>O.series.index?-1:1}(x,A)>0)&&(x=A)}),x}getChartCoordinatesFromPoint(o,u){let{xAxis:p,yAxis:x}=o.series,v=o.shapeArgs;if(p&&x){let S=o.clientX??o.plotX??0,A=o.plotY||0;return o.isNode&&v&&ht(v.x)&&ht(v.y)&&(S=v.x,A=v.y),u?{chartX:x.len+x.pos-A,chartY:p.len+p.pos-S}:{chartX:S+p.pos,chartY:A+x.pos}}if(v!=null&&v.x&&v.y)return{chartX:v.x,chartY:v.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:o}=this.chart,u=jt(o);this.chartPosition={left:u.left,top:u.top,scaleX:1,scaleY:1};let{offsetHeight:p,offsetWidth:x}=o;return x>2&&p>2&&(this.chartPosition.scaleX=u.width/x,this.chartPosition.scaleY=u.height/p),this.chartPosition}getCoordinates(o){let u={xAxis:[],yAxis:[]};for(let p of this.chart.axes)u[p.isXAxis?"xAxis":"yAxis"].push({axis:p,value:p.toValue(o[p.horiz?"chartX":"chartY"])});return u}getHoverData(o,u,p,x,v,S){let A=[],I=function(q){return q.visible&&!(!v&&q.directTouch)&&at(q.options.enableMouseTracking,!0)},O=u,N,z={chartX:S?S.chartX:void 0,chartY:S?S.chartY:void 0,shared:v};Nt(this,"beforeGetHoverData",z),N=O&&!O.stickyTracking?[O]:p.filter(q=>q.stickyTracking&&(z.filter||I)(q));let j=x&&o||!S?o:this.findNearestKDPoint(N,v,S);return O=j==null?void 0:j.series,j&&(v&&!O.noSharedTooltip?(N=p.filter(function(q){return z.filter?z.filter(q):I(q)&&!q.noSharedTooltip})).forEach(function(q){var re;let K=(re=q.options)==null?void 0:re.nullInteraction,se=pt(q.points,function(te){return te.x===j.x&&(!te.isNull||!!K)});Ct(se)&&(q.boosted&&q.boost&&(se=q.boost.getPoint(se)),A.push(se))}):A.push(j)),Nt(this,"afterGetHoverData",z={hoverPoint:j}),{hoverPoint:z.hoverPoint,hoverSeries:O,hoverPoints:A}}getPointFromEvent(o){let u=o.target,p;for(;u&&!p;)p=u.point,u=u.parentNode;return p}onTrackerMouseOut(o){let u=this.chart,p=o.relatedTarget,x=u.hoverSeries;this.isDirectTouch=!1,!x||!p||x.stickyTracking||this.inClass(p,"highcharts-tooltip")||this.inClass(p,"highcharts-series-"+x.index)&&this.inClass(p,"highcharts-tracker")||x.onMouseOut()}inClass(o,u){let p=o,x;for(;p;){if(x=We(p,"class")){if(x.indexOf(u)!==-1)return!0;if(x.indexOf("highcharts-container")!==-1)return!1}p=p.parentElement}}constructor(o,u){var p;this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=u,this.chart=o,this.runChartClick=!!((p=u.chart.events)!=null&&p.click),this.pinchDown=[],this.setDOMEvents(),Nt(this,"afterInit")}normalize(o,u){let p=o.touches,x=p?p.length?p.item(0):at(p.changedTouches,o.changedTouches)[0]:o;u||(u=this.getChartPosition());let v=x.pageX-u.left,S=x.pageY-u.top;return et(o,{chartX:Math.round(v/=u.scaleX),chartY:Math.round(S/=u.scaleY)})}onContainerClick(o){let u=this.chart,p=u.hoverPoint,x=this.normalize(o),v=u.plotLeft,S=u.plotTop;!u.cancelClick&&(p&&this.inClass(x.target,"highcharts-tracker")?(Nt(p.series,"click",et(x,{point:p})),u.hoverPoint&&p.firePointEvent("click",x)):(et(x,this.getCoordinates(x)),u.isInsidePlot(x.chartX-v,x.chartY-S,{visiblePlotOnly:!0})&&Nt(u,"click",x)))}onContainerMouseDown(o){var p;let u=(1&(o.buttons||o.button))==1;o=this.normalize(o),ke.isFirefox&&o.button!==0&&this.onContainerMouseMove(o),(o.button===void 0||u)&&(this.zoomOption(o),u&&((p=o.preventDefault)==null||p.call(o)),this.dragStart(o))}onContainerMouseLeave(o){let{pointer:u}=Ce[at(Et.hoverChartIndex,-1)]||{};o=this.normalize(o),this.onContainerMouseMove(o),u&&!this.inClass(o.relatedTarget,"highcharts-tooltip")&&(u.reset(),u.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(o){let u=this.chart,p=u.tooltip,x=this.normalize(o);this.setHoverChartIndex(o),(u.mouseIsDown==="mousedown"||this.touchSelect(x))&&this.drag(x),!u.openMenu&&(this.inClass(x.target,"highcharts-tracker")||u.isInsidePlot(x.chartX-u.plotLeft,x.chartY-u.plotTop,{visiblePlotOnly:!0}))&&!(p!=null&&p.shouldStickOnContact(x))&&(this.inClass(x.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(x))}onDocumentTouchEnd(o){this.onDocumentMouseUp(o)}onContainerTouchMove(o){this.touchSelect(o)?this.onContainerMouseMove(o):this.touch(o)}onContainerTouchStart(o){this.touchSelect(o)?this.onContainerMouseDown(o):(this.zoomOption(o),this.touch(o,!0))}onDocumentMouseMove(o){let u=this.chart,p=u.tooltip,x=this.chartPosition,v=this.normalize(o,x);!x||u.isInsidePlot(v.chartX-u.plotLeft,v.chartY-u.plotTop,{visiblePlotOnly:!0})||p!=null&&p.shouldStickOnContact(v)||v.target!==u.container.ownerDocument&&this.inClass(v.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(o){var u,p;(p=(u=Ce[at(Et.hoverChartIndex,-1)])==null?void 0:u.pointer)==null||p.drop(o)}pinch(o){let u=this,{chart:p,hasZoom:x,lastTouches:v}=u,S=[].map.call(o.touches||[],z=>u.normalize(z)),A=S.length,I=A===1&&(u.inClass(o.target,"highcharts-tracker")&&p.runTrackerClick||u.runChartClick),O=p.tooltip,N=A===1&&at(O==null?void 0:O.options.followTouchMove,!0);A>1?u.initiated=!0:N&&(u.initiated=!1),x&&u.initiated&&!I&&o.cancelable!==!1&&o.preventDefault(),o.type==="touchstart"?(u.pinchDown=S,u.res=!0,p.mouseDownX=o.chartX):N?this.runPointActions(u.normalize(o)):v&&(Nt(p,"touchpan",{originalEvent:o,touches:S},()=>{let z=j=>{let q=j[0],K=j[1]||q;return{x:q.chartX,y:q.chartY,width:K.chartX-q.chartX,height:K.chartY-q.chartY}};p.transform({axes:p.axes.filter(j=>j.zoomEnabled&&(this.zoomHor&&j.horiz||this.zoomVert&&!j.horiz)),to:z(S),from:z(v),trigger:o.type})}),u.res&&(u.res=!1,this.reset(!1,0))),u.lastTouches=S}reset(o,u){let p=this.chart,x=p.hoverSeries,v=p.hoverPoint,S=p.hoverPoints,A=p.tooltip,I=A!=null&&A.shared?S:v;o&&I&&Gt(I).forEach(function(O){O.series.isCartesian&&O.plotX===void 0&&(o=!1)}),o?A&&I&&Gt(I).length&&(A.refresh(I),A.shared&&S?S.forEach(function(O){O.setState(O.state,!0),O.series.isCartesian&&(O.series.xAxis.crosshair&&O.series.xAxis.drawCrosshair(null,O),O.series.yAxis.crosshair&&O.series.yAxis.drawCrosshair(null,O))}):v&&(v.setState(v.state,!0),p.axes.forEach(function(O){O.crosshair&&v.series[O.coll]===O&&O.drawCrosshair(null,v)}))):(v&&v.onMouseOut(),S&&S.forEach(function(O){O.setState()}),x&&x.onMouseOut(),A&&A.hide(u),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),p.axes.forEach(function(O){O.hideCrosshair()}),p.hoverPoints=p.hoverPoint=void 0)}runPointActions(o,u,p){var se;let x=this.chart,v=x.series,S=(se=x.tooltip)!=null&&se.options.enabled?x.tooltip:void 0,A=!!S&&S.shared,I=u||x.hoverPoint,O=(I==null?void 0:I.series)||x.hoverSeries,N=(!o||o.type!=="touchmove")&&(!!u||(O==null?void 0:O.directTouch)&&this.isDirectTouch),z=this.getHoverData(I,O,v,N,A,o);I=z.hoverPoint,O=z.hoverSeries;let j=z.hoverPoints,q=(O==null?void 0:O.tooltipOptions.followPointer)&&!O.tooltipOptions.split,K=A&&O&&!O.noSharedTooltip;if(I&&(p||I!==x.hoverPoint||S!=null&&S.isHidden)){if((x.hoverPoints||[]).forEach(function(re){j.indexOf(re)===-1&&re.setState()}),x.hoverSeries!==O&&O.onMouseOver(),this.applyInactiveState(j),(j||[]).forEach(function(re){re.setState("hover")}),x.hoverPoint&&x.hoverPoint.firePointEvent("mouseOut"),!I.series)return;x.hoverPoints=j,x.hoverPoint=I,I.firePointEvent("mouseOver",void 0,()=>{S&&I&&S.refresh(K?j:I,o)})}else if(q&&S&&!S.isHidden){let re=S.getAnchor([{}],o);x.isInsidePlot(re[0],re[1],{visiblePlotOnly:!0})&&S.updatePosition({plotX:re[0],plotY:re[1]})}this.unDocMouseMove||(this.unDocMouseMove=Fe(x.container.ownerDocument,"mousemove",re=>{var te,ce;return(ce=(te=Ce[Et.hoverChartIndex??-1])==null?void 0:te.pointer)==null?void 0:ce.onDocumentMouseMove(re)}),this.eventsToUnbind.push(this.unDocMouseMove)),x.axes.forEach(function(re){var fe;let te,ce=((fe=re.crosshair)==null?void 0:fe.snap)??!0;!ce||(te=x.hoverPoint)&&te.series[re.coll]===re||(te=pt(j,Xe=>{var Ne;return((Ne=Xe.series)==null?void 0:Ne[re.coll])===re})),te||!ce?re.drawCrosshair(o,te):re.hideCrosshair()})}setDOMEvents(){let o=this.chart.container,u=o.ownerDocument;o.onmousedown=this.onContainerMouseDown.bind(this),o.onmousemove=this.onContainerMouseMove.bind(this),o.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(Fe(o,"mouseenter",this.onContainerMouseEnter.bind(this)),Fe(o,"mouseleave",this.onContainerMouseLeave.bind(this))),Et.unbindDocumentMouseUp.some(x=>x.doc===u)||Et.unbindDocumentMouseUp.push({doc:u,unbind:Fe(u,"mouseup",this.onDocumentMouseUp.bind(this))});let p=this.chart.renderTo.parentElement;for(;p&&p.tagName!=="BODY";)this.eventsToUnbind.push(Fe(p,"scroll",()=>{delete this.chartPosition})),p=p.parentElement;this.eventsToUnbind.push(Fe(o,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),Fe(o,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),Et.unbindDocumentTouchEnd||(Et.unbindDocumentTouchEnd=Fe(u,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),Fe(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){var v,S;if(!Ge)return;let o=this.pointerCaptureEventsToUnbind,u=this.chart,p=u.container,x=at((v=u.options.tooltip)==null?void 0:v.followTouchMove,!0)&&u.series.some(A=>A.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&x?(o.push(Fe(p,"pointerdown",A=>{var I,O;(I=A.target)!=null&&I.hasPointerCapture(A.pointerId)&&((O=A.target)==null||O.releasePointerCapture(A.pointerId))}),Fe(p,"pointermove",A=>{var I,O;(O=(I=u.pointer)==null?void 0:I.getPointFromEvent(A))==null||O.onMouseOver(A)})),u.styledMode||it(p,{"touch-action":"none"}),p.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!x&&(o.forEach(A=>A()),o.length=0,u.styledMode||it(p,{"touch-action":at((S=u.options.chart.style)==null?void 0:S["touch-action"],"manipulation")}),p.className=p.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(o){var x;let u=this.chart,p=ke.charts[at(Et.hoverChartIndex,-1)];if(p&&p!==u){let v={relatedTarget:u.container};o&&!(o!=null&&o.relatedTarget)&&Object.assign({},o,v),(x=p.pointer)==null||x.onContainerMouseLeave(o||v)}p!=null&&p.mouseIsDown||(Et.hoverChartIndex=u.index)}touch(o,u){let p,{chart:x,pinchDown:v=[]}=this;this.setHoverChartIndex(),(o=this.normalize(o)).touches.length===1?x.isInsidePlot(o.chartX-x.plotLeft,o.chartY-x.plotTop,{visiblePlotOnly:!0})&&!x.openMenu?(u&&this.runPointActions(o),o.type==="touchmove"&&(p=!!v[0]&&Math.pow(v[0].chartX-o.chartX,2)+Math.pow(v[0].chartY-o.chartY,2)>=16),at(p,!0)&&this.pinch(o)):u&&this.reset():o.touches.length===2&&this.pinch(o)}touchSelect(o){return!!(this.chart.zooming.singleTouch&&o.touches&&o.touches.length===1)}zoomOption(o){let u=this.chart,p=u.inverted,x=u.zooming.type||"",v,S;/touch/.test(o.type)&&(x=at(u.zooming.pinchType,x)),this.zoomX=v=/x/.test(x),this.zoomY=S=/y/.test(x),this.zoomHor=v&&!p||S&&p,this.zoomVert=S&&!p||v&&p,this.hasZoom=v||S}}Et.unbindDocumentMouseUp=[],function(R){R.compose=function(o){Mt(Ie,"Core.Pointer")&&Fe(o,"beforeRender",function(){this.pointer=new R(this,this.options)})}}(Et||(Et={}));let Xt=Et;(function(R){R.setLength=function(o,u,p){return Array.isArray(o)?(o.length=u,o):o[p?"subarray":"slice"](0,u)},R.splice=function(o,u,p,x,v=[]){if(Array.isArray(o))return Array.isArray(v)||(v=Array.from(v)),{removed:o.splice(u,p,...v),array:o};let S=Object.getPrototypeOf(o).constructor,A=o[x?"subarray":"slice"](u,u+p),I=new S(o.length-p+v.length);return I.set(o.subarray(0,u),0),I.set(v,u),I.set(o.subarray(u+p),u+v.length),{removed:A,array:I}}})(ne||(ne={}));let{setLength:ki,splice:Ni}=ne,{fireEvent:bi,objectEach:Li,uniqueKey:Wi}=xe,Hi=class{constructor(R={}){this.autoId=!R.id,this.columns={},this.id=R.id||Wi(),this.modified=this,this.rowCount=0,this.versionTag=Wi();let o=0;Li(R.columns||{},(u,p)=>{this.columns[p]=u.slice(),o=Math.max(o,u.length)}),this.applyRowCount(o)}applyRowCount(R){this.rowCount=R,Li(this.columns,(o,u)=>{o.length!==R&&(this.columns[u]=ki(o,R))})}deleteRows(R,o=1){if(o>0&&R<this.rowCount){let u=0;Li(this.columns,(p,x)=>{this.columns[x]=Ni(p,R,o).array,u=p.length}),this.rowCount=u}bi(this,"afterDeleteRows",{rowIndex:R,rowCount:o}),this.versionTag=Wi()}getColumn(R,o){return this.columns[R]}getColumns(R,o){return(R||Object.keys(this.columns)).reduce((u,p)=>(u[p]=this.columns[p],u),{})}getRow(R,o){return(o||Object.keys(this.columns)).map(u=>{var p;return(p=this.columns[u])==null?void 0:p[R]})}setColumn(R,o=[],u=0,p){this.setColumns({[R]:o},u,p)}setColumns(R,o,u){let p=this.rowCount;Li(R,(x,v)=>{this.columns[v]=x.slice(),p=x.length}),this.applyRowCount(p),u!=null&&u.silent||(bi(this,"afterSetColumns"),this.versionTag=Wi())}setRow(R,o=this.rowCount,u,p){let{columns:x}=this,v=u?this.rowCount+1:o+1;Li(R,(S,A)=>{let I=x[A]||(p==null?void 0:p.addColumns)!==!1&&Array(v);I&&(u?I=Ni(I,o,0,!0,[S]).array:I[o]=S,x[A]=I)}),v>this.rowCount&&this.applyRowCount(v),p!=null&&p.silent||(bi(this,"afterSetRows"),this.versionTag=Wi())}},{extend:Ai,merge:Mr,pick:Dr}=xe;(function(R){function o(u,p,x){var Xe,Ne;let v=this.legendItem=this.legendItem||{},{chart:S,options:A}=this,{baseline:I=0,symbolWidth:O,symbolHeight:N}=u,z=this.symbol||"circle",j=N/2,q=S.renderer,K=v.group,se=I-Math.round((((Xe=u.fontMetrics)==null?void 0:Xe.b)||N)*(x?.4:.3)),re={},te,ce=A.marker,fe=0;if(S.styledMode||(re["stroke-width"]=Math.min(A.lineWidth||0,24),A.dashStyle?re.dashstyle=A.dashStyle:A.linecap==="square"||(re["stroke-linecap"]="round")),v.line=q.path().addClass("highcharts-graph").attr(re).add(K),x&&(v.area=q.path().addClass("highcharts-area").add(K)),re["stroke-linecap"]&&(fe=Math.min(v.line.strokeWidth(),O)/2),O){let $e=[["M",fe,se],["L",O-fe,se]];v.line.attr({d:$e}),(Ne=v.area)==null||Ne.attr({d:[...$e,["L",O-fe,I],["L",fe,I]]})}if(ce&&ce.enabled!==!1&&O){let $e=Math.min(Dr(ce.radius,j),j);z.indexOf("url")===0&&(ce=Mr(ce,{width:N,height:N}),$e=0),v.symbol=te=q.symbol(z,O/2-$e,se-$e,2*$e,2*$e,Ai({context:"legend"},ce)).addClass("highcharts-point").add(K),te.isMarker=!0}}R.areaMarker=function(u,p){o.call(this,u,p,!0)},R.lineMarker=o,R.rectangle=function(u,p){let x=p.legendItem||{},v=u.options,S=u.symbolHeight,A=v.squareSymbol,I=A?S:u.symbolWidth;x.symbol=this.chart.renderer.rect(A?(u.symbolWidth-S)/2:0,u.baseline-S+1,I,S,Dr(u.options.symbolRadius,S/2)).addClass("highcharts-point").attr({zIndex:3}).add(x.group)}})(ue||(ue={}));let Or=ue,{defaultOptions:Rr}=Le,{extend:_s,extendClass:ns,merge:no}=xe;(function(R){function o(u,p){let x=Rr.plotOptions||{},v=p.defaultOptions,S=p.prototype;return S.type=u,S.pointClass||(S.pointClass=ee),!R.seriesTypes[u]&&(v&&(x[u]=v),R.seriesTypes[u]=p,!0)}R.seriesTypes=ke.seriesTypes,R.registerSeriesType=o,R.seriesType=function(u,p,x,v,S){let A=Rr.plotOptions||{};if(p=p||"",A[u]=no(A[p],x),delete R.seriesTypes[u],o(u,ns(R.seriesTypes[p]||function(){},v)),R.seriesTypes[u].prototype.type=u,S){class I extends ee{}_s(I.prototype,S),R.seriesTypes[u].prototype.pointClass=I}return R.seriesTypes[u]}})(we||(we={}));let Pr=we,{animObject:Yr,setAnimation:Vr}=Cn,{defaultOptions:gr}=Le,{registerEventOptions:Un}=Kc,{svg:Ss,win:Kr}=ke,{seriesTypes:qn}=Pr,{format:uu}=fs,{arrayMax:Ea,arrayMin:fc,clamp:Ko,correctFloat:Sa,crisp:Tl,defined:wn,destroyObjectProperties:lh,diffObjects:zd,erase:Rm,error:Bd,extend:du,find:zm,fireEvent:pn,getClosestDistance:__,getNestedProperty:sp,insertItem:Fd,isArray:Za,isNumber:Hn,isString:y_,merge:fu,objectEach:Bm,pick:Mn,removeEvent:qx,syncTimeout:op}=xe;class Ws{constructor(){this.zoneAxis="y"}init(o,u){var I,O,N;let p;pn(this,"init",{options:u}),this.dataTable??(this.dataTable=new Hi);let x=o.series;this.eventsToUnbind=[],this.chart=o,this.options=this.setOptions(u);let v=this.options,S=v.visible!==!1;this.linkedSeries=[],this.bindAxes(),du(this,{name:v.name,state:"",visible:S,selected:v.selected===!0}),Un(this,v);let A=v.events;(A!=null&&A.click||(O=(I=v.point)==null?void 0:I.events)!=null&&O.click||v.allowPointSelect)&&(o.runTrackerClick=!0),this.getColor(),this.getSymbol(),this.isCartesian&&(o.hasCartesianSeries=!0),x.length&&(p=x[x.length-1]),this._i=Mn(p==null?void 0:p._i,-1)+1,this.opacity=this.options.opacity,o.orderItems("series",Fd(this,x)),(N=v.dataSorting)!=null&&N.enabled?this.setDataSortingOptions():this.points||this.data||this.setData(v.data,!1),pn(this,"afterInit")}is(o){return qn[o]&&this instanceof qn[o]}bindAxes(){let o,u=this,p=u.options,x=u.chart;pn(this,"bindAxes",null,function(){(u.axisTypes||[]).forEach(function(v){(x[v]||[]).forEach(function(S){o=S.options,(Mn(p[v],0)===S.index||p[v]!==void 0&&p[v]===o.id)&&(Fd(u,S.series),u[v]=S,S.isDirty=!0)}),u[v]||u.optionalAxis===v||Bd(18,!0,x)})}),pn(this,"afterBindAxes")}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.dataTable.rowCount>0}hasMarkerChanged(o,u){let p=o.marker,x=u.marker||{};return p&&(x.enabled&&!p.enabled||x.symbol!==p.symbol||x.height!==p.height||x.width!==p.width)}autoIncrement(o){let u,p=this.options,{pointIntervalUnit:x,relativeXValue:v}=this.options,S=this.chart.time,A=this.xIncrement??S.parse(p.pointStart)??0;if(this.pointInterval=u=Mn(this.pointInterval,p.pointInterval,1),v&&Hn(o)&&(u*=o),x){let I=S.toParts(A);x==="day"?I[2]+=u:x==="month"?I[1]+=u:x==="year"&&(I[0]+=u),u=S.makeTime.apply(S,I)-A}return v&&Hn(o)?A+u:(this.xIncrement=A+u,A)}setDataSortingOptions(){let o=this.options;du(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),wn(o.pointRange)||(o.pointRange=1)}setOptions(o){var re,te;let u,p=this.chart,x=p.options.plotOptions,v=p.userOptions||{},S=fu(o),A=p.styledMode,I={plotOptions:x,userOptions:S};pn(this,"setOptions",I);let O=I.plotOptions[this.type],N=v.plotOptions||{},z=N.series||{},j=gr.plotOptions[this.type]||{},q=N[this.type]||{};O.dataLabels=this.mergeArrays(j.dataLabels,O.dataLabels),this.userOptions=I.userOptions;let K=fu(O,x.series,q,S);this.tooltipOptions=fu(gr.tooltip,(re=gr.plotOptions.series)==null?void 0:re.tooltip,j==null?void 0:j.tooltip,p.userOptions.tooltip,(te=N.series)==null?void 0:te.tooltip,q.tooltip,S.tooltip),this.stickyTracking=Mn(S.stickyTracking,q.stickyTracking,z.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||K.stickyTracking),O.marker===null&&delete K.marker,this.zoneAxis=K.zoneAxis||"y";let se=this.zones=(K.zones||[]).map(ce=>({...ce}));return(K.negativeColor||K.negativeFillColor)&&!K.zones&&(u={value:K[this.zoneAxis+"Threshold"]||K.threshold||0,className:"highcharts-negative"},A||(u.color=K.negativeColor,u.fillColor=K.negativeFillColor),se.push(u)),se.length&&wn(se[se.length-1].value)&&se.push(A?{}:{color:this.color,fillColor:this.fillColor}),pn(this,"afterSetOptions",{options:K}),K}getName(){return this.options.name??uu(this.chart.options.lang.seriesName,this,this.chart)}getCyclic(o,u,p){let x,v,S=this.chart,A=`${o}Index`,I=`${o}Counter`,O=(p==null?void 0:p.length)||S.options.chart.colorCount;!u&&(wn(v=Mn(o==="color"?this.options.colorIndex:void 0,this[A]))?x=v:(S.series.length||(S[I]=0),x=S[I]%O,S[I]+=1),p&&(u=p[x])),x!==void 0&&(this[A]=x),this[o]=u}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||gr.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let o=this.options.marker;this.getCyclic("symbol",o.symbol,this.chart.options.symbols)}getColumn(o,u){return(u?this.dataTable.modified:this.dataTable).getColumn(o,!0)||[]}findPointIndex(o,u){var z;let p,x,v,{id:S,x:A}=o,I=this.points,O=this.options.dataSorting,N=this.cropStart||0;if(S){let j=this.chart.get(S);j instanceof ee&&(p=j)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let j=q=>!q.touched&&q.index===o.index;if(O!=null&&O.matchByName?j=q=>!q.touched&&q.name===o.name:this.options.relativeXValue&&(j=q=>!q.touched&&q.options.x===o.x),!(p=zm(I,j)))return}return p&&(v=p==null?void 0:p.index)!==void 0&&(x=!0),v===void 0&&Hn(A)&&(v=this.getColumn("x").indexOf(A,u)),v!==-1&&v!==void 0&&this.cropped&&(v=v>=N?v-N:v),!x&&Hn(v)&&((z=I[v])!=null&&z.touched)&&(v=void 0),v}updateData(o,u){var se;let{options:p,requireSorting:x}=this,v=p.dataSorting,S=this.points,A=[],I=o.length===S.length,O,N,z,j,q=!0;if(this.xIncrement=null,o.forEach((re,te)=>{var $e;let ce,fe=wn(re)&&this.pointClass.prototype.optionsToObject.call({series:this},re)||{},{id:Xe,x:Ne}=fe;Xe||Hn(Ne)?((ce=this.findPointIndex(fe,j))===-1||ce===void 0?A.push(re):S[ce]&&re!==(($e=p.data)==null?void 0:$e[ce])?(S[ce].update(re,!1,void 0,!1),S[ce].touched=!0,x&&(j=ce+1)):S[ce]&&(S[ce].touched=!0),(!I||te!==ce||v!=null&&v.enabled||this.hasDerivedData)&&(O=!0)):A.push(re)},this),O)for(N=S.length;N--;)(z=S[N])&&!z.touched&&((se=z.remove)==null||se.call(z,!1,u));else I&&!(v!=null&&v.enabled)?(o.forEach((re,te)=>{re===S[te].y||S[te].destroyed||S[te].update(re,!1,void 0,!1)}),A.length=0):q=!1;if(S.forEach(re=>{re&&(re.touched=!1)}),!q)return!1;A.forEach(re=>{this.addPoint(re,!1,void 0,void 0,!1)},this);let K=this.getColumn("x");return this.xIncrement===null&&K.length&&(this.xIncrement=Ea(K),this.autoIncrement()),!0}dataColumnKeys(){return["x",...this.pointArrayMap||["y"]]}setData(o,u=!0,p,x){var mt,tt;let v=this.points,S=(v==null?void 0:v.length)||0,A=this.options,I=this.chart,O=A.dataSorting,N=this.xAxis,z=A.turboThreshold,j=this.dataTable,q=this.dataColumnKeys(),K=this.pointValKey||"y",se=(this.pointArrayMap||[]).length,re=A.keys,te,ce,fe=0,Xe=1,Ne;I.options.chart.allowMutatingData||(A.data&&delete this.options.data,this.userOptions.data&&delete this.userOptions.data,Ne=fu(!0,o));let $e=(o=Ne||o||[]).length;if(O!=null&&O.enabled&&(o=this.sortData(o)),I.options.chart.allowMutatingData&&x!==!1&&$e&&S&&!this.cropped&&!this.hasGroupedData&&this.visible&&!this.boosted&&(ce=this.updateData(o,p)),!ce){this.xIncrement=null,this.colorCounter=0;let gt=z&&$e>z;if(gt){let Bt=this.getFirstValidPoint(o),Jt=this.getFirstValidPoint(o,$e-1,-1),ii=Ft=>!!(Za(Ft)&&(re||Hn(Ft[0])));if(Hn(Bt)&&Hn(Jt)){let Ft=[],ui=[];for(let gi of o)Ft.push(this.autoIncrement()),ui.push(gi);j.setColumns({x:Ft,[K]:ui})}else if(ii(Bt)&&ii(Jt))if(se){let Ft=+(Bt.length===se),ui=Array(q.length).fill(0).map(()=>[]);for(let gi of o){Ft&&ui[0].push(this.autoIncrement());for(let Ui=Ft;Ui<=se;Ui++)(mt=ui[Ui])==null||mt.push(gi[Ui-Ft])}j.setColumns(q.reduce((gi,Ui,wi)=>(gi[Ui]=ui[wi],gi),{}))}else{re&&(fe=re.indexOf("x"),Xe=re.indexOf("y"),fe=fe>=0?fe:0,Xe=Xe>=0?Xe:1),Bt.length===1&&(Xe=0);let Ft=[],ui=[];if(fe===Xe)for(let gi of o)Ft.push(this.autoIncrement()),ui.push(gi[Xe]);else for(let gi of o)Ft.push(gi[fe]),ui.push(gi[Xe]);j.setColumns({x:Ft,[K]:ui})}else gt=!1}if(!gt){let Bt=q.reduce((Jt,ii)=>(Jt[ii]=[],Jt),{});for(te=0;te<$e;te++){let Jt=this.pointClass.prototype.applyOptions.apply({series:this},[o[te]]);for(let ii of q)Bt[ii][te]=Jt[ii]}j.setColumns(Bt)}for(y_(this.getColumn("y")[0])&&Bd(14,!0,I),this.data=[],this.options.data=this.userOptions.data=o,te=S;te--;)(tt=v[te])==null||tt.destroy();N&&(N.minRange=N.userMinRange),this.isDirty=I.isDirtyBox=!0,this.isDirtyData=!!v,p=!1}A.legendType==="point"&&(this.processData(),this.generatePoints()),u&&I.redraw(p)}sortData(o){let u=this,p=u.options.dataSorting.sortKey||"y",x=function(v,S){return wn(S)&&v.pointClass.prototype.optionsToObject.call({series:v},S)||{}};return o.forEach(function(v,S){o[S]=x(u,v),o[S].index=S},this),o.concat().sort((v,S)=>{let A=sp(p,v),I=sp(p,S);return I<A?-1:+(I>A)}).forEach(function(v,S){v.x=S},this),u.linkedSeries&&u.linkedSeries.forEach(function(v){var I;let S=v.options,A=S.data;!((I=S.dataSorting)!=null&&I.enabled)&&A&&(A.forEach(function(O,N){A[N]=x(v,O),o[N]&&(A[N].x=o[N].x,A[N].index=N)}),v.setData(A,!1))}),o}getProcessedData(o){let u=this,{dataTable:p,isCartesian:x,options:v,xAxis:S}=u,A=v.cropThreshold,I=o||u.getExtremesFromAll,O=S==null?void 0:S.logarithmic,N=p.rowCount,z,j,q=0,K,se,re,te=u.getColumn("x"),ce=p,fe=!1;return S&&(se=(K=S.getExtremes()).min,re=K.max,fe=!!(S.categories&&!S.names.length),x&&u.sorted&&!I&&(!A||N>A||u.forceCrop)&&(te[N-1]<se||te[0]>re?ce=new Hi:u.getColumn(u.pointValKey||"y").length&&(te[0]<se||te[N-1]>re)&&(ce=(z=this.cropData(p,se,re)).modified,q=z.start,j=!0))),te=ce.getColumn("x")||[],{modified:ce,cropped:j,cropStart:q,closestPointRange:__([O?te.map(O.log2lin):te],()=>u.requireSorting&&!fe&&Bd(15,!1,u.chart))}}processData(o){let u=this.xAxis,p=this.dataTable;if(this.isCartesian&&!this.isDirty&&!u.isDirty&&!this.yAxis.isDirty&&!o)return!1;let x=this.getProcessedData();p.modified=x.modified,this.cropped=x.cropped,this.cropStart=x.cropStart,this.closestPointRange=this.basePointRange=x.closestPointRange,pn(this,"afterProcessData")}cropData(o,u,p){let x=o.getColumn("x",!0)||[],v=x.length,S={},A,I,O=0,N=v;for(A=0;A<v;A++)if(x[A]>=u){O=Math.max(0,A-1);break}for(I=A;I<v;I++)if(x[I]>p){N=I+1;break}for(let z of this.dataColumnKeys()){let j=o.getColumn(z,!0);j&&(S[z]=j.slice(O,N))}return{modified:new Hi({columns:S}),start:O,end:N}}generatePoints(){var Ne,$e,mt;let o=this.options,u=this.processedData||o.data,p=this.dataTable.modified,x=this.getColumn("x",!0),v=this.pointClass,S=p.rowCount,A=this.cropStart||0,I=this.hasGroupedData,O=o.keys,N=[],z=(Ne=o.dataGrouping)!=null&&Ne.groupAll?A:0,j=($e=this.xAxis)==null?void 0:$e.categories,q=this.pointArrayMap||["y"],K=this.dataColumnKeys(),se,re,te,ce,fe=this.data,Xe;if(!fe&&!I){let tt=[];tt.length=(u==null?void 0:u.length)||0,fe=this.data=tt}for(O&&I&&(this.options.keys=!1),ce=0;ce<S;ce++)re=A+ce,I?((te=new v(this,p.getRow(ce,K)||[])).dataGroup=this.groupMap[z+ce],(mt=te.dataGroup)!=null&&mt.options&&(te.options=te.dataGroup.options,du(te,te.dataGroup.options),delete te.dataLabels)):(te=fe[re],Xe=u?u[re]:p.getRow(ce,q),te||Xe===void 0||(fe[re]=te=new v(this,Xe,x[ce]))),te&&(te.index=I?z+ce:re,N[ce]=te,te.category=(j==null?void 0:j[te.x])??te.x,te.key=te.name??te.category);if(this.options.keys=O,fe&&(S!==(se=fe.length)||I))for(ce=0;ce<se;ce++)ce!==A||I||(ce+=S),fe[ce]&&(fe[ce].destroyElements(),fe[ce].plotX=void 0);this.data=fe,this.points=N,pn(this,"afterGeneratePoints")}getXExtremes(o){return{min:fc(o),max:Ea(o)}}getExtremes(o,u){var Ne;let{xAxis:p,yAxis:x}=this,v=u||this.getExtremesFromAll||this.options.getExtremesFromAll,S=v&&this.cropped?this.dataTable:this.dataTable.modified,A=S.rowCount,I=o||this.stackedYData,O=I?[I]:((Ne=this.keysAffectYAxis||this.pointArrayMap||["y"])==null?void 0:Ne.map($e=>S.getColumn($e,!0)||[]))||[],N=this.getColumn("x",!0),z=[],j=this.requireSorting&&!this.is("column")?1:0,q=!!x&&x.positiveValuesOnly,K=v||this.cropped||!p,se,re,te,ce=0,fe=0;for(p&&(ce=(se=p.getExtremes()).min,fe=se.max),te=0;te<A;te++)if(re=N[te],K||(N[te+j]||re)>=ce&&(N[te-j]||re)<=fe)for(let $e of O){let mt=$e[te];Hn(mt)&&(mt>0||!q)&&z.push(mt)}let Xe={activeYData:z,dataMin:fc(z),dataMax:Ea(z)};return pn(this,"afterGetExtremes",{dataExtremes:Xe}),Xe}applyExtremes(){let o=this.getExtremes();return this.dataMin=o.dataMin,this.dataMax=o.dataMax,o}getFirstValidPoint(o,u=0,p=1){let x=o.length,v=u;for(;v>=0&&v<x;){if(wn(o[v]))return o[v];v+=p}}translate(){var fe;this.generatePoints();let o=this.options,u=o.stacking,p=this.xAxis,x=this.enabledDataSorting,v=this.yAxis,S=this.points,A=S.length,I=this.pointPlacementToXValue(),O=!!I,N=o.threshold,z=o.startFromThreshold?N:0,j=(o==null?void 0:o.nullInteraction)&&v.len,q,K,se,re,te=Number.MAX_VALUE;function ce(Xe){return Ko(Xe,-1e9,1e9)}for(q=0;q<A;q++){let Xe,Ne=S[q],$e=Ne.x,mt,tt,gt=Ne.y,Bt=Ne.low,Jt=u&&((fe=v.stacking)==null?void 0:fe.stacks[(this.negStacks&&gt<(z?0:N)?"-":"")+this.stackKey]);Ne.plotX=Hn(K=p.translate($e,!1,!1,!1,!0,I))?Sa(ce(K)):void 0,u&&this.visible&&Jt&&Jt[$e]&&(re=this.getStackIndicator(re,$e,this.index),!Ne.isNull&&re.key&&(tt=(mt=Jt[$e]).points[re.key]),mt&&Za(tt)&&(Bt=tt[0],gt=tt[1],Bt===z&&re.key===Jt[$e].base&&(Bt=Mn(Hn(N)?N:v.min)),v.positiveValuesOnly&&wn(Bt)&&Bt<=0&&(Bt=void 0),Ne.total=Ne.stackTotal=Mn(mt.total),Ne.percentage=wn(Ne.y)&&mt.total?Ne.y/mt.total*100:void 0,Ne.stackY=gt,this.irregularWidths||mt.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),Ne.yBottom=wn(Bt)?ce(v.translate(Bt,!1,!0,!1,!0)):void 0,this.dataModify&&(gt=this.dataModify.modifyValue(gt,q)),Hn(gt)&&Ne.plotX!==void 0?Xe=Hn(Xe=v.translate(gt,!1,!0,!1,!0))?ce(Xe):void 0:!Hn(gt)&&j&&(Xe=j),Ne.plotY=Xe,Ne.isInside=this.isPointInside(Ne),Ne.clientX=O?Sa(p.translate($e,!1,!1,!1,!0,I)):K,Ne.negative=(Ne.y||0)<(N||0),Ne.isNull||Ne.visible===!1||(se!==void 0&&(te=Math.min(te,Math.abs(K-se))),se=K),Ne.zone=this.zones.length?Ne.getZone():void 0,!Ne.graphic&&this.group&&x&&(Ne.isNew=!0)}this.closestPointRangePx=te,pn(this,"afterTranslate")}getValidPoints(o,u,p){let x=this.chart;return(o||this.points||[]).filter(function(v){let{plotX:S,plotY:A}=v;return!!((p||!v.isNull&&Hn(A))&&(!u||x.isInsidePlot(S,A,{inverted:x.inverted})))&&v.visible!==!1})}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:o,group:u,markerGroup:p}=this,x=o.sharedClips,v=o.renderer,S=o.getClipBox(this),A=this.getSharedClipKey(),I=x[A];I?I.animate(S):x[A]=I=v.clipRect(S),u&&u.clip(this.options.clip===!1?void 0:I),p&&p.clip()}animate(o){let{chart:u,group:p,markerGroup:x}=this,v=u.inverted,S=Yr(this.options.animation),A=[this.getSharedClipKey(),S.duration,S.easing,S.defer].join(","),I=u.sharedClips[A],O=u.sharedClips[A+"m"];if(o&&p){let N=u.getClipBox(this);if(I)I.attr("height",N.height);else{N.width=0,v&&(N.x=u.plotHeight),I=u.renderer.clipRect(N),u.sharedClips[A]=I;let z={x:-99,y:-99,width:v?u.plotWidth+199:99,height:v?99:u.plotHeight+199};O=u.renderer.clipRect(z),u.sharedClips[A+"m"]=O}p.clip(I),x==null||x.clip(O)}else if(I&&!I.hasClass("highcharts-animating")){let N=u.getClipBox(this),z=S.step;(x!=null&&x.element.childNodes.length||u.series.length>1)&&(S.step=function(j,q){z&&z.apply(q,arguments),q.prop==="width"&&(O!=null&&O.element)&&O.attr(v?"height":"width",j+99)}),I.addClass("highcharts-animating").animate(N,S)}}afterAnimate(){this.setClip(),Bm(this.chart.sharedClips,(o,u,p)=>{o&&!this.chart.container.querySelector(`[clip-path="url(#${o.id})"]`)&&(o.destroy(),delete p[u])}),this.finishedAnimating=!0,pn(this,"afterAnimate")}drawPoints(o=this.points){let u,p,x,v,S,A,I,O=this.chart,N=O.styledMode,{colorAxis:z,options:j}=this,q=j.marker,K=j.nullInteraction,se=this[this.specialGroup||"markerGroup"],re=this.xAxis,te=Mn(q.enabled,!re||!!re.isRadial||null,this.closestPointRangePx>=q.enabledThreshold*q.radius);if(q.enabled!==!1||this._hasPointMarkers)for(u=0;u<o.length;u++){v=(x=(p=o[u]).graphic)?"animate":"attr",S=p.marker||{},A=!!p.marker;let ce=p.isNull;if((te&&!wn(S.enabled)||S.enabled)&&(!ce||K)&&p.visible!==!1){let fe=Mn(S.symbol,this.symbol,"rect");I=this.markerAttribs(p,p.selected&&"select"),this.enabledDataSorting&&(p.startXPos=re.reversed?-(I.width||0):re.width);let Xe=p.isInside!==!1;if(!x&&Xe&&((I.width||0)>0||p.hasImage)&&(p.graphic=x=O.renderer.symbol(fe,I.x,I.y,I.width,I.height,A?S:q).add(se),this.enabledDataSorting&&O.hasRendered&&(x.attr({x:p.startXPos}),v="animate")),x&&v==="animate"&&x[Xe?"show":"hide"](Xe).animate(I),x){let Ne=this.pointAttribs(p,N||!p.selected?void 0:"select");N?z&&x.css({fill:Ne.fill}):x[v](Ne)}x&&x.addClass(p.getClassName(),!0)}else x&&(p.graphic=x.destroy())}}markerAttribs(o,u){let p=this.options,x=p.marker,v=o.marker||{},S=v.symbol||x.symbol,A={},I,O,N=Mn(v.radius,x==null?void 0:x.radius);u&&(I=x.states[u],O=v.states&&v.states[u],N=Mn(O==null?void 0:O.radius,I==null?void 0:I.radius,N&&N+((I==null?void 0:I.radiusPlus)||0))),o.hasImage=S&&S.indexOf("url")===0,o.hasImage&&(N=0);let z=o.pos();return Hn(N)&&z&&(p.crisp&&(z[0]=Tl(z[0],o.hasImage?0:S==="rect"?(x==null?void 0:x.lineWidth)||0:1)),A.x=z[0]-N,A.y=z[1]-N),N&&(A.width=A.height=2*N),A}pointAttribs(o,u){var te;let p=this.options,x=p.marker,v=o==null?void 0:o.options,S=(v==null?void 0:v.marker)||{},A=v==null?void 0:v.color,I=o==null?void 0:o.color,O=(te=o==null?void 0:o.zone)==null?void 0:te.color,N,z,j=this.color,q,K,se=Mn(S.lineWidth,x.lineWidth),re=o!=null&&o.isNull&&p.nullInteraction?0:1;return j=A||O||I||j,q=S.fillColor||x.fillColor||j,K=S.lineColor||x.lineColor||j,u=u||"normal",N=x.states[u]||{},se=Mn((z=S.states&&S.states[u]||{}).lineWidth,N.lineWidth,se+Mn(z.lineWidthPlus,N.lineWidthPlus,0)),q=z.fillColor||N.fillColor||q,K=z.lineColor||N.lineColor||K,{stroke:K,"stroke-width":se,fill:q,opacity:re=Mn(z.opacity,N.opacity,re)}}destroy(o){var I,O;let u,p,x=this,v=x.chart,S=/AppleWebKit\/533/.test(Kr.navigator.userAgent),A=x.data||[];for(pn(x,"destroy",{keepEventsForUpdate:o}),this.removeEvents(o),(x.axisTypes||[]).forEach(function(N){p=x[N],p!=null&&p.series&&(Rm(p.series,x),p.isDirty=p.forceRedraw=!0)}),x.legendItem&&x.chart.legend.destroyItem(x),u=A.length;u--;)(O=(I=A[u])==null?void 0:I.destroy)==null||O.call(I);for(let N of x.zones)lh(N,void 0,!0);xe.clearTimeout(x.animationTimeout),Bm(x,function(N,z){N instanceof is&&!N.survive&&N[S&&z==="group"?"hide":"destroy"]()}),v.hoverSeries===x&&(v.hoverSeries=void 0),Rm(v.series,x),v.orderItems("series"),Bm(x,function(N,z){o&&z==="hcEvents"||delete x[z]})}applyZones(){let{area:o,chart:u,graph:p,zones:x,points:v,xAxis:S,yAxis:A,zoneAxis:I}=this,{inverted:O,renderer:N}=u,z=this[`${I}Axis`],{isXAxis:j,len:q=0,minPointOffset:K=0}=z||{},se=((p==null?void 0:p.strokeWidth())||0)/2+1,re=(te,ce=0,fe=0)=>{O&&(fe=q-fe);let{translated:Xe=0,lineClip:Ne}=te,$e=fe-Xe;Ne==null||Ne.push(["L",ce,Math.abs($e)<se?fe-se*($e<=0?-1:1):Xe])};if(x.length&&(p||o)&&z&&Hn(z.min)){let te=z.getExtremes().max+K,ce=Ne=>{Ne.forEach(($e,mt)=>{($e[0]==="M"||$e[0]==="L")&&(Ne[mt]=[$e[0],j?q-$e[1]:$e[1],j?$e[2]:q-$e[2]])})};if(x.forEach(Ne=>{Ne.lineClip=[],Ne.translated=Ko(z.toPixels(Mn(Ne.value,te),!0)||0,0,q)}),p&&!this.showLine&&p.hide(),o&&o.hide(),I==="y"&&v.length<S.len)for(let Ne of v){let{plotX:$e,plotY:mt,zone:tt}=Ne,gt=tt&&x[x.indexOf(tt)-1];tt&&re(tt,$e,mt),gt&&re(gt,$e,mt)}let fe=[],Xe=z.toPixels(z.getExtremes().min-K,!0);x.forEach(Ne=>{var Ui,wi;let $e=Ne.lineClip||[],mt=Math.round(Ne.translated||0);S.reversed&&$e.reverse();let{clip:tt,simpleClip:gt}=Ne,Bt=0,Jt=0,ii=S.len,Ft=A.len;j?(Bt=mt,ii=Xe):(Jt=mt,Ft=Xe);let ui=[["M",Bt,Jt],["L",ii,Jt],["L",ii,Ft],["L",Bt,Ft],["Z"]],gi=[ui[0],...$e,ui[1],ui[2],...fe,ui[3],ui[4]];fe=$e.reverse(),Xe=mt,O&&(ce(gi),o&&ce(ui)),tt?(tt.animate({d:gi}),gt==null||gt.animate({d:ui})):(tt=Ne.clip=N.path(gi),o&&(gt=Ne.simpleClip=N.path(ui))),p&&((Ui=Ne.graph)==null||Ui.clip(tt)),o&&((wi=Ne.area)==null||wi.clip(gt))})}else this.visible&&(p&&p.show(),o&&o.show())}plotGroup(o,u,p,x,v){let S=this[o],A=!S,I={visibility:p,zIndex:x||.1};return wn(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(I.opacity=this.opacity),S||(this[o]=S=this.chart.renderer.g().add(v)),S.addClass("highcharts-"+u+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(wn(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(S.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),S.attr(I)[A?"attr":"animate"](this.getPlotBox(u)),S}getPlotBox(o){let u=this.xAxis,p=this.yAxis,x=this.chart,v=x.inverted&&!x.polar&&u&&this.invertible&&o==="series";return x.inverted&&(u=p,p=this.xAxis),{translateX:u?u.left:x.plotLeft,translateY:p?p.top:x.plotTop,rotation:90*!!v,rotationOriginX:v?(u.len-p.len)/2:0,rotationOriginY:v?(u.len+p.len)/2:0,scaleX:v?-1:1,scaleY:1}}removeEvents(o){let{eventsToUnbind:u}=this;o||qx(this),u.length&&(u.forEach(p=>{p()}),u.length=0)}render(){var N,z,j,q,K;let o=this,{chart:u,options:p,hasRendered:x}=o,v=Yr(p.animation),S=o.visible?"inherit":"hidden",A=p.zIndex,I=u.seriesGroup,O=o.finishedAnimating?0:v.duration;pn(this,"render"),o.plotGroup("group","series",S,A,I),o.markerGroup=o.plotGroup("markerGroup","markers",S,A,I),p.clip!==!1&&o.setClip(),O&&((N=o.animate)==null||N.call(o,!0)),o.drawGraph&&(o.drawGraph(),o.applyZones()),o.visible&&o.drawPoints(),(z=o.drawDataLabels)==null||z.call(o),(j=o.redrawPoints)==null||j.call(o),p.enableMouseTracking&&((q=o.drawTracker)==null||q.call(o)),O&&((K=o.animate)==null||K.call(o)),x||(O&&v.defer&&(O+=v.defer),o.animationTimeout=op(()=>{o.afterAnimate()},O||0)),o.isDirty=!1,o.hasRendered=!0,pn(o,"afterRender")}redraw(){let o=this.isDirty||this.isDirtyData;this.translate(),this.render(),o&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(o,u){let{xAxis:p,yAxis:x}=this,v=this.chart.inverted;return this.searchKDTree({clientX:v?p.len-o.chartY+p.pos:o.chartX-p.pos,plotY:v?x.len-o.chartX+x.pos:o.chartY-x.pos},u,o)}buildKDTree(o){this.buildingKdTree=!0;let u=this,p=u.options,x=p.findNearestPointBy.indexOf("y")>-1?2:1;delete u.kdTree,op(function(){u.kdTree=function v(S,A,I){let O,N,z=S==null?void 0:S.length;if(z)return O=u.kdAxisArray[A%I],S.sort((j,q)=>(j[O]||0)-(q[O]||0)),{point:S[N=Math.floor(z/2)],left:v(S.slice(0,N),A+1,I),right:v(S.slice(N+1),A+1,I)}}(u.getValidPoints(void 0,!u.directTouch,p==null?void 0:p.nullInteraction),x,x),u.buildingKdTree=!1},p.kdNow||(o==null?void 0:o.type)==="touchstart"?0:1)}searchKDTree(o,u,p,x,v){let S=this,[A,I]=this.kdAxisArray,O=u?"distX":"dist",N=(S.options.findNearestPointBy||"").indexOf("y")>-1?2:1,z=!!S.isBubble,j=x||((K,se,re)=>{let te=K[re]||0,ce=se[re]||0;return[te===ce&&K.index>se.index||te<ce?K:se,!1]}),q=v||((K,se)=>K<se);if(this.kdTree||this.buildingKdTree||this.buildKDTree(p),this.kdTree)return function K(se,re,te,ce){var Bt;let fe=re.point,Xe=S.kdAxisArray[te%ce],Ne=fe,$e=!1;(function(Jt,ii){var lr;let Ft=Jt[A],ui=ii[A],gi=wn(Ft)&&wn(ui)?Ft-ui:null,Ui=Jt[I],wi=ii[I],ji=wn(Ui)&&wn(wi)?Ui-wi:0,_r=z&&((lr=ii.marker)==null?void 0:lr.radius)||0;ii.dist=Math.sqrt((gi&&gi*gi||0)+ji*ji)-_r,ii.distX=wn(gi)?Math.abs(gi)-_r:Number.MAX_VALUE})(se,fe);let mt=(se[Xe]||0)-(fe[Xe]||0)+(z&&((Bt=fe.marker)==null?void 0:Bt.radius)||0),tt=mt<0?"left":"right",gt=mt<0?"right":"left";return re[tt]&&([Ne,$e]=j(fe,K(se,re[tt],te+1,ce),O)),re[gt]&&q(Math.sqrt(mt*mt),Ne[O],$e)&&(Ne=j(Ne,K(se,re[gt],te+1,ce),O)[0]),Ne}(o,this.kdTree,N,N)}pointPlacementToXValue(){let{options:o,xAxis:u}=this,p=o.pointPlacement;return p==="between"&&(p=u.reversed?-.5:.5),Hn(p)?p*(o.pointRange||u.pointRange):0}isPointInside(o){let{chart:u,xAxis:p,yAxis:x}=this,{plotX:v=-1,plotY:S=-1}=o;return S>=0&&S<=(x?x.len:u.plotHeight)&&v>=0&&v<=(p?p.len:u.plotWidth)}drawTracker(){var j;let o=this,u=o.options,p=u.trackByArea,x=[].concat((p?o.areaPath:o.graphPath)||[]),v=o.chart,S=v.pointer,A=v.renderer,I=((j=v.options.tooltip)==null?void 0:j.snap)||0,O=()=>{u.enableMouseTracking&&v.hoverSeries!==o&&o.onMouseOver()},N="rgba(192,192,192,"+(Ss?1e-4:.002)+")",z=o.tracker;z?z.attr({d:x}):o.graph&&(o.tracker=z=A.path(x).attr({visibility:o.visible?"inherit":"hidden",zIndex:2}).addClass(p?"highcharts-tracker-area":"highcharts-tracker-line").add(o.group),v.styledMode||z.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:N,fill:p?N:"none","stroke-width":o.graph.strokeWidth()+(p?0:2*I)}),[o.tracker,o.markerGroup,o.dataLabelsGroup].forEach(q=>{q&&(q.addClass("highcharts-tracker").on("mouseover",O).on("mouseout",K=>{S==null||S.onTrackerMouseOut(K)}),u.cursor&&!v.styledMode&&q.css({cursor:u.cursor}),q.on("touchstart",O))})),pn(this,"afterDrawTracker")}addPoint(o,u,p,x,v){let S,A,I=this.options,{chart:O,data:N,dataTable:z,xAxis:j}=this,q=(j==null?void 0:j.hasNames)&&j.names,K=I.data,se=this.getColumn("x");u=Mn(u,!0);let re={series:this};this.pointClass.prototype.applyOptions.apply(re,[o]);let te=re.x;if(A=se.length,this.requireSorting&&te<se[A-1])for(S=!0;A&&se[A-1]>te;)A--;z.setRow(re,A,!0,{addColumns:!1}),q&&re.name&&(q[te]=re.name),K==null||K.splice(A,0,o),(S||this.processedData)&&(this.data.splice(A,0,null),this.processData()),I.legendType==="point"&&this.generatePoints(),p&&(N[0]&&N[0].remove?N[0].remove(!1):([N,K].filter(wn).forEach(ce=>{ce.shift()}),z.deleteRows(0))),v!==!1&&pn(this,"addPoint",{point:re}),this.isDirty=!0,this.isDirtyData=!0,u&&O.redraw(x)}removePoint(o,u,p){let x=this,{chart:v,data:S,points:A,dataTable:I}=x,O=S[o],N=function(){[(A==null?void 0:A.length)===S.length?A:void 0,S,x.options.data].filter(wn).forEach(z=>{z.splice(o,1)}),I.deleteRows(o),O==null||O.destroy(),x.isDirty=!0,x.isDirtyData=!0,u&&v.redraw()};Vr(p,v),u=Mn(u,!0),O?O.firePointEvent("remove",null,N):N()}remove(o,u,p,x){let v=this,S=v.chart;function A(){v.destroy(x),S.isDirtyLegend=S.isDirtyBox=!0,S.linkSeries(x),Mn(o,!0)&&S.redraw(u)}p!==!1?pn(v,"remove",null,A):A()}update(o,u){var te,ce;pn(this,"update",{options:o=zd(o,this.userOptions)});let p=this,x=p.chart,v=p.userOptions,S=p.initialType||p.type,A=x.options.plotOptions,I=qn[S].prototype,O=p.finishedAnimating&&{animation:!1},N={},z,j,q=Ws.keepProps.slice(),K=o.type||v.type||x.options.chart.type,se=!(this.hasDerivedData||K&&K!==this.type||o.keys!==void 0||o.pointStart!==void 0||o.pointInterval!==void 0||o.relativeXValue!==void 0||o.joinBy||o.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(fe=>p.hasOptionChanged(fe)));K=K||S,se?(q.push.apply(q,Ws.keepPropsForPoints),o.visible!==!1&&q.push("area","graph"),p.parallelArrays.forEach(function(fe){q.push(fe+"Data")}),o.data&&(o.dataSorting&&du(p.options.dataSorting,o.dataSorting),this.setData(o.data,!1))):this.dataTable.modified=this.dataTable,o=fu(v,{index:v.index===void 0?p.index:v.index,pointStart:((te=A==null?void 0:A.series)==null?void 0:te.pointStart)??v.pointStart??p.getColumn("x")[0]},!se&&{data:p.options.data},o,O),se&&o.data&&(o.data=p.options.data),(q=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(q)).forEach(function(fe){q[fe]=p[fe],delete p[fe]});let re=!1;if(qn[K]){if(re=K!==p.type,p.remove(!1,!1,!1,!0),re)if(x.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(p,qn[K].prototype);else{let fe=Object.hasOwnProperty.call(p,"hcEvents")&&p.hcEvents;for(j in I)p[j]=void 0;du(p,qn[K].prototype),fe?p.hcEvents=fe:delete p.hcEvents}}else Bd(17,!0,x,{missingModuleFor:K});if(q.forEach(function(fe){p[fe]=q[fe]}),p.init(x,o),se&&this.points)for(let fe of((z=p.options).visible===!1?(N.graphic=1,N.dataLabel=1):(this.hasMarkerChanged(z,v)&&(N.graphic=1),(ce=p.hasDataLabels)!=null&&ce.call(p)||(N.dataLabel=1)),this.points))fe!=null&&fe.series&&(fe.resolveColor(),Object.keys(N).length&&fe.destroyElements(N),z.showInLegend===!1&&fe.legendItem&&x.legend.destroyItem(fe));p.initialType=S,x.linkSeries(),x.setSortedData(),re&&p.linkedSeries.length&&(p.isDirtyData=!0),pn(this,"afterUpdate"),Mn(u,!0)&&x.redraw(!!se&&void 0)}setName(o){this.name=this.options.name=this.userOptions.name=o,this.chart.isDirtyLegend=!0}hasOptionChanged(o){var A,I;let u=this.chart,p=this.options[o],x=u.options.plotOptions,v=this.userOptions[o],S=Mn((A=x==null?void 0:x[this.type])==null?void 0:A[o],(I=x==null?void 0:x.series)==null?void 0:I[o]);return v&&!wn(S)?p!==v:p!==Mn(S,p)}onMouseOver(){let o=this.chart,u=o.hoverSeries,p=o.pointer;p==null||p.setHoverChartIndex(),u&&u!==this&&u.onMouseOut(),this.options.events.mouseOver&&pn(this,"mouseOver"),this.setState("hover"),o.hoverSeries=this}onMouseOut(){let o=this.options,u=this.chart,p=u.tooltip,x=u.hoverPoint;u.hoverSeries=null,x&&x.onMouseOut(),this&&o.events.mouseOut&&pn(this,"mouseOut"),p&&!this.stickyTracking&&(!p.shared||this.noSharedTooltip)&&p.hide(),u.series.forEach(function(v){v.setState("",!0)})}setState(o,u){let p=this,x=p.options,v=p.graph,S=x.inactiveOtherPoints,A=x.states,I=Mn(A[o||"normal"]&&A[o||"normal"].animation,p.chart.options.chart.animation),O=x.lineWidth,N=x.opacity;if(o=o||"",p.state!==o&&([p.group,p.markerGroup,p.dataLabelsGroup].forEach(function(z){z&&(p.state&&z.removeClass("highcharts-series-"+p.state),o&&z.addClass("highcharts-series-"+o))}),p.state=o,!p.chart.styledMode)){if(A[o]&&A[o].enabled===!1)return;if(o&&(O=A[o].lineWidth||O+(A[o].lineWidthPlus||0),N=Mn(A[o].opacity,N)),v&&!v.dashstyle&&Hn(O))for(let z of[v,...this.zones.map(j=>j.graph)])z==null||z.animate({"stroke-width":O},I);S||[p.group,p.markerGroup,p.dataLabelsGroup,p.labelBySeries].forEach(function(z){z&&z.animate({opacity:N},I)})}u&&S&&p.points&&p.setAllPointsToState(o||void 0)}setAllPointsToState(o){this.points.forEach(function(u){u.setState&&u.setState(o)})}setVisible(o,u){var I;let p=this,x=p.chart,v=x.options.chart.ignoreHiddenSeries,S=p.visible;p.visible=o=p.options.visible=p.userOptions.visible=o===void 0?!S:o;let A=o?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(O=>{var N;(N=p[O])==null||N[A]()}),(x.hoverSeries===p||((I=x.hoverPoint)==null?void 0:I.series)===p)&&p.onMouseOut(),p.legendItem&&x.legend.colorizeItem(p,o),p.isDirty=!0,p.options.stacking&&x.series.forEach(O=>{O.options.stacking&&O.visible&&(O.isDirty=!0)}),p.linkedSeries.forEach(O=>{O.setVisible(o,!1)}),v&&(x.isDirtyBox=!0),pn(p,A),u!==!1&&x.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(o){this.selected=o=this.options.selected=o===void 0?!this.selected:o,this.checkbox&&(this.checkbox.checked=o),pn(this,o?"select":"unselect")}shouldShowTooltip(o,u,p={}){return p.series=this,p.visiblePlotOnly=!0,this.chart.isInsidePlot(o,u,p)}drawLegendSymbol(o,u){var p;(p=Or[this.options.legendSymbol||"rectangle"])==null||p.call(this,o,u)}}Ws.defaultOptions={lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:R}=this.series.chart;return typeof this.y!="number"?"":R(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},Ws.types=Pr.seriesTypes,Ws.registerType=Pr.registerSeriesType,Ws.keepProps=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],Ws.keepPropsForPoints=["data","isDirtyData","isDirtyCanvas","points","dataTable","processedData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"],du(Ws.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:ee,requireSorting:!0,sorted:!0}),Pr.series=Ws;let ys=Ws,{animObject:El,setAnimation:Ca}=Cn,{registerEventOptions:Sl}=Kc,{composed:pc,marginNames:mc}=ke,{distribute:Xx}=Ua,{format:Zx}=fs,{addEvent:ap,createElement:Yx,css:x_,defined:lp,discardElement:Aa,find:Kx,fireEvent:Cl,isNumber:In,merge:Mi,pick:ls,pushUnique:cp,relativeLength:so,stableSort:v_,syncTimeout:b_}=xe;class Ao{constructor(o,u){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=o,this.setOptions(u),u.enabled&&(this.render(),Sl(this,u),ap(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),ap(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(o){let u=ls(o.padding,8);this.options=o,this.chart.styledMode||(this.itemStyle=o.itemStyle,this.itemHiddenStyle=Mi(this.itemStyle,o.itemHiddenStyle)),this.itemMarginTop=o.itemMarginTop,this.itemMarginBottom=o.itemMarginBottom,this.padding=u,this.initialItemY=u-5,this.symbolWidth=ls(o.symbolWidth,16),this.pages=[],this.proximate=o.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(o,u){let p=this.chart;this.setOptions(Mi(!0,this.options,o)),"events"in this.options&&Sl(this,this.options),this.destroy(),p.isDirtyLegend=p.isDirtyBox=!0,ls(u,!0)&&p.redraw(),Cl(this,"afterUpdate",{redraw:u})}colorizeItem(o,u){var O;let p=o.color,{area:x,group:v,label:S,line:A,symbol:I}=o.legendItem||{};if((o instanceof ys||o instanceof ee)&&(o.color=((O=o.options)==null?void 0:O.legendSymbolColor)||p),v==null||v[u?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:N={}}=this,z=N.color,{fillColor:j,fillOpacity:q,lineColor:K,marker:se}=o.options,re=te=>(!u&&(te.fill&&(te.fill=z),te.stroke&&(te.stroke=z)),te);S==null||S.css(Mi(u?this.itemStyle:N)),A==null||A.attr(re({stroke:K||o.color})),I&&I.attr(re(se&&I.isMarker?o.pointAttribs():{fill:o.color})),x==null||x.attr(re({fill:j||o.color,"fill-opacity":j?1:q??.75}))}o.color=p,Cl(this,"afterColorizeItem",{item:o,visible:u})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(o){let{group:u,x:p=0,y:x=0}=o.legendItem||{},v=this.options,S=v.symbolPadding,A=!v.rtl,I=o.checkbox;if(u!=null&&u.element){let O={translateX:A?p:this.legendWidth-p-2*S-4,translateY:x};u[lp(u.translateY)?"animate":"attr"](O,void 0,()=>{Cl(this,"afterPositionItem",{item:o})})}I&&(I.x=p,I.y=x)}destroyItem(o){let u=o.checkbox,p=o.legendItem||{};for(let x of["group","label","line","symbol"])p[x]&&(p[x]=p[x].destroy());u&&Aa(u),o.legendItem=void 0}destroy(){for(let o of this.getAllItems())this.destroyItem(o);for(let o of["clipRect","up","down","pager","nav","box","title","group"])this[o]&&(this[o]=this[o].destroy());this.display=null}positionCheckboxes(){var v;let o,u=(v=this.group)==null?void 0:v.alignAttr,p=this.clipHeight||this.legendHeight,x=this.titleHeight;u&&(o=u.translateY,this.allItems.forEach(function(S){let A,I=S.checkbox;I&&(A=o+x+I.y+(this.scrollOffset||0)+3,x_(I,{left:u.translateX+S.checkboxOffset+I.x-20+"px",top:A+"px",display:this.proximate||A>o-6&&A<o+p-6?"":"none"}))},this))}renderTitle(){let o=this.options,u=this.padding,p=o.title,x,v=0;p.text&&(this.title||(this.title=this.chart.renderer.label(p.text,u-3,u-4,void 0,void 0,void 0,o.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(p.style),this.title.add(this.group)),p.width||this.title.css({width:this.maxLegendWidth+"px"}),v=(x=this.title.getBBox()).height,this.offsetWidth=x.width,this.contentGroup.attr({translateY:v})),this.titleHeight=v}setText(o){let u=this.options;o.legendItem.label.attr({text:u.labelFormat?Zx(u.labelFormat,o,this.chart):u.labelFormatter.call(o)})}renderItem(o){var mt;let u=o.legendItem=o.legendItem||{},p=this.chart,x=p.renderer,v=this.options,S=v.layout==="horizontal",A=this.symbolWidth,I=v.symbolPadding||0,O=this.itemStyle,N=this.itemHiddenStyle,z=S?ls(v.itemDistance,20):0,j=!v.rtl,q=!o.series,K=!q&&o.series.drawLegendSymbol?o.series:o,se=K.options,re=!!this.createCheckboxForItem&&se&&se.showCheckbox,te=v.useHTML,ce=o.options.className,fe=u.label,Xe=A+I+z+20*!!re;!fe&&(u.group=x.g("legend-item").addClass("highcharts-"+K.type+"-series highcharts-color-"+o.colorIndex+(ce?" "+ce:"")+(q?" highcharts-series-"+o.index:"")).attr({zIndex:1}).add(this.scrollGroup),u.label=fe=x.text("",j?A+I:-I,this.baseline||0,te),p.styledMode||fe.css(Mi(o.visible?O:N)),fe.attr({align:j?"left":"right",zIndex:2}).add(u.group),!this.baseline&&(this.fontMetrics=x.fontMetrics(fe),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,fe.attr("y",this.baseline),this.symbolHeight=ls(v.symbolHeight,this.fontMetrics.f),v.squareSymbol&&(this.symbolWidth=ls(v.symbolWidth,Math.max(this.symbolHeight,16)),Xe=this.symbolWidth+I+z+20*!!re,j&&fe.attr("x",this.symbolWidth+I))),K.drawLegendSymbol(this,o),this.setItemEvents&&this.setItemEvents(o,fe,te)),re&&!o.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(o),this.colorizeItem(o,o.visible),(p.styledMode||!O.width)&&fe.css({width:(v.itemWidth||this.widthOption||p.spacingBox.width)-Xe+"px"}),this.setText(o);let Ne=fe.getBBox(),$e=((mt=this.fontMetrics)==null?void 0:mt.h)||0;o.itemWidth=o.checkboxOffset=v.itemWidth||u.labelWidth||Ne.width+Xe,this.maxItemWidth=Math.max(this.maxItemWidth,o.itemWidth),this.totalItemWidth+=o.itemWidth,this.itemHeight=o.itemHeight=Math.round(u.labelHeight||(Ne.height>1.5*$e?Ne.height:$e))}layoutItem(o){let u=this.options,p=this.padding,x=u.layout==="horizontal",v=o.itemHeight,S=this.itemMarginBottom,A=this.itemMarginTop,I=x?ls(u.itemDistance,20):0,O=this.maxLegendWidth,N=u.alignColumns&&this.totalItemWidth>O?this.maxItemWidth:o.itemWidth,z=o.legendItem||{};x&&this.itemX-p+N>O&&(this.itemX=p,this.lastLineHeight&&(this.itemY+=A+this.lastLineHeight+S),this.lastLineHeight=0),this.lastItemY=A+this.itemY+S,this.lastLineHeight=Math.max(v,this.lastLineHeight),z.x=this.itemX,z.y=this.itemY,x?this.itemX+=N:(this.itemY+=A+v+S,this.lastLineHeight=v),this.offsetWidth=this.widthOption||Math.max((x?this.itemX-p-(o.checkbox?0:I):N)+p,this.offsetWidth)}getAllItems(){let o=[];return this.chart.series.forEach(function(u){var x;let p=u==null?void 0:u.options;u&&ls(p.showInLegend,!lp(p.linkedTo)&&void 0,!0)&&(o=o.concat(((x=u.legendItem)==null?void 0:x.labels)||(p.legendType==="point"?u.data:u)))}),Cl(this,"afterGetAllItems",{allItems:o}),o}getAlignment(){let o=this.options;return this.proximate?o.align.charAt(0)+"tv":o.floating?"":o.align.charAt(0)+o.verticalAlign.charAt(0)+o.layout.charAt(0)}adjustMargins(o,u){let p=this.chart,x=this.options,v=this.getAlignment();v&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(S,A){S.test(v)&&!lp(o[A])&&(p[mc[A]]=Math.max(p[mc[A]],p.legend[(A+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][A]*x[A%2?"x":"y"]+ls(x.margin,12)+u[A]+(p.titleOffset[A]||0)))})}proximatePositions(){let o,u=this.chart,p=[],x=this.options.align==="left";for(let v of(this.allItems.forEach(function(S){let A,I,O=x,N,z;S.yAxis&&(S.xAxis.options.reversed&&(O=!O),S.points&&(A=Kx(O?S.points:S.points.slice(0).reverse(),function(j){return In(j.plotY)})),I=this.itemMarginTop+S.legendItem.label.getBBox().height+this.itemMarginBottom,z=S.yAxis.top-u.plotTop,N=S.visible?(A?A.plotY:S.yAxis.height)+(z-.3*I):z+S.yAxis.height,p.push({target:N,size:I,item:S}))},this),Xx(p,u.plotHeight)))o=v.item.legendItem||{},In(v.pos)&&(o.y=u.plotTop-u.spacing[0]+v.pos)}render(){let o=this.chart,u=o.renderer,p=this.options,x=this.padding,v=this.getAllItems(),S,A,I,O=this.group,N,z=this.box;this.itemX=x,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=so(p.width,o.spacingBox.width-x),N=o.spacingBox.width-2*x-p.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(N/=2),this.maxLegendWidth=this.widthOption||N,O||(this.group=O=u.g("legend").addClass(p.className||"").attr({zIndex:7}).add(),this.contentGroup=u.g().attr({zIndex:1}).add(O),this.scrollGroup=u.g().add(this.contentGroup)),this.renderTitle(),v_(v,(j,q)=>{var K,se;return(((K=j.options)==null?void 0:K.legendIndex)||0)-(((se=q.options)==null?void 0:se.legendIndex)||0)}),p.reversed&&v.reverse(),this.allItems=v,this.display=S=!!v.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,v.forEach(this.renderItem,this),v.forEach(this.layoutItem,this),A=(this.widthOption||this.offsetWidth)+x,I=this.lastItemY+this.lastLineHeight+this.titleHeight,I=this.handleOverflow(I)+x,z||(this.box=z=u.rect().addClass("highcharts-legend-box").attr({r:p.borderRadius}).add(O)),o.styledMode||z.attr({stroke:p.borderColor,"stroke-width":p.borderWidth||0,fill:p.backgroundColor||"none"}).shadow(p.shadow),A>0&&I>0&&z[z.placed?"animate":"attr"](z.crisp.call({},{x:0,y:0,width:A,height:I},z.strokeWidth())),O[S?"show":"hide"](),o.styledMode&&O.getStyle("display")==="none"&&(A=I=0),this.legendWidth=A,this.legendHeight=I,S&&this.align(),this.proximate||this.positionItems(),Cl(this,"afterRender")}align(o=this.chart.spacingBox){let u=this.chart,p=this.options,x=o.y;/(lth|ct|rth)/.test(this.getAlignment())&&u.titleOffset[0]>0?x+=u.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&u.titleOffset[2]>0&&(x-=u.titleOffset[2]),x!==o.y&&(o=Mi(o,{y:x})),u.hasRendered||(this.group.placed=!1),this.group.align(Mi(p,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":p.verticalAlign}),!0,o)}handleOverflow(o){let u=this,p=this.chart,x=p.renderer,v=this.options,S=v.y,A=v.verticalAlign==="top",I=this.padding,O=v.maxHeight,N=v.navigation,z=ls(N.animation,!0),j=N.arrowSize||12,q=this.pages,K=this.allItems,se=function(tt){typeof tt=="number"?mt.attr({height:tt}):mt&&(u.clipRect=mt.destroy(),u.contentGroup.clip()),u.contentGroup.div&&(u.contentGroup.div.style.clip=tt?"rect("+I+"px,9999px,"+(I+tt)+"px,0)":"auto")},re=function(tt){return u[tt]=x.circle(0,0,1.3*j).translate(j/2,j/2).add($e),p.styledMode||u[tt].attr("fill","rgba(0,0,0,0.0001)"),u[tt]},te,ce,fe,Xe,Ne=p.spacingBox.height+(A?-S:S)-I,$e=this.nav,mt=this.clipRect;return v.layout!=="horizontal"||v.verticalAlign==="middle"||v.floating||(Ne/=2),O&&(Ne=Math.min(Ne,O)),q.length=0,o&&Ne>0&&o>Ne&&N.enabled!==!1?(this.clipHeight=te=Math.max(Ne-20-this.titleHeight-I,0),this.currentPage=ls(this.currentPage,1),this.fullHeight=o,K.forEach((tt,gt)=>{let Bt=(fe=tt.legendItem||{}).y||0,Jt=Math.round(fe.label.getBBox().height),ii=q.length;(!ii||Bt-q[ii-1]>te&&(ce||Bt)!==q[ii-1])&&(q.push(ce||Bt),ii++),fe.pageIx=ii-1,ce&&Xe&&(Xe.pageIx=ii-1),gt===K.length-1&&Bt+Jt-q[ii-1]>te&&Bt>q[ii-1]&&(q.push(Bt),fe.pageIx=ii),Bt!==ce&&(ce=Bt),Xe=fe}),mt||(mt=u.clipRect=x.clipRect(0,I-2,9999,0),u.contentGroup.clip(mt)),se(te),$e||(this.nav=$e=x.g().attr({zIndex:1}).add(this.group),this.up=x.symbol("triangle",0,0,j,j).add($e),re("upTracker").on("click",function(){u.scroll(-1,z)}),this.pager=x.text("",15,10).addClass("highcharts-legend-navigation"),!p.styledMode&&N.style&&this.pager.css(N.style),this.pager.add($e),this.down=x.symbol("triangle-down",0,0,j,j).add($e),re("downTracker").on("click",function(){u.scroll(1,z)})),u.scroll(0),o=Ne):$e&&(se(),this.nav=$e.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),o}scroll(o,u){let p=this.chart,x=this.pages,v=x.length,S=this.clipHeight,A=this.options.navigation,I=this.pager,O=this.padding,N=this.currentPage+o;N>v&&(N=v),N>0&&(u!==void 0&&Ca(u,p),this.nav.attr({translateX:O,translateY:S+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(z){z.attr({class:N===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),I.attr({text:N+"/"+v}),[this.down,this.downTracker].forEach(function(z){z.attr({x:18+this.pager.getBBox().width,class:N===v?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),p.styledMode||(this.up.attr({fill:N===1?A.inactiveColor:A.activeColor}),this.upTracker.css({cursor:N===1?"default":"pointer"}),this.down.attr({fill:N===v?A.inactiveColor:A.activeColor}),this.downTracker.css({cursor:N===v?"default":"pointer"})),this.scrollOffset=-x[N-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=N,this.positionCheckboxes(),b_(()=>{Cl(this,"afterScroll",{currentPage:N})},El(ls(u,p.renderer.globalAnimation,!0)).duration))}setItemEvents(o,u,p){let x=this,v=o.legendItem||{},S=x.chart.renderer.boxWrapper,A=o instanceof ee,I=o instanceof ys,O="highcharts-legend-"+(A?"point":"series")+"-active",N=x.chart.styledMode,z=p?[u,v.symbol]:[v.group],j=q=>{x.allItems.forEach(K=>{o!==K&&[K].concat(K.linkedSeries||[]).forEach(se=>{se.setState(q,!A)})})};for(let q of z)q&&q.on("mouseover",function(){o.visible&&j("inactive"),o.setState("hover"),o.visible&&S.addClass(O),N||u.css(x.options.itemHoverStyle)}).on("mouseout",function(){x.chart.styledMode||u.css(Mi(o.visible?x.itemStyle:x.itemHiddenStyle)),j(""),S.removeClass(O),o.setState()}).on("click",function(K){let se=function(){o.setVisible&&o.setVisible(),j(o.visible?"inactive":"")};S.removeClass(O),Cl(x,"itemClick",{browserEvent:K,legendItem:o},se),A?o.firePointEvent("legendItemClick",{browserEvent:K}):I&&Cl(o,"legendItemClick",{browserEvent:K})})}createCheckboxForItem(o){o.checkbox=Yx("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:o.selected,defaultChecked:o.selected},this.options.itemCheckboxStyle,this.chart.container),ap(o.checkbox,"click",function(u){let p=u.target;Cl(o.series||o,"checkboxClick",{checked:p.checked,item:o},function(){o.select()})})}}(function(R){R.compose=function(o){cp(pc,"Core.Legend")&&ap(o,"beforeMargins",function(){this.legend=new R(this,this.options.legend)})}})(Ao||(Ao={}));let hp=Ao,{animate:Al,animObject:Nd,setAnimation:Ml}=Cn,{defaultOptions:Ud}=Le,{numberFormat:up}=fs,{registerEventOptions:Fm}=Kc,{charts:gc,doc:Vd,marginNames:dp,svg:w_,win:pu}=ke,{seriesTypes:_c}=Pr,{addEvent:Ma,attr:fp,createElement:pp,css:Hs,defined:Jo,diffObjects:oo,discardElement:jd,erase:Bs,error:ao,extend:Ya,find:mn,fireEvent:Er,getAlignFactor:$d,getStyle:Mo,isArray:Jx,isNumber:mu,isObject:T_,isString:Gd,merge:Fs,objectEach:mp,pick:xs,pInt:E_,relativeLength:Nm,removeEvent:S_,splat:gp,syncTimeout:C_,uniqueKey:A_}=xe;class Qo{static chart(o,u,p){return new Qo(o,u,p)}constructor(o,u,p){this.sharedClips={};let x=[...arguments];(Gd(o)||o.nodeName)&&(this.renderTo=x.shift()),this.init(x[0],x[1])}setZoomOptions(){let o=this.options.chart,u=o.zooming;this.zooming={...u,type:xs(o.zoomType,u.type),key:xs(o.zoomKey,u.key),pinchType:xs(o.pinchType,u.pinchType),singleTouch:xs(o.zoomBySingleTouch,u.singleTouch,!1),resetButton:Fs(u.resetButton,o.resetZoomButton)}}init(o,u){Er(this,"init",{args:arguments},function(){var S;let p=Fs(Ud,o),x=p.chart,v=this.renderTo||x.renderTo;this.userOptions=Ya({},o),(this.renderTo=Gd(v)?Vd.getElementById(v):v)||ao(13,!0,this),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=u,this.isResizing=0,this.options=p,this.axes=[],this.series=[],this.locale=p.lang.locale??((S=this.renderTo.closest("[lang]"))==null?void 0:S.lang),this.time=new us(Ya(p.time||{},{locale:this.locale}),p.lang),p.time=this.time.options,this.numberFormatter=(x.numberFormatter||up).bind(this),this.styledMode=x.styledMode,this.hasCartesianSeries=x.showAxes,this.index=gc.length,gc.push(this),ke.chartCount++,Fm(this,x),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),Er(this,"afterInit"),this.firstRender()})}initSeries(o){let u=this.options.chart,p=o.type||u.type,x=_c[p];x||ao(17,!0,this,{missingModuleFor:p});let v=new x;return typeof v.init=="function"&&v.init(this,o),v}setSortedData(){this.getSeriesOrderByLinks().forEach(function(o){o.points||o.data||!o.enabledDataSorting||o.setData(o.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(o,u){return o.linkedSeries.length||u.linkedSeries.length?u.linkedSeries.length-o.linkedSeries.length:0})}orderItems(o,u=0){let p=this[o],x=this.options[o]=gp(this.options[o]).slice(),v=this.userOptions[o]=this.userOptions[o]?gp(this.userOptions[o]).slice():[];if(this.hasRendered&&(x.splice(u),v.splice(u)),p)for(let S=u,A=p.length;S<A;++S){let I=p[S];I&&(I.index=S,I instanceof ys&&(I.name=I.getName()),I.options.isInternal||(x[S]=I.options,v[S]=I.userOptions))}}getClipBox(o,u){var N,z;let p=this.inverted,{xAxis:x,yAxis:v}=o||{},{x:S,y:A,width:I,height:O}=Fs(this.clipBox);return o&&(x&&x.len!==this.plotSizeX&&(I=x.len),v&&v.len!==this.plotSizeY&&(O=v.len),p&&!o.invertible&&([I,O]=[O,I])),u&&(S+=((N=p?v:x)==null?void 0:N.pos)??this.plotLeft,A+=((z=p?x:v)==null?void 0:z.pos)??this.plotTop),{x:S,y:A,width:I,height:O}}isInsidePlot(o,u,p={}){var re;let{inverted:x,plotBox:v,plotLeft:S,plotTop:A,scrollablePlotBox:I}=this,{scrollLeft:O=0,scrollTop:N=0}=p.visiblePlotOnly&&((re=this.scrollablePlotArea)==null?void 0:re.scrollingContainer)||{},z=p.series,j=p.visiblePlotOnly&&I||v,q=p.inverted?u:o,K=p.inverted?o:u,se={x:q,y:K,isInsidePlot:!0,options:p};if(!p.ignoreX){let te=z&&(x&&!this.polar?z.yAxis:z.xAxis)||{pos:S,len:1/0},ce=p.paneCoordinates?te.pos+q:S+q;ce>=Math.max(O+S,te.pos)&&ce<=Math.min(O+S+j.width,te.pos+te.len)||(se.isInsidePlot=!1)}if(!p.ignoreY&&se.isInsidePlot){let te=!x&&p.axis&&!p.axis.isXAxis&&p.axis||z&&(x?z.xAxis:z.yAxis)||{pos:A,len:1/0},ce=p.paneCoordinates?te.pos+K:A+K;ce>=Math.max(N+A,te.pos)&&ce<=Math.min(N+A+j.height,te.pos+te.len)||(se.isInsidePlot=!1)}return Er(this,"afterIsInsidePlot",se),se.isInsidePlot}redraw(o){Er(this,"beforeRedraw");let u=this.hasCartesianSeries?this.axes:this.colorAxis||[],p=this.series,x=this.pointer,v=this.legend,S=this.userOptions.legend,A=this.renderer,I=A.isHidden(),O=[],N,z,j,q=this.isDirtyBox,K=this.isDirtyLegend,se;for(A.rootFontSize=A.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),Ml(!!this.hasRendered&&o,this),I&&this.temporaryDisplay(),this.layOutTitles(!1),j=p.length;j--;)if(((se=p[j]).options.stacking||se.options.centerInCategory)&&(z=!0,se.isDirty)){N=!0;break}if(N)for(j=p.length;j--;)(se=p[j]).options.stacking&&(se.isDirty=!0);p.forEach(function(re){re.isDirty&&(re.options.legendType==="point"?(typeof re.updateTotals=="function"&&re.updateTotals(),K=!0):S&&(S.labelFormatter||S.labelFormat)&&(K=!0)),re.isDirtyData&&Er(re,"updatedData")}),K&&v&&v.options.enabled&&(v.render(),this.isDirtyLegend=!1),z&&this.getStacks(),u.forEach(function(re){re.updateNames(),re.setScale()}),this.getMargins(),u.forEach(function(re){re.isDirty&&(q=!0)}),u.forEach(function(re){let te=re.min+","+re.max;re.extKey!==te&&(re.extKey=te,O.push(function(){Er(re,"afterSetExtremes",Ya(re.eventArgs,re.getExtremes())),delete re.eventArgs})),(q||z)&&re.redraw()}),q&&this.drawChartBox(),Er(this,"predraw"),p.forEach(function(re){(q||re.isDirty)&&re.visible&&re.redraw(),re.isDirtyData=!1}),x&&x.reset(!0),A.draw(),Er(this,"redraw"),Er(this,"render"),I&&this.temporaryDisplay(!0),O.forEach(function(re){re.call()})}get(o){let u=this.series;function p(v){return v.id===o||v.options&&v.options.id===o}let x=mn(this.axes,p)||mn(this.series,p);for(let v=0;!x&&v<u.length;v++)x=mn(u[v].points||[],p);return x}createAxes(){let o=this.userOptions;for(let u of(Er(this,"createAxes"),["xAxis","yAxis"]))for(let p of o[u]=gp(o[u]||{}))new Ha(this,p,u);Er(this,"afterCreateAxes")}getSelectedPoints(){return this.series.reduce((o,u)=>(u.getPointsCollection().forEach(p=>{xs(p.selectedStaging,p.selected)&&o.push(p)}),o),[])}getSelectedSeries(){return this.series.filter(o=>o.selected)}setTitle(o,u,p){this.applyDescription("title",o),this.applyDescription("subtitle",u),this.applyDescription("caption",void 0),this.layOutTitles(p)}applyDescription(o,u){var S;let p=this,x=this.options[o]=Fs(this.options[o],u),v=this[o];v&&u&&(this[o]=v=v.destroy()),x&&!v&&((v=this.renderer.text(x.text,0,0,x.useHTML).attr({align:x.align,class:"highcharts-"+o,zIndex:x.zIndex||4}).css({textOverflow:"ellipsis",whiteSpace:"nowrap"}).add()).update=function(A,I){p.applyDescription(o,A),p.layOutTitles(I)},this.styledMode||v.css(Ya(o==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},x.style)),v.textPxLength=v.getBBox().width,v.css({whiteSpace:(S=x.style)==null?void 0:S.whiteSpace}),this[o]=v)}layOutTitles(o=!0){var A,I,O,N;let u=[0,0,0],{options:p,renderer:x,spacingBox:v}=this;["title","subtitle","caption"].forEach(z=>{var re;let j=this[z],q=this.options[z],K=Fs(v),se=(j==null?void 0:j.textPxLength)||0;if(j&&q){Er(this,"layOutTitle",{alignTo:K,key:z,textPxLength:se});let te=x.fontMetrics(j),ce=te.b,fe=te.h,Xe=q.verticalAlign||"top",Ne=Xe==="top",$e=Ne&&q.minScale||1,mt=z==="title"?Ne?-3:0:Ne?u[0]+2:0,tt=Math.min(K.width/se,1),gt=Math.max($e,tt),Bt=Fs({y:Xe==="bottom"?ce:mt+ce},{align:z==="title"?tt<$e?"left":"center":(re=this.title)==null?void 0:re.alignValue},q),Jt=(q.width||(tt>$e?this.chartWidth:K.width)/gt)+"px";j.alignValue!==Bt.align&&(j.placed=!1);let ii=Math.round(j.css({width:Jt}).getBBox(q.useHTML).height);if(Bt.height=ii,j.align(Bt,!1,K).attr({align:Bt.align,scaleX:gt,scaleY:gt,"transform-origin":`${K.x+se*gt*$d(Bt.align)} ${fe}`}),!q.floating){let Ft=ii*(ii<1.2*fe?1:gt);Xe==="top"?u[0]=Math.ceil(u[0]+Ft):Xe==="bottom"&&(u[2]=Math.ceil(u[2]+Ft))}}},this),u[0]&&(((A=p.title)==null?void 0:A.verticalAlign)||"top")==="top"&&(u[0]+=((I=p.title)==null?void 0:I.margin)||0),u[2]&&((O=p.caption)==null?void 0:O.verticalAlign)==="bottom"&&(u[2]+=((N=p.caption)==null?void 0:N.margin)||0);let S=!this.titleOffset||this.titleOffset.join(",")!==u.join(",");this.titleOffset=u,Er(this,"afterLayOutTitles"),!this.isDirtyBox&&S&&(this.isDirtyBox=this.isDirtyLegend=S,this.hasRendered&&o&&this.isDirtyBox&&this.redraw())}getContainerBox(){let o=[].map.call(this.renderTo.children,p=>{if(p!==this.container){let x=p.style.display;return p.style.display="none",[p,x]}}),u={width:Mo(this.renderTo,"width",!0)||0,height:Mo(this.renderTo,"height",!0)||0};return o.filter(Boolean).forEach(([p,x])=>{p.style.display=x}),u}getChartSize(){var S;let o=this.options.chart,u=o.width,p=o.height,x=this.getContainerBox(),v=x.height<=1||!((S=this.renderTo.parentElement)!=null&&S.style.height)&&this.renderTo.style.height==="100%";this.chartWidth=Math.max(0,u||x.width||600),this.chartHeight=Math.max(0,Nm(p,this.chartWidth)||(v?400:x.height)),this.containerBox=x}temporaryDisplay(o){let u=this.renderTo,p;if(o)for(;u!=null&&u.style;)u.hcOrigStyle&&(Hs(u,u.hcOrigStyle),delete u.hcOrigStyle),u.hcOrigDetached&&(Vd.body.removeChild(u),u.hcOrigDetached=!1),u=u.parentNode;else for(;u!=null&&u.style&&(Vd.body.contains(u)||u.parentNode||(u.hcOrigDetached=!0,Vd.body.appendChild(u)),(Mo(u,"display",!1)==="none"||u.hcOricDetached)&&(u.hcOrigStyle={display:u.style.display,height:u.style.height,overflow:u.style.overflow},p={display:"block",overflow:"hidden"},u!==this.renderTo&&(p.height=0),Hs(u,p),u.offsetWidth||u.style.setProperty("display","block","important")),(u=u.parentNode)!==Vd.body););}setClassName(o){this.container.className="highcharts-container "+(o||"")}getContainer(){var j,q;let o,u=this.options,p=u.chart,x="data-highcharts-chart",v=A_(),S=this.renderTo,A=E_(fp(S,x));mu(A)&&gc[A]&&gc[A].hasRendered&&gc[A].destroy(),fp(S,x,this.index),S.innerHTML=jr.emptyHTML,p.skipClone||S.offsetWidth||this.temporaryDisplay(),this.getChartSize();let I=this.chartHeight,O=this.chartWidth;Hs(S,{overflow:"hidden"}),this.styledMode||(o=Ya({position:"relative",overflow:"hidden",width:O+"px",height:I+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},p.style||{}));let N=pp("div",{id:v},o,S);this.container=N,this.getChartSize(),O===this.chartWidth||(O=this.chartWidth,this.styledMode||Hs(N,{width:xs((j=p.style)==null?void 0:j.width,O+"px")})),this.containerBox=this.getContainerBox(),this._cursor=N.style.cursor;let z=p.renderer||!w_?vo.getRendererType(p.renderer):Xc;if(this.renderer=new z(N,O,I,void 0,p.forExport,(q=u.exporting)==null?void 0:q.allowHTML,this.styledMode),Ml(void 0,this),this.setClassName(p.className),this.styledMode)for(let K in u.defs)this.renderer.definition(u.defs[K]);else this.renderer.setStyle(p.style);this.renderer.chartIndex=this.index,Er(this,"afterGetContainer")}getMargins(o){var v;let{spacing:u,margin:p,titleOffset:x}=this;this.resetMargins(),x[0]&&!Jo(p[0])&&(this.plotTop=Math.max(this.plotTop,x[0]+u[0])),x[2]&&!Jo(p[2])&&(this.marginBottom=Math.max(this.marginBottom,x[2]+u[2])),(v=this.legend)!=null&&v.display&&this.legend.adjustMargins(p,u),Er(this,"getMargins"),o||this.getAxisMargins()}getAxisMargins(){let o=this,u=o.axisOffset=[0,0,0,0],p=o.colorAxis,x=o.margin,v=function(S){S.forEach(function(A){A.visible&&A.getOffset()})};o.hasCartesianSeries?v(o.axes):p!=null&&p.length&&v(p),dp.forEach(function(S,A){Jo(x[A])||(o[S]+=u[A])}),o.setChartSize()}getOptions(){return oo(this.userOptions,Ud)}reflow(o){var v;let u=this,p=u.containerBox,x=u.getContainerBox();(v=u.pointer)==null||delete v.chartPosition,!u.isPrinting&&!u.isResizing&&p&&x.width&&((x.width!==p.width||x.height!==p.height)&&(xe.clearTimeout(u.reflowTimeout),u.reflowTimeout=C_(function(){u.container&&u.setSize(void 0,void 0,!1)},100*!!o)),u.containerBox=x)}setReflow(){let o=this,u=p=>{var x;(x=o.options)!=null&&x.chart.reflow&&o.hasLoaded&&o.reflow(p)};if(typeof ResizeObserver=="function")new ResizeObserver(u).observe(o.renderTo);else{let p=Ma(pu,"resize",u);Ma(this,"destroy",p)}}setSize(o,u,p){let x=this,v=x.renderer;x.isResizing+=1,Ml(p,x);let S=v.globalAnimation;x.oldChartHeight=x.chartHeight,x.oldChartWidth=x.chartWidth,o!==void 0&&(x.options.chart.width=o),u!==void 0&&(x.options.chart.height=u),x.getChartSize();let{chartWidth:A,chartHeight:I,scrollablePixelsX:O=0,scrollablePixelsY:N=0}=x;(x.isDirtyBox||A!==x.oldChartWidth||I!==x.oldChartHeight)&&(x.styledMode||(S?Al:Hs)(x.container,{width:`${A+O}px`,height:`${I+N}px`},S),x.setChartSize(!0),v.setSize(A,I,S),x.axes.forEach(function(z){z.isDirty=!0,z.setScale()}),x.isDirtyLegend=!0,x.isDirtyBox=!0,x.layOutTitles(),x.getMargins(),x.redraw(S),x.oldChartHeight=void 0,Er(x,"resize"),setTimeout(()=>{x&&Er(x,"endResize")},Nd(S).duration)),x.isResizing-=1}setChartSize(o){let u,p,x,v,{chartHeight:S,chartWidth:A,inverted:I,spacing:O,renderer:N}=this,z=this.clipOffset,j=Math[I?"floor":"round"];this.plotLeft=u=Math.round(this.plotLeft),this.plotTop=p=Math.round(this.plotTop),this.plotWidth=x=Math.max(0,Math.round(A-u-(this.marginRight??0))),this.plotHeight=v=Math.max(0,Math.round(S-p-(this.marginBottom??0))),this.plotSizeX=I?v:x,this.plotSizeY=I?x:v,this.spacingBox=N.spacingBox={x:O[3],y:O[0],width:A-O[3]-O[1],height:S-O[0]-O[2]},this.plotBox=N.plotBox={x:u,y:p,width:x,height:v},z&&(this.clipBox={x:j(z[3]),y:j(z[0]),width:j(this.plotSizeX-z[1]-z[3]),height:j(this.plotSizeY-z[0]-z[2])}),o||(this.axes.forEach(function(q){q.setAxisSize(),q.setAxisTranslation()}),N.alignElements()),Er(this,"afterSetChartSize",{skipAxes:o})}resetMargins(){Er(this,"resetMargins");let o=this,u=o.options.chart,p=u.plotBorderWidth||0,x=Math.round(p)/2;["margin","spacing"].forEach(function(v){let S=u[v],A=T_(S)?S:[S,S,S,S];["Top","Right","Bottom","Left"].forEach(function(I,O){o[v][O]=xs(u[v+I],A[O])})}),dp.forEach(function(v,S){o[v]=xs(o.margin[S],o.spacing[S])}),o.axisOffset=[0,0,0,0],o.clipOffset=[x,x,x,x],o.plotBorderWidth=p}drawChartBox(){let o=this.options.chart,u=this.renderer,p=this.chartWidth,x=this.chartHeight,v=this.styledMode,S=this.plotBGImage,A=o.backgroundColor,I=o.plotBackgroundColor,O=o.plotBackgroundImage,N=this.plotLeft,z=this.plotTop,j=this.plotWidth,q=this.plotHeight,K=this.plotBox,se=this.clipRect,re=this.clipBox,te=this.chartBackground,ce=this.plotBackground,fe=this.plotBorder,Xe,Ne,$e,mt="animate";te||(this.chartBackground=te=u.rect().addClass("highcharts-background").add(),mt="attr"),v?Xe=Ne=te.strokeWidth():(Ne=(Xe=o.borderWidth||0)+8*!!o.shadow,$e={fill:A||"none"},(Xe||te["stroke-width"])&&($e.stroke=o.borderColor,$e["stroke-width"]=Xe),te.attr($e).shadow(o.shadow)),te[mt]({x:Ne/2,y:Ne/2,width:p-Ne-Xe%2,height:x-Ne-Xe%2,r:o.borderRadius}),mt="animate",ce||(mt="attr",this.plotBackground=ce=u.rect().addClass("highcharts-plot-background").add()),ce[mt](K),!v&&(ce.attr({fill:I||"none"}).shadow(o.plotShadow),O&&(S?(O!==S.attr("href")&&S.attr("href",O),S.animate(K)):this.plotBGImage=u.image(O,N,z,j,q).add())),se?se.animate({width:re.width,height:re.height}):this.clipRect=u.clipRect(re),mt="animate",fe||(mt="attr",this.plotBorder=fe=u.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),v||fe.attr({stroke:o.plotBorderColor,"stroke-width":o.plotBorderWidth||0,fill:"none"}),fe[mt](fe.crisp(K,-fe.strokeWidth())),this.isDirtyBox=!1,Er(this,"afterDrawChartBox")}propFromSeries(){let o,u,p,x=this,v=x.options.chart,S=x.options.series;["inverted","angular","polar"].forEach(function(A){for(u=_c[v.type],p=v[A]||u&&u.prototype[A],o=S==null?void 0:S.length;!p&&o--;)(u=_c[S[o].type])&&u.prototype[A]&&(p=!0);x[A]=p})}linkSeries(o){let u=this,p=u.series;p.forEach(function(x){x.linkedSeries.length=0}),p.forEach(function(x){let{linkedTo:v}=x.options;if(Gd(v)){let S;(S=v===":previous"?u.series[x.index-1]:u.get(v))&&S.linkedParent!==x&&(S.linkedSeries.push(x),x.linkedParent=S,S.enabledDataSorting&&x.setDataSortingOptions(),x.visible=xs(x.options.visible,S.options.visible,x.visible))}}),Er(this,"afterLinkSeries",{isUpdating:o})}renderSeries(){this.series.forEach(function(o){o.translate(),o.render()})}render(){var N;let o=this.axes,u=this.colorAxis,p=this.renderer,x=this.options.chart.axisLayoutRuns||2,v=z=>{z.forEach(j=>{j.visible&&j.render()})},S=0,A=!0,I,O=0;for(let z of(this.setTitle(),Er(this,"beforeMargins"),(N=this.getStacks)==null||N.call(this),this.getMargins(!0),this.setChartSize(),o)){let{options:j}=z,{labels:q}=j;if(this.hasCartesianSeries&&z.horiz&&z.visible&&q.enabled&&z.series.length&&z.coll!=="colorAxis"&&!this.polar){S=j.tickLength,z.createGroups();let K=new ba(z,0,"",!0),se=K.createLabel("x",q);if(K.destroy(),se&&xs(q.reserveSpace,!mu(j.crossing))&&(S=se.getBBox().height+q.distance+Math.max(j.offset||0,0)),S){se==null||se.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-S,0);(A||I||x>1)&&O<x;){let z=this.plotWidth,j=this.plotHeight;for(let q of o)O===0?q.setScale():(q.horiz&&A||!q.horiz&&I)&&q.setTickInterval(!0);O===0?this.getAxisMargins():this.getMargins(),A=z/this.plotWidth>(O?1:1.1),I=j/this.plotHeight>(O?1:1.05),O++}this.drawChartBox(),this.hasCartesianSeries?v(o):u!=null&&u.length&&v(u),this.seriesGroup||(this.seriesGroup=p.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(o){let u=this,p=Fs(!0,this.options.credits,o);p.enabled&&!this.credits&&(this.credits=this.renderer.text(p.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){p.href&&(pu.location.href=p.href)}).attr({align:p.position.align,zIndex:8}),u.styledMode||this.credits.css(p.style),this.credits.add().align(p.position),this.credits.update=function(x){u.credits=u.credits.destroy(),u.addCredits(x)})}destroy(){var A,I;let o,u=this,p=u.axes,x=u.series,v=u.container,S=v==null?void 0:v.parentNode;for(Er(u,"destroy"),u.renderer.forExport?Bs(gc,u):gc[u.index]=void 0,ke.chartCount--,u.renderTo.removeAttribute("data-highcharts-chart"),S_(u),o=p.length;o--;)p[o]=p[o].destroy();for((I=(A=this.scroller)==null?void 0:A.destroy)==null||I.call(A),o=x.length;o--;)x[o]=x[o].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(O=>{var N,z;u[O]=(z=(N=u[O])==null?void 0:N.destroy)==null?void 0:z.call(N)}),v&&(v.innerHTML=jr.emptyHTML,S_(v),S&&jd(v)),mp(u,function(O,N){delete u[N]})}firstRender(){var x;let o=this,u=o.options;o.getContainer(),o.resetMargins(),o.setChartSize(),o.propFromSeries(),o.createAxes();let p=Jx(u.series)?u.series:[];u.series=[],p.forEach(function(v){o.initSeries(v)}),o.linkSeries(),o.setSortedData(),Er(o,"beforeRender"),o.render(),(x=o.pointer)==null||x.getChartPosition(),o.renderer.imgCount||o.hasLoaded||o.onload(),o.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(o){o&&this.index!==void 0&&o.apply(this,[this])},this),Er(this,"load"),Er(this,"render"),Jo(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:o,title:u}=this;!o||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":((u==null?void 0:u.element.textContent)||"").replace(/</g,"&lt;")}),o.accessibility&&o.accessibility.enabled===!1||ao('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(o,u,p){let x,v=this;return o&&(u=xs(u,!0),Er(v,"addSeries",{options:o},function(){x=v.initSeries(o),v.isDirtyLegend=!0,v.linkSeries(),x.enabledDataSorting&&x.setData(o.data,!1),Er(v,"afterAddSeries",{series:x}),u&&v.redraw(p)})),x}addAxis(o,u,p,x){return this.createAxis(u?"xAxis":"yAxis",{axis:o,redraw:p,animation:x})}addColorAxis(o,u,p){return this.createAxis("colorAxis",{axis:o,redraw:u,animation:p})}createAxis(o,u){let p=new Ha(this,u.axis,o);return xs(u.redraw,!0)&&this.redraw(u.animation),p}showLoading(o){let u=this,p=u.options,x=p.loading,v=function(){S&&Hs(S,{left:u.plotLeft+"px",top:u.plotTop+"px",width:u.plotWidth+"px",height:u.plotHeight+"px"})},S=u.loadingDiv,A=u.loadingSpan;S||(u.loadingDiv=S=pp("div",{className:"highcharts-loading highcharts-loading-hidden"},null,u.container)),A||(u.loadingSpan=A=pp("span",{className:"highcharts-loading-inner"},null,S),Ma(u,"redraw",v)),S.className="highcharts-loading",jr.setElementHTML(A,xs(o,p.lang.loading,"")),u.styledMode||(Hs(S,Ya(x.style,{zIndex:10})),Hs(A,x.labelStyle),u.loadingShown||(Hs(S,{opacity:0,display:""}),Al(S,{opacity:x.style.opacity||.5},{duration:x.showDuration||0}))),u.loadingShown=!0,v()}hideLoading(){let o=this.options,u=this.loadingDiv;u&&(u.className="highcharts-loading highcharts-loading-hidden",this.styledMode||Al(u,{opacity:0},{duration:o.loading.hideDuration||100,complete:function(){Hs(u,{display:"none"})}})),this.loadingShown=!1}update(o,u,p,x){let v,S,A,I=this,O={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},N=o.isResponsiveOptions,z=[];Er(I,"update",{options:o}),N||I.setResponsive(!1,!0),o=oo(o,I.options),I.userOptions=Fs(I.userOptions,o);let j=o.chart;j&&(Fs(!0,I.options.chart,j),this.setZoomOptions(),"className"in j&&I.setClassName(j.className),("inverted"in j||"polar"in j||"type"in j)&&(I.propFromSeries(),v=!0),"alignTicks"in j&&(v=!0),"events"in j&&Fm(this,j),mp(j,function(se,re){I.propsRequireUpdateSeries.indexOf("chart."+re)!==-1&&(S=!0),I.propsRequireDirtyBox.indexOf(re)!==-1&&(I.isDirtyBox=!0),I.propsRequireReflow.indexOf(re)===-1||(I.isDirtyBox=!0,N||(A=!0))}),!I.styledMode&&j.style&&I.renderer.setStyle(I.options.chart.style||{})),!I.styledMode&&o.colors&&(this.options.colors=o.colors),mp(o,function(se,re){I[re]&&typeof I[re].update=="function"?I[re].update(se,!1):typeof I[O[re]]=="function"?I[O[re]](se):re!=="colors"&&I.collectionsWithUpdate.indexOf(re)===-1&&Fs(!0,I.options[re],o[re]),re!=="chart"&&I.propsRequireUpdateSeries.indexOf(re)!==-1&&(S=!0)}),this.collectionsWithUpdate.forEach(function(se){o[se]&&(gp(o[se]).forEach(function(re,te){let ce,fe=Jo(re.id);fe&&(ce=I.get(re.id)),!ce&&I[se]&&(ce=I[se][xs(re.index,te)])&&(fe&&Jo(ce.options.id)||ce.options.isInternal)&&(ce=void 0),ce&&ce.coll===se&&(ce.update(re,!1),p&&(ce.touched=!0)),!ce&&p&&I.collectionsWithInit[se]&&(I.collectionsWithInit[se][0].apply(I,[re].concat(I.collectionsWithInit[se][1]||[]).concat([!1])).touched=!0)}),p&&I[se].forEach(function(re){re.touched||re.options.isInternal?delete re.touched:z.push(re)}))}),z.forEach(function(se){se.chart&&se.remove&&se.remove(!1)}),v&&I.axes.forEach(function(se){se.update({},!1)}),S&&I.getSeriesOrderByLinks().forEach(function(se){se.chart&&se.update({},!1)},this);let q=j==null?void 0:j.width,K=j&&(Gd(j.height)?Nm(j.height,q||I.chartWidth):j.height);A||mu(q)&&q!==I.chartWidth||mu(K)&&K!==I.chartHeight?I.setSize(q,K,x):xs(u,!0)&&I.redraw(x),Er(I,"afterUpdate",{options:o,redraw:u,animation:x})}setSubtitle(o,u){this.applyDescription("subtitle",o),this.layOutTitles(u)}setCaption(o,u){this.applyDescription("caption",o),this.layOutTitles(u)}showResetZoom(){let o=this,u=Ud.lang,p=o.zooming.resetButton,x=p.theme,v=p.relativeTo==="chart"||p.relativeTo==="spacingBox"?null:"plotBox";function S(){o.zoomOut()}Er(this,"beforeShowResetZoom",null,function(){o.resetZoomButton=o.renderer.button(u.resetZoom,null,null,S,x).attr({align:p.position.align,title:u.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(p.position,!1,v)}),Er(this,"afterShowResetZoom")}zoomOut(){Er(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(o,u){let p=this,x=typeof u=="object"?u:{enabled:u,type:"x"},v=x.type,S=v&&p[{x:"xAxis",xy:"axes",y:"yAxis"}[v]].filter(I=>I.options.panningEnabled&&!I.options.isInternal),A=p.options.chart;A!=null&&A.panning&&(A.panning=x),Er(this,"pan",{originalEvent:o},()=>{p.transform({axes:S,event:o,to:{x:o.chartX-(p.mouseDownX||0),y:o.chartY-(p.mouseDownY||0)},trigger:"pan"}),Hs(p.container,{cursor:"move"})})}transform(o){var K;let{axes:u=this.axes,event:p,from:x={},reset:v,selection:S,to:A={},trigger:I}=o,{inverted:O,time:N}=this,z=!1,j,q;for(let se of((K=this.hoverPoints)==null||K.forEach(re=>re.setState()),u)){let{horiz:re,len:te,minPointOffset:ce=0,options:fe,reversed:Xe}=se,Ne=re?"width":"height",$e=re?"x":"y",mt=xs(A[Ne],se.len),tt=xs(x[Ne],se.len),gt=10>Math.abs(mt)?1:mt/tt,Bt=(x[$e]||0)+tt/2-se.pos,Jt=Bt-((A[$e]??se.pos)+mt/2-se.pos)/gt,ii=Xe&&!O||!Xe&&O?-1:1;if(!v&&(Bt<0||Bt>se.len))continue;let Ft=se.toValue(Jt,!0)+(S||se.isOrdinal?0:ce*ii),ui=se.toValue(Jt+te/gt,!0)-(S||se.isOrdinal?0:ce*ii||0),gi=se.allExtremes;if(Ft>ui&&([Ft,ui]=[ui,Ft]),gt===1&&!v&&se.coll==="yAxis"&&!gi){for(let co of se.series){let Lo=co.getExtremes(co.getProcessedData(!0).modified.getColumn("y")||[],!0);gi??(gi={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),mu(Lo.dataMin)&&mu(Lo.dataMax)&&(gi.dataMin=Math.min(Lo.dataMin,gi.dataMin),gi.dataMax=Math.max(Lo.dataMax,gi.dataMax))}se.allExtremes=gi}let{dataMin:Ui,dataMax:wi,min:ji,max:_r}=Ya(se.getExtremes(),gi||{}),lr=N.parse(fe.min),br=N.parse(fe.max),Cs=Ui??lr,yr=wi??br,Br=ui-Ft,qi=se.categories?0:Math.min(Br,yr-Cs),pi=Cs-qi*(Jo(lr)?0:fe.minPadding),kn=yr+qi*(Jo(br)?0:fe.maxPadding),Fr=se.allowZoomOutside||gt===1||I!=="zoom"&&gt>1,Jr=Math.min(lr??pi,pi,Fr?ji:pi),an=Math.max(br??kn,kn,Fr?_r:kn);(!se.isOrdinal||se.options.overscroll||gt!==1||v)&&(Ft<Jr&&(Ft=Jr,gt>=1&&(ui=Ft+Br)),ui>an&&(ui=an,gt>=1&&(Ft=ui-Br)),(v||se.series.length&&(Ft!==ji||ui!==_r)&&Ft>=Jr&&ui<=an)&&(S?S[se.coll].push({axis:se,min:Ft,max:ui}):(se.isPanning=I!=="zoom",se.isPanning&&(q=!0),se.setExtremes(v?void 0:Ft,v?void 0:ui,!1,!1,{move:Jt,trigger:I,scale:gt}),!v&&(Ft>Jr||ui<an)&&I!=="mousewheel"&&(j=!0)),z=!0),p&&(this[re?"mouseDownX":"mouseDownY"]=p[re?"chartX":"chartY"]))}return z&&(S?Er(this,"selection",S,()=>{delete o.selection,o.trigger="zoom",this.transform(o)}):(!j||q||this.resetZoomButton?!j&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw(I==="zoom"&&(this.options.chart.animation??this.pointCount<100)))),z}}Ya(Qo.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Qo.prototype.addAxis,[!0]],yAxis:[Qo.prototype.addAxis,[!1]],series:[Qo.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});let{stop:Um}=Cn,{composed:Vm}=ke,{addEvent:Ka,createElement:cs,css:Wd,defined:_p,erase:Ja,merge:M_,pushUnique:yc}=xe;function Hd(){let R=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!R&&(this.scrollablePlotArea=R=new Ns(this)),R==null||R.applyFixed()}function Io(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class Ns{static compose(o,u,p){yc(Vm,this.compose)&&(Ka(o,"afterInit",Io),Ka(u,"afterSetChartSize",x=>this.afterSetSize(x.target,x)),Ka(u,"render",Hd),Ka(p,"show",Io))}static afterSetSize(o,u){let p,x,v,{minWidth:S,minHeight:A}=o.options.chart.scrollablePlotArea||{},{clipBox:I,plotBox:O,inverted:N,renderer:z}=o;if(!z.forExport&&(S?(o.scrollablePixelsX=p=Math.max(0,S-o.chartWidth),p&&(o.scrollablePlotBox=M_(o.plotBox),O.width=o.plotWidth+=p,I[N?"height":"width"]+=p,v=!0)):A&&(o.scrollablePixelsY=x=Math.max(0,A-o.chartHeight),_p(x)&&(o.scrollablePlotBox=M_(o.plotBox),O.height=o.plotHeight+=x,I[N?"width":"height"]+=x,v=!1)),_p(v)&&!u.skipAxes))for(let j of o.axes)(j.horiz===v||o.hasParallelCoordinates&&j.coll==="yAxis")&&(j.setAxisSize(),j.setAxisTranslation())}constructor(o){var q;let u,p=o.options.chart,x=vo.getRendererType(),v=p.scrollablePlotArea||{},S=this.moveFixedElements.bind(this),A={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};o.scrollablePixelsX&&(A.overflowX="auto"),o.scrollablePixelsY&&(A.overflowY="auto"),this.chart=o;let I=this.parentDiv=cs("div",{className:"highcharts-scrolling-parent"},{position:"relative"},o.renderTo),O=this.scrollingContainer=cs("div",{className:"highcharts-scrolling"},A,I),N=this.innerContainer=cs("div",{className:"highcharts-inner-container"},void 0,O),z=this.fixedDiv=cs("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(((q=p.style)==null?void 0:q.zIndex)||0)+2,top:0},void 0,!0),j=this.fixedRenderer=new x(z,o.chartWidth,o.chartHeight,p.style);this.mask=j.path().attr({fill:p.backgroundColor||"#fff","fill-opacity":v.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),O.parentNode.insertBefore(z,O),Wd(o.renderTo,{overflow:"visible"}),Ka(o,"afterShowResetZoom",S),Ka(o,"afterApplyDrilldown",S),Ka(o,"afterLayOutTitles",S),Ka(O,"scroll",()=>{let{pointer:K,hoverPoint:se}=o;K&&(delete K.chartPosition,se&&(u=se),K.runPointActions(void 0,u,!0))}),N.appendChild(o.container)}applyFixed(){var Bt;let{chart:o,fixedRenderer:u,isDirty:p,scrollingContainer:x}=this,{axisOffset:v,chartWidth:S,chartHeight:A,container:I,plotHeight:O,plotLeft:N,plotTop:z,plotWidth:j,scrollablePixelsX:q=0,scrollablePixelsY:K=0}=o,{scrollPositionX:se=0,scrollPositionY:re=0}=o.options.chart.scrollablePlotArea||{},te=S+q,ce=A+K;u.setSize(S,A),(p??!0)&&(this.isDirty=!1,this.moveFixedElements()),Um(o.container),Wd(I,{width:`${te}px`,height:`${ce}px`}),o.renderer.boxWrapper.attr({width:te,height:ce,viewBox:[0,0,te,ce].join(" ")}),(Bt=o.chartBackground)==null||Bt.attr({width:te,height:ce}),Wd(x,{width:`${S}px`,height:`${A}px`}),_p(p)||(x.scrollLeft=q*se,x.scrollTop=K*re);let fe=z-v[0]-1,Xe=N-v[3]-1,Ne=z+O+v[2]+1,$e=N+j+v[1]+1,mt=N+j-q,tt=z+O-K,gt=[["M",0,0]];q?gt=[["M",0,fe],["L",N-1,fe],["L",N-1,Ne],["L",0,Ne],["Z"],["M",mt,fe],["L",S,fe],["L",S,Ne],["L",mt,Ne],["Z"]]:K&&(gt=[["M",Xe,0],["L",Xe,z-1],["L",$e,z-1],["L",$e,0],["Z"],["M",Xe,tt],["L",Xe,A],["L",$e,A],["L",$e,tt],["Z"]]),o.redrawTrigger!=="adjustHeight"&&this.mask.attr({d:gt})}moveFixedElements(){let o,{container:u,inverted:p,scrollablePixelsX:x,scrollablePixelsY:v}=this.chart,S=this.fixedRenderer,A=Ns.fixedSelectors;if(x&&!p?o=".highcharts-yaxis":x&&p||v&&!p?o=".highcharts-xaxis":v&&p&&(o=".highcharts-yaxis"),o&&!(this.chart.hasParallelCoordinates&&o===".highcharts-yaxis"))for(let I of[`${o}:not(.highcharts-radial-axis)`,`${o}-labels:not(.highcharts-radial-axis-labels)`])yc(A,I);else for(let I of[".highcharts-xaxis",".highcharts-yaxis"])for(let O of[`${I}:not(.highcharts-radial-axis)`,`${I}-labels:not(.highcharts-radial-axis-labels)`])Ja(A,O);for(let I of A)[].forEach.call(u.querySelectorAll(I),O=>{(O.namespaceURI===S.SVG_NS?S.box:S.box.parentNode).appendChild(O),O.style.pointerEvents="auto"})}}Ns.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];let{format:Qx}=fs,{series:yp}=Pr,{destroyObjectProperties:I_,fireEvent:k_,getAlignFactor:qd,isNumber:ea,pick:Ia}=xe,jm=class{constructor(R,o,u,p,x){let v=R.chart.inverted,S=R.reversed;this.axis=R;let A=this.isNegative=!!u!=!!S;this.options=o=o||{},this.x=p,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=x,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:o.align||(v?A?"left":"right":"center"),verticalAlign:o.verticalAlign||(v?"middle":A?"bottom":"top"),y:o.y,x:o.x},this.textAlign=o.textAlign||(v?A?"right":"left":"center")}destroy(){I_(this,this.axis)}render(R){let o=this.axis.chart,u=this.options,p=u.format,x=p?Qx(p,this,o):u.formatter.call(this);if(this.label)this.label.attr({text:x,visibility:"hidden"});else{this.label=o.renderer.label(x,null,void 0,u.shape,void 0,void 0,u.useHTML,!1,"stack-labels");let v={r:u.borderRadius||0,text:x,padding:Ia(u.padding,5),visibility:"hidden"};o.styledMode||(v.fill=u.backgroundColor,v.stroke=u.borderColor,v["stroke-width"]=u.borderWidth,this.label.css(u.style||{})),this.label.attr(v),this.label.added||this.label.add(R)}this.label.labelrank=o.plotSizeY,k_(this,"afterRender")}setOffset(R,o,u,p,x,v){let{alignOptions:S,axis:A,label:I,options:O,textAlign:N}=this,z=A.chart,j=this.getStackBox({xOffset:R,width:o,boxBottom:u,boxTop:p,defaultX:x,xAxis:v}),{verticalAlign:q}=S;if(I&&j){let K=I.getBBox(void 0,0),se=I.padding,re=Ia(O.overflow,"justify")==="justify",te;S.x=O.x||0,S.y=O.y||0;let{x:ce,y:fe}=this.adjustStackPosition({labelBox:K,verticalAlign:q,textAlign:N});j.x-=ce,j.y-=fe,I.align(S,!1,j),(te=z.isInsidePlot(I.alignAttr.x+S.x+ce,I.alignAttr.y+S.y+fe))||(re=!1),re&&yp.prototype.justifyDataLabel.call(A,I,S,I.alignAttr,K,j),I.attr({x:I.alignAttr.x,y:I.alignAttr.y,rotation:O.rotation,rotationOriginX:K.width*qd(O.textAlign||"center"),rotationOriginY:K.height/2}),Ia(!re&&O.crop,!0)&&(te=ea(I.x)&&ea(I.y)&&z.isInsidePlot(I.x-se+(I.width||0),I.y)&&z.isInsidePlot(I.x+se,I.y)),I[te?"show":"hide"]()}k_(this,"afterSetOffset",{xOffset:R,width:o})}adjustStackPosition({labelBox:R,verticalAlign:o,textAlign:u}){return{x:R.width/2+R.width/2*(2*qd(u)-1),y:R.height/2*2*(1-qd(o))}}getStackBox(R){let o=this.axis,u=o.chart,{boxTop:p,defaultX:x,xOffset:v,width:S,boxBottom:A}=R,I=o.stacking.usePercentage?100:Ia(p,this.total,0),O=o.toPixels(I),N=R.xAxis||u.xAxis[0],z=Ia(x,N.translate(this.x))+v,j=Math.abs(O-o.toPixels(A||ea(o.min)&&o.logarithmic&&o.logarithmic.lin2log(o.min)||0)),q=u.inverted,K=this.isNegative;return q?{x:(K?O:O-j)-u.plotLeft,y:N.height-z-S+N.top-u.plotTop,width:j,height:S}:{x:z+N.transB-u.plotLeft,y:(K?O-j:O)-u.plotTop,width:S,height:j}}},{getDeferredAnimation:P_}=Cn,{series:{prototype:ev}}=Pr,{addEvent:Xd,correctFloat:ch,defined:hh,destroyObjectProperties:gu,fireEvent:Zd,isNumber:_u,objectEach:xc,pick:uh}=xe;function $m(){let R=this.inverted;this.axes.forEach(o=>{var u;(u=o.stacking)!=null&&u.stacks&&o.hasVisibleSeries&&(o.stacking.oldStacks=o.stacking.stacks)}),this.series.forEach(o=>{var p;let u=((p=o.xAxis)==null?void 0:p.options)||{};o.options.stacking&&o.reserveSpace()&&(o.stackKey=[o.type,uh(o.options.stack,""),R?u.top:u.left,R?u.height:u.width].join(","))})}function L_(){var o;let R=this.stacking;if(R){let u=R.stacks;xc(u,(p,x)=>{gu(p),delete u[x]}),(o=R.stackTotalGroup)==null||o.destroy()}}function yu(){this.stacking||(this.stacking=new Yd(this))}function D_(R,o,u,p){return!hh(R)||R.x!==o||p&&R.stackKey!==p?R={x:o,index:0,key:p,stackKey:p}:R.index++,R.key=[u,o,R.index].join(","),R}function Gm(){let R,o=this,u=o.yAxis,p=o.stackKey||"",x=u.stacking.stacks,v=o.getColumn("x",!0),S=o.options.stacking,A=o[S+"Stacker"];A&&[p,"-"+p].forEach(I=>{var q;let O=v.length,N,z,j;for(;O--;)N=v[O],R=o.getStackIndicator(R,N,o.index,I),z=(q=x[I])==null?void 0:q[N],(j=z==null?void 0:z.points[R.key||""])&&A.call(o,j,z,O)})}function O_(R,o,u){let p=o.total?100/o.total:0;R[0]=ch(R[0]*p),R[1]=ch(R[1]*p),this.stackedYData[u]=R[1]}function tv(R){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&this.chart.series.length>1?ev.setStackedPoints.call(this,R,"group"):R.stacking.resetStacks())}function iv(R,o){var tt,gt;let u,p,x,v,S,A,I,O=o||this.options.stacking;if(!O||!this.reserveSpace()||({group:"xAxis"}[O]||"yAxis")!==R.coll)return;let N=this.getColumn("x",!0),z=this.getColumn(this.pointValKey||"y",!0),j=[],q=z.length,K=this.options,se=K.threshold||0,re=K.startFromThreshold?se:0,te=K.stack,ce=o?`${this.type},${O}`:this.stackKey||"",fe="-"+ce,Xe=this.negStacks,Ne=R.stacking,$e=Ne.stacks,mt=Ne.oldStacks;for(Ne.stacksTouched+=1,I=0;I<q;I++){let Bt=N[I]||0,Jt=z[I],ii=_u(Jt)&&Jt||0;A=(u=this.getStackIndicator(u,Bt,this.index)).key||"",$e[S=(p=Xe&&ii<(re?0:se))?fe:ce]||($e[S]={}),$e[S][Bt]||((tt=mt[S])!=null&&tt[Bt]?($e[S][Bt]=mt[S][Bt],$e[S][Bt].total=null):$e[S][Bt]=new jm(R,R.options.stackLabels,!!p,Bt,te)),x=$e[S][Bt],Jt!==null?(x.points[A]=x.points[this.index]=[uh(x.cumulative,re)],hh(x.cumulative)||(x.base=A),x.touched=Ne.stacksTouched,u.index>0&&this.singleStacks===!1&&(x.points[A][0]=x.points[this.index+","+Bt+",0"][0])):(delete x.points[A],delete x.points[this.index]);let Ft=x.total||0;O==="percent"?(v=p?ce:fe,Ft=Xe&&((gt=$e[v])!=null&&gt[Bt])?(v=$e[v][Bt]).total=Math.max(v.total||0,Ft)+Math.abs(ii):ch(Ft+Math.abs(ii))):O==="group"?_u(Jt)&&Ft++:Ft=ch(Ft+ii),O==="group"?x.cumulative=(Ft||1)-1:x.cumulative=ch(uh(x.cumulative,re)+ii),x.total=Ft,Jt!==null&&(x.points[A].push(x.cumulative),j[I]=x.cumulative,x.hasValidPoints=!0)}O==="percent"&&(Ne.usePercentage=!0),O!=="group"&&(this.stackedYData=j),Ne.oldStacks={}}class Yd{constructor(o){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=o}buildStacks(){let o,u,p=this.axis,x=p.series,v=p.coll==="xAxis",S=p.options.reversedStacks,A=x.length;for(this.resetStacks(),this.usePercentage=!1,u=A;u--;)o=x[S?u:A-u-1],v&&o.setGroupedPoints(p),o.setStackedPoints(p);if(!v)for(u=0;u<A;u++)x[u].modifyStacks();Zd(p,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,xc(this.stacks,o=>{xc(o,u=>{u.cumulative=u.total})}))}resetStacks(){xc(this.stacks,o=>{xc(o,(u,p)=>{_u(u.touched)&&u.touched<this.stacksTouched?(u.destroy(),delete o[p]):(u.total=null,u.cumulative=null)})})}renderStackTotals(){var A;let o=this.axis,u=o.chart,p=u.renderer,x=this.stacks,v=P_(u,((A=o.options.stackLabels)==null?void 0:A.animation)||!1),S=this.stackTotalGroup=this.stackTotalGroup||p.g("stack-labels").attr({zIndex:6,opacity:0}).add();S.translate(u.plotLeft,u.plotTop),xc(x,I=>{xc(I,O=>{O.render(S)})}),S.animate({opacity:1},v)}}(Me||(Me={})).compose=function(R,o,u){let p=o.prototype,x=u.prototype;p.getStacks||(Xd(R,"init",yu),Xd(R,"destroy",L_),p.getStacks=$m,x.getStackIndicator=D_,x.modifyStacks=Gm,x.percentStacker=O_,x.setGroupedPoints=tv,x.setStackedPoints=iv)};let R_=Me,{defined:vc,merge:zr,isObject:Wm}=xe;class ka extends ys{drawGraph(){let o=this.options,u=(this.gappedPath||this.getGraphPath).call(this),p=this.chart.styledMode;[this,...this.zones].forEach((x,v)=>{let S,A=x.graph,I=A?"animate":"attr",O=x.dashStyle||o.dashStyle;A?(A.endX=this.preventGraphAnimation?null:u.xMap,A.animate({d:u})):u.length&&(x.graph=A=this.chart.renderer.path(u).addClass("highcharts-graph"+(v?` highcharts-zone-graph-${v-1} `:" ")+(v&&x.className||"")).attr({zIndex:1}).add(this.group)),A&&!p&&(S={stroke:!v&&o.lineColor||x.color||this.color||"#cccccc","stroke-width":o.lineWidth||0,fill:this.fillGraph&&this.color||"none"},O?S.dashstyle=O:o.linecap!=="square"&&(S["stroke-linecap"]=S["stroke-linejoin"]="round"),A[I](S).shadow(o.shadow&&zr({filterUnits:"userSpaceOnUse"},Wm(o.shadow)?o.shadow:{}))),A&&(A.startX=u.xMap,A.isArea=u.isArea)})}getGraphPath(o,u,p){let x=this,v=x.options,S=[],A=[],I,O=v.step,N=(o=o||x.points).reversed;return N&&o.reverse(),(O={right:1,center:2}[O]||O&&3)&&N&&(O=4-O),(o=this.getValidPoints(o,!1,v.nullInteraction||!(v.connectNulls&&!u&&!p))).forEach(function(z,j){let q,K=z.plotX,se=z.plotY,re=o[j-1],te=z.isNull||typeof se!="number";(z.leftCliff||re!=null&&re.rightCliff)&&!p&&(I=!0),te&&!vc(u)&&j>0?I=!v.connectNulls:te&&!u?I=!0:(j===0||I?q=[["M",z.plotX,z.plotY]]:x.getPointSpline?q=[x.getPointSpline(o,z,j)]:O?(q=O===1?[["L",re.plotX,se]]:O===2?[["L",(re.plotX+K)/2,re.plotY],["L",(re.plotX+K)/2,se]]:[["L",K,re.plotY]]).push(["L",K,se]):q=[["L",K,se]],A.push(z.x),O&&(A.push(z.x),O===2&&A.push(z.x)),S.push.apply(S,q),I=!1)}),S.xMap=A,x.graphPath=S,S}}ka.defaultOptions=zr(ys.defaultOptions,{legendSymbol:"lineMarker"}),Pr.registerSeriesType("line",ka);let{seriesTypes:{line:ta}}=Pr,{extend:Pa,merge:ko,objectEach:vs,pick:Kd}=xe;class Po extends ta{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:o,options:u}=this;[this,...this.zones].forEach((p,x)=>{let v={},S=p.fillColor||u.fillColor,A=p.area,I=A?"animate":"attr";A?(A.endX=this.preventGraphAnimation?null:o.xMap,A.animate({d:o})):(v.zIndex=0,(A=p.area=this.chart.renderer.path(o).addClass("highcharts-area"+(x?` highcharts-zone-area-${x-1} `:" ")+(x&&p.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(v.fill=S||p.color||this.color,v["fill-opacity"]=S?1:u.fillOpacity??.75,A.css({pointerEvents:this.stickyTracking?"none":"auto"})),A[I](v),A.startX=o.xMap,A.shiftUnit=u.step?2:1})}getGraphPath(o){let u,p,x,v=ta.prototype.getGraphPath,S=this.options,A=S.stacking,I=this.yAxis,O=[],N=[],z=this.index,j=I.stacking.stacks[this.stackKey],q=S.threshold,K=Math.round(I.getThreshold(S.threshold)),se=Kd(S.connectNulls,A==="percent"),re=function($e,mt,tt){let gt=o[$e],Bt=A&&j[gt.x].points[z],Jt=gt[tt+"Null"]||0,ii=gt[tt+"Cliff"]||0,Ft,ui,gi=!0;ii||Jt?(Ft=(Jt?Bt[0]:Bt[1])+ii,ui=Bt[0]+ii,gi=!!Jt):!A&&o[mt]&&o[mt].isNull&&(Ft=ui=q),Ft!==void 0&&(N.push({plotX:u,plotY:Ft===null?K:I.getThreshold(Ft),isNull:gi,isCliff:!0}),O.push({plotX:u,plotY:ui===null?K:I.getThreshold(ui),doCurve:!1}))};o=o||this.points,A&&(o=this.getStackPoints(o));for(let $e=0,mt=o.length;$e<mt;++$e)A||(o[$e].leftCliff=o[$e].rightCliff=o[$e].leftNull=o[$e].rightNull=void 0),p=o[$e].isNull,u=Kd(o[$e].rectPlotX,o[$e].plotX),x=A?Kd(o[$e].yBottom,K):K,p&&!se||(se||re($e,$e-1,"left"),p&&!A&&se||(N.push(o[$e]),O.push({x:$e,plotX:u,plotY:x})),se||re($e,$e+1,"right"));let te=v.call(this,N,!0,!0);O.reversed=!0;let ce=v.call(this,O,!0,!0),fe=ce[0];fe&&fe[0]==="M"&&(ce[0]=["L",fe[1],fe[2]]);let Xe=te.concat(ce);Xe.length&&Xe.push(["Z"]);let Ne=v.call(this,N,!1,se);return this.chart.series.length>1&&A&&N.some($e=>$e.isCliff)&&(Xe.hasStackedCliffs=Ne.hasStackedCliffs=!0),Xe.xMap=te.xMap,this.areaPath=Xe,Ne}getStackPoints(o){let u=this,p=[],x=[],v=this.xAxis,S=this.yAxis,A=S.stacking.stacks[this.stackKey],I={},O=S.series,N=O.length,z=S.options.reversedStacks?1:-1,j=O.indexOf(u);if(o=o||this.points,this.options.stacking){for(let K=0;K<o.length;K++)o[K].leftNull=o[K].rightNull=void 0,I[o[K].x]=o[K];vs(A,function(K,se){K.total!==null&&x.push(se)}),x.sort(function(K,se){return K-se});let q=O.map(K=>K.visible);x.forEach(function(K,se){let re=0,te,ce;if(I[K]&&!I[K].isNull)p.push(I[K]),[-1,1].forEach(function(fe){let Xe=fe===1?"rightNull":"leftNull",Ne=A[x[se+fe]],$e=0;if(Ne){let mt=j;for(;mt>=0&&mt<N;){let tt=O[mt].index;!(te=Ne.points[tt])&&(tt===u.index?I[K][Xe]=!0:q[mt]&&(ce=A[K].points[tt])&&($e-=ce[1]-ce[0])),mt+=z}}I[K][fe===1?"rightCliff":"leftCliff"]=$e});else{let fe=j;for(;fe>=0&&fe<N;){let Xe=O[fe].index;if(te=A[K].points[Xe]){re=te[1];break}fe+=z}re=Kd(re,0),re=S.translate(re,0,1,0,1),p.push({isNull:!0,plotX:v.translate(K,0,0,0,1),x:K,plotY:re,yBottom:re})}})}return p}}Po.defaultOptions=ko(ta.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),Pa(Po.prototype,{singleStacks:!1}),Pr.registerSeriesType("area",Po);let{line:Hm}=Pr.seriesTypes,{merge:xu,pick:vu}=xe;class xp extends Hm{getPointSpline(o,u,p){let x,v,S,A,I=u.plotX||0,O=u.plotY||0,N=o[p-1],z=o[p+1];function j(K){return K&&!K.isNull&&K.doCurve!==!1&&!u.isCliff}if(j(N)&&j(z)){let K=N.plotX||0,se=N.plotY||0,re=z.plotX||0,te=z.plotY||0,ce=0;x=(1.5*I+K)/2.5,v=(1.5*O+se)/2.5,S=(1.5*I+re)/2.5,A=(1.5*O+te)/2.5,S!==x&&(ce=(A-v)*(S-I)/(S-x)+O-A),v+=ce,A+=ce,v>se&&v>O?(v=Math.max(se,O),A=2*O-v):v<se&&v<O&&(v=Math.min(se,O),A=2*O-v),A>te&&A>O?(A=Math.max(te,O),v=2*O-A):A<te&&A<O&&(A=Math.min(te,O),v=2*O-A),u.rightContX=S,u.rightContY=A,u.controlPoints={low:[x,v],high:[S,A]}}let q=["C",vu(N.rightContX,N.plotX,0),vu(N.rightContY,N.plotY,0),vu(x,I,0),vu(v,O,0),I,O];return N.rightContX=N.rightContY=void 0,q}}xp.defaultOptions=xu(Hm.defaultOptions),Pr.registerSeriesType("spline",xp);let vp=xp,{area:rv,area:{prototype:Jd}}=Pr.seriesTypes,{extend:z_,merge:nv}=xe;class La extends vp{}La.defaultOptions=nv(vp.defaultOptions,rv.defaultOptions),z_(La.prototype,{getGraphPath:Jd.getGraphPath,getStackPoints:Jd.getStackPoints,drawGraph:Jd.drawGraph}),Pr.registerSeriesType("areaspline",La);let{animObject:dh}=Cn,{parse:bp}=st,{noop:wp}=ke,{clamp:bu,crisp:Qd,defined:B_,extend:qm,fireEvent:F_,isArray:Tp,isNumber:Ep,merge:ef,pick:wu,objectEach:N_}=xe;class Qa extends ys{animate(o){let u,p,x=this,v=this.yAxis,S=v.pos,A=v.reversed,I=x.options,{clipOffset:O,inverted:N}=this.chart,z={},j=N?"translateX":"translateY";o&&O?(z.scaleY=.001,p=bu(v.toPixels(I.threshold||0),S,S+v.len),N?z.translateX=(p+=A?-Math.floor(O[0]):Math.ceil(O[2]))-v.len:z.translateY=p+=A?Math.ceil(O[0]):-Math.floor(O[2]),x.clipBox&&x.setClip(),x.group.attr(z)):(u=Number(x.group.attr(j)),x.group.animate({scaleY:1},qm(dh(x.options.animation),{step:function(q,K){x.group&&(z[j]=u+K.pos*(S-u),x.group.attr(z))}})))}init(o,u){super.init.apply(this,arguments);let p=this;(o=p.chart).hasRendered&&o.series.forEach(function(x){x.type===p.type&&(x.isDirty=!0)})}getColumnMetrics(){var se,re;let o=this,u=o.options,p=o.xAxis,x=o.yAxis,v=p.options.reversedStacks,S=p.reversed&&!v||!p.reversed&&v,A={},I,O=0;u.grouping===!1?O=1:o.chart.series.forEach(function(te){let ce,fe=te.yAxis,Xe=te.options;te.type===o.type&&te.reserveSpace()&&x.len===fe.len&&x.pos===fe.pos&&(Xe.stacking&&Xe.stacking!=="group"?(A[I=te.stackKey]===void 0&&(A[I]=O++),ce=A[I]):Xe.grouping!==!1&&(ce=O++),te.columnIndex=ce)});let N=Math.min(Math.abs(p.transA)*(!((se=p.brokenAxis)!=null&&se.hasBreaks)&&((re=p.ordinal)==null?void 0:re.slope)||u.pointRange||p.closestPointRange||p.tickInterval||1),p.len),z=N*u.groupPadding,j=(N-2*z)/(O||1),q=Math.min(u.maxPointWidth||p.len,wu(u.pointWidth,j*(1-2*u.pointPadding))),K=(o.columnIndex||0)+ +!!S;return o.columnMetrics={width:q,offset:(j-q)/2+(z+K*j-N/2)*(S?-1:1),paddedWidth:j,columnCount:O},o.columnMetrics}crispCol(o,u,p,x){let v=this.borderWidth,S=this.chart.inverted;return x=Qd(u+x,v,S)-(u=Qd(u,v,S)),this.options.crisp&&(p=Qd(o+p,v)-(o=Qd(o,v))),{x:o,y:u,width:p,height:x}}adjustForMissingColumns(o,u,p,x){var v;if(!p.isNull&&x.columnCount>1){let S=this.xAxis.series.filter(N=>N.visible).map(N=>N.index),A=0,I=0;N_((v=this.xAxis.stacking)==null?void 0:v.stacks,N=>{var K;let z=typeof p.x=="number"?(K=N[p.x.toString()])==null?void 0:K.points:void 0,j=z==null?void 0:z[this.index],q={};if(z&&Tp(j)){let se=this.index,re=Object.keys(z).filter(te=>!te.match(",")&&z[te]&&z[te].length>1).map(parseFloat).filter(te=>S.indexOf(te)!==-1).filter(te=>{let ce=this.chart.series[te].options,fe=ce.stacking&&ce.stack;if(B_(fe)){if(Ep(q[fe]))return se===te&&(se=q[fe]),!1;q[fe]=te}return!0}).sort((te,ce)=>ce-te);A=re.indexOf(se),I=re.length}}),A=this.xAxis.reversed?I-1-A:A;let O=(I-1)*x.paddedWidth+u;o=(p.plotX||0)+O/2-u-A*x.paddedWidth}return o}translate(){let o=this,u=o.chart,p=o.options,x=o.dense=o.closestPointRange*o.xAxis.transA<2,v=o.borderWidth=wu(p.borderWidth,+!x),S=o.xAxis,A=o.yAxis,I=p.threshold,O=wu(p.minPointLength,5),N=o.getColumnMetrics(),z=N.width,j=o.pointXOffset=N.offset,q=o.dataMin,K=o.dataMax,se=o.translatedThreshold=A.getThreshold(I),re=o.barW=Math.max(z,1+2*v);p.pointPadding&&p.crisp&&(re=Math.ceil(re)),ys.prototype.translate.apply(o),o.points.forEach(function(te){let ce=wu(te.yBottom,se),fe=999+Math.abs(ce),Xe=te.plotX||0,Ne=bu(te.plotY,-fe,A.len+fe),$e,mt=Math.min(Ne,ce),tt=Math.max(Ne,ce)-mt,gt=z,Bt=Xe+j,Jt=re;O&&Math.abs(tt)<O&&(tt=O,$e=!A.reversed&&!te.negative||A.reversed&&te.negative,Ep(I)&&Ep(K)&&te.y===I&&K<=I&&(A.min||0)<I&&(q!==K||(A.max||0)<=I)&&($e=!$e,te.negative=!te.negative),mt=Math.abs(mt-se)>O?ce-O:se-($e?O:0)),B_(te.options.pointWidth)&&(Bt-=Math.round(((gt=Jt=Math.ceil(te.options.pointWidth))-z)/2)),p.centerInCategory&&(Bt=o.adjustForMissingColumns(Bt,gt,te,N)),te.barX=Bt,te.pointWidth=gt,te.tooltipPos=u.inverted?[bu(A.len+A.pos-u.plotLeft-Ne,A.pos-u.plotLeft,A.len+A.pos-u.plotLeft),S.len+S.pos-u.plotTop-Bt-Jt/2,tt]:[S.left-u.plotLeft+Bt+Jt/2,bu(Ne+A.pos-u.plotTop,A.pos-u.plotTop,A.len+A.pos-u.plotTop),tt],te.shapeType=o.pointClass.prototype.shapeType||"roundedRect",te.shapeArgs=o.crispCol(Bt,mt,Jt,te.isNull?0:tt)}),F_(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(o,u){let p=this.options,x=this.pointAttrToOptions||{},v=x.stroke||"borderColor",S=x["stroke-width"]||"borderWidth",A,I,O,N=o&&o.color||this.color,z=o&&o[v]||p[v]||N,j=o&&o.options.dashStyle||p.dashStyle,q=o&&o[S]||p[S]||this[S]||0,K=o!=null&&o.isNull&&p.nullInteraction?0:(o==null?void 0:o.opacity)??p.opacity??1;o&&this.zones.length&&(I=o.getZone(),N=o.options.color||I&&(I.color||o.nonZonedColor)||this.color,I&&(z=I.borderColor||z,j=I.dashStyle||j,q=I.borderWidth||q)),u&&o&&(O=(A=ef(p.states[u],o.options.states&&o.options.states[u]||{})).brightness,N=A.color||O!==void 0&&bp(N).brighten(A.brightness).get()||N,z=A[v]||z,q=A[S]||q,j=A.dashStyle||j,K=wu(A.opacity,K));let se={fill:N,stroke:z,"stroke-width":q,opacity:K};return j&&(se.dashstyle=j),se}drawPoints(o=this.points){let u,p=this,x=this.chart,v=p.options,S=v.nullInteraction,A=x.renderer,I=v.animationLimit||250;o.forEach(function(O){let N=O.plotY,z=O.graphic,j=!!z,q=z&&x.pointCount<I?"animate":"attr";Ep(N)&&(O.y!==null||S)?(u=O.shapeArgs,z&&O.hasNewShapeType()&&(z=z.destroy()),p.enabledDataSorting&&(O.startXPos=p.xAxis.reversed?-(u&&u.width||0):p.xAxis.width),!z&&(O.graphic=z=A[O.shapeType](u).add(O.group||p.group),z&&p.enabledDataSorting&&x.hasRendered&&x.pointCount<I&&(z.attr({x:O.startXPos}),j=!0,q="animate")),z&&j&&z[q](ef(u)),x.styledMode||z[q](p.pointAttribs(O,O.selected&&"select")).shadow(O.allowShadow!==!1&&v.shadow),z&&(z.addClass(O.getClassName(),!0),z.attr({visibility:O.visible?"inherit":"hidden"}))):z&&(O.graphic=z.destroy())})}drawTracker(o=this.points){let u,p=this,x=p.chart,v=x.pointer,S=function(A){v==null||v.normalize(A);let I=v==null?void 0:v.getPointFromEvent(A);v&&I&&p.options.enableMouseTracking&&(x.isInsidePlot(A.chartX-x.plotLeft,A.chartY-x.plotTop,{visiblePlotOnly:!0})||v!=null&&v.inClass(A.target,"highcharts-data-label"))&&(v.isDirectTouch=!0,I.onMouseOver(A))};o.forEach(function(A){u=Tp(A.dataLabels)?A.dataLabels:A.dataLabel?[A.dataLabel]:[],A.graphic&&(A.graphic.element.point=A),u.forEach(function(I){(I.div||I.element).point=A})}),p._hasTracking||(p.trackerGroups.forEach(function(A){p[A]&&(p[A].addClass("highcharts-tracker").on("mouseover",S).on("mouseout",function(I){v==null||v.onTrackerMouseOut(I)}).on("touchstart",S),!x.styledMode&&p.options.cursor&&p[A].css({cursor:p.options.cursor}))}),p._hasTracking=!0),F_(this,"afterDrawTracker")}remove(){let o=this,u=o.chart;u.hasRendered&&u.series.forEach(function(p){p.type===o.type&&(p.isDirty=!0)}),ys.prototype.remove.apply(o,arguments)}}Qa.defaultOptions=ef(ys.defaultOptions,{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}),qm(Qa.prototype,{directTouch:!0,getSymbol:wp,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),Pr.registerSeriesType("column",Qa);let tf=Qa,{getDeferredAnimation:sv}=Cn,{format:Tu}=fs,{defined:el,extend:Xm,fireEvent:Sp,getAlignFactor:U_,isArray:bc,isString:Eu,merge:rf,objectEach:V_,pick:nf,pInt:ov,splat:Zm}=xe;(function(R){function o(){return I(this).some(N=>N==null?void 0:N.enabled)}function u(N,z,j,q,K){var Bt;let{chart:se,enabledDataSorting:re}=this,te=this.isCartesian&&se.inverted,ce=N.plotX,fe=N.plotY,Xe=j.rotation||0,Ne=el(ce)&&el(fe)&&se.isInsidePlot(ce,Math.round(fe),{inverted:te,paneCoordinates:!0,series:this}),$e=Xe===0&&nf(j.overflow,re?"none":"justify")==="justify",mt=this.visible&&N.visible!==!1&&el(ce)&&(N.series.forceDL||re&&!$e||Ne||nf(j.inside,!!this.options.stacking)&&q&&se.isInsidePlot(ce,te?q.x+1:q.y+q.height-1,{inverted:te,paneCoordinates:!0,series:this})),tt=N.pos();if(mt&&tt){var gt;let Jt=z.getBBox(),ii=z.getBBox(void 0,0);if(q=Xm({x:tt[0],y:Math.round(tt[1]),width:0,height:0},q||{}),j.alignTo==="plotEdges"&&this.isCartesian&&(q[te?"x":"y"]=0,q[te?"width":"height"]=((Bt=this.yAxis)==null?void 0:Bt.len)||0),Xm(j,{width:Jt.width,height:Jt.height}),gt=q,re&&this.xAxis&&!$e&&this.setDataLabelStartPos(N,z,K,Ne,gt),z.align(rf(j,{width:ii.width,height:ii.height}),!1,q,!1),z.alignAttr.x+=U_(j.align)*(ii.width-Jt.width),z.alignAttr.y+=U_(j.verticalAlign)*(ii.height-Jt.height),z[z.placed?"animate":"attr"]({"text-align":z.alignAttr["text-align"]||"center",x:z.alignAttr.x+(Jt.width-ii.width)/2,y:z.alignAttr.y+(Jt.height-ii.height)/2,rotationOriginX:(z.width||0)/2,rotationOriginY:(z.height||0)/2}),$e&&q.height>=0)this.justifyDataLabel(z,j,z.alignAttr,Jt,q,K);else if(nf(j.crop,!0)){let{x:Ft,y:ui}=z.alignAttr;mt=se.isInsidePlot(Ft,ui,{paneCoordinates:!0,series:this})&&se.isInsidePlot(Ft+Jt.width-1,ui+Jt.height-1,{paneCoordinates:!0,series:this})}j.shape&&!Xe&&z[K?"attr":"animate"]({anchorX:tt[0],anchorY:tt[1]})}K&&re&&(z.placed=!1),mt||re&&!$e?(z.show(),z.placed=!0):(z.hide(),z.placed=!1)}function p(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function x(N){let z=this.hasRendered||0,j=this.initDataLabelsGroup().attr({opacity:+z});return!z&&j&&(this.visible&&j.show(),this.options.animation?j.animate({opacity:1},N):j.attr({opacity:1})),j}function v(N){var mt;let z;N=N||this.points;let j=this,q=j.chart,K=j.options,se=q.renderer,{backgroundColor:re,plotBackgroundColor:te}=q.options.chart,ce=se.getContrast(Eu(te)&&te||Eu(re)&&re||"#000000"),fe=I(j),{animation:Xe,defer:Ne}=fe[0],$e=Ne?sv(q,Xe,j):{defer:0,duration:0};Sp(this,"drawDataLabels"),(mt=j.hasDataLabels)!=null&&mt.call(j)&&(z=this.initDataLabels($e),N.forEach(tt=>{var ii,Ft,ui;let gt=tt.dataLabels||[],Bt=tt.color||j.color;Zm(A(fe,tt.dlOptions||((ii=tt.options)==null?void 0:ii.dataLabels))).forEach((gi,Ui)=>{var Jr;let wi=gi.enabled&&(tt.visible||tt.dataLabelOnHidden)&&(!tt.isNull||tt.dataLabelOnNull)&&function(an,co){let Lo=co.filter;if(Lo){let ia=Lo.operator,qs=an[Lo.property],Xn=Lo.value;return ia===">"&&qs>Xn||ia==="<"&&qs<Xn||ia===">="&&qs>=Xn||ia==="<="&&qs<=Xn||ia==="=="&&qs==Xn||ia==="==="&&qs===Xn||ia==="!="&&qs!=Xn||ia==="!=="&&qs!==Xn||!1}return!0}(tt,gi),{backgroundColor:ji,borderColor:_r,distance:lr,style:br={}}=gi,Cs,yr,Br,qi={},pi=gt[Ui],kn=!pi,Fr;wi&&(yr=el(Cs=nf(gi[tt.formatPrefix+"Format"],gi.format))?Tu(Cs,tt,q):(gi[tt.formatPrefix+"Formatter"]||gi.formatter).call(tt,gi),Br=gi.rotation,!q.styledMode&&(br.color=nf(gi.color,br.color,Eu(j.color)?j.color:void 0,"#000000"),br.color==="contrast"?(ji!=="none"&&(Fr=ji),tt.contrastColor=se.getContrast(Fr!=="auto"&&Eu(Fr)&&Fr||(Eu(Bt)?Bt:"")),br.color=Fr||!el(lr)&&gi.inside||0>ov(lr||0)||K.stacking?tt.contrastColor:ce):delete tt.contrastColor,K.cursor&&(br.cursor=K.cursor)),qi={r:gi.borderRadius||0,rotation:Br,padding:gi.padding,zIndex:1},q.styledMode||(qi.fill=ji==="auto"?tt.color:ji,qi.stroke=_r==="auto"?tt.color:_r,qi["stroke-width"]=gi.borderWidth),V_(qi,(an,co)=>{an===void 0&&delete qi[co]})),!pi||wi&&el(yr)&&!!(pi.div||(Jr=pi.text)!=null&&Jr.foreignObject)==!!gi.useHTML&&(pi.rotation&&gi.rotation||pi.rotation===gi.rotation)||(pi=void 0,kn=!0),wi&&el(yr)&&(pi?qi.text=yr:(pi=se.label(yr,0,0,gi.shape,void 0,void 0,gi.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+tt.colorIndex+" "+(gi.className||"")+(gi.useHTML?" highcharts-tracker":"")),pi&&(pi.options=gi,pi.attr(qi),q.styledMode?br.width&&pi.css({width:br.width,textOverflow:br.textOverflow,whiteSpace:br.whiteSpace}):pi.css(br).shadow(gi.shadow),Sp(pi,"beforeAddingDataLabel",{labelOptions:gi,point:tt}),pi.added||pi.add(z),j.alignDataLabel(tt,pi,gi,void 0,kn),pi.isActive=!0,gt[Ui]&&gt[Ui]!==pi&&gt[Ui].destroy(),gt[Ui]=pi))});let Jt=gt.length;for(;Jt--;)(Ft=gt[Jt])!=null&&Ft.isActive?gt[Jt].isActive=!1:((ui=gt[Jt])==null||ui.destroy(),gt.splice(Jt,1));tt.dataLabel=gt[0],tt.dataLabels=gt})),Sp(this,"afterDrawDataLabels")}function S(N,z,j,q,K,se){let re=this.chart,te=z.align,ce=z.verticalAlign,fe=N.box?0:N.padding||0,Xe=re.inverted?this.yAxis:this.xAxis,Ne=Xe?Xe.left-re.plotLeft:0,$e=re.inverted?this.xAxis:this.yAxis,mt=$e?$e.top-re.plotTop:0,{x:tt=0,y:gt=0}=z,Bt,Jt;return(Bt=(j.x||0)+fe+Ne)<0&&(te==="right"&&tt>=0?(z.align="left",z.inside=!0):tt-=Bt,Jt=!0),(Bt=(j.x||0)+q.width-fe+Ne)>re.plotWidth&&(te==="left"&&tt<=0?(z.align="right",z.inside=!0):tt+=re.plotWidth-Bt,Jt=!0),(Bt=j.y+fe+mt)<0&&(ce==="bottom"&&gt>=0?(z.verticalAlign="top",z.inside=!0):gt-=Bt,Jt=!0),(Bt=(j.y||0)+q.height-fe+mt)>re.plotHeight&&(ce==="top"&&gt<=0?(z.verticalAlign="bottom",z.inside=!0):gt+=re.plotHeight-Bt,Jt=!0),Jt&&(z.x=tt,z.y=gt,N.placed=!se,N.align(z,void 0,K)),Jt}function A(N,z){let j=[],q;if(bc(N)&&!bc(z))j=N.map(function(K){return rf(K,z)});else if(bc(z)&&!bc(N))j=z.map(function(K){return rf(N,K)});else if(bc(N)||bc(z)){if(bc(N)&&bc(z))for(q=Math.max(N.length,z.length);q--;)j[q]=rf(N[q],z[q])}else j=rf(N,z);return j}function I(N){var j,q;let z=N.chart.options.plotOptions;return Zm(A(A((j=z==null?void 0:z.series)==null?void 0:j.dataLabels,(q=z==null?void 0:z[N.type])==null?void 0:q.dataLabels),N.options.dataLabels))}function O(N,z,j,q,K){let se=this.chart,re=se.inverted,te=this.xAxis,ce=te.reversed,fe=((re?z.height:z.width)||0)/2,Xe=N.pointWidth,Ne=Xe?Xe/2:0;z.startXPos=re?K.x:ce?-fe-Ne:te.width-fe+Ne,z.startYPos=re?ce?this.yAxis.height-fe+Ne:-fe-Ne:K.y,q?z.visibility==="hidden"&&(z.show(),z.attr({opacity:0}).animate({opacity:1})):z.attr({opacity:1}).animate({opacity:0},void 0,z.hide),se.hasRendered&&(j&&z.attr({x:z.startXPos,y:z.startYPos}),z.placed=!0)}R.compose=function(N){let z=N.prototype;z.initDataLabels||(z.initDataLabels=x,z.initDataLabelsGroup=p,z.alignDataLabel=u,z.drawDataLabels=v,z.justifyDataLabel=S,z.mergeArrays=A,z.setDataLabelStartPos=O,z.hasDataLabels=o)}})(Ye||(Ye={}));let sf=Ye,{composed:j_}=ke,{series:Cp}=Pr,{merge:Il,pushUnique:lo}=xe;(function(R){function o(u,p,x,v,S){var se,re;let{chart:A,options:I}=this,O=A.inverted,N=((se=this.xAxis)==null?void 0:se.len)||A.plotSizeX||0,z=((re=this.yAxis)==null?void 0:re.len)||A.plotSizeY||0,j=u.dlBox||u.shapeArgs,q=u.below??(u.plotY||0)>(this.translatedThreshold??z),K=x.inside??!!I.stacking;if(j){if(v=Il(j),x.overflow!=="allow"||x.crop!==!1||I.clip!==!1){v.y<0&&(v.height+=v.y,v.y=0);let te=v.y+v.height-z;te>0&&te<v.height-1&&(v.height-=te)}O&&(v={x:z-v.y-v.height,y:N-v.x-v.width,width:v.height,height:v.width}),K||(O?(v.x+=q?0:v.width,v.width=0):(v.y+=q?v.height:0,v.height=0))}x.align??(x.align=!O||K?"center":q?"right":"left"),x.verticalAlign??(x.verticalAlign=O||K?"middle":q?"top":"bottom"),Cp.prototype.alignDataLabel.call(this,u,p,x,v,S),x.inside&&u.contrastColor&&p.css({color:u.contrastColor})}R.compose=function(u){sf.compose(Cp),lo(j_,"ColumnDataLabel")&&(u.prototype.alignDataLabel=o)}})(Ze||(Ze={}));let av=Ze,{extend:Ym,merge:lv}=xe;class Km extends tf{}Km.defaultOptions=lv(tf.defaultOptions,{}),Ym(Km.prototype,{inverted:!0}),Pr.registerSeriesType("bar",Km);let{column:cv,line:Ap}=Pr.seriesTypes,{addEvent:Mp,extend:$_,merge:fh}=xe;class wc extends Ap{applyJitter(){let o=this,u=this.options.jitter,p=this.points.length;u&&this.points.forEach(function(x,v){["x","y"].forEach(function(S,A){if(u[S]&&!x.isNull){let I=`plot${S.toUpperCase()}`,O=o[`${S}Axis`],N=u[S]*O.transA;if(O&&!O.logarithmic){let z=Math.max(0,(x[I]||0)-N),j=Math.min(O.len,(x[I]||0)+N);x[I]=z+(j-z)*function(q){let K=1e4*Math.sin(q);return K-Math.floor(K)}(v+A*p),S==="x"&&(x.clientX=x.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}wc.defaultOptions=fh(Ap.defaultOptions,{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}"></span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),$_(wc.prototype,{drawTracker:cv.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),Mp(wc,"afterTranslate",function(){this.applyJitter()}),Pr.registerSeriesType("scatter",wc);let{deg2rad:G_}=ke,{fireEvent:hv,isNumber:Jm,pick:Ip,relativeLength:uv}=xe;(function(R){R.getCenter=function(){let o=this.options,u=this.chart,p=2*(o.slicedOffset||0),x=u.plotWidth-2*p,v=u.plotHeight-2*p,S=o.center,A=Math.min(x,v),I=o.thickness,O,N=o.size,z=o.innerSize||0,j,q;typeof N=="string"&&(N=parseFloat(N)),typeof z=="string"&&(z=parseFloat(z));let K=[Ip(S==null?void 0:S[0],"50%"),Ip(S==null?void 0:S[1],"50%"),Ip(N&&N<0?void 0:o.size,"100%"),Ip(z&&z<0?void 0:o.innerSize||0,"0%")];for(!u.angular||this instanceof ys||(K[3]=0),j=0;j<4;++j)q=K[j],O=j<2||j===2&&/%$/.test(q),K[j]=uv(q,[x,v,A,K[2]][j])+(O?p:0);return K[3]>K[2]&&(K[3]=K[2]),Jm(I)&&2*I<K[2]&&I>0&&(K[3]=K[2]-2*I),hv(this,"afterGetCenter",{positions:K}),K},R.getStartAndEndRadians=function(o,u){let p=Jm(o)?o:0,x=Jm(u)&&u>p&&u-p<360?u:p+360;return{start:G_*(p+-90),end:G_*(x+-90)}}})(je||(je={}));let W_=je,{setAnimation:dv}=Cn,{addEvent:kp,defined:fv,extend:Su,isNumber:pv,pick:Vn,relativeLength:Pp}=xe;class Qm extends ee{getConnectorPath(o){let u=o.dataLabelPosition,p=o.options||{},x=p.connectorShape,v=this.connectorShapes[x]||x;return u&&v.call(this,{...u.computed,alignment:u.alignment},u.connectorPosition,p)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(o){let u=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(u.x,u.y,u.r+o,u.r+o,{innerR:u.r-1,start:u.start,end:u.end,borderRadius:u.borderRadius})}constructor(o,u,p){super(o,u,p),this.half=0,this.name??(this.name=o.chart.options.lang.pieSliceName);let x=v=>{this.slice(v.type==="select")};kp(this,"select",x),kp(this,"unselect",x)}isValid(){return pv(this.y)&&this.y>=0}setVisible(o,u=!0){o!==this.visible&&this.update({visible:o??!this.visible},u,void 0,!1)}slice(o,u,p){let x=this.series;dv(p,x.chart),u=Vn(u,!0),this.sliced=this.options.sliced=o=fv(o)?o:!this.sliced,x.options.data[x.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}Su(Qm.prototype,{connectorShapes:{fixedOffset:function(R,o,u){let p=o.breakAt,x=o.touchingSliceAt,v=u.softConnector?["C",R.x+(R.alignment==="left"?-5:5),R.y,2*p.x-x.x,2*p.y-x.y,p.x,p.y]:["L",p.x,p.y];return[["M",R.x,R.y],v,["L",x.x,x.y]]},straight:function(R,o){let u=o.touchingSliceAt;return[["M",R.x,R.y],["L",u.x,u.y]]},crookedLine:function(R,o,u){let{angle:p=this.angle||0,breakAt:x,touchingSliceAt:v}=o,{series:S}=this,[A,I,O]=S.center,N=O/2,{plotLeft:z,plotWidth:j}=S.chart,q=R.alignment==="left",{x:K,y:se}=R,re=x.x;if(u.crookDistance){let ce=Pp(u.crookDistance,1);re=q?A+N+(j+z-A-N)*(1-ce):z+(A-N)*ce}else re=A+(I-se)*Math.tan(p-Math.PI/2);let te=[["M",K,se]];return(q?re<=K&&re>=x.x:re>=K&&re<=x.x)&&te.push(["L",re,se]),te.push(["L",x.x,x.y],["L",v.x,v.y]),te}}});let{getStartAndEndRadians:Lp}=W_,{noop:of}=ke,{clamp:af,extend:H_,fireEvent:eg,merge:ph,pick:tg}=xe;class lf extends ys{animate(o){let u=this,p=u.points,x=u.startAngleRad;o||p.forEach(function(v){let S=v.graphic,A=v.shapeArgs;S&&A&&(S.attr({r:tg(v.startR,u.center&&u.center[3]/2),start:x,end:x}),S.animate({r:A.r,start:A.start,end:A.end},u.options.animation))})}drawEmpty(){let o,u,p=this.startAngleRad,x=this.endAngleRad,v=this.options;this.total===0&&this.center?(o=this.center[0],u=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(o,u,this.center[1]/2,0,p,x).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:Gh.arc(o,u,this.center[2]/2,0,{start:p,end:x,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":v.borderWidth,fill:v.fillColor||"none",stroke:v.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let o=this.chart.renderer;this.points.forEach(function(u){u.graphic&&u.hasNewShapeType()&&(u.graphic=u.graphic.destroy()),u.graphic||(u.graphic=o[u.shapeType](u.shapeArgs).add(u.series.group),u.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(o,u,p,x){let v=this.center,S=this.radii?this.radii[p.index]||0:v[2]/2,A=x.dataLabelPosition,I=(A==null?void 0:A.distance)||0,O=Math.asin(af((o-v[1])/(S+I),-1,1));return v[0]+Math.cos(O)*(S+I)*(u?-1:1)+(I>0?(u?-1:1)*(x.padding||0):0)}hasData(){return!!this.dataTable.rowCount}redrawPoints(){let o,u,p,x,v=this,S=v.chart;this.drawEmpty(),v.group&&!S.styledMode&&v.group.shadow(v.options.shadow),v.points.forEach(function(A){let I={};u=A.graphic,!A.isNull&&u?(x=A.shapeArgs,o=A.getTranslate(),S.styledMode||(p=v.pointAttribs(A,A.selected&&"select")),A.delayedRendering?(u.setRadialReference(v.center).attr(x).attr(o),S.styledMode||u.attr(p).attr({"stroke-linejoin":"round"}),A.delayedRendering=!1):(u.setRadialReference(v.center),S.styledMode||ph(!0,I,p),ph(!0,I,x,o),u.animate(I)),u.attr({visibility:A.visible?"inherit":"hidden"}),u.addClass(A.getClassName(),!0)):u&&(A.graphic=u.destroy())})}sortByAngle(o,u){o.sort(function(p,x){return p.angle!==void 0&&(x.angle-p.angle)*u})}translate(o){eg(this,"translate"),this.generatePoints();let u=this.options,p=u.slicedOffset,x=Lp(u.startAngle,u.endAngle),v=this.startAngleRad=x.start,S=(this.endAngleRad=x.end)-v,A=this.points,I=u.ignoreHiddenPoint,O=A.length,N,z,j,q,K,se,re,te=0;for(o||(this.center=o=this.getCenter()),se=0;se<O;se++){re=A[se],N=v+te*S,re.isValid()&&(!I||re.visible)&&(te+=re.percentage/100),z=v+te*S;let ce={x:o[0],y:o[1],r:o[2]/2,innerR:o[3]/2,start:Math.round(1e3*N)/1e3,end:Math.round(1e3*z)/1e3};re.shapeType="arc",re.shapeArgs=ce,(j=(z+N)/2)>1.5*Math.PI?j-=2*Math.PI:j<-Math.PI/2&&(j+=2*Math.PI),re.slicedTranslation={translateX:Math.round(Math.cos(j)*p),translateY:Math.round(Math.sin(j)*p)},q=Math.cos(j)*o[2]/2,K=Math.sin(j)*o[2]/2,re.tooltipPos=[o[0]+.7*q,o[1]+.7*K],re.half=+(j<-Math.PI/2||j>Math.PI/2),re.angle=j}eg(this,"afterTranslate")}updateTotals(){let o=this.points,u=o.length,p=this.options.ignoreHiddenPoint,x,v,S=0;for(x=0;x<u;x++)(v=o[x]).isValid()&&(!p||v.visible)&&(S+=v.y);for(x=0,this.total=S;x<u;x++)(v=o[x]).percentage=S>0&&(v.visible||!p)?v.y/S*100:0,v.total=S}}lf.defaultOptions=ph(ys.defaultOptions,{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.isNull?void 0:this.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}),H_(lf.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:tf.prototype.drawTracker,getCenter:W_.getCenter,getSymbol:of,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:tf.prototype.pointAttribs,pointClass:Qm,requireSorting:!1,searchPoint:of,trackerGroups:["group","dataLabelsGroup"]}),Pr.registerSeriesType("pie",lf);let{composed:ig,noop:mv}=ke,{distribute:q_}=Ua,{series:Cu}=Pr,{arrayMax:gv,clamp:Dp,defined:X_,pick:rg,pushUnique:ng,relativeLength:cf}=xe;(function(R){let o={radialDistributionY:function(S,A){var I;return(((I=A.dataLabelPosition)==null?void 0:I.top)||0)+S.distributeBox.pos},radialDistributionX:function(S,A,I,O,N){let z=N.dataLabelPosition;return S.getX(I<((z==null?void 0:z.top)||0)+2||I>((z==null?void 0:z.bottom)||0)-2?O:I,A.half,A,N)},justify:function(S,A,I,O){var N;return O[0]+(S.half?-1:1)*(I+(((N=A.dataLabelPosition)==null?void 0:N.distance)||0))},alignToPlotEdges:function(S,A,I,O){let N=S.getBBox().width;return A?N+O:I-N-O},alignToConnectors:function(S,A,I,O){let N=0,z;return S.forEach(function(j){(z=j.dataLabel.getBBox().width)>N&&(N=z)}),A?N+O:I-N-O}};function u(S,A){let I=Math.PI/2,{start:O=0,end:N=0}=S.shapeArgs||{},z=S.angle||0;A>0&&O<I&&N>I&&z>I/2&&z<1.5*I&&(z=z<=I?Math.max(I/2,(O+I)/2):Math.min(1.5*I,(I+N)/2));let{center:j,options:q}=this,K=j[2]/2,se=Math.cos(z),re=Math.sin(z),te=j[0]+se*K,ce=j[1]+re*K,fe=Math.min((q.slicedOffset||0)+(q.borderWidth||0),A/5);return{natural:{x:te+se*A,y:ce+re*A},computed:{},alignment:A<0?"center":S.half?"right":"left",connectorPosition:{angle:z,breakAt:{x:te+se*fe,y:ce+re*fe},touchingSliceAt:{x:te,y:ce}},distance:A}}function p(){var mt;let S=this,A=S.points,I=S.chart,O=I.plotWidth,N=I.plotHeight,z=I.plotLeft,j=Math.round(I.chartWidth/3),q=S.center,K=q[2]/2,se=q[1],re=[[],[]],te=[0,0,0,0],ce=S.dataLabelPositioners,fe,Xe,Ne,$e=0;S.visible&&((mt=S.hasDataLabels)!=null&&mt.call(S))&&(A.forEach(tt=>{(tt.dataLabels||[]).forEach(gt=>{gt.shortened&&(gt.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),gt.shortened=!1)})}),Cu.prototype.drawDataLabels.apply(S),A.forEach(tt=>{(tt.dataLabels||[]).forEach((gt,Bt)=>{var ui;let Jt=q[2]/2,ii=gt.options,Ft=cf((ii==null?void 0:ii.distance)||0,Jt);Bt===0&&re[tt.half].push(tt),!X_((ui=ii==null?void 0:ii.style)==null?void 0:ui.width)&&gt.getBBox().width>j&&(gt.css({width:Math.round(.7*j)+"px"}),gt.shortened=!0),gt.dataLabelPosition=this.getDataLabelPosition(tt,Ft),$e=Math.max($e,Ft)})}),re.forEach((tt,gt)=>{let Bt=tt.length,Jt=[],ii,Ft,ui=0,gi;Bt&&(S.sortByAngle(tt,gt-.5),$e>0&&(ii=Math.max(0,se-K-$e),Ft=Math.min(se+K+$e,I.plotHeight),tt.forEach(Ui=>{(Ui.dataLabels||[]).forEach(wi=>{var _r;let ji=wi.dataLabelPosition;ji&&ji.distance>0&&(ji.top=Math.max(0,se-K-ji.distance),ji.bottom=Math.min(se+K+ji.distance,I.plotHeight),ui=wi.getBBox().height||21,wi.lineHeight=I.renderer.fontMetrics(wi.text||wi).h+2*wi.padding,Ui.distributeBox={target:(((_r=wi.dataLabelPosition)==null?void 0:_r.natural.y)||0)-ji.top+wi.lineHeight/2,size:ui,rank:Ui.y},Jt.push(Ui.distributeBox))})}),q_(Jt,gi=Ft+ui-ii,gi/5)),tt.forEach(Ui=>{(Ui.dataLabels||[]).forEach(wi=>{let ji=wi.options||{},_r=Ui.distributeBox,lr=wi.dataLabelPosition,br=(lr==null?void 0:lr.natural.y)||0,Cs=ji.connectorPadding||0,yr=wi.lineHeight||21,Br=(yr-wi.getBBox().height)/2,qi=0,pi=br,kn="inherit";if(lr){if(Jt&&X_(_r)&&lr.distance>0&&(_r.pos===void 0?kn="hidden":(Ne=_r.size,pi=ce.radialDistributionY(Ui,wi))),ji.justify)qi=ce.justify(Ui,wi,K,q);else switch(ji.alignTo){case"connectors":qi=ce.alignToConnectors(tt,gt,O,z);break;case"plotEdges":qi=ce.alignToPlotEdges(wi,gt,O,z);break;default:qi=ce.radialDistributionX(S,Ui,pi-Br,br,wi)}if(lr.attribs={visibility:kn,align:lr.alignment},lr.posAttribs={x:qi+(ji.x||0)+({left:Cs,right:-Cs}[lr.alignment]||0),y:pi+(ji.y||0)-yr/2},lr.computed.x=qi,lr.computed.y=pi-Br,rg(ji.crop,!0)){let Fr;qi-(Xe=wi.getBBox().width)<Cs&&gt===1?(Fr=Math.round(Xe-qi+Cs),te[3]=Math.max(Fr,te[3])):qi+Xe>O-Cs&&gt===0&&(Fr=Math.round(qi+Xe-O+Cs),te[1]=Math.max(Fr,te[1])),pi-Ne/2<0?te[0]=Math.max(Math.round(-pi+Ne/2),te[0]):pi+Ne/2>N&&(te[2]=Math.max(Math.round(pi+Ne/2-N),te[2])),lr.sideOverflow=Fr}}})}))}),(gv(te)===0||this.verifyDataLabelOverflow(te))&&(this.placeDataLabels(),this.points.forEach(tt=>{(tt.dataLabels||[]).forEach(gt=>{var Ft;let{connectorColor:Bt,connectorWidth:Jt=1}=gt.options||{},ii=gt.dataLabelPosition;if(Jt){let ui;fe=gt.connector,ii&&ii.distance>0?(ui=!fe,fe||(gt.connector=fe=I.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+tt.colorIndex+(tt.className?" "+tt.className:"")).add(S.dataLabelsGroup)),I.styledMode||fe.attr({"stroke-width":Jt,stroke:Bt||tt.color||"#666666"}),fe[ui?"attr":"animate"]({d:tt.getConnectorPath(gt)}),fe.attr({visibility:(Ft=ii.attribs)==null?void 0:Ft.visibility})):fe&&(gt.connector=fe.destroy())}})})))}function x(){this.points.forEach(S=>{(S.dataLabels||[]).forEach(A=>{var O,N;let I=A.dataLabelPosition;I?(I.sideOverflow&&(A.css({width:Math.max(A.getBBox().width-I.sideOverflow,0)+"px",textOverflow:((N=(O=A.options)==null?void 0:O.style)==null?void 0:N.textOverflow)||"ellipsis"}),A.shortened=!0),A.attr(I.attribs),A[A.moved?"animate":"attr"](I.posAttribs),A.moved=!0):A&&A.attr({y:-9999})}),delete S.distributeBox},this)}function v(S){let A=this.center,I=this.options,O=I.center,N=I.minSize||80,z=N,j=I.size!==null;return!j&&(O[0]!==null?z=Math.max(A[2]-Math.max(S[1],S[3]),N):(z=Math.max(A[2]-S[1]-S[3],N),A[0]+=(S[3]-S[1])/2),O[1]!==null?z=Dp(z,N,A[2]-Math.max(S[0],S[2])):(z=Dp(z,N,A[2]-S[0]-S[2]),A[1]+=(S[0]-S[2])/2),z<A[2]?(A[2]=z,A[3]=Math.min(I.thickness?Math.max(0,z-2*I.thickness):Math.max(0,cf(I.innerSize||0,z)),z),this.translate(A),this.drawDataLabels&&this.drawDataLabels()):j=!0),j}R.compose=function(S){if(sf.compose(Cu),ng(ig,"PieDataLabel")){let A=S.prototype;A.dataLabelPositioners=o,A.alignDataLabel=mv,A.drawDataLabels=p,A.getDataLabelPosition=u,A.placeDataLabels=x,A.verifyDataLabelOverflow=v}}})(ae||(ae={}));let _v=ae;(function(R){R.getCenterOfPoints=function(o){let u=o.reduce((p,x)=>(p.x+=x.x,p.y+=x.y,p),{x:0,y:0});return{x:u.x/o.length,y:u.y/o.length}},R.getDistanceBetweenPoints=function(o,u){return Math.sqrt(Math.pow(u.x-o.x,2)+Math.pow(u.y-o.y,2))},R.getAngleBetweenPoints=function(o,u){return Math.atan2(u.x-o.x,u.y-o.y)},R.pointInPolygon=function({x:o,y:u},p){let x=p.length,v,S,A=!1;for(v=0,S=x-1;v<x;S=v++){let[I,O]=p[v],[N,z]=p[S];O>u!=z>u&&o<(N-I)*(u-O)/(z-O)+I&&(A=!A)}return A}})(ge||(ge={}));let{pointInPolygon:yv}=ge,{addEvent:xv,getAlignFactor:vv,fireEvent:Z_,objectEach:Y_,pick:Op}=xe;function bv(R){let o=R.length,u=(N,z)=>!(z.x>=N.x+N.width||z.x+z.width<=N.x||z.y>=N.y+N.height||z.y+z.height<=N.y),p=(N,z)=>{for(let j of N)if(yv({x:j[0],y:j[1]},z))return!0;return!1},x,v,S,A,I,O=!1;for(let N=0;N<o;N++)(x=R[N])&&(x.oldOpacity=x.opacity,x.newOpacity=1,x.absoluteBox=function(z){var j,q;if(z&&(!z.alignAttr||z.placed)){let K=z.box?0:z.padding||0,se=z.alignAttr||{x:z.attr("x"),y:z.attr("y")},{height:re,polygon:te,width:ce}=z.getBBox(),fe=vv(z.alignValue)*ce;return z.width=ce,z.height=re,{x:se.x+(((j=z.parentGroup)==null?void 0:j.translateX)||0)+K-fe,y:se.y+(((q=z.parentGroup)==null?void 0:q.translateY)||0)+K,width:ce-2*K,height:re-2*K,polygon:te}}}(x));R.sort((N,z)=>(z.labelrank||0)-(N.labelrank||0));for(let N=0;N<o;++N){A=(v=R[N])&&v.absoluteBox;let z=A==null?void 0:A.polygon;for(let j=N+1;j<o;++j){I=(S=R[j])&&S.absoluteBox;let q=!1;if(A&&I&&v!==S&&v.newOpacity!==0&&S.newOpacity!==0&&v.visibility!=="hidden"&&S.visibility!=="hidden"){let K=I.polygon;if(z&&K&&z!==K?p(z,K)&&(q=!0):u(A,I)&&(q=!0),q){let se=v.labelrank<S.labelrank?v:S,re=se.text;se.newOpacity=0,re!=null&&re.element.querySelector("textPath")&&re.hide()}}}}for(let N of R)sg(N,this)&&(O=!0);O&&Z_(this,"afterHideAllOverlappingLabels")}function sg(R,o){let u,p=!1;return R&&(u=R.newOpacity,R.oldOpacity!==u&&(R.hasClass("highcharts-data-label")?(R[u?"removeClass":"addClass"]("highcharts-data-label-hidden"),p=!0,R[R.isOld?"animate":"attr"]({opacity:u},void 0,function(){o.styledMode||R.css({pointerEvents:u?"auto":"none"})}),Z_(o,"afterHideOverlappingLabel")):R.attr({opacity:u})),R.isOld=!0),p}function Au(){var u;let R=this,o=[];for(let p of R.labelCollectors||[])o=o.concat(p());for(let p of R.yAxis||[])p.stacking&&p.options.stackLabels&&!p.options.stackLabels.allowOverlap&&Y_(p.stacking.stacks,x=>{Y_(x,v=>{v.label&&o.push(v.label)})});for(let p of R.series||[])if(p.visible&&((u=p.hasDataLabels)!=null&&u.call(p))){let x=v=>{for(let S of v)S.visible&&(S.dataLabels||[]).forEach(A=>{var O;let I=A.options||{};A.labelrank=Op(I.labelrank,S.labelrank,(O=S.shapeArgs)==null?void 0:O.height),I.allowOverlap??Number(I.distance)>0?(A.oldOpacity=A.opacity,A.newOpacity=1,sg(A,R)):o.push(A)})};x(p.nodes||[]),x(p.points)}this.hideOverlappingLabels(o)}let K_={compose:function(R){let o=R.prototype;o.hideOverlappingLabels||(o.hideOverlappingLabels=bv,xv(R,"render",Au))}},{defaultOptions:wv}=Le,{noop:J_}=ke,{addEvent:og,extend:Q_,isObject:ey,merge:Tv,relativeLength:ag}=xe,lg={radius:0,scope:"stack",where:void 0},hf=J_,uf=J_;function Ev(R,o,u,p,x={}){let v=hf(R,o,u,p,x),{innerR:S=0,r:A=u,start:I=0,end:O=0}=x;if(x.open||!x.borderRadius)return v;let N=O-I,z=Math.sin(N/2),j=Math.max(Math.min(ag(x.borderRadius||0,A-S),(A-S)/2,A*z/(1+z)),0),q=Math.min(j,N/Math.PI*2*S),K=v.length-1;for(;K--;)(function(se,re,te){let ce,fe,Xe,Ne=se[re],$e=se[re+1];if($e[0]==="Z"&&($e=se[0]),(Ne[0]==="M"||Ne[0]==="L")&&$e[0]==="A"?(ce=Ne,fe=$e,Xe=!0):Ne[0]==="A"&&($e[0]==="M"||$e[0]==="L")&&(ce=$e,fe=Ne),ce&&fe&&fe.params){let mt=fe[1],tt=fe[5],gt=fe.params,{start:Bt,end:Jt,cx:ii,cy:Ft}=gt,ui=tt?mt-te:mt+te,gi=ui?Math.asin(te/ui):0,Ui=tt?gi:-gi,wi=Math.cos(gi)*ui;Xe?(gt.start=Bt+Ui,ce[1]=ii+wi*Math.cos(Bt),ce[2]=Ft+wi*Math.sin(Bt),se.splice(re+1,0,["A",te,te,0,0,1,ii+mt*Math.cos(gt.start),Ft+mt*Math.sin(gt.start)])):(gt.end=Jt-Ui,fe[6]=ii+mt*Math.cos(gt.end),fe[7]=Ft+mt*Math.sin(gt.end),se.splice(re+1,0,["A",te,te,0,0,1,ii+wi*Math.cos(Jt),Ft+wi*Math.sin(Jt)])),fe[4]=Math.abs(gt.end-gt.start)<Math.PI?0:1}})(v,K,K>1?q:j);return v}function Sv(){var R,o;if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:u,yAxis:p}=this,x=u.stacking==="percent",v=(o=(R=wv.plotOptions)==null?void 0:R[this.type])==null?void 0:o.borderRadius,S=mh(u.borderRadius,ey(v)?v:{}),A=p.options.reversed;for(let I of this.points){let{shapeArgs:O}=I;if(I.shapeType==="roundedRect"&&O){let{width:N=0,height:z=0,y:j=0}=O,q=j,K=z;if(S.scope==="stack"&&I.stackTotal){let ce=p.translate(x?100:I.stackTotal,!1,!0,!1,!0),fe=p.translate(u.threshold||0,!1,!0,!1,!0),Xe=this.crispCol(0,Math.min(ce,fe),0,Math.abs(ce-fe));q=Xe.y,K=Xe.height}let se=(I.negative?-1:1)*(A?-1:1)==-1,re=S.where;!re&&this.is("waterfall")&&Math.abs((I.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(re="all"),re||(re="end");let te=Math.min(ag(S.radius,N),N/2,re==="all"?z/2:1/0)||0;re==="end"&&(se&&(q-=te),K+=te),Q_(O,{brBoxHeight:K,brBoxY:q,r:te})}}}}function mh(R,o){return ey(R)||(R={radius:R||0}),Tv(lg,o,R)}function df(){let R=mh(this.options.borderRadius);for(let o of this.points){let u=o.shapeArgs;u&&(u.borderRadius=ag(R.radius,(u.r||0)-(u.innerR||0)))}}function ty(R,o,u,p,x={}){let v=uf(R,o,u,p,x),{r:S=0,brBoxHeight:A=p,brBoxY:I=o}=x,O=o-I,N=I+A-(o+p),z=O-S>-.1?0:S,j=N-S>-.1?0:S,q=Math.max(z&&O,0),K=Math.max(j&&N,0),se=[R+z,o],re=[R+u-z,o],te=[R+u,o+z],ce=[R+u,o+p-j],fe=[R+u-j,o+p],Xe=[R+j,o+p],Ne=[R,o+p-j],$e=[R,o+z],mt=(tt,gt)=>Math.sqrt(Math.pow(tt,2)-Math.pow(gt,2));if(q){let tt=mt(z,z-q);se[0]-=tt,re[0]+=tt,te[1]=$e[1]=o+z-q}if(p<z-q){let tt=mt(z,z-q-p);te[0]=ce[0]=R+u-z+tt,fe[0]=Math.min(te[0],fe[0]),Xe[0]=Math.max(ce[0],Xe[0]),Ne[0]=$e[0]=R+z-tt,te[1]=$e[1]=o+p}if(K){let tt=mt(j,j-K);fe[0]+=tt,Xe[0]-=tt,ce[1]=Ne[1]=o+p-j+K}if(p<j-K){let tt=mt(j,j-K-p);te[0]=ce[0]=R+u-j+tt,re[0]=Math.min(te[0],re[0]),se[0]=Math.max(ce[0],se[0]),Ne[0]=$e[0]=R+j-tt,ce[1]=Ne[1]=o}return v.length=0,v.push(["M",...se],["L",...re],["A",z,z,0,0,1,...te],["L",...ce],["A",j,j,0,0,1,...fe],["L",...Xe],["A",j,j,0,0,1,...Ne],["L",...$e],["A",z,z,0,0,1,...se],["Z"]),v}let{diffObjects:ff,extend:iy,find:Cv,merge:ry,pick:pf,uniqueKey:ny}=xe;(function(R){function o(p,x){let v=p.condition;(v.callback||function(){return this.chartWidth<=pf(v.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=pf(v.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=pf(v.minWidth,0)&&this.chartHeight>=pf(v.minHeight,0)}).call(this)&&x.push(p._id)}function u(p,x){let v=this.options.responsive,S=this.currentResponsive,A=[],I;!x&&v&&v.rules&&v.rules.forEach(z=>{z._id===void 0&&(z._id=ny()),this.matchResponsiveRule(z,A)},this);let O=ry(...A.map(z=>Cv((v==null?void 0:v.rules)||[],j=>j._id===z)).map(z=>z==null?void 0:z.chartOptions));O.isResponsiveOptions=!0,A=A.toString()||void 0;let N=S==null?void 0:S.ruleIds;A===N||(S&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(S.undoOptions,p,!0),this.updatingResponsive=!1),A?((I=ff(O,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:A,mergedOptions:O,undoOptions:I},this.updatingResponsive||this.update(O,p,!0)):this.currentResponsive=void 0)}R.compose=function(p){let x=p.prototype;return x.matchResponsiveRule||iy(x,{matchResponsiveRule:o,setResponsive:u}),p}})(Oe||(Oe={}));let sy=Oe;ke.AST=jr,ke.Axis=Ha,ke.Chart=Qo,ke.Color=st,ke.DataLabel=sf,ke.DataTableCore=Hi,ke.Fx=zi,ke.HTMLElement=gl,ke.Legend=hp,ke.LegendSymbol=Or,ke.OverlappingDataLabels=ke.OverlappingDataLabels||K_,ke.PlotLineOrBand=oh,ke.Point=ee,ke.Pointer=Xt,ke.RendererRegistry=vo,ke.Series=ys,ke.SeriesRegistry=Pr,ke.StackItem=jm,ke.SVGElement=is,ke.SVGRenderer=Xc,ke.Templating=fs,ke.Tick=ba,ke.Time=us,ke.Tooltip=hu,ke.animate=Cn.animate,ke.animObject=Cn.animObject,ke.chart=Qo.chart,ke.color=st.parse,ke.dateFormat=fs.dateFormat,ke.defaultOptions=Le.defaultOptions,ke.distribute=Ua.distribute,ke.format=fs.format,ke.getDeferredAnimation=Cn.getDeferredAnimation,ke.getOptions=Le.getOptions,ke.numberFormat=fs.numberFormat,ke.seriesType=Pr.seriesType,ke.setAnimation=Cn.setAnimation,ke.setOptions=Le.setOptions,ke.stop=Cn.stop,ke.time=Le.defaultTime,ke.timers=zi.timers,{compose:function(R,o,u){let p=R.types.pie;if(!o.symbolCustomAttribs.includes("borderRadius")){let x=u.prototype.symbols;og(R,"afterColumnTranslate",Sv,{order:9}),og(p,"afterTranslate",df),o.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),hf=x.arc,uf=x.roundedRect,x.arc=Ev,x.roundedRect=ty}},optionsToObject:mh}.compose(ke.Series,ke.SVGElement,ke.SVGRenderer),av.compose(ke.Series.types.column),sf.compose(ke.Series),Ed.compose(ke.Axis),gl.compose(ke.SVGRenderer),hp.compose(ke.Chart),sh.compose(ke.Axis),K_.compose(ke.Chart),_v.compose(ke.Series.types.pie),oh.compose(ke.Chart,ke.Axis),Xt.compose(ke.Chart),sy.compose(ke.Chart),Ns.compose(ke.Axis,ke.Chart,ke.Series),R_.compose(ke.Axis,ke.Chart,ke.Series),hu.compose(ke.Pointer),xe.extend(ke,xe);let oy=ke;return rt.default})())}(T0)),T0.exports}const e5=K3(DL);(function(t,l){(function(d,_){t.exports=_(QN(),e5)})(self,(d,_)=>(()=>{var T={879:s=>{s.exports=d},744:s=>{s.exports=_}},C={};function P(s){var $=C[s];if($!==void 0)return $.exports;var Z=C[s]={exports:{}};return T[s](Z,Z.exports,P),Z.exports}P.n=s=>{var $=s&&s.__esModule?()=>s.default:()=>s;return P.d($,{a:$}),$},P.d=(s,$)=>{for(var Z in $)P.o($,Z)&&!P.o(s,Z)&&Object.defineProperty(s,Z,{enumerable:!0,get:$[Z]})},P.o=(s,$)=>Object.prototype.hasOwnProperty.call(s,$),P.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var V={};return(()=>{P.r(V),P.d(V,{Chart:()=>Me,default:()=>Ye});var s=P(879),$=P.n(s),Z=function Ze(je,ae){var ge=$().isArray(je)?[]:{};function Oe(ze,rt){!$().isObject(ze,!ae)||$().isClass(ze)||$().isDOMElement(ze)?ge[rt]=ze:ge[rt]=Ze(ze,ae)}return $().isArray(je)?je.forEach(function(ze,rt){return Oe(ze,rt)}):$().objectEach(je,Oe),ge},J=P(744);function ne(Ze){return function(je){if(Array.isArray(je))return ue(je)}(Ze)||function(je){if(typeof Symbol<"u"&&je[Symbol.iterator]!=null||je["@@iterator"]!=null)return Array.from(je)}(Ze)||function(je,ae){if(je){if(typeof je=="string")return ue(je,ae);var ge=Object.prototype.toString.call(je).slice(8,-1);if(ge==="Object"&&je.constructor&&(ge=je.constructor.name),ge==="Map"||ge==="Set")return Array.from(je);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return ue(je,ae)}}(Ze)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ue(Ze,je){(je==null||je>Ze.length)&&(je=Ze.length);for(var ae=0,ge=new Array(je);ae<je;ae++)ge[ae]=Ze[ae];return ge}const we=function(Ze){var je=this;return{render:function(){return(0,J.h)("div",{ref:"chart"})},beforeUnmount:function(){var ae;return je==null||(ae=je.chart)===null||ae===void 0?void 0:ae.destroy()},props:{constructorType:{type:String,default:"chart"},options:{type:Object,required:!0},callback:Function,updateArgs:{type:Array,default:function(){return[!0,!0]}},highcharts:{type:Object},deepCopyOnUpdate:{type:Boolean,default:!0}},watch:{options:{handler:function(ae){var ge;(ge=this.chart).update.apply(ge,[Z(ae,this.deepCopyOnUpdate)].concat(ne(this.updateArgs)))},deep:!0}},mounted:function(){var ae=this.highcharts||Ze;ae[this.constructorType]?this.options?this.chart=ae[this.constructorType](this.$refs.chart,Z(this.options,!0),this.callback?this.callback:null):console.error('The "options" parameter was not passed.'):console.error("'".concat(this.constructorType,"' constructor-type is incorrect. Sometimes this error is caused by the fact, that the corresponding module wasn't imported."))}}};var Me=we($());function Ye(Ze){var je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ze.component(je.tagName||"highcharts",we(je.highcharts||$()))}})(),V})())})(KA);var t5=KA.exports;const i5=qA(t5),r5="Soil Values Geoportal",n5={home:"Home",map:"Map",mne:"Monitoring & Evaluation",catalog:"Data Catalogue",about:"About",adminPanel:"Admin Panel",login:"Login",logout:"Logout"},s5={en:"English",fr:"French"},o5=" 2025 Soil Values Geoportal. All rights reserved.",a5={landcover:{name:"Biophysical Monitoring",description:"Monitors key environmental variables including land cover, vegetation indices (NDVI, EVI), topography, and water availability. It offers a holistic view of the landscapes biophysical condition for better planning and resource management."},crop:{name:"Crop Monitoring",description:"This tool provides spatial insights into crop distribution, health, and seasonal performance using remote sensing data. It supports early detection of crop stress, tracking of growth stages, and estimation of yields to inform timely agricultural interventions."},degradation:{name:"Degradation Monitoring",description:"Tracks land degradation over time by analysing vegetation cover, erosion risk, and human impact. It helps identify hotspots of land degradation, supporting targeted land restoration and sustainable land management efforts."},drought:{name:"Drought Monitoring",description:"Detects and visualizes drought events using climatic and remote sensing indicators like rainfall anomalies, vegetation stress, and soil moisture. It supports early warning systems and helps stakeholders prepare and respond to climate risks."},fertility:{name:"Fertility Monitoring",description:"Assesses soil fertility dynamics through indicators such as organic carbon content, nutrient availability, and land use practices. The tool guides stakeholders in making data-informed decisions for improved soil health and productivity."},risk:{name:"Risk Monitoring",description:"Identify environmental risks by monitoring exposure to climate extremes, soil degradation, and water scarcity to prioritize resilience interventions."}},l5={title:"Map Legend",labels:{water:"Water",forest:"Forest",cropland:"Cropland",grassland:"Grassland",shrubland:"Shrubland",wetland:"Wetland",bareland:"Bareland",urban:"Urban",boundary:"Boundary Outline"}},c5={title:"Soil Values Geoportal",intro1:"Welcome to the Soil Values Geoportal, your gateway to dynamic, data-driven insights for landscape restoration and sustainable land management.",intro2:"Explore real-time maps and analytics on land cover, soil health, crops, and climate to inform impactful decisions across our intervention areas.",launch:"Launch"},h5={hero:{title:"Soil Values",subtitle:"Catalyzing Farm Productivity  Burkina Faso, Mali, Niger, Nigeria  Active"},description:{program:"Soil Values",intro:"is a 10-year program (20242034) financed by the Netherlands Directorate-General for International Cooperation (DGIS), aimed at sustainable soil fertility management across Burkina Faso, Mali, Northern Nigeria, and Niger.",impact:"The program targets 2 million hectares and 1.5 million farmersespecially womenfostering resilient, productive farming systems.",approach:"The strategy centers on Integrated Soil Fertility Management (ISFM) and participatory landscape planning to foster scalable, sustainable solutions."},outcomes:{title:"Expected Outcomes",item1:"1.5 million smallholder farmers, including 800,000 women, reduce the yield gap and build resilience to climate shocks.",item2:"40+ river basins and landscapes2 million hectaresare managed sustainably with equitable water use.",item3:"Soil fertility becomes a priority in agricultural programs, national policies, and civil society efforts.",item4:"Neighboring countries (Ghana and Cte dIvoire) engage in dialogue on fertilizer trade and food security."},partners:{title:"Implementing Partners",description1:"Soil Values is implemented by IFDC in collaboration with SNV and Wageningen University and Research (WUR), alongside knowledge partners such as AGRA, ICRAF, IITA, ISRIC, and IWMI.",note:"Supported by DGIS under Dutch development policy."},updates:{title:"Recent Updates"}},u5={title:"Data Catalogue",description:`The Data Catalogue page centralizes access to diverse datasets managed within the geoportal. It provides structured metadata descriptions, facilitating efficient search, discovery, and utilization of spatial and non-spatial data resources.

Users will explore detailed descriptions of datasets, preview data formats, and access download links or APIs for integration into analytical workflows. The page will promote data transparency, interoperability, and accessibility, supporting evidence-based decision-making and collaborative research initiatives across multiple stakeholders.`},d5={title:"MEL Dashboard",description:`The MEL page serves as the central space for tracking project activities, progress, and performance across the Soil Values program. This page will feature an embedded interactive MEL dashboard developed by the IFDC M&E team, offering real-time insights into key indicators, outcomes, and learning milestones.

Users will visualize monitoring data geographically and thematically, supporting evidence-based decision-making and adaptive project management. The integration of this dashboard into the geoportal allows for a seamless link between spatial data and performance monitoring frameworks, promoting transparency, accountability, and learning across stakeholders.`},f5={title:"Biophysical Monitoring",description:"Monitors key environmental variables including land cover, vegetation indices (NDVI, EVI), topography, and water availability. It offers a holistic view of the landscapes biophysical condition for better planning and resource management.",mapLayers:"Map Layers",evi:"Cumulative EVI",health:"Biophysical Health (20102023)",baseline:"Land Cover  Baseline Period (20032008)",evaluation:"Land Cover  Evaluation Period (20102023)"},p5={title:"Soil Fertility Monitoring",description:"Assesses soil fertility dynamics through indicators such as organic carbon content, nutrient availability, and land use practices. The tool guides stakeholders in making data-informed decisions for improved soil health and productivity.",baseline:"Baseline",current:"Current",changes:{positive:"+ Improved",neutral:"No Change"},indicators:{organicMatter:"Organic Matter",nutrientLevels:"Nutrient Levels",erosionRisk:"Erosion Risk",waterRetention:"Water Retention"}},m5={title:"Login",subtitle:"Access your account to manage and upload data",formTitle:"Sign In",loggingIn:"Logging in...",loginButton:"Login",invalidCredentials:"Invalid email or password"},g5={panelTitle:"Admin Panel",uploadRaster:"Upload Raster",createUser:"Create User",generateSyntheticData:"Generate Synthetic Data",manageData:"Manage Data (Coming Soon)",uploadRasterLayer:"Upload Raster Layer",layerName:"Layer Name",category:"Category",year:"Year",description:"Description",uploading:"Uploading...",upload:"Upload",publishedLayers:"Published Layers",createNewUser:"Create New User",email:"Email",password:"Password",role:"Role",selectRole:"Select Role",adminRole:"Admin",partnerRole:"Partner",analystRole:"Analyst",publicRole:"Public",generateSyntheticTitle:"Generate Synthetic Data",generateSyntheticDescription:"This will wipe existing synthetic tables, refill them with new fake data, and point all *_view tables to synthetic versions.",generateNow:"Generate Now",generating:"Generating...",insertedRowCounts:"Inserted Row Counts:",output:"Output:",dataManagementPlaceholderTitle:"Data Management (Coming Soon)",dataManagementPlaceholderDescription:"Future tools for managing datasets, users, and configurations will appear here."},_5={title:"Map Controls",reopen:"Map Controls",basemap:"Basemap",basemapLight:"Light",basemapStreets:"Streets",basemapSatellite:"Satellite",basemapDark:"Dark",country:"Country",watershed:"Watershed",commune:"Commune",select:"Select",rasterLayer:"Raster Layer",selectRaster:"Select Raster",reset:"Reset Map"},y5={title:"Toolbox",tools:{landcover:{name:"Land Cover Monitoring",description:"Visualize and analyze land cover patterns over time, focusing on vegetation types, land use change, and habitat distribution."},crop:{name:"Crop Monitoring",description:"Track crop health and growth using satellite imagery and agricultural datasets to support farming decisions."},degradation:{name:"Land Degradation",description:"Assess soil erosion, deforestation, and land quality decline to inform sustainable land management."},drought:{name:"Drought Monitoring",description:"Monitor drought conditions and water stress using rainfall, temperature, and vegetation health indicators."},fertility:{name:"Soil Fertility",description:"Analyze soil nutrient levels, pH, and organic matter to guide agricultural productivity and soil management."},risk:{name:"Risk Assessment",description:"Evaluate environmental and agricultural risks, including floods, droughts, and other climate hazards."}}},x5={title:r5,nav:n5,lang:s5,footer:o5,tools:a5,legend:l5,home:c5,about:h5,catalog:u5,monitoring:d5,biophysical:f5,fertility:p5,login:m5,admin:g5,mapControls:_5,toolbox:y5},v5="Goportail Soil Values",b5={home:"Accueil",map:"Carte",mne:"Suivi & valuation",catalog:"Catalogue de donnes",about:" propos",adminPanel:"Panneau d'administration",login:"Connexion",logout:"Dconnexion"},w5={en:"Anglais",fr:"Franais"},T5=" 2025 Portail gospatial Soil Values. Tous droits rservs.",E5={title:"Bote  outils",tools:{landcover:{name:"Suivi de la couverture terrestre",description:"Visualiser et analyser les schmas de couverture terrestre au fil du temps, en mettant l'accent sur les types de vgtation, les changements d'utilisation des terres et la rpartition des habitats."},crop:{name:"Suivi des cultures",description:"Suivre la sant et la croissance des cultures  l'aide d'images satellites et de donnes agricoles pour soutenir les dcisions agricoles."},degradation:{name:"Dgradation des terres",description:"valuer l'rosion des sols, la dforestation et le dclin de la qualit des terres afin d'informer une gestion durable."},drought:{name:"Suivi de la scheresse",description:"Surveiller les conditions de scheresse et le stress hydrique  l'aide d'indicateurs de prcipitations, de temprature et de sant de la vgtation."},fertility:{name:"Fertilit des sols",description:"Analyser les niveaux de nutriments, le pH et la matire organique du sol pour guider la productivit agricole et la gestion des sols."},risk:{name:"valuation des risques",description:"valuer les risques environnementaux et agricoles, y compris les inondations, les scheresses et autres alas climatiques."}}},S5={title:"Lgende de la carte",labels:{water:"Eau",forest:"Fort",cropland:"Terres cultives",grassland:"Prairies",shrubland:"Arbustes",wetland:"Zone humide",bareland:"Sol nu",urban:"Zone urbaine",boundary:"Limite"}},C5={title:"Goportail Soil Values",intro1:"Bienvenue sur le Goportail Soil Values, votre passerelle vers des donnes dynamiques pour la restauration des paysages et la gestion durable des terres.",intro2:"Explorez des cartes et des analyses en temps rel sur la couverture terrestre, la sant des sols, les cultures et le climat pour guider vos dcisions.",launch:"Lancer"},A5={hero:{title:"Soil Values",subtitle:"Stimuler la productivit agricole  Burkina Faso, Mali, Niger, Nigria  Actif"},description:{program:"Soil Values",intro:"est un programme de 10 ans (20242034) financ par la Direction gnrale de la coopration internationale des Pays-Bas (DGIS), visant  une gestion durable de la fertilit des sols au Burkina Faso, Mali, Nord du Nigria et Niger.",impact:"Le programme cible 2 millions d'hectares et 1,5 million d'agriculteurs, notamment des femmes, pour renforcer des systmes agricoles rsilients et productifs.",approach:"La stratgie repose sur la Gestion Intgre de la Fertilit des Sols (GIFS) et une planification participative des paysages pour encourager des solutions durables et volutives."},outcomes:{title:"Rsultats Attendus",item1:"1,5 million de petits exploitants agricoles, dont 800 000 femmes, rduisent le dficit de rendement et renforcent leur rsilience face aux chocs climatiques.",item2:"Plus de 40 bassins versants et paysages  2 millions dhectares  sont grs durablement avec une utilisation quitable de leau.",item3:"La fertilit des sols devient une priorit dans les programmes agricoles, les politiques nationales et les actions de la socit civile.",item4:"Les pays voisins (Ghana et Cte dIvoire) dialoguent sur le commerce des engrais et la scurit alimentaire."},partners:{title:"Partenaires de mise en uvre",description1:"Soil Values est mis en uvre par l'IFDC en collaboration avec SNV et lUniversit de Wageningen (WUR), avec des partenaires de connaissance comme AGRA, ICRAF, IITA, ISRIC et IWMI.",note:"Soutenu par la DGIS dans le cadre de la politique de dveloppement nerlandaise."},updates:{title:"Dernires actualits"}},M5={title:"Catalogue de donnes",description:`La page Catalogue de donnes centralise laccs  divers jeux de donnes grs dans le portail gospatial. Elle fournit des descriptions de mtadonnes structures, facilitant la recherche, la dcouverte et lutilisation efficace des ressources de donnes spatiales et non spatiales.

Les utilisateurs peuvent consulter des descriptions dtailles des jeux de donnes, prvisualiser les formats, et accder  des liens de tlchargement ou des API pour les intgrer dans leurs flux de travail analytiques. Cette page favorise la transparence, linteroprabilit et laccessibilit des donnes, soutenant la prise de dcisions fondes sur les donnes et la recherche collaborative entre parties prenantes.`},I5={title:"Tableau de bord MEL",description:`La page MEL constitue lespace central pour suivre les activits du projet, les progrs et les performances dans le cadre du programme Soil Values. Cette page prsentera un tableau de bord MEL interactif dvelopp par lquipe S&E de lIFDC, offrant des informations en temps rel sur les indicateurs cls, les rsultats et les tapes dapprentissage.

Les utilisateurs pourront visualiser les donnes de suivi de manire gographique et thmatique, soutenant la prise de dcision fonde sur des donnes probantes et une gestion adaptative du projet. Lintgration de ce tableau de bord dans le portail gospatial permet un lien fluide entre les donnes spatiales et les cadres de suivi des performances, favorisant la transparence, la redevabilit et lapprentissage entre les parties prenantes.`},k5={title:"Suivi biophysique",description:"Surveille les principales variables environnementales telles que la couverture terrestre, les indices de vgtation (NDVI, EVI), la topographie et la disponibilit en eau. Il offre une vue holistique de l'tat biophysique du paysage pour une meilleure planification et gestion des ressources.",mapLayers:"Couches cartographiques",evi:"EVI cumulatif",health:"Sant biophysique (20102023)",baseline:"Couverture terrestre  Priode de rfrence (20032008)",evaluation:"Couverture terrestre  Priode d'valuation (20102023)"},P5={title:"Suivi de la fertilit des sols",description:"value la dynamique de la fertilit des sols via des indicateurs tels que la teneur en carbone organique, la disponibilit des nutriments et les pratiques d'utilisation des terres. Cet outil aide les parties prenantes  prendre des dcisions claires pour amliorer la sant et la productivit des sols.",baseline:"Rfrence",current:"Actuel",changes:{positive:"+ Amlioration",neutral:"Aucun changement"},indicators:{organicMatter:"Matire organique",nutrientLevels:"Niveaux de nutriments",erosionRisk:"Risque d'rosion",waterRetention:"Rtention d'eau"}},L5={title:"Contrles de la carte",reopen:"Contrles de la carte",basemap:"Fond de carte",basemapLight:"Clair",basemapStreets:"Rues",basemapSatellite:"Satellite",basemapDark:"Sombre",country:"Pays",watershed:"Bassin versant",commune:"Commune",select:"Slectionner",rasterLayer:"Couche raster",selectRaster:"Slectionner un raster",reset:"Rinitialiser la carte"},D5={title:"Connexion",subtitle:"Accdez  votre compte pour grer et tlcharger des donnes",formTitle:"Se connecter",loggingIn:"Connexion en cours...",loginButton:"Connexion",invalidCredentials:"Adresse e-mail ou mot de passe invalide"},O5={panelTitle:"Panneau d'administration",uploadRaster:"Tlcharger un raster",createUser:"Crer un utilisateur",generateSyntheticData:"Gnrer des donnes synthtiques",manageData:"Grer les donnes (Bientt disponible)",uploadRasterLayer:"Tlcharger une couche raster",layerName:"Nom de la couche",category:"Catgorie",year:"Anne",description:"Description",uploading:"Tlchargement...",upload:"Tlcharger",publishedLayers:"Couches publies",createNewUser:"Crer un nouvel utilisateur",email:"E-mail",password:"Mot de passe",role:"Rle",selectRole:"Slectionner un rle",adminRole:"Administrateur",partnerRole:"Partenaire",analystRole:"Analyste",publicRole:"Public",generateSyntheticTitle:"Gnrer des donnes synthtiques",generateSyntheticDescription:"Cela effacera les tables synthtiques existantes, les remplira avec de nouvelles donnes fictives et pointera toutes les tables *_view vers les versions synthtiques.",generateNow:"Gnrer maintenant",generating:"Gnration...",insertedRowCounts:"Nombre de lignes insres :",output:"Sortie :",dataManagementPlaceholderTitle:"Gestion des donnes (Bientt disponible)",dataManagementPlaceholderDescription:"Les futurs outils pour grer les ensembles de donnes, les utilisateurs et les configurations apparatront ici."},R5={title:v5,nav:b5,lang:w5,footer:T5,toolbox:E5,legend:S5,home:C5,about:A5,catalog:M5,monitoring:I5,biophysical:k5,fertility:P5,mapControls:L5,login:D5,admin:O5},z5=RR({legacy:!1,globalInjection:!0,locale:"en",fallbackLocale:"en",messages:{en:x5,fr:R5}});var B5=Object.defineProperty,aE=Object.getOwnPropertySymbols,F5=Object.prototype.hasOwnProperty,N5=Object.prototype.propertyIsEnumerable,lE=(t,l,d)=>l in t?B5(t,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[l]=d,JA=(t,l)=>{for(var d in l||(l={}))F5.call(l,d)&&lE(t,d,l[d]);if(aE)for(var d of aE(l))N5.call(l,d)&&lE(t,d,l[d]);return t},Wx=t=>typeof t=="function",Hx=t=>typeof t=="string",QA=t=>Hx(t)&&t.trim().length>0,U5=t=>typeof t=="number",Af=t=>typeof t>"u",s_=t=>typeof t=="object"&&t!==null,V5=t=>Oc(t,"tag")&&QA(t.tag),eM=t=>window.TouchEvent&&t instanceof TouchEvent,tM=t=>Oc(t,"component")&&iM(t.component),j5=t=>Wx(t)||s_(t),iM=t=>!Af(t)&&(Hx(t)||j5(t)||tM(t)),cE=t=>s_(t)&&["height","width","right","left","top","bottom"].every(l=>U5(t[l])),Oc=(t,l)=>(s_(t)||Wx(t))&&l in t,$5=(t=>()=>t++)(0);function E0(t){return eM(t)?t.targetTouches[0].clientX:t.clientX}function hE(t){return eM(t)?t.targetTouches[0].clientY:t.clientY}var G5=t=>{Af(t.remove)?t.parentNode&&t.parentNode.removeChild(t):t.remove()},g_=t=>tM(t)?g_(t.component):V5(t)?zn({render(){return t}}):typeof t=="string"?t:kr(cn(t)),W5=t=>{if(typeof t=="string")return t;const l=Oc(t,"props")&&s_(t.props)?t.props:{},d=Oc(t,"listeners")&&s_(t.listeners)?t.listeners:{};return{component:g_(t),props:l,listeners:d}},H5=()=>typeof window<"u",e1=class{constructor(){this.allHandlers={}}getHandlers(t){return this.allHandlers[t]||[]}on(t,l){const d=this.getHandlers(t);d.push(l),this.allHandlers[t]=d}off(t,l){const d=this.getHandlers(t);d.splice(d.indexOf(l)>>>0,1)}emit(t,l){this.getHandlers(t).forEach(_=>_(l))}},q5=t=>["on","off","emit"].every(l=>Oc(t,l)&&Wx(t[l])),Ra;(function(t){t.SUCCESS="success",t.ERROR="error",t.WARNING="warning",t.INFO="info",t.DEFAULT="default"})(Ra||(Ra={}));var hx;(function(t){t.TOP_LEFT="top-left",t.TOP_CENTER="top-center",t.TOP_RIGHT="top-right",t.BOTTOM_LEFT="bottom-left",t.BOTTOM_CENTER="bottom-center",t.BOTTOM_RIGHT="bottom-right"})(hx||(hx={}));var za;(function(t){t.ADD="add",t.DISMISS="dismiss",t.UPDATE="update",t.CLEAR="clear",t.UPDATE_DEFAULTS="update_defaults"})(za||(za={}));var Fl="Vue-Toastification",Ol={type:{type:String,default:Ra.DEFAULT},classNames:{type:[String,Array],default:()=>[]},trueBoolean:{type:Boolean,default:!0}},rM={type:Ol.type,customIcon:{type:[String,Boolean,Object,Function],default:!0}},Gy={component:{type:[String,Object,Function,Boolean],default:"button"},classNames:Ol.classNames,showOnHover:{type:Boolean,default:!1},ariaLabel:{type:String,default:"close"}},ub={timeout:{type:[Number,Boolean],default:5e3},hideProgressBar:{type:Boolean,default:!1},isRunning:{type:Boolean,default:!1}},nM={transition:{type:[Object,String],default:`${Fl}__bounce`}},X5={position:{type:String,default:hx.TOP_RIGHT},draggable:Ol.trueBoolean,draggablePercent:{type:Number,default:.6},pauseOnFocusLoss:Ol.trueBoolean,pauseOnHover:Ol.trueBoolean,closeOnClick:Ol.trueBoolean,timeout:ub.timeout,hideProgressBar:ub.hideProgressBar,toastClassName:Ol.classNames,bodyClassName:Ol.classNames,icon:rM.customIcon,closeButton:Gy.component,closeButtonClassName:Gy.classNames,showCloseButtonOnHover:Gy.showOnHover,accessibility:{type:Object,default:()=>({toastRole:"alert",closeButtonLabel:"close"})},rtl:{type:Boolean,default:!1},eventBus:{type:Object,required:!1,default:()=>new e1}},Z5={id:{type:[String,Number],required:!0,default:0},type:Ol.type,content:{type:[String,Object,Function],required:!0,default:""},onClick:{type:Function,default:void 0},onClose:{type:Function,default:void 0}},Y5={container:{type:[Object,Function],default:()=>document.body},newestOnTop:Ol.trueBoolean,maxToasts:{type:Number,default:20},transition:nM.transition,toastDefaults:Object,filterBeforeCreate:{type:Function,default:t=>t},filterToasts:{type:Function,default:t=>t},containerClassName:Ol.classNames,onMounted:Function,shareAppContext:[Boolean,Object]},kh={CORE_TOAST:X5,TOAST:Z5,CONTAINER:Y5,PROGRESS_BAR:ub,ICON:rM,TRANSITION:nM,CLOSE_BUTTON:Gy},sM=zn({name:"VtProgressBar",props:kh.PROGRESS_BAR,data(){return{hasClass:!0}},computed:{style(){return{animationDuration:`${this.timeout}ms`,animationPlayState:this.isRunning?"running":"paused",opacity:this.hideProgressBar?0:1}},cpClass(){return this.hasClass?`${Fl}__progress-bar`:""}},watch:{timeout(){this.hasClass=!1,this.$nextTick(()=>this.hasClass=!0)}},mounted(){this.$el.addEventListener("animationend",this.animationEnded)},beforeUnmount(){this.$el.removeEventListener("animationend",this.animationEnded)},methods:{animationEnded(){this.$emit("close-toast")}}});function K5(t,l){return _i(),Pi("div",{style:zc(t.style),class:Vs(t.cpClass)},null,6)}sM.render=K5;var J5=sM,oM=zn({name:"VtCloseButton",props:kh.CLOSE_BUTTON,computed:{buttonComponent(){return this.component!==!1?g_(this.component):"button"},classes(){const t=[`${Fl}__close-button`];return this.showOnHover&&t.push("show-on-hover"),t.concat(this.classNames)}}}),Q5=js("  ");function e4(t,l){return _i(),No(Mx(t.buttonComponent),d_({"aria-label":t.ariaLabel,class:t.classes},t.$attrs),{default:Us(()=>[Q5]),_:1},16,["aria-label","class"])}oM.render=e4;var t4=oM,aM={},i4={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"check-circle",class:"svg-inline--fa fa-check-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},r4=lt("path",{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},null,-1),n4=[r4];function s4(t,l){return _i(),Pi("svg",i4,n4)}aM.render=s4;var o4=aM,lM={},a4={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",class:"svg-inline--fa fa-info-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},l4=lt("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},null,-1),c4=[l4];function h4(t,l){return _i(),Pi("svg",a4,c4)}lM.render=h4;var uE=lM,cM={},u4={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-circle",class:"svg-inline--fa fa-exclamation-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},d4=lt("path",{fill:"currentColor",d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),f4=[d4];function p4(t,l){return _i(),Pi("svg",u4,f4)}cM.render=p4;var m4=cM,hM={},g4={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-triangle",class:"svg-inline--fa fa-exclamation-triangle fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},_4=lt("path",{fill:"currentColor",d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),y4=[_4];function x4(t,l){return _i(),Pi("svg",g4,y4)}hM.render=x4;var v4=hM,uM=zn({name:"VtIcon",props:kh.ICON,computed:{customIconChildren(){return Oc(this.customIcon,"iconChildren")?this.trimValue(this.customIcon.iconChildren):""},customIconClass(){return Hx(this.customIcon)?this.trimValue(this.customIcon):Oc(this.customIcon,"iconClass")?this.trimValue(this.customIcon.iconClass):""},customIconTag(){return Oc(this.customIcon,"iconTag")?this.trimValue(this.customIcon.iconTag,"i"):"i"},hasCustomIcon(){return this.customIconClass.length>0},component(){return this.hasCustomIcon?this.customIconTag:iM(this.customIcon)?g_(this.customIcon):this.iconTypeComponent},iconTypeComponent(){return{[Ra.DEFAULT]:uE,[Ra.INFO]:uE,[Ra.SUCCESS]:o4,[Ra.ERROR]:v4,[Ra.WARNING]:m4}[this.type]},iconClasses(){const t=[`${Fl}__icon`];return this.hasCustomIcon?t.concat(this.customIconClass):t}},methods:{trimValue(t,l=""){return QA(t)?t.trim():l}}});function b4(t,l){return _i(),No(Mx(t.component),{class:Vs(t.iconClasses)},{default:Us(()=>[js(Vt(t.customIconChildren),1)]),_:1},8,["class"])}uM.render=b4;var w4=uM,dM=zn({name:"VtToast",components:{ProgressBar:J5,CloseButton:t4,Icon:w4},inheritAttrs:!1,props:Object.assign({},kh.CORE_TOAST,kh.TOAST),data(){return{isRunning:!0,disableTransitions:!1,beingDragged:!1,dragStart:0,dragPos:{x:0,y:0},dragRect:{}}},computed:{classes(){const t=[`${Fl}__toast`,`${Fl}__toast--${this.type}`,`${this.position}`].concat(this.toastClassName);return this.disableTransitions&&t.push("disable-transition"),this.rtl&&t.push(`${Fl}__toast--rtl`),t},bodyClasses(){return[`${Fl}__toast-${Hx(this.content)?"body":"component-body"}`].concat(this.bodyClassName)},draggableStyle(){return this.dragStart===this.dragPos.x?{}:this.beingDragged?{transform:`translateX(${this.dragDelta}px)`,opacity:1-Math.abs(this.dragDelta/this.removalDistance)}:{transition:"transform 0.2s, opacity 0.2s",transform:"translateX(0)",opacity:1}},dragDelta(){return this.beingDragged?this.dragPos.x-this.dragStart:0},removalDistance(){return cE(this.dragRect)?(this.dragRect.right-this.dragRect.left)*this.draggablePercent:0}},mounted(){this.draggable&&this.draggableSetup(),this.pauseOnFocusLoss&&this.focusSetup()},beforeUnmount(){this.draggable&&this.draggableCleanup(),this.pauseOnFocusLoss&&this.focusCleanup()},methods:{hasProp:Oc,getVueComponentFromObj:g_,closeToast(){this.eventBus.emit(za.DISMISS,this.id)},clickHandler(){this.onClick&&this.onClick(this.closeToast),this.closeOnClick&&(!this.beingDragged||this.dragStart===this.dragPos.x)&&this.closeToast()},timeoutHandler(){this.closeToast()},hoverPause(){this.pauseOnHover&&(this.isRunning=!1)},hoverPlay(){this.pauseOnHover&&(this.isRunning=!0)},focusPause(){this.isRunning=!1},focusPlay(){this.isRunning=!0},focusSetup(){addEventListener("blur",this.focusPause),addEventListener("focus",this.focusPlay)},focusCleanup(){removeEventListener("blur",this.focusPause),removeEventListener("focus",this.focusPlay)},draggableSetup(){const t=this.$el;t.addEventListener("touchstart",this.onDragStart,{passive:!0}),t.addEventListener("mousedown",this.onDragStart),addEventListener("touchmove",this.onDragMove,{passive:!1}),addEventListener("mousemove",this.onDragMove),addEventListener("touchend",this.onDragEnd),addEventListener("mouseup",this.onDragEnd)},draggableCleanup(){const t=this.$el;t.removeEventListener("touchstart",this.onDragStart),t.removeEventListener("mousedown",this.onDragStart),removeEventListener("touchmove",this.onDragMove),removeEventListener("mousemove",this.onDragMove),removeEventListener("touchend",this.onDragEnd),removeEventListener("mouseup",this.onDragEnd)},onDragStart(t){this.beingDragged=!0,this.dragPos={x:E0(t),y:hE(t)},this.dragStart=E0(t),this.dragRect=this.$el.getBoundingClientRect()},onDragMove(t){this.beingDragged&&(t.preventDefault(),this.isRunning&&(this.isRunning=!1),this.dragPos={x:E0(t),y:hE(t)})},onDragEnd(){this.beingDragged&&(Math.abs(this.dragDelta)>=this.removalDistance?(this.disableTransitions=!0,this.$nextTick(()=>this.closeToast())):setTimeout(()=>{this.beingDragged=!1,cE(this.dragRect)&&this.pauseOnHover&&this.dragRect.bottom>=this.dragPos.y&&this.dragPos.y>=this.dragRect.top&&this.dragRect.left<=this.dragPos.x&&this.dragPos.x<=this.dragRect.right?this.isRunning=!1:this.isRunning=!0}))}}}),T4=["role"];function E4(t,l){const d=Mh("Icon"),_=Mh("CloseButton"),T=Mh("ProgressBar");return _i(),Pi("div",{class:Vs(t.classes),style:zc(t.draggableStyle),onClick:l[0]||(l[0]=(...C)=>t.clickHandler&&t.clickHandler(...C)),onMouseenter:l[1]||(l[1]=(...C)=>t.hoverPause&&t.hoverPause(...C)),onMouseleave:l[2]||(l[2]=(...C)=>t.hoverPlay&&t.hoverPlay(...C))},[t.icon?(_i(),No(d,{key:0,"custom-icon":t.icon,type:t.type},null,8,["custom-icon","type"])):En("v-if",!0),lt("div",{role:t.accessibility.toastRole||"alert",class:Vs(t.bodyClasses)},[typeof t.content=="string"?(_i(),Pi($r,{key:0},[js(Vt(t.content),1)],2112)):(_i(),No(Mx(t.getVueComponentFromObj(t.content)),d_({key:1,"toast-id":t.id},t.hasProp(t.content,"props")?t.content.props:{},lS(t.hasProp(t.content,"listeners")?t.content.listeners:{}),{onCloseToast:t.closeToast}),null,16,["toast-id","onCloseToast"]))],10,T4),t.closeButton?(_i(),No(_,{key:1,component:t.closeButton,"class-names":t.closeButtonClassName,"show-on-hover":t.showCloseButtonOnHover,"aria-label":t.accessibility.closeButtonLabel,onClick:Kg(t.closeToast,["stop"])},null,8,["component","class-names","show-on-hover","aria-label","onClick"])):En("v-if",!0),t.timeout?(_i(),No(T,{key:2,"is-running":t.isRunning,"hide-progress-bar":t.hideProgressBar,timeout:t.timeout,onCloseToast:t.timeoutHandler},null,8,["is-running","hide-progress-bar","timeout","onCloseToast"])):En("v-if",!0)],38)}dM.render=E4;var S4=dM,fM=zn({name:"VtTransition",props:kh.TRANSITION,emits:["leave"],methods:{hasProp:Oc,leave(t){t instanceof HTMLElement&&(t.style.left=t.offsetLeft+"px",t.style.top=t.offsetTop+"px",t.style.width=getComputedStyle(t).width,t.style.position="absolute")}}});function C4(t,l){return _i(),No(nC,{tag:"div","enter-active-class":t.transition.enter?t.transition.enter:`${t.transition}-enter-active`,"move-class":t.transition.move?t.transition.move:`${t.transition}-move`,"leave-active-class":t.transition.leave?t.transition.leave:`${t.transition}-leave-active`,onLeave:t.leave},{default:Us(()=>[aS(t.$slots,"default")]),_:3},8,["enter-active-class","move-class","leave-active-class","onLeave"])}fM.render=C4;var A4=fM,pM=zn({name:"VueToastification",devtools:{hide:!0},components:{Toast:S4,VtTransition:A4},props:Object.assign({},kh.CORE_TOAST,kh.CONTAINER,kh.TRANSITION),data(){return{count:0,positions:Object.values(hx),toasts:{},defaults:{}}},computed:{toastArray(){return Object.values(this.toasts)},filteredToasts(){return this.defaults.filterToasts(this.toastArray)}},beforeMount(){const t=this.eventBus;t.on(za.ADD,this.addToast),t.on(za.CLEAR,this.clearToasts),t.on(za.DISMISS,this.dismissToast),t.on(za.UPDATE,this.updateToast),t.on(za.UPDATE_DEFAULTS,this.updateDefaults),this.defaults=this.$props},mounted(){this.setup(this.container)},methods:{async setup(t){Wx(t)&&(t=await t()),G5(this.$el),t.appendChild(this.$el)},setToast(t){Af(t.id)||(this.toasts[t.id]=t)},addToast(t){t.content=W5(t.content);const l=Object.assign({},this.defaults,t.type&&this.defaults.toastDefaults&&this.defaults.toastDefaults[t.type],t),d=this.defaults.filterBeforeCreate(l,this.toastArray);d&&this.setToast(d)},dismissToast(t){const l=this.toasts[t];!Af(l)&&!Af(l.onClose)&&l.onClose(),delete this.toasts[t]},clearToasts(){Object.keys(this.toasts).forEach(t=>{this.dismissToast(t)})},getPositionToasts(t){const l=this.filteredToasts.filter(d=>d.position===t).slice(0,this.defaults.maxToasts);return this.defaults.newestOnTop?l.reverse():l},updateDefaults(t){Af(t.container)||this.setup(t.container),this.defaults=Object.assign({},this.defaults,t)},updateToast({id:t,options:l,create:d}){this.toasts[t]?(l.timeout&&l.timeout===this.toasts[t].timeout&&l.timeout++,this.setToast(Object.assign({},this.toasts[t],l))):d&&this.addToast(Object.assign({},{id:t},l))},getClasses(t){return[`${Fl}__container`,t].concat(this.defaults.containerClassName)}}});function M4(t,l){const d=Mh("Toast"),_=Mh("VtTransition");return _i(),Pi("div",null,[(_i(!0),Pi($r,null,Ba(t.positions,T=>(_i(),Pi("div",{key:T},[pr(_,{transition:t.defaults.transition,class:Vs(t.getClasses(T))},{default:Us(()=>[(_i(!0),Pi($r,null,Ba(t.getPositionToasts(T),C=>(_i(),No(d,d_({key:C.id},C),null,16))),128))]),_:2},1032,["transition","class"])]))),128))])}pM.render=M4;var I4=pM,dE=(t={},l=!0)=>{const d=t.eventBus=t.eventBus||new e1;l&&Bf(()=>{const C=Jg(I4,JA({},t)),P=C.mount(document.createElement("div")),V=t.onMounted;if(Af(V)||V(P,C),t.shareAppContext){const s=t.shareAppContext;s===!0?console.warn(`[${Fl}] App to share context with was not provided.`):(C._context.components=s._context.components,C._context.directives=s._context.directives,C._context.mixins=s._context.mixins,C._context.provides=s._context.provides,C.config.globalProperties=s.config.globalProperties)}});const _=(C,P)=>{const V=Object.assign({},{id:$5(),type:Ra.DEFAULT},P,{content:C});return d.emit(za.ADD,V),V.id};_.clear=()=>d.emit(za.CLEAR,void 0),_.updateDefaults=C=>{d.emit(za.UPDATE_DEFAULTS,C)},_.dismiss=C=>{d.emit(za.DISMISS,C)};function T(C,{content:P,options:V},s=!1){const $=Object.assign({},V,{content:P});d.emit(za.UPDATE,{id:C,options:$,create:s})}return _.update=T,_.success=(C,P)=>_(C,Object.assign({},P,{type:Ra.SUCCESS})),_.info=(C,P)=>_(C,Object.assign({},P,{type:Ra.INFO})),_.error=(C,P)=>_(C,Object.assign({},P,{type:Ra.ERROR})),_.warning=(C,P)=>_(C,Object.assign({},P,{type:Ra.WARNING})),_},k4=()=>{const t=()=>console.warn(`[${Fl}] This plugin does not support SSR!`);return new Proxy(t,{get(){return t}})};function P4(t){return H5()?q5(t)?dE({eventBus:t},!1):dE(t,!0):k4()}var L4=Symbol("VueToastification"),D4=new e1,O4=(t,l)=>{(l==null?void 0:l.shareAppContext)===!0&&(l.shareAppContext=t);const d=P4(JA({eventBus:D4},l));t.provide(L4,d)},R4=O4;const bm=Jg(G3),z4=HR();bm.use(z4);bm.use(YA);bm.use(z5);bm.use(i5);const B4={position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnHover:!0,draggable:!0,hideProgressBar:!1};bm.use(R4,B4);bm.mount("#app");
